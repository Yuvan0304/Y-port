var Ka=Object.defineProperty;var rn=(r,a,n)=>a in r?Ka(r,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[a]=n;var nn=(r,a)=>()=>(a||r((a={exports:{}}).exports,a),a.exports);var _s=(r,a,n)=>rn(r,typeof a!="symbol"?a+"":a,n);var hn=nn((exports,module)=>{(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))o(f);new MutationObserver(f=>{for(const y of f)if(y.type==="childList")for(const x of y.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&o(x)}).observe(document,{childList:!0,subtree:!0});function n(f){const y={};return f.integrity&&(y.integrity=f.integrity),f.referrerPolicy&&(y.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?y.credentials="include":f.crossOrigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function o(f){if(f.ep)return;f.ep=!0;const y=n(f);fetch(f.href,y)}})();const scriptRel="modulepreload",assetsURL=function(r){return"/"+r},seen={},__vitePreload=function(a,n,o){let f=Promise.resolve();if(n&&n.length>0){let x=function(S){return Promise.all(S.map(A=>Promise.resolve(A).then(C=>({status:"fulfilled",value:C}),C=>({status:"rejected",reason:C}))))};document.getElementsByTagName("link");const b=document.querySelector("meta[property=csp-nonce]"),_=(b==null?void 0:b.nonce)||(b==null?void 0:b.getAttribute("nonce"));f=x(n.map(S=>{if(S=assetsURL(S),S in seen)return;seen[S]=!0;const A=S.endsWith(".css"),C=A?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${S}"]${C}`))return;const P=document.createElement("link");if(P.rel=A?"stylesheet":scriptRel,A||(P.as="script"),P.crossOrigin="",P.href=S,_&&P.setAttribute("nonce",_),document.head.appendChild(P),A)return new Promise((T,M)=>{P.addEventListener("load",T),P.addEventListener("error",()=>M(new Error(`Unable to preload CSS for ${S}`)))})}))}function y(x){const b=new Event("vite:preloadError",{cancelable:!0});if(b.payload=x,window.dispatchEvent(b),!b.defaultPrevented)throw x}return f.then(x=>{for(const b of x||[])b.status==="rejected"&&y(b.reason);return a().catch(y)})};function _assertThisInitialized(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function _inheritsLoose(r,a){r.prototype=Object.create(a.prototype),r.prototype.constructor=r,r.__proto__=a}/*!
 * GSAP 3.13.0
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var _config$1={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},_defaults$1={duration:.5,overwrite:!1,delay:0},_suppressOverwrites$1,_reverting$1,_context$2,_bigNum$2=1e8,_tinyNum=1/_bigNum$2,_2PI=Math.PI*2,_HALF_PI=_2PI/4,_gsID=0,_sqrt$1=Math.sqrt,_cos$1=Math.cos,_sin$1=Math.sin,_isString$2=function(a){return typeof a=="string"},_isFunction$2=function(a){return typeof a=="function"},_isNumber$2=function(a){return typeof a=="number"},_isUndefined=function(a){return typeof a>"u"},_isObject$1=function(a){return typeof a=="object"},_isNotFalse=function(a){return a!==!1},_windowExists$3=function(){return typeof window<"u"},_isFuncOrString=function(a){return _isFunction$2(a)||_isString$2(a)},_isTypedArray=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},_isArray=Array.isArray,_strictNumExp=/(?:-?\.?\d|\.)+/gi,_numExp$1=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,_numWithUnitExp=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,_complexStringNumExp=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,_relExp=/[+-]=-?[.\d]+/,_delimitedValueExp=/[^,'"\[\]\s]+/gi,_unitExp=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,_globalTimeline,_win$3,_coreInitted$4,_doc$3,_globals={},_installScope={},_coreReady,_install=function(a){return(_installScope=_merge(a,_globals))&&gsap$4},_missingPlugin=function(a,n){return console.warn("Invalid property",a,"set to",n,"Missing plugin? gsap.registerPlugin()")},_warn=function(a,n){return!n&&console.warn(a)},_addGlobal=function(a,n){return a&&(_globals[a]=n)&&_installScope&&(_installScope[a]=n)||_globals},_emptyFunc=function(){return 0},_startAtRevertConfig={suppressEvents:!0,isStart:!0,kill:!1},_revertConfigNoKill={suppressEvents:!0,kill:!1},_revertConfig={suppressEvents:!0},_reservedProps={},_lazyTweens=[],_lazyLookup={},_lastRenderedFrame,_plugins={},_effects={},_nextGCFrame=30,_harnessPlugins=[],_callbackNames="",_harness=function(a){var n=a[0],o,f;if(_isObject$1(n)||_isFunction$2(n)||(a=[a]),!(o=(n._gsap||{}).harness)){for(f=_harnessPlugins.length;f--&&!_harnessPlugins[f].targetTest(n););o=_harnessPlugins[f]}for(f=a.length;f--;)a[f]&&(a[f]._gsap||(a[f]._gsap=new GSCache(a[f],o)))||a.splice(f,1);return a},_getCache=function(a){return a._gsap||_harness(toArray(a))[0]._gsap},_getProperty=function(a,n,o){return(o=a[n])&&_isFunction$2(o)?a[n]():_isUndefined(o)&&a.getAttribute&&a.getAttribute(n)||o},_forEachName=function(a,n){return(a=a.split(",")).forEach(n)||a},_round$3=function(a){return Math.round(a*1e5)/1e5||0},_roundPrecise=function(a){return Math.round(a*1e7)/1e7||0},_parseRelative=function(a,n){var o=n.charAt(0),f=parseFloat(n.substr(2));return a=parseFloat(a),o==="+"?a+f:o==="-"?a-f:o==="*"?a*f:a/f},_arrayContainsAny=function(a,n){for(var o=n.length,f=0;a.indexOf(n[f])<0&&++f<o;);return f<o},_lazyRender=function(){var a=_lazyTweens.length,n=_lazyTweens.slice(0),o,f;for(_lazyLookup={},_lazyTweens.length=0,o=0;o<a;o++)f=n[o],f&&f._lazy&&(f.render(f._lazy[0],f._lazy[1],!0)._lazy=0)},_isRevertWorthy=function(a){return!!(a._initted||a._startAt||a.add)},_lazySafeRender=function(a,n,o,f){_lazyTweens.length&&!_reverting$1&&_lazyRender(),a.render(n,o,!!(_reverting$1&&n<0&&_isRevertWorthy(a))),_lazyTweens.length&&!_reverting$1&&_lazyRender()},_numericIfPossible=function(a){var n=parseFloat(a);return(n||n===0)&&(a+"").match(_delimitedValueExp).length<2?n:_isString$2(a)?a.trim():a},_passThrough$1=function(a){return a},_setDefaults$1=function(a,n){for(var o in n)o in a||(a[o]=n[o]);return a},_setKeyframeDefaults=function(a){return function(n,o){for(var f in o)f in n||f==="duration"&&a||f==="ease"||(n[f]=o[f])}},_merge=function(a,n){for(var o in n)a[o]=n[o];return a},_mergeDeep=function r(a,n){for(var o in n)o!=="__proto__"&&o!=="constructor"&&o!=="prototype"&&(a[o]=_isObject$1(n[o])?r(a[o]||(a[o]={}),n[o]):n[o]);return a},_copyExcluding=function(a,n){var o={},f;for(f in a)f in n||(o[f]=a[f]);return o},_inheritDefaults=function(a){var n=a.parent||_globalTimeline,o=a.keyframes?_setKeyframeDefaults(_isArray(a.keyframes)):_setDefaults$1;if(_isNotFalse(a.inherit))for(;n;)o(a,n.vars.defaults),n=n.parent||n._dp;return a},_arraysMatch=function(a,n){for(var o=a.length,f=o===n.length;f&&o--&&a[o]===n[o];);return o<0},_addLinkedListItem=function(a,n,o,f,y){var x=a[f],b;if(y)for(b=n[y];x&&x[y]>b;)x=x._prev;return x?(n._next=x._next,x._next=n):(n._next=a[o],a[o]=n),n._next?n._next._prev=n:a[f]=n,n._prev=x,n.parent=n._dp=a,n},_removeLinkedListItem=function(a,n,o,f){o===void 0&&(o="_first"),f===void 0&&(f="_last");var y=n._prev,x=n._next;y?y._next=x:a[o]===n&&(a[o]=x),x?x._prev=y:a[f]===n&&(a[f]=y),n._next=n._prev=n.parent=null},_removeFromParent=function(a,n){a.parent&&(!n||a.parent.autoRemoveChildren)&&a.parent.remove&&a.parent.remove(a),a._act=0},_uncache=function(a,n){if(a&&(!n||n._end>a._dur||n._start<0))for(var o=a;o;)o._dirty=1,o=o.parent;return a},_recacheAncestors=function(a){for(var n=a.parent;n&&n.parent;)n._dirty=1,n.totalDuration(),n=n.parent;return a},_rewindStartAt=function(a,n,o,f){return a._startAt&&(_reverting$1?a._startAt.revert(_revertConfigNoKill):a.vars.immediateRender&&!a.vars.autoRevert||a._startAt.render(n,!0,f))},_hasNoPausedAncestors=function r(a){return!a||a._ts&&r(a.parent)},_elapsedCycleDuration=function(a){return a._repeat?_animationCycle(a._tTime,a=a.duration()+a._rDelay)*a:0},_animationCycle=function(a,n){var o=Math.floor(a=_roundPrecise(a/n));return a&&o===a?o-1:o},_parentToChildTotalTime=function(a,n){return(a-n._start)*n._ts+(n._ts>=0?0:n._dirty?n.totalDuration():n._tDur)},_setEnd=function(a){return a._end=_roundPrecise(a._start+(a._tDur/Math.abs(a._ts||a._rts||_tinyNum)||0))},_alignPlayhead=function(a,n){var o=a._dp;return o&&o.smoothChildTiming&&a._ts&&(a._start=_roundPrecise(o._time-(a._ts>0?n/a._ts:((a._dirty?a.totalDuration():a._tDur)-n)/-a._ts)),_setEnd(a),o._dirty||_uncache(o,a)),a},_postAddChecks=function(a,n){var o;if((n._time||!n._dur&&n._initted||n._start<a._time&&(n._dur||!n.add))&&(o=_parentToChildTotalTime(a.rawTime(),n),(!n._dur||_clamp$1(0,n.totalDuration(),o)-n._tTime>_tinyNum)&&n.render(o,!0)),_uncache(a,n)._dp&&a._initted&&a._time>=a._dur&&a._ts){if(a._dur<a.duration())for(o=a;o._dp;)o.rawTime()>=0&&o.totalTime(o._tTime),o=o._dp;a._zTime=-1e-8}},_addToTimeline=function(a,n,o,f){return n.parent&&_removeFromParent(n),n._start=_roundPrecise((_isNumber$2(o)?o:o||a!==_globalTimeline?_parsePosition$1(a,o,n):a._time)+n._delay),n._end=_roundPrecise(n._start+(n.totalDuration()/Math.abs(n.timeScale())||0)),_addLinkedListItem(a,n,"_first","_last",a._sort?"_start":0),_isFromOrFromStart(n)||(a._recent=n),f||_postAddChecks(a,n),a._ts<0&&_alignPlayhead(a,a._tTime),a},_scrollTrigger=function(a,n){return(_globals.ScrollTrigger||_missingPlugin("scrollTrigger",n))&&_globals.ScrollTrigger.create(n,a)},_attemptInitTween=function(a,n,o,f,y){if(_initTween(a,n,y),!a._initted)return 1;if(!o&&a._pt&&!_reverting$1&&(a._dur&&a.vars.lazy!==!1||!a._dur&&a.vars.lazy)&&_lastRenderedFrame!==_ticker.frame)return _lazyTweens.push(a),a._lazy=[y,f],1},_parentPlayheadIsBeforeStart=function r(a){var n=a.parent;return n&&n._ts&&n._initted&&!n._lock&&(n.rawTime()<0||r(n))},_isFromOrFromStart=function(a){var n=a.data;return n==="isFromStart"||n==="isStart"},_renderZeroDurationTween=function(a,n,o,f){var y=a.ratio,x=n<0||!n&&(!a._start&&_parentPlayheadIsBeforeStart(a)&&!(!a._initted&&_isFromOrFromStart(a))||(a._ts<0||a._dp._ts<0)&&!_isFromOrFromStart(a))?0:1,b=a._rDelay,_=0,S,A,C;if(b&&a._repeat&&(_=_clamp$1(0,a._tDur,n),A=_animationCycle(_,b),a._yoyo&&A&1&&(x=1-x),A!==_animationCycle(a._tTime,b)&&(y=1-x,a.vars.repeatRefresh&&a._initted&&a.invalidate())),x!==y||_reverting$1||f||a._zTime===_tinyNum||!n&&a._zTime){if(!a._initted&&_attemptInitTween(a,n,f,o,_))return;for(C=a._zTime,a._zTime=n||(o?_tinyNum:0),o||(o=n&&!C),a.ratio=x,a._from&&(x=1-x),a._time=0,a._tTime=_,S=a._pt;S;)S.r(x,S.d),S=S._next;n<0&&_rewindStartAt(a,n,o,!0),a._onUpdate&&!o&&_callback$1(a,"onUpdate"),_&&a._repeat&&!o&&a.parent&&_callback$1(a,"onRepeat"),(n>=a._tDur||n<0)&&a.ratio===x&&(x&&_removeFromParent(a,1),!o&&!_reverting$1&&(_callback$1(a,x?"onComplete":"onReverseComplete",!0),a._prom&&a._prom()))}else a._zTime||(a._zTime=n)},_findNextPauseTween=function(a,n,o){var f;if(o>n)for(f=a._first;f&&f._start<=o;){if(f.data==="isPause"&&f._start>n)return f;f=f._next}else for(f=a._last;f&&f._start>=o;){if(f.data==="isPause"&&f._start<n)return f;f=f._prev}},_setDuration=function(a,n,o,f){var y=a._repeat,x=_roundPrecise(n)||0,b=a._tTime/a._tDur;return b&&!f&&(a._time*=x/a._dur),a._dur=x,a._tDur=y?y<0?1e10:_roundPrecise(x*(y+1)+a._rDelay*y):x,b>0&&!f&&_alignPlayhead(a,a._tTime=a._tDur*b),a.parent&&_setEnd(a),o||_uncache(a.parent,a),a},_onUpdateTotalDuration=function(a){return a instanceof Timeline?_uncache(a):_setDuration(a,a._dur)},_zeroPosition={_start:0,endTime:_emptyFunc,totalDuration:_emptyFunc},_parsePosition$1=function r(a,n,o){var f=a.labels,y=a._recent||_zeroPosition,x=a.duration()>=_bigNum$2?y.endTime(!1):a._dur,b,_,S;return _isString$2(n)&&(isNaN(n)||n in f)?(_=n.charAt(0),S=n.substr(-1)==="%",b=n.indexOf("="),_==="<"||_===">"?(b>=0&&(n=n.replace(/=/,"")),(_==="<"?y._start:y.endTime(y._repeat>=0))+(parseFloat(n.substr(1))||0)*(S?(b<0?y:o).totalDuration()/100:1)):b<0?(n in f||(f[n]=x),f[n]):(_=parseFloat(n.charAt(b-1)+n.substr(b+1)),S&&o&&(_=_/100*(_isArray(o)?o[0]:o).totalDuration()),b>1?r(a,n.substr(0,b-1),o)+_:x+_)):n==null?x:+n},_createTweenType=function(a,n,o){var f=_isNumber$2(n[1]),y=(f?2:1)+(a<2?0:1),x=n[y],b,_;if(f&&(x.duration=n[1]),x.parent=o,a){for(b=x,_=o;_&&!("immediateRender"in b);)b=_.vars.defaults||{},_=_isNotFalse(_.vars.inherit)&&_.parent;x.immediateRender=_isNotFalse(b.immediateRender),a<2?x.runBackwards=1:x.startAt=n[y-1]}return new Tween(n[0],x,n[y+1])},_conditionalReturn=function(a,n){return a||a===0?n(a):n},_clamp$1=function(a,n,o){return o<a?a:o>n?n:o},getUnit=function(a,n){return!_isString$2(a)||!(n=_unitExp.exec(a))?"":n[1]},clamp=function(a,n,o){return _conditionalReturn(o,function(f){return _clamp$1(a,n,f)})},_slice=[].slice,_isArrayLike=function(a,n){return a&&_isObject$1(a)&&"length"in a&&(!n&&!a.length||a.length-1 in a&&_isObject$1(a[0]))&&!a.nodeType&&a!==_win$3},_flatten=function(a,n,o){return o===void 0&&(o=[]),a.forEach(function(f){var y;return _isString$2(f)&&!n||_isArrayLike(f,1)?(y=o).push.apply(y,toArray(f)):o.push(f)})||o},toArray=function(a,n,o){return _context$2&&!n&&_context$2.selector?_context$2.selector(a):_isString$2(a)&&!o&&(_coreInitted$4||!_wake())?_slice.call((n||_doc$3).querySelectorAll(a),0):_isArray(a)?_flatten(a,o):_isArrayLike(a)?_slice.call(a,0):a?[a]:[]},selector=function(a){return a=toArray(a)[0]||_warn("Invalid scope")||{},function(n){var o=a.current||a.nativeElement||a;return toArray(n,o.querySelectorAll?o:o===a?_warn("Invalid scope")||_doc$3.createElement("div"):a)}},shuffle=function(a){return a.sort(function(){return .5-Math.random()})},distribute=function(a){if(_isFunction$2(a))return a;var n=_isObject$1(a)?a:{each:a},o=_parseEase(n.ease),f=n.from||0,y=parseFloat(n.base)||0,x={},b=f>0&&f<1,_=isNaN(f)||b,S=n.axis,A=f,C=f;return _isString$2(f)?A=C={center:.5,edges:.5,end:1}[f]||0:!b&&_&&(A=f[0],C=f[1]),function(P,T,M){var O=(M||n).length,I=x[O],D,z,k,L,R,F,B,N,j;if(!I){if(j=n.grid==="auto"?0:(n.grid||[1,_bigNum$2])[1],!j){for(B=-1e8;B<(B=M[j++].getBoundingClientRect().left)&&j<O;);j<O&&j--}for(I=x[O]=[],D=_?Math.min(j,O)*A-.5:f%j,z=j===_bigNum$2?0:_?O*C/j-.5:f/j|0,B=0,N=_bigNum$2,F=0;F<O;F++)k=F%j-D,L=z-(F/j|0),I[F]=R=S?Math.abs(S==="y"?L:k):_sqrt$1(k*k+L*L),R>B&&(B=R),R<N&&(N=R);f==="random"&&shuffle(I),I.max=B-N,I.min=N,I.v=O=(parseFloat(n.amount)||parseFloat(n.each)*(j>O?O-1:S?S==="y"?O/j:j:Math.max(j,O/j))||0)*(f==="edges"?-1:1),I.b=O<0?y-O:y,I.u=getUnit(n.amount||n.each)||0,o=o&&O<0?_invertEase(o):o}return O=(I[P]-I.min)/I.max||0,_roundPrecise(I.b+(o?o(O):O)*I.v)+I.u}},_roundModifier=function(a){var n=Math.pow(10,((a+"").split(".")[1]||"").length);return function(o){var f=_roundPrecise(Math.round(parseFloat(o)/a)*a*n);return(f-f%1)/n+(_isNumber$2(o)?0:getUnit(o))}},snap=function(a,n){var o=_isArray(a),f,y;return!o&&_isObject$1(a)&&(f=o=a.radius||_bigNum$2,a.values?(a=toArray(a.values),(y=!_isNumber$2(a[0]))&&(f*=f)):a=_roundModifier(a.increment)),_conditionalReturn(n,o?_isFunction$2(a)?function(x){return y=a(x),Math.abs(y-x)<=f?y:x}:function(x){for(var b=parseFloat(y?x.x:x),_=parseFloat(y?x.y:0),S=_bigNum$2,A=0,C=a.length,P,T;C--;)y?(P=a[C].x-b,T=a[C].y-_,P=P*P+T*T):P=Math.abs(a[C]-b),P<S&&(S=P,A=C);return A=!f||S<=f?a[A]:x,y||A===x||_isNumber$2(x)?A:A+getUnit(x)}:_roundModifier(a))},random=function(a,n,o,f){return _conditionalReturn(_isArray(a)?!n:o===!0?!!(o=0):!f,function(){return _isArray(a)?a[~~(Math.random()*a.length)]:(o=o||1e-5)&&(f=o<1?Math.pow(10,(o+"").length-2):1)&&Math.floor(Math.round((a-o/2+Math.random()*(n-a+o*.99))/o)*o*f)/f})},pipe=function(){for(var a=arguments.length,n=new Array(a),o=0;o<a;o++)n[o]=arguments[o];return function(f){return n.reduce(function(y,x){return x(y)},f)}},unitize=function(a,n){return function(o){return a(parseFloat(o))+(n||getUnit(o))}},normalize=function(a,n,o){return mapRange(a,n,0,1,o)},_wrapArray=function(a,n,o){return _conditionalReturn(o,function(f){return a[~~n(f)]})},wrap=function r(a,n,o){var f=n-a;return _isArray(a)?_wrapArray(a,r(0,a.length),n):_conditionalReturn(o,function(y){return(f+(y-a)%f)%f+a})},wrapYoyo=function r(a,n,o){var f=n-a,y=f*2;return _isArray(a)?_wrapArray(a,r(0,a.length-1),n):_conditionalReturn(o,function(x){return x=(y+(x-a)%y)%y||0,a+(x>f?y-x:x)})},_replaceRandom=function(a){for(var n=0,o="",f,y,x,b;~(f=a.indexOf("random(",n));)x=a.indexOf(")",f),b=a.charAt(f+7)==="[",y=a.substr(f+7,x-f-7).match(b?_delimitedValueExp:_strictNumExp),o+=a.substr(n,f-n)+random(b?y:+y[0],b?0:+y[1],+y[2]||1e-5),n=x+1;return o+a.substr(n,a.length-n)},mapRange=function(a,n,o,f,y){var x=n-a,b=f-o;return _conditionalReturn(y,function(_){return o+((_-a)/x*b||0)})},interpolate=function r(a,n,o,f){var y=isNaN(a+n)?0:function(T){return(1-T)*a+T*n};if(!y){var x=_isString$2(a),b={},_,S,A,C,P;if(o===!0&&(f=1)&&(o=null),x)a={p:a},n={p:n};else if(_isArray(a)&&!_isArray(n)){for(A=[],C=a.length,P=C-2,S=1;S<C;S++)A.push(r(a[S-1],a[S]));C--,y=function(M){M*=C;var O=Math.min(P,~~M);return A[O](M-O)},o=n}else f||(a=_merge(_isArray(a)?[]:{},a));if(!A){for(_ in n)_addPropTween.call(b,a,_,"get",n[_]);y=function(M){return _renderPropTweens(M,b)||(x?a.p:a)}}}return _conditionalReturn(o,y)},_getLabelInDirection=function(a,n,o){var f=a.labels,y=_bigNum$2,x,b,_;for(x in f)b=f[x]-n,b<0==!!o&&b&&y>(b=Math.abs(b))&&(_=x,y=b);return _},_callback$1=function(a,n,o){var f=a.vars,y=f[n],x=_context$2,b=a._ctx,_,S,A;if(y)return _=f[n+"Params"],S=f.callbackScope||a,o&&_lazyTweens.length&&_lazyRender(),b&&(_context$2=b),A=_?y.apply(S,_):y.call(S),_context$2=x,A},_interrupt=function(a){return _removeFromParent(a),a.scrollTrigger&&a.scrollTrigger.kill(!!_reverting$1),a.progress()<1&&_callback$1(a,"onInterrupt"),a},_quickTween,_registerPluginQueue=[],_createPlugin=function(a){if(a)if(a=!a.name&&a.default||a,_windowExists$3()||a.headless){var n=a.name,o=_isFunction$2(a),f=n&&!o&&a.init?function(){this._props=[]}:a,y={init:_emptyFunc,render:_renderPropTweens,add:_addPropTween,kill:_killPropTweensOf,modifier:_addPluginModifier,rawVars:0},x={targetTest:0,get:0,getSetter:_getSetter,aliases:{},register:0};if(_wake(),a!==f){if(_plugins[n])return;_setDefaults$1(f,_setDefaults$1(_copyExcluding(a,y),x)),_merge(f.prototype,_merge(y,_copyExcluding(a,x))),_plugins[f.prop=n]=f,a.targetTest&&(_harnessPlugins.push(f),_reservedProps[n]=1),n=(n==="css"?"CSS":n.charAt(0).toUpperCase()+n.substr(1))+"Plugin"}_addGlobal(n,f),a.register&&a.register(gsap$4,f,PropTween)}else _registerPluginQueue.push(a)},_255=255,_colorLookup={aqua:[0,_255,_255],lime:[0,_255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,_255],navy:[0,0,128],white:[_255,_255,_255],olive:[128,128,0],yellow:[_255,_255,0],orange:[_255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[_255,0,0],pink:[_255,192,203],cyan:[0,_255,_255],transparent:[_255,_255,_255,0]},_hue=function(a,n,o){return a+=a<0?1:a>1?-1:0,(a*6<1?n+(o-n)*a*6:a<.5?o:a*3<2?n+(o-n)*(2/3-a)*6:n)*_255+.5|0},splitColor=function(a,n,o){var f=a?_isNumber$2(a)?[a>>16,a>>8&_255,a&_255]:0:_colorLookup.black,y,x,b,_,S,A,C,P,T,M;if(!f){if(a.substr(-1)===","&&(a=a.substr(0,a.length-1)),_colorLookup[a])f=_colorLookup[a];else if(a.charAt(0)==="#"){if(a.length<6&&(y=a.charAt(1),x=a.charAt(2),b=a.charAt(3),a="#"+y+y+x+x+b+b+(a.length===5?a.charAt(4)+a.charAt(4):"")),a.length===9)return f=parseInt(a.substr(1,6),16),[f>>16,f>>8&_255,f&_255,parseInt(a.substr(7),16)/255];a=parseInt(a.substr(1),16),f=[a>>16,a>>8&_255,a&_255]}else if(a.substr(0,3)==="hsl"){if(f=M=a.match(_strictNumExp),!n)_=+f[0]%360/360,S=+f[1]/100,A=+f[2]/100,x=A<=.5?A*(S+1):A+S-A*S,y=A*2-x,f.length>3&&(f[3]*=1),f[0]=_hue(_+1/3,y,x),f[1]=_hue(_,y,x),f[2]=_hue(_-1/3,y,x);else if(~a.indexOf("="))return f=a.match(_numExp$1),o&&f.length<4&&(f[3]=1),f}else f=a.match(_strictNumExp)||_colorLookup.transparent;f=f.map(Number)}return n&&!M&&(y=f[0]/_255,x=f[1]/_255,b=f[2]/_255,C=Math.max(y,x,b),P=Math.min(y,x,b),A=(C+P)/2,C===P?_=S=0:(T=C-P,S=A>.5?T/(2-C-P):T/(C+P),_=C===y?(x-b)/T+(x<b?6:0):C===x?(b-y)/T+2:(y-x)/T+4,_*=60),f[0]=~~(_+.5),f[1]=~~(S*100+.5),f[2]=~~(A*100+.5)),o&&f.length<4&&(f[3]=1),f},_colorOrderData=function(a){var n=[],o=[],f=-1;return a.split(_colorExp).forEach(function(y){var x=y.match(_numWithUnitExp)||[];n.push.apply(n,x),o.push(f+=x.length+1)}),n.c=o,n},_formatColors=function(a,n,o){var f="",y=(a+f).match(_colorExp),x=n?"hsla(":"rgba(",b=0,_,S,A,C;if(!y)return a;if(y=y.map(function(P){return(P=splitColor(P,n,1))&&x+(n?P[0]+","+P[1]+"%,"+P[2]+"%,"+P[3]:P.join(","))+")"}),o&&(A=_colorOrderData(a),_=o.c,_.join(f)!==A.c.join(f)))for(S=a.replace(_colorExp,"1").split(_numWithUnitExp),C=S.length-1;b<C;b++)f+=S[b]+(~_.indexOf(b)?y.shift()||x+"0,0,0,0)":(A.length?A:y.length?y:o).shift());if(!S)for(S=a.split(_colorExp),C=S.length-1;b<C;b++)f+=S[b]+y[b];return f+S[C]},_colorExp=function(){var r="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",a;for(a in _colorLookup)r+="|"+a+"\\b";return new RegExp(r+")","gi")}(),_hslExp=/hsl[a]?\(/,_colorStringFilter=function(a){var n=a.join(" "),o;if(_colorExp.lastIndex=0,_colorExp.test(n))return o=_hslExp.test(n),a[1]=_formatColors(a[1],o),a[0]=_formatColors(a[0],o,_colorOrderData(a[1])),!0},_tickerActive,_ticker=function(){var r=Date.now,a=500,n=33,o=r(),f=o,y=1e3/240,x=y,b=[],_,S,A,C,P,T,M=function O(I){var D=r()-f,z=I===!0,k,L,R,F;if((D>a||D<0)&&(o+=D-n),f+=D,R=f-o,k=R-x,(k>0||z)&&(F=++C.frame,P=R-C.time*1e3,C.time=R=R/1e3,x+=k+(k>=y?4:y-k),L=1),z||(_=S(O)),L)for(T=0;T<b.length;T++)b[T](R,P,F,I)};return C={time:0,frame:0,tick:function(){M(!0)},deltaRatio:function(I){return P/(1e3/(I||60))},wake:function(){_coreReady&&(!_coreInitted$4&&_windowExists$3()&&(_win$3=_coreInitted$4=window,_doc$3=_win$3.document||{},_globals.gsap=gsap$4,(_win$3.gsapVersions||(_win$3.gsapVersions=[])).push(gsap$4.version),_install(_installScope||_win$3.GreenSockGlobals||!_win$3.gsap&&_win$3||{}),_registerPluginQueue.forEach(_createPlugin)),A=typeof requestAnimationFrame<"u"&&requestAnimationFrame,_&&C.sleep(),S=A||function(I){return setTimeout(I,x-C.time*1e3+1|0)},_tickerActive=1,M(2))},sleep:function(){(A?cancelAnimationFrame:clearTimeout)(_),_tickerActive=0,S=_emptyFunc},lagSmoothing:function(I,D){a=I||1/0,n=Math.min(D||33,a)},fps:function(I){y=1e3/(I||240),x=C.time*1e3+y},add:function(I,D,z){var k=D?function(L,R,F,B){I(L,R,F,B),C.remove(k)}:I;return C.remove(I),b[z?"unshift":"push"](k),_wake(),k},remove:function(I,D){~(D=b.indexOf(I))&&b.splice(D,1)&&T>=D&&T--},_listeners:b},C}(),_wake=function(){return!_tickerActive&&_ticker.wake()},_easeMap={},_customEaseExp=/^[\d.\-M][\d.\-,\s]/,_quotesExp=/["']/g,_parseObjectInString=function(a){for(var n={},o=a.substr(1,a.length-3).split(":"),f=o[0],y=1,x=o.length,b,_,S;y<x;y++)_=o[y],b=y!==x-1?_.lastIndexOf(","):_.length,S=_.substr(0,b),n[f]=isNaN(S)?S.replace(_quotesExp,"").trim():+S,f=_.substr(b+1).trim();return n},_valueInParentheses=function(a){var n=a.indexOf("(")+1,o=a.indexOf(")"),f=a.indexOf("(",n);return a.substring(n,~f&&f<o?a.indexOf(")",o+1):o)},_configEaseFromString=function(a){var n=(a+"").split("("),o=_easeMap[n[0]];return o&&n.length>1&&o.config?o.config.apply(null,~a.indexOf("{")?[_parseObjectInString(n[1])]:_valueInParentheses(a).split(",").map(_numericIfPossible)):_easeMap._CE&&_customEaseExp.test(a)?_easeMap._CE("",a):o},_invertEase=function(a){return function(n){return 1-a(1-n)}},_propagateYoyoEase=function r(a,n){for(var o=a._first,f;o;)o instanceof Timeline?r(o,n):o.vars.yoyoEase&&(!o._yoyo||!o._repeat)&&o._yoyo!==n&&(o.timeline?r(o.timeline,n):(f=o._ease,o._ease=o._yEase,o._yEase=f,o._yoyo=n)),o=o._next},_parseEase=function(a,n){return a&&(_isFunction$2(a)?a:_easeMap[a]||_configEaseFromString(a))||n},_insertEase=function(a,n,o,f){o===void 0&&(o=function(_){return 1-n(1-_)}),f===void 0&&(f=function(_){return _<.5?n(_*2)/2:1-n((1-_)*2)/2});var y={easeIn:n,easeOut:o,easeInOut:f},x;return _forEachName(a,function(b){_easeMap[b]=_globals[b]=y,_easeMap[x=b.toLowerCase()]=o;for(var _ in y)_easeMap[x+(_==="easeIn"?".in":_==="easeOut"?".out":".inOut")]=_easeMap[b+"."+_]=y[_]}),y},_easeInOutFromOut=function(a){return function(n){return n<.5?(1-a(1-n*2))/2:.5+a((n-.5)*2)/2}},_configElastic=function r(a,n,o){var f=n>=1?n:1,y=(o||(a?.3:.45))/(n<1?n:1),x=y/_2PI*(Math.asin(1/f)||0),b=function(A){return A===1?1:f*Math.pow(2,-10*A)*_sin$1((A-x)*y)+1},_=a==="out"?b:a==="in"?function(S){return 1-b(1-S)}:_easeInOutFromOut(b);return y=_2PI/y,_.config=function(S,A){return r(a,S,A)},_},_configBack=function r(a,n){n===void 0&&(n=1.70158);var o=function(x){return x?--x*x*((n+1)*x+n)+1:0},f=a==="out"?o:a==="in"?function(y){return 1-o(1-y)}:_easeInOutFromOut(o);return f.config=function(y){return r(a,y)},f};_forEachName("Linear,Quad,Cubic,Quart,Quint,Strong",function(r,a){var n=a<5?a+1:a;_insertEase(r+",Power"+(n-1),a?function(o){return Math.pow(o,n)}:function(o){return o},function(o){return 1-Math.pow(1-o,n)},function(o){return o<.5?Math.pow(o*2,n)/2:1-Math.pow((1-o)*2,n)/2})});_easeMap.Linear.easeNone=_easeMap.none=_easeMap.Linear.easeIn;_insertEase("Elastic",_configElastic("in"),_configElastic("out"),_configElastic());(function(r,a){var n=1/a,o=2*n,f=2.5*n,y=function(b){return b<n?r*b*b:b<o?r*Math.pow(b-1.5/a,2)+.75:b<f?r*(b-=2.25/a)*b+.9375:r*Math.pow(b-2.625/a,2)+.984375};_insertEase("Bounce",function(x){return 1-y(1-x)},y)})(7.5625,2.75);_insertEase("Expo",function(r){return Math.pow(2,10*(r-1))*r+r*r*r*r*r*r*(1-r)});_insertEase("Circ",function(r){return-(_sqrt$1(1-r*r)-1)});_insertEase("Sine",function(r){return r===1?1:-_cos$1(r*_HALF_PI)+1});_insertEase("Back",_configBack("in"),_configBack("out"),_configBack());_easeMap.SteppedEase=_easeMap.steps=_globals.SteppedEase={config:function(a,n){a===void 0&&(a=1);var o=1/a,f=a+(n?0:1),y=n?1:0,x=1-_tinyNum;return function(b){return((f*_clamp$1(0,x,b)|0)+y)*o}}};_defaults$1.ease=_easeMap["quad.out"];_forEachName("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(r){return _callbackNames+=r+","+r+"Params,"});var GSCache=function(a,n){this.id=_gsID++,a._gsap=this,this.target=a,this.harness=n,this.get=n?n.get:_getProperty,this.set=n?n.getSetter:_getSetter},Animation=function(){function r(n){this.vars=n,this._delay=+n.delay||0,(this._repeat=n.repeat===1/0?-2:n.repeat||0)&&(this._rDelay=n.repeatDelay||0,this._yoyo=!!n.yoyo||!!n.yoyoEase),this._ts=1,_setDuration(this,+n.duration,1,1),this.data=n.data,_context$2&&(this._ctx=_context$2,_context$2.data.push(this)),_tickerActive||_ticker.wake()}var a=r.prototype;return a.delay=function(o){return o||o===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+o-this._delay),this._delay=o,this):this._delay},a.duration=function(o){return arguments.length?this.totalDuration(this._repeat>0?o+(o+this._rDelay)*this._repeat:o):this.totalDuration()&&this._dur},a.totalDuration=function(o){return arguments.length?(this._dirty=0,_setDuration(this,this._repeat<0?o:(o-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},a.totalTime=function(o,f){if(_wake(),!arguments.length)return this._tTime;var y=this._dp;if(y&&y.smoothChildTiming&&this._ts){for(_alignPlayhead(this,o),!y._dp||y.parent||_postAddChecks(y,this);y&&y.parent;)y.parent._time!==y._start+(y._ts>=0?y._tTime/y._ts:(y.totalDuration()-y._tTime)/-y._ts)&&y.totalTime(y._tTime,!0),y=y.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&o<this._tDur||this._ts<0&&o>0||!this._tDur&&!o)&&_addToTimeline(this._dp,this,this._start-this._delay)}return(this._tTime!==o||!this._dur&&!f||this._initted&&Math.abs(this._zTime)===_tinyNum||!o&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=o),_lazySafeRender(this,o,f)),this},a.time=function(o,f){return arguments.length?this.totalTime(Math.min(this.totalDuration(),o+_elapsedCycleDuration(this))%(this._dur+this._rDelay)||(o?this._dur:0),f):this._time},a.totalProgress=function(o,f){return arguments.length?this.totalTime(this.totalDuration()*o,f):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>=0&&this._initted?1:0},a.progress=function(o,f){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-o:o)+_elapsedCycleDuration(this),f):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},a.iteration=function(o,f){var y=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(o-1)*y,f):this._repeat?_animationCycle(this._tTime,y)+1:1},a.timeScale=function(o,f){if(!arguments.length)return this._rts===-1e-8?0:this._rts;if(this._rts===o)return this;var y=this.parent&&this._ts?_parentToChildTotalTime(this.parent._time,this):this._tTime;return this._rts=+o||0,this._ts=this._ps||o===-1e-8?0:this._rts,this.totalTime(_clamp$1(-Math.abs(this._delay),this.totalDuration(),y),f!==!1),_setEnd(this),_recacheAncestors(this)},a.paused=function(o){return arguments.length?(this._ps!==o&&(this._ps=o,o?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(_wake(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==_tinyNum&&(this._tTime-=_tinyNum)))),this):this._ps},a.startTime=function(o){if(arguments.length){this._start=o;var f=this.parent||this._dp;return f&&(f._sort||!this.parent)&&_addToTimeline(f,this,o-this._delay),this}return this._start},a.endTime=function(o){return this._start+(_isNotFalse(o)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},a.rawTime=function(o){var f=this.parent||this._dp;return f?o&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?_parentToChildTotalTime(f.rawTime(o),this):this._tTime:this._tTime},a.revert=function(o){o===void 0&&(o=_revertConfig);var f=_reverting$1;return _reverting$1=o,_isRevertWorthy(this)&&(this.timeline&&this.timeline.revert(o),this.totalTime(-.01,o.suppressEvents)),this.data!=="nested"&&o.kill!==!1&&this.kill(),_reverting$1=f,this},a.globalTime=function(o){for(var f=this,y=arguments.length?o:f.rawTime();f;)y=f._start+y/(Math.abs(f._ts)||1),f=f._dp;return!this.parent&&this._sat?this._sat.globalTime(o):y},a.repeat=function(o){return arguments.length?(this._repeat=o===1/0?-2:o,_onUpdateTotalDuration(this)):this._repeat===-2?1/0:this._repeat},a.repeatDelay=function(o){if(arguments.length){var f=this._time;return this._rDelay=o,_onUpdateTotalDuration(this),f?this.time(f):this}return this._rDelay},a.yoyo=function(o){return arguments.length?(this._yoyo=o,this):this._yoyo},a.seek=function(o,f){return this.totalTime(_parsePosition$1(this,o),_isNotFalse(f))},a.restart=function(o,f){return this.play().totalTime(o?-this._delay:0,_isNotFalse(f)),this._dur||(this._zTime=-1e-8),this},a.play=function(o,f){return o!=null&&this.seek(o,f),this.reversed(!1).paused(!1)},a.reverse=function(o,f){return o!=null&&this.seek(o||this.totalDuration(),f),this.reversed(!0).paused(!1)},a.pause=function(o,f){return o!=null&&this.seek(o,f),this.paused(!0)},a.resume=function(){return this.paused(!1)},a.reversed=function(o){return arguments.length?(!!o!==this.reversed()&&this.timeScale(-this._rts||(o?-1e-8:0)),this):this._rts<0},a.invalidate=function(){return this._initted=this._act=0,this._zTime=-1e-8,this},a.isActive=function(){var o=this.parent||this._dp,f=this._start,y;return!!(!o||this._ts&&this._initted&&o.isActive()&&(y=o.rawTime(!0))>=f&&y<this.endTime(!0)-_tinyNum)},a.eventCallback=function(o,f,y){var x=this.vars;return arguments.length>1?(f?(x[o]=f,y&&(x[o+"Params"]=y),o==="onUpdate"&&(this._onUpdate=f)):delete x[o],this):x[o]},a.then=function(o){var f=this;return new Promise(function(y){var x=_isFunction$2(o)?o:_passThrough$1,b=function(){var S=f.then;f.then=null,_isFunction$2(x)&&(x=x(f))&&(x.then||x===f)&&(f.then=S),y(x),f.then=S};f._initted&&f.totalProgress()===1&&f._ts>=0||!f._tTime&&f._ts<0?b():f._prom=b})},a.kill=function(){_interrupt(this)},r}();_setDefaults$1(Animation.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-1e-8,_prom:0,_ps:!1,_rts:1});var Timeline=function(r){_inheritsLoose(a,r);function a(o,f){var y;return o===void 0&&(o={}),y=r.call(this,o)||this,y.labels={},y.smoothChildTiming=!!o.smoothChildTiming,y.autoRemoveChildren=!!o.autoRemoveChildren,y._sort=_isNotFalse(o.sortChildren),_globalTimeline&&_addToTimeline(o.parent||_globalTimeline,_assertThisInitialized(y),f),o.reversed&&y.reverse(),o.paused&&y.paused(!0),o.scrollTrigger&&_scrollTrigger(_assertThisInitialized(y),o.scrollTrigger),y}var n=a.prototype;return n.to=function(f,y,x){return _createTweenType(0,arguments,this),this},n.from=function(f,y,x){return _createTweenType(1,arguments,this),this},n.fromTo=function(f,y,x,b){return _createTweenType(2,arguments,this),this},n.set=function(f,y,x){return y.duration=0,y.parent=this,_inheritDefaults(y).repeatDelay||(y.repeat=0),y.immediateRender=!!y.immediateRender,new Tween(f,y,_parsePosition$1(this,x),1),this},n.call=function(f,y,x){return _addToTimeline(this,Tween.delayedCall(0,f,y),x)},n.staggerTo=function(f,y,x,b,_,S,A){return x.duration=y,x.stagger=x.stagger||b,x.onComplete=S,x.onCompleteParams=A,x.parent=this,new Tween(f,x,_parsePosition$1(this,_)),this},n.staggerFrom=function(f,y,x,b,_,S,A){return x.runBackwards=1,_inheritDefaults(x).immediateRender=_isNotFalse(x.immediateRender),this.staggerTo(f,y,x,b,_,S,A)},n.staggerFromTo=function(f,y,x,b,_,S,A,C){return b.startAt=x,_inheritDefaults(b).immediateRender=_isNotFalse(b.immediateRender),this.staggerTo(f,y,b,_,S,A,C)},n.render=function(f,y,x){var b=this._time,_=this._dirty?this.totalDuration():this._tDur,S=this._dur,A=f<=0?0:_roundPrecise(f),C=this._zTime<0!=f<0&&(this._initted||!S),P,T,M,O,I,D,z,k,L,R,F,B;if(this!==_globalTimeline&&A>_&&f>=0&&(A=_),A!==this._tTime||x||C){if(b!==this._time&&S&&(A+=this._time-b,f+=this._time-b),P=A,L=this._start,k=this._ts,D=!k,C&&(S||(b=this._zTime),(f||!y)&&(this._zTime=f)),this._repeat){if(F=this._yoyo,I=S+this._rDelay,this._repeat<-1&&f<0)return this.totalTime(I*100+f,y,x);if(P=_roundPrecise(A%I),A===_?(O=this._repeat,P=S):(R=_roundPrecise(A/I),O=~~R,O&&O===R&&(P=S,O--),P>S&&(P=S)),R=_animationCycle(this._tTime,I),!b&&this._tTime&&R!==O&&this._tTime-R*I-this._dur<=0&&(R=O),F&&O&1&&(P=S-P,B=1),O!==R&&!this._lock){var N=F&&R&1,j=N===(F&&O&1);if(O<R&&(N=!N),b=N?0:A%S?S:A,this._lock=1,this.render(b||(B?0:_roundPrecise(O*I)),y,!S)._lock=0,this._tTime=A,!y&&this.parent&&_callback$1(this,"onRepeat"),this.vars.repeatRefresh&&!B&&(this.invalidate()._lock=1),b&&b!==this._time||D!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(S=this._dur,_=this._tDur,j&&(this._lock=2,b=N?S:-1e-4,this.render(b,!0),this.vars.repeatRefresh&&!B&&this.invalidate()),this._lock=0,!this._ts&&!D)return this;_propagateYoyoEase(this,B)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(z=_findNextPauseTween(this,_roundPrecise(b),_roundPrecise(P)),z&&(A-=P-(P=z._start))),this._tTime=A,this._time=P,this._act=!k,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=f,b=0),!b&&A&&!y&&!R&&(_callback$1(this,"onStart"),this._tTime!==A))return this;if(P>=b&&f>=0)for(T=this._first;T;){if(M=T._next,(T._act||P>=T._start)&&T._ts&&z!==T){if(T.parent!==this)return this.render(f,y,x);if(T.render(T._ts>0?(P-T._start)*T._ts:(T._dirty?T.totalDuration():T._tDur)+(P-T._start)*T._ts,y,x),P!==this._time||!this._ts&&!D){z=0,M&&(A+=this._zTime=-1e-8);break}}T=M}else{T=this._last;for(var G=f<0?f:P;T;){if(M=T._prev,(T._act||G<=T._end)&&T._ts&&z!==T){if(T.parent!==this)return this.render(f,y,x);if(T.render(T._ts>0?(G-T._start)*T._ts:(T._dirty?T.totalDuration():T._tDur)+(G-T._start)*T._ts,y,x||_reverting$1&&_isRevertWorthy(T)),P!==this._time||!this._ts&&!D){z=0,M&&(A+=this._zTime=G?-1e-8:_tinyNum);break}}T=M}}if(z&&!y&&(this.pause(),z.render(P>=b?0:-1e-8)._zTime=P>=b?1:-1,this._ts))return this._start=L,_setEnd(this),this.render(f,y,x);this._onUpdate&&!y&&_callback$1(this,"onUpdate",!0),(A===_&&this._tTime>=this.totalDuration()||!A&&b)&&(L===this._start||Math.abs(k)!==Math.abs(this._ts))&&(this._lock||((f||!S)&&(A===_&&this._ts>0||!A&&this._ts<0)&&_removeFromParent(this,1),!y&&!(f<0&&!b)&&(A||b||!_)&&(_callback$1(this,A===_&&f>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(A<_&&this.timeScale()>0)&&this._prom())))}return this},n.add=function(f,y){var x=this;if(_isNumber$2(y)||(y=_parsePosition$1(this,y,f)),!(f instanceof Animation)){if(_isArray(f))return f.forEach(function(b){return x.add(b,y)}),this;if(_isString$2(f))return this.addLabel(f,y);if(_isFunction$2(f))f=Tween.delayedCall(0,f);else return this}return this!==f?_addToTimeline(this,f,y):this},n.getChildren=function(f,y,x,b){f===void 0&&(f=!0),y===void 0&&(y=!0),x===void 0&&(x=!0),b===void 0&&(b=-1e8);for(var _=[],S=this._first;S;)S._start>=b&&(S instanceof Tween?y&&_.push(S):(x&&_.push(S),f&&_.push.apply(_,S.getChildren(!0,y,x)))),S=S._next;return _},n.getById=function(f){for(var y=this.getChildren(1,1,1),x=y.length;x--;)if(y[x].vars.id===f)return y[x]},n.remove=function(f){return _isString$2(f)?this.removeLabel(f):_isFunction$2(f)?this.killTweensOf(f):(f.parent===this&&_removeLinkedListItem(this,f),f===this._recent&&(this._recent=this._last),_uncache(this))},n.totalTime=function(f,y){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=_roundPrecise(_ticker.time-(this._ts>0?f/this._ts:(this.totalDuration()-f)/-this._ts))),r.prototype.totalTime.call(this,f,y),this._forcing=0,this):this._tTime},n.addLabel=function(f,y){return this.labels[f]=_parsePosition$1(this,y),this},n.removeLabel=function(f){return delete this.labels[f],this},n.addPause=function(f,y,x){var b=Tween.delayedCall(0,y||_emptyFunc,x);return b.data="isPause",this._hasPause=1,_addToTimeline(this,b,_parsePosition$1(this,f))},n.removePause=function(f){var y=this._first;for(f=_parsePosition$1(this,f);y;)y._start===f&&y.data==="isPause"&&_removeFromParent(y),y=y._next},n.killTweensOf=function(f,y,x){for(var b=this.getTweensOf(f,x),_=b.length;_--;)_overwritingTween!==b[_]&&b[_].kill(f,y);return this},n.getTweensOf=function(f,y){for(var x=[],b=toArray(f),_=this._first,S=_isNumber$2(y),A;_;)_ instanceof Tween?_arrayContainsAny(_._targets,b)&&(S?(!_overwritingTween||_._initted&&_._ts)&&_.globalTime(0)<=y&&_.globalTime(_.totalDuration())>y:!y||_.isActive())&&x.push(_):(A=_.getTweensOf(b,y)).length&&x.push.apply(x,A),_=_._next;return x},n.tweenTo=function(f,y){y=y||{};var x=this,b=_parsePosition$1(x,f),_=y,S=_.startAt,A=_.onStart,C=_.onStartParams,P=_.immediateRender,T,M=Tween.to(x,_setDefaults$1({ease:y.ease||"none",lazy:!1,immediateRender:!1,time:b,overwrite:"auto",duration:y.duration||Math.abs((b-(S&&"time"in S?S.time:x._time))/x.timeScale())||_tinyNum,onStart:function(){if(x.pause(),!T){var I=y.duration||Math.abs((b-(S&&"time"in S?S.time:x._time))/x.timeScale());M._dur!==I&&_setDuration(M,I,0,1).render(M._time,!0,!0),T=1}A&&A.apply(M,C||[])}},y));return P?M.render(0):M},n.tweenFromTo=function(f,y,x){return this.tweenTo(y,_setDefaults$1({startAt:{time:_parsePosition$1(this,f)}},x))},n.recent=function(){return this._recent},n.nextLabel=function(f){return f===void 0&&(f=this._time),_getLabelInDirection(this,_parsePosition$1(this,f))},n.previousLabel=function(f){return f===void 0&&(f=this._time),_getLabelInDirection(this,_parsePosition$1(this,f),1)},n.currentLabel=function(f){return arguments.length?this.seek(f,!0):this.previousLabel(this._time+_tinyNum)},n.shiftChildren=function(f,y,x){x===void 0&&(x=0);for(var b=this._first,_=this.labels,S;b;)b._start>=x&&(b._start+=f,b._end+=f),b=b._next;if(y)for(S in _)_[S]>=x&&(_[S]+=f);return _uncache(this)},n.invalidate=function(f){var y=this._first;for(this._lock=0;y;)y.invalidate(f),y=y._next;return r.prototype.invalidate.call(this,f)},n.clear=function(f){f===void 0&&(f=!0);for(var y=this._first,x;y;)x=y._next,this.remove(y),y=x;return this._dp&&(this._time=this._tTime=this._pTime=0),f&&(this.labels={}),_uncache(this)},n.totalDuration=function(f){var y=0,x=this,b=x._last,_=_bigNum$2,S,A,C;if(arguments.length)return x.timeScale((x._repeat<0?x.duration():x.totalDuration())/(x.reversed()?-f:f));if(x._dirty){for(C=x.parent;b;)S=b._prev,b._dirty&&b.totalDuration(),A=b._start,A>_&&x._sort&&b._ts&&!x._lock?(x._lock=1,_addToTimeline(x,b,A-b._delay,1)._lock=0):_=A,A<0&&b._ts&&(y-=A,(!C&&!x._dp||C&&C.smoothChildTiming)&&(x._start+=A/x._ts,x._time-=A,x._tTime-=A),x.shiftChildren(-A,!1,-1/0),_=0),b._end>y&&b._ts&&(y=b._end),b=S;_setDuration(x,x===_globalTimeline&&x._time>y?x._time:y,1,1),x._dirty=0}return x._tDur},a.updateRoot=function(f){if(_globalTimeline._ts&&(_lazySafeRender(_globalTimeline,_parentToChildTotalTime(f,_globalTimeline)),_lastRenderedFrame=_ticker.frame),_ticker.frame>=_nextGCFrame){_nextGCFrame+=_config$1.autoSleep||120;var y=_globalTimeline._first;if((!y||!y._ts)&&_config$1.autoSleep&&_ticker._listeners.length<2){for(;y&&!y._ts;)y=y._next;y||_ticker.sleep()}}},a}(Animation);_setDefaults$1(Timeline.prototype,{_lock:0,_hasPause:0,_forcing:0});var _addComplexStringPropTween=function(a,n,o,f,y,x,b){var _=new PropTween(this._pt,a,n,0,1,_renderComplexString,null,y),S=0,A=0,C,P,T,M,O,I,D,z;for(_.b=o,_.e=f,o+="",f+="",(D=~f.indexOf("random("))&&(f=_replaceRandom(f)),x&&(z=[o,f],x(z,a,n),o=z[0],f=z[1]),P=o.match(_complexStringNumExp)||[];C=_complexStringNumExp.exec(f);)M=C[0],O=f.substring(S,C.index),T?T=(T+1)%5:O.substr(-5)==="rgba("&&(T=1),M!==P[A++]&&(I=parseFloat(P[A-1])||0,_._pt={_next:_._pt,p:O||A===1?O:",",s:I,c:M.charAt(1)==="="?_parseRelative(I,M)-I:parseFloat(M)-I,m:T&&T<4?Math.round:0},S=_complexStringNumExp.lastIndex);return _.c=S<f.length?f.substring(S,f.length):"",_.fp=b,(_relExp.test(f)||D)&&(_.e=0),this._pt=_,_},_addPropTween=function(a,n,o,f,y,x,b,_,S,A){_isFunction$2(f)&&(f=f(y||0,a,x));var C=a[n],P=o!=="get"?o:_isFunction$2(C)?S?a[n.indexOf("set")||!_isFunction$2(a["get"+n.substr(3)])?n:"get"+n.substr(3)](S):a[n]():C,T=_isFunction$2(C)?S?_setterFuncWithParam:_setterFunc:_setterPlain,M;if(_isString$2(f)&&(~f.indexOf("random(")&&(f=_replaceRandom(f)),f.charAt(1)==="="&&(M=_parseRelative(P,f)+(getUnit(P)||0),(M||M===0)&&(f=M))),!A||P!==f||_forceAllPropTweens)return!isNaN(P*f)&&f!==""?(M=new PropTween(this._pt,a,n,+P||0,f-(P||0),typeof C=="boolean"?_renderBoolean:_renderPlain,0,T),S&&(M.fp=S),b&&M.modifier(b,this,a),this._pt=M):(!C&&!(n in a)&&_missingPlugin(n,f),_addComplexStringPropTween.call(this,a,n,P,f,T,_||_config$1.stringFilter,S))},_processVars=function(a,n,o,f,y){if(_isFunction$2(a)&&(a=_parseFuncOrString(a,y,n,o,f)),!_isObject$1(a)||a.style&&a.nodeType||_isArray(a)||_isTypedArray(a))return _isString$2(a)?_parseFuncOrString(a,y,n,o,f):a;var x={},b;for(b in a)x[b]=_parseFuncOrString(a[b],y,n,o,f);return x},_checkPlugin=function(a,n,o,f,y,x){var b,_,S,A;if(_plugins[a]&&(b=new _plugins[a]).init(y,b.rawVars?n[a]:_processVars(n[a],f,y,x,o),o,f,x)!==!1&&(o._pt=_=new PropTween(o._pt,y,a,0,1,b.render,b,0,b.priority),o!==_quickTween))for(S=o._ptLookup[o._targets.indexOf(y)],A=b._props.length;A--;)S[b._props[A]]=_;return b},_overwritingTween,_forceAllPropTweens,_initTween=function r(a,n,o){var f=a.vars,y=f.ease,x=f.startAt,b=f.immediateRender,_=f.lazy,S=f.onUpdate,A=f.runBackwards,C=f.yoyoEase,P=f.keyframes,T=f.autoRevert,M=a._dur,O=a._startAt,I=a._targets,D=a.parent,z=D&&D.data==="nested"?D.vars.targets:I,k=a._overwrite==="auto"&&!_suppressOverwrites$1,L=a.timeline,R,F,B,N,j,G,Y,X,$,te,ee,q,Z;if(L&&(!P||!y)&&(y="none"),a._ease=_parseEase(y,_defaults$1.ease),a._yEase=C?_invertEase(_parseEase(C===!0?y:C,_defaults$1.ease)):0,C&&a._yoyo&&!a._repeat&&(C=a._yEase,a._yEase=a._ease,a._ease=C),a._from=!L&&!!f.runBackwards,!L||P&&!f.stagger){if(X=I[0]?_getCache(I[0]).harness:0,q=X&&f[X.prop],R=_copyExcluding(f,_reservedProps),O&&(O._zTime<0&&O.progress(1),n<0&&A&&b&&!T?O.render(-1,!0):O.revert(A&&M?_revertConfigNoKill:_startAtRevertConfig),O._lazy=0),x){if(_removeFromParent(a._startAt=Tween.set(I,_setDefaults$1({data:"isStart",overwrite:!1,parent:D,immediateRender:!0,lazy:!O&&_isNotFalse(_),startAt:null,delay:0,onUpdate:S&&function(){return _callback$1(a,"onUpdate")},stagger:0},x))),a._startAt._dp=0,a._startAt._sat=a,n<0&&(_reverting$1||!b&&!T)&&a._startAt.revert(_revertConfigNoKill),b&&M&&n<=0&&o<=0){n&&(a._zTime=n);return}}else if(A&&M&&!O){if(n&&(b=!1),B=_setDefaults$1({overwrite:!1,data:"isFromStart",lazy:b&&!O&&_isNotFalse(_),immediateRender:b,stagger:0,parent:D},R),q&&(B[X.prop]=q),_removeFromParent(a._startAt=Tween.set(I,B)),a._startAt._dp=0,a._startAt._sat=a,n<0&&(_reverting$1?a._startAt.revert(_revertConfigNoKill):a._startAt.render(-1,!0)),a._zTime=n,!b)r(a._startAt,_tinyNum,_tinyNum);else if(!n)return}for(a._pt=a._ptCache=0,_=M&&_isNotFalse(_)||_&&!M,F=0;F<I.length;F++){if(j=I[F],Y=j._gsap||_harness(I)[F]._gsap,a._ptLookup[F]=te={},_lazyLookup[Y.id]&&_lazyTweens.length&&_lazyRender(),ee=z===I?F:z.indexOf(j),X&&($=new X).init(j,q||R,a,ee,z)!==!1&&(a._pt=N=new PropTween(a._pt,j,$.name,0,1,$.render,$,0,$.priority),$._props.forEach(function(U){te[U]=N}),$.priority&&(G=1)),!X||q)for(B in R)_plugins[B]&&($=_checkPlugin(B,R,a,ee,j,z))?$.priority&&(G=1):te[B]=N=_addPropTween.call(a,j,B,"get",R[B],ee,z,0,f.stringFilter);a._op&&a._op[F]&&a.kill(j,a._op[F]),k&&a._pt&&(_overwritingTween=a,_globalTimeline.killTweensOf(j,te,a.globalTime(n)),Z=!a.parent,_overwritingTween=0),a._pt&&_&&(_lazyLookup[Y.id]=1)}G&&_sortPropTweensByPriority(a),a._onInit&&a._onInit(a)}a._onUpdate=S,a._initted=(!a._op||a._pt)&&!Z,P&&n<=0&&L.render(_bigNum$2,!0,!0)},_updatePropTweens=function(a,n,o,f,y,x,b,_){var S=(a._pt&&a._ptCache||(a._ptCache={}))[n],A,C,P,T;if(!S)for(S=a._ptCache[n]=[],P=a._ptLookup,T=a._targets.length;T--;){if(A=P[T][n],A&&A.d&&A.d._pt)for(A=A.d._pt;A&&A.p!==n&&A.fp!==n;)A=A._next;if(!A)return _forceAllPropTweens=1,a.vars[n]="+=0",_initTween(a,b),_forceAllPropTweens=0,_?_warn(n+" not eligible for reset"):1;S.push(A)}for(T=S.length;T--;)C=S[T],A=C._pt||C,A.s=(f||f===0)&&!y?f:A.s+(f||0)+x*A.c,A.c=o-A.s,C.e&&(C.e=_round$3(o)+getUnit(C.e)),C.b&&(C.b=A.s+getUnit(C.b))},_addAliasesToVars=function(a,n){var o=a[0]?_getCache(a[0]).harness:0,f=o&&o.aliases,y,x,b,_;if(!f)return n;y=_merge({},n);for(x in f)if(x in y)for(_=f[x].split(","),b=_.length;b--;)y[_[b]]=y[x];return y},_parseKeyframe=function(a,n,o,f){var y=n.ease||f||"power1.inOut",x,b;if(_isArray(n))b=o[a]||(o[a]=[]),n.forEach(function(_,S){return b.push({t:S/(n.length-1)*100,v:_,e:y})});else for(x in n)b=o[x]||(o[x]=[]),x==="ease"||b.push({t:parseFloat(a),v:n[x],e:y})},_parseFuncOrString=function(a,n,o,f,y){return _isFunction$2(a)?a.call(n,o,f,y):_isString$2(a)&&~a.indexOf("random(")?_replaceRandom(a):a},_staggerTweenProps=_callbackNames+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",_staggerPropsToSkip={};_forEachName(_staggerTweenProps+",id,stagger,delay,duration,paused,scrollTrigger",function(r){return _staggerPropsToSkip[r]=1});var Tween=function(r){_inheritsLoose(a,r);function a(o,f,y,x){var b;typeof f=="number"&&(y.duration=f,f=y,y=null),b=r.call(this,x?f:_inheritDefaults(f))||this;var _=b.vars,S=_.duration,A=_.delay,C=_.immediateRender,P=_.stagger,T=_.overwrite,M=_.keyframes,O=_.defaults,I=_.scrollTrigger,D=_.yoyoEase,z=f.parent||_globalTimeline,k=(_isArray(o)||_isTypedArray(o)?_isNumber$2(o[0]):"length"in f)?[o]:toArray(o),L,R,F,B,N,j,G,Y;if(b._targets=k.length?_harness(k):_warn("GSAP target "+o+" not found. https://gsap.com",!_config$1.nullTargetWarn)||[],b._ptLookup=[],b._overwrite=T,M||P||_isFuncOrString(S)||_isFuncOrString(A)){if(f=b.vars,L=b.timeline=new Timeline({data:"nested",defaults:O||{},targets:z&&z.data==="nested"?z.vars.targets:k}),L.kill(),L.parent=L._dp=_assertThisInitialized(b),L._start=0,P||_isFuncOrString(S)||_isFuncOrString(A)){if(B=k.length,G=P&&distribute(P),_isObject$1(P))for(N in P)~_staggerTweenProps.indexOf(N)&&(Y||(Y={}),Y[N]=P[N]);for(R=0;R<B;R++)F=_copyExcluding(f,_staggerPropsToSkip),F.stagger=0,D&&(F.yoyoEase=D),Y&&_merge(F,Y),j=k[R],F.duration=+_parseFuncOrString(S,_assertThisInitialized(b),R,j,k),F.delay=(+_parseFuncOrString(A,_assertThisInitialized(b),R,j,k)||0)-b._delay,!P&&B===1&&F.delay&&(b._delay=A=F.delay,b._start+=A,F.delay=0),L.to(j,F,G?G(R,j,k):0),L._ease=_easeMap.none;L.duration()?S=A=0:b.timeline=0}else if(M){_inheritDefaults(_setDefaults$1(L.vars.defaults,{ease:"none"})),L._ease=_parseEase(M.ease||f.ease||"none");var X=0,$,te,ee;if(_isArray(M))M.forEach(function(q){return L.to(k,q,">")}),L.duration();else{F={};for(N in M)N==="ease"||N==="easeEach"||_parseKeyframe(N,M[N],F,M.easeEach);for(N in F)for($=F[N].sort(function(q,Z){return q.t-Z.t}),X=0,R=0;R<$.length;R++)te=$[R],ee={ease:te.e,duration:(te.t-(R?$[R-1].t:0))/100*S},ee[N]=te.v,L.to(k,ee,X),X+=ee.duration;L.duration()<S&&L.to({},{duration:S-L.duration()})}}S||b.duration(S=L.duration())}else b.timeline=0;return T===!0&&!_suppressOverwrites$1&&(_overwritingTween=_assertThisInitialized(b),_globalTimeline.killTweensOf(k),_overwritingTween=0),_addToTimeline(z,_assertThisInitialized(b),y),f.reversed&&b.reverse(),f.paused&&b.paused(!0),(C||!S&&!M&&b._start===_roundPrecise(z._time)&&_isNotFalse(C)&&_hasNoPausedAncestors(_assertThisInitialized(b))&&z.data!=="nested")&&(b._tTime=-1e-8,b.render(Math.max(0,-A)||0)),I&&_scrollTrigger(_assertThisInitialized(b),I),b}var n=a.prototype;return n.render=function(f,y,x){var b=this._time,_=this._tDur,S=this._dur,A=f<0,C=f>_-_tinyNum&&!A?_:f<_tinyNum?0:f,P,T,M,O,I,D,z,k,L;if(!S)_renderZeroDurationTween(this,f,y,x);else if(C!==this._tTime||!f||x||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==A||this._lazy){if(P=C,k=this.timeline,this._repeat){if(O=S+this._rDelay,this._repeat<-1&&A)return this.totalTime(O*100+f,y,x);if(P=_roundPrecise(C%O),C===_?(M=this._repeat,P=S):(I=_roundPrecise(C/O),M=~~I,M&&M===I?(P=S,M--):P>S&&(P=S)),D=this._yoyo&&M&1,D&&(L=this._yEase,P=S-P),I=_animationCycle(this._tTime,O),P===b&&!x&&this._initted&&M===I)return this._tTime=C,this;M!==I&&(k&&this._yEase&&_propagateYoyoEase(k,D),this.vars.repeatRefresh&&!D&&!this._lock&&P!==O&&this._initted&&(this._lock=x=1,this.render(_roundPrecise(O*M),!0).invalidate()._lock=0))}if(!this._initted){if(_attemptInitTween(this,A?f:P,x,y,C))return this._tTime=0,this;if(b!==this._time&&!(x&&this.vars.repeatRefresh&&M!==I))return this;if(S!==this._dur)return this.render(f,y,x)}if(this._tTime=C,this._time=P,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=z=(L||this._ease)(P/S),this._from&&(this.ratio=z=1-z),!b&&C&&!y&&!I&&(_callback$1(this,"onStart"),this._tTime!==C))return this;for(T=this._pt;T;)T.r(z,T.d),T=T._next;k&&k.render(f<0?f:k._dur*k._ease(P/this._dur),y,x)||this._startAt&&(this._zTime=f),this._onUpdate&&!y&&(A&&_rewindStartAt(this,f,y,x),_callback$1(this,"onUpdate")),this._repeat&&M!==I&&this.vars.onRepeat&&!y&&this.parent&&_callback$1(this,"onRepeat"),(C===this._tDur||!C)&&this._tTime===C&&(A&&!this._onUpdate&&_rewindStartAt(this,f,!0,!0),(f||!S)&&(C===this._tDur&&this._ts>0||!C&&this._ts<0)&&_removeFromParent(this,1),!y&&!(A&&!b)&&(C||b||D)&&(_callback$1(this,C===_?"onComplete":"onReverseComplete",!0),this._prom&&!(C<_&&this.timeScale()>0)&&this._prom()))}return this},n.targets=function(){return this._targets},n.invalidate=function(f){return(!f||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(f),r.prototype.invalidate.call(this,f)},n.resetTo=function(f,y,x,b,_){_tickerActive||_ticker.wake(),this._ts||this.play();var S=Math.min(this._dur,(this._dp._time-this._start)*this._ts),A;return this._initted||_initTween(this,S),A=this._ease(S/this._dur),_updatePropTweens(this,f,y,x,b,A,S,_)?this.resetTo(f,y,x,b,1):(_alignPlayhead(this,0),this.parent||_addLinkedListItem(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},n.kill=function(f,y){if(y===void 0&&(y="all"),!f&&(!y||y==="all"))return this._lazy=this._pt=0,this.parent?_interrupt(this):this.scrollTrigger&&this.scrollTrigger.kill(!!_reverting$1),this;if(this.timeline){var x=this.timeline.totalDuration();return this.timeline.killTweensOf(f,y,_overwritingTween&&_overwritingTween.vars.overwrite!==!0)._first||_interrupt(this),this.parent&&x!==this.timeline.totalDuration()&&_setDuration(this,this._dur*this.timeline._tDur/x,0,1),this}var b=this._targets,_=f?toArray(f):b,S=this._ptLookup,A=this._pt,C,P,T,M,O,I,D;if((!y||y==="all")&&_arraysMatch(b,_))return y==="all"&&(this._pt=0),_interrupt(this);for(C=this._op=this._op||[],y!=="all"&&(_isString$2(y)&&(O={},_forEachName(y,function(z){return O[z]=1}),y=O),y=_addAliasesToVars(b,y)),D=b.length;D--;)if(~_.indexOf(b[D])){P=S[D],y==="all"?(C[D]=y,M=P,T={}):(T=C[D]=C[D]||{},M=y);for(O in M)I=P&&P[O],I&&((!("kill"in I.d)||I.d.kill(O)===!0)&&_removeLinkedListItem(this,I,"_pt"),delete P[O]),T!=="all"&&(T[O]=1)}return this._initted&&!this._pt&&A&&_interrupt(this),this},a.to=function(f,y){return new a(f,y,arguments[2])},a.from=function(f,y){return _createTweenType(1,arguments)},a.delayedCall=function(f,y,x,b){return new a(y,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:f,onComplete:y,onReverseComplete:y,onCompleteParams:x,onReverseCompleteParams:x,callbackScope:b})},a.fromTo=function(f,y,x){return _createTweenType(2,arguments)},a.set=function(f,y){return y.duration=0,y.repeatDelay||(y.repeat=0),new a(f,y)},a.killTweensOf=function(f,y,x){return _globalTimeline.killTweensOf(f,y,x)},a}(Animation);_setDefaults$1(Tween.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});_forEachName("staggerTo,staggerFrom,staggerFromTo",function(r){Tween[r]=function(){var a=new Timeline,n=_slice.call(arguments,0);return n.splice(r==="staggerFromTo"?5:4,0,0),a[r].apply(a,n)}});var _setterPlain=function(a,n,o){return a[n]=o},_setterFunc=function(a,n,o){return a[n](o)},_setterFuncWithParam=function(a,n,o,f){return a[n](f.fp,o)},_setterAttribute=function(a,n,o){return a.setAttribute(n,o)},_getSetter=function(a,n){return _isFunction$2(a[n])?_setterFunc:_isUndefined(a[n])&&a.setAttribute?_setterAttribute:_setterPlain},_renderPlain=function(a,n){return n.set(n.t,n.p,Math.round((n.s+n.c*a)*1e6)/1e6,n)},_renderBoolean=function(a,n){return n.set(n.t,n.p,!!(n.s+n.c*a),n)},_renderComplexString=function(a,n){var o=n._pt,f="";if(!a&&n.b)f=n.b;else if(a===1&&n.e)f=n.e;else{for(;o;)f=o.p+(o.m?o.m(o.s+o.c*a):Math.round((o.s+o.c*a)*1e4)/1e4)+f,o=o._next;f+=n.c}n.set(n.t,n.p,f,n)},_renderPropTweens=function(a,n){for(var o=n._pt;o;)o.r(a,o.d),o=o._next},_addPluginModifier=function(a,n,o,f){for(var y=this._pt,x;y;)x=y._next,y.p===f&&y.modifier(a,n,o),y=x},_killPropTweensOf=function(a){for(var n=this._pt,o,f;n;)f=n._next,n.p===a&&!n.op||n.op===a?_removeLinkedListItem(this,n,"_pt"):n.dep||(o=1),n=f;return!o},_setterWithModifier=function(a,n,o,f){f.mSet(a,n,f.m.call(f.tween,o,f.mt),f)},_sortPropTweensByPriority=function(a){for(var n=a._pt,o,f,y,x;n;){for(o=n._next,f=y;f&&f.pr>n.pr;)f=f._next;(n._prev=f?f._prev:x)?n._prev._next=n:y=n,(n._next=f)?f._prev=n:x=n,n=o}a._pt=y},PropTween=function(){function r(n,o,f,y,x,b,_,S,A){this.t=o,this.s=y,this.c=x,this.p=f,this.r=b||_renderPlain,this.d=_||this,this.set=S||_setterPlain,this.pr=A||0,this._next=n,n&&(n._prev=this)}var a=r.prototype;return a.modifier=function(o,f,y){this.mSet=this.mSet||this.set,this.set=_setterWithModifier,this.m=o,this.mt=y,this.tween=f},r}();_forEachName(_callbackNames+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(r){return _reservedProps[r]=1});_globals.TweenMax=_globals.TweenLite=Tween;_globals.TimelineLite=_globals.TimelineMax=Timeline;_globalTimeline=new Timeline({sortChildren:!1,defaults:_defaults$1,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});_config$1.stringFilter=_colorStringFilter;var _media=[],_listeners$1={},_emptyArray$1=[],_lastMediaTime=0,_contextID=0,_dispatch$1=function(a){return(_listeners$1[a]||_emptyArray$1).map(function(n){return n()})},_onMediaChange=function(){var a=Date.now(),n=[];a-_lastMediaTime>2&&(_dispatch$1("matchMediaInit"),_media.forEach(function(o){var f=o.queries,y=o.conditions,x,b,_,S;for(b in f)x=_win$3.matchMedia(f[b]).matches,x&&(_=1),x!==y[b]&&(y[b]=x,S=1);S&&(o.revert(),_&&n.push(o))}),_dispatch$1("matchMediaRevert"),n.forEach(function(o){return o.onMatch(o,function(f){return o.add(null,f)})}),_lastMediaTime=a,_dispatch$1("matchMedia"))},Context=function(){function r(n,o){this.selector=o&&selector(o),this.data=[],this._r=[],this.isReverted=!1,this.id=_contextID++,n&&this.add(n)}var a=r.prototype;return a.add=function(o,f,y){_isFunction$2(o)&&(y=f,f=o,o=_isFunction$2);var x=this,b=function(){var S=_context$2,A=x.selector,C;return S&&S!==x&&S.data.push(x),y&&(x.selector=selector(y)),_context$2=x,C=f.apply(x,arguments),_isFunction$2(C)&&x._r.push(C),_context$2=S,x.selector=A,x.isReverted=!1,C};return x.last=b,o===_isFunction$2?b(x,function(_){return x.add(null,_)}):o?x[o]=b:b},a.ignore=function(o){var f=_context$2;_context$2=null,o(this),_context$2=f},a.getTweens=function(){var o=[];return this.data.forEach(function(f){return f instanceof r?o.push.apply(o,f.getTweens()):f instanceof Tween&&!(f.parent&&f.parent.data==="nested")&&o.push(f)}),o},a.clear=function(){this._r.length=this.data.length=0},a.kill=function(o,f){var y=this;if(o?function(){for(var b=y.getTweens(),_=y.data.length,S;_--;)S=y.data[_],S.data==="isFlip"&&(S.revert(),S.getChildren(!0,!0,!1).forEach(function(A){return b.splice(b.indexOf(A),1)}));for(b.map(function(A){return{g:A._dur||A._delay||A._sat&&!A._sat.vars.immediateRender?A.globalTime(0):-1/0,t:A}}).sort(function(A,C){return C.g-A.g||-1/0}).forEach(function(A){return A.t.revert(o)}),_=y.data.length;_--;)S=y.data[_],S instanceof Timeline?S.data!=="nested"&&(S.scrollTrigger&&S.scrollTrigger.revert(),S.kill()):!(S instanceof Tween)&&S.revert&&S.revert(o);y._r.forEach(function(A){return A(o,y)}),y.isReverted=!0}():this.data.forEach(function(b){return b.kill&&b.kill()}),this.clear(),f)for(var x=_media.length;x--;)_media[x].id===this.id&&_media.splice(x,1)},a.revert=function(o){this.kill(o||{})},r}(),MatchMedia=function(){function r(n){this.contexts=[],this.scope=n,_context$2&&_context$2.data.push(this)}var a=r.prototype;return a.add=function(o,f,y){_isObject$1(o)||(o={matches:o});var x=new Context(0,y||this.scope),b=x.conditions={},_,S,A;_context$2&&!x.selector&&(x.selector=_context$2.selector),this.contexts.push(x),f=x.add("onMatch",f),x.queries=o;for(S in o)S==="all"?A=1:(_=_win$3.matchMedia(o[S]),_&&(_media.indexOf(x)<0&&_media.push(x),(b[S]=_.matches)&&(A=1),_.addListener?_.addListener(_onMediaChange):_.addEventListener("change",_onMediaChange)));return A&&f(x,function(C){return x.add(null,C)}),this},a.revert=function(o){this.kill(o||{})},a.kill=function(o){this.contexts.forEach(function(f){return f.kill(o,!0)})},r}(),_gsap={registerPlugin:function(){for(var a=arguments.length,n=new Array(a),o=0;o<a;o++)n[o]=arguments[o];n.forEach(function(f){return _createPlugin(f)})},timeline:function(a){return new Timeline(a)},getTweensOf:function(a,n){return _globalTimeline.getTweensOf(a,n)},getProperty:function(a,n,o,f){_isString$2(a)&&(a=toArray(a)[0]);var y=_getCache(a||{}).get,x=o?_passThrough$1:_numericIfPossible;return o==="native"&&(o=""),a&&(n?x((_plugins[n]&&_plugins[n].get||y)(a,n,o,f)):function(b,_,S){return x((_plugins[b]&&_plugins[b].get||y)(a,b,_,S))})},quickSetter:function(a,n,o){if(a=toArray(a),a.length>1){var f=a.map(function(A){return gsap$4.quickSetter(A,n,o)}),y=f.length;return function(A){for(var C=y;C--;)f[C](A)}}a=a[0]||{};var x=_plugins[n],b=_getCache(a),_=b.harness&&(b.harness.aliases||{})[n]||n,S=x?function(A){var C=new x;_quickTween._pt=0,C.init(a,o?A+o:A,_quickTween,0,[a]),C.render(1,C),_quickTween._pt&&_renderPropTweens(1,_quickTween)}:b.set(a,_);return x?S:function(A){return S(a,_,o?A+o:A,b,1)}},quickTo:function(a,n,o){var f,y=gsap$4.to(a,_setDefaults$1((f={},f[n]="+=0.1",f.paused=!0,f.stagger=0,f),o||{})),x=function(_,S,A){return y.resetTo(n,_,S,A)};return x.tween=y,x},isTweening:function(a){return _globalTimeline.getTweensOf(a,!0).length>0},defaults:function(a){return a&&a.ease&&(a.ease=_parseEase(a.ease,_defaults$1.ease)),_mergeDeep(_defaults$1,a||{})},config:function(a){return _mergeDeep(_config$1,a||{})},registerEffect:function(a){var n=a.name,o=a.effect,f=a.plugins,y=a.defaults,x=a.extendTimeline;(f||"").split(",").forEach(function(b){return b&&!_plugins[b]&&!_globals[b]&&_warn(n+" effect requires "+b+" plugin.")}),_effects[n]=function(b,_,S){return o(toArray(b),_setDefaults$1(_||{},y),S)},x&&(Timeline.prototype[n]=function(b,_,S){return this.add(_effects[n](b,_isObject$1(_)?_:(S=_)&&{},this),S)})},registerEase:function(a,n){_easeMap[a]=_parseEase(n)},parseEase:function(a,n){return arguments.length?_parseEase(a,n):_easeMap},getById:function(a){return _globalTimeline.getById(a)},exportRoot:function(a,n){a===void 0&&(a={});var o=new Timeline(a),f,y;for(o.smoothChildTiming=_isNotFalse(a.smoothChildTiming),_globalTimeline.remove(o),o._dp=0,o._time=o._tTime=_globalTimeline._time,f=_globalTimeline._first;f;)y=f._next,(n||!(!f._dur&&f instanceof Tween&&f.vars.onComplete===f._targets[0]))&&_addToTimeline(o,f,f._start-f._delay),f=y;return _addToTimeline(_globalTimeline,o,0),o},context:function(a,n){return a?new Context(a,n):_context$2},matchMedia:function(a){return new MatchMedia(a)},matchMediaRefresh:function(){return _media.forEach(function(a){var n=a.conditions,o,f;for(f in n)n[f]&&(n[f]=!1,o=1);o&&a.revert()})||_onMediaChange()},addEventListener:function(a,n){var o=_listeners$1[a]||(_listeners$1[a]=[]);~o.indexOf(n)||o.push(n)},removeEventListener:function(a,n){var o=_listeners$1[a],f=o&&o.indexOf(n);f>=0&&o.splice(f,1)},utils:{wrap,wrapYoyo,distribute,random,snap,normalize,getUnit,clamp,splitColor,toArray,selector,mapRange,pipe,unitize,interpolate,shuffle},install:_install,effects:_effects,ticker:_ticker,updateRoot:Timeline.updateRoot,plugins:_plugins,globalTimeline:_globalTimeline,core:{PropTween,globals:_addGlobal,Tween,Timeline,Animation,getCache:_getCache,_removeLinkedListItem,reverting:function(){return _reverting$1},context:function(a){return a&&_context$2&&(_context$2.data.push(a),a._ctx=_context$2),_context$2},suppressOverwrites:function(a){return _suppressOverwrites$1=a}}};_forEachName("to,from,fromTo,delayedCall,set,killTweensOf",function(r){return _gsap[r]=Tween[r]});_ticker.add(Timeline.updateRoot);_quickTween=_gsap.to({},{duration:0});var _getPluginPropTween=function(a,n){for(var o=a._pt;o&&o.p!==n&&o.op!==n&&o.fp!==n;)o=o._next;return o},_addModifiers=function(a,n){var o=a._targets,f,y,x;for(f in n)for(y=o.length;y--;)x=a._ptLookup[y][f],x&&(x=x.d)&&(x._pt&&(x=_getPluginPropTween(x,f)),x&&x.modifier&&x.modifier(n[f],a,o[y],f))},_buildModifierPlugin=function(a,n){return{name:a,headless:1,rawVars:1,init:function(f,y,x){x._onInit=function(b){var _,S;if(_isString$2(y)&&(_={},_forEachName(y,function(A){return _[A]=1}),y=_),n){_={};for(S in y)_[S]=n(y[S]);y=_}_addModifiers(b,y)}}}},gsap$4=_gsap.registerPlugin({name:"attr",init:function(a,n,o,f,y){var x,b,_;this.tween=o;for(x in n)_=a.getAttribute(x)||"",b=this.add(a,"setAttribute",(_||0)+"",n[x],f,y,0,0,x),b.op=x,b.b=_,this._props.push(x)},render:function(a,n){for(var o=n._pt;o;)_reverting$1?o.set(o.t,o.p,o.b,o):o.r(a,o.d),o=o._next}},{name:"endArray",headless:1,init:function(a,n){for(var o=n.length;o--;)this.add(a,o,a[o]||0,n[o],0,0,0,0,0,1)}},_buildModifierPlugin("roundProps",_roundModifier),_buildModifierPlugin("modifiers"),_buildModifierPlugin("snap",snap))||_gsap;Tween.version=Timeline.version=gsap$4.version="3.13.0";_coreReady=1;_windowExists$3()&&_wake();_easeMap.Power0;_easeMap.Power1;_easeMap.Power2;_easeMap.Power3;_easeMap.Power4;_easeMap.Linear;_easeMap.Quad;_easeMap.Cubic;_easeMap.Quart;_easeMap.Quint;_easeMap.Strong;_easeMap.Elastic;_easeMap.Back;_easeMap.SteppedEase;_easeMap.Bounce;_easeMap.Sine;_easeMap.Expo;_easeMap.Circ;/*!
 * CSSPlugin 3.13.0
 * https://gsap.com
 *
 * Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var _win$2,_doc$2,_docElement,_pluginInitted,_tempDiv,_recentSetterPlugin,_reverting,_windowExists$2=function(){return typeof window<"u"},_transformProps={},_RAD2DEG=180/Math.PI,_DEG2RAD$1=Math.PI/180,_atan2=Math.atan2,_bigNum$1=1e8,_capsExp$1=/([A-Z])/g,_horizontalExp=/(left|right|width|margin|padding|x)/i,_complexExp=/[\s,\(]\S/,_propertyAliases={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},_renderCSSProp=function(a,n){return n.set(n.t,n.p,Math.round((n.s+n.c*a)*1e4)/1e4+n.u,n)},_renderPropWithEnd=function(a,n){return n.set(n.t,n.p,a===1?n.e:Math.round((n.s+n.c*a)*1e4)/1e4+n.u,n)},_renderCSSPropWithBeginning=function(a,n){return n.set(n.t,n.p,a?Math.round((n.s+n.c*a)*1e4)/1e4+n.u:n.b,n)},_renderRoundedCSSProp=function(a,n){var o=n.s+n.c*a;n.set(n.t,n.p,~~(o+(o<0?-.5:.5))+n.u,n)},_renderNonTweeningValue=function(a,n){return n.set(n.t,n.p,a?n.e:n.b,n)},_renderNonTweeningValueOnlyAtEnd=function(a,n){return n.set(n.t,n.p,a!==1?n.b:n.e,n)},_setterCSSStyle=function(a,n,o){return a.style[n]=o},_setterCSSProp=function(a,n,o){return a.style.setProperty(n,o)},_setterTransform=function(a,n,o){return a._gsap[n]=o},_setterScale=function(a,n,o){return a._gsap.scaleX=a._gsap.scaleY=o},_setterScaleWithRender=function(a,n,o,f,y){var x=a._gsap;x.scaleX=x.scaleY=o,x.renderTransform(y,x)},_setterTransformWithRender=function(a,n,o,f,y){var x=a._gsap;x[n]=o,x.renderTransform(y,x)},_transformProp$1="transform",_transformOriginProp=_transformProp$1+"Origin",_saveStyle=function r(a,n){var o=this,f=this.target,y=f.style,x=f._gsap;if(a in _transformProps&&y){if(this.tfm=this.tfm||{},a!=="transform")a=_propertyAliases[a]||a,~a.indexOf(",")?a.split(",").forEach(function(b){return o.tfm[b]=_get(f,b)}):this.tfm[a]=x.x?x[a]:_get(f,a),a===_transformOriginProp&&(this.tfm.zOrigin=x.zOrigin);else return _propertyAliases.transform.split(",").forEach(function(b){return r.call(o,b,n)});if(this.props.indexOf(_transformProp$1)>=0)return;x.svg&&(this.svgo=f.getAttribute("data-svg-origin"),this.props.push(_transformOriginProp,n,"")),a=_transformProp$1}(y||n)&&this.props.push(a,n,y[a])},_removeIndependentTransforms=function(a){a.translate&&(a.removeProperty("translate"),a.removeProperty("scale"),a.removeProperty("rotate"))},_revertStyle=function(){var a=this.props,n=this.target,o=n.style,f=n._gsap,y,x;for(y=0;y<a.length;y+=3)a[y+1]?a[y+1]===2?n[a[y]](a[y+2]):n[a[y]]=a[y+2]:a[y+2]?o[a[y]]=a[y+2]:o.removeProperty(a[y].substr(0,2)==="--"?a[y]:a[y].replace(_capsExp$1,"-$1").toLowerCase());if(this.tfm){for(x in this.tfm)f[x]=this.tfm[x];f.svg&&(f.renderTransform(),n.setAttribute("data-svg-origin",this.svgo||"")),y=_reverting(),(!y||!y.isStart)&&!o[_transformProp$1]&&(_removeIndependentTransforms(o),f.zOrigin&&o[_transformOriginProp]&&(o[_transformOriginProp]+=" "+f.zOrigin+"px",f.zOrigin=0,f.renderTransform()),f.uncache=1)}},_getStyleSaver=function(a,n){var o={target:a,props:[],revert:_revertStyle,save:_saveStyle};return a._gsap||gsap$4.core.getCache(a),n&&a.style&&a.nodeType&&n.split(",").forEach(function(f){return o.save(f)}),o},_supports3D,_createElement=function(a,n){var o=_doc$2.createElementNS?_doc$2.createElementNS((n||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),a):_doc$2.createElement(a);return o&&o.style?o:_doc$2.createElement(a)},_getComputedProperty=function r(a,n,o){var f=getComputedStyle(a);return f[n]||f.getPropertyValue(n.replace(_capsExp$1,"-$1").toLowerCase())||f.getPropertyValue(n)||!o&&r(a,_checkPropPrefix(n)||n,1)||""},_prefixes="O,Moz,ms,Ms,Webkit".split(","),_checkPropPrefix=function(a,n,o){var f=n||_tempDiv,y=f.style,x=5;if(a in y&&!o)return a;for(a=a.charAt(0).toUpperCase()+a.substr(1);x--&&!(_prefixes[x]+a in y););return x<0?null:(x===3?"ms":x>=0?_prefixes[x]:"")+a},_initCore$3=function(){_windowExists$2()&&window.document&&(_win$2=window,_doc$2=_win$2.document,_docElement=_doc$2.documentElement,_tempDiv=_createElement("div")||{style:{}},_createElement("div"),_transformProp$1=_checkPropPrefix(_transformProp$1),_transformOriginProp=_transformProp$1+"Origin",_tempDiv.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",_supports3D=!!_checkPropPrefix("perspective"),_reverting=gsap$4.core.reverting,_pluginInitted=1)},_getReparentedCloneBBox=function(a){var n=a.ownerSVGElement,o=_createElement("svg",n&&n.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),f=a.cloneNode(!0),y;f.style.display="block",o.appendChild(f),_docElement.appendChild(o);try{y=f.getBBox()}catch{}return o.removeChild(f),_docElement.removeChild(o),y},_getAttributeFallbacks=function(a,n){for(var o=n.length;o--;)if(a.hasAttribute(n[o]))return a.getAttribute(n[o])},_getBBox=function(a){var n,o;try{n=a.getBBox()}catch{n=_getReparentedCloneBBox(a),o=1}return n&&(n.width||n.height)||o||(n=_getReparentedCloneBBox(a)),n&&!n.width&&!n.x&&!n.y?{x:+_getAttributeFallbacks(a,["x","cx","x1"])||0,y:+_getAttributeFallbacks(a,["y","cy","y1"])||0,width:0,height:0}:n},_isSVG=function(a){return!!(a.getCTM&&(!a.parentNode||a.ownerSVGElement)&&_getBBox(a))},_removeProperty=function(a,n){if(n){var o=a.style,f;n in _transformProps&&n!==_transformOriginProp&&(n=_transformProp$1),o.removeProperty?(f=n.substr(0,2),(f==="ms"||n.substr(0,6)==="webkit")&&(n="-"+n),o.removeProperty(f==="--"?n:n.replace(_capsExp$1,"-$1").toLowerCase())):o.removeAttribute(n)}},_addNonTweeningPT=function(a,n,o,f,y,x){var b=new PropTween(a._pt,n,o,0,1,x?_renderNonTweeningValueOnlyAtEnd:_renderNonTweeningValue);return a._pt=b,b.b=f,b.e=y,a._props.push(o),b},_nonConvertibleUnits={deg:1,rad:1,turn:1},_nonStandardLayouts={grid:1,flex:1},_convertToUnit=function r(a,n,o,f){var y=parseFloat(o)||0,x=(o+"").trim().substr((y+"").length)||"px",b=_tempDiv.style,_=_horizontalExp.test(n),S=a.tagName.toLowerCase()==="svg",A=(S?"client":"offset")+(_?"Width":"Height"),C=100,P=f==="px",T=f==="%",M,O,I,D;if(f===x||!y||_nonConvertibleUnits[f]||_nonConvertibleUnits[x])return y;if(x!=="px"&&!P&&(y=r(a,n,o,"px")),D=a.getCTM&&_isSVG(a),(T||x==="%")&&(_transformProps[n]||~n.indexOf("adius")))return M=D?a.getBBox()[_?"width":"height"]:a[A],_round$3(T?y/M*C:y/100*M);if(b[_?"width":"height"]=C+(P?x:f),O=f!=="rem"&&~n.indexOf("adius")||f==="em"&&a.appendChild&&!S?a:a.parentNode,D&&(O=(a.ownerSVGElement||{}).parentNode),(!O||O===_doc$2||!O.appendChild)&&(O=_doc$2.body),I=O._gsap,I&&T&&I.width&&_&&I.time===_ticker.time&&!I.uncache)return _round$3(y/I.width*C);if(T&&(n==="height"||n==="width")){var z=a.style[n];a.style[n]=C+f,M=a[A],z?a.style[n]=z:_removeProperty(a,n)}else(T||x==="%")&&!_nonStandardLayouts[_getComputedProperty(O,"display")]&&(b.position=_getComputedProperty(a,"position")),O===a&&(b.position="static"),O.appendChild(_tempDiv),M=_tempDiv[A],O.removeChild(_tempDiv),b.position="absolute";return _&&T&&(I=_getCache(O),I.time=_ticker.time,I.width=O[A]),_round$3(P?M*y/C:M&&y?C/M*y:0)},_get=function(a,n,o,f){var y;return _pluginInitted||_initCore$3(),n in _propertyAliases&&n!=="transform"&&(n=_propertyAliases[n],~n.indexOf(",")&&(n=n.split(",")[0])),_transformProps[n]&&n!=="transform"?(y=_parseTransform(a,f),y=n!=="transformOrigin"?y[n]:y.svg?y.origin:_firstTwoOnly(_getComputedProperty(a,_transformOriginProp))+" "+y.zOrigin+"px"):(y=a.style[n],(!y||y==="auto"||f||~(y+"").indexOf("calc("))&&(y=_specialProps[n]&&_specialProps[n](a,n,o)||_getComputedProperty(a,n)||_getProperty(a,n)||(n==="opacity"?1:0))),o&&!~(y+"").trim().indexOf(" ")?_convertToUnit(a,n,y,o)+o:y},_tweenComplexCSSString=function(a,n,o,f){if(!o||o==="none"){var y=_checkPropPrefix(n,a,1),x=y&&_getComputedProperty(a,y,1);x&&x!==o?(n=y,o=x):n==="borderColor"&&(o=_getComputedProperty(a,"borderTopColor"))}var b=new PropTween(this._pt,a.style,n,0,1,_renderComplexString),_=0,S=0,A,C,P,T,M,O,I,D,z,k,L,R;if(b.b=o,b.e=f,o+="",f+="",f.substring(0,6)==="var(--"&&(f=_getComputedProperty(a,f.substring(4,f.indexOf(")")))),f==="auto"&&(O=a.style[n],a.style[n]=f,f=_getComputedProperty(a,n)||f,O?a.style[n]=O:_removeProperty(a,n)),A=[o,f],_colorStringFilter(A),o=A[0],f=A[1],P=o.match(_numWithUnitExp)||[],R=f.match(_numWithUnitExp)||[],R.length){for(;C=_numWithUnitExp.exec(f);)I=C[0],z=f.substring(_,C.index),M?M=(M+1)%5:(z.substr(-5)==="rgba("||z.substr(-5)==="hsla(")&&(M=1),I!==(O=P[S++]||"")&&(T=parseFloat(O)||0,L=O.substr((T+"").length),I.charAt(1)==="="&&(I=_parseRelative(T,I)+L),D=parseFloat(I),k=I.substr((D+"").length),_=_numWithUnitExp.lastIndex-k.length,k||(k=k||_config$1.units[n]||L,_===f.length&&(f+=k,b.e+=k)),L!==k&&(T=_convertToUnit(a,n,O,k)||0),b._pt={_next:b._pt,p:z||S===1?z:",",s:T,c:D-T,m:M&&M<4||n==="zIndex"?Math.round:0});b.c=_<f.length?f.substring(_,f.length):""}else b.r=n==="display"&&f==="none"?_renderNonTweeningValueOnlyAtEnd:_renderNonTweeningValue;return _relExp.test(f)&&(b.e=0),this._pt=b,b},_keywordToPercent={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},_convertKeywordsToPercentages=function(a){var n=a.split(" "),o=n[0],f=n[1]||"50%";return(o==="top"||o==="bottom"||f==="left"||f==="right")&&(a=o,o=f,f=a),n[0]=_keywordToPercent[o]||o,n[1]=_keywordToPercent[f]||f,n.join(" ")},_renderClearProps=function(a,n){if(n.tween&&n.tween._time===n.tween._dur){var o=n.t,f=o.style,y=n.u,x=o._gsap,b,_,S;if(y==="all"||y===!0)f.cssText="",_=1;else for(y=y.split(","),S=y.length;--S>-1;)b=y[S],_transformProps[b]&&(_=1,b=b==="transformOrigin"?_transformOriginProp:_transformProp$1),_removeProperty(o,b);_&&(_removeProperty(o,_transformProp$1),x&&(x.svg&&o.removeAttribute("transform"),f.scale=f.rotate=f.translate="none",_parseTransform(o,1),x.uncache=1,_removeIndependentTransforms(f)))}},_specialProps={clearProps:function(a,n,o,f,y){if(y.data!=="isFromStart"){var x=a._pt=new PropTween(a._pt,n,o,0,0,_renderClearProps);return x.u=f,x.pr=-10,x.tween=y,a._props.push(o),1}}},_identity2DMatrix=[1,0,0,1,0,0],_rotationalProperties={},_isNullTransform=function(a){return a==="matrix(1, 0, 0, 1, 0, 0)"||a==="none"||!a},_getComputedTransformMatrixAsArray=function(a){var n=_getComputedProperty(a,_transformProp$1);return _isNullTransform(n)?_identity2DMatrix:n.substr(7).match(_numExp$1).map(_round$3)},_getMatrix=function(a,n){var o=a._gsap||_getCache(a),f=a.style,y=_getComputedTransformMatrixAsArray(a),x,b,_,S;return o.svg&&a.getAttribute("transform")?(_=a.transform.baseVal.consolidate().matrix,y=[_.a,_.b,_.c,_.d,_.e,_.f],y.join(",")==="1,0,0,1,0,0"?_identity2DMatrix:y):(y===_identity2DMatrix&&!a.offsetParent&&a!==_docElement&&!o.svg&&(_=f.display,f.display="block",x=a.parentNode,(!x||!a.offsetParent&&!a.getBoundingClientRect().width)&&(S=1,b=a.nextElementSibling,_docElement.appendChild(a)),y=_getComputedTransformMatrixAsArray(a),_?f.display=_:_removeProperty(a,"display"),S&&(b?x.insertBefore(a,b):x?x.appendChild(a):_docElement.removeChild(a))),n&&y.length>6?[y[0],y[1],y[4],y[5],y[12],y[13]]:y)},_applySVGOrigin=function(a,n,o,f,y,x){var b=a._gsap,_=y||_getMatrix(a,!0),S=b.xOrigin||0,A=b.yOrigin||0,C=b.xOffset||0,P=b.yOffset||0,T=_[0],M=_[1],O=_[2],I=_[3],D=_[4],z=_[5],k=n.split(" "),L=parseFloat(k[0])||0,R=parseFloat(k[1])||0,F,B,N,j;o?_!==_identity2DMatrix&&(B=T*I-M*O)&&(N=L*(I/B)+R*(-O/B)+(O*z-I*D)/B,j=L*(-M/B)+R*(T/B)-(T*z-M*D)/B,L=N,R=j):(F=_getBBox(a),L=F.x+(~k[0].indexOf("%")?L/100*F.width:L),R=F.y+(~(k[1]||k[0]).indexOf("%")?R/100*F.height:R)),f||f!==!1&&b.smooth?(D=L-S,z=R-A,b.xOffset=C+(D*T+z*O)-D,b.yOffset=P+(D*M+z*I)-z):b.xOffset=b.yOffset=0,b.xOrigin=L,b.yOrigin=R,b.smooth=!!f,b.origin=n,b.originIsAbsolute=!!o,a.style[_transformOriginProp]="0px 0px",x&&(_addNonTweeningPT(x,b,"xOrigin",S,L),_addNonTweeningPT(x,b,"yOrigin",A,R),_addNonTweeningPT(x,b,"xOffset",C,b.xOffset),_addNonTweeningPT(x,b,"yOffset",P,b.yOffset)),a.setAttribute("data-svg-origin",L+" "+R)},_parseTransform=function(a,n){var o=a._gsap||new GSCache(a);if("x"in o&&!n&&!o.uncache)return o;var f=a.style,y=o.scaleX<0,x="px",b="deg",_=getComputedStyle(a),S=_getComputedProperty(a,_transformOriginProp)||"0",A,C,P,T,M,O,I,D,z,k,L,R,F,B,N,j,G,Y,X,$,te,ee,q,Z,U,W,H,K,le,me,ne,pe;return A=C=P=O=I=D=z=k=L=0,T=M=1,o.svg=!!(a.getCTM&&_isSVG(a)),_.translate&&((_.translate!=="none"||_.scale!=="none"||_.rotate!=="none")&&(f[_transformProp$1]=(_.translate!=="none"?"translate3d("+(_.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(_.rotate!=="none"?"rotate("+_.rotate+") ":"")+(_.scale!=="none"?"scale("+_.scale.split(" ").join(",")+") ":"")+(_[_transformProp$1]!=="none"?_[_transformProp$1]:"")),f.scale=f.rotate=f.translate="none"),B=_getMatrix(a,o.svg),o.svg&&(o.uncache?(U=a.getBBox(),S=o.xOrigin-U.x+"px "+(o.yOrigin-U.y)+"px",Z=""):Z=!n&&a.getAttribute("data-svg-origin"),_applySVGOrigin(a,Z||S,!!Z||o.originIsAbsolute,o.smooth!==!1,B)),R=o.xOrigin||0,F=o.yOrigin||0,B!==_identity2DMatrix&&(Y=B[0],X=B[1],$=B[2],te=B[3],A=ee=B[4],C=q=B[5],B.length===6?(T=Math.sqrt(Y*Y+X*X),M=Math.sqrt(te*te+$*$),O=Y||X?_atan2(X,Y)*_RAD2DEG:0,z=$||te?_atan2($,te)*_RAD2DEG+O:0,z&&(M*=Math.abs(Math.cos(z*_DEG2RAD$1))),o.svg&&(A-=R-(R*Y+F*$),C-=F-(R*X+F*te))):(pe=B[6],me=B[7],H=B[8],K=B[9],le=B[10],ne=B[11],A=B[12],C=B[13],P=B[14],N=_atan2(pe,le),I=N*_RAD2DEG,N&&(j=Math.cos(-N),G=Math.sin(-N),Z=ee*j+H*G,U=q*j+K*G,W=pe*j+le*G,H=ee*-G+H*j,K=q*-G+K*j,le=pe*-G+le*j,ne=me*-G+ne*j,ee=Z,q=U,pe=W),N=_atan2(-$,le),D=N*_RAD2DEG,N&&(j=Math.cos(-N),G=Math.sin(-N),Z=Y*j-H*G,U=X*j-K*G,W=$*j-le*G,ne=te*G+ne*j,Y=Z,X=U,$=W),N=_atan2(X,Y),O=N*_RAD2DEG,N&&(j=Math.cos(N),G=Math.sin(N),Z=Y*j+X*G,U=ee*j+q*G,X=X*j-Y*G,q=q*j-ee*G,Y=Z,ee=U),I&&Math.abs(I)+Math.abs(O)>359.9&&(I=O=0,D=180-D),T=_round$3(Math.sqrt(Y*Y+X*X+$*$)),M=_round$3(Math.sqrt(q*q+pe*pe)),N=_atan2(ee,q),z=Math.abs(N)>2e-4?N*_RAD2DEG:0,L=ne?1/(ne<0?-ne:ne):0),o.svg&&(Z=a.getAttribute("transform"),o.forceCSS=a.setAttribute("transform","")||!_isNullTransform(_getComputedProperty(a,_transformProp$1)),Z&&a.setAttribute("transform",Z))),Math.abs(z)>90&&Math.abs(z)<270&&(y?(T*=-1,z+=O<=0?180:-180,O+=O<=0?180:-180):(M*=-1,z+=z<=0?180:-180)),n=n||o.uncache,o.x=A-((o.xPercent=A&&(!n&&o.xPercent||(Math.round(a.offsetWidth/2)===Math.round(-A)?-50:0)))?a.offsetWidth*o.xPercent/100:0)+x,o.y=C-((o.yPercent=C&&(!n&&o.yPercent||(Math.round(a.offsetHeight/2)===Math.round(-C)?-50:0)))?a.offsetHeight*o.yPercent/100:0)+x,o.z=P+x,o.scaleX=_round$3(T),o.scaleY=_round$3(M),o.rotation=_round$3(O)+b,o.rotationX=_round$3(I)+b,o.rotationY=_round$3(D)+b,o.skewX=z+b,o.skewY=k+b,o.transformPerspective=L+x,(o.zOrigin=parseFloat(S.split(" ")[2])||!n&&o.zOrigin||0)&&(f[_transformOriginProp]=_firstTwoOnly(S)),o.xOffset=o.yOffset=0,o.force3D=_config$1.force3D,o.renderTransform=o.svg?_renderSVGTransforms:_supports3D?_renderCSSTransforms:_renderNon3DTransforms,o.uncache=0,o},_firstTwoOnly=function(a){return(a=a.split(" "))[0]+" "+a[1]},_addPxTranslate=function(a,n,o){var f=getUnit(n);return _round$3(parseFloat(n)+parseFloat(_convertToUnit(a,"x",o+"px",f)))+f},_renderNon3DTransforms=function(a,n){n.z="0px",n.rotationY=n.rotationX="0deg",n.force3D=0,_renderCSSTransforms(a,n)},_zeroDeg="0deg",_zeroPx="0px",_endParenthesis=") ",_renderCSSTransforms=function(a,n){var o=n||this,f=o.xPercent,y=o.yPercent,x=o.x,b=o.y,_=o.z,S=o.rotation,A=o.rotationY,C=o.rotationX,P=o.skewX,T=o.skewY,M=o.scaleX,O=o.scaleY,I=o.transformPerspective,D=o.force3D,z=o.target,k=o.zOrigin,L="",R=D==="auto"&&a&&a!==1||D===!0;if(k&&(C!==_zeroDeg||A!==_zeroDeg)){var F=parseFloat(A)*_DEG2RAD$1,B=Math.sin(F),N=Math.cos(F),j;F=parseFloat(C)*_DEG2RAD$1,j=Math.cos(F),x=_addPxTranslate(z,x,B*j*-k),b=_addPxTranslate(z,b,-Math.sin(F)*-k),_=_addPxTranslate(z,_,N*j*-k+k)}I!==_zeroPx&&(L+="perspective("+I+_endParenthesis),(f||y)&&(L+="translate("+f+"%, "+y+"%) "),(R||x!==_zeroPx||b!==_zeroPx||_!==_zeroPx)&&(L+=_!==_zeroPx||R?"translate3d("+x+", "+b+", "+_+") ":"translate("+x+", "+b+_endParenthesis),S!==_zeroDeg&&(L+="rotate("+S+_endParenthesis),A!==_zeroDeg&&(L+="rotateY("+A+_endParenthesis),C!==_zeroDeg&&(L+="rotateX("+C+_endParenthesis),(P!==_zeroDeg||T!==_zeroDeg)&&(L+="skew("+P+", "+T+_endParenthesis),(M!==1||O!==1)&&(L+="scale("+M+", "+O+_endParenthesis),z.style[_transformProp$1]=L||"translate(0, 0)"},_renderSVGTransforms=function(a,n){var o=n||this,f=o.xPercent,y=o.yPercent,x=o.x,b=o.y,_=o.rotation,S=o.skewX,A=o.skewY,C=o.scaleX,P=o.scaleY,T=o.target,M=o.xOrigin,O=o.yOrigin,I=o.xOffset,D=o.yOffset,z=o.forceCSS,k=parseFloat(x),L=parseFloat(b),R,F,B,N,j;_=parseFloat(_),S=parseFloat(S),A=parseFloat(A),A&&(A=parseFloat(A),S+=A,_+=A),_||S?(_*=_DEG2RAD$1,S*=_DEG2RAD$1,R=Math.cos(_)*C,F=Math.sin(_)*C,B=Math.sin(_-S)*-P,N=Math.cos(_-S)*P,S&&(A*=_DEG2RAD$1,j=Math.tan(S-A),j=Math.sqrt(1+j*j),B*=j,N*=j,A&&(j=Math.tan(A),j=Math.sqrt(1+j*j),R*=j,F*=j)),R=_round$3(R),F=_round$3(F),B=_round$3(B),N=_round$3(N)):(R=C,N=P,F=B=0),(k&&!~(x+"").indexOf("px")||L&&!~(b+"").indexOf("px"))&&(k=_convertToUnit(T,"x",x,"px"),L=_convertToUnit(T,"y",b,"px")),(M||O||I||D)&&(k=_round$3(k+M-(M*R+O*B)+I),L=_round$3(L+O-(M*F+O*N)+D)),(f||y)&&(j=T.getBBox(),k=_round$3(k+f/100*j.width),L=_round$3(L+y/100*j.height)),j="matrix("+R+","+F+","+B+","+N+","+k+","+L+")",T.setAttribute("transform",j),z&&(T.style[_transformProp$1]=j)},_addRotationalPropTween=function(a,n,o,f,y){var x=360,b=_isString$2(y),_=parseFloat(y)*(b&&~y.indexOf("rad")?_RAD2DEG:1),S=_-f,A=f+S+"deg",C,P;return b&&(C=y.split("_")[1],C==="short"&&(S%=x,S!==S%(x/2)&&(S+=S<0?x:-360)),C==="cw"&&S<0?S=(S+x*_bigNum$1)%x-~~(S/x)*x:C==="ccw"&&S>0&&(S=(S-x*_bigNum$1)%x-~~(S/x)*x)),a._pt=P=new PropTween(a._pt,n,o,f,S,_renderPropWithEnd),P.e=A,P.u="deg",a._props.push(o),P},_assign=function(a,n){for(var o in n)a[o]=n[o];return a},_addRawTransformPTs=function(a,n,o){var f=_assign({},o._gsap),y="perspective,force3D,transformOrigin,svgOrigin",x=o.style,b,_,S,A,C,P,T,M;f.svg?(S=o.getAttribute("transform"),o.setAttribute("transform",""),x[_transformProp$1]=n,b=_parseTransform(o,1),_removeProperty(o,_transformProp$1),o.setAttribute("transform",S)):(S=getComputedStyle(o)[_transformProp$1],x[_transformProp$1]=n,b=_parseTransform(o,1),x[_transformProp$1]=S);for(_ in _transformProps)S=f[_],A=b[_],S!==A&&y.indexOf(_)<0&&(T=getUnit(S),M=getUnit(A),C=T!==M?_convertToUnit(o,_,S,M):parseFloat(S),P=parseFloat(A),a._pt=new PropTween(a._pt,b,_,C,P-C,_renderCSSProp),a._pt.u=M||0,a._props.push(_));_assign(b,f)};_forEachName("padding,margin,Width,Radius",function(r,a){var n="Top",o="Right",f="Bottom",y="Left",x=(a<3?[n,o,f,y]:[n+y,n+o,f+o,f+y]).map(function(b){return a<2?r+b:"border"+b+r});_specialProps[a>1?"border"+r:r]=function(b,_,S,A,C){var P,T;if(arguments.length<4)return P=x.map(function(M){return _get(b,M,S)}),T=P.join(" "),T.split(P[0]).length===5?P[0]:T;P=(A+"").split(" "),T={},x.forEach(function(M,O){return T[M]=P[O]=P[O]||P[(O-1)/2|0]}),b.init(_,T,C)}});var CSSPlugin={name:"css",register:_initCore$3,targetTest:function(a){return a.style&&a.nodeType},init:function(a,n,o,f,y){var x=this._props,b=a.style,_=o.vars.startAt,S,A,C,P,T,M,O,I,D,z,k,L,R,F,B,N;_pluginInitted||_initCore$3(),this.styles=this.styles||_getStyleSaver(a),N=this.styles.props,this.tween=o;for(O in n)if(O!=="autoRound"&&(A=n[O],!(_plugins[O]&&_checkPlugin(O,n,o,f,a,y)))){if(T=typeof A,M=_specialProps[O],T==="function"&&(A=A.call(o,f,a,y),T=typeof A),T==="string"&&~A.indexOf("random(")&&(A=_replaceRandom(A)),M)M(this,a,O,A,o)&&(B=1);else if(O.substr(0,2)==="--")S=(getComputedStyle(a).getPropertyValue(O)+"").trim(),A+="",_colorExp.lastIndex=0,_colorExp.test(S)||(I=getUnit(S),D=getUnit(A)),D?I!==D&&(S=_convertToUnit(a,O,S,D)+D):I&&(A+=I),this.add(b,"setProperty",S,A,f,y,0,0,O),x.push(O),N.push(O,0,b[O]);else if(T!=="undefined"){if(_&&O in _?(S=typeof _[O]=="function"?_[O].call(o,f,a,y):_[O],_isString$2(S)&&~S.indexOf("random(")&&(S=_replaceRandom(S)),getUnit(S+"")||S==="auto"||(S+=_config$1.units[O]||getUnit(_get(a,O))||""),(S+"").charAt(1)==="="&&(S=_get(a,O))):S=_get(a,O),P=parseFloat(S),z=T==="string"&&A.charAt(1)==="="&&A.substr(0,2),z&&(A=A.substr(2)),C=parseFloat(A),O in _propertyAliases&&(O==="autoAlpha"&&(P===1&&_get(a,"visibility")==="hidden"&&C&&(P=0),N.push("visibility",0,b.visibility),_addNonTweeningPT(this,b,"visibility",P?"inherit":"hidden",C?"inherit":"hidden",!C)),O!=="scale"&&O!=="transform"&&(O=_propertyAliases[O],~O.indexOf(",")&&(O=O.split(",")[0]))),k=O in _transformProps,k){if(this.styles.save(O),T==="string"&&A.substring(0,6)==="var(--"&&(A=_getComputedProperty(a,A.substring(4,A.indexOf(")"))),C=parseFloat(A)),L||(R=a._gsap,R.renderTransform&&!n.parseTransform||_parseTransform(a,n.parseTransform),F=n.smoothOrigin!==!1&&R.smooth,L=this._pt=new PropTween(this._pt,b,_transformProp$1,0,1,R.renderTransform,R,0,-1),L.dep=1),O==="scale")this._pt=new PropTween(this._pt,R,"scaleY",R.scaleY,(z?_parseRelative(R.scaleY,z+C):C)-R.scaleY||0,_renderCSSProp),this._pt.u=0,x.push("scaleY",O),O+="X";else if(O==="transformOrigin"){N.push(_transformOriginProp,0,b[_transformOriginProp]),A=_convertKeywordsToPercentages(A),R.svg?_applySVGOrigin(a,A,0,F,0,this):(D=parseFloat(A.split(" ")[2])||0,D!==R.zOrigin&&_addNonTweeningPT(this,R,"zOrigin",R.zOrigin,D),_addNonTweeningPT(this,b,O,_firstTwoOnly(S),_firstTwoOnly(A)));continue}else if(O==="svgOrigin"){_applySVGOrigin(a,A,1,F,0,this);continue}else if(O in _rotationalProperties){_addRotationalPropTween(this,R,O,P,z?_parseRelative(P,z+A):A);continue}else if(O==="smoothOrigin"){_addNonTweeningPT(this,R,"smooth",R.smooth,A);continue}else if(O==="force3D"){R[O]=A;continue}else if(O==="transform"){_addRawTransformPTs(this,A,a);continue}}else O in b||(O=_checkPropPrefix(O)||O);if(k||(C||C===0)&&(P||P===0)&&!_complexExp.test(A)&&O in b)I=(S+"").substr((P+"").length),C||(C=0),D=getUnit(A)||(O in _config$1.units?_config$1.units[O]:I),I!==D&&(P=_convertToUnit(a,O,S,D)),this._pt=new PropTween(this._pt,k?R:b,O,P,(z?_parseRelative(P,z+C):C)-P,!k&&(D==="px"||O==="zIndex")&&n.autoRound!==!1?_renderRoundedCSSProp:_renderCSSProp),this._pt.u=D||0,I!==D&&D!=="%"&&(this._pt.b=S,this._pt.r=_renderCSSPropWithBeginning);else if(O in b)_tweenComplexCSSString.call(this,a,O,S,z?z+A:A);else if(O in a)this.add(a,O,S||a[O],z?z+A:A,f,y);else if(O!=="parseTransform"){_missingPlugin(O,A);continue}k||(O in b?N.push(O,0,b[O]):typeof a[O]=="function"?N.push(O,2,a[O]()):N.push(O,1,S||a[O])),x.push(O)}}B&&_sortPropTweensByPriority(this)},render:function(a,n){if(n.tween._time||!_reverting())for(var o=n._pt;o;)o.r(a,o.d),o=o._next;else n.styles.revert()},get:_get,aliases:_propertyAliases,getSetter:function(a,n,o){var f=_propertyAliases[n];return f&&f.indexOf(",")<0&&(n=f),n in _transformProps&&n!==_transformOriginProp&&(a._gsap.x||_get(a,"x"))?o&&_recentSetterPlugin===o?n==="scale"?_setterScale:_setterTransform:(_recentSetterPlugin=o||{})&&(n==="scale"?_setterScaleWithRender:_setterTransformWithRender):a.style&&!_isUndefined(a.style[n])?_setterCSSStyle:~n.indexOf("-")?_setterCSSProp:_getSetter(a,n)},core:{_removeProperty,_getMatrix}};gsap$4.utils.checkPrefix=_checkPropPrefix;gsap$4.core.getStyleSaver=_getStyleSaver;(function(r,a,n,o){var f=_forEachName(r+","+a+","+n,function(y){_transformProps[y]=1});_forEachName(a,function(y){_config$1.units[y]="deg",_rotationalProperties[y]=1}),_propertyAliases[f[13]]=r+","+a,_forEachName(o,function(y){var x=y.split(":");_propertyAliases[x[1]]=f[x[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");_forEachName("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(r){_config$1.units[r]="px"});gsap$4.registerPlugin(CSSPlugin);var gsapWithCSS=gsap$4.registerPlugin(CSSPlugin)||gsap$4;gsapWithCSS.core.Tween;/*!
 * paths 3.13.0
 * https://gsap.com
 *
 * Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var _svgPathExp=/[achlmqstvz]|(-?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/ig,_scientific=/[\+\-]?\d*\.?\d+e[\+\-]?\d+/ig,_DEG2RAD=Math.PI/180,_sin=Math.sin,_cos=Math.cos,_abs$1=Math.abs,_sqrt=Math.sqrt,_isNumber$1=function(a){return typeof a=="number"},_roundingNum=1e5,_round$2=function(a){return Math.round(a*_roundingNum)/_roundingNum||0};function transformRawPath(r,a,n,o,f,y,x){for(var b=r.length,_,S,A,C,P;--b>-1;)for(_=r[b],S=_.length,A=0;A<S;A+=2)C=_[A],P=_[A+1],_[A]=C*a+P*o+y,_[A+1]=C*n+P*f+x;return r._dirty=1,r}function arcToSegment(r,a,n,o,f,y,x,b,_){if(!(r===b&&a===_)){n=_abs$1(n),o=_abs$1(o);var S=f%360*_DEG2RAD,A=_cos(S),C=_sin(S),P=Math.PI,T=P*2,M=(r-b)/2,O=(a-_)/2,I=A*M+C*O,D=-C*M+A*O,z=I*I,k=D*D,L=z/(n*n)+k/(o*o);L>1&&(n=_sqrt(L)*n,o=_sqrt(L)*o);var R=n*n,F=o*o,B=(R*F-R*k-F*z)/(R*k+F*z);B<0&&(B=0);var N=(y===x?-1:1)*_sqrt(B),j=N*(n*D/o),G=N*-(o*I/n),Y=(r+b)/2,X=(a+_)/2,$=Y+(A*j-C*G),te=X+(C*j+A*G),ee=(I-j)/n,q=(D-G)/o,Z=(-I-j)/n,U=(-D-G)/o,W=ee*ee+q*q,H=(q<0?-1:1)*Math.acos(ee/_sqrt(W)),K=(ee*U-q*Z<0?-1:1)*Math.acos((ee*Z+q*U)/_sqrt(W*(Z*Z+U*U)));isNaN(K)&&(K=P),!x&&K>0?K-=T:x&&K<0&&(K+=T),H%=T,K%=T;var le=Math.ceil(_abs$1(K)/(T/4)),me=[],ne=K/le,pe=4/3*_sin(ne/2)/(1+_cos(ne/2)),ge=A*n,ye=C*n,_e=C*-o,ve=A*o,Ee;for(Ee=0;Ee<le;Ee++)f=H+Ee*ne,I=_cos(f),D=_sin(f),ee=_cos(f+=ne),q=_sin(f),me.push(I-pe*D,D+pe*I,ee+pe*q,q-pe*ee,ee,q);for(Ee=0;Ee<me.length;Ee+=2)I=me[Ee],D=me[Ee+1],me[Ee]=I*ge+D*_e+$,me[Ee+1]=I*ye+D*ve+te;return me[Ee-2]=b,me[Ee-1]=_,me}}function stringToRawPath(r){var a=(r+"").replace(_scientific,function(j){var G=+j;return G<1e-4&&G>-1e-4?0:G}).match(_svgPathExp)||[],n=[],o=0,f=0,y=2/3,x=a.length,b=0,_="ERROR: malformed path: "+r,S,A,C,P,T,M,O,I,D,z,k,L,R,F,B,N=function(G,Y,X,$){z=(X-G)/3,k=($-Y)/3,O.push(G+z,Y+k,X-z,$-k,X,$)};if(!r||!isNaN(a[0])||isNaN(a[1]))return console.log(_),n;for(S=0;S<x;S++)if(R=T,isNaN(a[S])?(T=a[S].toUpperCase(),M=T!==a[S]):S--,C=+a[S+1],P=+a[S+2],M&&(C+=o,P+=f),S||(I=C,D=P),T==="M")O&&(O.length<8?n.length-=1:b+=O.length),o=I=C,f=D=P,O=[C,P],n.push(O),S+=2,T="L";else if(T==="C")O||(O=[0,0]),M||(o=f=0),O.push(C,P,o+a[S+3]*1,f+a[S+4]*1,o+=a[S+5]*1,f+=a[S+6]*1),S+=6;else if(T==="S")z=o,k=f,(R==="C"||R==="S")&&(z+=o-O[O.length-4],k+=f-O[O.length-3]),M||(o=f=0),O.push(z,k,C,P,o+=a[S+3]*1,f+=a[S+4]*1),S+=4;else if(T==="Q")z=o+(C-o)*y,k=f+(P-f)*y,M||(o=f=0),o+=a[S+3]*1,f+=a[S+4]*1,O.push(z,k,o+(C-o)*y,f+(P-f)*y,o,f),S+=4;else if(T==="T")z=o-O[O.length-4],k=f-O[O.length-3],O.push(o+z,f+k,C+(o+z*1.5-C)*y,P+(f+k*1.5-P)*y,o=C,f=P),S+=2;else if(T==="H")N(o,f,o=C,f),S+=1;else if(T==="V")N(o,f,o,f=C+(M?f-o:0)),S+=1;else if(T==="L"||T==="Z")T==="Z"&&(C=I,P=D,O.closed=!0),(T==="L"||_abs$1(o-C)>.5||_abs$1(f-P)>.5)&&(N(o,f,C,P),T==="L"&&(S+=2)),o=C,f=P;else if(T==="A"){if(F=a[S+4],B=a[S+5],z=a[S+6],k=a[S+7],A=7,F.length>1&&(F.length<3?(k=z,z=B,A--):(k=B,z=F.substr(2),A-=2),B=F.charAt(1),F=F.charAt(0)),L=arcToSegment(o,f,+a[S+1],+a[S+2],+a[S+3],+F,+B,(M?o:0)+z*1,(M?f:0)+k*1),S+=A,L)for(A=0;A<L.length;A++)O.push(L[A]);o=O[O.length-2],f=O[O.length-1]}else console.log(_);return S=O.length,S<6?(n.pop(),S=0):O[0]===O[S-2]&&O[1]===O[S-1]&&(O.closed=!0),n.totalPoints=b+S,n}function rawPathToString(r){_isNumber$1(r[0])&&(r=[r]);var a="",n=r.length,o,f,y,x;for(f=0;f<n;f++){for(x=r[f],a+="M"+_round$2(x[0])+","+_round$2(x[1])+" C",o=x.length,y=2;y<o;y++)a+=_round$2(x[y++])+","+_round$2(x[y++])+" "+_round$2(x[y++])+","+_round$2(x[y++])+" "+_round$2(x[y++])+","+_round$2(x[y])+" ";x.closed&&(a+="z")}return a}/*!
 * CustomEase 3.13.0
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var gsap$3,_coreInitted$3,_getGSAP$3=function(){return gsap$3||typeof window<"u"&&(gsap$3=window.gsap)&&gsap$3.registerPlugin&&gsap$3},_initCore$2=function(){gsap$3=_getGSAP$3(),gsap$3?(gsap$3.registerEase("_CE",CustomEase.create),_coreInitted$3=1):console.warn("Please gsap.registerPlugin(CustomEase)")},_bigNum=1e20,_round$1=function(a){return~~(a*1e3+(a<0?-.5:.5))/1e3},_numExp=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/gi,_needsParsingExp=/[cLlsSaAhHvVtTqQ]/g,_findMinimum=function(a){var n=a.length,o=_bigNum,f;for(f=1;f<n;f+=6)+a[f]<o&&(o=+a[f]);return o},_normalize=function(a,n,o){!o&&o!==0&&(o=Math.max(+a[a.length-1],+a[1]));var f=+a[0]*-1,y=-o,x=a.length,b=1/(+a[x-2]+f),_=-n||(Math.abs(+a[x-1]-+a[1])<.01*(+a[x-2]-+a[0])?_findMinimum(a)+y:+a[x-1]+y),S;for(_?_=1/_:_=-b,S=0;S<x;S+=2)a[S]=(+a[S]+f)*b,a[S+1]=(+a[S+1]+y)*_},_bezierToPoints=function r(a,n,o,f,y,x,b,_,S,A,C){var P=(a+o)/2,T=(n+f)/2,M=(o+y)/2,O=(f+x)/2,I=(y+b)/2,D=(x+_)/2,z=(P+M)/2,k=(T+O)/2,L=(M+I)/2,R=(O+D)/2,F=(z+L)/2,B=(k+R)/2,N=b-a,j=_-n,G=Math.abs((o-b)*j-(f-_)*N),Y=Math.abs((y-b)*j-(x-_)*N),X;return A||(A=[{x:a,y:n},{x:b,y:_}],C=1),A.splice(C||A.length-1,0,{x:F,y:B}),(G+Y)*(G+Y)>S*(N*N+j*j)&&(X=A.length,r(a,n,P,T,z,k,F,B,S,A,C),r(F,B,L,R,I,D,b,_,S,A,C+1+(A.length-X))),A},CustomEase=function(){function r(n,o,f){_coreInitted$3||_initCore$2(),this.id=n,this.setData(o,f)}var a=r.prototype;return a.setData=function(o,f){f=f||{},o=o||"0,0,1,1";var y=o.match(_numExp),x=1,b=[],_=[],S=f.precision||1,A=S<=1,C,P,T,M,O,I,D,z,k;if(this.data=o,(_needsParsingExp.test(o)||~o.indexOf("M")&&o.indexOf("C")<0)&&(y=stringToRawPath(o)[0]),C=y.length,C===4)y.unshift(0,0),y.push(1,1),C=8;else if((C-2)%6)throw"Invalid CustomEase";for((+y[0]!=0||+y[C-2]!=1)&&_normalize(y,f.height,f.originY),this.segment=y,M=2;M<C;M+=6)P={x:+y[M-2],y:+y[M-1]},T={x:+y[M+4],y:+y[M+5]},b.push(P,T),_bezierToPoints(P.x,P.y,+y[M],+y[M+1],+y[M+2],+y[M+3],T.x,T.y,1/(S*2e5),b,b.length-1);for(C=b.length,M=0;M<C;M++)D=b[M],z=b[M-1]||D,(D.x>z.x||z.y!==D.y&&z.x===D.x||D===z)&&D.x<=1?(z.cx=D.x-z.x,z.cy=D.y-z.y,z.n=D,z.nx=D.x,A&&M>1&&Math.abs(z.cy/z.cx-b[M-2].cy/b[M-2].cx)>2&&(A=0),z.cx<x&&(z.cx?x=z.cx:(z.cx=.001,M===C-1&&(z.x-=.001,x=Math.min(x,.001),A=0)))):(b.splice(M--,1),C--);if(C=1/x+1|0,O=1/C,I=0,D=b[0],A){for(M=0;M<C;M++)k=M*O,D.nx<k&&(D=b[++I]),P=D.y+(k-D.x)/D.cx*D.cy,_[M]={x:k,cx:O,y:P,cy:0,nx:9},M&&(_[M-1].cy=P-_[M-1].y);I=b[b.length-1],_[C-1].cy=I.y-P,_[C-1].cx=I.x-_[_.length-1].x}else{for(M=0;M<C;M++)D.nx<M*O&&(D=b[++I]),_[M]=D;I<b.length-1&&(_[M-1]=b[b.length-2])}return this.ease=function(L){var R=_[L*C|0]||_[C-1];return R.nx<L&&(R=R.n),R.y+(L-R.x)/R.cx*R.cy},this.ease.custom=this,this.id&&gsap$3&&gsap$3.registerEase(this.id,this.ease),this},a.getSVGData=function(o){return r.getSVGData(this,o)},r.create=function(o,f,y){return new r(o,f,y).ease},r.register=function(o){gsap$3=o,_initCore$2()},r.get=function(o){return gsap$3.parseEase(o)},r.getSVGData=function(o,f){f=f||{};var y=f.width||100,x=f.height||100,b=f.x||0,_=(f.y||0)+x,S=gsap$3.utils.toArray(f.path)[0],A,C,P,T,M,O,I,D,z,k;if(f.invert&&(x=-x,_=0),typeof o=="string"&&(o=gsap$3.parseEase(o)),o.custom&&(o=o.custom),o instanceof r)A=rawPathToString(transformRawPath([o.segment],y,0,0,-x,b,_));else{for(A=[b,_],I=Math.max(5,(f.precision||1)*200),T=1/I,I+=2,D=5/I,z=_round$1(b+T*y),k=_round$1(_+o(T)*-x),C=(k-_)/(z-b),P=2;P<I;P++)M=_round$1(b+P*T*y),O=_round$1(_+o(P*T)*-x),(Math.abs((O-k)/(M-z)-C)>D||P===I-1)&&(A.push(z,k),C=(O-k)/(M-z)),z=M,k=O;A="M"+A.join(",")}return S&&S.setAttribute("d",A),A},r}();CustomEase.version="3.13.0";CustomEase.headless=!0;_getGSAP$3()&&gsap$3.registerPlugin(CustomEase);var RF=Object.create,Ng=Object.defineProperty,LF=Object.getOwnPropertyDescriptor,BF=Object.getOwnPropertyNames,NF=Object.getPrototypeOf,FF=Object.prototype.hasOwnProperty,VF=(r,a,n)=>a in r?Ng(r,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[a]=n,pc=(r,a)=>()=>(a||r((a={exports:{}}).exports,a),a.exports),UF=(r,a)=>{for(var n in a)Ng(r,n,{get:a[n],enumerable:!0})},zF=(r,a,n,o)=>{if(a&&typeof a=="object"||typeof a=="function")for(let f of BF(a))!FF.call(r,f)&&f!==n&&Ng(r,f,{get:()=>a[f],enumerable:!(o=LF(a,f))||o.enumerable});return r},Za=(r,a,n)=>(n=r!=null?RF(NF(r)):{},zF(a||!r||!r.__esModule?Ng(n,"default",{value:r,enumerable:!0}):n,r)),mc=(r,a,n)=>(VF(r,typeof a!="symbol"?a+"":a,n),n),hO=pc((r,a)=>{(function(n,o){typeof r=="object"?a.exports=o():typeof define=="function"&&define.amd?define(o):n.Alea=o()})(r,function(){return n.importState=function(f){var y=new n;return y.importState(f),y},n;function n(){return function(f){var y=0,x=0,b=0,_=1;f.length==0&&(f=[+new Date]);var S=o();y=S(" "),x=S(" "),b=S(" ");for(var A=0;A<f.length;A++)y-=S(f[A]),y<0&&(y+=1),x-=S(f[A]),x<0&&(x+=1),b-=S(f[A]),b<0&&(b+=1);S=null;var C=function(){var P=2091639*y+_*23283064365386963e-26;return y=x,x=b,b=P-(_=P|0)};return C.next=C,C.uint32=function(){return C()*4294967296},C.fract53=function(){return C()+(C()*2097152|0)*11102230246251565e-32},C.version="Alea 0.9",C.args=f,C.exportState=function(){return[y,x,b,_]},C.importState=function(P){y=+P[0]||0,x=+P[1]||0,b=+P[2]||0,_=+P[3]||0},C}(Array.prototype.slice.call(arguments))}function o(){var f=4022871197,y=function(x){x=x.toString();for(var b=0;b<x.length;b++){f+=x.charCodeAt(b);var _=.02519603282416938*f;f=_>>>0,_-=f,_*=f,f=_>>>0,_-=f,f+=_*4294967296}return(f>>>0)*23283064365386963e-26};return y.version="Mash 0.9",y}})}),CA=pc((r,a)=>{(function(n,o){typeof r=="object"&&typeof a<"u"?o(r):typeof define=="function"&&define.amd?define(["exports"],o):o((n=typeof globalThis<"u"?globalThis:n||self).SVDJS={})})(r,function(n){n.SVD=function(o,f,y,x,b){if(f=f===void 0||f,y=y===void 0||y,b=1e-64/(x=x||Math.pow(2,-52)),!o)throw new TypeError("Matrix a is not defined");var _,S,A,C,P,T,M,O,I,D,z,k,L=o[0].length,R=o.length;if(R<L)throw new TypeError("Invalid matrix: m < n");for(var F=[],B=[],N=[],j=f==="f"?R:L,G=D=M=0;G<R;G++)B[G]=new Array(j).fill(0);for(G=0;G<L;G++)N[G]=new Array(L).fill(0);var Y,X=new Array(L).fill(0);for(G=0;G<R;G++)for(_=0;_<L;_++)B[G][_]=o[G][_];for(G=0;G<L;G++){for(F[G]=M,I=0,A=G+1,_=G;_<R;_++)I+=Math.pow(B[_][G],2);if(I<b)M=0;else for(O=(T=B[G][G])*(M=T<0?Math.sqrt(I):-Math.sqrt(I))-I,B[G][G]=T-M,_=A;_<L;_++){for(I=0,S=G;S<R;S++)I+=B[S][G]*B[S][_];for(T=I/O,S=G;S<R;S++)B[S][_]=B[S][_]+T*B[S][G]}for(X[G]=M,I=0,_=A;_<L;_++)I+=Math.pow(B[G][_],2);if(I<b)M=0;else{for(O=(T=B[G][G+1])*(M=T<0?Math.sqrt(I):-Math.sqrt(I))-I,B[G][G+1]=T-M,_=A;_<L;_++)F[_]=B[G][_]/O;for(_=A;_<R;_++){for(I=0,S=A;S<L;S++)I+=B[_][S]*B[G][S];for(S=A;S<L;S++)B[_][S]=B[_][S]+I*F[S]}}D<(z=Math.abs(X[G])+Math.abs(F[G]))&&(D=z)}if(y)for(G=L-1;0<=G;G--){if(M!==0){for(O=B[G][G+1]*M,_=A;_<L;_++)N[_][G]=B[G][_]/O;for(_=A;_<L;_++){for(I=0,S=A;S<L;S++)I+=B[G][S]*N[S][_];for(S=A;S<L;S++)N[S][_]=N[S][_]+I*N[S][G]}}for(_=A;_<L;_++)N[G][_]=0,N[_][G]=0;N[G][G]=1,M=F[G],A=G}if(f){if(f==="f")for(G=L;G<R;G++){for(_=L;_<R;_++)B[G][_]=0;B[G][G]=1}for(G=L-1;0<=G;G--){for(A=G+1,M=X[G],_=A;_<j;_++)B[G][_]=0;if(M!==0){for(O=B[G][G]*M,_=A;_<j;_++){for(I=0,S=A;S<R;S++)I+=B[S][G]*B[S][_];for(T=I/O,S=G;S<R;S++)B[S][_]=B[S][_]+T*B[S][G]}for(_=G;_<R;_++)B[_][G]=B[_][G]/M}else for(_=G;_<R;_++)B[_][G]=0;B[G][G]=B[G][G]+1}}for(x*=D,S=L-1;0<=S;S--)for(var $=0;$<50;$++){for(Y=!1,A=S;0<=A;A--){if(Math.abs(F[A])<=x){Y=!0;break}if(Math.abs(X[A-1])<=x)break}if(!Y){for(P=0,C=A-(I=1),G=A;G<S+1&&(T=I*F[G],F[G]=P*F[G],!(Math.abs(T)<=x));G++)if(M=X[G],X[G]=Math.sqrt(T*T+M*M),P=M/(O=X[G]),I=-T/O,f)for(_=0;_<R;_++)z=B[_][C],k=B[_][G],B[_][C]=z*P+k*I,B[_][G]=-z*I+k*P}if(k=X[S],A===S){if(k<0&&(X[S]=-k,y))for(_=0;_<L;_++)N[_][S]=-N[_][S];break}for(D=X[A],T=(((z=X[S-1])-k)*(z+k)+((M=F[S-1])-(O=F[S]))*(M+O))/(2*O*z),M=Math.sqrt(T*T+1),T=((D-k)*(D+k)+O*(z/(T<0?T-M:T+M)-O))/D,G=A+(I=P=1);G<S+1;G++){if(M=F[G],z=X[G],O=I*M,M*=P,k=Math.sqrt(T*T+O*O),T=D*(P=T/(F[G-1]=k))+M*(I=O/k),M=-D*I+M*P,O=z*I,z*=P,y)for(_=0;_<L;_++)D=N[_][G-1],k=N[_][G],N[_][G-1]=D*P+k*I,N[_][G]=-D*I+k*P;if(k=Math.sqrt(T*T+O*O),T=(P=T/(X[G-1]=k))*M+(I=O/k)*z,D=-I*M+P*z,f)for(_=0;_<R;_++)z=B[_][G-1],k=B[_][G],B[_][G-1]=z*P+k*I,B[_][G]=-z*I+k*P}F[A]=0,F[S]=T,X[S]=D}for(G=0;G<L;G++)X[G]<x&&(X[G]=0);return{u:B,q:X,v:N}},n.VERSION="1.1.1",Object.defineProperty(n,"__esModule",{value:!0})})}),GR=pc((r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.default=n;function n(o){if(o===null||o===!0||o===!1)return NaN;var f=Number(o);return isNaN(f)?f:f<0?Math.ceil(f):Math.floor(f)}a.exports=r.default}),HR=pc((r,a)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.default=n;function n(o){var f=new Date(Date.UTC(o.getFullYear(),o.getMonth(),o.getDate(),o.getHours(),o.getMinutes(),o.getSeconds(),o.getMilliseconds()));return f.setUTCFullYear(o.getFullYear()),o.getTime()-f.getTime()}a.exports=r.default}),GL=pc((r,a)=>{function n(y,x){function b(){this.constructor=y}b.prototype=x.prototype,y.prototype=new b}function o(y,x,b,_){this.message=y,this.expected=x,this.found=b,this.location=_,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,o)}n(o,Error),o.buildMessage=function(y,x){var b={literal:function(M){return'"'+S(M.text)+'"'},class:function(M){var O="",I;for(I=0;I<M.parts.length;I++)O+=M.parts[I]instanceof Array?A(M.parts[I][0])+"-"+A(M.parts[I][1]):A(M.parts[I]);return"["+(M.inverted?"^":"")+O+"]"},any:function(M){return"any character"},end:function(M){return"end of input"},other:function(M){return M.description}};function _(M){return M.charCodeAt(0).toString(16).toUpperCase()}function S(M){return M.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(O){return"\\x0"+_(O)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(O){return"\\x"+_(O)})}function A(M){return M.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(O){return"\\x0"+_(O)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(O){return"\\x"+_(O)})}function C(M){return b[M.type](M)}function P(M){var O=new Array(M.length),I,D;for(I=0;I<M.length;I++)O[I]=C(M[I]);if(O.sort(),O.length>0){for(I=1,D=1;I<O.length;I++)O[I-1]!==O[I]&&(O[D]=O[I],D++);O.length=D}switch(O.length){case 1:return O[0];case 2:return O[0]+" or "+O[1];default:return O.slice(0,-1).join(", ")+", or "+O[O.length-1]}}function T(M){return M?'"'+S(M)+'"':"end of input"}return"Expected "+P(y)+" but "+T(x)+" found."};function f(y,x){x=x!==void 0?x:{};var b={},_={svg_path:Lr},S=Lr,A=function(J){if(!J)return[];for(var Q=[],ae=0;ae<J.length;ae++)Q=Q.concat.apply(Q,J[ae]);var re=Q[0];return re&&re.code=="m"&&(delete re.relative,re.code="M"),Q},C=function(J,Q){return ra(J,Q)},P=/^[Mm]/,T=nt(["M","m"],!1,!1),M=function(J,Q,ae){var re=es(J,[Q]);return ae&&(re=re.concat(es(J=="M"?"L":"l",ae[1]))),re},O=/^[Zz]/,I=nt(["Z","z"],!1,!1),D=function(){return es("Z")},z=/^[Ll]/,k=nt(["L","l"],!1,!1),L=function(J,Q){return es(J,Q)},R=/^[Hh]/,F=nt(["H","h"],!1,!1),B=function(J,Q){return es(J,Q.map(function(ae){return{x:ae}}))},N=/^[Vv]/,j=nt(["V","v"],!1,!1),G=function(J,Q){return es(J,Q.map(function(ae){return{y:ae}}))},Y=/^[Cc]/,X=nt(["C","c"],!1,!1),$=function(J,Q,ae){return{x1:J.x,y1:J.y,x2:Q.x,y2:Q.y,x:ae.x,y:ae.y}},te=/^[Ss]/,ee=nt(["S","s"],!1,!1),q=function(J,Q){return{x2:J.x,y2:J.y,x:Q.x,y:Q.y}},Z=/^[Qq]/,U=nt(["Q","q"],!1,!1),W=function(J,Q){return{x1:J.x,y1:J.y,x:Q.x,y:Q.y}},H=/^[Tt]/,K=nt(["T","t"],!1,!1),le=/^[Aa]/,me=nt(["A","a"],!1,!1),ne=function(J,Q,ae,re,de,ke){return{rx:J,ry:Q,xAxisRotation:ae,largeArc:re,sweep:de,x:ke.x,y:ke.y}},pe=function(J,Q){return{x:J,y:Q}},ge=function(J){return J*1},ye=function(J){return J.join("")*1},_e=/^[01]/,ve=nt(["0","1"],!1,!1),Ee=function(J){return J=="1"},xe=function(){return""},Me=",",Pe=ui(",",!1),be=function(J){return J.join("")},Oe=".",Be=ui(".",!1),oe=/^[eE]/,De=nt(["e","E"],!1,!1),ze=/^[+\-]/,Ne=nt(["+","-"],!1,!1),Le=/^[0-9]/,bt=nt([["0","9"]],!1,!1),Ve=function(J){return J.join("")},He=/^[ \t\n\r]/,tt=nt([" ","	",`
`,"\r"],!1,!1),ie=0,We=[{line:1,column:1}],wt=0,Nt=[],Ot;if("startRule"in x){if(!(x.startRule in _))throw new Error(`Can't start parsing from rule "`+x.startRule+'".');S=_[x.startRule]}function ui(J,Q){return{type:"literal",text:J,ignoreCase:Q}}function nt(J,Q,ae){return{type:"class",parts:J,inverted:Q,ignoreCase:ae}}function Rs(){return{type:"end"}}function er(J){var Q=We[J],ae;if(Q)return Q;for(ae=J-1;!We[ae];)ae--;for(Q=We[ae],Q={line:Q.line,column:Q.column};ae<J;)y.charCodeAt(ae)===10?(Q.line++,Q.column=1):Q.column++,ae++;return We[J]=Q,Q}function is(J,Q){var ae=er(J),re=er(Q);return{start:{offset:J,line:ae.line,column:ae.column},end:{offset:Q,line:re.line,column:re.column}}}function zt(J){ie<wt||(ie>wt&&(wt=ie,Nt=[]),Nt.push(J))}function zr(J,Q,ae){return new o(o.buildMessage(J,Q),J,Q,ae)}function Lr(){var J,Q,ae,re,de;for(J=ie,Q=[],ae=Pt();ae!==b;)Q.push(ae),ae=Pt();if(Q!==b)if(ae=st(),ae===b&&(ae=null),ae!==b){for(re=[],de=Pt();de!==b;)re.push(de),de=Pt();re!==b?(Q=A(ae),J=Q):(ie=J,J=b)}else ie=J,J=b;else ie=J,J=b;return J}function st(){var J,Q,ae,re,de,ke;if(J=ie,Q=Cr(),Q!==b){for(ae=[],re=ie,de=[],ke=Pt();ke!==b;)de.push(ke),ke=Pt();for(de!==b?(ke=Cr(),ke!==b?(de=[de,ke],re=de):(ie=re,re=b)):(ie=re,re=b);re!==b;){for(ae.push(re),re=ie,de=[],ke=Pt();ke!==b;)de.push(ke),ke=Pt();de!==b?(ke=Cr(),ke!==b?(de=[de,ke],re=de):(ie=re,re=b)):(ie=re,re=b)}ae!==b?(Q=C(Q,ae),J=Q):(ie=J,J=b)}else ie=J,J=b;return J}function Cr(){var J,Q,ae,re,de,ke;if(J=ie,Q=Ei(),Q!==b){for(ae=[],re=ie,de=[],ke=Pt();ke!==b;)de.push(ke),ke=Pt();for(de!==b?(ke=Rt(),ke!==b?(de=[de,ke],re=de):(ie=re,re=b)):(ie=re,re=b);re!==b;){for(ae.push(re),re=ie,de=[],ke=Pt();ke!==b;)de.push(ke),ke=Pt();de!==b?(ke=Rt(),ke!==b?(de=[de,ke],re=de):(ie=re,re=b)):(ie=re,re=b)}ae!==b?(Q=C(Q,ae),J=Q):(ie=J,J=b)}else ie=J,J=b;return J}function Rt(){var J;return J=Bi(),J===b&&(J=Pr(),J===b&&(J=rs(),J===b&&(J=vt(),J===b&&(J=Ye(),J===b&&(J=ft(),J===b&&(J=di(),J===b&&(J=Ai(),J===b&&(J=qt())))))))),J}function Ei(){var J,Q,ae,re,de,ke,ia;if(J=ie,P.test(y.charAt(ie))?(Q=y.charAt(ie),ie++):(Q=b,zt(T)),Q!==b){for(ae=[],re=Pt();re!==b;)ae.push(re),re=Pt();ae!==b?(re=Dt(),re!==b?(de=ie,ke=At(),ke===b&&(ke=null),ke!==b?(ia=ps(),ia!==b?(ke=[ke,ia],de=ke):(ie=de,de=b)):(ie=de,de=b),de===b&&(de=null),de!==b?(Q=M(Q,re,de),J=Q):(ie=J,J=b)):(ie=J,J=b)):(ie=J,J=b)}else ie=J,J=b;return J}function Bi(){var J,Q;return J=ie,O.test(y.charAt(ie))?(Q=y.charAt(ie),ie++):(Q=b,zt(I)),Q!==b&&(Q=D()),J=Q,J}function Pr(){var J,Q,ae,re;if(J=ie,z.test(y.charAt(ie))?(Q=y.charAt(ie),ie++):(Q=b,zt(k)),Q!==b){for(ae=[],re=Pt();re!==b;)ae.push(re),re=Pt();ae!==b?(re=ps(),re!==b?(Q=L(Q,re),J=Q):(ie=J,J=b)):(ie=J,J=b)}else ie=J,J=b;return J}function ps(){var J,Q,ae,re,de,ke;if(J=ie,Q=Dt(),Q!==b){for(ae=[],re=ie,de=At(),de===b&&(de=null),de!==b?(ke=Dt(),ke!==b?(de=[de,ke],re=de):(ie=re,re=b)):(ie=re,re=b);re!==b;)ae.push(re),re=ie,de=At(),de===b&&(de=null),de!==b?(ke=Dt(),ke!==b?(de=[de,ke],re=de):(ie=re,re=b)):(ie=re,re=b);ae!==b?(Q=C(Q,ae),J=Q):(ie=J,J=b)}else ie=J,J=b;return J}function rs(){var J,Q,ae,re;if(J=ie,R.test(y.charAt(ie))?(Q=y.charAt(ie),ie++):(Q=b,zt(F)),Q!==b){for(ae=[],re=Pt();re!==b;)ae.push(re),re=Pt();ae!==b?(re=Us(),re!==b?(Q=B(Q,re),J=Q):(ie=J,J=b)):(ie=J,J=b)}else ie=J,J=b;return J}function Us(){var J,Q,ae,re,de,ke;if(J=ie,Q=Mi(),Q!==b){for(ae=[],re=ie,de=At(),de===b&&(de=null),de!==b?(ke=Mi(),ke!==b?(de=[de,ke],re=de):(ie=re,re=b)):(ie=re,re=b);re!==b;)ae.push(re),re=ie,de=At(),de===b&&(de=null),de!==b?(ke=Mi(),ke!==b?(de=[de,ke],re=de):(ie=re,re=b)):(ie=re,re=b);ae!==b?(Q=C(Q,ae),J=Q):(ie=J,J=b)}else ie=J,J=b;return J}function vt(){var J,Q,ae,re;if(J=ie,N.test(y.charAt(ie))?(Q=y.charAt(ie),ie++):(Q=b,zt(j)),Q!==b){for(ae=[],re=Pt();re!==b;)ae.push(re),re=Pt();ae!==b?(re=Us(),re!==b?(Q=G(Q,re),J=Q):(ie=J,J=b)):(ie=J,J=b)}else ie=J,J=b;return J}function Ye(){var J,Q,ae,re;if(J=ie,Y.test(y.charAt(ie))?(Q=y.charAt(ie),ie++):(Q=b,zt(X)),Q!==b){for(ae=[],re=Pt();re!==b;)ae.push(re),re=Pt();ae!==b?(re=kt(),re!==b?(Q=L(Q,re),J=Q):(ie=J,J=b)):(ie=J,J=b)}else ie=J,J=b;return J}function kt(){var J,Q,ae,re,de,ke;if(J=ie,Q=Re(),Q!==b){for(ae=[],re=ie,de=At(),de===b&&(de=null),de!==b?(ke=Re(),ke!==b?(de=[de,ke],re=de):(ie=re,re=b)):(ie=re,re=b);re!==b;)ae.push(re),re=ie,de=At(),de===b&&(de=null),de!==b?(ke=Re(),ke!==b?(de=[de,ke],re=de):(ie=re,re=b)):(ie=re,re=b);ae!==b?(Q=C(Q,ae),J=Q):(ie=J,J=b)}else ie=J,J=b;return J}function Re(){var J,Q,ae,re,de,ke;return J=ie,Q=Dt(),Q!==b?(ae=At(),ae===b&&(ae=null),ae!==b?(re=Dt(),re!==b?(de=At(),de===b&&(de=null),de!==b?(ke=Dt(),ke!==b?(Q=$(Q,re,ke),J=Q):(ie=J,J=b)):(ie=J,J=b)):(ie=J,J=b)):(ie=J,J=b)):(ie=J,J=b),J}function ft(){var J,Q,ae,re;if(J=ie,te.test(y.charAt(ie))?(Q=y.charAt(ie),ie++):(Q=b,zt(ee)),Q!==b){for(ae=[],re=Pt();re!==b;)ae.push(re),re=Pt();ae!==b?(re=je(),re!==b?(Q=L(Q,re),J=Q):(ie=J,J=b)):(ie=J,J=b)}else ie=J,J=b;return J}function je(){var J,Q,ae,re,de,ke;if(J=ie,Q=ot(),Q!==b){for(ae=[],re=ie,de=At(),de===b&&(de=null),de!==b?(ke=ot(),ke!==b?(de=[de,ke],re=de):(ie=re,re=b)):(ie=re,re=b);re!==b;)ae.push(re),re=ie,de=At(),de===b&&(de=null),de!==b?(ke=ot(),ke!==b?(de=[de,ke],re=de):(ie=re,re=b)):(ie=re,re=b);ae!==b?(Q=C(Q,ae),J=Q):(ie=J,J=b)}else ie=J,J=b;return J}function ot(){var J,Q,ae,re;return J=ie,Q=Dt(),Q!==b?(ae=At(),ae===b&&(ae=null),ae!==b?(re=Dt(),re!==b?(Q=q(Q,re),J=Q):(ie=J,J=b)):(ie=J,J=b)):(ie=J,J=b),J}function di(){var J,Q,ae,re;if(J=ie,Z.test(y.charAt(ie))?(Q=y.charAt(ie),ie++):(Q=b,zt(U)),Q!==b){for(ae=[],re=Pt();re!==b;)ae.push(re),re=Pt();ae!==b?(re=It(),re!==b?(Q=L(Q,re),J=Q):(ie=J,J=b)):(ie=J,J=b)}else ie=J,J=b;return J}function It(){var J,Q,ae,re,de,ke;if(J=ie,Q=Kt(),Q!==b){for(ae=[],re=ie,de=At(),de===b&&(de=null),de!==b?(ke=Kt(),ke!==b?(de=[de,ke],re=de):(ie=re,re=b)):(ie=re,re=b);re!==b;)ae.push(re),re=ie,de=At(),de===b&&(de=null),de!==b?(ke=Kt(),ke!==b?(de=[de,ke],re=de):(ie=re,re=b)):(ie=re,re=b);ae!==b?(Q=C(Q,ae),J=Q):(ie=J,J=b)}else ie=J,J=b;return J}function Kt(){var J,Q,ae,re;return J=ie,Q=Dt(),Q!==b?(ae=At(),ae===b&&(ae=null),ae!==b?(re=Dt(),re!==b?(Q=W(Q,re),J=Q):(ie=J,J=b)):(ie=J,J=b)):(ie=J,J=b),J}function Ai(){var J,Q,ae,re;if(J=ie,H.test(y.charAt(ie))?(Q=y.charAt(ie),ie++):(Q=b,zt(K)),Q!==b){for(ae=[],re=Pt();re!==b;)ae.push(re),re=Pt();ae!==b?(re=ai(),re!==b?(Q=L(Q,re),J=Q):(ie=J,J=b)):(ie=J,J=b)}else ie=J,J=b;return J}function ai(){var J,Q,ae,re,de,ke;if(J=ie,Q=Dt(),Q!==b){for(ae=[],re=ie,de=At(),de===b&&(de=null),de!==b?(ke=Dt(),ke!==b?(de=[de,ke],re=de):(ie=re,re=b)):(ie=re,re=b);re!==b;)ae.push(re),re=ie,de=At(),de===b&&(de=null),de!==b?(ke=Dt(),ke!==b?(de=[de,ke],re=de):(ie=re,re=b)):(ie=re,re=b);ae!==b?(Q=C(Q,ae),J=Q):(ie=J,J=b)}else ie=J,J=b;return J}function qt(){var J,Q,ae,re;if(J=ie,le.test(y.charAt(ie))?(Q=y.charAt(ie),ie++):(Q=b,zt(me)),Q!==b){for(ae=[],re=Pt();re!==b;)ae.push(re),re=Pt();ae!==b?(re=Bt(),re!==b?(Q=L(Q,re),J=Q):(ie=J,J=b)):(ie=J,J=b)}else ie=J,J=b;return J}function Bt(){var J,Q,ae,re,de,ke;if(J=ie,Q=Vi(),Q!==b){for(ae=[],re=ie,de=At(),de===b&&(de=null),de!==b?(ke=Vi(),ke!==b?(de=[de,ke],re=de):(ie=re,re=b)):(ie=re,re=b);re!==b;)ae.push(re),re=ie,de=At(),de===b&&(de=null),de!==b?(ke=Vi(),ke!==b?(de=[de,ke],re=de):(ie=re,re=b)):(ie=re,re=b);ae!==b?(Q=C(Q,ae),J=Q):(ie=J,J=b)}else ie=J,J=b;return J}function Vi(){var J,Q,ae,re,de,ke,ia,Ga,na,Ya,ha,Qa;return J=ie,Q=Fi(),Q!==b?(ae=At(),ae===b&&(ae=null),ae!==b?(re=Fi(),re!==b?(de=At(),de===b&&(de=null),de!==b?(ke=Mi(),ke!==b?(ia=At(),ia!==b?(Ga=mi(),Ga!==b?(na=At(),na===b&&(na=null),na!==b?(Ya=mi(),Ya!==b?(ha=At(),ha===b&&(ha=null),ha!==b?(Qa=Dt(),Qa!==b?(Q=ne(Q,re,ke,Ga,Ya,Qa),J=Q):(ie=J,J=b)):(ie=J,J=b)):(ie=J,J=b)):(ie=J,J=b)):(ie=J,J=b)):(ie=J,J=b)):(ie=J,J=b)):(ie=J,J=b)):(ie=J,J=b)):(ie=J,J=b)):(ie=J,J=b),J}function Dt(){var J,Q,ae,re;return J=ie,Q=Mi(),Q!==b?(ae=At(),ae===b&&(ae=null),ae!==b?(re=Mi(),re!==b?(Q=pe(Q,re),J=Q):(ie=J,J=b)):(ie=J,J=b)):(ie=J,J=b),J}function Fi(){var J,Q;return J=ie,Q=os(),Q===b&&(Q=Ci()),Q!==b&&(Q=ge(Q)),J=Q,J}function Mi(){var J,Q,ae,re;return J=ie,Q=ie,ae=hi(),ae===b&&(ae=null),ae!==b?(re=os(),re!==b?(ae=[ae,re],Q=ae):(ie=Q,Q=b)):(ie=Q,Q=b),Q===b&&(Q=ie,ae=hi(),ae===b&&(ae=null),ae!==b?(re=Ci(),re!==b?(ae=[ae,re],Q=ae):(ie=Q,Q=b)):(ie=Q,Q=b)),Q!==b&&(Q=ye(Q)),J=Q,J}function mi(){var J,Q;return J=ie,_e.test(y.charAt(ie))?(Q=y.charAt(ie),ie++):(Q=b,zt(ve)),Q!==b&&(Q=Ee(Q)),J=Q,J}function At(){var J,Q,ae,re,de;if(J=ie,Q=[],ae=Pt(),ae!==b)for(;ae!==b;)Q.push(ae),ae=Pt();else Q=b;if(Q!==b)if(ae=wi(),ae===b&&(ae=null),ae!==b){for(re=[],de=Pt();de!==b;)re.push(de),de=Pt();re!==b?(Q=[Q,ae,re],J=Q):(ie=J,J=b)}else ie=J,J=b;else ie=J,J=b;if(J===b){if(J=ie,Q=ie,ae=wi(),ae!==b){for(re=[],de=Pt();de!==b;)re.push(de),de=Pt();re!==b?(ae=[ae,re],Q=ae):(ie=Q,Q=b)}else ie=Q,Q=b;Q!==b&&(Q=xe()),J=Q}return J}function wi(){var J;return y.charCodeAt(ie)===44?(J=Me,ie++):(J=b,zt(Pe)),J}function os(){var J,Q,ae,re;return J=ie,Q=ie,ae=ta(),ae!==b?(re=Si(),re===b&&(re=null),re!==b?(ae=[ae,re],Q=ae):(ie=Q,Q=b)):(ie=Q,Q=b),Q===b&&(Q=ie,ae=Ci(),ae!==b?(re=Si(),re!==b?(ae=[ae,re],Q=ae):(ie=Q,Q=b)):(ie=Q,Q=b)),Q!==b&&(Q=be(Q)),J=Q,J}function ta(){var J,Q,ae,re,de;return J=ie,Q=ie,ae=Ci(),ae===b&&(ae=null),ae!==b?(y.charCodeAt(ie)===46?(re=Oe,ie++):(re=b,zt(Be)),re!==b?(de=Ci(),de!==b?(ae=[ae,re,de],Q=ae):(ie=Q,Q=b)):(ie=Q,Q=b)):(ie=Q,Q=b),Q===b&&(Q=ie,ae=Ci(),ae!==b?(y.charCodeAt(ie)===46?(re=Oe,ie++):(re=b,zt(Be)),re!==b?(ae=[ae,re],Q=ae):(ie=Q,Q=b)):(ie=Q,Q=b)),Q!==b&&(Q=be(Q)),J=Q,J}function Si(){var J,Q,ae,re,de;return J=ie,Q=ie,oe.test(y.charAt(ie))?(ae=y.charAt(ie),ie++):(ae=b,zt(De)),ae!==b?(re=hi(),re===b&&(re=null),re!==b?(de=Ci(),de!==b?(ae=[ae,re,de],Q=ae):(ie=Q,Q=b)):(ie=Q,Q=b)):(ie=Q,Q=b),Q!==b&&(Q=be(Q)),J=Q,J}function hi(){var J;return ze.test(y.charAt(ie))?(J=y.charAt(ie),ie++):(J=b,zt(Ne)),J}function Ci(){var J,Q,ae;if(J=ie,Q=[],Le.test(y.charAt(ie))?(ae=y.charAt(ie),ie++):(ae=b,zt(bt)),ae!==b)for(;ae!==b;)Q.push(ae),Le.test(y.charAt(ie))?(ae=y.charAt(ie),ie++):(ae=b,zt(bt));else Q=b;return Q!==b&&(Q=Ve(Q)),J=Q,J}function Pt(){var J,Q;return J=ie,He.test(y.charAt(ie))?(Q=y.charAt(ie),ie++):(Q=b,zt(tt)),Q!==b&&(Q=xe()),J=Q,J}function ra(J,Q){if(!Q)return[J];for(var ae=[J],re=0,de=Q.length;re<de;re++)ae[re+1]=Q[re][1];return ae}var cs={m:"moveto",l:"lineto",h:"horizontal lineto",v:"vertical lineto",c:"curveto",s:"smooth curveto",q:"quadratic curveto",t:"smooth quadratic curveto",a:"elliptical arc",z:"closepath"};for(var kr in cs)cs[kr.toUpperCase()]=cs[kr];function es(J,Q){Q||(Q=[{}]);for(var ae=Q.length;ae--;){var re={code:J,command:cs[J]};J==J.toLowerCase()&&(re.relative=!0);for(var de in Q[ae])re[de]=Q[ae][de];Q[ae]=re}return Q}if(Ot=S(),Ot!==b&&ie===y.length)return Ot;throw Ot!==b&&ie<y.length&&zt(Rs()),zr(Nt,wt<y.length?y.charAt(wt):null,wt<y.length?is(wt,wt+1):is(wt,wt))}a.exports={SyntaxError:o,parse:f}}),gT=pc((r,a)=>{var n=GL().parse;n.parseSVG=n,n.makeAbsolute=o,a.exports=n;function o(f){var y,x={x:0,y:0},b={x:"x0",y:"y0",x1:"x0",y1:"y0",x2:"x0",y2:"y0"};return f.forEach(function(_){_.command==="moveto"&&(y=_),_.x0=x.x,_.y0=x.y;for(var S in b)S in _&&(_[S]+=_.relative?_[b[S]]:0);"x"in _||(_.x=x.x),"y"in _||(_.y=x.y),_.relative=!1,_.code=_.code.toUpperCase(),_.command=="closepath"&&(_.x=y.x,_.y=y.y),x=_}),f}}),IF=pc((r,a)=>{a.exports=function(n,o){for(var f=n.split("."),y=o.split("."),x=0;x<3;x++){var b=Number(f[x]),_=Number(y[x]);if(b>_)return 1;if(_>b)return-1;if(!isNaN(b)&&isNaN(_))return 1;if(isNaN(b)&&!isNaN(_))return-1}return 0}}),pa="149",qn=0,gi=1,tr=0,il=1,Bu=100,mP=204,gP=205,uS=3,yP=0,Ls=0,vP=300,sl=301,ol=302,oh=306,Bs=1e3,Jt=1001,fS=1002,yt=1003,it=1006,Ac=1008,Or=1009,Ft=1015,Xn=1016,pr=1023,Lp=1028,gn=3e3,ct=3001,fo="srgb",vp="srgb-linear",L1=7680,OV=519,pS=35044,my="300 es",gr=class{addEventListener(r,a){this._listeners===void 0&&(this._listeners={});let n=this._listeners;n[r]===void 0&&(n[r]=[]),n[r].indexOf(a)===-1&&n[r].push(a)}hasEventListener(r,a){if(this._listeners===void 0)return!1;let n=this._listeners;return n[r]!==void 0&&n[r].indexOf(a)!==-1}removeEventListener(r,a){if(this._listeners===void 0)return;let n=this._listeners[r];if(n!==void 0){let o=n.indexOf(a);o!==-1&&n.splice(o,1)}}dispatchEvent(r){if(this._listeners===void 0)return;let a=this._listeners[r.type];if(a!==void 0){r.target=this;let n=a.slice(0);for(let o=0,f=n.length;o<f;o++)n[o].call(this,r);r.target=null}}},sn=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],pC=1234567,fp=Math.PI/180,xp=180/Math.PI;function ss(){let r=Math.random()*4294967295|0,a=Math.random()*4294967295|0,n=Math.random()*4294967295|0,o=Math.random()*4294967295|0;return(sn[r&255]+sn[r>>8&255]+sn[r>>16&255]+sn[r>>24&255]+"-"+sn[a&255]+sn[a>>8&255]+"-"+sn[a>>16&15|64]+sn[a>>24&255]+"-"+sn[n&63|128]+sn[n>>8&255]+"-"+sn[n>>16&255]+sn[n>>24&255]+sn[o&255]+sn[o>>8&255]+sn[o>>16&255]+sn[o>>24&255]).toLowerCase()}function pi(r,a,n){return Math.max(a,Math.min(n,r))}function ZS(r,a){return(r%a+a)%a}function RV(r,a,n,o,f){return o+(r-a)*(f-o)/(n-a)}function LV(r,a,n){return r!==a?(n-r)/(a-r):0}function pp(r,a,n){return(1-n)*r+n*a}function BV(r,a,n,o){return pp(r,a,1-Math.exp(-n*o))}function NV(r,a=1){return a-Math.abs(ZS(r,a*2)-a)}function FV(r,a,n){return r<=a?0:r>=n?1:(r=(r-a)/(n-a),r*r*(3-2*r))}function VV(r,a,n){return r<=a?0:r>=n?1:(r=(r-a)/(n-a),r*r*r*(r*(r*6-15)+10))}function UV(r,a){return r+Math.floor(Math.random()*(a-r+1))}function zV(r,a){return r+Math.random()*(a-r)}function kV(r){return r*(.5-Math.random())}function GV(r){r!==void 0&&(pC=r);let a=pC+=1831565813;return a=Math.imul(a^a>>>15,a|1),a^=a+Math.imul(a^a>>>7,a|61),((a^a>>>14)>>>0)/4294967296}function jV(r){return r*fp}function HV(r){return r*xp}function gS(r){return(r&r-1)===0&&r!==0}function SP(r){return Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))}function gy(r){return Math.pow(2,Math.floor(Math.log(r)/Math.LN2))}function WV(r,a,n,o,f){let y=Math.cos,x=Math.sin,b=y(n/2),_=x(n/2),S=y((a+o)/2),A=x((a+o)/2),C=y((a-o)/2),P=x((a-o)/2),T=y((o-a)/2),M=x((o-a)/2);switch(f){case"XYX":r.set(b*A,_*C,_*P,b*S);break;case"YZY":r.set(_*P,b*A,_*C,b*S);break;case"ZXZ":r.set(_*C,_*P,b*A,b*S);break;case"XZX":r.set(b*A,_*M,_*T,b*S);break;case"YXY":r.set(_*T,b*A,_*M,b*S);break;case"ZYZ":r.set(_*M,_*T,b*A,b*S);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+f)}}function da(r,a){switch(a.constructor){case Float32Array:return r;case Uint16Array:return r/65535;case Uint8Array:return r/255;case Int16Array:return Math.max(r/32767,-1);case Int8Array:return Math.max(r/127,-1);default:throw new Error("Invalid component type.")}}function Sr(r,a){switch(a.constructor){case Float32Array:return r;case Uint16Array:return Math.round(r*65535);case Uint8Array:return Math.round(r*255);case Int16Array:return Math.round(r*32767);case Int8Array:return Math.round(r*127);default:throw new Error("Invalid component type.")}}var we=Object.freeze({__proto__:null,DEG2RAD:fp,RAD2DEG:xp,ceilPowerOfTwo:SP,clamp:pi,damp:BV,degToRad:jV,denormalize:da,euclideanModulo:ZS,floorPowerOfTwo:gy,generateUUID:ss,inverseLerp:LV,isPowerOfTwo:gS,lerp:pp,mapLinear:RV,normalize:Sr,pingpong:NV,radToDeg:HV,randFloat:zV,randFloatSpread:kV,randInt:UV,seededRandom:GV,setQuaternionFromProperEuler:WV,smootherstep:VV,smoothstep:FV}),V=class{constructor(r=0,a=0){V.prototype.isVector2=!0,this.x=r,this.y=a}get width(){return this.x}set width(r){this.x=r}get height(){return this.y}set height(r){this.y=r}set(r,a){return this.x=r,this.y=a,this}setScalar(r){return this.x=r,this.y=r,this}setX(r){return this.x=r,this}setY(r){return this.y=r,this}setComponent(r,a){switch(r){case 0:this.x=a;break;case 1:this.y=a;break;default:throw new Error("index is out of range: "+r)}return this}getComponent(r){switch(r){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+r)}}clone(){return new this.constructor(this.x,this.y)}copy(r){return this.x=r.x,this.y=r.y,this}add(r){return this.x+=r.x,this.y+=r.y,this}addScalar(r){return this.x+=r,this.y+=r,this}addVectors(r,a){return this.x=r.x+a.x,this.y=r.y+a.y,this}addScaledVector(r,a){return this.x+=r.x*a,this.y+=r.y*a,this}sub(r){return this.x-=r.x,this.y-=r.y,this}subScalar(r){return this.x-=r,this.y-=r,this}subVectors(r,a){return this.x=r.x-a.x,this.y=r.y-a.y,this}multiply(r){return this.x*=r.x,this.y*=r.y,this}multiplyScalar(r){return this.x*=r,this.y*=r,this}divide(r){return this.x/=r.x,this.y/=r.y,this}divideScalar(r){return this.multiplyScalar(1/r)}applyMatrix3(r){let a=this.x,n=this.y,o=r.elements;return this.x=o[0]*a+o[3]*n+o[6],this.y=o[1]*a+o[4]*n+o[7],this}min(r){return this.x=Math.min(this.x,r.x),this.y=Math.min(this.y,r.y),this}max(r){return this.x=Math.max(this.x,r.x),this.y=Math.max(this.y,r.y),this}clamp(r,a){return this.x=Math.max(r.x,Math.min(a.x,this.x)),this.y=Math.max(r.y,Math.min(a.y,this.y)),this}clampScalar(r,a){return this.x=Math.max(r,Math.min(a,this.x)),this.y=Math.max(r,Math.min(a,this.y)),this}clampLength(r,a){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(r,Math.min(a,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(r){return this.x*r.x+this.y*r.y}cross(r){return this.x*r.y-this.y*r.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(r){return Math.sqrt(this.distanceToSquared(r))}distanceToSquared(r){let a=this.x-r.x,n=this.y-r.y;return a*a+n*n}manhattanDistanceTo(r){return Math.abs(this.x-r.x)+Math.abs(this.y-r.y)}setLength(r){return this.normalize().multiplyScalar(r)}lerp(r,a){return this.x+=(r.x-this.x)*a,this.y+=(r.y-this.y)*a,this}lerpVectors(r,a,n){return this.x=r.x+(a.x-r.x)*n,this.y=r.y+(a.y-r.y)*n,this}equals(r){return r.x===this.x&&r.y===this.y}fromArray(r,a=0){return this.x=r[a],this.y=r[a+1],this}toArray(r=[],a=0){return r[a]=this.x,r[a+1]=this.y,r}fromBufferAttribute(r,a){return this.x=r.getX(a),this.y=r.getY(a),this}rotateAround(r,a){let n=Math.cos(a),o=Math.sin(a),f=this.x-r.x,y=this.y-r.y;return this.x=f*n-y*o+r.x,this.y=f*o+y*n+r.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},mr=class{constructor(){mr.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(r,a,n,o,f,y,x,b,_){let S=this.elements;return S[0]=r,S[1]=o,S[2]=x,S[3]=a,S[4]=f,S[5]=b,S[6]=n,S[7]=y,S[8]=_,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(r){let a=this.elements,n=r.elements;return a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[4]=n[4],a[5]=n[5],a[6]=n[6],a[7]=n[7],a[8]=n[8],this}extractBasis(r,a,n){return r.setFromMatrix3Column(this,0),a.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(r){let a=r.elements;return this.set(a[0],a[4],a[8],a[1],a[5],a[9],a[2],a[6],a[10]),this}multiply(r){return this.multiplyMatrices(this,r)}premultiply(r){return this.multiplyMatrices(r,this)}multiplyMatrices(r,a){let n=r.elements,o=a.elements,f=this.elements,y=n[0],x=n[3],b=n[6],_=n[1],S=n[4],A=n[7],C=n[2],P=n[5],T=n[8],M=o[0],O=o[3],I=o[6],D=o[1],z=o[4],k=o[7],L=o[2],R=o[5],F=o[8];return f[0]=y*M+x*D+b*L,f[3]=y*O+x*z+b*R,f[6]=y*I+x*k+b*F,f[1]=_*M+S*D+A*L,f[4]=_*O+S*z+A*R,f[7]=_*I+S*k+A*F,f[2]=C*M+P*D+T*L,f[5]=C*O+P*z+T*R,f[8]=C*I+P*k+T*F,this}multiplyScalar(r){let a=this.elements;return a[0]*=r,a[3]*=r,a[6]*=r,a[1]*=r,a[4]*=r,a[7]*=r,a[2]*=r,a[5]*=r,a[8]*=r,this}determinant(){let r=this.elements,a=r[0],n=r[1],o=r[2],f=r[3],y=r[4],x=r[5],b=r[6],_=r[7],S=r[8];return a*y*S-a*x*_-n*f*S+n*x*b+o*f*_-o*y*b}invert(){let r=this.elements,a=r[0],n=r[1],o=r[2],f=r[3],y=r[4],x=r[5],b=r[6],_=r[7],S=r[8],A=S*y-x*_,C=x*b-S*f,P=_*f-y*b,T=a*A+n*C+o*P;if(T===0)return this.set(0,0,0,0,0,0,0,0,0);let M=1/T;return r[0]=A*M,r[1]=(o*_-S*n)*M,r[2]=(x*n-o*y)*M,r[3]=C*M,r[4]=(S*a-o*b)*M,r[5]=(o*f-x*a)*M,r[6]=P*M,r[7]=(n*b-_*a)*M,r[8]=(y*a-n*f)*M,this}transpose(){let r,a=this.elements;return r=a[1],a[1]=a[3],a[3]=r,r=a[2],a[2]=a[6],a[6]=r,r=a[5],a[5]=a[7],a[7]=r,this}getNormalMatrix(r){return this.setFromMatrix4(r).invert().transpose()}transposeIntoArray(r){let a=this.elements;return r[0]=a[0],r[1]=a[3],r[2]=a[6],r[3]=a[1],r[4]=a[4],r[5]=a[7],r[6]=a[2],r[7]=a[5],r[8]=a[8],this}setUvTransform(r,a,n,o,f,y,x){let b=Math.cos(f),_=Math.sin(f);return this.set(n*b,n*_,-n*(b*y+_*x)+y+r,-o*_,o*b,-o*(-_*y+b*x)+x+a,0,0,1),this}scale(r,a){return this.premultiply(B1.makeScale(r,a)),this}rotate(r){return this.premultiply(B1.makeRotation(-r)),this}translate(r,a){return this.premultiply(B1.makeTranslation(r,a)),this}makeTranslation(r,a){return this.set(1,0,r,0,1,a,0,0,1),this}makeRotation(r){let a=Math.cos(r),n=Math.sin(r);return this.set(a,-n,0,n,a,0,0,0,1),this}makeScale(r,a){return this.set(r,0,0,0,a,0,0,0,1),this}equals(r){let a=this.elements,n=r.elements;for(let o=0;o<9;o++)if(a[o]!==n[o])return!1;return!0}fromArray(r,a=0){for(let n=0;n<9;n++)this.elements[n]=r[n+a];return this}toArray(r=[],a=0){let n=this.elements;return r[a]=n[0],r[a+1]=n[1],r[a+2]=n[2],r[a+3]=n[3],r[a+4]=n[4],r[a+5]=n[5],r[a+6]=n[6],r[a+7]=n[7],r[a+8]=n[8],r}clone(){return new this.constructor().fromArray(this.elements)}},B1=new mr;function wP(r){for(let a=r.length-1;a>=0;--a)if(r[a]>=65535)return!0;return!1}var qV={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Fg(r,a){return new qV[r](a)}function bp(r){return document.createElementNS("http://www.w3.org/1999/xhtml",r)}function wc(r){return r<.04045?r*.0773993808:Math.pow(r*.9478672986+.0521327014,2.4)}function hy(r){return r<.0031308?r*12.92:1.055*Math.pow(r,.41666)-.055}var N1={[fo]:{[vp]:wc},[vp]:{[fo]:hy}},fn={legacyMode:!0,get workingColorSpace(){return vp},set workingColorSpace(r){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(r,a,n){if(this.legacyMode||a===n||!a||!n)return r;if(N1[a]&&N1[a][n]!==void 0){let o=N1[a][n];return r.r=o(r.r),r.g=o(r.g),r.b=o(r.b),r}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(r,a){return this.convert(r,this.workingColorSpace,a)},toWorkingColorSpace:function(r,a){return this.convert(r,a,this.workingColorSpace)}},AP={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ti={r:0,g:0,b:0},Is={h:0,s:0,l:0},Vg={h:0,s:0,l:0};function F1(r,a,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?r+(a-r)*6*n:n<1/2?a:n<2/3?r+(a-r)*6*(2/3-n):r}function Ug(r,a){return a.r=r.r,a.g=r.g,a.b=r.b,a}var qe=class{constructor(r,a,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,a===void 0&&n===void 0?this.set(r):this.setRGB(r,a,n)}set(r){return r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r),this}setScalar(r){return this.r=r,this.g=r,this.b=r,this}setHex(r,a=fo){return r=Math.floor(r),this.r=(r>>16&255)/255,this.g=(r>>8&255)/255,this.b=(r&255)/255,fn.toWorkingColorSpace(this,a),this}setRGB(r,a,n,o=fn.workingColorSpace){return this.r=r,this.g=a,this.b=n,fn.toWorkingColorSpace(this,o),this}setHSL(r,a,n,o=fn.workingColorSpace){if(r=ZS(r,1),a=pi(a,0,1),n=pi(n,0,1),a===0)this.r=this.g=this.b=n;else{let f=n<=.5?n*(1+a):n+a-n*a,y=2*n-f;this.r=F1(y,f,r+1/3),this.g=F1(y,f,r),this.b=F1(y,f,r-1/3)}return fn.toWorkingColorSpace(this,o),this}setStyle(r,a=fo){function n(f){f!==void 0&&parseFloat(f)<1&&console.warn("THREE.Color: Alpha component of "+r+" will be ignored.")}let o;if(o=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(r)){let f,y=o[1],x=o[2];switch(y){case"rgb":case"rgba":if(f=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(x))return this.r=Math.min(255,parseInt(f[1],10))/255,this.g=Math.min(255,parseInt(f[2],10))/255,this.b=Math.min(255,parseInt(f[3],10))/255,fn.toWorkingColorSpace(this,a),n(f[4]),this;if(f=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(x))return this.r=Math.min(100,parseInt(f[1],10))/100,this.g=Math.min(100,parseInt(f[2],10))/100,this.b=Math.min(100,parseInt(f[3],10))/100,fn.toWorkingColorSpace(this,a),n(f[4]),this;break;case"hsl":case"hsla":if(f=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(x)){let b=parseFloat(f[1])/360,_=parseFloat(f[2])/100,S=parseFloat(f[3])/100;return n(f[4]),this.setHSL(b,_,S,a)}break}}else if(o=/^\#([A-Fa-f\d]+)$/.exec(r)){let f=o[1],y=f.length;if(y===3)return this.r=parseInt(f.charAt(0)+f.charAt(0),16)/255,this.g=parseInt(f.charAt(1)+f.charAt(1),16)/255,this.b=parseInt(f.charAt(2)+f.charAt(2),16)/255,fn.toWorkingColorSpace(this,a),this;if(y===6)return this.r=parseInt(f.charAt(0)+f.charAt(1),16)/255,this.g=parseInt(f.charAt(2)+f.charAt(3),16)/255,this.b=parseInt(f.charAt(4)+f.charAt(5),16)/255,fn.toWorkingColorSpace(this,a),this}return r&&r.length>0?this.setColorName(r,a):this}setColorName(r,a=fo){let n=AP[r.toLowerCase()];return n!==void 0?this.setHex(n,a):console.warn("THREE.Color: Unknown color "+r),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(r){return this.r=r.r,this.g=r.g,this.b=r.b,this}copySRGBToLinear(r){return this.r=wc(r.r),this.g=wc(r.g),this.b=wc(r.b),this}copyLinearToSRGB(r){return this.r=hy(r.r),this.g=hy(r.g),this.b=hy(r.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(r=fo){return fn.fromWorkingColorSpace(Ug(this,Ti),r),pi(Ti.r*255,0,255)<<16^pi(Ti.g*255,0,255)<<8^pi(Ti.b*255,0,255)<<0}getHexString(r=fo){return("000000"+this.getHex(r).toString(16)).slice(-6)}getHSL(r,a=fn.workingColorSpace){fn.fromWorkingColorSpace(Ug(this,Ti),a);let n=Ti.r,o=Ti.g,f=Ti.b,y=Math.max(n,o,f),x=Math.min(n,o,f),b,_,S=(x+y)/2;if(x===y)b=0,_=0;else{let A=y-x;switch(_=S<=.5?A/(y+x):A/(2-y-x),y){case n:b=(o-f)/A+(o<f?6:0);break;case o:b=(f-n)/A+2;break;case f:b=(n-o)/A+4;break}b/=6}return r.h=b,r.s=_,r.l=S,r}getRGB(r,a=fn.workingColorSpace){return fn.fromWorkingColorSpace(Ug(this,Ti),a),r.r=Ti.r,r.g=Ti.g,r.b=Ti.b,r}getStyle(r=fo){return fn.fromWorkingColorSpace(Ug(this,Ti),r),r!==fo?`color(${r} ${Ti.r} ${Ti.g} ${Ti.b})`:`rgb(${Ti.r*255|0},${Ti.g*255|0},${Ti.b*255|0})`}offsetHSL(r,a,n){return this.getHSL(Is),Is.h+=r,Is.s+=a,Is.l+=n,this.setHSL(Is.h,Is.s,Is.l),this}add(r){return this.r+=r.r,this.g+=r.g,this.b+=r.b,this}addColors(r,a){return this.r=r.r+a.r,this.g=r.g+a.g,this.b=r.b+a.b,this}addScalar(r){return this.r+=r,this.g+=r,this.b+=r,this}sub(r){return this.r=Math.max(0,this.r-r.r),this.g=Math.max(0,this.g-r.g),this.b=Math.max(0,this.b-r.b),this}multiply(r){return this.r*=r.r,this.g*=r.g,this.b*=r.b,this}multiplyScalar(r){return this.r*=r,this.g*=r,this.b*=r,this}lerp(r,a){return this.r+=(r.r-this.r)*a,this.g+=(r.g-this.g)*a,this.b+=(r.b-this.b)*a,this}lerpColors(r,a,n){return this.r=r.r+(a.r-r.r)*n,this.g=r.g+(a.g-r.g)*n,this.b=r.b+(a.b-r.b)*n,this}lerpHSL(r,a){this.getHSL(Is),r.getHSL(Vg);let n=pp(Is.h,Vg.h,a),o=pp(Is.s,Vg.s,a),f=pp(Is.l,Vg.l,a);return this.setHSL(n,o,f),this}equals(r){return r.r===this.r&&r.g===this.g&&r.b===this.b}fromArray(r,a=0){return this.r=r[a],this.g=r[a+1],this.b=r[a+2],this}toArray(r=[],a=0){return r[a]=this.r,r[a+1]=this.g,r[a+2]=this.b,r}fromBufferAttribute(r,a){return this.r=r.getX(a),this.g=r.getY(a),this.b=r.getZ(a),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};qe.NAMES=AP;var Su,yy=class{static getDataURL(r){if(/^data:/i.test(r.src)||typeof HTMLCanvasElement>"u")return r.src;let a;if(r instanceof HTMLCanvasElement)a=r;else{Su===void 0&&(Su=bp("canvas")),Su.width=r.width,Su.height=r.height;let n=Su.getContext("2d");r instanceof ImageData?n.putImageData(r,0,0):n.drawImage(r,0,0,r.width,r.height),a=Su}return a.width>2048||a.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",r),a.toDataURL("image/jpeg",.6)):a.toDataURL("image/png")}static sRGBToLinear(r){if(typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&r instanceof ImageBitmap){let a=bp("canvas");a.width=r.width,a.height=r.height;let n=a.getContext("2d");n.drawImage(r,0,0,r.width,r.height);let o=n.getImageData(0,0,r.width,r.height),f=o.data;for(let y=0;y<f.length;y++)f[y]=wc(f[y]/255)*255;return n.putImageData(o,0,0),a}else if(r.data){let a=r.data.slice(0);for(let n=0;n<a.length;n++)a instanceof Uint8Array||a instanceof Uint8ClampedArray?a[n]=Math.floor(wc(a[n]/255)*255):a[n]=wc(a[n]);return{data:a,width:r.width,height:r.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),r}},vy=class{constructor(r=null){this.isSource=!0,this.uuid=ss(),this.data=r,this.version=0}set needsUpdate(r){r===!0&&this.version++}toJSON(r){let a=r===void 0||typeof r=="string";if(!a&&r.images[this.uuid]!==void 0)return r.images[this.uuid];let n={uuid:this.uuid,url:""},o=this.data;if(o!==null){let f;if(Array.isArray(o)){f=[];for(let y=0,x=o.length;y<x;y++)o[y].isDataTexture?f.push(V1(o[y].image)):f.push(V1(o[y]))}else f=V1(o);n.url=f}return a||(r.images[this.uuid]=n),n}};function V1(r){return typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&r instanceof ImageBitmap?yy.getDataURL(r):r.data?{data:Array.from(r.data),width:r.width,height:r.height,type:r.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var YV=0,rr=class extends gr{constructor(r=rr.DEFAULT_IMAGE,a=rr.DEFAULT_MAPPING,n=Jt,o=Jt,f=it,y=Ac,x=pr,b=Or,_=rr.DEFAULT_ANISOTROPY,S=gn){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:YV++}),this.uuid=ss(),this.name="",this.source=new vy(r),this.mipmaps=[],this.mapping=a,this.wrapS=n,this.wrapT=o,this.magFilter=f,this.minFilter=y,this.anisotropy=_,this.format=x,this.internalFormat=null,this.type=b,this.offset=new V(0,0),this.repeat=new V(1,1),this.center=new V(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new mr,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=S,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(r){this.source.data=r}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(r){return this.name=r.name,this.source=r.source,this.mipmaps=r.mipmaps.slice(0),this.mapping=r.mapping,this.wrapS=r.wrapS,this.wrapT=r.wrapT,this.magFilter=r.magFilter,this.minFilter=r.minFilter,this.anisotropy=r.anisotropy,this.format=r.format,this.internalFormat=r.internalFormat,this.type=r.type,this.offset.copy(r.offset),this.repeat.copy(r.repeat),this.center.copy(r.center),this.rotation=r.rotation,this.matrixAutoUpdate=r.matrixAutoUpdate,this.matrix.copy(r.matrix),this.generateMipmaps=r.generateMipmaps,this.premultiplyAlpha=r.premultiplyAlpha,this.flipY=r.flipY,this.unpackAlignment=r.unpackAlignment,this.encoding=r.encoding,this.userData=JSON.parse(JSON.stringify(r.userData)),this.needsUpdate=!0,this}toJSON(r){let a=r===void 0||typeof r=="string";if(!a&&r.textures[this.uuid]!==void 0)return r.textures[this.uuid];let n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(r).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),a||(r.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(r){if(this.mapping!==vP)return r;if(r.applyMatrix3(this.matrix),r.x<0||r.x>1)switch(this.wrapS){case Bs:r.x=r.x-Math.floor(r.x);break;case Jt:r.x=r.x<0?0:1;break;case fS:Math.abs(Math.floor(r.x)%2)===1?r.x=Math.ceil(r.x)-r.x:r.x=r.x-Math.floor(r.x);break}if(r.y<0||r.y>1)switch(this.wrapT){case Bs:r.y=r.y-Math.floor(r.y);break;case Jt:r.y=r.y<0?0:1;break;case fS:Math.abs(Math.floor(r.y)%2)===1?r.y=Math.ceil(r.y)-r.y:r.y=r.y-Math.floor(r.y);break}return this.flipY&&(r.y=1-r.y),r}set needsUpdate(r){r===!0&&(this.version++,this.source.needsUpdate=!0)}};rr.DEFAULT_IMAGE=null;rr.DEFAULT_MAPPING=vP;rr.DEFAULT_ANISOTROPY=1;var Qe=class{constructor(r=0,a=0,n=0,o=1){Qe.prototype.isVector4=!0,this.x=r,this.y=a,this.z=n,this.w=o}get width(){return this.z}set width(r){this.z=r}get height(){return this.w}set height(r){this.w=r}set(r,a,n,o){return this.x=r,this.y=a,this.z=n,this.w=o,this}setScalar(r){return this.x=r,this.y=r,this.z=r,this.w=r,this}setX(r){return this.x=r,this}setY(r){return this.y=r,this}setZ(r){return this.z=r,this}setW(r){return this.w=r,this}setComponent(r,a){switch(r){case 0:this.x=a;break;case 1:this.y=a;break;case 2:this.z=a;break;case 3:this.w=a;break;default:throw new Error("index is out of range: "+r)}return this}getComponent(r){switch(r){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+r)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(r){return this.x=r.x,this.y=r.y,this.z=r.z,this.w=r.w!==void 0?r.w:1,this}add(r){return this.x+=r.x,this.y+=r.y,this.z+=r.z,this.w+=r.w,this}addScalar(r){return this.x+=r,this.y+=r,this.z+=r,this.w+=r,this}addVectors(r,a){return this.x=r.x+a.x,this.y=r.y+a.y,this.z=r.z+a.z,this.w=r.w+a.w,this}addScaledVector(r,a){return this.x+=r.x*a,this.y+=r.y*a,this.z+=r.z*a,this.w+=r.w*a,this}sub(r){return this.x-=r.x,this.y-=r.y,this.z-=r.z,this.w-=r.w,this}subScalar(r){return this.x-=r,this.y-=r,this.z-=r,this.w-=r,this}subVectors(r,a){return this.x=r.x-a.x,this.y=r.y-a.y,this.z=r.z-a.z,this.w=r.w-a.w,this}multiply(r){return this.x*=r.x,this.y*=r.y,this.z*=r.z,this.w*=r.w,this}multiplyScalar(r){return this.x*=r,this.y*=r,this.z*=r,this.w*=r,this}applyMatrix4(r){let a=this.x,n=this.y,o=this.z,f=this.w,y=r.elements;return this.x=y[0]*a+y[4]*n+y[8]*o+y[12]*f,this.y=y[1]*a+y[5]*n+y[9]*o+y[13]*f,this.z=y[2]*a+y[6]*n+y[10]*o+y[14]*f,this.w=y[3]*a+y[7]*n+y[11]*o+y[15]*f,this}divideScalar(r){return this.multiplyScalar(1/r)}setAxisAngleFromQuaternion(r){this.w=2*Math.acos(r.w);let a=Math.sqrt(1-r.w*r.w);return a<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=r.x/a,this.y=r.y/a,this.z=r.z/a),this}setAxisAngleFromRotationMatrix(r){let a,n,o,f,y=r.elements,x=y[0],b=y[4],_=y[8],S=y[1],A=y[5],C=y[9],P=y[2],T=y[6],M=y[10];if(Math.abs(b-S)<.01&&Math.abs(_-P)<.01&&Math.abs(C-T)<.01){if(Math.abs(b+S)<.1&&Math.abs(_+P)<.1&&Math.abs(C+T)<.1&&Math.abs(x+A+M-3)<.1)return this.set(1,0,0,0),this;a=Math.PI;let I=(x+1)/2,D=(A+1)/2,z=(M+1)/2,k=(b+S)/4,L=(_+P)/4,R=(C+T)/4;return I>D&&I>z?I<.01?(n=0,o=.707106781,f=.707106781):(n=Math.sqrt(I),o=k/n,f=L/n):D>z?D<.01?(n=.707106781,o=0,f=.707106781):(o=Math.sqrt(D),n=k/o,f=R/o):z<.01?(n=.707106781,o=.707106781,f=0):(f=Math.sqrt(z),n=L/f,o=R/f),this.set(n,o,f,a),this}let O=Math.sqrt((T-C)*(T-C)+(_-P)*(_-P)+(S-b)*(S-b));return Math.abs(O)<.001&&(O=1),this.x=(T-C)/O,this.y=(_-P)/O,this.z=(S-b)/O,this.w=Math.acos((x+A+M-1)/2),this}min(r){return this.x=Math.min(this.x,r.x),this.y=Math.min(this.y,r.y),this.z=Math.min(this.z,r.z),this.w=Math.min(this.w,r.w),this}max(r){return this.x=Math.max(this.x,r.x),this.y=Math.max(this.y,r.y),this.z=Math.max(this.z,r.z),this.w=Math.max(this.w,r.w),this}clamp(r,a){return this.x=Math.max(r.x,Math.min(a.x,this.x)),this.y=Math.max(r.y,Math.min(a.y,this.y)),this.z=Math.max(r.z,Math.min(a.z,this.z)),this.w=Math.max(r.w,Math.min(a.w,this.w)),this}clampScalar(r,a){return this.x=Math.max(r,Math.min(a,this.x)),this.y=Math.max(r,Math.min(a,this.y)),this.z=Math.max(r,Math.min(a,this.z)),this.w=Math.max(r,Math.min(a,this.w)),this}clampLength(r,a){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(r,Math.min(a,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(r){return this.x*r.x+this.y*r.y+this.z*r.z+this.w*r.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(r){return this.normalize().multiplyScalar(r)}lerp(r,a){return this.x+=(r.x-this.x)*a,this.y+=(r.y-this.y)*a,this.z+=(r.z-this.z)*a,this.w+=(r.w-this.w)*a,this}lerpVectors(r,a,n){return this.x=r.x+(a.x-r.x)*n,this.y=r.y+(a.y-r.y)*n,this.z=r.z+(a.z-r.z)*n,this.w=r.w+(a.w-r.w)*n,this}equals(r){return r.x===this.x&&r.y===this.y&&r.z===this.z&&r.w===this.w}fromArray(r,a=0){return this.x=r[a],this.y=r[a+1],this.z=r[a+2],this.w=r[a+3],this}toArray(r=[],a=0){return r[a]=this.x,r[a+1]=this.y,r[a+2]=this.z,r[a+3]=this.w,r}fromBufferAttribute(r,a){return this.x=r.getX(a),this.y=r.getY(a),this.z=r.getZ(a),this.w=r.getW(a),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},at=class extends gr{constructor(r=1,a=1,n={}){super(),this.isWebGLRenderTarget=!0,this.width=r,this.height=a,this.depth=1,this.scissor=new Qe(0,0,r,a),this.scissorTest=!1,this.viewport=new Qe(0,0,r,a);let o={width:r,height:a,depth:1};this.texture=new rr(o,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.internalFormat=n.internalFormat!==void 0?n.internalFormat:null,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:it,this.depthBuffer=n.depthBuffer!==void 0?n.depthBuffer:!0,this.stencilBuffer=n.stencilBuffer!==void 0?n.stencilBuffer:!1,this.depthTexture=n.depthTexture!==void 0?n.depthTexture:null,this.samples=n.samples!==void 0?n.samples:0}setSize(r,a,n=1){(this.width!==r||this.height!==a||this.depth!==n)&&(this.width=r,this.height=a,this.depth=n,this.texture.image.width=r,this.texture.image.height=a,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,r,a),this.scissor.set(0,0,r,a)}clone(){return new this.constructor().copy(this)}copy(r){this.width=r.width,this.height=r.height,this.depth=r.depth,this.viewport.copy(r.viewport),this.texture=r.texture.clone(),this.texture.isRenderTargetTexture=!0;let a=Object.assign({},r.texture.image);return this.texture.source=new vy(a),this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,r.depthTexture!==null&&(this.depthTexture=r.depthTexture.clone()),this.samples=r.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},xy=class extends rr{constructor(r=null,a=1,n=1,o=1){super(null),this.isDataArrayTexture=!0,this.image={data:r,width:a,height:n,depth:o},this.magFilter=yt,this.minFilter=yt,this.wrapR=Jt,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},by=class extends rr{constructor(r=null,a=1,n=1,o=1){super(null),this.isData3DTexture=!0,this.image={data:r,width:a,height:n,depth:o},this.magFilter=yt,this.minFilter=yt,this.wrapR=Jt,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},ku=class extends at{constructor(r=1,a=1,n=1,o={}){super(r,a,o),this.isWebGLMultipleRenderTargets=!0;let f=this.texture;this.texture=[];for(let y=0;y<n;y++)this.texture[y]=f.clone(),this.texture[y].isRenderTargetTexture=!0}setSize(r,a,n=1){if(this.width!==r||this.height!==a||this.depth!==n){this.width=r,this.height=a,this.depth=n;for(let o=0,f=this.texture.length;o<f;o++)this.texture[o].image.width=r,this.texture[o].image.height=a,this.texture[o].image.depth=n;this.dispose()}return this.viewport.set(0,0,r,a),this.scissor.set(0,0,r,a),this}copy(r){this.dispose(),this.width=r.width,this.height=r.height,this.depth=r.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,r.depthTexture!==null&&(this.depthTexture=r.depthTexture.clone()),this.texture.length=0;for(let a=0,n=r.texture.length;a<n;a++)this.texture[a]=r.texture[a].clone(),this.texture[a].isRenderTargetTexture=!0;return this}},Ke=class{constructor(r=0,a=0,n=0,o=1){this.isQuaternion=!0,this._x=r,this._y=a,this._z=n,this._w=o}static slerpFlat(r,a,n,o,f,y,x){let b=n[o+0],_=n[o+1],S=n[o+2],A=n[o+3],C=f[y+0],P=f[y+1],T=f[y+2],M=f[y+3];if(x===0){r[a+0]=b,r[a+1]=_,r[a+2]=S,r[a+3]=A;return}if(x===1){r[a+0]=C,r[a+1]=P,r[a+2]=T,r[a+3]=M;return}if(A!==M||b!==C||_!==P||S!==T){let O=1-x,I=b*C+_*P+S*T+A*M,D=I>=0?1:-1,z=1-I*I;if(z>Number.EPSILON){let L=Math.sqrt(z),R=Math.atan2(L,I*D);O=Math.sin(O*R)/L,x=Math.sin(x*R)/L}let k=x*D;if(b=b*O+C*k,_=_*O+P*k,S=S*O+T*k,A=A*O+M*k,O===1-x){let L=1/Math.sqrt(b*b+_*_+S*S+A*A);b*=L,_*=L,S*=L,A*=L}}r[a]=b,r[a+1]=_,r[a+2]=S,r[a+3]=A}static multiplyQuaternionsFlat(r,a,n,o,f,y){let x=n[o],b=n[o+1],_=n[o+2],S=n[o+3],A=f[y],C=f[y+1],P=f[y+2],T=f[y+3];return r[a]=x*T+S*A+b*P-_*C,r[a+1]=b*T+S*C+_*A-x*P,r[a+2]=_*T+S*P+x*C-b*A,r[a+3]=S*T-x*A-b*C-_*P,r}get x(){return this._x}set x(r){this._x=r,this._onChangeCallback()}get y(){return this._y}set y(r){this._y=r,this._onChangeCallback()}get z(){return this._z}set z(r){this._z=r,this._onChangeCallback()}get w(){return this._w}set w(r){this._w=r,this._onChangeCallback()}set(r,a,n,o){return this._x=r,this._y=a,this._z=n,this._w=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(r){return this._x=r.x,this._y=r.y,this._z=r.z,this._w=r.w,this._onChangeCallback(),this}setFromEuler(r,a){let n=r._x,o=r._y,f=r._z,y=r._order,x=Math.cos,b=Math.sin,_=x(n/2),S=x(o/2),A=x(f/2),C=b(n/2),P=b(o/2),T=b(f/2);switch(y){case"XYZ":this._x=C*S*A+_*P*T,this._y=_*P*A-C*S*T,this._z=_*S*T+C*P*A,this._w=_*S*A-C*P*T;break;case"YXZ":this._x=C*S*A+_*P*T,this._y=_*P*A-C*S*T,this._z=_*S*T-C*P*A,this._w=_*S*A+C*P*T;break;case"ZXY":this._x=C*S*A-_*P*T,this._y=_*P*A+C*S*T,this._z=_*S*T+C*P*A,this._w=_*S*A-C*P*T;break;case"ZYX":this._x=C*S*A-_*P*T,this._y=_*P*A+C*S*T,this._z=_*S*T-C*P*A,this._w=_*S*A+C*P*T;break;case"YZX":this._x=C*S*A+_*P*T,this._y=_*P*A+C*S*T,this._z=_*S*T-C*P*A,this._w=_*S*A-C*P*T;break;case"XZY":this._x=C*S*A-_*P*T,this._y=_*P*A-C*S*T,this._z=_*S*T+C*P*A,this._w=_*S*A+C*P*T;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+y)}return a!==!1&&this._onChangeCallback(),this}setFromAxisAngle(r,a){let n=a/2,o=Math.sin(n);return this._x=r.x*o,this._y=r.y*o,this._z=r.z*o,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(r){let a=r.elements,n=a[0],o=a[4],f=a[8],y=a[1],x=a[5],b=a[9],_=a[2],S=a[6],A=a[10],C=n+x+A;if(C>0){let P=.5/Math.sqrt(C+1);this._w=.25/P,this._x=(S-b)*P,this._y=(f-_)*P,this._z=(y-o)*P}else if(n>x&&n>A){let P=2*Math.sqrt(1+n-x-A);this._w=(S-b)/P,this._x=.25*P,this._y=(o+y)/P,this._z=(f+_)/P}else if(x>A){let P=2*Math.sqrt(1+x-n-A);this._w=(f-_)/P,this._x=(o+y)/P,this._y=.25*P,this._z=(b+S)/P}else{let P=2*Math.sqrt(1+A-n-x);this._w=(y-o)/P,this._x=(f+_)/P,this._y=(b+S)/P,this._z=.25*P}return this._onChangeCallback(),this}setFromUnitVectors(r,a){let n=r.dot(a)+1;return n<Number.EPSILON?(n=0,Math.abs(r.x)>Math.abs(r.z)?(this._x=-r.y,this._y=r.x,this._z=0,this._w=n):(this._x=0,this._y=-r.z,this._z=r.y,this._w=n)):(this._x=r.y*a.z-r.z*a.y,this._y=r.z*a.x-r.x*a.z,this._z=r.x*a.y-r.y*a.x,this._w=n),this.normalize()}angleTo(r){return 2*Math.acos(Math.abs(pi(this.dot(r),-1,1)))}rotateTowards(r,a){let n=this.angleTo(r);if(n===0)return this;let o=Math.min(1,a/n);return this.slerp(r,o),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(r){return this._x*r._x+this._y*r._y+this._z*r._z+this._w*r._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let r=this.length();return r===0?(this._x=0,this._y=0,this._z=0,this._w=1):(r=1/r,this._x=this._x*r,this._y=this._y*r,this._z=this._z*r,this._w=this._w*r),this._onChangeCallback(),this}multiply(r){return this.multiplyQuaternions(this,r)}premultiply(r){return this.multiplyQuaternions(r,this)}multiplyQuaternions(r,a){let n=r._x,o=r._y,f=r._z,y=r._w,x=a._x,b=a._y,_=a._z,S=a._w;return this._x=n*S+y*x+o*_-f*b,this._y=o*S+y*b+f*x-n*_,this._z=f*S+y*_+n*b-o*x,this._w=y*S-n*x-o*b-f*_,this._onChangeCallback(),this}slerp(r,a){if(a===0)return this;if(a===1)return this.copy(r);let n=this._x,o=this._y,f=this._z,y=this._w,x=y*r._w+n*r._x+o*r._y+f*r._z;if(x<0?(this._w=-r._w,this._x=-r._x,this._y=-r._y,this._z=-r._z,x=-x):this.copy(r),x>=1)return this._w=y,this._x=n,this._y=o,this._z=f,this;let b=1-x*x;if(b<=Number.EPSILON){let P=1-a;return this._w=P*y+a*this._w,this._x=P*n+a*this._x,this._y=P*o+a*this._y,this._z=P*f+a*this._z,this.normalize(),this._onChangeCallback(),this}let _=Math.sqrt(b),S=Math.atan2(_,x),A=Math.sin((1-a)*S)/_,C=Math.sin(a*S)/_;return this._w=y*A+this._w*C,this._x=n*A+this._x*C,this._y=o*A+this._y*C,this._z=f*A+this._z*C,this._onChangeCallback(),this}slerpQuaternions(r,a,n){return this.copy(r).slerp(a,n)}random(){let r=Math.random(),a=Math.sqrt(1-r),n=Math.sqrt(r),o=2*Math.PI*Math.random(),f=2*Math.PI*Math.random();return this.set(a*Math.cos(o),n*Math.sin(f),n*Math.cos(f),a*Math.sin(o))}equals(r){return r._x===this._x&&r._y===this._y&&r._z===this._z&&r._w===this._w}fromArray(r,a=0){return this._x=r[a],this._y=r[a+1],this._z=r[a+2],this._w=r[a+3],this._onChangeCallback(),this}toArray(r=[],a=0){return r[a]=this._x,r[a+1]=this._y,r[a+2]=this._z,r[a+3]=this._w,r}fromBufferAttribute(r,a){return this._x=r.getX(a),this._y=r.getY(a),this._z=r.getZ(a),this._w=r.getW(a),this}_onChange(r){return this._onChangeCallback=r,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},E=class{constructor(r=0,a=0,n=0){E.prototype.isVector3=!0,this.x=r,this.y=a,this.z=n}set(r,a,n){return n===void 0&&(n=this.z),this.x=r,this.y=a,this.z=n,this}setScalar(r){return this.x=r,this.y=r,this.z=r,this}setX(r){return this.x=r,this}setY(r){return this.y=r,this}setZ(r){return this.z=r,this}setComponent(r,a){switch(r){case 0:this.x=a;break;case 1:this.y=a;break;case 2:this.z=a;break;default:throw new Error("index is out of range: "+r)}return this}getComponent(r){switch(r){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+r)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(r){return this.x=r.x,this.y=r.y,this.z=r.z,this}add(r){return this.x+=r.x,this.y+=r.y,this.z+=r.z,this}addScalar(r){return this.x+=r,this.y+=r,this.z+=r,this}addVectors(r,a){return this.x=r.x+a.x,this.y=r.y+a.y,this.z=r.z+a.z,this}addScaledVector(r,a){return this.x+=r.x*a,this.y+=r.y*a,this.z+=r.z*a,this}sub(r){return this.x-=r.x,this.y-=r.y,this.z-=r.z,this}subScalar(r){return this.x-=r,this.y-=r,this.z-=r,this}subVectors(r,a){return this.x=r.x-a.x,this.y=r.y-a.y,this.z=r.z-a.z,this}multiply(r){return this.x*=r.x,this.y*=r.y,this.z*=r.z,this}multiplyScalar(r){return this.x*=r,this.y*=r,this.z*=r,this}multiplyVectors(r,a){return this.x=r.x*a.x,this.y=r.y*a.y,this.z=r.z*a.z,this}applyEuler(r){return this.applyQuaternion(mC.setFromEuler(r))}applyAxisAngle(r,a){return this.applyQuaternion(mC.setFromAxisAngle(r,a))}applyMatrix3(r){let a=this.x,n=this.y,o=this.z,f=r.elements;return this.x=f[0]*a+f[3]*n+f[6]*o,this.y=f[1]*a+f[4]*n+f[7]*o,this.z=f[2]*a+f[5]*n+f[8]*o,this}applyNormalMatrix(r){return this.applyMatrix3(r).normalize()}applyMatrix4(r){let a=this.x,n=this.y,o=this.z,f=r.elements,y=1/(f[3]*a+f[7]*n+f[11]*o+f[15]);return this.x=(f[0]*a+f[4]*n+f[8]*o+f[12])*y,this.y=(f[1]*a+f[5]*n+f[9]*o+f[13])*y,this.z=(f[2]*a+f[6]*n+f[10]*o+f[14])*y,this}applyQuaternion(r){let a=this.x,n=this.y,o=this.z,f=r.x,y=r.y,x=r.z,b=r.w,_=b*a+y*o-x*n,S=b*n+x*a-f*o,A=b*o+f*n-y*a,C=-f*a-y*n-x*o;return this.x=_*b+C*-f+S*-x-A*-y,this.y=S*b+C*-y+A*-f-_*-x,this.z=A*b+C*-x+_*-y-S*-f,this}project(r){return this.applyMatrix4(r.matrixWorldInverse).applyMatrix4(r.projectionMatrix)}unproject(r){return this.applyMatrix4(r.projectionMatrixInverse).applyMatrix4(r.matrixWorld)}transformDirection(r){let a=this.x,n=this.y,o=this.z,f=r.elements;return this.x=f[0]*a+f[4]*n+f[8]*o,this.y=f[1]*a+f[5]*n+f[9]*o,this.z=f[2]*a+f[6]*n+f[10]*o,this.normalize()}divide(r){return this.x/=r.x,this.y/=r.y,this.z/=r.z,this}divideScalar(r){return this.multiplyScalar(1/r)}min(r){return this.x=Math.min(this.x,r.x),this.y=Math.min(this.y,r.y),this.z=Math.min(this.z,r.z),this}max(r){return this.x=Math.max(this.x,r.x),this.y=Math.max(this.y,r.y),this.z=Math.max(this.z,r.z),this}clamp(r,a){return this.x=Math.max(r.x,Math.min(a.x,this.x)),this.y=Math.max(r.y,Math.min(a.y,this.y)),this.z=Math.max(r.z,Math.min(a.z,this.z)),this}clampScalar(r,a){return this.x=Math.max(r,Math.min(a,this.x)),this.y=Math.max(r,Math.min(a,this.y)),this.z=Math.max(r,Math.min(a,this.z)),this}clampLength(r,a){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(r,Math.min(a,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(r){return this.x*r.x+this.y*r.y+this.z*r.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(r){return this.normalize().multiplyScalar(r)}lerp(r,a){return this.x+=(r.x-this.x)*a,this.y+=(r.y-this.y)*a,this.z+=(r.z-this.z)*a,this}lerpVectors(r,a,n){return this.x=r.x+(a.x-r.x)*n,this.y=r.y+(a.y-r.y)*n,this.z=r.z+(a.z-r.z)*n,this}cross(r){return this.crossVectors(this,r)}crossVectors(r,a){let n=r.x,o=r.y,f=r.z,y=a.x,x=a.y,b=a.z;return this.x=o*b-f*x,this.y=f*y-n*b,this.z=n*x-o*y,this}projectOnVector(r){let a=r.lengthSq();if(a===0)return this.set(0,0,0);let n=r.dot(this)/a;return this.copy(r).multiplyScalar(n)}projectOnPlane(r){return U1.copy(this).projectOnVector(r),this.sub(U1)}reflect(r){return this.sub(U1.copy(r).multiplyScalar(2*this.dot(r)))}angleTo(r){let a=Math.sqrt(this.lengthSq()*r.lengthSq());if(a===0)return Math.PI/2;let n=this.dot(r)/a;return Math.acos(pi(n,-1,1))}distanceTo(r){return Math.sqrt(this.distanceToSquared(r))}distanceToSquared(r){let a=this.x-r.x,n=this.y-r.y,o=this.z-r.z;return a*a+n*n+o*o}manhattanDistanceTo(r){return Math.abs(this.x-r.x)+Math.abs(this.y-r.y)+Math.abs(this.z-r.z)}setFromSpherical(r){return this.setFromSphericalCoords(r.radius,r.phi,r.theta)}setFromSphericalCoords(r,a,n){let o=Math.sin(a)*r;return this.x=o*Math.sin(n),this.y=Math.cos(a)*r,this.z=o*Math.cos(n),this}setFromCylindrical(r){return this.setFromCylindricalCoords(r.radius,r.theta,r.y)}setFromCylindricalCoords(r,a,n){return this.x=r*Math.sin(a),this.y=n,this.z=r*Math.cos(a),this}setFromMatrixPosition(r){let a=r.elements;return this.x=a[12],this.y=a[13],this.z=a[14],this}setFromMatrixScale(r){let a=this.setFromMatrixColumn(r,0).length(),n=this.setFromMatrixColumn(r,1).length(),o=this.setFromMatrixColumn(r,2).length();return this.x=a,this.y=n,this.z=o,this}setFromMatrixColumn(r,a){return this.fromArray(r.elements,a*4)}setFromMatrix3Column(r,a){return this.fromArray(r.elements,a*3)}setFromEuler(r){return this.x=r._x,this.y=r._y,this.z=r._z,this}equals(r){return r.x===this.x&&r.y===this.y&&r.z===this.z}fromArray(r,a=0){return this.x=r[a],this.y=r[a+1],this.z=r[a+2],this}toArray(r=[],a=0){return r[a]=this.x,r[a+1]=this.y,r[a+2]=this.z,r}fromBufferAttribute(r,a){return this.x=r.getX(a),this.y=r.getY(a),this.z=r.getZ(a),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let r=(Math.random()-.5)*2,a=Math.random()*Math.PI*2,n=Math.sqrt(1-r**2);return this.x=n*Math.cos(a),this.y=n*Math.sin(a),this.z=r,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},U1=new E,mC=new Ke,Xt=class{constructor(r=new E(1/0,1/0,1/0),a=new E(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=r,this.max=a}set(r,a){return this.min.copy(r),this.max.copy(a),this}setFromArray(r){let a=1/0,n=1/0,o=1/0,f=-1/0,y=-1/0,x=-1/0;for(let b=0,_=r.length;b<_;b+=3){let S=r[b],A=r[b+1],C=r[b+2];S<a&&(a=S),A<n&&(n=A),C<o&&(o=C),S>f&&(f=S),A>y&&(y=A),C>x&&(x=C)}return this.min.set(a,n,o),this.max.set(f,y,x),this}setFromBufferAttribute(r){let a=1/0,n=1/0,o=1/0,f=-1/0,y=-1/0,x=-1/0;for(let b=0,_=r.count;b<_;b++){let S=r.getX(b),A=r.getY(b),C=r.getZ(b);S<a&&(a=S),A<n&&(n=A),C<o&&(o=C),S>f&&(f=S),A>y&&(y=A),C>x&&(x=C)}return this.min.set(a,n,o),this.max.set(f,y,x),this}setFromPoints(r){this.makeEmpty();for(let a=0,n=r.length;a<n;a++)this.expandByPoint(r[a]);return this}setFromCenterAndSize(r,a){let n=gc.copy(a).multiplyScalar(.5);return this.min.copy(r).sub(n),this.max.copy(r).add(n),this}setFromObject(r,a=!1){return this.makeEmpty(),this.expandByObject(r,a)}clone(){return new this.constructor().copy(this)}copy(r){return this.min.copy(r.min),this.max.copy(r.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(r){return this.isEmpty()?r.set(0,0,0):r.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(r){return this.isEmpty()?r.set(0,0,0):r.subVectors(this.max,this.min)}expandByPoint(r){return this.min.min(r),this.max.max(r),this}expandByVector(r){return this.min.sub(r),this.max.add(r),this}expandByScalar(r){return this.min.addScalar(-r),this.max.addScalar(r),this}expandByObject(r,a=!1){r.updateWorldMatrix(!1,!1);let n=r.geometry;if(n!==void 0)if(a&&n.attributes!=null&&n.attributes.position!==void 0){let f=n.attributes.position;for(let y=0,x=f.count;y<x;y++)gc.fromBufferAttribute(f,y).applyMatrix4(r.matrixWorld),this.expandByPoint(gc)}else n.boundingBox===null&&n.computeBoundingBox(),z1.copy(n.boundingBox),z1.applyMatrix4(r.matrixWorld),this.union(z1);let o=r.children;for(let f=0,y=o.length;f<y;f++)this.expandByObject(o[f],a);return this}containsPoint(r){return!(r.x<this.min.x||r.x>this.max.x||r.y<this.min.y||r.y>this.max.y||r.z<this.min.z||r.z>this.max.z)}containsBox(r){return this.min.x<=r.min.x&&r.max.x<=this.max.x&&this.min.y<=r.min.y&&r.max.y<=this.max.y&&this.min.z<=r.min.z&&r.max.z<=this.max.z}getParameter(r,a){return a.set((r.x-this.min.x)/(this.max.x-this.min.x),(r.y-this.min.y)/(this.max.y-this.min.y),(r.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(r){return!(r.max.x<this.min.x||r.min.x>this.max.x||r.max.y<this.min.y||r.min.y>this.max.y||r.max.z<this.min.z||r.min.z>this.max.z)}intersectsSphere(r){return this.clampPoint(r.center,gc),gc.distanceToSquared(r.center)<=r.radius*r.radius}intersectsPlane(r){let a,n;return r.normal.x>0?(a=r.normal.x*this.min.x,n=r.normal.x*this.max.x):(a=r.normal.x*this.max.x,n=r.normal.x*this.min.x),r.normal.y>0?(a+=r.normal.y*this.min.y,n+=r.normal.y*this.max.y):(a+=r.normal.y*this.max.y,n+=r.normal.y*this.min.y),r.normal.z>0?(a+=r.normal.z*this.min.z,n+=r.normal.z*this.max.z):(a+=r.normal.z*this.max.z,n+=r.normal.z*this.min.z),a<=-r.constant&&n>=-r.constant}intersectsTriangle(r){if(this.isEmpty())return!1;this.getCenter(rp),zg.subVectors(this.max,rp),wu.subVectors(r.a,rp),Au.subVectors(r.b,rp),Eu.subVectors(r.c,rp),Ja.subVectors(Au,wu),$a.subVectors(Eu,Au),yc.subVectors(wu,Eu);let a=[0,-Ja.z,Ja.y,0,-$a.z,$a.y,0,-yc.z,yc.y,Ja.z,0,-Ja.x,$a.z,0,-$a.x,yc.z,0,-yc.x,-Ja.y,Ja.x,0,-$a.y,$a.x,0,-yc.y,yc.x,0];return!k1(a,wu,Au,Eu,zg)||(a=[1,0,0,0,1,0,0,0,1],!k1(a,wu,Au,Eu,zg))?!1:(kg.crossVectors(Ja,$a),a=[kg.x,kg.y,kg.z],k1(a,wu,Au,Eu,zg))}clampPoint(r,a){return a.copy(r).clamp(this.min,this.max)}distanceToPoint(r){return gc.copy(r).clamp(this.min,this.max).sub(r).length()}getBoundingSphere(r){return this.getCenter(r.center),r.radius=this.getSize(gc).length()*.5,r}intersect(r){return this.min.max(r.min),this.max.min(r.max),this.isEmpty()&&this.makeEmpty(),this}union(r){return this.min.min(r.min),this.max.max(r.max),this}applyMatrix4(r){return this.isEmpty()?this:(sa[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(r),sa[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(r),sa[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(r),sa[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(r),sa[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(r),sa[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(r),sa[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(r),sa[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(r),this.setFromPoints(sa),this)}translate(r){return this.min.add(r),this.max.add(r),this}equals(r){return r.min.equals(this.min)&&r.max.equals(this.max)}},sa=[new E,new E,new E,new E,new E,new E,new E,new E],gc=new E,z1=new Xt,wu=new E,Au=new E,Eu=new E,Ja=new E,$a=new E,yc=new E,rp=new E,zg=new E,kg=new E,vc=new E;function k1(r,a,n,o,f){for(let y=0,x=r.length-3;y<=x;y+=3){vc.fromArray(r,y);let b=f.x*Math.abs(vc.x)+f.y*Math.abs(vc.y)+f.z*Math.abs(vc.z),_=a.dot(vc),S=n.dot(vc),A=o.dot(vc);if(Math.max(-Math.max(_,S,A),Math.min(_,S,A))>b)return!1}return!0}var KV=new Xt,ip$2=new E,G1=new E,Nr=class{constructor(r=new E,a=-1){this.center=r,this.radius=a}set(r,a){return this.center.copy(r),this.radius=a,this}setFromPoints(r,a){let n=this.center;a!==void 0?n.copy(a):KV.setFromPoints(r).getCenter(n);let o=0;for(let f=0,y=r.length;f<y;f++)o=Math.max(o,n.distanceToSquared(r[f]));return this.radius=Math.sqrt(o),this}copy(r){return this.center.copy(r.center),this.radius=r.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(r){return r.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(r){return r.distanceTo(this.center)-this.radius}intersectsSphere(r){let a=this.radius+r.radius;return r.center.distanceToSquared(this.center)<=a*a}intersectsBox(r){return r.intersectsSphere(this)}intersectsPlane(r){return Math.abs(r.distanceToPoint(this.center))<=this.radius}clampPoint(r,a){let n=this.center.distanceToSquared(r);return a.copy(r),n>this.radius*this.radius&&(a.sub(this.center).normalize(),a.multiplyScalar(this.radius).add(this.center)),a}getBoundingBox(r){return this.isEmpty()?(r.makeEmpty(),r):(r.set(this.center,this.center),r.expandByScalar(this.radius),r)}applyMatrix4(r){return this.center.applyMatrix4(r),this.radius=this.radius*r.getMaxScaleOnAxis(),this}translate(r){return this.center.add(r),this}expandByPoint(r){if(this.isEmpty())return this.center.copy(r),this.radius=0,this;ip$2.subVectors(r,this.center);let a=ip$2.lengthSq();if(a>this.radius*this.radius){let n=Math.sqrt(a),o=(n-this.radius)*.5;this.center.addScaledVector(ip$2,o/n),this.radius+=o}return this}union(r){return r.isEmpty()?this:this.isEmpty()?(this.copy(r),this):(this.center.equals(r.center)===!0?this.radius=Math.max(this.radius,r.radius):(G1.subVectors(r.center,this.center).setLength(r.radius),this.expandByPoint(ip$2.copy(r.center).add(G1)),this.expandByPoint(ip$2.copy(r.center).sub(G1))),this)}equals(r){return r.center.equals(this.center)&&r.radius===this.radius}clone(){return new this.constructor().copy(this)}},oa=new E,j1=new E,Gg=new E,el=new E,H1=new E,jg=new E,W1=new E,Ns=class{constructor(r=new E,a=new E(0,0,-1)){this.origin=r,this.direction=a}set(r,a){return this.origin.copy(r),this.direction.copy(a),this}copy(r){return this.origin.copy(r.origin),this.direction.copy(r.direction),this}at(r,a){return a.copy(this.direction).multiplyScalar(r).add(this.origin)}lookAt(r){return this.direction.copy(r).sub(this.origin).normalize(),this}recast(r){return this.origin.copy(this.at(r,oa)),this}closestPointToPoint(r,a){a.subVectors(r,this.origin);let n=a.dot(this.direction);return n<0?a.copy(this.origin):a.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(r){return Math.sqrt(this.distanceSqToPoint(r))}distanceSqToPoint(r){let a=oa.subVectors(r,this.origin).dot(this.direction);return a<0?this.origin.distanceToSquared(r):(oa.copy(this.direction).multiplyScalar(a).add(this.origin),oa.distanceToSquared(r))}distanceSqToSegment(r,a,n,o){j1.copy(r).add(a).multiplyScalar(.5),Gg.copy(a).sub(r).normalize(),el.copy(this.origin).sub(j1);let f=r.distanceTo(a)*.5,y=-this.direction.dot(Gg),x=el.dot(this.direction),b=-el.dot(Gg),_=el.lengthSq(),S=Math.abs(1-y*y),A,C,P,T;if(S>0)if(A=y*b-x,C=y*x-b,T=f*S,A>=0)if(C>=-T)if(C<=T){let M=1/S;A*=M,C*=M,P=A*(A+y*C+2*x)+C*(y*A+C+2*b)+_}else C=f,A=Math.max(0,-(y*C+x)),P=-A*A+C*(C+2*b)+_;else C=-f,A=Math.max(0,-(y*C+x)),P=-A*A+C*(C+2*b)+_;else C<=-T?(A=Math.max(0,-(-y*f+x)),C=A>0?-f:Math.min(Math.max(-f,-b),f),P=-A*A+C*(C+2*b)+_):C<=T?(A=0,C=Math.min(Math.max(-f,-b),f),P=C*(C+2*b)+_):(A=Math.max(0,-(y*f+x)),C=A>0?f:Math.min(Math.max(-f,-b),f),P=-A*A+C*(C+2*b)+_);else C=y>0?-f:f,A=Math.max(0,-(y*C+x)),P=-A*A+C*(C+2*b)+_;return n&&n.copy(this.direction).multiplyScalar(A).add(this.origin),o&&o.copy(Gg).multiplyScalar(C).add(j1),P}intersectSphere(r,a){oa.subVectors(r.center,this.origin);let n=oa.dot(this.direction),o=oa.dot(oa)-n*n,f=r.radius*r.radius;if(o>f)return null;let y=Math.sqrt(f-o),x=n-y,b=n+y;return x<0&&b<0?null:x<0?this.at(b,a):this.at(x,a)}intersectsSphere(r){return this.distanceSqToPoint(r.center)<=r.radius*r.radius}distanceToPlane(r){let a=r.normal.dot(this.direction);if(a===0)return r.distanceToPoint(this.origin)===0?0:null;let n=-(this.origin.dot(r.normal)+r.constant)/a;return n>=0?n:null}intersectPlane(r,a){let n=this.distanceToPlane(r);return n===null?null:this.at(n,a)}intersectsPlane(r){let a=r.distanceToPoint(this.origin);return a===0||r.normal.dot(this.direction)*a<0}intersectBox(r,a){let n,o,f,y,x,b,_=1/this.direction.x,S=1/this.direction.y,A=1/this.direction.z,C=this.origin;return _>=0?(n=(r.min.x-C.x)*_,o=(r.max.x-C.x)*_):(n=(r.max.x-C.x)*_,o=(r.min.x-C.x)*_),S>=0?(f=(r.min.y-C.y)*S,y=(r.max.y-C.y)*S):(f=(r.max.y-C.y)*S,y=(r.min.y-C.y)*S),n>y||f>o||((f>n||isNaN(n))&&(n=f),(y<o||isNaN(o))&&(o=y),A>=0?(x=(r.min.z-C.z)*A,b=(r.max.z-C.z)*A):(x=(r.max.z-C.z)*A,b=(r.min.z-C.z)*A),n>b||x>o)||((x>n||n!==n)&&(n=x),(b<o||o!==o)&&(o=b),o<0)?null:this.at(n>=0?n:o,a)}intersectsBox(r){return this.intersectBox(r,oa)!==null}intersectTriangle(r,a,n,o,f){H1.subVectors(a,r),jg.subVectors(n,r),W1.crossVectors(H1,jg);let y=this.direction.dot(W1),x;if(y>0){if(o)return null;x=1}else if(y<0)x=-1,y=-y;else return null;el.subVectors(this.origin,r);let b=x*this.direction.dot(jg.crossVectors(el,jg));if(b<0)return null;let _=x*this.direction.dot(H1.cross(el));if(_<0||b+_>y)return null;let S=-x*el.dot(W1);return S<0?null:this.at(S/y,f)}applyMatrix4(r){return this.origin.applyMatrix4(r),this.direction.transformDirection(r),this}equals(r){return r.origin.equals(this.origin)&&r.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},ue=class{constructor(){ue.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(r,a,n,o,f,y,x,b,_,S,A,C,P,T,M,O){let I=this.elements;return I[0]=r,I[4]=a,I[8]=n,I[12]=o,I[1]=f,I[5]=y,I[9]=x,I[13]=b,I[2]=_,I[6]=S,I[10]=A,I[14]=C,I[3]=P,I[7]=T,I[11]=M,I[15]=O,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new ue().fromArray(this.elements)}copy(r){let a=this.elements,n=r.elements;return a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[4]=n[4],a[5]=n[5],a[6]=n[6],a[7]=n[7],a[8]=n[8],a[9]=n[9],a[10]=n[10],a[11]=n[11],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15],this}copyPosition(r){let a=this.elements,n=r.elements;return a[12]=n[12],a[13]=n[13],a[14]=n[14],this}setFromMatrix3(r){let a=r.elements;return this.set(a[0],a[3],a[6],0,a[1],a[4],a[7],0,a[2],a[5],a[8],0,0,0,0,1),this}extractBasis(r,a,n){return r.setFromMatrixColumn(this,0),a.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(r,a,n){return this.set(r.x,a.x,n.x,0,r.y,a.y,n.y,0,r.z,a.z,n.z,0,0,0,0,1),this}extractRotation(r){let a=this.elements,n=r.elements,o=1/Tu.setFromMatrixColumn(r,0).length(),f=1/Tu.setFromMatrixColumn(r,1).length(),y=1/Tu.setFromMatrixColumn(r,2).length();return a[0]=n[0]*o,a[1]=n[1]*o,a[2]=n[2]*o,a[3]=0,a[4]=n[4]*f,a[5]=n[5]*f,a[6]=n[6]*f,a[7]=0,a[8]=n[8]*y,a[9]=n[9]*y,a[10]=n[10]*y,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,this}makeRotationFromEuler(r){let a=this.elements,n=r.x,o=r.y,f=r.z,y=Math.cos(n),x=Math.sin(n),b=Math.cos(o),_=Math.sin(o),S=Math.cos(f),A=Math.sin(f);if(r.order==="XYZ"){let C=y*S,P=y*A,T=x*S,M=x*A;a[0]=b*S,a[4]=-b*A,a[8]=_,a[1]=P+T*_,a[5]=C-M*_,a[9]=-x*b,a[2]=M-C*_,a[6]=T+P*_,a[10]=y*b}else if(r.order==="YXZ"){let C=b*S,P=b*A,T=_*S,M=_*A;a[0]=C+M*x,a[4]=T*x-P,a[8]=y*_,a[1]=y*A,a[5]=y*S,a[9]=-x,a[2]=P*x-T,a[6]=M+C*x,a[10]=y*b}else if(r.order==="ZXY"){let C=b*S,P=b*A,T=_*S,M=_*A;a[0]=C-M*x,a[4]=-y*A,a[8]=T+P*x,a[1]=P+T*x,a[5]=y*S,a[9]=M-C*x,a[2]=-y*_,a[6]=x,a[10]=y*b}else if(r.order==="ZYX"){let C=y*S,P=y*A,T=x*S,M=x*A;a[0]=b*S,a[4]=T*_-P,a[8]=C*_+M,a[1]=b*A,a[5]=M*_+C,a[9]=P*_-T,a[2]=-_,a[6]=x*b,a[10]=y*b}else if(r.order==="YZX"){let C=y*b,P=y*_,T=x*b,M=x*_;a[0]=b*S,a[4]=M-C*A,a[8]=T*A+P,a[1]=A,a[5]=y*S,a[9]=-x*S,a[2]=-_*S,a[6]=P*A+T,a[10]=C-M*A}else if(r.order==="XZY"){let C=y*b,P=y*_,T=x*b,M=x*_;a[0]=b*S,a[4]=-A,a[8]=_*S,a[1]=C*A+M,a[5]=y*S,a[9]=P*A-T,a[2]=T*A-P,a[6]=x*S,a[10]=M*A+C}return a[3]=0,a[7]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,this}makeRotationFromQuaternion(r){return this.compose(QV,r,ZV)}lookAt(r,a,n){let o=this.elements;return Hn.subVectors(r,a),Hn.lengthSq()===0&&(Hn.z=1),Hn.normalize(),tl.crossVectors(n,Hn),tl.lengthSq()===0&&(Math.abs(n.z)===1?Hn.x+=1e-4:Hn.z+=1e-4,Hn.normalize(),tl.crossVectors(n,Hn)),tl.normalize(),Hg.crossVectors(Hn,tl),o[0]=tl.x,o[4]=Hg.x,o[8]=Hn.x,o[1]=tl.y,o[5]=Hg.y,o[9]=Hn.y,o[2]=tl.z,o[6]=Hg.z,o[10]=Hn.z,this}multiply(r){return this.multiplyMatrices(this,r)}premultiply(r){return this.multiplyMatrices(r,this)}multiplyMatrices(r,a){let n=r.elements,o=a.elements,f=this.elements,y=n[0],x=n[4],b=n[8],_=n[12],S=n[1],A=n[5],C=n[9],P=n[13],T=n[2],M=n[6],O=n[10],I=n[14],D=n[3],z=n[7],k=n[11],L=n[15],R=o[0],F=o[4],B=o[8],N=o[12],j=o[1],G=o[5],Y=o[9],X=o[13],$=o[2],te=o[6],ee=o[10],q=o[14],Z=o[3],U=o[7],W=o[11],H=o[15];return f[0]=y*R+x*j+b*$+_*Z,f[4]=y*F+x*G+b*te+_*U,f[8]=y*B+x*Y+b*ee+_*W,f[12]=y*N+x*X+b*q+_*H,f[1]=S*R+A*j+C*$+P*Z,f[5]=S*F+A*G+C*te+P*U,f[9]=S*B+A*Y+C*ee+P*W,f[13]=S*N+A*X+C*q+P*H,f[2]=T*R+M*j+O*$+I*Z,f[6]=T*F+M*G+O*te+I*U,f[10]=T*B+M*Y+O*ee+I*W,f[14]=T*N+M*X+O*q+I*H,f[3]=D*R+z*j+k*$+L*Z,f[7]=D*F+z*G+k*te+L*U,f[11]=D*B+z*Y+k*ee+L*W,f[15]=D*N+z*X+k*q+L*H,this}multiplyScalar(r){let a=this.elements;return a[0]*=r,a[4]*=r,a[8]*=r,a[12]*=r,a[1]*=r,a[5]*=r,a[9]*=r,a[13]*=r,a[2]*=r,a[6]*=r,a[10]*=r,a[14]*=r,a[3]*=r,a[7]*=r,a[11]*=r,a[15]*=r,this}determinant(){let r=this.elements,a=r[0],n=r[4],o=r[8],f=r[12],y=r[1],x=r[5],b=r[9],_=r[13],S=r[2],A=r[6],C=r[10],P=r[14],T=r[3],M=r[7],O=r[11],I=r[15];return T*(+f*b*A-o*_*A-f*x*C+n*_*C+o*x*P-n*b*P)+M*(+a*b*P-a*_*C+f*y*C-o*y*P+o*_*S-f*b*S)+O*(+a*_*A-a*x*P-f*y*A+n*y*P+f*x*S-n*_*S)+I*(-o*x*S-a*b*A+a*x*C+o*y*A-n*y*C+n*b*S)}transpose(){let r=this.elements,a;return a=r[1],r[1]=r[4],r[4]=a,a=r[2],r[2]=r[8],r[8]=a,a=r[6],r[6]=r[9],r[9]=a,a=r[3],r[3]=r[12],r[12]=a,a=r[7],r[7]=r[13],r[13]=a,a=r[11],r[11]=r[14],r[14]=a,this}setPosition(r,a,n){let o=this.elements;return r.isVector3?(o[12]=r.x,o[13]=r.y,o[14]=r.z):(o[12]=r,o[13]=a,o[14]=n),this}invert(){let r=this.elements,a=r[0],n=r[1],o=r[2],f=r[3],y=r[4],x=r[5],b=r[6],_=r[7],S=r[8],A=r[9],C=r[10],P=r[11],T=r[12],M=r[13],O=r[14],I=r[15],D=A*O*_-M*C*_+M*b*P-x*O*P-A*b*I+x*C*I,z=T*C*_-S*O*_-T*b*P+y*O*P+S*b*I-y*C*I,k=S*M*_-T*A*_+T*x*P-y*M*P-S*x*I+y*A*I,L=T*A*b-S*M*b-T*x*C+y*M*C+S*x*O-y*A*O,R=a*D+n*z+o*k+f*L;if(R===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let F=1/R;return r[0]=D*F,r[1]=(M*C*f-A*O*f-M*o*P+n*O*P+A*o*I-n*C*I)*F,r[2]=(x*O*f-M*b*f+M*o*_-n*O*_-x*o*I+n*b*I)*F,r[3]=(A*b*f-x*C*f-A*o*_+n*C*_+x*o*P-n*b*P)*F,r[4]=z*F,r[5]=(S*O*f-T*C*f+T*o*P-a*O*P-S*o*I+a*C*I)*F,r[6]=(T*b*f-y*O*f-T*o*_+a*O*_+y*o*I-a*b*I)*F,r[7]=(y*C*f-S*b*f+S*o*_-a*C*_-y*o*P+a*b*P)*F,r[8]=k*F,r[9]=(T*A*f-S*M*f-T*n*P+a*M*P+S*n*I-a*A*I)*F,r[10]=(y*M*f-T*x*f+T*n*_-a*M*_-y*n*I+a*x*I)*F,r[11]=(S*x*f-y*A*f-S*n*_+a*A*_+y*n*P-a*x*P)*F,r[12]=L*F,r[13]=(S*M*o-T*A*o+T*n*C-a*M*C-S*n*O+a*A*O)*F,r[14]=(T*x*o-y*M*o-T*n*b+a*M*b+y*n*O-a*x*O)*F,r[15]=(y*A*o-S*x*o+S*n*b-a*A*b-y*n*C+a*x*C)*F,this}scale(r){let a=this.elements,n=r.x,o=r.y,f=r.z;return a[0]*=n,a[4]*=o,a[8]*=f,a[1]*=n,a[5]*=o,a[9]*=f,a[2]*=n,a[6]*=o,a[10]*=f,a[3]*=n,a[7]*=o,a[11]*=f,this}getMaxScaleOnAxis(){let r=this.elements,a=r[0]*r[0]+r[1]*r[1]+r[2]*r[2],n=r[4]*r[4]+r[5]*r[5]+r[6]*r[6],o=r[8]*r[8]+r[9]*r[9]+r[10]*r[10];return Math.sqrt(Math.max(a,n,o))}makeTranslation(r,a,n){return this.set(1,0,0,r,0,1,0,a,0,0,1,n,0,0,0,1),this}makeRotationX(r){let a=Math.cos(r),n=Math.sin(r);return this.set(1,0,0,0,0,a,-n,0,0,n,a,0,0,0,0,1),this}makeRotationY(r){let a=Math.cos(r),n=Math.sin(r);return this.set(a,0,n,0,0,1,0,0,-n,0,a,0,0,0,0,1),this}makeRotationZ(r){let a=Math.cos(r),n=Math.sin(r);return this.set(a,-n,0,0,n,a,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(r,a){let n=Math.cos(a),o=Math.sin(a),f=1-n,y=r.x,x=r.y,b=r.z,_=f*y,S=f*x;return this.set(_*y+n,_*x-o*b,_*b+o*x,0,_*x+o*b,S*x+n,S*b-o*y,0,_*b-o*x,S*b+o*y,f*b*b+n,0,0,0,0,1),this}makeScale(r,a,n){return this.set(r,0,0,0,0,a,0,0,0,0,n,0,0,0,0,1),this}makeShear(r,a,n,o,f,y){return this.set(1,n,f,0,r,1,y,0,a,o,1,0,0,0,0,1),this}compose(r,a,n){let o=this.elements,f=a._x,y=a._y,x=a._z,b=a._w,_=f+f,S=y+y,A=x+x,C=f*_,P=f*S,T=f*A,M=y*S,O=y*A,I=x*A,D=b*_,z=b*S,k=b*A,L=n.x,R=n.y,F=n.z;return o[0]=(1-(M+I))*L,o[1]=(P+k)*L,o[2]=(T-z)*L,o[3]=0,o[4]=(P-k)*R,o[5]=(1-(C+I))*R,o[6]=(O+D)*R,o[7]=0,o[8]=(T+z)*F,o[9]=(O-D)*F,o[10]=(1-(C+M))*F,o[11]=0,o[12]=r.x,o[13]=r.y,o[14]=r.z,o[15]=1,this}decompose(r,a,n){let o=this.elements,f=Tu.set(o[0],o[1],o[2]).length(),y=Tu.set(o[4],o[5],o[6]).length(),x=Tu.set(o[8],o[9],o[10]).length();this.determinant()<0&&(f=-f),r.x=o[12],r.y=o[13],r.z=o[14],Ds.copy(this);let b=1/f,_=1/y,S=1/x;return Ds.elements[0]*=b,Ds.elements[1]*=b,Ds.elements[2]*=b,Ds.elements[4]*=_,Ds.elements[5]*=_,Ds.elements[6]*=_,Ds.elements[8]*=S,Ds.elements[9]*=S,Ds.elements[10]*=S,a.setFromRotationMatrix(Ds),n.x=f,n.y=y,n.z=x,this}makePerspective(r,a,n,o,f,y){let x=this.elements,b=2*f/(a-r),_=2*f/(n-o),S=(a+r)/(a-r),A=(n+o)/(n-o),C=-(y+f)/(y-f),P=-2*y*f/(y-f);return x[0]=b,x[4]=0,x[8]=S,x[12]=0,x[1]=0,x[5]=_,x[9]=A,x[13]=0,x[2]=0,x[6]=0,x[10]=C,x[14]=P,x[3]=0,x[7]=0,x[11]=-1,x[15]=0,this}makeOrthographic(r,a,n,o,f,y){let x=this.elements,b=1/(a-r),_=1/(n-o),S=1/(y-f),A=(a+r)*b,C=(n+o)*_,P=(y+f)*S;return x[0]=2*b,x[4]=0,x[8]=0,x[12]=-A,x[1]=0,x[5]=2*_,x[9]=0,x[13]=-C,x[2]=0,x[6]=0,x[10]=-2*S,x[14]=-P,x[3]=0,x[7]=0,x[11]=0,x[15]=1,this}equals(r){let a=this.elements,n=r.elements;for(let o=0;o<16;o++)if(a[o]!==n[o])return!1;return!0}fromArray(r,a=0){for(let n=0;n<16;n++)this.elements[n]=r[n+a];return this}toArray(r=[],a=0){let n=this.elements;return r[a]=n[0],r[a+1]=n[1],r[a+2]=n[2],r[a+3]=n[3],r[a+4]=n[4],r[a+5]=n[5],r[a+6]=n[6],r[a+7]=n[7],r[a+8]=n[8],r[a+9]=n[9],r[a+10]=n[10],r[a+11]=n[11],r[a+12]=n[12],r[a+13]=n[13],r[a+14]=n[14],r[a+15]=n[15],r}},Tu=new E,Ds=new ue,QV=new E(0,0,0),ZV=new E(1,1,1),tl=new E,Hg=new E,Hn=new E,gC=new ue,yC=new Ke,or=class{constructor(r=0,a=0,n=0,o=or.DEFAULT_ORDER){this.isEuler=!0,this._x=r,this._y=a,this._z=n,this._order=o}get x(){return this._x}set x(r){this._x=r,this._onChangeCallback()}get y(){return this._y}set y(r){this._y=r,this._onChangeCallback()}get z(){return this._z}set z(r){this._z=r,this._onChangeCallback()}get order(){return this._order}set order(r){this._order=r,this._onChangeCallback()}set(r,a,n,o=this._order){return this._x=r,this._y=a,this._z=n,this._order=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(r){return this._x=r._x,this._y=r._y,this._z=r._z,this._order=r._order,this._onChangeCallback(),this}setFromRotationMatrix(r,a=this._order,n=!0){let o=r.elements,f=o[0],y=o[4],x=o[8],b=o[1],_=o[5],S=o[9],A=o[2],C=o[6],P=o[10];switch(a){case"XYZ":this._y=Math.asin(pi(x,-1,1)),Math.abs(x)<.9999999?(this._x=Math.atan2(-S,P),this._z=Math.atan2(-y,f)):(this._x=Math.atan2(C,_),this._z=0);break;case"YXZ":this._x=Math.asin(-pi(S,-1,1)),Math.abs(S)<.9999999?(this._y=Math.atan2(x,P),this._z=Math.atan2(b,_)):(this._y=Math.atan2(-A,f),this._z=0);break;case"ZXY":this._x=Math.asin(pi(C,-1,1)),Math.abs(C)<.9999999?(this._y=Math.atan2(-A,P),this._z=Math.atan2(-y,_)):(this._y=0,this._z=Math.atan2(b,f));break;case"ZYX":this._y=Math.asin(-pi(A,-1,1)),Math.abs(A)<.9999999?(this._x=Math.atan2(C,P),this._z=Math.atan2(b,f)):(this._x=0,this._z=Math.atan2(-y,_));break;case"YZX":this._z=Math.asin(pi(b,-1,1)),Math.abs(b)<.9999999?(this._x=Math.atan2(-S,_),this._y=Math.atan2(-A,f)):(this._x=0,this._y=Math.atan2(x,P));break;case"XZY":this._z=Math.asin(-pi(y,-1,1)),Math.abs(y)<.9999999?(this._x=Math.atan2(C,_),this._y=Math.atan2(x,f)):(this._x=Math.atan2(-S,P),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+a)}return this._order=a,n===!0&&this._onChangeCallback(),this}setFromQuaternion(r,a,n){return gC.makeRotationFromQuaternion(r),this.setFromRotationMatrix(gC,a,n)}setFromVector3(r,a=this._order){return this.set(r.x,r.y,r.z,a)}reorder(r){return yC.setFromEuler(this),this.setFromQuaternion(yC,r)}equals(r){return r._x===this._x&&r._y===this._y&&r._z===this._z&&r._order===this._order}fromArray(r){return this._x=r[0],this._y=r[1],this._z=r[2],r[3]!==void 0&&(this._order=r[3]),this._onChangeCallback(),this}toArray(r=[],a=0){return r[a]=this._x,r[a+1]=this._y,r[a+2]=this._z,r[a+3]=this._order,r}_onChange(r){return this._onChangeCallback=r,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};or.DEFAULT_ORDER="XYZ";var Sp=class{constructor(){this.mask=1}set(r){this.mask=(1<<r|0)>>>0}enable(r){this.mask|=1<<r|0}enableAll(){this.mask=-1}toggle(r){this.mask^=1<<r|0}disable(r){this.mask&=~(1<<r|0)}disableAll(){this.mask=0}test(r){return(this.mask&r.mask)!==0}isEnabled(r){return(this.mask&(1<<r|0))!==0}},JV=0,vC=new E,Mu=new Ke,aa=new ue,Wg=new E,np=new E,$V=new E,eU=new Ke,xC=new E(1,0,0),bC=new E(0,1,0),SC=new E(0,0,1),tU={type:"added"},wC={type:"removed"},_t=class extends gr{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:JV++}),this.uuid=ss(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=_t.DEFAULT_UP.clone();let r=new E,a=new or,n=new Ke,o=new E(1,1,1);function f(){n.setFromEuler(a,!1)}function y(){a.setFromQuaternion(n,void 0,!1)}a._onChange(f),n._onChange(y),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:r},rotation:{configurable:!0,enumerable:!0,value:a},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:o},modelViewMatrix:{value:new ue},normalMatrix:{value:new mr}}),this.matrix=new ue,this.matrixWorld=new ue,this.matrixAutoUpdate=_t.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=_t.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new Sp,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(r){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(r),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(r){return this.quaternion.premultiply(r),this}setRotationFromAxisAngle(r,a){this.quaternion.setFromAxisAngle(r,a)}setRotationFromEuler(r){this.quaternion.setFromEuler(r,!0)}setRotationFromMatrix(r){this.quaternion.setFromRotationMatrix(r)}setRotationFromQuaternion(r){this.quaternion.copy(r)}rotateOnAxis(r,a){return Mu.setFromAxisAngle(r,a),this.quaternion.multiply(Mu),this}rotateOnWorldAxis(r,a){return Mu.setFromAxisAngle(r,a),this.quaternion.premultiply(Mu),this}rotateX(r){return this.rotateOnAxis(xC,r)}rotateY(r){return this.rotateOnAxis(bC,r)}rotateZ(r){return this.rotateOnAxis(SC,r)}translateOnAxis(r,a){return vC.copy(r).applyQuaternion(this.quaternion),this.position.add(vC.multiplyScalar(a)),this}translateX(r){return this.translateOnAxis(xC,r)}translateY(r){return this.translateOnAxis(bC,r)}translateZ(r){return this.translateOnAxis(SC,r)}localToWorld(r){return this.updateWorldMatrix(!0,!1),r.applyMatrix4(this.matrixWorld)}worldToLocal(r){return this.updateWorldMatrix(!0,!1),r.applyMatrix4(aa.copy(this.matrixWorld).invert())}lookAt(r,a,n){r.isVector3?Wg.copy(r):Wg.set(r,a,n);let o=this.parent;this.updateWorldMatrix(!0,!1),np.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?aa.lookAt(np,Wg,this.up):aa.lookAt(Wg,np,this.up),this.quaternion.setFromRotationMatrix(aa),o&&(aa.extractRotation(o.matrixWorld),Mu.setFromRotationMatrix(aa),this.quaternion.premultiply(Mu.invert()))}add(r){if(arguments.length>1){for(let a=0;a<arguments.length;a++)this.add(arguments[a]);return this}return r===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",r),this):(r&&r.isObject3D?(r.parent!==null&&r.parent.remove(r),r.parent=this,this.children.push(r),r.dispatchEvent(tU)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",r),this)}remove(r){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}let a=this.children.indexOf(r);return a!==-1&&(r.parent=null,this.children.splice(a,1),r.dispatchEvent(wC)),this}removeFromParent(){let r=this.parent;return r!==null&&r.remove(this),this}clear(){for(let r=0;r<this.children.length;r++){let a=this.children[r];a.parent=null,a.dispatchEvent(wC)}return this.children.length=0,this}attach(r){return this.updateWorldMatrix(!0,!1),aa.copy(this.matrixWorld).invert(),r.parent!==null&&(r.parent.updateWorldMatrix(!0,!1),aa.multiply(r.parent.matrixWorld)),r.applyMatrix4(aa),this.add(r),r.updateWorldMatrix(!1,!0),this}getObjectById(r){return this.getObjectByProperty("id",r)}getObjectByName(r){return this.getObjectByProperty("name",r)}getObjectByProperty(r,a){if(this[r]===a)return this;for(let n=0,o=this.children.length;n<o;n++){let f=this.children[n].getObjectByProperty(r,a);if(f!==void 0)return f}}getObjectsByProperty(r,a){let n=[];this[r]===a&&n.push(this);for(let o=0,f=this.children.length;o<f;o++){let y=this.children[o].getObjectsByProperty(r,a);y.length>0&&(n=n.concat(y))}return n}getWorldPosition(r){return this.updateWorldMatrix(!0,!1),r.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(r){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(np,r,$V),r}getWorldScale(r){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(np,eU,r),r}getWorldDirection(r){this.updateWorldMatrix(!0,!1);let a=this.matrixWorld.elements;return r.set(a[8],a[9],a[10]).normalize()}raycast(){}traverse(r){r(this);let a=this.children;for(let n=0,o=a.length;n<o;n++)a[n].traverse(r)}traverseVisible(r){if(this.visible===!1)return;r(this);let a=this.children;for(let n=0,o=a.length;n<o;n++)a[n].traverseVisible(r)}traverseAncestors(r){let a=this.parent;a!==null&&(r(a),a.traverseAncestors(r))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(r){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||r)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,r=!0);let a=this.children;for(let n=0,o=a.length;n<o;n++){let f=a[n];(f.matrixWorldAutoUpdate===!0||r===!0)&&f.updateMatrixWorld(r)}}updateWorldMatrix(r,a){let n=this.parent;if(r===!0&&n!==null&&n.matrixWorldAutoUpdate===!0&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),a===!0){let o=this.children;for(let f=0,y=o.length;f<y;f++){let x=o[f];x.matrixWorldAutoUpdate===!0&&x.updateWorldMatrix(!1,!0)}}}toJSON(r){let a=r===void 0||typeof r=="string",n={};a&&(r={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});let o={};o.uuid=this.uuid,o.type=this.type,this.name!==""&&(o.name=this.name),this.castShadow===!0&&(o.castShadow=!0),this.receiveShadow===!0&&(o.receiveShadow=!0),this.visible===!1&&(o.visible=!1),this.frustumCulled===!1&&(o.frustumCulled=!1),this.renderOrder!==0&&(o.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(o.userData=this.userData),o.layers=this.layers.mask,o.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(o.matrixAutoUpdate=!1),this.isInstancedMesh&&(o.type="InstancedMesh",o.count=this.count,o.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(o.instanceColor=this.instanceColor.toJSON()));function f(x,b){return x[b.uuid]===void 0&&(x[b.uuid]=b.toJSON(r)),b.uuid}if(this.isScene)this.background&&(this.background.isColor?o.background=this.background.toJSON():this.background.isTexture&&(o.background=this.background.toJSON(r).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(o.environment=this.environment.toJSON(r).uuid);else if(this.isMesh||this.isLine||this.isPoints){o.geometry=f(r.geometries,this.geometry);let x=this.geometry.parameters;if(x!==void 0&&x.shapes!==void 0){let b=x.shapes;if(Array.isArray(b))for(let _=0,S=b.length;_<S;_++){let A=b[_];f(r.shapes,A)}else f(r.shapes,b)}}if(this.isSkinnedMesh&&(o.bindMode=this.bindMode,o.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(f(r.skeletons,this.skeleton),o.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let x=[];for(let b=0,_=this.material.length;b<_;b++)x.push(f(r.materials,this.material[b]));o.material=x}else o.material=f(r.materials,this.material);if(this.children.length>0){o.children=[];for(let x=0;x<this.children.length;x++)o.children.push(this.children[x].toJSON(r).object)}if(this.animations.length>0){o.animations=[];for(let x=0;x<this.animations.length;x++){let b=this.animations[x];o.animations.push(f(r.animations,b))}}if(a){let x=y(r.geometries),b=y(r.materials),_=y(r.textures),S=y(r.images),A=y(r.shapes),C=y(r.skeletons),P=y(r.animations),T=y(r.nodes);x.length>0&&(n.geometries=x),b.length>0&&(n.materials=b),_.length>0&&(n.textures=_),S.length>0&&(n.images=S),A.length>0&&(n.shapes=A),C.length>0&&(n.skeletons=C),P.length>0&&(n.animations=P),T.length>0&&(n.nodes=T)}return n.object=o,n;function y(x){let b=[];for(let _ in x){let S=x[_];delete S.metadata,b.push(S)}return b}}clone(r){return new this.constructor().copy(this,r)}copy(r,a=!0){if(this.name=r.name,this.up.copy(r.up),this.position.copy(r.position),this.rotation.order=r.rotation.order,this.quaternion.copy(r.quaternion),this.scale.copy(r.scale),this.matrix.copy(r.matrix),this.matrixWorld.copy(r.matrixWorld),this.matrixAutoUpdate=r.matrixAutoUpdate,this.matrixWorldNeedsUpdate=r.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=r.matrixWorldAutoUpdate,this.layers.mask=r.layers.mask,this.visible=r.visible,this.castShadow=r.castShadow,this.receiveShadow=r.receiveShadow,this.frustumCulled=r.frustumCulled,this.renderOrder=r.renderOrder,this.userData=JSON.parse(JSON.stringify(r.userData)),a===!0)for(let n=0;n<r.children.length;n++){let o=r.children[n];this.add(o.clone())}return this}};_t.DEFAULT_UP=new E(0,1,0);_t.DEFAULT_MATRIX_AUTO_UPDATE=!0;_t.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var Os=new E,la=new E,q1=new E,ca=new E,Cu=new E,Pu=new E,AC=new E,X1=new E,Y1=new E,K1=new E,_r=class{constructor(r=new E,a=new E,n=new E){this.a=r,this.b=a,this.c=n}static getNormal(r,a,n,o){o.subVectors(n,a),Os.subVectors(r,a),o.cross(Os);let f=o.lengthSq();return f>0?o.multiplyScalar(1/Math.sqrt(f)):o.set(0,0,0)}static getBarycoord(r,a,n,o,f){Os.subVectors(o,a),la.subVectors(n,a),q1.subVectors(r,a);let y=Os.dot(Os),x=Os.dot(la),b=Os.dot(q1),_=la.dot(la),S=la.dot(q1),A=y*_-x*x;if(A===0)return f.set(-2,-1,-1);let C=1/A,P=(_*b-x*S)*C,T=(y*S-x*b)*C;return f.set(1-P-T,T,P)}static containsPoint(r,a,n,o){return this.getBarycoord(r,a,n,o,ca),ca.x>=0&&ca.y>=0&&ca.x+ca.y<=1}static getUV(r,a,n,o,f,y,x,b){return this.getBarycoord(r,a,n,o,ca),b.set(0,0),b.addScaledVector(f,ca.x),b.addScaledVector(y,ca.y),b.addScaledVector(x,ca.z),b}static isFrontFacing(r,a,n,o){return Os.subVectors(n,a),la.subVectors(r,a),Os.cross(la).dot(o)<0}set(r,a,n){return this.a.copy(r),this.b.copy(a),this.c.copy(n),this}setFromPointsAndIndices(r,a,n,o){return this.a.copy(r[a]),this.b.copy(r[n]),this.c.copy(r[o]),this}setFromAttributeAndIndices(r,a,n,o){return this.a.fromBufferAttribute(r,a),this.b.fromBufferAttribute(r,n),this.c.fromBufferAttribute(r,o),this}clone(){return new this.constructor().copy(this)}copy(r){return this.a.copy(r.a),this.b.copy(r.b),this.c.copy(r.c),this}getArea(){return Os.subVectors(this.c,this.b),la.subVectors(this.a,this.b),Os.cross(la).length()*.5}getMidpoint(r){return r.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(r){return _r.getNormal(this.a,this.b,this.c,r)}getPlane(r){return r.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(r,a){return _r.getBarycoord(r,this.a,this.b,this.c,a)}getUV(r,a,n,o,f){return _r.getUV(r,this.a,this.b,this.c,a,n,o,f)}containsPoint(r){return _r.containsPoint(r,this.a,this.b,this.c)}isFrontFacing(r){return _r.isFrontFacing(this.a,this.b,this.c,r)}intersectsBox(r){return r.intersectsTriangle(this)}closestPointToPoint(r,a){let n=this.a,o=this.b,f=this.c,y,x;Cu.subVectors(o,n),Pu.subVectors(f,n),X1.subVectors(r,n);let b=Cu.dot(X1),_=Pu.dot(X1);if(b<=0&&_<=0)return a.copy(n);Y1.subVectors(r,o);let S=Cu.dot(Y1),A=Pu.dot(Y1);if(S>=0&&A<=S)return a.copy(o);let C=b*A-S*_;if(C<=0&&b>=0&&S<=0)return y=b/(b-S),a.copy(n).addScaledVector(Cu,y);K1.subVectors(r,f);let P=Cu.dot(K1),T=Pu.dot(K1);if(T>=0&&P<=T)return a.copy(f);let M=P*_-b*T;if(M<=0&&_>=0&&T<=0)return x=_/(_-T),a.copy(n).addScaledVector(Pu,x);let O=S*T-P*A;if(O<=0&&A-S>=0&&P-T>=0)return AC.subVectors(f,o),x=(A-S)/(A-S+(P-T)),a.copy(o).addScaledVector(AC,x);let I=1/(O+M+C);return y=M*I,x=C*I,a.copy(n).addScaledVector(Cu,y).addScaledVector(Pu,x)}equals(r){return r.a.equals(this.a)&&r.b.equals(this.b)&&r.c.equals(this.c)}},rU=0,Ec=class extends gr{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:rU++}),this.uuid=ss(),this.name="",this.type="Material",this.blending=il,this.side=qn,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=mP,this.blendDst=gP,this.blendEquation=Bu,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=uS,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=OV,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=L1,this.stencilZFail=L1,this.stencilZPass=L1,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(r){this._alphaTest>0!=r>0&&this.version++,this._alphaTest=r}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(r){if(r!==void 0)for(let a in r){let n=r[a];if(n===void 0){console.warn("THREE.Material: '"+a+"' parameter is undefined.");continue}let o=this[a];if(o===void 0){console.warn("THREE."+this.type+": '"+a+"' is not a property of this material.");continue}o&&o.isColor?o.set(n):o&&o.isVector3&&n&&n.isVector3?o.copy(n):this[a]=n}}toJSON(r){let a=r===void 0||typeof r=="string";a&&(r={textures:{},images:{}});let n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(r).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(r).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(r).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(r).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(r).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(r).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(r).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(r).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(r).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(r).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(r).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(r).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(r).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(r).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(r).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(r).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(r).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(r).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(r).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(r).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(r).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(r).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(r).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==il&&(n.blending=this.blending),this.side!==qn&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(n.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(n.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=this.flatShading),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function o(f){let y=[];for(let x in f){let b=f[x];delete b.metadata,y.push(b)}return y}if(a){let f=o(r.textures),y=o(r.images);f.length>0&&(n.textures=f),y.length>0&&(n.images=y)}return n}clone(){return new this.constructor().copy(this)}copy(r){this.name=r.name,this.blending=r.blending,this.side=r.side,this.vertexColors=r.vertexColors,this.opacity=r.opacity,this.transparent=r.transparent,this.blendSrc=r.blendSrc,this.blendDst=r.blendDst,this.blendEquation=r.blendEquation,this.blendSrcAlpha=r.blendSrcAlpha,this.blendDstAlpha=r.blendDstAlpha,this.blendEquationAlpha=r.blendEquationAlpha,this.depthFunc=r.depthFunc,this.depthTest=r.depthTest,this.depthWrite=r.depthWrite,this.stencilWriteMask=r.stencilWriteMask,this.stencilFunc=r.stencilFunc,this.stencilRef=r.stencilRef,this.stencilFuncMask=r.stencilFuncMask,this.stencilFail=r.stencilFail,this.stencilZFail=r.stencilZFail,this.stencilZPass=r.stencilZPass,this.stencilWrite=r.stencilWrite;let a=r.clippingPlanes,n=null;if(a!==null){let o=a.length;n=new Array(o);for(let f=0;f!==o;++f)n[f]=a[f].clone()}return this.clippingPlanes=n,this.clipIntersection=r.clipIntersection,this.clipShadows=r.clipShadows,this.shadowSide=r.shadowSide,this.colorWrite=r.colorWrite,this.precision=r.precision,this.polygonOffset=r.polygonOffset,this.polygonOffsetFactor=r.polygonOffsetFactor,this.polygonOffsetUnits=r.polygonOffsetUnits,this.dithering=r.dithering,this.alphaTest=r.alphaTest,this.alphaToCoverage=r.alphaToCoverage,this.premultipliedAlpha=r.premultipliedAlpha,this.forceSinglePass=r.forceSinglePass,this.visible=r.visible,this.toneMapped=r.toneMapped,this.userData=JSON.parse(JSON.stringify(r.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(r){r===!0&&this.version++}},an=class extends Ec{constructor(r){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new qe(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=yP,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.specularMap=r.specularMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.combine=r.combine,this.reflectivity=r.reflectivity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.fog=r.fog,this}},fi=new E,qg=new V,Ge=class{constructor(r,a,n=!1){if(Array.isArray(r))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=r,this.itemSize=a,this.count=r!==void 0?r.length/a:0,this.normalized=n,this.usage=pS,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(r){r===!0&&this.version++}setUsage(r){return this.usage=r,this}copy(r){return this.name=r.name,this.array=new r.array.constructor(r.array),this.itemSize=r.itemSize,this.count=r.count,this.normalized=r.normalized,this.usage=r.usage,this}copyAt(r,a,n){r*=this.itemSize,n*=a.itemSize;for(let o=0,f=this.itemSize;o<f;o++)this.array[r+o]=a.array[n+o];return this}copyArray(r){return this.array.set(r),this}applyMatrix3(r){if(this.itemSize===2)for(let a=0,n=this.count;a<n;a++)qg.fromBufferAttribute(this,a),qg.applyMatrix3(r),this.setXY(a,qg.x,qg.y);else if(this.itemSize===3)for(let a=0,n=this.count;a<n;a++)fi.fromBufferAttribute(this,a),fi.applyMatrix3(r),this.setXYZ(a,fi.x,fi.y,fi.z);return this}applyMatrix4(r){for(let a=0,n=this.count;a<n;a++)fi.fromBufferAttribute(this,a),fi.applyMatrix4(r),this.setXYZ(a,fi.x,fi.y,fi.z);return this}applyNormalMatrix(r){for(let a=0,n=this.count;a<n;a++)fi.fromBufferAttribute(this,a),fi.applyNormalMatrix(r),this.setXYZ(a,fi.x,fi.y,fi.z);return this}transformDirection(r){for(let a=0,n=this.count;a<n;a++)fi.fromBufferAttribute(this,a),fi.transformDirection(r),this.setXYZ(a,fi.x,fi.y,fi.z);return this}set(r,a=0){return this.array.set(r,a),this}getX(r){let a=this.array[r*this.itemSize];return this.normalized&&(a=da(a,this.array)),a}setX(r,a){return this.normalized&&(a=Sr(a,this.array)),this.array[r*this.itemSize]=a,this}getY(r){let a=this.array[r*this.itemSize+1];return this.normalized&&(a=da(a,this.array)),a}setY(r,a){return this.normalized&&(a=Sr(a,this.array)),this.array[r*this.itemSize+1]=a,this}getZ(r){let a=this.array[r*this.itemSize+2];return this.normalized&&(a=da(a,this.array)),a}setZ(r,a){return this.normalized&&(a=Sr(a,this.array)),this.array[r*this.itemSize+2]=a,this}getW(r){let a=this.array[r*this.itemSize+3];return this.normalized&&(a=da(a,this.array)),a}setW(r,a){return this.normalized&&(a=Sr(a,this.array)),this.array[r*this.itemSize+3]=a,this}setXY(r,a,n){return r*=this.itemSize,this.normalized&&(a=Sr(a,this.array),n=Sr(n,this.array)),this.array[r+0]=a,this.array[r+1]=n,this}setXYZ(r,a,n,o){return r*=this.itemSize,this.normalized&&(a=Sr(a,this.array),n=Sr(n,this.array),o=Sr(o,this.array)),this.array[r+0]=a,this.array[r+1]=n,this.array[r+2]=o,this}setXYZW(r,a,n,o,f){return r*=this.itemSize,this.normalized&&(a=Sr(a,this.array),n=Sr(n,this.array),o=Sr(o,this.array),f=Sr(f,this.array)),this.array[r+0]=a,this.array[r+1]=n,this.array[r+2]=o,this.array[r+3]=f,this}onUpload(r){return this.onUploadCallback=r,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let r={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(r.name=this.name),this.usage!==pS&&(r.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(r.updateRange=this.updateRange),r}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}},Sy=class extends Ge{constructor(r,a,n){super(new Uint16Array(r),a,n)}},mo=class extends Ge{constructor(r,a,n){super(new Uint32Array(r),a,n)}},Te=class extends Ge{constructor(r,a,n){super(new Float32Array(r),a,n)}},iU=0,ns=new ue,Q1=new _t,_u=new E,Wn=new Xt,sp=new Xt,Ni=new E,Ce=class extends gr{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:iU++}),this.uuid=ss(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(r){return Array.isArray(r)?this.index=new(wP(r)?mo:Sy)(r,1):this.index=r,this}getAttribute(r){return this.attributes[r]}setAttribute(r,a){return this.attributes[r]=a,this}deleteAttribute(r){return delete this.attributes[r],this}hasAttribute(r){return this.attributes[r]!==void 0}addGroup(r,a,n=0){this.groups.push({start:r,count:a,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(r,a){this.drawRange.start=r,this.drawRange.count=a}applyMatrix4(r){let a=this.attributes.position;a!==void 0&&(a.applyMatrix4(r),a.needsUpdate=!0);let n=this.attributes.normal;if(n!==void 0){let f=new mr().getNormalMatrix(r);n.applyNormalMatrix(f),n.needsUpdate=!0}let o=this.attributes.tangent;return o!==void 0&&(o.transformDirection(r),o.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(r){return ns.makeRotationFromQuaternion(r),this.applyMatrix4(ns),this}rotateX(r){return ns.makeRotationX(r),this.applyMatrix4(ns),this}rotateY(r){return ns.makeRotationY(r),this.applyMatrix4(ns),this}rotateZ(r){return ns.makeRotationZ(r),this.applyMatrix4(ns),this}translate(r,a,n){return ns.makeTranslation(r,a,n),this.applyMatrix4(ns),this}scale(r,a,n){return ns.makeScale(r,a,n),this.applyMatrix4(ns),this}lookAt(r){return Q1.lookAt(r),Q1.updateMatrix(),this.applyMatrix4(Q1.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(_u).negate(),this.translate(_u.x,_u.y,_u.z),this}setFromPoints(r){let a=[];for(let n=0,o=r.length;n<o;n++){let f=r[n];a.push(f.x,f.y,f.z||0)}return this.setAttribute("position",new Te(a,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Xt);let r=this.attributes.position,a=this.morphAttributes.position;if(r&&r.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new E(-1/0,-1/0,-1/0),new E(1/0,1/0,1/0));return}if(r!==void 0){if(this.boundingBox.setFromBufferAttribute(r),a)for(let n=0,o=a.length;n<o;n++){let f=a[n];Wn.setFromBufferAttribute(f),this.morphTargetsRelative?(Ni.addVectors(this.boundingBox.min,Wn.min),this.boundingBox.expandByPoint(Ni),Ni.addVectors(this.boundingBox.max,Wn.max),this.boundingBox.expandByPoint(Ni)):(this.boundingBox.expandByPoint(Wn.min),this.boundingBox.expandByPoint(Wn.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Nr);let r=this.attributes.position,a=this.morphAttributes.position;if(r&&r.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new E,1/0);return}if(r){let n=this.boundingSphere.center;if(Wn.setFromBufferAttribute(r),a)for(let f=0,y=a.length;f<y;f++){let x=a[f];sp.setFromBufferAttribute(x),this.morphTargetsRelative?(Ni.addVectors(Wn.min,sp.min),Wn.expandByPoint(Ni),Ni.addVectors(Wn.max,sp.max),Wn.expandByPoint(Ni)):(Wn.expandByPoint(sp.min),Wn.expandByPoint(sp.max))}Wn.getCenter(n);let o=0;for(let f=0,y=r.count;f<y;f++)Ni.fromBufferAttribute(r,f),o=Math.max(o,n.distanceToSquared(Ni));if(a)for(let f=0,y=a.length;f<y;f++){let x=a[f],b=this.morphTargetsRelative;for(let _=0,S=x.count;_<S;_++)Ni.fromBufferAttribute(x,_),b&&(_u.fromBufferAttribute(r,_),Ni.add(_u)),o=Math.max(o,n.distanceToSquared(Ni))}this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let r=this.index,a=this.attributes;if(r===null||a.position===void 0||a.normal===void 0||a.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let n=r.array,o=a.position.array,f=a.normal.array,y=a.uv.array,x=o.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ge(new Float32Array(4*x),4));let b=this.getAttribute("tangent").array,_=[],S=[];for(let j=0;j<x;j++)_[j]=new E,S[j]=new E;let A=new E,C=new E,P=new E,T=new V,M=new V,O=new V,I=new E,D=new E;function z(j,G,Y){A.fromArray(o,j*3),C.fromArray(o,G*3),P.fromArray(o,Y*3),T.fromArray(y,j*2),M.fromArray(y,G*2),O.fromArray(y,Y*2),C.sub(A),P.sub(A),M.sub(T),O.sub(T);let X=1/(M.x*O.y-O.x*M.y);!isFinite(X)||(I.copy(C).multiplyScalar(O.y).addScaledVector(P,-M.y).multiplyScalar(X),D.copy(P).multiplyScalar(M.x).addScaledVector(C,-O.x).multiplyScalar(X),_[j].add(I),_[G].add(I),_[Y].add(I),S[j].add(D),S[G].add(D),S[Y].add(D))}let k=this.groups;k.length===0&&(k=[{start:0,count:n.length}]);for(let j=0,G=k.length;j<G;++j){let Y=k[j],X=Y.start,$=Y.count;for(let te=X,ee=X+$;te<ee;te+=3)z(n[te+0],n[te+1],n[te+2])}let L=new E,R=new E,F=new E,B=new E;function N(j){F.fromArray(f,j*3),B.copy(F);let G=_[j];L.copy(G),L.sub(F.multiplyScalar(F.dot(G))).normalize(),R.crossVectors(B,G);let Y=R.dot(S[j])<0?-1:1;b[j*4]=L.x,b[j*4+1]=L.y,b[j*4+2]=L.z,b[j*4+3]=Y}for(let j=0,G=k.length;j<G;++j){let Y=k[j],X=Y.start,$=Y.count;for(let te=X,ee=X+$;te<ee;te+=3)N(n[te+0]),N(n[te+1]),N(n[te+2])}}computeVertexNormals(){let r=this.index,a=this.getAttribute("position");if(a!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Ge(new Float32Array(a.count*3),3),this.setAttribute("normal",n);else for(let C=0,P=n.count;C<P;C++)n.setXYZ(C,0,0,0);let o=new E,f=new E,y=new E,x=new E,b=new E,_=new E,S=new E,A=new E;if(r)for(let C=0,P=r.count;C<P;C+=3){let T=r.getX(C+0),M=r.getX(C+1),O=r.getX(C+2);o.fromBufferAttribute(a,T),f.fromBufferAttribute(a,M),y.fromBufferAttribute(a,O),S.subVectors(y,f),A.subVectors(o,f),S.cross(A),x.fromBufferAttribute(n,T),b.fromBufferAttribute(n,M),_.fromBufferAttribute(n,O),x.add(S),b.add(S),_.add(S),n.setXYZ(T,x.x,x.y,x.z),n.setXYZ(M,b.x,b.y,b.z),n.setXYZ(O,_.x,_.y,_.z)}else for(let C=0,P=a.count;C<P;C+=3)o.fromBufferAttribute(a,C+0),f.fromBufferAttribute(a,C+1),y.fromBufferAttribute(a,C+2),S.subVectors(y,f),A.subVectors(o,f),S.cross(A),n.setXYZ(C+0,S.x,S.y,S.z),n.setXYZ(C+1,S.x,S.y,S.z),n.setXYZ(C+2,S.x,S.y,S.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){let r=this.attributes.normal;for(let a=0,n=r.count;a<n;a++)Ni.fromBufferAttribute(r,a),Ni.normalize(),r.setXYZ(a,Ni.x,Ni.y,Ni.z)}toNonIndexed(){function r(x,b){let _=x.array,S=x.itemSize,A=x.normalized,C=new _.constructor(b.length*S),P=0,T=0;for(let M=0,O=b.length;M<O;M++){x.isInterleavedBufferAttribute?P=b[M]*x.data.stride+x.offset:P=b[M]*S;for(let I=0;I<S;I++)C[T++]=_[P++]}return new Ge(C,S,A)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let a=new Ce,n=this.index.array,o=this.attributes;for(let x in o){let b=o[x],_=r(b,n);a.setAttribute(x,_)}let f=this.morphAttributes;for(let x in f){let b=[],_=f[x];for(let S=0,A=_.length;S<A;S++){let C=_[S],P=r(C,n);b.push(P)}a.morphAttributes[x]=b}a.morphTargetsRelative=this.morphTargetsRelative;let y=this.groups;for(let x=0,b=y.length;x<b;x++){let _=y[x];a.addGroup(_.start,_.count,_.materialIndex)}return a}toJSON(){let r={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),Object.keys(this.userData).length>0&&(r.userData=this.userData),this.parameters!==void 0){let b=this.parameters;for(let _ in b)b[_]!==void 0&&(r[_]=b[_]);return r}r.data={attributes:{}};let a=this.index;a!==null&&(r.data.index={type:a.array.constructor.name,array:Array.prototype.slice.call(a.array)});let n=this.attributes;for(let b in n){let _=n[b];r.data.attributes[b]=_.toJSON(r.data)}let o={},f=!1;for(let b in this.morphAttributes){let _=this.morphAttributes[b],S=[];for(let A=0,C=_.length;A<C;A++){let P=_[A];S.push(P.toJSON(r.data))}S.length>0&&(o[b]=S,f=!0)}f&&(r.data.morphAttributes=o,r.data.morphTargetsRelative=this.morphTargetsRelative);let y=this.groups;y.length>0&&(r.data.groups=JSON.parse(JSON.stringify(y)));let x=this.boundingSphere;return x!==null&&(r.data.boundingSphere={center:x.center.toArray(),radius:x.radius}),r}clone(){return new this.constructor().copy(this)}copy(r){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let a={};this.name=r.name;let n=r.index;n!==null&&this.setIndex(n.clone(a));let o=r.attributes;for(let _ in o){let S=o[_];this.setAttribute(_,S.clone(a))}let f=r.morphAttributes;for(let _ in f){let S=[],A=f[_];for(let C=0,P=A.length;C<P;C++)S.push(A[C].clone(a));this.morphAttributes[_]=S}this.morphTargetsRelative=r.morphTargetsRelative;let y=r.groups;for(let _=0,S=y.length;_<S;_++){let A=y[_];this.addGroup(A.start,A.count,A.materialIndex)}let x=r.boundingBox;x!==null&&(this.boundingBox=x.clone());let b=r.boundingSphere;return b!==null&&(this.boundingSphere=b.clone()),this.drawRange.start=r.drawRange.start,this.drawRange.count=r.drawRange.count,this.userData=r.userData,r.parameters!==void 0&&(this.parameters=Object.assign({},r.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}},EC=new ue,Iu=new Ns,Z1=new Nr,op$2=new E,ap=new E,lp=new E,J1=new E,Xg=new E,Yg=new V,Kg=new V,Qg=new V,$1=new E,Zg=new E,Et=class extends _t{constructor(r=new Ce,a=new an){super(),this.isMesh=!0,this.type="Mesh",this.geometry=r,this.material=a,this.updateMorphTargets()}copy(r,a){return super.copy(r,a),r.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=r.morphTargetInfluences.slice()),r.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},r.morphTargetDictionary)),this.material=r.material,this.geometry=r.geometry,this}updateMorphTargets(){let r=this.geometry.morphAttributes,a=Object.keys(r);if(a.length>0){let n=r[a[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,f=n.length;o<f;o++){let y=n[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[y]=o}}}}getVertexPosition(r,a){let n=this.geometry,o=n.attributes.position,f=n.morphAttributes.position,y=n.morphTargetsRelative;a.fromBufferAttribute(o,r);let x=this.morphTargetInfluences;if(f&&x){Xg.set(0,0,0);for(let b=0,_=f.length;b<_;b++){let S=x[b],A=f[b];S!==0&&(J1.fromBufferAttribute(A,r),y?Xg.addScaledVector(J1,S):Xg.addScaledVector(J1.sub(a),S))}a.add(Xg)}return this.isSkinnedMesh&&this.boneTransform(r,a),a}raycast(r,a){let n=this.geometry,o=this.material,f=this.matrixWorld;if(o===void 0||(n.boundingSphere===null&&n.computeBoundingSphere(),Z1.copy(n.boundingSphere),Z1.applyMatrix4(f),r.ray.intersectsSphere(Z1)===!1)||(EC.copy(f).invert(),Iu.copy(r.ray).applyMatrix4(EC),n.boundingBox!==null&&Iu.intersectsBox(n.boundingBox)===!1))return;let y,x=n.index,b=n.attributes.position,_=n.attributes.uv,S=n.attributes.uv2,A=n.groups,C=n.drawRange;if(x!==null)if(Array.isArray(o))for(let P=0,T=A.length;P<T;P++){let M=A[P],O=o[M.materialIndex],I=Math.max(M.start,C.start),D=Math.min(x.count,Math.min(M.start+M.count,C.start+C.count));for(let z=I,k=D;z<k;z+=3){let L=x.getX(z),R=x.getX(z+1),F=x.getX(z+2);y=Jg(this,O,r,Iu,_,S,L,R,F),y&&(y.faceIndex=Math.floor(z/3),y.face.materialIndex=M.materialIndex,a.push(y))}}else{let P=Math.max(0,C.start),T=Math.min(x.count,C.start+C.count);for(let M=P,O=T;M<O;M+=3){let I=x.getX(M),D=x.getX(M+1),z=x.getX(M+2);y=Jg(this,o,r,Iu,_,S,I,D,z),y&&(y.faceIndex=Math.floor(M/3),a.push(y))}}else if(b!==void 0)if(Array.isArray(o))for(let P=0,T=A.length;P<T;P++){let M=A[P],O=o[M.materialIndex],I=Math.max(M.start,C.start),D=Math.min(b.count,Math.min(M.start+M.count,C.start+C.count));for(let z=I,k=D;z<k;z+=3){let L=z,R=z+1,F=z+2;y=Jg(this,O,r,Iu,_,S,L,R,F),y&&(y.faceIndex=Math.floor(z/3),y.face.materialIndex=M.materialIndex,a.push(y))}}else{let P=Math.max(0,C.start),T=Math.min(b.count,C.start+C.count);for(let M=P,O=T;M<O;M+=3){let I=M,D=M+1,z=M+2;y=Jg(this,o,r,Iu,_,S,I,D,z),y&&(y.faceIndex=Math.floor(M/3),a.push(y))}}}};function nU(r,a,n,o,f,y,x,b){let _;if(a.side===gi?_=o.intersectTriangle(x,y,f,!0,b):_=o.intersectTriangle(f,y,x,a.side===qn,b),_===null)return null;Zg.copy(b),Zg.applyMatrix4(r.matrixWorld);let S=n.ray.origin.distanceTo(Zg);return S<n.near||S>n.far?null:{distance:S,point:Zg.clone(),object:r}}function Jg(r,a,n,o,f,y,x,b,_){r.getVertexPosition(x,op$2),r.getVertexPosition(b,ap),r.getVertexPosition(_,lp);let S=nU(r,a,n,o,op$2,ap,lp,$1);if(S){f&&(Yg.fromBufferAttribute(f,x),Kg.fromBufferAttribute(f,b),Qg.fromBufferAttribute(f,_),S.uv=_r.getUV($1,op$2,ap,lp,Yg,Kg,Qg,new V)),y&&(Yg.fromBufferAttribute(y,x),Kg.fromBufferAttribute(y,b),Qg.fromBufferAttribute(y,_),S.uv2=_r.getUV($1,op$2,ap,lp,Yg,Kg,Qg,new V));let A={a:x,b,c:_,normal:new E,materialIndex:0};_r.getNormal(op$2,ap,lp,A.normal),S.face=A}return S}var yi=class extends Ce{constructor(r=1,a=1,n=1,o=1,f=1,y=1){super(),this.type="BoxGeometry",this.parameters={width:r,height:a,depth:n,widthSegments:o,heightSegments:f,depthSegments:y};let x=this;o=Math.floor(o),f=Math.floor(f),y=Math.floor(y);let b=[],_=[],S=[],A=[],C=0,P=0;T("z","y","x",-1,-1,n,a,r,y,f,0),T("z","y","x",1,-1,n,a,-r,y,f,1),T("x","z","y",1,1,r,n,a,o,y,2),T("x","z","y",1,-1,r,n,-a,o,y,3),T("x","y","z",1,-1,r,a,n,o,f,4),T("x","y","z",-1,-1,r,a,-n,o,f,5),this.setIndex(b),this.setAttribute("position",new Te(_,3)),this.setAttribute("normal",new Te(S,3)),this.setAttribute("uv",new Te(A,2));function T(M,O,I,D,z,k,L,R,F,B,N){let j=k/F,G=L/B,Y=k/2,X=L/2,$=R/2,te=F+1,ee=B+1,q=0,Z=0,U=new E;for(let W=0;W<ee;W++){let H=W*G-X;for(let K=0;K<te;K++){let le=K*j-Y;U[M]=le*D,U[O]=H*z,U[I]=$,_.push(U.x,U.y,U.z),U[M]=0,U[O]=0,U[I]=R>0?1:-1,S.push(U.x,U.y,U.z),A.push(K/F),A.push(1-W/B),q+=1}}for(let W=0;W<B;W++)for(let H=0;H<F;H++){let K=C+H+te*W,le=C+H+te*(W+1),me=C+(H+1)+te*(W+1),ne=C+(H+1)+te*W;b.push(K,le,ne),b.push(le,me,ne),Z+=6}x.addGroup(P,Z,N),P+=Z,C+=q}}static fromJSON(r){return new yi(r.width,r.height,r.depth,r.widthSegments,r.heightSegments,r.depthSegments)}};function Gu(r){let a={};for(let n in r){a[n]={};for(let o in r[n]){let f=r[n][o];f&&(f.isColor||f.isMatrix3||f.isMatrix4||f.isVector2||f.isVector3||f.isVector4||f.isTexture||f.isQuaternion)?a[n][o]=f.clone():Array.isArray(f)?a[n][o]=f.slice():a[n][o]=f}}return a}function mn(r){let a={};for(let n=0;n<r.length;n++){let o=Gu(r[n]);for(let f in o)a[f]=o[f]}return a}function sU(r){let a=[];for(let n=0;n<r.length;n++)a.push(r[n].clone());return a}var Vs={clone:Gu,merge:mn},oU=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,aU=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,Je=class extends Ec{constructor(r){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=oU,this.fragmentShader=aU,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,r!==void 0&&this.setValues(r)}copy(r){return super.copy(r),this.fragmentShader=r.fragmentShader,this.vertexShader=r.vertexShader,this.uniforms=Gu(r.uniforms),this.uniformsGroups=sU(r.uniformsGroups),this.defines=Object.assign({},r.defines),this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.fog=r.fog,this.lights=r.lights,this.clipping=r.clipping,this.extensions=Object.assign({},r.extensions),this.glslVersion=r.glslVersion,this}toJSON(r){let a=super.toJSON(r);a.glslVersion=this.glslVersion,a.uniforms={};for(let o in this.uniforms){let f=this.uniforms[o].value;f&&f.isTexture?a.uniforms[o]={type:"t",value:f.toJSON(r).uuid}:f&&f.isColor?a.uniforms[o]={type:"c",value:f.getHex()}:f&&f.isVector2?a.uniforms[o]={type:"v2",value:f.toArray()}:f&&f.isVector3?a.uniforms[o]={type:"v3",value:f.toArray()}:f&&f.isVector4?a.uniforms[o]={type:"v4",value:f.toArray()}:f&&f.isMatrix3?a.uniforms[o]={type:"m3",value:f.toArray()}:f&&f.isMatrix4?a.uniforms[o]={type:"m4",value:f.toArray()}:a.uniforms[o]={value:f}}Object.keys(this.defines).length>0&&(a.defines=this.defines),a.vertexShader=this.vertexShader,a.fragmentShader=this.fragmentShader;let n={};for(let o in this.extensions)this.extensions[o]===!0&&(n[o]=!0);return Object.keys(n).length>0&&(a.extensions=n),a}},yn=class extends _t{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new ue,this.projectionMatrix=new ue,this.projectionMatrixInverse=new ue}copy(r,a){return super.copy(r,a),this.matrixWorldInverse.copy(r.matrixWorldInverse),this.projectionMatrix.copy(r.projectionMatrix),this.projectionMatrixInverse.copy(r.projectionMatrixInverse),this}getWorldDirection(r){this.updateWorldMatrix(!0,!1);let a=this.matrixWorld.elements;return r.set(-a[8],-a[9],-a[10]).normalize()}updateMatrixWorld(r){super.updateMatrixWorld(r),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(r,a){super.updateWorldMatrix(r,a),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},ti=class extends yn{constructor(r=50,a=1,n=.1,o=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=r,this.zoom=1,this.near=n,this.far=o,this.focus=10,this.aspect=a,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(r,a){return super.copy(r,a),this.fov=r.fov,this.zoom=r.zoom,this.near=r.near,this.far=r.far,this.focus=r.focus,this.aspect=r.aspect,this.view=r.view===null?null:Object.assign({},r.view),this.filmGauge=r.filmGauge,this.filmOffset=r.filmOffset,this}setFocalLength(r){let a=.5*this.getFilmHeight()/r;this.fov=xp*2*Math.atan(a),this.updateProjectionMatrix()}getFocalLength(){let r=Math.tan(fp*.5*this.fov);return .5*this.getFilmHeight()/r}getEffectiveFOV(){return xp*2*Math.atan(Math.tan(fp*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(r,a,n,o,f,y){this.aspect=r/a,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=r,this.view.fullHeight=a,this.view.offsetX=n,this.view.offsetY=o,this.view.width=f,this.view.height=y,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let r=this.near,a=r*Math.tan(fp*.5*this.fov)/this.zoom,n=2*a,o=this.aspect*n,f=-.5*o,y=this.view;if(this.view!==null&&this.view.enabled){let b=y.fullWidth,_=y.fullHeight;f+=y.offsetX*o/b,a-=y.offsetY*n/_,o*=y.width/b,n*=y.height/_}let x=this.filmOffset;x!==0&&(f+=r*x/this.getFilmWidth()),this.projectionMatrix.makePerspective(f,f+o,a,a-n,r,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(r){let a=super.toJSON(r);return a.object.fov=this.fov,a.object.zoom=this.zoom,a.object.near=this.near,a.object.far=this.far,a.object.focus=this.focus,a.object.aspect=this.aspect,this.view!==null&&(a.object.view=Object.assign({},this.view)),a.object.filmGauge=this.filmGauge,a.object.filmOffset=this.filmOffset,a}},ju=class extends rr{constructor(r,a,n,o,f,y,x,b,_,S){r=r!==void 0?r:[],a=a!==void 0?a:sl,super(r,a,n,o,f,y,x,b,_,S),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(r){this.image=r}},eS=new E,lU=new E,cU=new mr,Gr=class{constructor(r=new E(1,0,0),a=0){this.isPlane=!0,this.normal=r,this.constant=a}set(r,a){return this.normal.copy(r),this.constant=a,this}setComponents(r,a,n,o){return this.normal.set(r,a,n),this.constant=o,this}setFromNormalAndCoplanarPoint(r,a){return this.normal.copy(r),this.constant=-a.dot(this.normal),this}setFromCoplanarPoints(r,a,n){let o=eS.subVectors(n,a).cross(lU.subVectors(r,a)).normalize();return this.setFromNormalAndCoplanarPoint(o,r),this}copy(r){return this.normal.copy(r.normal),this.constant=r.constant,this}normalize(){let r=1/this.normal.length();return this.normal.multiplyScalar(r),this.constant*=r,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(r){return this.normal.dot(r)+this.constant}distanceToSphere(r){return this.distanceToPoint(r.center)-r.radius}projectPoint(r,a){return a.copy(this.normal).multiplyScalar(-this.distanceToPoint(r)).add(r)}intersectLine(r,a){let n=r.delta(eS),o=this.normal.dot(n);if(o===0)return this.distanceToPoint(r.start)===0?a.copy(r.start):null;let f=-(r.start.dot(this.normal)+this.constant)/o;return f<0||f>1?null:a.copy(n).multiplyScalar(f).add(r.start)}intersectsLine(r){let a=this.distanceToPoint(r.start),n=this.distanceToPoint(r.end);return a<0&&n>0||n<0&&a>0}intersectsBox(r){return r.intersectsPlane(this)}intersectsSphere(r){return r.intersectsPlane(this)}coplanarPoint(r){return r.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(r,a){let n=a||cU.getNormalMatrix(r),o=this.coplanarPoint(eS).applyMatrix4(r),f=this.normal.applyMatrix3(n).normalize();return this.constant=-o.dot(f),this}translate(r){return this.constant-=r.dot(this.normal),this}equals(r){return r.normal.equals(this.normal)&&r.constant===this.constant}clone(){return new this.constructor().copy(this)}},Ru=new Nr,$g=new E,wp=class{constructor(r=new Gr,a=new Gr,n=new Gr,o=new Gr,f=new Gr,y=new Gr){this.planes=[r,a,n,o,f,y]}set(r,a,n,o,f,y){let x=this.planes;return x[0].copy(r),x[1].copy(a),x[2].copy(n),x[3].copy(o),x[4].copy(f),x[5].copy(y),this}copy(r){let a=this.planes;for(let n=0;n<6;n++)a[n].copy(r.planes[n]);return this}setFromProjectionMatrix(r){let a=this.planes,n=r.elements,o=n[0],f=n[1],y=n[2],x=n[3],b=n[4],_=n[5],S=n[6],A=n[7],C=n[8],P=n[9],T=n[10],M=n[11],O=n[12],I=n[13],D=n[14],z=n[15];return a[0].setComponents(x-o,A-b,M-C,z-O).normalize(),a[1].setComponents(x+o,A+b,M+C,z+O).normalize(),a[2].setComponents(x+f,A+_,M+P,z+I).normalize(),a[3].setComponents(x-f,A-_,M-P,z-I).normalize(),a[4].setComponents(x-y,A-S,M-T,z-D).normalize(),a[5].setComponents(x+y,A+S,M+T,z+D).normalize(),this}intersectsObject(r){let a=r.geometry;return a.boundingSphere===null&&a.computeBoundingSphere(),Ru.copy(a.boundingSphere).applyMatrix4(r.matrixWorld),this.intersectsSphere(Ru)}intersectsSprite(r){return Ru.center.set(0,0,0),Ru.radius=.7071067811865476,Ru.applyMatrix4(r.matrixWorld),this.intersectsSphere(Ru)}intersectsSphere(r){let a=this.planes,n=r.center,o=-r.radius;for(let f=0;f<6;f++)if(a[f].distanceToPoint(n)<o)return!1;return!0}intersectsBox(r){let a=this.planes;for(let n=0;n<6;n++){let o=a[n];if($g.x=o.normal.x>0?r.max.x:r.min.x,$g.y=o.normal.y>0?r.max.y:r.min.y,$g.z=o.normal.z>0?r.max.z:r.min.z,o.distanceToPoint($g)<0)return!1}return!0}containsPoint(r){let a=this.planes;for(let n=0;n<6;n++)if(a[n].distanceToPoint(r)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}},vi=class extends Ce{constructor(r=1,a=1,n=1,o=1){super(),this.type="PlaneGeometry",this.parameters={width:r,height:a,widthSegments:n,heightSegments:o};let f=r/2,y=a/2,x=Math.floor(n),b=Math.floor(o),_=x+1,S=b+1,A=r/x,C=a/b,P=[],T=[],M=[],O=[];for(let I=0;I<S;I++){let D=I*C-y;for(let z=0;z<_;z++){let k=z*A-f;T.push(k,-D,0),M.push(0,0,1),O.push(z/x),O.push(1-I/b)}}for(let I=0;I<b;I++)for(let D=0;D<x;D++){let z=D+_*I,k=D+_*(I+1),L=D+1+_*(I+1),R=D+1+_*I;P.push(z,k,R),P.push(k,L,R)}this.setIndex(P),this.setAttribute("position",new Te(T,3)),this.setAttribute("normal",new Te(M,3)),this.setAttribute("uv",new Te(O,2))}static fromJSON(r){return new vi(r.width,r.height,r.widthSegments,r.heightSegments)}},az=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Gz=`#if NUM_SPOT_LIGHT_COORDS > 0
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,Wz=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Rk=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,Lk=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,St={lights_fragment_begin:az,shadowmap_pars_fragment:Gz,shadowmask_pars_fragment:Wz,meshphysical_vert:Rk,meshphysical_frag:Lk},Ie={common:{diffuse:{value:new qe(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new mr},uv2Transform:{value:new mr},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new V(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new qe(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new qe(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new mr}},sprite:{diffuse:{value:new qe(16777215)},opacity:{value:1},center:{value:new V(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new mr}}},po={basic:{uniforms:mn([Ie.common,Ie.specularmap,Ie.envmap,Ie.aomap,Ie.lightmap,Ie.fog])},lambert:{uniforms:mn([Ie.common,Ie.specularmap,Ie.envmap,Ie.aomap,Ie.lightmap,Ie.emissivemap,Ie.bumpmap,Ie.normalmap,Ie.displacementmap,Ie.fog,Ie.lights,{emissive:{value:new qe(0)}}])},phong:{uniforms:mn([Ie.common,Ie.specularmap,Ie.envmap,Ie.aomap,Ie.lightmap,Ie.emissivemap,Ie.bumpmap,Ie.normalmap,Ie.displacementmap,Ie.fog,Ie.lights,{emissive:{value:new qe(0)},specular:{value:new qe(1118481)},shininess:{value:30}}])},standard:{uniforms:mn([Ie.common,Ie.envmap,Ie.aomap,Ie.lightmap,Ie.emissivemap,Ie.bumpmap,Ie.normalmap,Ie.displacementmap,Ie.roughnessmap,Ie.metalnessmap,Ie.fog,Ie.lights,{emissive:{value:new qe(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}])},toon:{uniforms:mn([Ie.common,Ie.aomap,Ie.lightmap,Ie.emissivemap,Ie.bumpmap,Ie.normalmap,Ie.displacementmap,Ie.gradientmap,Ie.fog,Ie.lights,{emissive:{value:new qe(0)}}])},matcap:{uniforms:mn([Ie.common,Ie.bumpmap,Ie.normalmap,Ie.displacementmap,Ie.fog,{matcap:{value:null}}])},points:{uniforms:mn([Ie.points,Ie.fog])},dashed:{uniforms:mn([Ie.common,Ie.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}])},depth:{uniforms:mn([Ie.common,Ie.displacementmap])},normal:{uniforms:mn([Ie.common,Ie.bumpmap,Ie.normalmap,Ie.displacementmap,{opacity:{value:1}}])},sprite:{uniforms:mn([Ie.sprite,Ie.fog])},background:{uniforms:{uvTransform:{value:new mr}}},distanceRGBA:{uniforms:mn([Ie.common,Ie.displacementmap,{referencePosition:{value:new E},nearDistance:{value:1},farDistance:{value:1e3}}])},shadow:{uniforms:mn([Ie.lights,Ie.fog,{color:{value:new qe(0)},opacity:{value:1}}])}};po.physical={uniforms:mn([po.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new V(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new qe(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new V},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new qe(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new qe(1,1,1)},specularColorMap:{value:null}}]),vertexShader:St.meshphysical_vert,fragmentShader:St.meshphysical_frag};var ll=class extends yn{constructor(r=-1,a=1,n=1,o=-1,f=.1,y=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=r,this.right=a,this.top=n,this.bottom=o,this.near=f,this.far=y,this.updateProjectionMatrix()}copy(r,a){return super.copy(r,a),this.left=r.left,this.right=r.right,this.top=r.top,this.bottom=r.bottom,this.near=r.near,this.far=r.far,this.zoom=r.zoom,this.view=r.view===null?null:Object.assign({},r.view),this}setViewOffset(r,a,n,o,f,y){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=r,this.view.fullHeight=a,this.view.offsetX=n,this.view.offsetY=o,this.view.width=f,this.view.height=y,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let r=(this.right-this.left)/(2*this.zoom),a=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,o=(this.top+this.bottom)/2,f=n-r,y=n+r,x=o+a,b=o-a;if(this.view!==null&&this.view.enabled){let _=(this.right-this.left)/this.view.fullWidth/this.zoom,S=(this.top-this.bottom)/this.view.fullHeight/this.zoom;f+=_*this.view.offsetX,y=f+_*this.view.width,x-=S*this.view.offsetY,b=x-S*this.view.height}this.projectionMatrix.makeOrthographic(f,y,x,b,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(r){let a=super.toJSON(r);return a.object.zoom=this.zoom,a.object.left=this.left,a.object.right=this.right,a.object.top=this.top,a.object.bottom=this.bottom,a.object.near=this.near,a.object.far=this.far,this.view!==null&&(a.object.view=Object.assign({},this.view)),a}};new ll;new qe;var xc=(1+Math.sqrt(5))/2,Lu=1/xc;new E(1,1,1),new E(-1,1,1),new E(1,1,-1),new E(-1,1,-1),new E(0,xc,Lu),new E(0,xc,-Lu),new E(Lu,0,xc),new E(-Lu,0,xc),new E(xc,Lu,0),new E(-xc,Lu,0);new rr;new xy;new by;new ju;var on=class extends _t{constructor(){super(),this.isGroup=!0,this.type="Group"}},Hu=class{constructor(r,a=1,n=1e3){this.isFog=!0,this.name="",this.color=new qe(r),this.near=a,this.far=n}clone(){return new Hu(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}},wr=class extends _t{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(r,a){return super.copy(r,a),r.background!==null&&(this.background=r.background.clone()),r.environment!==null&&(this.environment=r.environment.clone()),r.fog!==null&&(this.fog=r.fog.clone()),this.backgroundBlurriness=r.backgroundBlurriness,this.backgroundIntensity=r.backgroundIntensity,r.overrideMaterial!==null&&(this.overrideMaterial=r.overrideMaterial.clone()),this.matrixAutoUpdate=r.matrixAutoUpdate,this}toJSON(r){let a=super.toJSON(r);return this.fog!==null&&(a.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(a.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(a.object.backgroundIntensity=this.backgroundIntensity),a}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(r){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=r}},Ay=class{constructor(r,a){this.isInterleavedBuffer=!0,this.array=r,this.stride=a,this.count=r!==void 0?r.length/a:0,this.usage=pS,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=ss()}onUploadCallback(){}set needsUpdate(r){r===!0&&this.version++}setUsage(r){return this.usage=r,this}copy(r){return this.array=new r.array.constructor(r.array),this.count=r.count,this.stride=r.stride,this.usage=r.usage,this}copyAt(r,a,n){r*=this.stride,n*=a.stride;for(let o=0,f=this.stride;o<f;o++)this.array[r+o]=a.array[n+o];return this}set(r,a=0){return this.array.set(r,a),this}clone(r){r.arrayBuffers===void 0&&(r.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ss()),r.arrayBuffers[this.array.buffer._uuid]===void 0&&(r.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let a=new this.array.constructor(r.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(a,this.stride);return n.setUsage(this.usage),n}onUpload(r){return this.onUploadCallback=r,this}toJSON(r){return r.arrayBuffers===void 0&&(r.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ss()),r.arrayBuffers[this.array.buffer._uuid]===void 0&&(r.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},pn=new E,Tc=class{constructor(r,a,n,o=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=r,this.itemSize=a,this.offset=n,this.normalized=o}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(r){this.data.needsUpdate=r}applyMatrix4(r){for(let a=0,n=this.data.count;a<n;a++)pn.fromBufferAttribute(this,a),pn.applyMatrix4(r),this.setXYZ(a,pn.x,pn.y,pn.z);return this}applyNormalMatrix(r){for(let a=0,n=this.count;a<n;a++)pn.fromBufferAttribute(this,a),pn.applyNormalMatrix(r),this.setXYZ(a,pn.x,pn.y,pn.z);return this}transformDirection(r){for(let a=0,n=this.count;a<n;a++)pn.fromBufferAttribute(this,a),pn.transformDirection(r),this.setXYZ(a,pn.x,pn.y,pn.z);return this}setX(r,a){return this.normalized&&(a=Sr(a,this.array)),this.data.array[r*this.data.stride+this.offset]=a,this}setY(r,a){return this.normalized&&(a=Sr(a,this.array)),this.data.array[r*this.data.stride+this.offset+1]=a,this}setZ(r,a){return this.normalized&&(a=Sr(a,this.array)),this.data.array[r*this.data.stride+this.offset+2]=a,this}setW(r,a){return this.normalized&&(a=Sr(a,this.array)),this.data.array[r*this.data.stride+this.offset+3]=a,this}getX(r){let a=this.data.array[r*this.data.stride+this.offset];return this.normalized&&(a=da(a,this.array)),a}getY(r){let a=this.data.array[r*this.data.stride+this.offset+1];return this.normalized&&(a=da(a,this.array)),a}getZ(r){let a=this.data.array[r*this.data.stride+this.offset+2];return this.normalized&&(a=da(a,this.array)),a}getW(r){let a=this.data.array[r*this.data.stride+this.offset+3];return this.normalized&&(a=da(a,this.array)),a}setXY(r,a,n){return r=r*this.data.stride+this.offset,this.normalized&&(a=Sr(a,this.array),n=Sr(n,this.array)),this.data.array[r+0]=a,this.data.array[r+1]=n,this}setXYZ(r,a,n,o){return r=r*this.data.stride+this.offset,this.normalized&&(a=Sr(a,this.array),n=Sr(n,this.array),o=Sr(o,this.array)),this.data.array[r+0]=a,this.data.array[r+1]=n,this.data.array[r+2]=o,this}setXYZW(r,a,n,o,f){return r=r*this.data.stride+this.offset,this.normalized&&(a=Sr(a,this.array),n=Sr(n,this.array),o=Sr(o,this.array),f=Sr(f,this.array)),this.data.array[r+0]=a,this.data.array[r+1]=n,this.data.array[r+2]=o,this.data.array[r+3]=f,this}clone(r){if(r===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let a=[];for(let n=0;n<this.count;n++){let o=n*this.data.stride+this.offset;for(let f=0;f<this.itemSize;f++)a.push(this.data.array[o+f])}return new Ge(new this.array.constructor(a),this.itemSize,this.normalized)}else return r.interleavedBuffers===void 0&&(r.interleavedBuffers={}),r.interleavedBuffers[this.data.uuid]===void 0&&(r.interleavedBuffers[this.data.uuid]=this.data.clone(r)),new Tc(r.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(r){if(r===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let a=[];for(let n=0;n<this.count;n++){let o=n*this.data.stride+this.offset;for(let f=0;f<this.itemSize;f++)a.push(this.data.array[o+f])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:a,normalized:this.normalized}}else return r.interleavedBuffers===void 0&&(r.interleavedBuffers={}),r.interleavedBuffers[this.data.uuid]===void 0&&(r.interleavedBuffers[this.data.uuid]=this.data.toJSON(r)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},Ep=class extends _t{constructor(){super(),this.isBone=!0,this.type="Bone"}},Fr=class extends rr{constructor(r=null,a=1,n=1,o,f,y,x,b,_=yt,S=yt,A,C){super(null,y,x,b,_,S,o,f,A,C),this.isDataTexture=!0,this.image={data:r,width:a,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},qC=new ue,O4=new ue,cl=class{constructor(r=[],a=[]){this.uuid=ss(),this.bones=r.slice(0),this.boneInverses=a,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){let r=this.bones,a=this.boneInverses;if(this.boneMatrices=new Float32Array(r.length*16),a.length===0)this.calculateInverses();else if(r.length!==a.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,o=this.bones.length;n<o;n++)this.boneInverses.push(new ue)}}calculateInverses(){this.boneInverses.length=0;for(let r=0,a=this.bones.length;r<a;r++){let n=new ue;this.bones[r]&&n.copy(this.bones[r].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let r=0,a=this.bones.length;r<a;r++){let n=this.bones[r];n&&n.matrixWorld.copy(this.boneInverses[r]).invert()}for(let r=0,a=this.bones.length;r<a;r++){let n=this.bones[r];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){let r=this.bones,a=this.boneInverses,n=this.boneMatrices,o=this.boneTexture;for(let f=0,y=r.length;f<y;f++){let x=r[f]?r[f].matrixWorld:O4;qC.multiplyMatrices(x,a[f]),qC.toArray(n,f*16)}o!==null&&(o.needsUpdate=!0)}clone(){return new cl(this.bones,this.boneInverses)}computeBoneTexture(){let r=Math.sqrt(this.bones.length*4);r=SP(r),r=Math.max(r,4);let a=new Float32Array(r*r*4);a.set(this.boneMatrices);let n=new Fr(a,r,r,pr,Ft);return n.needsUpdate=!0,this.boneMatrices=a,this.boneTexture=n,this.boneTextureSize=r,this}getBoneByName(r){for(let a=0,n=this.bones.length;a<n;a++){let o=this.bones[a];if(o.name===r)return o}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(r,a){this.uuid=r.uuid;for(let n=0,o=r.bones.length;n<o;n++){let f=r.bones[n],y=a[f];y===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",f),y=new Ep),this.bones.push(y),this.boneInverses.push(new ue().fromArray(r.boneInverses[n]))}return this.init(),this}toJSON(){let r={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};r.uuid=this.uuid;let a=this.bones,n=this.boneInverses;for(let o=0,f=a.length;o<f;o++){let y=a[o];r.bones.push(y.uuid);let x=n[o];r.boneInverses.push(x.toArray())}return r}},go=class extends Ge{constructor(r,a,n,o=1){super(r,a,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=o}copy(r){return super.copy(r),this.meshPerAttribute=r.meshPerAttribute,this}toJSON(){let r=super.toJSON();return r.meshPerAttribute=this.meshPerAttribute,r.isInstancedBufferAttribute=!0,r}},XC=new ue,YC=new ue,ry=[],R4=new ue,cp=new Et,Ey=class extends Et{constructor(r,a,n){super(r,a),this.isInstancedMesh=!0,this.instanceMatrix=new go(new Float32Array(n*16),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1;for(let o=0;o<n;o++)this.setMatrixAt(o,R4)}copy(r,a){return super.copy(r,a),this.instanceMatrix.copy(r.instanceMatrix),r.instanceColor!==null&&(this.instanceColor=r.instanceColor.clone()),this.count=r.count,this}getColorAt(r,a){a.fromArray(this.instanceColor.array,r*3)}getMatrixAt(r,a){a.fromArray(this.instanceMatrix.array,r*16)}raycast(r,a){let n=this.matrixWorld,o=this.count;if(cp.geometry=this.geometry,cp.material=this.material,cp.material!==void 0)for(let f=0;f<o;f++){this.getMatrixAt(f,XC),YC.multiplyMatrices(n,XC),cp.matrixWorld=YC,cp.raycast(r,ry);for(let y=0,x=ry.length;y<x;y++){let b=ry[y];b.instanceId=f,b.object=this,a.push(b)}ry.length=0}}setColorAt(r,a){this.instanceColor===null&&(this.instanceColor=new go(new Float32Array(this.instanceMatrix.count*3),3)),a.toArray(this.instanceColor.array,r*3)}setMatrixAt(r,a){a.toArray(this.instanceMatrix.array,r*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}},as=class extends Ec{constructor(r){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new qe(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.linewidth=r.linewidth,this.linecap=r.linecap,this.linejoin=r.linejoin,this.fog=r.fog,this}},KC=new E,QC=new E,ZC=new ue,nS=new Ns,iy=new Nr,Mc=class extends _t{constructor(r=new Ce,a=new as){super(),this.isLine=!0,this.type="Line",this.geometry=r,this.material=a,this.updateMorphTargets()}copy(r,a){return super.copy(r,a),this.material=r.material,this.geometry=r.geometry,this}computeLineDistances(){let r=this.geometry;if(r.index===null){let a=r.attributes.position,n=[0];for(let o=1,f=a.count;o<f;o++)KC.fromBufferAttribute(a,o-1),QC.fromBufferAttribute(a,o),n[o]=n[o-1],n[o]+=KC.distanceTo(QC);r.setAttribute("lineDistance",new Te(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(r,a){let n=this.geometry,o=this.matrixWorld,f=r.params.Line.threshold,y=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),iy.copy(n.boundingSphere),iy.applyMatrix4(o),iy.radius+=f,r.ray.intersectsSphere(iy)===!1)return;ZC.copy(o).invert(),nS.copy(r.ray).applyMatrix4(ZC);let x=f/((this.scale.x+this.scale.y+this.scale.z)/3),b=x*x,_=new E,S=new E,A=new E,C=new E,P=this.isLineSegments?2:1,T=n.index,M=n.attributes.position;if(T!==null){let O=Math.max(0,y.start),I=Math.min(T.count,y.start+y.count);for(let D=O,z=I-1;D<z;D+=P){let k=T.getX(D),L=T.getX(D+1);if(_.fromBufferAttribute(M,k),S.fromBufferAttribute(M,L),nS.distanceSqToSegment(_,S,C,A)>b)continue;C.applyMatrix4(this.matrixWorld);let R=r.ray.origin.distanceTo(C);R<r.near||R>r.far||a.push({distance:R,point:A.clone().applyMatrix4(this.matrixWorld),index:D,face:null,faceIndex:null,object:this})}}else{let O=Math.max(0,y.start),I=Math.min(M.count,y.start+y.count);for(let D=O,z=I-1;D<z;D+=P){if(_.fromBufferAttribute(M,D),S.fromBufferAttribute(M,D+1),nS.distanceSqToSegment(_,S,C,A)>b)continue;C.applyMatrix4(this.matrixWorld);let k=r.ray.origin.distanceTo(C);k<r.near||k>r.far||a.push({distance:k,point:A.clone().applyMatrix4(this.matrixWorld),index:D,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){let r=this.geometry.morphAttributes,a=Object.keys(r);if(a.length>0){let n=r[a[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,f=n.length;o<f;o++){let y=n[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[y]=o}}}}},JC=new E,$C=new E,ul=class extends Mc{constructor(r,a){super(r,a),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let r=this.geometry;if(r.index===null){let a=r.attributes.position,n=[];for(let o=0,f=a.count;o<f;o+=2)JC.fromBufferAttribute(a,o),$C.fromBufferAttribute(a,o+1),n[o]=o===0?0:n[o-1],n[o+1]=n[o]+JC.distanceTo($C);r.setAttribute("lineDistance",new Te(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},Ty=class extends rr{constructor(r,a,n,o,f,y,x,b,_){super(r,a,n,o,f,y,x,b,_),this.isVideoTexture=!0,this.minFilter=y!==void 0?y:it,this.magFilter=f!==void 0?f:it,this.generateMipmaps=!1;let S=this;function A(){S.needsUpdate=!0,r.requestVideoFrameCallback(A)}"requestVideoFrameCallback"in r&&r.requestVideoFrameCallback(A)}clone(){return new this.constructor(this.image).copy(this)}update(){let r=this.image;!("requestVideoFrameCallback"in r)&&r.readyState>=r.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}},My=class extends rr{constructor(r,a,n,o,f,y,x,b,_){super(r,a,n,o,f,y,x,b,_),this.isCanvasTexture=!0,this.needsUpdate=!0}},ls=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(r,a){let n=this.getUtoTmapping(r);return this.getPoint(n,a)}getPoints(r=5){let a=[];for(let n=0;n<=r;n++)a.push(this.getPoint(n/r));return a}getSpacedPoints(r=5){let a=[];for(let n=0;n<=r;n++)a.push(this.getPointAt(n/r));return a}getLength(){let r=this.getLengths();return r[r.length-1]}getLengths(r=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===r+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let a=[],n,o=this.getPoint(0),f=0;a.push(0);for(let y=1;y<=r;y++)n=this.getPoint(y/r),f+=n.distanceTo(o),a.push(f),o=n;return this.cacheArcLengths=a,a}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(r,a){let n=this.getLengths(),o=0,f=n.length,y;a?y=a:y=r*n[f-1];let x=0,b=f-1,_;for(;x<=b;)if(o=Math.floor(x+(b-x)/2),_=n[o]-y,_<0)x=o+1;else if(_>0)b=o-1;else{b=o;break}if(o=b,n[o]===y)return o/(f-1);let S=n[o],A=n[o+1]-S,C=(y-S)/A;return(o+C)/(f-1)}getTangent(r,a){let n=r-1e-4,o=r+1e-4;n<0&&(n=0),o>1&&(o=1);let f=this.getPoint(n),y=this.getPoint(o),x=a||(f.isVector2?new V:new E);return x.copy(y).sub(f).normalize(),x}getTangentAt(r,a){let n=this.getUtoTmapping(r);return this.getTangent(n,a)}computeFrenetFrames(r,a){let n=new E,o=[],f=[],y=[],x=new E,b=new ue;for(let P=0;P<=r;P++){let T=P/r;o[P]=this.getTangentAt(T,new E)}f[0]=new E,y[0]=new E;let _=Number.MAX_VALUE,S=Math.abs(o[0].x),A=Math.abs(o[0].y),C=Math.abs(o[0].z);S<=_&&(_=S,n.set(1,0,0)),A<=_&&(_=A,n.set(0,1,0)),C<=_&&n.set(0,0,1),x.crossVectors(o[0],n).normalize(),f[0].crossVectors(o[0],x),y[0].crossVectors(o[0],f[0]);for(let P=1;P<=r;P++){if(f[P]=f[P-1].clone(),y[P]=y[P-1].clone(),x.crossVectors(o[P-1],o[P]),x.length()>Number.EPSILON){x.normalize();let T=Math.acos(pi(o[P-1].dot(o[P]),-1,1));f[P].applyMatrix4(b.makeRotationAxis(x,T))}y[P].crossVectors(o[P],f[P])}if(a===!0){let P=Math.acos(pi(f[0].dot(f[r]),-1,1));P/=r,o[0].dot(x.crossVectors(f[0],f[r]))>0&&(P=-P);for(let T=1;T<=r;T++)f[T].applyMatrix4(b.makeRotationAxis(o[T],P*T)),y[T].crossVectors(o[T],f[T])}return{tangents:o,normals:f,binormals:y}}clone(){return new this.constructor().copy(this)}copy(r){return this.arcLengthDivisions=r.arcLengthDivisions,this}toJSON(){let r={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return r.arcLengthDivisions=this.arcLengthDivisions,r.type=this.type,r}fromJSON(r){return this.arcLengthDivisions=r.arcLengthDivisions,this}},Cc=class extends ls{constructor(r=0,a=0,n=1,o=1,f=0,y=Math.PI*2,x=!1,b=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=r,this.aY=a,this.xRadius=n,this.yRadius=o,this.aStartAngle=f,this.aEndAngle=y,this.aClockwise=x,this.aRotation=b}getPoint(r,a){let n=a||new V,o=Math.PI*2,f=this.aEndAngle-this.aStartAngle,y=Math.abs(f)<Number.EPSILON;for(;f<0;)f+=o;for(;f>o;)f-=o;f<Number.EPSILON&&(y?f=0:f=o),this.aClockwise===!0&&!y&&(f===o?f=-o:f=f-o);let x=this.aStartAngle+r*f,b=this.aX+this.xRadius*Math.cos(x),_=this.aY+this.yRadius*Math.sin(x);if(this.aRotation!==0){let S=Math.cos(this.aRotation),A=Math.sin(this.aRotation),C=b-this.aX,P=_-this.aY;b=C*S-P*A+this.aX,_=C*A+P*S+this.aY}return n.set(b,_)}copy(r){return super.copy(r),this.aX=r.aX,this.aY=r.aY,this.xRadius=r.xRadius,this.yRadius=r.yRadius,this.aStartAngle=r.aStartAngle,this.aEndAngle=r.aEndAngle,this.aClockwise=r.aClockwise,this.aRotation=r.aRotation,this}toJSON(){let r=super.toJSON();return r.aX=this.aX,r.aY=this.aY,r.xRadius=this.xRadius,r.yRadius=this.yRadius,r.aStartAngle=this.aStartAngle,r.aEndAngle=this.aEndAngle,r.aClockwise=this.aClockwise,r.aRotation=this.aRotation,r}fromJSON(r){return super.fromJSON(r),this.aX=r.aX,this.aY=r.aY,this.xRadius=r.xRadius,this.yRadius=r.yRadius,this.aStartAngle=r.aStartAngle,this.aEndAngle=r.aEndAngle,this.aClockwise=r.aClockwise,this.aRotation=r.aRotation,this}},_S=class extends Cc{constructor(r,a,n,o,f,y){super(r,a,n,n,o,f,y),this.isArcCurve=!0,this.type="ArcCurve"}};function ew(){let r=0,a=0,n=0,o=0;function f(y,x,b,_){r=y,a=b,n=-3*y+3*x-2*b-_,o=2*y-2*x+b+_}return{initCatmullRom:function(y,x,b,_,S){f(x,b,S*(b-y),S*(_-x))},initNonuniformCatmullRom:function(y,x,b,_,S,A,C){let P=(x-y)/S-(b-y)/(S+A)+(b-x)/A,T=(b-x)/A-(_-x)/(A+C)+(_-b)/C;P*=A,T*=A,f(x,b,P,T)},calc:function(y){let x=y*y,b=x*y;return r+a*y+n*x+o*b}}}var ny=new E,sS=new ew,oS=new ew,aS=new ew,IS=class extends ls{constructor(r=[],a=!1,n="centripetal",o=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=r,this.closed=a,this.curveType=n,this.tension=o}getPoint(r,a=new E){let n=a,o=this.points,f=o.length,y=(f-(this.closed?0:1))*r,x=Math.floor(y),b=y-x;this.closed?x+=x>0?0:(Math.floor(Math.abs(x)/f)+1)*f:b===0&&x===f-1&&(x=f-2,b=1);let _,S;this.closed||x>0?_=o[(x-1)%f]:(ny.subVectors(o[0],o[1]).add(o[0]),_=ny);let A=o[x%f],C=o[(x+1)%f];if(this.closed||x+2<f?S=o[(x+2)%f]:(ny.subVectors(o[f-1],o[f-2]).add(o[f-1]),S=ny),this.curveType==="centripetal"||this.curveType==="chordal"){let P=this.curveType==="chordal"?.5:.25,T=Math.pow(_.distanceToSquared(A),P),M=Math.pow(A.distanceToSquared(C),P),O=Math.pow(C.distanceToSquared(S),P);M<1e-4&&(M=1),T<1e-4&&(T=M),O<1e-4&&(O=M),sS.initNonuniformCatmullRom(_.x,A.x,C.x,S.x,T,M,O),oS.initNonuniformCatmullRom(_.y,A.y,C.y,S.y,T,M,O),aS.initNonuniformCatmullRom(_.z,A.z,C.z,S.z,T,M,O)}else this.curveType==="catmullrom"&&(sS.initCatmullRom(_.x,A.x,C.x,S.x,this.tension),oS.initCatmullRom(_.y,A.y,C.y,S.y,this.tension),aS.initCatmullRom(_.z,A.z,C.z,S.z,this.tension));return n.set(sS.calc(b),oS.calc(b),aS.calc(b)),n}copy(r){super.copy(r),this.points=[];for(let a=0,n=r.points.length;a<n;a++){let o=r.points[a];this.points.push(o.clone())}return this.closed=r.closed,this.curveType=r.curveType,this.tension=r.tension,this}toJSON(){let r=super.toJSON();r.points=[];for(let a=0,n=this.points.length;a<n;a++){let o=this.points[a];r.points.push(o.toArray())}return r.closed=this.closed,r.curveType=this.curveType,r.tension=this.tension,r}fromJSON(r){super.fromJSON(r),this.points=[];for(let a=0,n=r.points.length;a<n;a++){let o=r.points[a];this.points.push(new E().fromArray(o))}return this.closed=r.closed,this.curveType=r.curveType,this.tension=r.tension,this}};function eP(r,a,n,o,f){let y=(o-a)*.5,x=(f-n)*.5,b=r*r,_=r*b;return(2*n-2*o+y+x)*_+(-3*n+3*o-2*y-x)*b+y*r+n}function L4(r,a){let n=1-r;return n*n*a}function B4(r,a){return 2*(1-r)*r*a}function N4(r,a){return r*r*a}function gp(r,a,n,o){return L4(r,a)+B4(r,n)+N4(r,o)}function F4(r,a){let n=1-r;return n*n*n*a}function V4(r,a){let n=1-r;return 3*n*n*r*a}function U4(r,a){return 3*(1-r)*r*r*a}function z4(r,a){return r*r*r*a}function yp(r,a,n,o,f){return F4(r,a)+V4(r,n)+U4(r,o)+z4(r,f)}var ln=class extends ls{constructor(r=new V,a=new V,n=new V,o=new V){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=r,this.v1=a,this.v2=n,this.v3=o}getPoint(r,a=new V){let n=a,o=this.v0,f=this.v1,y=this.v2,x=this.v3;return n.set(yp(r,o.x,f.x,y.x,x.x),yp(r,o.y,f.y,y.y,x.y)),n}copy(r){return super.copy(r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this.v3.copy(r.v3),this}toJSON(){let r=super.toJSON();return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r.v3=this.v3.toArray(),r}fromJSON(r){return super.fromJSON(r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this.v3.fromArray(r.v3),this}},Pc=class extends ls{constructor(r=new E,a=new E,n=new E,o=new E){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=r,this.v1=a,this.v2=n,this.v3=o}getPoint(r,a=new E){let n=a,o=this.v0,f=this.v1,y=this.v2,x=this.v3;return n.set(yp(r,o.x,f.x,y.x,x.x),yp(r,o.y,f.y,y.y,x.y),yp(r,o.z,f.z,y.z,x.z)),n}copy(r){return super.copy(r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this.v3.copy(r.v3),this}toJSON(){let r=super.toJSON();return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r.v3=this.v3.toArray(),r}fromJSON(r){return super.fromJSON(r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this.v3.fromArray(r.v3),this}},cn=class extends ls{constructor(r=new V,a=new V){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=r,this.v2=a}getPoint(r,a=new V){let n=a;return r===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(r).add(this.v1)),n}getPointAt(r,a){return this.getPoint(r,a)}getTangent(r,a){let n=a||new V;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(r){return super.copy(r),this.v1.copy(r.v1),this.v2.copy(r.v2),this}toJSON(){let r=super.toJSON();return r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r}fromJSON(r){return super.fromJSON(r),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this}},Tp=class extends ls{constructor(r=new E,a=new E){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=r,this.v2=a}getPoint(r,a=new E){let n=a;return r===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(r).add(this.v1)),n}getPointAt(r,a){return this.getPoint(r,a)}copy(r){return super.copy(r),this.v1.copy(r.v1),this.v2.copy(r.v2),this}toJSON(){let r=super.toJSON();return r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r}fromJSON(r){return super.fromJSON(r),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this}},Yn=class extends ls{constructor(r=new V,a=new V,n=new V){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=r,this.v1=a,this.v2=n}getPoint(r,a=new V){let n=a,o=this.v0,f=this.v1,y=this.v2;return n.set(gp(r,o.x,f.x,y.x),gp(r,o.y,f.y,y.y)),n}copy(r){return super.copy(r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this}toJSON(){let r=super.toJSON();return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r}fromJSON(r){return super.fromJSON(r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this}},DS=class extends ls{constructor(r=new E,a=new E,n=new E){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=r,this.v1=a,this.v2=n}getPoint(r,a=new E){let n=a,o=this.v0,f=this.v1,y=this.v2;return n.set(gp(r,o.x,f.x,y.x),gp(r,o.y,f.y,y.y),gp(r,o.z,f.z,y.z)),n}copy(r){return super.copy(r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this}toJSON(){let r=super.toJSON();return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r}fromJSON(r){return super.fromJSON(r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this}},Wu=class extends ls{constructor(r=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=r}getPoint(r,a=new V){let n=a,o=this.points,f=(o.length-1)*r,y=Math.floor(f),x=f-y,b=o[y===0?y:y-1],_=o[y],S=o[y>o.length-2?o.length-1:y+1],A=o[y>o.length-3?o.length-1:y+2];return n.set(eP(x,b.x,_.x,S.x,A.x),eP(x,b.y,_.y,S.y,A.y)),n}copy(r){super.copy(r),this.points=[];for(let a=0,n=r.points.length;a<n;a++){let o=r.points[a];this.points.push(o.clone())}return this}toJSON(){let r=super.toJSON();r.points=[];for(let a=0,n=this.points.length;a<n;a++){let o=this.points[a];r.points.push(o.toArray())}return r}fromJSON(r){super.fromJSON(r),this.points=[];for(let a=0,n=r.points.length;a<n;a++){let o=r.points[a];this.points.push(new V().fromArray(o))}return this}},k4=Object.freeze({__proto__:null,ArcCurve:_S,CatmullRomCurve3:IS,CubicBezierCurve:ln,CubicBezierCurve3:Pc,EllipseCurve:Cc,LineCurve:cn,LineCurve3:Tp,QuadraticBezierCurve:Yn,QuadraticBezierCurve3:DS,SplineCurve:Wu}),Mp=class extends ls{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(r){this.curves.push(r)}closePath(){let r=this.curves[0].getPoint(0),a=this.curves[this.curves.length-1].getPoint(1);r.equals(a)||this.curves.push(new cn(a,r))}getPoint(r,a){let n=r*this.getLength(),o=this.getCurveLengths(),f=0;for(;f<o.length;){if(o[f]>=n){let y=o[f]-n,x=this.curves[f],b=x.getLength(),_=b===0?0:1-y/b;return x.getPointAt(_,a)}f++}return null}getLength(){let r=this.getCurveLengths();return r[r.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let r=[],a=0;for(let n=0,o=this.curves.length;n<o;n++)a+=this.curves[n].getLength(),r.push(a);return this.cacheLengths=r,r}getSpacedPoints(r=40){let a=[];for(let n=0;n<=r;n++)a.push(this.getPoint(n/r));return this.autoClose&&a.push(a[0]),a}getPoints(r=12){let a=[],n;for(let o=0,f=this.curves;o<f.length;o++){let y=f[o],x=y.isEllipseCurve?r*2:y.isLineCurve||y.isLineCurve3?1:y.isSplineCurve?r*y.points.length:r,b=y.getPoints(x);for(let _=0;_<b.length;_++){let S=b[_];n&&n.equals(S)||(a.push(S),n=S)}}return this.autoClose&&a.length>1&&!a[a.length-1].equals(a[0])&&a.push(a[0]),a}copy(r){super.copy(r),this.curves=[];for(let a=0,n=r.curves.length;a<n;a++){let o=r.curves[a];this.curves.push(o.clone())}return this.autoClose=r.autoClose,this}toJSON(){let r=super.toJSON();r.autoClose=this.autoClose,r.curves=[];for(let a=0,n=this.curves.length;a<n;a++){let o=this.curves[a];r.curves.push(o.toJSON())}return r}fromJSON(r){super.fromJSON(r),this.autoClose=r.autoClose,this.curves=[];for(let a=0,n=r.curves.length;a<n;a++){let o=r.curves[a];this.curves.push(new k4[o.type]().fromJSON(o))}return this}},_c=class extends Mp{constructor(r){super(),this.type="Path",this.currentPoint=new V,r&&this.setFromPoints(r)}setFromPoints(r){this.moveTo(r[0].x,r[0].y);for(let a=1,n=r.length;a<n;a++)this.lineTo(r[a].x,r[a].y);return this}moveTo(r,a){return this.currentPoint.set(r,a),this}lineTo(r,a){let n=new cn(this.currentPoint.clone(),new V(r,a));return this.curves.push(n),this.currentPoint.set(r,a),this}quadraticCurveTo(r,a,n,o){let f=new Yn(this.currentPoint.clone(),new V(r,a),new V(n,o));return this.curves.push(f),this.currentPoint.set(n,o),this}bezierCurveTo(r,a,n,o,f,y){let x=new ln(this.currentPoint.clone(),new V(r,a),new V(n,o),new V(f,y));return this.curves.push(x),this.currentPoint.set(f,y),this}splineThru(r){let a=[this.currentPoint.clone()].concat(r),n=new Wu(a);return this.curves.push(n),this.currentPoint.copy(r[r.length-1]),this}arc(r,a,n,o,f,y){let x=this.currentPoint.x,b=this.currentPoint.y;return this.absarc(r+x,a+b,n,o,f,y),this}absarc(r,a,n,o,f,y){return this.absellipse(r,a,n,n,o,f,y),this}ellipse(r,a,n,o,f,y,x,b){let _=this.currentPoint.x,S=this.currentPoint.y;return this.absellipse(r+_,a+S,n,o,f,y,x,b),this}absellipse(r,a,n,o,f,y,x,b){let _=new Cc(r,a,n,o,f,y,x,b);if(this.curves.length>0){let A=_.getPoint(0);A.equals(this.currentPoint)||this.lineTo(A.x,A.y)}this.curves.push(_);let S=_.getPoint(1);return this.currentPoint.copy(S),this}copy(r){return super.copy(r),this.currentPoint.copy(r.currentPoint),this}toJSON(){let r=super.toJSON();return r.currentPoint=this.currentPoint.toArray(),r}fromJSON(r){return super.fromJSON(r),this.currentPoint.fromArray(r.currentPoint),this}},qu=class extends Ce{constructor(r=[new V(0,-.5),new V(.5,0),new V(0,.5)],a=12,n=0,o=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:r,segments:a,phiStart:n,phiLength:o},a=Math.floor(a),o=pi(o,0,Math.PI*2);let f=[],y=[],x=[],b=[],_=[],S=1/a,A=new E,C=new V,P=new E,T=new E,M=new E,O=0,I=0;for(let D=0;D<=r.length-1;D++)switch(D){case 0:O=r[D+1].x-r[D].x,I=r[D+1].y-r[D].y,P.x=I*1,P.y=-O,P.z=I*0,M.copy(P),P.normalize(),b.push(P.x,P.y,P.z);break;case r.length-1:b.push(M.x,M.y,M.z);break;default:O=r[D+1].x-r[D].x,I=r[D+1].y-r[D].y,P.x=I*1,P.y=-O,P.z=I*0,T.copy(P),P.x+=M.x,P.y+=M.y,P.z+=M.z,P.normalize(),b.push(P.x,P.y,P.z),M.copy(T)}for(let D=0;D<=a;D++){let z=n+D*S*o,k=Math.sin(z),L=Math.cos(z);for(let R=0;R<=r.length-1;R++){A.x=r[R].x*k,A.y=r[R].y,A.z=r[R].x*L,y.push(A.x,A.y,A.z),C.x=D/a,C.y=R/(r.length-1),x.push(C.x,C.y);let F=b[3*R+0]*k,B=b[3*R+1],N=b[3*R+0]*L;_.push(F,B,N)}}for(let D=0;D<a;D++)for(let z=0;z<r.length-1;z++){let k=z+D*r.length,L=k,R=k+r.length,F=k+r.length+1,B=k+1;f.push(L,R,B),f.push(F,B,R)}this.setIndex(f),this.setAttribute("position",new Te(y,3)),this.setAttribute("uv",new Te(x,2)),this.setAttribute("normal",new Te(_,3))}static fromJSON(r){return new qu(r.points,r.segments,r.phiStart,r.phiLength)}},Ic=class extends Ce{constructor(r=1,a=1,n=1,o=32,f=1,y=!1,x=0,b=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:r,radiusBottom:a,height:n,radialSegments:o,heightSegments:f,openEnded:y,thetaStart:x,thetaLength:b};let _=this;o=Math.floor(o),f=Math.floor(f);let S=[],A=[],C=[],P=[],T=0,M=[],O=n/2,I=0;D(),y===!1&&(r>0&&z(!0),a>0&&z(!1)),this.setIndex(S),this.setAttribute("position",new Te(A,3)),this.setAttribute("normal",new Te(C,3)),this.setAttribute("uv",new Te(P,2));function D(){let k=new E,L=new E,R=0,F=(a-r)/n;for(let B=0;B<=f;B++){let N=[],j=B/f,G=j*(a-r)+r;for(let Y=0;Y<=o;Y++){let X=Y/o,$=X*b+x,te=Math.sin($),ee=Math.cos($);L.x=G*te,L.y=-j*n+O,L.z=G*ee,A.push(L.x,L.y,L.z),k.set(te,F,ee).normalize(),C.push(k.x,k.y,k.z),P.push(X,1-j),N.push(T++)}M.push(N)}for(let B=0;B<o;B++)for(let N=0;N<f;N++){let j=M[N][B],G=M[N+1][B],Y=M[N+1][B+1],X=M[N][B+1];S.push(j,G,X),S.push(G,Y,X),R+=6}_.addGroup(I,R,0),I+=R}function z(k){let L=T,R=new V,F=new E,B=0,N=k===!0?r:a,j=k===!0?1:-1;for(let Y=1;Y<=o;Y++)A.push(0,O*j,0),C.push(0,j,0),P.push(.5,.5),T++;let G=T;for(let Y=0;Y<=o;Y++){let X=Y/o*b+x,$=Math.cos(X),te=Math.sin(X);F.x=N*te,F.y=O*j,F.z=N*$,A.push(F.x,F.y,F.z),C.push(0,j,0),R.x=$*.5+.5,R.y=te*.5*j+.5,P.push(R.x,R.y),T++}for(let Y=0;Y<o;Y++){let X=L+Y,$=G+Y;k===!0?S.push($,$+1,X):S.push($+1,$,X),B+=3}_.addGroup(I,B,k===!0?1:2),I+=B}}static fromJSON(r){return new Ic(r.radiusTop,r.radiusBottom,r.height,r.radialSegments,r.heightSegments,r.openEnded,r.thetaStart,r.thetaLength)}},hl=class extends Ic{constructor(r=1,a=1,n=32,o=1,f=!1,y=0,x=Math.PI*2){super(0,r,a,n,o,f,y,x),this.type="ConeGeometry",this.parameters={radius:r,height:a,radialSegments:n,heightSegments:o,openEnded:f,thetaStart:y,thetaLength:x}}static fromJSON(r){return new hl(r.radius,r.height,r.radialSegments,r.heightSegments,r.openEnded,r.thetaStart,r.thetaLength)}},Xu=class extends Ce{constructor(r=[],a=[],n=1,o=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:r,indices:a,radius:n,detail:o};let f=[],y=[];x(o),_(n),S(),this.setAttribute("position",new Te(f,3)),this.setAttribute("normal",new Te(f.slice(),3)),this.setAttribute("uv",new Te(y,2)),o===0?this.computeVertexNormals():this.normalizeNormals();function x(D){let z=new E,k=new E,L=new E;for(let R=0;R<a.length;R+=3)P(a[R+0],z),P(a[R+1],k),P(a[R+2],L),b(z,k,L,D)}function b(D,z,k,L){let R=L+1,F=[];for(let B=0;B<=R;B++){F[B]=[];let N=D.clone().lerp(k,B/R),j=z.clone().lerp(k,B/R),G=R-B;for(let Y=0;Y<=G;Y++)Y===0&&B===R?F[B][Y]=N:F[B][Y]=N.clone().lerp(j,Y/G)}for(let B=0;B<R;B++)for(let N=0;N<2*(R-B)-1;N++){let j=Math.floor(N/2);N%2===0?(C(F[B][j+1]),C(F[B+1][j]),C(F[B][j])):(C(F[B][j+1]),C(F[B+1][j+1]),C(F[B+1][j]))}}function _(D){let z=new E;for(let k=0;k<f.length;k+=3)z.x=f[k+0],z.y=f[k+1],z.z=f[k+2],z.normalize().multiplyScalar(D),f[k+0]=z.x,f[k+1]=z.y,f[k+2]=z.z}function S(){let D=new E;for(let z=0;z<f.length;z+=3){D.x=f[z+0],D.y=f[z+1],D.z=f[z+2];let k=O(D)/2/Math.PI+.5,L=I(D)/Math.PI+.5;y.push(k,1-L)}T(),A()}function A(){for(let D=0;D<y.length;D+=6){let z=y[D+0],k=y[D+2],L=y[D+4],R=Math.max(z,k,L),F=Math.min(z,k,L);R>.9&&F<.1&&(z<.2&&(y[D+0]+=1),k<.2&&(y[D+2]+=1),L<.2&&(y[D+4]+=1))}}function C(D){f.push(D.x,D.y,D.z)}function P(D,z){let k=D*3;z.x=r[k+0],z.y=r[k+1],z.z=r[k+2]}function T(){let D=new E,z=new E,k=new E,L=new E,R=new V,F=new V,B=new V;for(let N=0,j=0;N<f.length;N+=9,j+=6){D.set(f[N+0],f[N+1],f[N+2]),z.set(f[N+3],f[N+4],f[N+5]),k.set(f[N+6],f[N+7],f[N+8]),R.set(y[j+0],y[j+1]),F.set(y[j+2],y[j+3]),B.set(y[j+4],y[j+5]),L.copy(D).add(z).add(k).divideScalar(3);let G=O(L);M(R,j+0,D,G),M(F,j+2,z,G),M(B,j+4,k,G)}}function M(D,z,k,L){L<0&&D.x===1&&(y[z]=D.x-1),k.x===0&&k.z===0&&(y[z]=L/2/Math.PI+.5)}function O(D){return Math.atan2(D.z,-D.x)}function I(D){return Math.atan2(-D.y,Math.sqrt(D.x*D.x+D.z*D.z))}}static fromJSON(r){return new Xu(r.vertices,r.indices,r.radius,r.details)}},Yu=class extends Xu{constructor(r=1,a=0){let n=(1+Math.sqrt(5))/2,o=1/n,f=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-o,-n,0,-o,n,0,o,-n,0,o,n,-o,-n,0,-o,n,0,o,-n,0,o,n,0,-n,0,-o,n,0,-o,-n,0,o,n,0,o],y=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(f,y,r,a),this.type="DodecahedronGeometry",this.parameters={radius:r,detail:a}}static fromJSON(r){return new Yu(r.radius,r.detail)}},fa=class extends _c{constructor(r){super(r),this.uuid=ss(),this.type="Shape",this.holes=[]}getPointsHoles(r){let a=[];for(let n=0,o=this.holes.length;n<o;n++)a[n]=this.holes[n].getPoints(r);return a}extractPoints(r){return{shape:this.getPoints(r),holes:this.getPointsHoles(r)}}copy(r){super.copy(r),this.holes=[];for(let a=0,n=r.holes.length;a<n;a++){let o=r.holes[a];this.holes.push(o.clone())}return this}toJSON(){let r=super.toJSON();r.uuid=this.uuid,r.holes=[];for(let a=0,n=this.holes.length;a<n;a++){let o=this.holes[a];r.holes.push(o.toJSON())}return r}fromJSON(r){super.fromJSON(r),this.uuid=r.uuid,this.holes=[];for(let a=0,n=r.holes.length;a<n;a++){let o=r.holes[a];this.holes.push(new _c().fromJSON(o))}return this}},G4={triangulate:function(r,a,n=2){let o=a&&a.length,f=o?a[0]*n:r.length,y=IP(r,0,f,n,!0),x=[];if(!y||y.next===y.prev)return x;let b,_,S,A,C,P,T;if(o&&(y=X4(r,a,y,n)),r.length>80*n){b=S=r[0],_=A=r[1];for(let M=n;M<f;M+=n)C=r[M],P=r[M+1],C<b&&(b=C),P<_&&(_=P),C>S&&(S=C),P>A&&(A=P);T=Math.max(S-b,A-_),T=T!==0?32767/T:0}return Cp(y,x,n,b,_,T,0),x}};function IP(r,a,n,o,f){let y,x;if(f===n5(r,a,n,o)>0)for(y=a;y<n;y+=o)x=tP(y,r[y],r[y+1],x);else for(y=n-o;y>=a;y-=o)x=tP(y,r[y],r[y+1],x);return x&&Hy(x,x.next)&&(_p(x),x=x.next),x}function Dc(r,a){if(!r)return r;a||(a=r);let n=r,o;do if(o=!1,!n.steiner&&(Hy(n,n.next)||jr(n.prev,n,n.next)===0)){if(_p(n),n=a=n.prev,n===n.next)break;o=!0}else n=n.next;while(o||n!==a);return a}function Cp(r,a,n,o,f,y,x){if(!r)return;!x&&y&&J4(r,o,f,y);let b=r,_,S;for(;r.prev!==r.next;){if(_=r.prev,S=r.next,y?H4(r,o,f,y):j4(r)){a.push(_.i/n|0),a.push(r.i/n|0),a.push(S.i/n|0),_p(r),r=S.next,b=S.next;continue}if(r=S,r===b){x?x===1?(r=W4(Dc(r),a,n),Cp(r,a,n,o,f,y,2)):x===2&&q4(r,a,n,o,f,y):Cp(Dc(r),a,n,o,f,y,1);break}}}function j4(r){let a=r.prev,n=r,o=r.next;if(jr(a,n,o)>=0)return!1;let f=a.x,y=n.x,x=o.x,b=a.y,_=n.y,S=o.y,A=f<y?f<x?f:x:y<x?y:x,C=b<_?b<S?b:S:_<S?_:S,P=f>y?f>x?f:x:y>x?y:x,T=b>_?b>S?b:S:_>S?_:S,M=o.next;for(;M!==a;){if(M.x>=A&&M.x<=P&&M.y>=C&&M.y<=T&&Uu(f,b,y,_,x,S,M.x,M.y)&&jr(M.prev,M,M.next)>=0)return!1;M=M.next}return!0}function H4(r,a,n,o){let f=r.prev,y=r,x=r.next;if(jr(f,y,x)>=0)return!1;let b=f.x,_=y.x,S=x.x,A=f.y,C=y.y,P=x.y,T=b<_?b<S?b:S:_<S?_:S,M=A<C?A<P?A:P:C<P?C:P,O=b>_?b>S?b:S:_>S?_:S,I=A>C?A>P?A:P:C>P?C:P,D=OS(T,M,a,n,o),z=OS(O,I,a,n,o),k=r.prevZ,L=r.nextZ;for(;k&&k.z>=D&&L&&L.z<=z;){if(k.x>=T&&k.x<=O&&k.y>=M&&k.y<=I&&k!==f&&k!==x&&Uu(b,A,_,C,S,P,k.x,k.y)&&jr(k.prev,k,k.next)>=0||(k=k.prevZ,L.x>=T&&L.x<=O&&L.y>=M&&L.y<=I&&L!==f&&L!==x&&Uu(b,A,_,C,S,P,L.x,L.y)&&jr(L.prev,L,L.next)>=0))return!1;L=L.nextZ}for(;k&&k.z>=D;){if(k.x>=T&&k.x<=O&&k.y>=M&&k.y<=I&&k!==f&&k!==x&&Uu(b,A,_,C,S,P,k.x,k.y)&&jr(k.prev,k,k.next)>=0)return!1;k=k.prevZ}for(;L&&L.z<=z;){if(L.x>=T&&L.x<=O&&L.y>=M&&L.y<=I&&L!==f&&L!==x&&Uu(b,A,_,C,S,P,L.x,L.y)&&jr(L.prev,L,L.next)>=0)return!1;L=L.nextZ}return!0}function W4(r,a,n){let o=r;do{let f=o.prev,y=o.next.next;!Hy(f,y)&&DP(f,o,o.next,y)&&Pp(f,y)&&Pp(y,f)&&(a.push(f.i/n|0),a.push(o.i/n|0),a.push(y.i/n|0),_p(o),_p(o.next),o=r=y),o=o.next}while(o!==r);return Dc(o)}function q4(r,a,n,o,f,y){let x=r;do{let b=x.next.next;for(;b!==x.prev;){if(x.i!==b.i&&t5(x,b)){let _=OP(x,b);x=Dc(x,x.next),_=Dc(_,_.next),Cp(x,a,n,o,f,y,0),Cp(_,a,n,o,f,y,0);return}b=b.next}x=x.next}while(x!==r)}function X4(r,a,n,o){let f=[],y,x,b,_,S;for(y=0,x=a.length;y<x;y++)b=a[y]*o,_=y<x-1?a[y+1]*o:r.length,S=IP(r,b,_,o,!1),S===S.next&&(S.steiner=!0),f.push(e5(S));for(f.sort(Y4),y=0;y<f.length;y++)n=K4(f[y],n);return n}function Y4(r,a){return r.x-a.x}function K4(r,a){let n=Q4(r,a);if(!n)return a;let o=OP(n,r);return Dc(o,o.next),Dc(n,n.next)}function Q4(r,a){let n=a,o=-1/0,f,y=r.x,x=r.y;do{if(x<=n.y&&x>=n.next.y&&n.next.y!==n.y){let P=n.x+(x-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(P<=y&&P>o&&(o=P,f=n.x<n.next.x?n:n.next,P===y))return f}n=n.next}while(n!==a);if(!f)return null;let b=f,_=f.x,S=f.y,A=1/0,C;n=f;do y>=n.x&&n.x>=_&&y!==n.x&&Uu(x<S?y:o,x,_,S,x<S?o:y,x,n.x,n.y)&&(C=Math.abs(x-n.y)/(y-n.x),Pp(n,r)&&(C<A||C===A&&(n.x>f.x||n.x===f.x&&Z4(f,n)))&&(f=n,A=C)),n=n.next;while(n!==b);return f}function Z4(r,a){return jr(r.prev,r,a.prev)<0&&jr(a.next,r,r.next)<0}function J4(r,a,n,o){let f=r;do f.z===0&&(f.z=OS(f.x,f.y,a,n,o)),f.prevZ=f.prev,f.nextZ=f.next,f=f.next;while(f!==r);f.prevZ.nextZ=null,f.prevZ=null,$4(f)}function $4(r){let a,n,o,f,y,x,b,_,S=1;do{for(n=r,r=null,y=null,x=0;n;){for(x++,o=n,b=0,a=0;a<S&&(b++,o=o.nextZ,!!o);a++);for(_=S;b>0||_>0&&o;)b!==0&&(_===0||!o||n.z<=o.z)?(f=n,n=n.nextZ,b--):(f=o,o=o.nextZ,_--),y?y.nextZ=f:r=f,f.prevZ=y,y=f;n=o}y.nextZ=null,S*=2}while(x>1);return r}function OS(r,a,n,o,f){return r=(r-n)*f|0,a=(a-o)*f|0,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,a=(a|a<<8)&16711935,a=(a|a<<4)&252645135,a=(a|a<<2)&858993459,a=(a|a<<1)&1431655765,r|a<<1}function e5(r){let a=r,n=r;do(a.x<n.x||a.x===n.x&&a.y<n.y)&&(n=a),a=a.next;while(a!==r);return n}function Uu(r,a,n,o,f,y,x,b){return(f-x)*(a-b)>=(r-x)*(y-b)&&(r-x)*(o-b)>=(n-x)*(a-b)&&(n-x)*(y-b)>=(f-x)*(o-b)}function t5(r,a){return r.next.i!==a.i&&r.prev.i!==a.i&&!r5(r,a)&&(Pp(r,a)&&Pp(a,r)&&i5(r,a)&&(jr(r.prev,r,a.prev)||jr(r,a.prev,a))||Hy(r,a)&&jr(r.prev,r,r.next)>0&&jr(a.prev,a,a.next)>0)}function jr(r,a,n){return(a.y-r.y)*(n.x-a.x)-(a.x-r.x)*(n.y-a.y)}function Hy(r,a){return r.x===a.x&&r.y===a.y}function DP(r,a,n,o){let f=oy(jr(r,a,n)),y=oy(jr(r,a,o)),x=oy(jr(n,o,r)),b=oy(jr(n,o,a));return!!(f!==y&&x!==b||f===0&&sy(r,n,a)||y===0&&sy(r,o,a)||x===0&&sy(n,r,o)||b===0&&sy(n,a,o))}function sy(r,a,n){return a.x<=Math.max(r.x,n.x)&&a.x>=Math.min(r.x,n.x)&&a.y<=Math.max(r.y,n.y)&&a.y>=Math.min(r.y,n.y)}function oy(r){return r>0?1:r<0?-1:0}function r5(r,a){let n=r;do{if(n.i!==r.i&&n.next.i!==r.i&&n.i!==a.i&&n.next.i!==a.i&&DP(n,n.next,r,a))return!0;n=n.next}while(n!==r);return!1}function Pp(r,a){return jr(r.prev,r,r.next)<0?jr(r,a,r.next)>=0&&jr(r,r.prev,a)>=0:jr(r,a,r.prev)<0||jr(r,r.next,a)<0}function i5(r,a){let n=r,o=!1,f=(r.x+a.x)/2,y=(r.y+a.y)/2;do n.y>y!=n.next.y>y&&n.next.y!==n.y&&f<(n.next.x-n.x)*(y-n.y)/(n.next.y-n.y)+n.x&&(o=!o),n=n.next;while(n!==r);return o}function OP(r,a){let n=new RS(r.i,r.x,r.y),o=new RS(a.i,a.x,a.y),f=r.next,y=a.prev;return r.next=a,a.prev=r,n.next=f,f.prev=n,o.next=n,n.prev=o,y.next=o,o.prev=y,o}function tP(r,a,n,o){let f=new RS(r,a,n);return o?(f.next=o.next,f.prev=o,o.next.prev=f,o.next=f):(f.prev=f,f.next=f),f}function _p(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function RS(r,a,n){this.i=r,this.x=a,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function n5(r,a,n,o){let f=0;for(let y=a,x=n-o;y<n;y+=o)f+=(r[x]-r[y])*(r[y+1]+r[x+1]),x=y;return f}var Ku=class{static area(r){let a=r.length,n=0;for(let o=a-1,f=0;f<a;o=f++)n+=r[o].x*r[f].y-r[f].x*r[o].y;return n*.5}static isClockWise(r){return Ku.area(r)<0}static triangulateShape(r,a){let n=[],o=[],f=[];rP(r),iP(n,r);let y=r.length;a.forEach(rP);for(let b=0;b<a.length;b++)o.push(y),y+=a[b].length,iP(n,a[b]);let x=G4.triangulate(n,o);for(let b=0;b<x.length;b+=3)f.push(x.slice(b,b+3));return f}};function rP(r){let a=r.length;a>2&&r[a-1].equals(r[0])&&r.pop()}function iP(r,a){for(let n=0;n<a.length;n++)r.push(a[n].x),r.push(a[n].y)}var Qu=class extends Xu{constructor(r=1,a=0){let n=(1+Math.sqrt(5))/2,o=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],f=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(o,f,r,a),this.type="IcosahedronGeometry",this.parameters={radius:r,detail:a}}static fromJSON(r){return new Qu(r.radius,r.detail)}},Fs=class extends Ce{constructor(r=1,a=32,n=16,o=0,f=Math.PI*2,y=0,x=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:r,widthSegments:a,heightSegments:n,phiStart:o,phiLength:f,thetaStart:y,thetaLength:x},a=Math.max(3,Math.floor(a)),n=Math.max(2,Math.floor(n));let b=Math.min(y+x,Math.PI),_=0,S=[],A=new E,C=new E,P=[],T=[],M=[],O=[];for(let I=0;I<=n;I++){let D=[],z=I/n,k=0;I==0&&y==0?k=.5/a:I==n&&b==Math.PI&&(k=-.5/a);for(let L=0;L<=a;L++){let R=L/a;A.x=-r*Math.cos(o+R*f)*Math.sin(y+z*x),A.y=r*Math.cos(y+z*x),A.z=r*Math.sin(o+R*f)*Math.sin(y+z*x),T.push(A.x,A.y,A.z),C.copy(A).normalize(),M.push(C.x,C.y,C.z),O.push(R+k,1-z),D.push(_++)}S.push(D)}for(let I=0;I<n;I++)for(let D=0;D<a;D++){let z=S[I][D+1],k=S[I][D],L=S[I+1][D],R=S[I+1][D+1];(I!==0||y>0)&&P.push(z,k,R),(I!==n-1||b<Math.PI)&&P.push(k,L,R)}this.setIndex(P),this.setAttribute("position",new Te(T,3)),this.setAttribute("normal",new Te(M,3)),this.setAttribute("uv",new Te(O,2))}static fromJSON(r){return new Fs(r.radius,r.widthSegments,r.heightSegments,r.phiStart,r.phiLength,r.thetaStart,r.thetaLength)}},Zu=class extends Ce{constructor(r=1,a=.4,n=12,o=48,f=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:r,tube:a,radialSegments:n,tubularSegments:o,arc:f},n=Math.floor(n),o=Math.floor(o);let y=[],x=[],b=[],_=[],S=new E,A=new E,C=new E;for(let P=0;P<=n;P++)for(let T=0;T<=o;T++){let M=T/o*f,O=P/n*Math.PI*2;A.x=(r+a*Math.cos(O))*Math.cos(M),A.y=(r+a*Math.cos(O))*Math.sin(M),A.z=a*Math.sin(O),x.push(A.x,A.y,A.z),S.x=r*Math.cos(M),S.y=r*Math.sin(M),C.subVectors(A,S).normalize(),b.push(C.x,C.y,C.z),_.push(T/o),_.push(P/n)}for(let P=1;P<=n;P++)for(let T=1;T<=o;T++){let M=(o+1)*P+T-1,O=(o+1)*(P-1)+T-1,I=(o+1)*(P-1)+T,D=(o+1)*P+T;y.push(M,O,D),y.push(O,I,D)}this.setIndex(y),this.setAttribute("position",new Te(x,3)),this.setAttribute("normal",new Te(b,3)),this.setAttribute("uv",new Te(_,2))}static fromJSON(r){return new Zu(r.radius,r.tube,r.radialSegments,r.tubularSegments,r.arc)}},Ju=class extends Ce{constructor(r=1,a=.4,n=64,o=8,f=2,y=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:r,tube:a,tubularSegments:n,radialSegments:o,p:f,q:y},n=Math.floor(n),o=Math.floor(o);let x=[],b=[],_=[],S=[],A=new E,C=new E,P=new E,T=new E,M=new E,O=new E,I=new E;for(let z=0;z<=n;++z){let k=z/n*f*Math.PI*2;D(k,f,y,r,P),D(k+.01,f,y,r,T),O.subVectors(T,P),I.addVectors(T,P),M.crossVectors(O,I),I.crossVectors(M,O),M.normalize(),I.normalize();for(let L=0;L<=o;++L){let R=L/o*Math.PI*2,F=-a*Math.cos(R),B=a*Math.sin(R);A.x=P.x+(F*I.x+B*M.x),A.y=P.y+(F*I.y+B*M.y),A.z=P.z+(F*I.z+B*M.z),b.push(A.x,A.y,A.z),C.subVectors(A,P).normalize(),_.push(C.x,C.y,C.z),S.push(z/n),S.push(L/o)}}for(let z=1;z<=n;z++)for(let k=1;k<=o;k++){let L=(o+1)*(z-1)+(k-1),R=(o+1)*z+(k-1),F=(o+1)*z+k,B=(o+1)*(z-1)+k;x.push(L,R,B),x.push(R,F,B)}this.setIndex(x),this.setAttribute("position",new Te(b,3)),this.setAttribute("normal",new Te(_,3)),this.setAttribute("uv",new Te(S,2));function D(z,k,L,R,F){let B=Math.cos(z),N=Math.sin(z),j=L/k*z,G=Math.cos(j);F.x=R*(2+G)*.5*B,F.y=R*(2+G)*N*.5,F.z=R*Math.sin(j)*.5}}static fromJSON(r){return new Ju(r.radius,r.tube,r.tubularSegments,r.radialSegments,r.p,r.q)}},Cy=class extends Je{constructor(r){super(r),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}},Iy={enabled:!1,files:{},add:function(r,a){this.enabled!==!1&&(this.files[r]=a)},get:function(r){if(this.enabled!==!1)return this.files[r]},remove:function(r){delete this.files[r]},clear:function(){this.files={}}},Ip=class{constructor(r,a,n){let o=this,f=!1,y=0,x=0,b,_=[];this.onStart=void 0,this.onLoad=r,this.onProgress=a,this.onError=n,this.itemStart=function(S){x++,f===!1&&o.onStart!==void 0&&o.onStart(S,y,x),f=!0},this.itemEnd=function(S){y++,o.onProgress!==void 0&&o.onProgress(S,y,x),y===x&&(f=!1,o.onLoad!==void 0&&o.onLoad())},this.itemError=function(S){o.onError!==void 0&&o.onError(S)},this.resolveURL=function(S){return b?b(S):S},this.setURLModifier=function(S){return b=S,this},this.addHandler=function(S,A){return _.push(S,A),this},this.removeHandler=function(S){let A=_.indexOf(S);return A!==-1&&_.splice(A,2),this},this.getHandler=function(S){for(let A=0,C=_.length;A<C;A+=2){let P=_[A],T=_[A+1];if(P.global&&(P.lastIndex=0),P.test(S))return T}return null}}},l5=new Ip,pl=class{constructor(r){this.manager=r!==void 0?r:l5,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(r,a){let n=this;return new Promise(function(o,f){n.load(r,o,a,f)})}parse(){}setCrossOrigin(r){return this.crossOrigin=r,this}setWithCredentials(r){return this.withCredentials=r,this}setPath(r){return this.path=r,this}setResourcePath(r){return this.resourcePath=r,this}setRequestHeader(r){return this.requestHeader=r,this}},ua={},FS=class extends Error{constructor(r,a){super(r),this.response=a}},ih=class extends pl{constructor(r){super(r)}load(r,a,n,o){r===void 0&&(r=""),this.path!==void 0&&(r=this.path+r),r=this.manager.resolveURL(r);let f=Iy.get(r);if(f!==void 0)return this.manager.itemStart(r),setTimeout(()=>{a&&a(f),this.manager.itemEnd(r)},0),f;if(ua[r]!==void 0){ua[r].push({onLoad:a,onProgress:n,onError:o});return}ua[r]=[],ua[r].push({onLoad:a,onProgress:n,onError:o});let y=new Request(r,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),x=this.mimeType,b=this.responseType;fetch(y).then(_=>{if(_.status===200||_.status===0){if(_.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||_.body===void 0||_.body.getReader===void 0)return _;let S=ua[r],A=_.body.getReader(),C=_.headers.get("Content-Length")||_.headers.get("X-File-Size"),P=C?parseInt(C):0,T=P!==0,M=0,O=new ReadableStream({start(I){D();function D(){A.read().then(({done:z,value:k})=>{if(z)I.close();else{M+=k.byteLength;let L=new ProgressEvent("progress",{lengthComputable:T,loaded:M,total:P});for(let R=0,F=S.length;R<F;R++){let B=S[R];B.onProgress&&B.onProgress(L)}I.enqueue(k),D()}})}}});return new Response(O)}else throw new FS(`fetch for "${_.url}" responded with ${_.status}: ${_.statusText}`,_)}).then(_=>{switch(b){case"arraybuffer":return _.arrayBuffer();case"blob":return _.blob();case"document":return _.text().then(S=>new DOMParser().parseFromString(S,x));case"json":return _.json();default:if(x===void 0)return _.text();{let S=/charset="?([^;"\s]*)"?/i.exec(x),A=S&&S[1]?S[1].toLowerCase():void 0,C=new TextDecoder(A);return _.arrayBuffer().then(P=>C.decode(P))}}}).then(_=>{Iy.add(r,_);let S=ua[r];delete ua[r];for(let A=0,C=S.length;A<C;A++){let P=S[A];P.onLoad&&P.onLoad(_)}}).catch(_=>{let S=ua[r];if(S===void 0)throw this.manager.itemError(r),_;delete ua[r];for(let A=0,C=S.length;A<C;A++){let P=S[A];P.onError&&P.onError(_)}this.manager.itemError(r)}).finally(()=>{this.manager.itemEnd(r)}),this.manager.itemStart(r)}setResponseType(r){return this.responseType=r,this}setMimeType(r){return this.mimeType=r,this}},VS=class extends pl{constructor(r){super(r)}load(r,a,n,o){this.path!==void 0&&(r=this.path+r),r=this.manager.resolveURL(r);let f=this,y=Iy.get(r);if(y!==void 0)return f.manager.itemStart(r),setTimeout(function(){a&&a(y),f.manager.itemEnd(r)},0),y;let x=bp("img");function b(){S(),Iy.add(r,this),a&&a(this),f.manager.itemEnd(r)}function _(A){S(),o&&o(A),f.manager.itemError(r),f.manager.itemEnd(r)}function S(){x.removeEventListener("load",b,!1),x.removeEventListener("error",_,!1)}return x.addEventListener("load",b,!1),x.addEventListener("error",_,!1),r.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(x.crossOrigin=this.crossOrigin),f.manager.itemStart(r),x.src=r,x}},Dy=class extends pl{constructor(r){super(r)}load(r,a,n,o){let f=new rr,y=new VS(this.manager);return y.setCrossOrigin(this.crossOrigin),y.setPath(this.path),y.load(r,function(x){f.image=x,f.needsUpdate=!0,a!==void 0&&a(f)},n,o),f}},ml=class extends _t{constructor(r,a=1){super(),this.isLight=!0,this.type="Light",this.color=new qe(r),this.intensity=a}dispose(){}copy(r,a){return super.copy(r,a),this.color.copy(r.color),this.intensity=r.intensity,this}toJSON(r){let a=super.toJSON(r);return a.object.color=this.color.getHex(),a.object.intensity=this.intensity,this.groundColor!==void 0&&(a.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(a.object.distance=this.distance),this.angle!==void 0&&(a.object.angle=this.angle),this.decay!==void 0&&(a.object.decay=this.decay),this.penumbra!==void 0&&(a.object.penumbra=this.penumbra),this.shadow!==void 0&&(a.object.shadow=this.shadow.toJSON()),a}},Oy=class extends ml{constructor(r,a,n){super(r,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(_t.DEFAULT_UP),this.updateMatrix(),this.groundColor=new qe(a)}copy(r,a){return super.copy(r,a),this.groundColor.copy(r.groundColor),this}},lS=new ue,sP=new E,oP=new E,Dp=class{constructor(r){this.camera=r,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new V(512,512),this.map=null,this.mapPass=null,this.matrix=new ue,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new wp,this._frameExtents=new V(1,1),this._viewportCount=1,this._viewports=[new Qe(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(r){let a=this.camera,n=this.matrix;sP.setFromMatrixPosition(r.matrixWorld),a.position.copy(sP),oP.setFromMatrixPosition(r.target.matrixWorld),a.lookAt(oP),a.updateMatrixWorld(),lS.multiplyMatrices(a.projectionMatrix,a.matrixWorldInverse),this._frustum.setFromProjectionMatrix(lS),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(lS)}getViewport(r){return this._viewports[r]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(r){return this.camera=r.camera.clone(),this.bias=r.bias,this.radius=r.radius,this.mapSize.copy(r.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let r={};return this.bias!==0&&(r.bias=this.bias),this.normalBias!==0&&(r.normalBias=this.normalBias),this.radius!==1&&(r.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(r.mapSize=this.mapSize.toArray()),r.camera=this.camera.toJSON(!1).object,delete r.camera.matrix,r}},US=class extends Dp{constructor(){super(new ti(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(r){let a=this.camera,n=xp*2*r.angle*this.focus,o=this.mapSize.width/this.mapSize.height,f=r.distance||a.far;(n!==a.fov||o!==a.aspect||f!==a.far)&&(a.fov=n,a.aspect=o,a.far=f,a.updateProjectionMatrix()),super.updateMatrices(r)}copy(r){return super.copy(r),this.focus=r.focus,this}},Ry=class extends ml{constructor(r,a,n=0,o=Math.PI/3,f=0,y=2){super(r,a),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(_t.DEFAULT_UP),this.updateMatrix(),this.target=new _t,this.distance=n,this.angle=o,this.penumbra=f,this.decay=y,this.map=null,this.shadow=new US}get power(){return this.intensity*Math.PI}set power(r){this.intensity=r/Math.PI}dispose(){this.shadow.dispose()}copy(r,a){return super.copy(r,a),this.distance=r.distance,this.angle=r.angle,this.penumbra=r.penumbra,this.decay=r.decay,this.target=r.target.clone(),this.shadow=r.shadow.clone(),this}},aP=new ue,up=new E,cS=new E,zS=class extends Dp{constructor(){super(new ti(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new V(4,2),this._viewportCount=6,this._viewports=[new Qe(2,1,1,1),new Qe(0,1,1,1),new Qe(3,1,1,1),new Qe(1,1,1,1),new Qe(3,0,1,1),new Qe(1,0,1,1)],this._cubeDirections=[new E(1,0,0),new E(-1,0,0),new E(0,0,1),new E(0,0,-1),new E(0,1,0),new E(0,-1,0)],this._cubeUps=[new E(0,1,0),new E(0,1,0),new E(0,1,0),new E(0,1,0),new E(0,0,1),new E(0,0,-1)]}updateMatrices(r,a=0){let n=this.camera,o=this.matrix,f=r.distance||n.far;f!==n.far&&(n.far=f,n.updateProjectionMatrix()),up.setFromMatrixPosition(r.matrixWorld),n.position.copy(up),cS.copy(n.position),cS.add(this._cubeDirections[a]),n.up.copy(this._cubeUps[a]),n.lookAt(cS),n.updateMatrixWorld(),o.makeTranslation(-up.x,-up.y,-up.z),aP.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(aP)}},Ly=class extends ml{constructor(r,a,n=0,o=2){super(r,a),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=o,this.shadow=new zS}get power(){return this.intensity*4*Math.PI}set power(r){this.intensity=r/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(r,a){return super.copy(r,a),this.distance=r.distance,this.decay=r.decay,this.shadow=r.shadow.clone(),this}},kS=class extends Dp{constructor(){super(new ll(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},By=class extends ml{constructor(r,a){super(r,a),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(_t.DEFAULT_UP),this.updateMatrix(),this.target=new _t,this.shadow=new kS}dispose(){this.shadow.dispose()}copy(r){return super.copy(r),this.target=r.target.clone(),this.shadow=r.shadow.clone(),this}},Op=class extends Ce{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(r){return super.copy(r),this.instanceCount=r.instanceCount,this}toJSON(){let r=super.toJSON();return r.instanceCount=this.instanceCount,r.isInstancedBufferGeometry=!0,r}},nh=class extends pl{constructor(r){super(r)}load(r,a,n,o){let f=this,y=new ih(f.manager);y.setPath(f.path),y.setRequestHeader(f.requestHeader),y.setWithCredentials(f.withCredentials),y.load(r,function(x){try{a(f.parse(JSON.parse(x)))}catch(b){o?o(b):console.error(b),f.manager.itemError(r)}},n,o)}parse(r){let a={},n={};function o(C,P){if(a[P]!==void 0)return a[P];let T=C.interleavedBuffers[P],M=f(C,T.buffer),O=Fg(T.type,M),I=new Ay(O,T.stride);return I.uuid=T.uuid,a[P]=I,I}function f(C,P){if(n[P]!==void 0)return n[P];let T=C.arrayBuffers[P],M=new Uint32Array(T).buffer;return n[P]=M,M}let y=r.isInstancedBufferGeometry?new Op:new Ce,x=r.data.index;if(x!==void 0){let C=Fg(x.type,x.array);y.setIndex(new Ge(C,1))}let b=r.data.attributes;for(let C in b){let P=b[C],T;if(P.isInterleavedBufferAttribute){let M=o(r.data,P.data);T=new Tc(M,P.itemSize,P.offset,P.normalized)}else{let M=Fg(P.type,P.array),O=P.isInstancedBufferAttribute?go:Ge;T=new O(M,P.itemSize,P.normalized)}P.name!==void 0&&(T.name=P.name),P.usage!==void 0&&T.setUsage(P.usage),P.updateRange!==void 0&&(T.updateRange.offset=P.updateRange.offset,T.updateRange.count=P.updateRange.count),y.setAttribute(C,T)}let _=r.data.morphAttributes;if(_)for(let C in _){let P=_[C],T=[];for(let M=0,O=P.length;M<O;M++){let I=P[M],D;if(I.isInterleavedBufferAttribute){let z=o(r.data,I.data);D=new Tc(z,I.itemSize,I.offset,I.normalized)}else{let z=Fg(I.type,I.array);D=new Ge(z,I.itemSize,I.normalized)}I.name!==void 0&&(D.name=I.name),T.push(D)}y.morphAttributes[C]=T}r.data.morphTargetsRelative&&(y.morphTargetsRelative=!0);let S=r.data.groups||r.data.drawcalls||r.data.offsets;if(S!==void 0)for(let C=0,P=S.length;C!==P;++C){let T=S[C];y.addGroup(T.start,T.count,T.materialIndex)}let A=r.data.boundingSphere;if(A!==void 0){let C=new E;A.center!==void 0&&C.fromArray(A.center),y.boundingSphere=new Nr(C,A.radius)}return r.name&&(y.name=r.name),r.userData&&(y.userData=r.userData),y}},tw="\\[\\]\\.:\\/",rw="[^"+tw+"]",u5="[^"+tw.replace("\\.","")+"]";/((?:WC+[\/:])*)/.source.replace("WC",rw);/(WCOD+)?/.source.replace("WCOD",u5);/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",rw);/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",rw);var ce=class{constructor(r){this.value=r}clone(){return new ce(this.value.clone===void 0?this.value:this.value.clone())}},sh=class{constructor(r,a,n=0,o=1/0){this.ray=new Ns(r,a),this.near=n,this.far=o,this.camera=null,this.layers=new Sp,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(r,a){this.ray.set(r,a)}setFromCamera(r,a){a.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(a.matrixWorld),this.ray.direction.set(r.x,r.y,.5).unproject(a).sub(this.ray.origin).normalize(),this.camera=a):a.isOrthographicCamera?(this.ray.origin.set(r.x,r.y,(a.near+a.far)/(a.near-a.far)).unproject(a),this.ray.direction.set(0,0,-1).transformDirection(a.matrixWorld),this.camera=a):console.error("THREE.Raycaster: Unsupported camera type: "+a.type)}intersectObject(r,a=!0,n=[]){return WS(r,this,n,a),n.sort(cP),n}intersectObjects(r,a=!0,n=[]){for(let o=0,f=r.length;o<f;o++)WS(r[o],this,n,a);return n.sort(cP),n}};function cP(r,a){return r.distance-a.distance}function WS(r,a,n,o){if(r.layers.test(a.layers)&&r.raycast(a,n),o===!0){let f=r.children;for(let y=0,x=f.length;y<x;y++)WS(f[y],a,n,!0)}}var uP=new V,gl=class{constructor(r=new V(1/0,1/0),a=new V(-1/0,-1/0)){this.isBox2=!0,this.min=r,this.max=a}set(r,a){return this.min.copy(r),this.max.copy(a),this}setFromPoints(r){this.makeEmpty();for(let a=0,n=r.length;a<n;a++)this.expandByPoint(r[a]);return this}setFromCenterAndSize(r,a){let n=uP.copy(a).multiplyScalar(.5);return this.min.copy(r).sub(n),this.max.copy(r).add(n),this}clone(){return new this.constructor().copy(this)}copy(r){return this.min.copy(r.min),this.max.copy(r.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(r){return this.isEmpty()?r.set(0,0):r.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(r){return this.isEmpty()?r.set(0,0):r.subVectors(this.max,this.min)}expandByPoint(r){return this.min.min(r),this.max.max(r),this}expandByVector(r){return this.min.sub(r),this.max.add(r),this}expandByScalar(r){return this.min.addScalar(-r),this.max.addScalar(r),this}containsPoint(r){return!(r.x<this.min.x||r.x>this.max.x||r.y<this.min.y||r.y>this.max.y)}containsBox(r){return this.min.x<=r.min.x&&r.max.x<=this.max.x&&this.min.y<=r.min.y&&r.max.y<=this.max.y}getParameter(r,a){return a.set((r.x-this.min.x)/(this.max.x-this.min.x),(r.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(r){return!(r.max.x<this.min.x||r.min.x>this.max.x||r.max.y<this.min.y||r.min.y>this.max.y)}clampPoint(r,a){return a.copy(r).clamp(this.min,this.max)}distanceToPoint(r){return uP.copy(r).clamp(this.min,this.max).sub(r).length()}intersect(r){return this.min.max(r.min),this.max.min(r.max),this}union(r){return this.min.min(r.min),this.max.max(r.max),this}translate(r){return this.min.add(r),this.max.add(r),this}equals(r){return r.min.equals(this.min)&&r.max.equals(this.max)}},hP=new E,ly=new E,Pi=class{constructor(r=new E,a=new E){this.start=r,this.end=a}set(r,a){return this.start.copy(r),this.end.copy(a),this}copy(r){return this.start.copy(r.start),this.end.copy(r.end),this}getCenter(r){return r.addVectors(this.start,this.end).multiplyScalar(.5)}delta(r){return r.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(r,a){return this.delta(a).multiplyScalar(r).add(this.start)}closestPointToPointParameter(r,a){hP.subVectors(r,this.start),ly.subVectors(this.end,this.start);let n=ly.dot(ly),o=ly.dot(hP)/n;return a&&(o=pi(o,0,1)),o}closestPointToPoint(r,a,n){let o=this.closestPointToPointParameter(r,a);return this.delta(n).multiplyScalar(o).add(this.start)}applyMatrix4(r){return this.start.applyMatrix4(r),this.end.applyMatrix4(r),this}equals(r){return r.start.equals(this.start)&&r.end.equals(this.end)}clone(){return new this.constructor().copy(this)}},dP=new E,Vy=class extends _t{constructor(r,a){super(),this.light=r,this.matrix=r.matrixWorld,this.matrixAutoUpdate=!1,this.color=a,this.type="SpotLightHelper";let n=new Ce,o=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let y=0,x=1,b=32;y<b;y++,x++){let _=y/b*Math.PI*2,S=x/b*Math.PI*2;o.push(Math.cos(_),Math.sin(_),1,Math.cos(S),Math.sin(S),1)}n.setAttribute("position",new Te(o,3));let f=new as({fog:!1,toneMapped:!1});this.cone=new ul(n,f),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);let r=this.light.distance?this.light.distance:1e3,a=r*Math.tan(this.light.angle);this.cone.scale.set(a,a,r),dP.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(dP),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},Uy=class extends Et{constructor(r,a,n){let o=new Fs(a,4,2),f=new an({wireframe:!0,fog:!1,toneMapped:!1});super(o,f),this.light=r,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},fP=new E,cy=new E,pP=new E,zy=class extends _t{constructor(r,a,n){super(),this.light=r,this.matrix=r.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",a===void 0&&(a=1);let o=new Ce;o.setAttribute("position",new Te([-a,a,0,a,a,0,a,-a,0,-a,-a,0,-a,a,0],3));let f=new as({fog:!1,toneMapped:!1});this.lightPlane=new Mc(o,f),this.add(this.lightPlane),o=new Ce,o.setAttribute("position",new Te([0,0,0,0,0,1],3)),this.targetLine=new Mc(o,f),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),fP.setFromMatrixPosition(this.light.matrixWorld),cy.setFromMatrixPosition(this.light.target.matrixWorld),pP.subVectors(cy,fP),this.lightPlane.lookAt(cy),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(cy),this.targetLine.scale.z=pP.length()}},uy=new E,Kr=new yn,yl=class extends ul{constructor(r){let a=new Ce,n=new as({color:16777215,vertexColors:!0,toneMapped:!1}),o=[],f=[],y={};x("n1","n2"),x("n2","n4"),x("n4","n3"),x("n3","n1"),x("f1","f2"),x("f2","f4"),x("f4","f3"),x("f3","f1"),x("n1","f1"),x("n2","f2"),x("n3","f3"),x("n4","f4"),x("p","n1"),x("p","n2"),x("p","n3"),x("p","n4"),x("u1","u2"),x("u2","u3"),x("u3","u1"),x("c","t"),x("p","c"),x("cn1","cn2"),x("cn3","cn4"),x("cf1","cf2"),x("cf3","cf4");function x(T,M){b(T),b(M)}function b(T){o.push(0,0,0),f.push(0,0,0),y[T]===void 0&&(y[T]=[]),y[T].push(o.length/3-1)}a.setAttribute("position",new Te(o,3)),a.setAttribute("color",new Te(f,3)),super(a,n),this.type="CameraHelper",this.camera=r,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=r.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=y,this.update();let _=new qe(16755200),S=new qe(16711680),A=new qe(43775),C=new qe(16777215),P=new qe(3355443);this.setColors(_,S,A,C,P)}setColors(r,a,n,o,f){let y=this.geometry.getAttribute("color");y.setXYZ(0,r.r,r.g,r.b),y.setXYZ(1,r.r,r.g,r.b),y.setXYZ(2,r.r,r.g,r.b),y.setXYZ(3,r.r,r.g,r.b),y.setXYZ(4,r.r,r.g,r.b),y.setXYZ(5,r.r,r.g,r.b),y.setXYZ(6,r.r,r.g,r.b),y.setXYZ(7,r.r,r.g,r.b),y.setXYZ(8,r.r,r.g,r.b),y.setXYZ(9,r.r,r.g,r.b),y.setXYZ(10,r.r,r.g,r.b),y.setXYZ(11,r.r,r.g,r.b),y.setXYZ(12,r.r,r.g,r.b),y.setXYZ(13,r.r,r.g,r.b),y.setXYZ(14,r.r,r.g,r.b),y.setXYZ(15,r.r,r.g,r.b),y.setXYZ(16,r.r,r.g,r.b),y.setXYZ(17,r.r,r.g,r.b),y.setXYZ(18,r.r,r.g,r.b),y.setXYZ(19,r.r,r.g,r.b),y.setXYZ(20,r.r,r.g,r.b),y.setXYZ(21,r.r,r.g,r.b),y.setXYZ(22,r.r,r.g,r.b),y.setXYZ(23,r.r,r.g,r.b),y.setXYZ(24,a.r,a.g,a.b),y.setXYZ(25,a.r,a.g,a.b),y.setXYZ(26,a.r,a.g,a.b),y.setXYZ(27,a.r,a.g,a.b),y.setXYZ(28,a.r,a.g,a.b),y.setXYZ(29,a.r,a.g,a.b),y.setXYZ(30,a.r,a.g,a.b),y.setXYZ(31,a.r,a.g,a.b),y.setXYZ(32,n.r,n.g,n.b),y.setXYZ(33,n.r,n.g,n.b),y.setXYZ(34,n.r,n.g,n.b),y.setXYZ(35,n.r,n.g,n.b),y.setXYZ(36,n.r,n.g,n.b),y.setXYZ(37,n.r,n.g,n.b),y.setXYZ(38,o.r,o.g,o.b),y.setXYZ(39,o.r,o.g,o.b),y.setXYZ(40,f.r,f.g,f.b),y.setXYZ(41,f.r,f.g,f.b),y.setXYZ(42,f.r,f.g,f.b),y.setXYZ(43,f.r,f.g,f.b),y.setXYZ(44,f.r,f.g,f.b),y.setXYZ(45,f.r,f.g,f.b),y.setXYZ(46,f.r,f.g,f.b),y.setXYZ(47,f.r,f.g,f.b),y.setXYZ(48,f.r,f.g,f.b),y.setXYZ(49,f.r,f.g,f.b),y.needsUpdate=!0}update(){let r=this.geometry,a=this.pointMap,n=1,o=1;Kr.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),ei("c",a,r,Kr,0,0,-1),ei("t",a,r,Kr,0,0,1),ei("n1",a,r,Kr,-1,-1,-1),ei("n2",a,r,Kr,n,-1,-1),ei("n3",a,r,Kr,-1,o,-1),ei("n4",a,r,Kr,n,o,-1),ei("f1",a,r,Kr,-1,-1,1),ei("f2",a,r,Kr,n,-1,1),ei("f3",a,r,Kr,-1,o,1),ei("f4",a,r,Kr,n,o,1),ei("u1",a,r,Kr,n*.7,o*1.1,-1),ei("u2",a,r,Kr,-1*.7,o*1.1,-1),ei("u3",a,r,Kr,0,o*2,-1),ei("cf1",a,r,Kr,-1,0,1),ei("cf2",a,r,Kr,n,0,1),ei("cf3",a,r,Kr,0,-1,1),ei("cf4",a,r,Kr,0,o,1),ei("cn1",a,r,Kr,-1,0,-1),ei("cn2",a,r,Kr,n,0,-1),ei("cn3",a,r,Kr,0,-1,-1),ei("cn4",a,r,Kr,0,o,-1),r.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function ei(r,a,n,o,f,y,x){uy.set(f,y,x).unproject(o);let b=a[r];if(b!==void 0){let _=n.getAttribute("position");for(let S=0,A=b.length;S<A;S++)_.setXYZ(b[S],uy.x,uy.y,uy.z)}}var vl=class extends ul{constructor(r,a=16776960){let n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),o=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],f=new Ce;f.setIndex(new Ge(n,1)),f.setAttribute("position",new Te(o,3)),super(f,new as({color:a,toneMapped:!1})),this.box=r,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(r){let a=this.box;a.isEmpty()||(a.getCenter(this.position),a.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(r))}dispose(){this.geometry.dispose(),this.material.dispose()}},ky=class extends ul{constructor(r=1){let a=[0,0,0,r,0,0,0,0,0,0,r,0,0,0,0,0,0,r],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],o=new Ce;o.setAttribute("position",new Te(a,3)),o.setAttribute("color",new Te(n,3));let f=new as({vertexColors:!0,toneMapped:!1});super(o,f),this.type="AxesHelper"}setColors(r,a,n){let o=new qe,f=this.geometry.attributes.color.array;return o.set(r),o.toArray(f,0),o.toArray(f,3),o.set(a),o.toArray(f,6),o.toArray(f,9),o.set(n),o.toArray(f,12),o.toArray(f,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}};v5();function v5(){let r=new ArrayBuffer(4),a=new Float32Array(r),n=new Uint32Array(r),o=new Uint32Array(512),f=new Uint32Array(512);for(let _=0;_<256;++_){let S=_-127;S<-27?(o[_]=0,o[_|256]=32768,f[_]=24,f[_|256]=24):S<-14?(o[_]=1024>>-S-14,o[_|256]=1024>>-S-14|32768,f[_]=-S-1,f[_|256]=-S-1):S<=15?(o[_]=S+15<<10,o[_|256]=S+15<<10|32768,f[_]=13,f[_|256]=13):S<128?(o[_]=31744,o[_|256]=64512,f[_]=24,f[_|256]=24):(o[_]=31744,o[_|256]=64512,f[_]=13,f[_|256]=13)}let y=new Uint32Array(2048),x=new Uint32Array(64),b=new Uint32Array(64);for(let _=1;_<1024;++_){let S=_<<13,A=0;for(;(S&8388608)===0;)S<<=1,A-=8388608;S&=-8388609,A+=947912704,y[_]=S|A}for(let _=1024;_<2048;++_)y[_]=939524096+(_-1024<<13);for(let _=1;_<31;++_)x[_]=_<<23;x[31]=1199570944,x[32]=2147483648;for(let _=33;_<63;++_)x[_]=2147483648+(_-32<<23);x[63]=3347054592;for(let _=1;_<64;++_)_!==32&&(b[_]=1024);return{floatView:a,uint32View:n,baseTable:o,shiftTable:f,mantissaTable:y,exponentTable:x,offsetTable:b}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:pa}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=pa);function hh(){return!0}function xl(r,a){return r.length!==a.length||r.some((n,o)=>a[o]!==n)}var qy=new Set(["hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),w5=new Set(["concat","includes","indexOf","join","keys","lastIndexOf"]),ow={push:hh,pop:hh,shift:hh,unshift:hh,copyWithin:xl,reverse:xl,sort:xl,splice:xl,flat:xl,fill:xl};[...qy,...w5,...Object.keys(ow)];function dh(r,a){if(r.size!==a.size)return!0;for(let n of r)if(!a.has(n))return!0;return!1}var aw=["keys","values","entries"],lw=new Set(["has","toString"]),cw={add:dh,clear:dh,delete:dh,forEach:dh};[...lw,...Object.keys(cw),...aw];function fh(r,a){if(r.size!==a.size)return!0;let n;for(let[o,f]of r)if(n=a.get(o),n!==f||n===void 0&&!a.has(o))return!0;return!1}var A5=new Set([...lw,"get"]),uw={set:fh,clear:fh,delete:fh,forEach:fh};[...A5,...Object.keys(uw),...aw];var T5=typeof global=="object"&&global&&global.Object===Object&&global,Xy=T5,M5=typeof self=="object"&&self&&self.Object===Object&&self,C5=Xy||M5||Function("return this")(),Qr=C5,P5=Qr.Symbol,Ui=P5,zP=Object.prototype,_5=zP.hasOwnProperty,I5=zP.toString,Gp=Ui?Ui.toStringTag:void 0;function D5(r){var a=_5.call(r,Gp),n=r[Gp];try{r[Gp]=void 0;var o=!0}catch{}var f=I5.call(r);return o&&(a?r[Gp]=n:delete r[Gp]),f}var kP=D5,O5=Object.prototype,R5=O5.toString;function L5(r){return R5.call(r)}var GP=L5,B5="[object Null]",N5="[object Undefined]",jP=Ui?Ui.toStringTag:void 0;function F5(r){return r==null?r===void 0?N5:B5:jP&&jP in Object(r)?kP(r):GP(r)}var Zn=F5;function V5(r){return r!=null&&typeof r=="object"}var qi=V5,U5="[object Symbol]";function z5(r){return typeof r=="symbol"||qi(r)&&Zn(r)==U5}var yo=z5;function k5(r,a){for(var n=-1,o=r==null?0:r.length,f=Array(o);++n<o;)f[n]=a(r[n],n,r);return f}var Yy=k5,G5=Array.isArray,_i$1=G5,HP=Ui?Ui.prototype:void 0,WP=HP?HP.toString:void 0;function qP(r){if(typeof r=="string")return r;if(_i$1(r))return Yy(r,qP)+"";if(yo(r))return WP?WP.call(r):"";var a=r+"";return a=="0"&&1/r==-1/0?"-0":a}var XP=qP,H5=/\s/;function W5(r){for(var a=r.length;a--&&H5.test(r.charAt(a)););return a}var YP=W5,q5=/^\s+/;function X5(r){return r&&r.slice(0,YP(r)+1).replace(q5,"")}var KP=X5;function Y5(r){var a=typeof r;return r!=null&&(a=="object"||a=="function")}var xi=Y5,QP=NaN,K5=/^[-+]0x[0-9a-f]+$/i,Q5=/^0b[01]+$/i,Z5=/^0o[0-7]+$/i,J5=parseInt;function $5(r){if(typeof r=="number")return r;if(yo(r))return QP;if(xi(r)){var a=typeof r.valueOf=="function"?r.valueOf():r;r=xi(a)?a+"":a}if(typeof r!="string")return r===0?r:+r;r=KP(r);var n=Q5.test(r);return n||Z5.test(r)?J5(r.slice(2),n?2:8):K5.test(r)?QP:+r}var fw=$5;function ej(r){return r}var Ky=ej,tj="[object AsyncFunction]",rj="[object Function]",ij="[object GeneratorFunction]",nj="[object Proxy]";function sj(r){if(!xi(r))return!1;var a=Zn(r);return a==rj||a==ij||a==tj||a==nj}var Qy=sj,oj=Qr["__core-js_shared__"],Zy=oj,ZP=function(){var r=/[^.]+$/.exec(Zy&&Zy.keys&&Zy.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function aj(r){return!!ZP&&ZP in r}var JP=aj,lj=Function.prototype,cj=lj.toString;function uj(r){if(r!=null){try{return cj.call(r)}catch{}try{return r+""}catch{}}return""}var ma=uj,hj=/[\\^$.*+?()[\]{}|]/g,dj=/^\[object .+?Constructor\]$/,fj=Function.prototype,pj=Object.prototype,mj=fj.toString,gj=pj.hasOwnProperty,yj=RegExp("^"+mj.call(gj).replace(hj,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function vj(r){if(!xi(r)||JP(r))return!1;var a=Qy(r)?yj:dj;return a.test(ma(r))}var $P=vj;function xj(r,a){return r==null?void 0:r[a]}var e_=xj;function bj(r,a){var n=e_(r,a);return $P(n)?n:void 0}var _n=bj,Sj=_n(Qr,"WeakMap"),Jy=Sj,t_=Object.create,wj=function(){function r(){}return function(a){if(!xi(a))return{};if(t_)return t_(a);r.prototype=a;var n=new r;return r.prototype=void 0,n}}(),r_=wj;function Aj(r,a,n){switch(n.length){case 0:return r.call(a);case 1:return r.call(a,n[0]);case 2:return r.call(a,n[0],n[1]);case 3:return r.call(a,n[0],n[1],n[2])}return r.apply(a,n)}var i_=Aj;function Ej(r,a){var n=-1,o=r.length;for(a||(a=Array(o));++n<o;)a[n]=r[n];return a}var n_=Ej,Tj=800,Mj=16,Cj=Date.now;function Pj(r){var a=0,n=0;return function(){var o=Cj(),f=Mj-(o-n);if(n=o,f>0){if(++a>=Tj)return arguments[0]}else a=0;return r.apply(void 0,arguments)}}var s_=Pj;function _j(r){return function(){return r}}var o_=_j,Ij=function(){try{var r=_n(Object,"defineProperty");return r({},"",{}),r}catch{}}(),yh=Ij,Dj=yh?function(r,a){return yh(r,"toString",{configurable:!0,enumerable:!1,value:o_(a),writable:!0})}:Ky,a_=Dj,Oj=s_(a_),l_=Oj;function Rj(r,a){for(var n=-1,o=r==null?0:r.length;++n<o&&a(r[n],n,r)!==!1;);return r}var c_=Rj,Lj=9007199254740991,Bj=/^(?:0|[1-9]\d*)$/;function Nj(r,a){var n=typeof r;return a=a??Lj,!!a&&(n=="number"||n!="symbol"&&Bj.test(r))&&r>-1&&r%1==0&&r<a}var vh=Nj;function Fj(r,a,n){a=="__proto__"&&yh?yh(r,a,{configurable:!0,enumerable:!0,value:n,writable:!0}):r[a]=n}var $y=Fj;function Vj(r,a){return r===a||r!==r&&a!==a}var xh=Vj,Uj=Object.prototype,zj=Uj.hasOwnProperty;function kj(r,a,n){var o=r[a];(!(zj.call(r,a)&&xh(o,n))||n===void 0&&!(a in r))&&$y(r,a,n)}var bh=kj;function Gj(r,a,n,o){var f=!n;n||(n={});for(var y=-1,x=a.length;++y<x;){var b=a[y],_=o?o(n[b],r[b],b,n,r):void 0;_===void 0&&(_=r[b]),f?$y(n,b,_):bh(n,b,_)}return n}var vo=Gj,u_=Math.max;function jj(r,a,n){return a=u_(a===void 0?r.length-1:a,0),function(){for(var o=arguments,f=-1,y=u_(o.length-a,0),x=Array(y);++f<y;)x[f]=o[a+f];f=-1;for(var b=Array(a+1);++f<a;)b[f]=o[f];return b[a]=n(x),i_(r,this,b)}}var h_=jj,Hj=9007199254740991;function Wj(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=Hj}var Sh=Wj;function qj(r){return r!=null&&Sh(r.length)&&!Qy(r)}var ev=qj,Xj=Object.prototype;function Yj(r){var a=r&&r.constructor,n=typeof a=="function"&&a.prototype||Xj;return r===n}var wh=Yj;function Kj(r,a){for(var n=-1,o=Array(r);++n<r;)o[n]=a(n);return o}var d_=Kj,Qj="[object Arguments]";function Zj(r){return qi(r)&&Zn(r)==Qj}var pw=Zj,f_=Object.prototype,Jj=f_.hasOwnProperty,$j=f_.propertyIsEnumerable,eH=pw(function(){return arguments}())?pw:function(r){return qi(r)&&Jj.call(r,"callee")&&!$j.call(r,"callee")},Ah=eH;function tH(){return!1}var p_=tH,y_=typeof exports=="object"&&exports&&!exports.nodeType&&exports,m_=y_&&typeof module=="object"&&module&&!module.nodeType&&module,rH=m_&&m_.exports===y_,g_=rH?Qr.Buffer:void 0,iH=g_?g_.isBuffer:void 0,nH=iH||p_,Lc=nH,sH="[object Arguments]",oH="[object Array]",aH="[object Boolean]",lH="[object Date]",cH="[object Error]",uH="[object Function]",hH="[object Map]",dH="[object Number]",fH="[object Object]",pH="[object RegExp]",mH="[object Set]",gH="[object String]",yH="[object WeakMap]",vH="[object ArrayBuffer]",xH="[object DataView]",bH="[object Float32Array]",SH="[object Float64Array]",wH="[object Int8Array]",AH="[object Int16Array]",EH="[object Int32Array]",TH="[object Uint8Array]",MH="[object Uint8ClampedArray]",CH="[object Uint16Array]",PH="[object Uint32Array]",Rr={};Rr[bH]=Rr[SH]=Rr[wH]=Rr[AH]=Rr[EH]=Rr[TH]=Rr[MH]=Rr[CH]=Rr[PH]=!0;Rr[sH]=Rr[oH]=Rr[vH]=Rr[aH]=Rr[xH]=Rr[lH]=Rr[cH]=Rr[uH]=Rr[hH]=Rr[dH]=Rr[fH]=Rr[pH]=Rr[mH]=Rr[gH]=Rr[yH]=!1;function _H(r){return qi(r)&&Sh(r.length)&&!!Rr[Zn(r)]}var v_=_H;function IH(r){return function(a){return r(a)}}var Eh=IH,x_=typeof exports=="object"&&exports&&!exports.nodeType&&exports,jp=x_&&typeof module=="object"&&module&&!module.nodeType&&module,DH=jp&&jp.exports===x_,mw=DH&&Xy.process,OH=function(){try{var r=jp&&jp.require&&jp.require("util").types;return r||mw&&mw.binding&&mw.binding("util")}catch{}}(),ga=OH,b_=ga&&ga.isTypedArray,RH=b_?Eh(b_):v_,tv=RH,LH=Object.prototype,BH=LH.hasOwnProperty;function NH(r,a){var n=_i$1(r),o=!n&&Ah(r),f=!n&&!o&&Lc(r),y=!n&&!o&&!f&&tv(r),x=n||o||f||y,b=x?d_(r.length,String):[],_=b.length;for(var S in r)(a||BH.call(r,S))&&!(x&&(S=="length"||f&&(S=="offset"||S=="parent")||y&&(S=="buffer"||S=="byteLength"||S=="byteOffset")||vh(S,_)))&&b.push(S);return b}var rv=NH;function FH(r,a){return function(n){return r(a(n))}}var iv=FH,VH=iv(Object.keys,Object),S_=VH,UH=Object.prototype,zH=UH.hasOwnProperty;function kH(r){if(!wh(r))return S_(r);var a=[];for(var n in Object(r))zH.call(r,n)&&n!="constructor"&&a.push(n);return a}var w_=kH;function GH(r){return ev(r)?rv(r):w_(r)}var Th=GH;function jH(r){var a=[];if(r!=null)for(var n in Object(r))a.push(n);return a}var A_=jH,HH=Object.prototype,WH=HH.hasOwnProperty;function qH(r){if(!xi(r))return A_(r);var a=wh(r),n=[];for(var o in r)o=="constructor"&&(a||!WH.call(r,o))||n.push(o);return n}var E_=qH;function XH(r){return ev(r)?rv(r,!0):E_(r)}var us=XH,YH=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,KH=/^\w*$/;function QH(r,a){if(_i$1(r))return!1;var n=typeof r;return n=="number"||n=="symbol"||n=="boolean"||r==null||yo(r)?!0:KH.test(r)||!YH.test(r)||a!=null&&r in Object(a)}var T_=QH,ZH=_n(Object,"create"),ya=ZH;function JH(){this.__data__=ya?ya(null):{},this.size=0}var M_=JH;function $H(r){var a=this.has(r)&&delete this.__data__[r];return this.size-=a?1:0,a}var C_=$H,eW="__lodash_hash_undefined__",tW=Object.prototype,rW=tW.hasOwnProperty;function iW(r){var a=this.__data__;if(ya){var n=a[r];return n===eW?void 0:n}return rW.call(a,r)?a[r]:void 0}var P_=iW,nW=Object.prototype,sW=nW.hasOwnProperty;function oW(r){var a=this.__data__;return ya?a[r]!==void 0:sW.call(a,r)}var __=oW,aW="__lodash_hash_undefined__";function lW(r,a){var n=this.__data__;return this.size+=this.has(r)?0:1,n[r]=ya&&a===void 0?aW:a,this}var I_=lW;function Mh(r){var a=-1,n=r==null?0:r.length;for(this.clear();++a<n;){var o=r[a];this.set(o[0],o[1])}}Mh.prototype.clear=M_;Mh.prototype.delete=C_;Mh.prototype.get=P_;Mh.prototype.has=__;Mh.prototype.set=I_;var gw=Mh;function cW(){this.__data__=[],this.size=0}var D_=cW;function uW(r,a){for(var n=r.length;n--;)if(xh(r[n][0],a))return n;return-1}var bl=uW,hW=Array.prototype,dW=hW.splice;function fW(r){var a=this.__data__,n=bl(a,r);if(n<0)return!1;var o=a.length-1;return n==o?a.pop():dW.call(a,n,1),--this.size,!0}var O_=fW;function pW(r){var a=this.__data__,n=bl(a,r);return n<0?void 0:a[n][1]}var R_=pW;function mW(r){return bl(this.__data__,r)>-1}var L_=mW;function gW(r,a){var n=this.__data__,o=bl(n,r);return o<0?(++this.size,n.push([r,a])):n[o][1]=a,this}var B_=gW;function Ch(r){var a=-1,n=r==null?0:r.length;for(this.clear();++a<n;){var o=r[a];this.set(o[0],o[1])}}Ch.prototype.clear=D_;Ch.prototype.delete=O_;Ch.prototype.get=R_;Ch.prototype.has=L_;Ch.prototype.set=B_;var Sl=Ch,yW=_n(Qr,"Map"),wl=yW;function vW(){this.size=0,this.__data__={hash:new gw,map:new(wl||Sl),string:new gw}}var N_=vW;function xW(r){var a=typeof r;return a=="string"||a=="number"||a=="symbol"||a=="boolean"?r!=="__proto__":r===null}var F_=xW;function bW(r,a){var n=r.__data__;return F_(a)?n[typeof a=="string"?"string":"hash"]:n.map}var Al=bW;function SW(r){var a=Al(this,r).delete(r);return this.size-=a?1:0,a}var V_=SW;function wW(r){return Al(this,r).get(r)}var U_=wW;function AW(r){return Al(this,r).has(r)}var z_=AW;function EW(r,a){var n=Al(this,r),o=n.size;return n.set(r,a),this.size+=n.size==o?0:1,this}var k_=EW;function Ph(r){var a=-1,n=r==null?0:r.length;for(this.clear();++a<n;){var o=r[a];this.set(o[0],o[1])}}Ph.prototype.clear=N_;Ph.prototype.delete=V_;Ph.prototype.get=U_;Ph.prototype.has=z_;Ph.prototype.set=k_;var Bc=Ph,TW="Expected a function";function yw(r,a){if(typeof r!="function"||a!=null&&typeof a!="function")throw new TypeError(TW);var n=function(){var o=arguments,f=a?a.apply(this,o):o[0],y=n.cache;if(y.has(f))return y.get(f);var x=r.apply(this,o);return n.cache=y.set(f,x)||y,x};return n.cache=new(yw.Cache||Bc),n}yw.Cache=Bc;var G_=yw,MW=500;function CW(r){var a=G_(r,function(o){return n.size===MW&&n.clear(),o}),n=a.cache;return a}var j_=CW,PW=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,_W=/\\(\\)?/g,IW=j_(function(r){var a=[];return r.charCodeAt(0)===46&&a.push(""),r.replace(PW,function(n,o,f,y){a.push(f?y.replace(_W,"$1"):o||n)}),a}),H_=IW;function DW(r){return r==null?"":XP(r)}var W_=DW;function OW(r,a){return _i$1(r)?r:T_(r,a)?[r]:H_(W_(r))}var hs=OW;function LW(r){if(typeof r=="string"||yo(r))return r;var a=r+"";return a=="0"&&1/r==-1/0?"-0":a}var El=LW;function BW(r,a){a=hs(a,r);for(var n=0,o=a.length;r!=null&&n<o;)r=r[El(a[n++])];return n&&n==o?r:void 0}var nv=BW;function NW(r,a){for(var n=-1,o=a.length,f=r.length;++n<o;)r[f+n]=a[n];return r}var _h=NW,q_=Ui?Ui.isConcatSpreadable:void 0;function FW(r){return _i$1(r)||Ah(r)||!!(q_&&r&&r[q_])}var X_=FW;function Y_(r,a,n,o,f){var y=-1,x=r.length;for(n||(n=X_),f||(f=[]);++y<x;){var b=r[y];a>0&&n(b)?a>1?Y_(b,a-1,n,o,f):_h(f,b):o||(f[f.length]=b)}return f}var K_=Y_;function VW(r){var a=r==null?0:r.length;return a?K_(r,1):[]}var Q_=VW;function UW(r){return l_(h_(r,void 0,Q_),r+"")}var sv=UW,zW=iv(Object.getPrototypeOf,Object),Ih=zW,kW="[object Object]",GW=Function.prototype,jW=Object.prototype,Z_=GW.toString,HW=jW.hasOwnProperty,WW=Z_.call(Object);function qW(r){if(!qi(r)||Zn(r)!=kW)return!1;var a=Ih(r);if(a===null)return!0;var n=HW.call(a,"constructor")&&a.constructor;return typeof n=="function"&&n instanceof n&&Z_.call(n)==WW}var J_=qW;function XW(r,a,n){var o=-1,f=r.length;a<0&&(a=-a>f?0:f+a),n=n>f?f:n,n<0&&(n+=f),f=a>n?0:n-a>>>0,a>>>=0;for(var y=Array(f);++o<f;)y[o]=r[o+a];return y}var $_=XW;function YW(){this.__data__=new Sl,this.size=0}var e2=YW;function KW(r){var a=this.__data__,n=a.delete(r);return this.size=a.size,n}var t2=KW;function QW(r){return this.__data__.get(r)}var r2=QW;function ZW(r){return this.__data__.has(r)}var i2=ZW,JW=200;function $W(r,a){var n=this.__data__;if(n instanceof Sl){var o=n.__data__;if(!wl||o.length<JW-1)return o.push([r,a]),this.size=++n.size,this;n=this.__data__=new Bc(o)}return n.set(r,a),this.size=n.size,this}var n2=$W;function Dh(r){var a=this.__data__=new Sl(r);this.size=a.size}Dh.prototype.clear=e2;Dh.prototype.delete=t2;Dh.prototype.get=r2;Dh.prototype.has=i2;Dh.prototype.set=n2;var Oh=Dh;function e6(r,a){return r&&vo(a,Th(a),r)}var s2=e6;function t6(r,a){return r&&vo(a,us(a),r)}var o2=t6,u2=typeof exports=="object"&&exports&&!exports.nodeType&&exports,a2=u2&&typeof module=="object"&&module&&!module.nodeType&&module,r6=a2&&a2.exports===u2,l2=r6?Qr.Buffer:void 0,c2=l2?l2.allocUnsafe:void 0;function i6(r,a){if(a)return r.slice();var n=r.length,o=c2?c2(n):new r.constructor(n);return r.copy(o),o}var h2=i6;function n6(r,a){for(var n=-1,o=r==null?0:r.length,f=0,y=[];++n<o;){var x=r[n];a(x,n,r)&&(y[f++]=x)}return y}var d2=n6;function s6(){return[]}var ov=s6,o6=Object.prototype,a6=o6.propertyIsEnumerable,f2=Object.getOwnPropertySymbols,l6=f2?function(r){return r==null?[]:(r=Object(r),d2(f2(r),function(a){return a6.call(r,a)}))}:ov,Rh=l6;function c6(r,a){return vo(r,Rh(r),a)}var p2=c6,u6=Object.getOwnPropertySymbols,h6=u6?function(r){for(var a=[];r;)_h(a,Rh(r)),r=Ih(r);return a}:ov,av=h6;function d6(r,a){return vo(r,av(r),a)}var m2=d6;function f6(r,a,n){var o=a(r);return _i$1(r)?o:_h(o,n(r))}var lv=f6;function p6(r){return lv(r,Th,Rh)}var Hp=p6;function m6(r){return lv(r,us,av)}var cv=m6,g6=_n(Qr,"DataView"),uv=g6,y6=_n(Qr,"Promise"),hv=y6,v6=_n(Qr,"Set"),dv=v6,g2="[object Map]",x6="[object Object]",y2="[object Promise]",v2="[object Set]",x2="[object WeakMap]",b2="[object DataView]",b6=ma(uv),S6=ma(wl),w6=ma(hv),A6=ma(dv),E6=ma(Jy),Nc=Zn;(uv&&Nc(new uv(new ArrayBuffer(1)))!=b2||wl&&Nc(new wl)!=g2||hv&&Nc(hv.resolve())!=y2||dv&&Nc(new dv)!=v2||Jy&&Nc(new Jy)!=x2)&&(Nc=function(r){var a=Zn(r),n=a==x6?r.constructor:void 0,o=n?ma(n):"";if(o)switch(o){case b6:return b2;case S6:return g2;case w6:return y2;case A6:return v2;case E6:return x2}return a});var va=Nc,T6=Object.prototype,M6=T6.hasOwnProperty;function C6(r){var a=r.length,n=new r.constructor(a);return a&&typeof r[0]=="string"&&M6.call(r,"index")&&(n.index=r.index,n.input=r.input),n}var S2=C6,P6=Qr.Uint8Array,Lh=P6;function _6(r){var a=new r.constructor(r.byteLength);return new Lh(a).set(new Lh(r)),a}var Bh=_6;function I6(r,a){var n=a?Bh(r.buffer):r.buffer;return new r.constructor(n,r.byteOffset,r.byteLength)}var w2=I6,D6=/\w*$/;function O6(r){var a=new r.constructor(r.source,D6.exec(r));return a.lastIndex=r.lastIndex,a}var A2=O6,E2=Ui?Ui.prototype:void 0,T2=E2?E2.valueOf:void 0;function R6(r){return T2?Object(T2.call(r)):{}}var M2=R6;function L6(r,a){var n=a?Bh(r.buffer):r.buffer;return new r.constructor(n,r.byteOffset,r.length)}var C2=L6,B6="[object Boolean]",N6="[object Date]",F6="[object Map]",V6="[object Number]",U6="[object RegExp]",z6="[object Set]",k6="[object String]",G6="[object Symbol]",j6="[object ArrayBuffer]",H6="[object DataView]",W6="[object Float32Array]",q6="[object Float64Array]",X6="[object Int8Array]",Y6="[object Int16Array]",K6="[object Int32Array]",Q6="[object Uint8Array]",Z6="[object Uint8ClampedArray]",J6="[object Uint16Array]",$6="[object Uint32Array]";function e8(r,a,n){var o=r.constructor;switch(a){case j6:return Bh(r);case B6:case N6:return new o(+r);case H6:return w2(r,n);case W6:case q6:case X6:case Y6:case K6:case Q6:case Z6:case J6:case $6:return C2(r,n);case F6:return new o;case V6:case k6:return new o(r);case U6:return A2(r);case z6:return new o;case G6:return M2(r)}}var P2=e8;function t8(r){return typeof r.constructor=="function"&&!wh(r)?r_(Ih(r)):{}}var _2=t8,r8="[object Map]";function i8(r){return qi(r)&&va(r)==r8}var I2=i8,D2=ga&&ga.isMap,n8=D2?Eh(D2):I2,O2=n8,s8="[object Set]";function o8(r){return qi(r)&&va(r)==s8}var R2=o8,L2=ga&&ga.isSet,a8=L2?Eh(L2):R2,B2=a8,l8=1,c8=2,u8=4,N2="[object Arguments]",h8="[object Array]",d8="[object Boolean]",f8="[object Date]",p8="[object Error]",F2="[object Function]",m8="[object GeneratorFunction]",g8="[object Map]",y8="[object Number]",V2="[object Object]",v8="[object RegExp]",x8="[object Set]",b8="[object String]",S8="[object Symbol]",w8="[object WeakMap]",A8="[object ArrayBuffer]",E8="[object DataView]",T8="[object Float32Array]",M8="[object Float64Array]",C8="[object Int8Array]",P8="[object Int16Array]",_8="[object Int32Array]",I8="[object Uint8Array]",D8="[object Uint8ClampedArray]",O8="[object Uint16Array]",R8="[object Uint32Array]",Ir={};Ir[N2]=Ir[h8]=Ir[A8]=Ir[E8]=Ir[d8]=Ir[f8]=Ir[T8]=Ir[M8]=Ir[C8]=Ir[P8]=Ir[_8]=Ir[g8]=Ir[y8]=Ir[V2]=Ir[v8]=Ir[x8]=Ir[b8]=Ir[S8]=Ir[I8]=Ir[D8]=Ir[O8]=Ir[R8]=!0;Ir[p8]=Ir[F2]=Ir[w8]=!1;function fv(r,a,n,o,f,y){var x,b=a&l8,_=a&c8,S=a&u8;if(n&&(x=f?n(r,o,f,y):n(r)),x!==void 0)return x;if(!xi(r))return r;var A=_i$1(r);if(A){if(x=S2(r),!b)return n_(r,x)}else{var C=va(r),P=C==F2||C==m8;if(Lc(r))return h2(r,b);if(C==V2||C==N2||P&&!f){if(x=_||P?{}:_2(r),!b)return _?m2(r,o2(x,r)):p2(r,s2(x,r))}else{if(!Ir[C])return f?r:{};x=P2(r,C,b)}}y||(y=new Oh);var T=y.get(r);if(T)return T;y.set(r,x),B2(r)?r.forEach(function(I){x.add(fv(I,a,n,I,r,y))}):O2(r)&&r.forEach(function(I,D){x.set(D,fv(I,a,n,D,r,y))});var M=S?_?cv:Hp:_?us:Th,O=A?void 0:M(r);return c_(O||r,function(I,D){O&&(D=I,I=r[D]),bh(x,D,fv(I,a,n,D,r,y))}),x}var pv=fv,L8=1,B8=4;function N8(r){return pv(r,L8|B8)}var xa=N8,F8="__lodash_hash_undefined__";function V8(r){return this.__data__.set(r,F8),this}var U2=V8;function U8(r){return this.__data__.has(r)}var z2=U8;function mv(r){var a=-1,n=r==null?0:r.length;for(this.__data__=new Bc;++a<n;)this.add(r[a])}mv.prototype.add=mv.prototype.push=U2;mv.prototype.has=z2;var k2=mv;function z8(r,a){for(var n=-1,o=r==null?0:r.length;++n<o;)if(a(r[n],n,r))return!0;return!1}var G2=z8;function k8(r,a){return r.has(a)}var j2=k8,G8=1,j8=2;function H8(r,a,n,o,f,y){var x=n&G8,b=r.length,_=a.length;if(b!=_&&!(x&&_>b))return!1;var S=y.get(r),A=y.get(a);if(S&&A)return S==a&&A==r;var C=-1,P=!0,T=n&j8?new k2:void 0;for(y.set(r,a),y.set(a,r);++C<b;){var M=r[C],O=a[C];if(o)var I=x?o(O,M,C,a,r,y):o(M,O,C,r,a,y);if(I!==void 0){if(I)continue;P=!1;break}if(T){if(!G2(a,function(D,z){if(!j2(T,z)&&(M===D||f(M,D,n,o,y)))return T.push(z)})){P=!1;break}}else if(!(M===O||f(M,O,n,o,y))){P=!1;break}}return y.delete(r),y.delete(a),P}var gv=H8;function W8(r){var a=-1,n=Array(r.size);return r.forEach(function(o,f){n[++a]=[f,o]}),n}var H2=W8;function q8(r){var a=-1,n=Array(r.size);return r.forEach(function(o){n[++a]=o}),n}var W2=q8,X8=1,Y8=2,K8="[object Boolean]",Q8="[object Date]",Z8="[object Error]",J8="[object Map]",$8="[object Number]",e9="[object RegExp]",t9="[object Set]",r9="[object String]",i9="[object Symbol]",n9="[object ArrayBuffer]",s9="[object DataView]",q2=Ui?Ui.prototype:void 0,vw=q2?q2.valueOf:void 0;function o9(r,a,n,o,f,y,x){switch(n){case s9:if(r.byteLength!=a.byteLength||r.byteOffset!=a.byteOffset)return!1;r=r.buffer,a=a.buffer;case n9:return!(r.byteLength!=a.byteLength||!y(new Lh(r),new Lh(a)));case K8:case Q8:case $8:return xh(+r,+a);case Z8:return r.name==a.name&&r.message==a.message;case e9:case r9:return r==a+"";case J8:var b=H2;case t9:var _=o&X8;if(b||(b=W2),r.size!=a.size&&!_)return!1;var S=x.get(r);if(S)return S==a;o|=Y8,x.set(r,a);var A=gv(b(r),b(a),o,f,y,x);return x.delete(r),A;case i9:if(vw)return vw.call(r)==vw.call(a)}return!1}var X2=o9,a9=1,l9=Object.prototype,c9=l9.hasOwnProperty;function u9(r,a,n,o,f,y){var x=n&a9,b=Hp(r),_=b.length,S=Hp(a),A=S.length;if(_!=A&&!x)return!1;for(var C=_;C--;){var P=b[C];if(!(x?P in a:c9.call(a,P)))return!1}var T=y.get(r),M=y.get(a);if(T&&M)return T==a&&M==r;var O=!0;y.set(r,a),y.set(a,r);for(var I=x;++C<_;){P=b[C];var D=r[P],z=a[P];if(o)var k=x?o(z,D,P,a,r,y):o(D,z,P,r,a,y);if(!(k===void 0?D===z||f(D,z,n,o,y):k)){O=!1;break}I||(I=P=="constructor")}if(O&&!I){var L=r.constructor,R=a.constructor;L!=R&&"constructor"in r&&"constructor"in a&&!(typeof L=="function"&&L instanceof L&&typeof R=="function"&&R instanceof R)&&(O=!1)}return y.delete(r),y.delete(a),O}var Y2=u9,h9=1,K2="[object Arguments]",Q2="[object Array]",yv="[object Object]",d9=Object.prototype,Z2=d9.hasOwnProperty;function f9(r,a,n,o,f,y){var x=_i$1(r),b=_i$1(a),_=x?Q2:va(r),S=b?Q2:va(a);_=_==K2?yv:_,S=S==K2?yv:S;var A=_==yv,C=S==yv,P=_==S;if(P&&Lc(r)){if(!Lc(a))return!1;x=!0,A=!1}if(P&&!A)return y||(y=new Oh),x||tv(r)?gv(r,a,n,o,f,y):X2(r,a,_,n,o,f,y);if(!(n&h9)){var T=A&&Z2.call(r,"__wrapped__"),M=C&&Z2.call(a,"__wrapped__");if(T||M){var O=T?r.value():r,I=M?a.value():a;return y||(y=new Oh),f(O,I,n,o,y)}}return P?(y||(y=new Oh),Y2(r,a,n,o,f,y)):!1}var J2=f9;function $2(r,a,n,o,f){return r===a?!0:r==null||a==null||!qi(r)&&!qi(a)?r!==r&&a!==a:J2(r,a,n,o,$2,f)}var eI=$2;function p9(r,a){return r!=null&&a in Object(r)}var tI=p9;function m9(r,a,n){a=hs(a,r);for(var o=-1,f=a.length,y=!1;++o<f;){var x=El(a[o]);if(!(y=r!=null&&n(r,x)))break;r=r[x]}return y||++o!=f?y:(f=r==null?0:r.length,!!f&&Sh(f)&&vh(x,f)&&(_i$1(r)||Ah(r)))}var rI=m9;function g9(r,a){return r!=null&&rI(r,a,tI)}var iI=g9,y9=function(){return Qr.Date.now()},vv=y9,v9="Expected a function",x9=Math.max,b9=Math.min;function S9(r,a,n){var o,f,y,x,b,_,S=0,A=!1,C=!1,P=!0;if(typeof r!="function")throw new TypeError(v9);a=fw(a)||0,xi(n)&&(A=!!n.leading,C="maxWait"in n,y=C?x9(fw(n.maxWait)||0,a):y,P="trailing"in n?!!n.trailing:P);function T(F){var B=o,N=f;return o=f=void 0,S=F,x=r.apply(N,B),x}function M(F){return S=F,b=setTimeout(D,a),A?T(F):x}function O(F){var B=F-_,N=F-S,j=a-B;return C?b9(j,y-N):j}function I(F){var B=F-_,N=F-S;return _===void 0||B>=a||B<0||C&&N>=y}function D(){var F=vv();if(I(F))return z(F);b=setTimeout(D,O(F))}function z(F){return b=void 0,P&&o?T(F):(o=f=void 0,x)}function k(){b!==void 0&&clearTimeout(b),S=0,o=_=f=b=void 0}function L(){return b===void 0?x:z(vv())}function R(){var F=vv(),B=I(F);if(o=arguments,f=this,_=F,B){if(b===void 0)return M(_);if(C)return clearTimeout(b),b=setTimeout(D,a),T(_)}return b===void 0&&(b=setTimeout(D,a)),x}return R.cancel=k,R.flush=L,R}var xo=S9;function w9(r){var a=r==null?0:r.length;return a?r[a-1]:void 0}var nI=w9;function A9(r,a){return r>a}var sI=A9;function E9(r,a){return a.length<2?r:nv(r,$_(a,0,-1))}var oI=E9;function T9(r,a){return eI(r,a)}var Fc=T9;function M9(r,a,n){for(var o=-1,f=r.length;++o<f;){var y=r[o],x=a(y);if(x!=null&&(b===void 0?x===x&&!yo(x):n(x,b)))var b=x,_=y}return _}var aI=M9;function C9(r){return r&&r.length?aI(r,Ky,sI):void 0}var xw=C9;function P9(r,a){return a=hs(a,r),r=oI(r,a),r==null||delete r[El(nI(a))]}var lI=P9;function _9(r){return J_(r)?void 0:r}var cI=_9,I9=1,D9=2,O9=4,R9=sv(function(r,a){var n={};if(r==null)return n;var o=!1;a=Yy(a,function(y){return y=hs(y,r),o||(o=y.length>1),y}),vo(r,cv(r),n),o&&(n=pv(n,I9|D9|O9,cI));for(var f=a.length;f--;)lI(n,a[f]);return n}),Nh=R9;function L9(r,a,n,o){if(!xi(r))return r;a=hs(a,r);for(var f=-1,y=a.length,x=y-1,b=r;b!=null&&++f<y;){var _=El(a[f]),S=n;if(_==="__proto__"||_==="constructor"||_==="prototype")return r;if(f!=x){var A=b[_];S=o?o(A,_,b):void 0,S===void 0&&(S=xi(A)?A:vh(a[f+1])?[]:{})}bh(b,_,S),b=b[_]}return r}var uI=L9;function B9(r,a,n){for(var o=-1,f=a.length,y={};++o<f;){var x=a[o],b=nv(r,x);n(b,x)&&uI(y,hs(x,r),b)}return y}var hI=B9;function N9(r,a){return hI(r,a,function(n,o){return iI(r,o)})}var dI=N9,F9=sv(function(r,a){return r==null?{}:dI(r,a)}),In=F9,V9="Expected a function";function U9(r,a,n){var o=!0,f=!0;if(typeof r!="function")throw new TypeError(V9);return xi(n)&&(o="leading"in n?!!n.leading:o,f="trailing"in n?!!n.trailing:f),xo(r,a,{leading:o,maxWait:a,trailing:f})}var bw=U9;function xv(r){for(let a of Object.keys(r))r[a]===void 0&&delete r[a];return r}function Xi(r,a){return Object.setPrototypeOf(r,a),r}var z9=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().includes(" electron/"),k9=()=>typeof window>"u"?!1:window.navigator.platform.toUpperCase().includes("MAC"),G9=()=>typeof window>"u"?!1:/iPad|iPhone|iPod/.test(window.navigator.userAgent)||Fh&&"ontouchend"in document,j9=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1,H9=()=>typeof window>"u"?!1:"ontouchstart"in window||navigator.maxTouchPoints>0,W9=()=>{if(typeof window>"u")return!1;let r=navigator.userAgent,a=navigator.vendor;return/Safari/i.test(r)&&/Apple Computer/.test(a)},q9=()=>{if(typeof window>"u")return null;let r=navigator.userAgent.match(/Version\/(\d+\.\d)/);return r&&r[1]},X9=()=>{if(typeof window>"u")return;let r=new URLSearchParams(window.location.search).get("desktop-app-version");return r?(window.localStorage.setItem("desktop-app-version",r),r):window.localStorage.getItem("desktop-app-version")??"0.0.6"},Sw=z9();Sw&&X9();var Fh=k9(),bo=G9();j9();var Ii=H9(),ww=W9(),pI=Number(q9());function bv(r){return Array.isArray(r)?r:[r]}function Sv(r,a){let n=0;for(;n<r.length&&n<a.length;){if(r[n]<a[n])return-1;if(r[n]>a[n])return 1;n+=1}return n!==a.length?-1:n!==r.length?1:0}var $e=[];function yI(){$e.splice(0,$e.length)}var AI=new Promise(r=>{}),MI=new Promise(r=>{}),Ze=class{modifyById(r,a){let n=this;if(n[r]===void 0)throw new Error("not expected");{let o={...n,[r]:a};return Object.setPrototypeOf(o,Ze.prototype),o}}add(r,a){var n;return((n=this.runOp({type:1,id:r,data:a}))==null?void 0:n.data)??this}runOp(r){let a=this;if(r.type===1){let n=a[r.id],o;n===void 0?o={type:2,id:r.id}:o={type:1,id:r.id,data:n};let{id:f,data:y}=r,x={...a,[f]:y};return Object.setPrototypeOf(x,Ze.prototype),{data:x,actual:r,reverse:o}}else if(r.type===2){let{id:n}=r,o=a[n];if(o===void 0)return null;{let f={...a};return Object.setPrototypeOf(f,Ze.prototype),delete f[n],{data:f,actual:r,reverse:{type:1,id:n,data:o}}}}return null}};function Xp(r){if(r.deepFreeze!==void 0){r.deepFreeze(r);return}let a=Object.getOwnPropertyNames(r);for(let n of a){let o=r[n];o&&typeof o=="object"&&Xp(o)}return Object.freeze(r)}function PI(r,a){let n=0;for(;n<r.length&&n<a.length;){if(r[n]<a[n])return-1;if(r[n]>a[n])return 1;n+=1}return n!==a.length?-1:n!==r.length?1:0}var Uh=class extends Error{};function Pv(r){let a={...r};return Object.setPrototypeOf(a,Object.getPrototypeOf(r)),a}function So(r,a,n){if(r===void 0?a===void 0?(r=0,a=10):r=a-10:a===void 0&&(a=r+10),r>a){let y=r;r=a,a=y}let o=[],f=1/(n+1);for(let y=0;y<n;y++){let x=r+(a-r)*(y+.75+Math.random()*.5)*f;o.push(x)}return o}function zh(r){return r instanceof Uint8Array||r instanceof Uint16Array||r instanceof Uint32Array||r instanceof Int8Array||r instanceof Int16Array||r instanceof Int32Array||r instanceof Float32Array||r instanceof Float64Array}function _I(){return typeof process<"u"}function II(r,a){for(let n of r)a(n.id,n.data)!==!0&&II(n.children,a)}function DI(r,a){if(a(r.id,r.data)!==!0)for(let n of r.children)DI(n,a)}var vr=class extends Array{constructor(...r){super(...r),Object.setPrototypeOf(this,vr.prototype)}deepFreeze(){let r=0;for(;r<this.length;)Xp(this[r]),r++}fillCaches0(r,a){this.objCaches.set(r.id,r),this.parentCaches.set(r.id,a);for(let n of r.children)this.fillCaches0(n,r.id)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,this.parentCaches=new Map;for(let r of this)this.fillCaches0(r,null)}}randomId(){this.fillCaches();let r=Array.from(this.objCaches.keys());if(r.length!==0)return r[Math.max(0,Math.floor(Math.random()*r.length)-1)]}nonExistOrDescendantOf(r,a){if(!this.has(r))return!0;for(;r;){let n=this.parent(r);if(n===a)return!0;r=n}return!1}rootAcestor(r){for(;r;){let a=this.parent(r);if(a)r=a;else return r}return r}isDescendantOf(r,a){for(;r;){let n=this.parent(r);if(n===a)return!0;r=n}return!1}data(r){var a;return(a=this.get(r))==null?void 0:a.data}has(r){return this.childrenOf(r)!==void 0}get(r){return this.fillCaches(),this.objCaches.get(r)}childrenOf(r){var a;return r===null?this:(a=this.get(r))==null?void 0:a.children}traverseFrom(r,a){if(r===null)this.traverse(a);else{let n=this.get(r);n&&DI(n,a)}}traverse(r){II(this,r)}totalSize(){return this.fillCaches(),this.objCaches.size}parent(r){return this.fillCaches(),this.parentCaches.get(r)}childrenArray(r){return r===null?this:this.get(r).children}modifyById(r,a){if(this.get(r)===void 0)throw new Error("not expected");{let n=this.parent(r),o=this.childrenArray(n),f=o.findIndex(x=>x.id===r);if(f<0)throw new Error("not expected");let y=o[f];return o=[...o],o[f]={...y,data:a},this.modifyArrayBy(n,o)}}modifyArrayBy(r,a){let n=r,o=a;for(;n!==null;){let y=o,x=n;if(n=this.parent(n),n===void 0)throw new Error;o=this.childrenArray(n);let b=o.findIndex(_=>_.id===x);if(b<0)throw new Error;o=[...o],o[b]={...o[b],children:y}}Object.setPrototypeOf(o,vr.prototype);let f=o;return f.fillCaches(),f}runOp(r){switch(r.type){case 7:return this.addOp(r);case 8:return this.deleteOp(r);case 9:return this.moveOp(r)}return null}checkDuplicatedIdRec({id:r,children:a}){if(this.get(r)!==void 0)return!0;for(let n of a)if(this.checkDuplicatedIdRec(n))return!0;return!1}addOp(r){let{parent:a,fi:n,id:o,data:f,children:y}=r;if(a!==null&&this.get(a)===void 0||this.checkDuplicatedIdRec(r))return null;{let x=a,b=this.childrenArray(x),_={fi:n,id:o,data:f,children:y};return b=[...b,_],b.sort((S,A)=>S.fi-A.fi),r.localIndex=b.indexOf(_),{data:this.modifyArrayBy(x,b),actual:r,reverse:{type:8,id:o}}}}deleteOp(r){let{id:a}=r;if(this.get(a)===null)return null;{let n=this.parent(a);if(n===void 0)return null;let o=this.childrenArray(n),f=o.findIndex(x=>x.id===a);r.localIndex=f,o=[...o];let y=o.splice(f,1)[0];return{data:this.modifyArrayBy(n,o),actual:r,reverse:{type:7,...y,parent:n}}}}moveOp(r){let{parent:a,fi:n,id:o}=r;if(a!==null&&this.get(a)===void 0)return this.deleteOp({type:8,id:o});if(a!==null){let C=a;for(;C!==null;){if(C===void 0)throw new Error;if(C===o)throw new Uh("cyclic tree");C=this.parent(C)}}let f=this.parent(o);if(f===void 0)return null;let y=f,x=this.childrenArray(f),b=x.findIndex(C=>C.id===o);x=[...x];let _=x.splice(b,1)[0],S=this.modifyArrayBy(f,x);f=a,x=S.childrenArray(f);let A=_.fi;return _={..._,fi:n},x=[...x,_],x.sort((C,P)=>C.fi-P.fi),r.localIndex=x.indexOf(_),S=S.modifyArrayBy(f,x),{data:S,actual:r,reverse:{type:9,parent:y,fi:A,id:o}}}previous(r,a){if(a===null){let o=this.childrenArray(r);return o.length===0?null:o[o.length-1].id}let n=null;for(let o of this.childrenArray(r)){if(o.id===a)return n;n=o.id}return null}traverseSortNext(r){let a=this.parent(r);if(a!==void 0){let n=this.childrenArray(a),o=n.findIndex(f=>f.id===r)+1;if(o<n.length)return n[o].id;if(a)return this.traverseSortNext(a)}}sortNext(r){let a=this.childrenArray(r);return a.length>0?a[0].id:this.traverseSortNext(r)}traverseSortPrevious(r){let a=this.childrenArray(r);return a.length>0?this.traverseSortPrevious(a[a.length-1].id):r}sortPrevious(r){let a=this.parent(r);if(a!==void 0){let n=this.childrenArray(a),o=n.findIndex(f=>f.id===r)-1;return o>=0?this.traverseSortPrevious(n[o].id):a}}getAllSorted(r){let a=[];for(let n of r){let o=this.getWithSortKey(n.id);o!==void 0&&a.push({...n,...o})}a.sort((n,o)=>PI(n.sortKey,o.sortKey));for(let n of a)delete n.sortKey;return a}getWithSortKey(r){var a=r;let n=[],o=this.get(a),f=o;if(o!==void 0){for(;a;)n.splice(0,0,o.fi),a=this.parent(a),a!==null&&(o=this.get(a));return{...f,sortKey:n}}}insertBeforeHelper(r,a,n){return this.insertAfterHelper(r,this.previous(r,a),n)}insertAfterHelper(r,a,n){let o=this.childrenArray(r);if(a===null){if(o.length===0)return So(0,n,n);{let f=o[0].fi;return So(f-n,f,n)}}else{let f=this.get(a);if(f===void 0||this.parent(a)!==r)throw new Error("illegal args");let y=o.find(x=>x.fi>f.fi);if(y===void 0){let x=o[o.length-1].fi;return So(x,x+n,n)}else return So(f.fi,y.fi,n)}}},kh;(r=>{function a(n,o){if(o.type!==0)return null;if(Array.isArray(n)){let f=o.props,y={},x=[...n],b=!1;if(f)for(let _ of Object.keys(f)){let S=parseInt(_);if(isNaN(S))throw new Error("wrong index");y[_]=x[S],x[S]=f[_],b=!0}return b?{data:x,actual:o,reverse:{type:0,props:y}}:null}else{let f=o.props,y={},x={...n},b=!1;if(f)for(let _ of Object.keys(f)){y[_]=x[_];let S=f[_];S===void 0?delete x[_]:x[_]=S,b=!0}return b?{data:x,actual:o,reverse:{type:0,props:y}}:null}}r.runOp=a})(kh||(kh={}));var Ue=class extends Array{constructor(...r){super(...r),Object.setPrototypeOf(this,Ue.prototype)}deepFreeze(){let r=0;for(;r<this.length;)Xp(this[r]),r++}fillCaches0(r){this.objCaches.set(r.id,r)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,Object.getOwnPropertyDescriptor(this,"objCaches").enumerable=!1;for(let r of this)this.fillCaches0(r)}}randomId(){this.fillCaches();let r=Array.from(this.objCaches.keys());if(r.length!==0)return r[Math.max(0,Math.floor(Math.random()*r.length)-1)]}data(r){var a;return(a=this.get(r))==null?void 0:a.data}get(r){return this.fillCaches(),this.objCaches.get(r)}modifyById(r,a){if(this.get(r)===void 0)throw new Error("not expected");{let n=this,o=n.findIndex(y=>y.id===r);if(o<0)throw new Error("not expected");let f=n[o];return n=[...n],n[o]={...f,data:a},this.modifyArrayBy(n)}}modifyArrayBy(r){Object.setPrototypeOf(r,Ue.prototype);let a=r;return _I()||a.fillCaches(),a}runOp(r){switch(r.type){case 4:return this.addOp(r);case 5:return this.deleteOp(r);case 6:return this.moveOp(r)}return null}addOp(r){let{fi:a,id:n,data:o}=r,f=this,y={fi:a,id:n,data:o};return f=[...f,y],f.sort((x,b)=>x.fi-b.fi),r.localIndex=f.indexOf(y),{data:this.modifyArrayBy(f),actual:r,reverse:{type:5,id:n}}}deleteOp(r){let{id:a}=r,n=this,o=n.findIndex(y=>y.id===a);if(o===-1)return null;r.localIndex=o,n=[...n];let f=n.splice(o,1)[0];return{data:this.modifyArrayBy(n),actual:r,reverse:{type:4,...f}}}moveOp(r){let{fi:a,id:n}=r,o=this;o=[...o];let f=o.findIndex(b=>b.id===n);if(f===-1)return null;let y=o[f].fi,x={...o[f],fi:a};return o[f]=x,o.sort((b,_)=>b.fi-_.fi),r.localIndex=o.indexOf(x),{data:this.modifyArrayBy(o),actual:r,reverse:{type:6,fi:y,id:n}}}previous(r){if(r===null)return this.length===0?null:this[this.length-1].id;let a=null;for(let n of this){if(n.id===r)return a;a=n.id}return null}insertBeforeHelper(r,a){return this.insertAfterHelper(this.previous(r),a)}insertAfterHelper(r,a){let n=this;if(r===null){if(n.length===0)return So(0,a,a);{let o=n[0].fi;return So(o-a,o,a)}}else{let o=this.get(r);if(o===void 0)throw new Error("illegal args");let f=n.find(y=>y.fi>o.fi);if(f===void 0){let y=n[n.length-1].fi;return So(y,y+a,a)}else return So(o.fi,f.fi,a)}}};function Gh(r){return r&&typeof r=="object"&&r instanceof xr}var xr=class{unusedFunOverridesTable(r){}runOp(r){let a=[],n=this,o=0,f={};for(;o<r.path.length;){if(a.push(n),n=n===void 0?void 0:n[r.path[o]],n!==void 0&&!Gh(n))return null;o+=1}n=n?Pv(n):new xr;for(let[b,_]of Object.entries(r.props)){let S=n[b];f[b]=S,_===void 0?delete n[b]:n[b]=_}for(;o>0;){if(Object.keys(n).length===0){let b=a[o-1];b&&(n=Pv(b),delete n[r.path[o-1]])}else{let b=a[o-1];if(b){let _=Pv(b);_[r.path[o-1]]=n,n=_}else{let _=new xr;_[r.path[o-1]]=n,n=_}}o-=1}let y=Object.setPrototypeOf(n,xr.prototype),x={...r,props:f};return{data:y,actual:r,reverse:x}}},wo;(r=>{function a(f,y){return Yp(f,y)??f}r.apply=a;function n(f,y){return Ew(f,y)}r.merge=n;function o(f,y){let x=0,b=y.path,_=f;for(;x<b.length&&_!==void 0;){if(_=Ar.zoomOnce(_,b[x]),_===void 0)return y;if(!Gh(_))return;x+=1}if(_===void 0)return y;if(Gh(_))if(y.type===0){let S={...y.props};for(let A of Object.keys(_))delete S[A];return{...y,props:S}}else if(y.type===1||y.type===4||y.type===7){let S=Aw([y],_);return S?(console.log(S),S):y}else return y}r.filterOp=o})(wo||(wo={}));function Aw(r,a){if(a===void 0)return;let n=!1,o=r.map(f=>{let y=f.id,x=Yp(f.data,a[y]);if(n=n||x!==void 0,x===void 0&&(x=f.data),f.children){let b=Aw(f.children,a);return b!==void 0?n=!0:b=f.children,{...f,id:y,data:x,children:b}}else return{...f,id:y,data:x}});if(n)return o}function Y9(r,a){if(a===void 0)return;let n=!1,o=r.map(f=>{let y=f.id,x=Yp(f.data,a[y]);return n=n||x!==void 0,x===void 0&&(x=f.data),{...f,id:y,data:x}});if(n)return Object.setPrototypeOf(o,Object.getPrototypeOf(r)),o}function Yp(r,a){if(!Gh(a))return a;if(r instanceof vr){let n=Aw(r,a);return n!==void 0&&Object.setPrototypeOf(n,Object.getPrototypeOf(r)),n}else{if(r instanceof Ue)return Y9(r,a);if(Array.isArray(r)){let n=!1,o=r.map((f,y)=>{let x=Yp(f,a[y]);return n=n||x!==void 0,x===void 0&&(x=f),x});return n?(Object.setPrototypeOf(o,Object.getPrototypeOf(r)),o):void 0}else{if(r instanceof xr)return Ew(r,a);if(r&&typeof r=="object"){let n={},o=!1;for(let[f,y]of Object.entries(r)){let x=Yp(y,a[f]);o=o||x!==void 0,x===void 0&&(x=y),n[f]=x}return o?(Object.setPrototypeOf(n,Object.getPrototypeOf(r)),n):void 0}}}}function Ew(r,a){if(r===void 0)return a;if(a===void 0)return r;if(!Gh(a))return a;if(!Gh(r))return wo.apply(r,a);let n=new Set;for(let f of Object.keys(r))n.add(f);for(let f of Object.keys(a))n.add(f);let o=new xr;for(let f of n){let y=Ew(r===void 0?void 0:r[f],a===void 0?void 0:a[f]);o[f]=y}return o}function OI(r,a){let n={cur:[],result:[],len:0};return r=Kp(r,a,n)??r,[r,n.result]}function _v(r,a){return r===null?null:(r.cur[r.len]=a,r.len+=1,r)}function Iv(r){r&&(r.len-=1)}function K9(r){if(r===null)return null;r.result.push(r.cur.slice(0,r.len))}function RI(r,a,n){let o=!1,f=r.map(y=>{let x=y.id,b=a[x];if(b!==void 0&&typeof b=="string"&&(o=!0,x=b,n!==null))throw new Error("not supported");let _=Kp(y.data,a,_v(n,x));Iv(n),o=o||_!==void 0,_===void 0&&(_=y.data);let S=RI(y.children,a,n);return S!==void 0?o=!0:S=y.children,{...y,id:x,data:_,children:S}});if(o)return f}function Q9(r,a,n){let o=!1,f=r.map(y=>{let x=y.id,b=a[x];if(b!==void 0&&typeof b=="string"&&(o=!0,x=b,n!==null))throw new Error("not supported");let _=Kp(y.data,a,_v(n,x));return Iv(n),o=o||_!==void 0,_===void 0&&(_=y.data),{...y,id:x,data:_}});if(o)return Object.setPrototypeOf(f,Object.getPrototypeOf(r)),f}function Kp(r,a,n){if(r instanceof vr){let o=RI(r,a,n);return o!==void 0&&Object.setPrototypeOf(o,Object.getPrototypeOf(r)),o}else{if(r instanceof Ue)return Q9(r,a,n);if(Array.isArray(r)){let o=!1,f=r.map((y,x)=>{let b=Kp(y,a,_v(n,x));return Iv(n),o=o||b!==void 0,b===void 0&&(b=y),b});return o?(Object.setPrototypeOf(f,Object.getPrototypeOf(r)),f):void 0}else if(r&&typeof r=="object"&&!zh(r)){let o={},f=!1;for(let[y,x]of Object.entries(r))if(y!=="name"&&y!=="variableId"){let b=a[y];if(typeof b=="string"){if(n!==null)throw new Error("not supported");f=!0,y=b}let _=Kp(x,a,_v(n,y));Iv(n),f=f||_!==void 0,_===void 0&&(_=x),o[y]=_}else o[y]=x;return f?(Object.setPrototypeOf(o,Object.getPrototypeOf(r)),o):void 0}else if(typeof r=="string"){let o=a[r];return o!==void 0&&K9(n),o}else return}}var jh;(r=>{function a(n,o){let f=Ar.zoom(o,n.path);if(typeof f=="object"){let y={};for(let x of Object.keys(n.props))y[x]=f[x];return{...n,props:y}}else return{...n,props:{}}}r.replaceProps=a})(jh||(jh={}));var Vr;(r=>{function a(_,S){return{..._,path:_.path.slice(S)}}r.drop=a;function n(_,S){var A;return((A=o(_,S))==null?void 0:A.data)??_}r.applySimple=n;function o(_,S){var P,T;let A=S.path;for(var C=[];;){let M;if(_ instanceof xr&&S.type===0&&(M=_.runOp({...S,path:A.slice(C.length)}),M===null&&(M=void 0)),M===void 0&&C.length===A.length&&(_ instanceof vr||_ instanceof Ue||_ instanceof Ze?M=_.runOp(S):M=kh.runOp(_,S)),M!==void 0)if(M!==null){let D=M.data;for(let z=C.length-1;z>=0;z--){let k=A[z],L=C[z];if(L instanceof vr){if(typeof k=="number")throw new Error("illegal arg");D=L.modifyById(k,D)}else if(L instanceof Ue){if(typeof k=="number")throw new Error("illegal arg");D=L.modifyById(k,D)}else if(L instanceof Ze){if(typeof k=="number")throw new Error("illegal arg");D=L.modifyById(k,D)}else if(L instanceof xr){let R={...L,[k]:D};D=Object.setPrototypeOf(R,xr.prototype)}else if(typeof L=="object")if(Array.isArray(L)){if(typeof k=="string"&&(k=parseInt(k),isNaN(k)))throw new Error("Invalid path");let R=D;D=[...L],D[k]=R}else D={...L,[k]:D};else return null}return{data:D,actual:{...M.actual,path:A},reverse:{...M.reverse,path:A}}}else return null;let O=A[C.length],I;if(_ instanceof vr){if(typeof O=="number")throw new Error("");I=(P=_.get(O))==null?void 0:P.data}else if(_ instanceof Ue){if(typeof O=="number")throw new Error("");I=(T=_.get(O))==null?void 0:T.data}else _!==null&&(I=_[O]);if(I!==void 0)C.push(_),_=I;else return null}}r.apply=o;function f(_,S){for(let A=0;A<_.length&&A<S.length;A++)if(_[A]!==S[A])return!0;return!1}r.pathDisjoint=f;function y(_,S){if(_.length!==S.length)return!1;for(let A=0;A<_.length;A++)if(_[A]!==S[A])return!1;return!0}r.pathEq=y;function x(_,S){return f(_.path,S.path)}r.commutative=x;function b(_,S){return _.type===0&&S.type===0&&y(_.path,S.path)?Object.keys(_.props).every(A=>S.props[A]!==void 0):!1}r.subsumed=b})(Vr||(Vr={}));var Qp;(r=>{function a(){return[]}r.empty=a;function n(S,A){let C=[];for(let P of S){let[T,...M]=P.path;T===A&&C.push({...P,path:M})}return C}r.removePrefix=n;function o(S,A){return S.map(C=>({...C,path:[A,...C.path]}))}r.addPrefix=o;function f(S,A){return[...S,...A]}r.concat=f;function y(S,A){return[...S.filter(C=>!A.some(P=>Vr.subsumed(C,P))),...A]}r.compress=y;function x(S,A){return S.every(C=>A.every(P=>Vr.commutative(C,P)))}r.commutative=x;function b(S,A){for(let C of A){let P=_(S,C);P!==null&&(S=P.data)}return S}r.applyAll=b;function _(S,A){var C=S;let P=[],T=[];for(let M of A)try{if(M.type===3||M.type===5&&M.path[M.path.length-1]==="variables"){let O,I,D;if(M.type===3?(O=Ar.zoom(C,[...M.path,M.id]),D=Vr.apply(C,{...M,type:2})):(O=Ar.zoom(C,[...M.path,M.id,"value"]),D=Vr.apply(C,M)),D!==null){C=D.data;let[z,k]=OI(C,{[M.id]:O});C=z;for(let L=0;L<k.length;L++){let R=k[L],F=R.pop();if(typeof F=="number"){let B=[F];for(let j=L+1;j<k.length;j++){let G=k[j],Y=G[G.length-1];if(typeof Y=="number"&&Ar.equal(R,G.slice(0,G.length-1)))B.push(Y),k.splice(j,1);else break}let N=Ar.zoom(C,R);I=N.map((j,G)=>B.includes(G)?M.id:j),O=N,F=R.pop()}else{if(F==="alphaOverride"||F==="alpha"){O/=100;let B=O,N=Ar.zoom(C,R.slice(0,R.length-2)),j=N.layers.map(G=>G.id===R[R.length-1]?{...G,data:{...G.data,[F]:B}}:G);Object.setPrototypeOf(j,Object.getPrototypeOf(N.layers)),N.layers=j}I=M.id}P.push({type:0,path:R,props:{[F]:O}}),T.push({type:0,path:R,props:{[F]:I}})}T.push(D.reverse),P.push(D.actual)}}else{let O=Vr.apply(C,M);O!==null&&(P.push(O.actual),C=O.data,T.push(O.reverse))}}catch(O){if(O instanceof Uh)return null;throw O}return{data:C,actual:P,reverse:T.reverse()}}r.apply=_})(Qp||(Qp={}));var LI=Symbol(),Z9=Symbol(),Ov=Symbol(),Vc=class{reportOp(r,a,n=[]){let o=this;if(a===null)return;o._current=a.data;let f=n;for(;!(o instanceof Dv);){let y=o._path,x=o._current;if(y!==""&&f.splice(0,0,y),o=o._parent,o===null)return;o.update(y,x)}o.push(f,r,a.actual,a.reverse)}deleteChildren(r){if(this._children){let a=this._children[r];if(a){let n=a[Ov];n&&n(),delete this._children[r]}}}},Mw=class extends Vc{constructor(r,a,n){super(),this._parent=r,this._path=a,this._current=n}update(r,a){if(Array.isArray(this._current)){if(typeof r=="string"&&(r=parseInt(r),isNaN(r)))throw new Error("Invalid path");this._current=[...this._current],this._current[r]=a}else this._current={...this._current,[r]:a}}runOp(r){this.reportOp(r,kh.runOp(this._current,r),r.path)}},Cw=class extends Vc{constructor(r,a,n){super(),this._parent=r,this._path=a,this._current=n}update(r,a){this._current={...this._current,[r]:a},Object.setPrototypeOf(this._current,Ze.prototype)}runOp(r){this.reportOp(r,this._current.runOp(r))}},BI={get(r,a){if(a===Ov)return()=>{r._parent=null};if(a===LI)return r._current;if(a===Z9)return r;let{_current:n,_children:o}=r;if(a==="push"&&Array.isArray(n))throw new Error("not supported to expand array");let f=o===void 0?void 0:o[a];if(f!==void 0)return f;let y=n[a],x=Rv(r,a,y);return x!==y?(o===void 0&&(o={},r._children=o),o[a]=x,x):y},has(r,a){return a in r._current},ownKeys(r){return Reflect.ownKeys(r._current)},defineProperty(){throw Error("not supported")},getPrototypeOf(r){return Object.getPrototypeOf(r._current)},setPrototypeOf(){throw Error("not supported")},getOwnPropertyDescriptor(r,a){let n=r._current,o=Reflect.getOwnPropertyDescriptor(n,a);return o&&{writable:!0,configurable:!0,enumerable:o.enumerable,value:n[a]}}},J9={...BI,set(r,a,n){let o={type:0,props:{[a]:Hr(n)??n}};return r.deleteChildren(a),r.runOp(o),!0},deleteProperty(r,a){let n={type:0,props:{[a]:void 0}};return r.deleteChildren(a),r.runOp(n),!0}},$9={...BI,set(r,a,n){return n===void 0?this.deleteProperty(r,a):(r.deleteChildren(a),r.runOp({type:1,id:a,data:n})),!0},deleteProperty(r,a){return r.runOp({type:2,id:a}),!0}},Hh=class extends Vc{constructor(r,a,n){super(),this._children={},this._parent=r,this._path=a,this._current=n,this[Ov]=()=>{this._parent=null}}unproxy(){return this._current}update(r,a){this._current=this._current.modifyById(r,a)}runOp(r){this.reportOp(r,this._current.runOp(r))}randomId(){return this._current.randomId()}isDescendantOf(r,a){return this._current.isDescendantOf(r,a)}childrenOf(r){return this._current.childrenOf(r)}traverse(r){return this._current.traverse(r)}get(r){return this._current.get(r)}parent(r){return this._current.parent(r)}traverse(r){this._current.traverse((a,n)=>{r(a,this.data(a))})}data(r){var x;let{_current:a,_children:n}=this,o=n===void 0?void 0:n[r];if(o!==void 0)return o;let f=(x=a.get(r))==null?void 0:x.data,y=Rv(this,r,f);return y!==f?(n===void 0&&(n={},this._children=n),n[r]=y,y):f}add(r,a,n,o,f){this.runOp({type:7,parent:r,fi:a,id:n,data:o,children:f})}move(r,a,n){this.runOp({type:9,parent:r,fi:a,id:n})}insertAfter(r,a,n){let o=this._current.insertAfterHelper(r,a,n.length);for(let f=0;f<n.length;f++){let y=n[f];this.add(r,o[f],y.id,y.data,y.children)}}insertBefore(r,a,n){let o=this._current.insertBeforeHelper(r,a,n.length);for(let f=0;f<n.length;f++){let y=n[f];this.add(r,o[f],y.id,y.data,y.children)}}moveAfter(r,a,n){let o=this._current.insertAfterHelper(r,a,n.length);for(let f=0;f<n.length;f++){let y=n[f];this.move(r,o[f],y)}}moveBefore(r,a,n){let o=this._current.insertBeforeHelper(r,a,n.length);for(let f=0;f<n.length;f++){let y=n[f];this.move(r,o[f],y)}}delete(r){this.deleteChildren(r),this.runOp({type:8,id:r})}sortNext(r){return this._current.sortNext(r)}sortPrevious(r){return this._current.sortPrevious(r)}getAllSorted(r){return this._current.getAllSorted(r)}},Wh=class extends Vc{constructor(r,a,n){super(),this._children={},this._parent=r,this._path=a,this._current=n,this[Ov]=()=>{this._parent=null}}unproxy(){return this._current}get length(){return this._current.length}forEach(r){let a=this.length;for(let n=0;n<a;n++){let o=this._current[n].id,f=this._current[n].fi;r(this.data(this._current[n].id),o,f)}}find(r){let a=this.length;for(let n=0;n<a;n++){let o=this._current[n].id;if(r(this.data(o),o))return this.get(o)}}update(r,a){this._current=this._current.modifyById(r,a)}randomId(){return this._current.randomId()}get(r){return{...this._current.get(r),data:this.data(r)}}data(r){var x;let{_current:a,_children:n}=this,o=n===void 0?void 0:n[r];if(o!==void 0)return o;let f=(x=a.get(r))==null?void 0:x.data,y=Rv(this,r,f);return y!==f?(n===void 0&&(n={},this._children=n),n[r]=y,y):f}runOp(r){this.reportOp(r,this._current.runOp(r))}add(r,a,n){this.runOp({type:4,fi:r,id:a,data:n})}move(r,a){this.runOp({type:6,fi:r,id:a})}insertAfter(r,a){let n=this._current.insertAfterHelper(r,a.length);for(let o=0;o<a.length;o++){let f=a[o];this.add(n[o],f.id,f.data)}}insertBefore(r,a){let n=this._current.insertBeforeHelper(r,a.length);for(let o=0;o<a.length;o++){let f=a[o];this.add(n[o],f.id,f.data)}}moveAfter(r,a){let n=this._current.insertAfterHelper(r,a.length);for(let o=0;o<a.length;o++){let f=a[o];this.move(n[o],f)}}moveBefore(r,a){let n=this._current.insertBeforeHelper(r,a.length);for(let o=0;o<a.length;o++){let f=a[o];this.move(n[o],f)}}delete(r){this.deleteChildren(r),this.runOp({type:5,id:r})}};function Tw(r,a,n){if(r.length>0){let o=r[r.length-1];if(o.type===0&&a.type===0&&Ar.equal(o.path,n)){Object.assign(o.props,a.props);return}}r.push({...a,path:n})}var Dv=class extends Vc{constructor(r){super(),this.ts=[],this.actual=[],this.reverse=[],this._current=r}update(r,a){if(r!=="")throw new Error("");this._current=a}push(r,a,n,o){Tw(this.ts,a,r),Tw(this.actual,n,r),Tw(this.reverse,o,r)}result(){return{data:this._current,ts:this.ts,actual:this.actual,reverse:this.reverse.reverse()}}};function Rv(r,a,n){return n instanceof vr?new Hh(r,a,n):n instanceof Ue?new Wh(r,a,n):n instanceof Ze?new Proxy(new Cw(r,a,n),$9):n!==null&&typeof n=="object"?zh(n)?n:new Proxy(new Mw(r,a,n),J9):n}function Pw(r){let a=new Dv(r);return[Rv(a,"",r),a]}function Tl(r,a){let[n,o]=Pw(r);return a(n),o.result()}function Hr(r){return r instanceof Hh||r instanceof Wh?r._current:r!==null&&typeof r=="object"?r[LI]:r}var Ar;(r=>{function a(y,x){if(x.length===y.length)for(var b=0;b<y.length;){if(y[b]!==x[b])return!1;b+=1}else return!1;return!0}r.equal=a;function n(y,x,b){let _=f(b,y);if(_!==void 0&&typeof _=="object"&&_!==null){let S={...x};return Object.keys(_).forEach(A=>{delete S[A]}),S}else return x}r.removeOverridden=n;function o(y,x){if((y instanceof vr||y instanceof Hh)&&typeof x=="string"||(y instanceof Ue||y instanceof Wh)&&typeof x=="string")return y.data(x);if(typeof x=="number"&&Array.isArray(y)||typeof x=="string"&&typeof y=="object"&&y!==null)return y[x]}r.zoomOnce=o;function f(y,x,b=0){for(;b<x.length&&y!==void 0;)y=o(y,x[b]),b+=1;return y}r.zoom=f})(Ar||(Ar={}));function NI(r,a){let n=[];if(a.length===r.length)for(var o=0;o<r.length;){if(a[o]==="*")n.push(r[o]);else if(r[o]!==a[o])return null;o+=1}else return null;return n}function Vt(r,a){let n=[];if(a.length<=r.length)for(var o=0;o<a.length;){if(a[o]==="*")n.push(r[o]);else if(r[o]!==a[o])return null;o+=1}else return null;return n}var Lv=class{},Zp=class extends Lv{constructor(r){super(),this.id=r}},Jp=class extends Lv{constructor(r){super(),this.data=r}},Iw;try{Iw=new TextDecoder}catch{}var Xe,Cl,se=0,Dn={},$t,Ml,ds=0,Ao=0,Jn,ba,xn=[],ar,FI={useRecords:!1,mapsAsObjects:!0},$p=class{},Lw=new $p;Lw.name="MessagePack 0xC1";var qh=!1,Eo=class{constructor(r){r&&(r.useRecords===!1&&r.mapsAsObjects===void 0&&(r.mapsAsObjects=!0),r.structures?r.structures.sharedLength=r.structures.length:r.getStructures&&((r.structures=[]).uninitialized=!0,r.structures.sharedLength=0)),Object.assign(this,r)}unpack(r,a){if(Xe)return KI(()=>(Nv(),this?this.unpack(r,a):Eo.prototype.unpack.call(FI,r,a)));Cl=a>-1?a:r.length,se=0,Ao=0,Ml=null,Jn=null,Xe=r;try{ar=r.dataView||(r.dataView=new DataView(r.buffer,r.byteOffset,r.byteLength))}catch(n){throw Xe=null,r instanceof Uint8Array?n:new Error("Source must be a Uint8Array or Buffer but was a "+(r&&typeof r=="object"?r.constructor.name:typeof r))}if(this instanceof Eo){if(Dn=this,this.structures)return $t=this.structures,Bv();(!$t||$t.length>0)&&($t=[])}else Dn=FI,(!$t||$t.length>0)&&($t=[]);return Bv()}unpackMultiple(r,a){let n,o=0;try{qh=!0;let f=r.length,y=this?this.unpack(r,f):Uv.unpack(r,f);if(a){for(a(y);se<f;)if(o=se,a(Bv())===!1)return}else{for(n=[y];se<f;)o=se,n.push(Bv());return n}}catch(f){throw f.lastPosition=o,f.values=n,f}finally{qh=!1,Nv()}}_mergeStructures(r,a){r=r||[];for(let n=0,o=r.length;n<o;n++){let f=r[n];f&&(f.isShared=!0,n>=32&&(f.highByte=n-32>>5))}r.sharedLength=r.length;for(let n in a||[])if(n>=0){let o=r[n],f=a[n];f&&(o&&((r.restoreStructures||(r.restoreStructures=[]))[n]=o),r[n]=f)}return this.structures=r}decode(r,a){return this.unpack(r,a)}};function Bv(){try{if(!Dn.trusted&&!qh){let a=$t.sharedLength||0;a<$t.length&&($t.length=a)}let r=Zr();if(se==Cl)$t.restoreStructures&&VI(),$t=null,Xe=null,ba&&(ba=null);else if(se>Cl){let a=new Error("Unexpected end of MessagePack data");throw a.incomplete=!0,a}else if(!qh)throw new Error("Data read, but end of buffer not reached");return r}catch(r){throw $t.restoreStructures&&VI(),Nv(),(r instanceof RangeError||r.message.startsWith("Unexpected end of buffer"))&&(r.incomplete=!0),r}}function VI(){for(let r in $t.restoreStructures)$t[r]=$t.restoreStructures[r];$t.restoreStructures=null}function Zr(){let r=Xe[se++];if(r<160)if(r<128){if(r<64)return r;{let a=$t[r&63]||Dn.getStructures&&WI()[r&63];return a?(a.read||(a.read=Bw(a,r&63)),a.read()):r}}else if(r<144)if(r-=128,Dn.mapsAsObjects){let a={};for(let n=0;n<r;n++)a[XI()]=Zr();return a}else{let a=new Map;for(let n=0;n<r;n++)a.set(Zr(),Zr());return a}else{r-=144;let a=new Array(r);for(let n=0;n<r;n++)a[n]=Zr();return a}else if(r<192){let a=r-160;if(Ao>=se)return Ml.slice(se-ds,(se+=a)-ds);if(Ao==0&&Cl<140){let n=a<16?Nw(a):qI(a);if(n!=null)return n}return Rw(a)}else{let a;switch(r){case 192:return null;case 193:return Jn?(a=Zr(),a>0?Jn[1].slice(Jn.position1,Jn.position1+=a):Jn[0].slice(Jn.position0,Jn.position0-=a)):Lw;case 194:return!1;case 195:return!0;case 196:return _w(Xe[se++]);case 197:return a=ar.getUint16(se),se+=2,_w(a);case 198:return a=ar.getUint32(se),se+=4,_w(a);case 199:return Uc(Xe[se++]);case 200:return a=ar.getUint16(se),se+=2,Uc(a);case 201:return a=ar.getUint32(se),se+=4,Uc(a);case 202:if(a=ar.getFloat32(se),Dn.useFloat32>2){let n=Vv[(Xe[se]&127)<<1|Xe[se+1]>>7];return se+=4,(n*a+(a>0?.5:-.5)>>0)/n}return se+=4,a;case 203:return a=ar.getFloat64(se),se+=8,a;case 204:return Xe[se++];case 205:return a=ar.getUint16(se),se+=2,a;case 206:return a=ar.getUint32(se),se+=4,a;case 207:return Dn.int64AsNumber?(a=ar.getUint32(se)*4294967296,a+=ar.getUint32(se+4)):a=ar.getBigUint64(se),se+=8,a;case 208:return ar.getInt8(se++);case 209:return a=ar.getInt16(se),se+=2,a;case 210:return a=ar.getInt32(se),se+=4,a;case 211:return Dn.int64AsNumber?(a=ar.getInt32(se)*4294967296,a+=ar.getUint32(se+4)):a=ar.getBigInt64(se),se+=8,a;case 212:if(a=Xe[se++],a==114)return jI(Xe[se++]&63);{let n=xn[a];if(n)return n.read?(se++,n.read(Zr())):n.noBuffer?(se++,n()):n(Xe.subarray(se,++se));throw new Error("Unknown extension "+a)}case 213:return a=Xe[se],a==114?(se++,jI(Xe[se++]&63,Xe[se++])):Uc(2);case 214:return Uc(4);case 215:return Uc(8);case 216:return Uc(16);case 217:return a=Xe[se++],Ao>=se?Ml.slice(se-ds,(se+=a)-ds):tq(a);case 218:return a=ar.getUint16(se),se+=2,Ao>=se?Ml.slice(se-ds,(se+=a)-ds):rq(a);case 219:return a=ar.getUint32(se),se+=4,Ao>=se?Ml.slice(se-ds,(se+=a)-ds):iq(a);case 220:return a=ar.getUint16(se),se+=2,zI(a);case 221:return a=ar.getUint32(se),se+=4,zI(a);case 222:return a=ar.getUint16(se),se+=2,kI(a);case 223:return a=ar.getUint32(se),se+=4,kI(a);default:if(r>=224)return r-256;if(r===void 0){let n=new Error("Unexpected end of MessagePack data");throw n.incomplete=!0,n}throw new Error("Unknown MessagePack token "+r)}}}var eq=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function Bw(r,a){function n(){if(n.count++>2){let f=r.read=new Function("r","return function(){return {"+r.map(y=>eq.test(y)?y+":r()":"["+JSON.stringify(y)+"]:r()").join(",")+"}}")(Zr);return r.highByte===0&&(r.read=UI(a,r.read)),f()}let o={};for(let f=0,y=r.length;f<y;f++){let x=r[f];o[x]=Zr()}return o}return n.count=0,r.highByte===0?UI(a,n):n}var UI=(r,a)=>function(){let n=Xe[se++];if(n===0)return a();let o=r<32?-(r+(n<<5)):r+(n<<5),f=$t[o]||WI()[o];if(!f)throw new Error("Record id is not defined for "+o);return f.read||(f.read=Bw(f,r)),f.read()};function WI(){let r=KI(()=>(Xe=null,Dn.getStructures()));return $t=Dn._mergeStructures(r,$t)}var Rw=Fv,tq=Fv,rq=Fv,iq=Fv;function Fv(r){let a;if(r<16&&(a=Nw(r)))return a;if(r>64&&Iw)return Iw.decode(Xe.subarray(se,se+=r));let n=se+r,o=[];for(a="";se<n;){let f=Xe[se++];if((f&128)===0)o.push(f);else if((f&224)===192){let y=Xe[se++]&63;o.push((f&31)<<6|y)}else if((f&240)===224){let y=Xe[se++]&63,x=Xe[se++]&63;o.push((f&31)<<12|y<<6|x)}else if((f&248)===240){let y=Xe[se++]&63,x=Xe[se++]&63,b=Xe[se++]&63,_=(f&7)<<18|y<<12|x<<6|b;_>65535&&(_-=65536,o.push(_>>>10&1023|55296),_=56320|_&1023),o.push(_)}else o.push(f);o.length>=4096&&(a+=zi.apply(String,o),o.length=0)}return o.length>0&&(a+=zi.apply(String,o)),a}function zI(r){let a=new Array(r);for(let n=0;n<r;n++)a[n]=Zr();return a}function kI(r){if(Dn.mapsAsObjects){let a={};for(let n=0;n<r;n++)a[XI()]=Zr();return a}else{let a=new Map;for(let n=0;n<r;n++)a.set(Zr(),Zr());return a}}var zi=String.fromCharCode;function qI(r){let a=se,n=new Array(r);for(let o=0;o<r;o++){let f=Xe[se++];if((f&128)>0){se=a;return}n[o]=f}return zi.apply(String,n)}function Nw(r){if(r<4)if(r<2){if(r===0)return"";{let a=Xe[se++];if((a&128)>1){se-=1;return}return zi(a)}}else{let a=Xe[se++],n=Xe[se++];if((a&128)>0||(n&128)>0){se-=2;return}if(r<3)return zi(a,n);let o=Xe[se++];if((o&128)>0){se-=3;return}return zi(a,n,o)}else{let a=Xe[se++],n=Xe[se++],o=Xe[se++],f=Xe[se++];if((a&128)>0||(n&128)>0||(o&128)>0||(f&128)>0){se-=4;return}if(r<6){if(r===4)return zi(a,n,o,f);{let y=Xe[se++];if((y&128)>0){se-=5;return}return zi(a,n,o,f,y)}}else if(r<8){let y=Xe[se++],x=Xe[se++];if((y&128)>0||(x&128)>0){se-=6;return}if(r<7)return zi(a,n,o,f,y,x);let b=Xe[se++];if((b&128)>0){se-=7;return}return zi(a,n,o,f,y,x,b)}else{let y=Xe[se++],x=Xe[se++],b=Xe[se++],_=Xe[se++];if((y&128)>0||(x&128)>0||(b&128)>0||(_&128)>0){se-=8;return}if(r<10){if(r===8)return zi(a,n,o,f,y,x,b,_);{let S=Xe[se++];if((S&128)>0){se-=9;return}return zi(a,n,o,f,y,x,b,_,S)}}else if(r<12){let S=Xe[se++],A=Xe[se++];if((S&128)>0||(A&128)>0){se-=10;return}if(r<11)return zi(a,n,o,f,y,x,b,_,S,A);let C=Xe[se++];if((C&128)>0){se-=11;return}return zi(a,n,o,f,y,x,b,_,S,A,C)}else{let S=Xe[se++],A=Xe[se++],C=Xe[se++],P=Xe[se++];if((S&128)>0||(A&128)>0||(C&128)>0||(P&128)>0){se-=12;return}if(r<14){if(r===12)return zi(a,n,o,f,y,x,b,_,S,A,C,P);{let T=Xe[se++];if((T&128)>0){se-=13;return}return zi(a,n,o,f,y,x,b,_,S,A,C,P,T)}}else{let T=Xe[se++],M=Xe[se++];if((T&128)>0||(M&128)>0){se-=14;return}if(r<15)return zi(a,n,o,f,y,x,b,_,S,A,C,P,T,M);let O=Xe[se++];if((O&128)>0){se-=15;return}return zi(a,n,o,f,y,x,b,_,S,A,C,P,T,M,O)}}}}}function _w(r){return Dn.copyBuffers?Uint8Array.prototype.slice.call(Xe,se,se+=r):Xe.subarray(se,se+=r)}function Uc(r){let a=Xe[se++];if(xn[a])return xn[a](Xe.subarray(se,se+=r));throw new Error("Unknown extension type "+a)}var GI=new Array(4096);function XI(){let r=Xe[se++];if(r>=160&&r<192){if(r=r-160,Ao>=se)return Ml.slice(se-ds,(se+=r)-ds);if(!(Ao==0&&Cl<180))return Rw(r)}else return se--,Zr();let a=(r<<5^(r>1?ar.getUint16(se):r>0?Xe[se]:0))&4095,n=GI[a],o=se,f=se+r-3,y,x=0;if(n&&n.bytes==r){for(;o<f;){if(y=ar.getUint32(o),y!=n[x++]){o=1879048192;break}o+=4}for(f+=3;o<f;)if(y=Xe[o++],y!=n[x++]){o=1879048192;break}if(o===f)return se=o,n.string;f-=3,o=se}for(n=[],GI[a]=n,n.bytes=r;o<f;)y=ar.getUint32(o),n.push(y),o+=4;for(f+=3;o<f;)y=Xe[o++],n.push(y);let b=r<16?Nw(r):qI(r);return b!=null?n.string=b:n.string=Rw(r)}var jI=(r,a)=>{var n=Zr();let o=r;a!==void 0&&(r=r<32?-((a<<5)+r):(a<<5)+r,n.highByte=a);let f=$t[r];return f&&f.isShared&&(($t.restoreStructures||($t.restoreStructures=[]))[r]=f),$t[r]=n,n.read=Bw(n,o),n.read()},YI=typeof self=="object"?self:global;xn[0]=()=>{};xn[0].noBuffer=!0;xn[101]=()=>{let r=Zr();return(YI[r[0]]||Error)(r[1])};xn[105]=r=>{let a=ar.getUint32(se-4);ba||(ba=new Map);let n=Xe[se],o;n>=144&&n<160||n==220||n==221?o=[]:o={};let f={target:o};ba.set(a,f);let y=Zr();return f.used?Object.assign(o,y):(f.target=y,y)};xn[112]=r=>{let a=ar.getUint32(se-4),n=ba.get(a);return n.used=!0,n.target};xn[115]=()=>new Set(Zr());var Fw=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(r=>r+"Array");xn[116]=r=>{let a=r[0],n=Fw[a];if(!n)throw new Error("Could not find typed array for code "+a);return new YI[n](Uint8Array.prototype.slice.call(r,1).buffer)};xn[120]=()=>{let r=Zr();return new RegExp(r[0],r[1])};xn[98]=r=>{let a=(r[0]<<24)+(r[1]<<16)+(r[2]<<8)+r[3],n=se;se+=a-4,Jn=[Zr(),Zr()],Jn.position0=0,Jn.position1=0;let o=se;se=n;try{return Zr()}finally{se=o}};xn[255]=r=>r.length==4?new Date((r[0]*16777216+(r[1]<<16)+(r[2]<<8)+r[3])*1e3):r.length==8?new Date(((r[0]<<22)+(r[1]<<14)+(r[2]<<6)+(r[3]>>2))/1e6+((r[3]&3)*4294967296+r[4]*16777216+(r[5]<<16)+(r[6]<<8)+r[7])*1e3):r.length==12?new Date(((r[0]<<24)+(r[1]<<16)+(r[2]<<8)+r[3])/1e6+((r[4]&128?-281474976710656:0)+r[6]*1099511627776+r[7]*4294967296+r[8]*16777216+(r[9]<<16)+(r[10]<<8)+r[11])*1e3):new Date("invalid");function KI(r){let a=Cl,n=se,o=ds,f=Ao,y=Ml,x=ba,b=Jn,_=new Uint8Array(Xe.slice(0,Cl)),S=$t,A=$t.slice(0,$t.length),C=Dn,P=qh,T=r();return Cl=a,se=n,ds=o,Ao=f,Ml=y,ba=x,Jn=b,Xe=_,qh=P,$t=S,$t.splice(0,$t.length,...A),Dn=C,ar=new DataView(Xe.buffer,Xe.byteOffset,Xe.byteLength),T}function Nv(){Xe=null,ba=null,$t=null}function QI(r){r.unpack?xn[r.type]=r.unpack:xn[r.type]=r}var Vv=new Array(147);for(let r=0;r<256;r++)Vv[r]=+("1e"+Math.floor(45.15-r*.30103));var Uv=new Eo({useRecords:!1});Uv.unpack;Uv.unpackMultiple;Uv.unpack;var aq=new Float32Array(1);new Uint8Array(aq.buffer,0,4);var kv;try{kv=new TextEncoder}catch{}var Gv,Uw,jv=typeof Buffer<"u",Vw=jv?Buffer.allocUnsafeSlow:Uint8Array,eD=jv?Buffer:Uint8Array,ZI=jv?4294967296:2144337920,Se,ri,he=0,To,Mo=null,lq=/[\u0080-\uFFFF]/,em=Symbol("record-id"),zc=class extends Eo{constructor(r){super(r),this.offset=0;let a,n,o,f,y,x=0,b=eD.prototype.utf8Write?function(F,B,N){return Se.utf8Write(F,B,N)}:kv&&kv.encodeInto?function(F,B){return kv.encodeInto(F,Se.subarray(B)).written}:!1,_=this;r||(r={});let S=r&&r.sequential,A=r.structures||r.saveStructures,C=r.maxSharedStructures;if(C==null&&(C=A?32:0),C>8160)throw new Error("Maximum maxSharedStructure is 8160");let P=r.maxOwnStructures;P==null&&(P=A?32:64),S&&!r.saveStructures&&(this.structures=[]);let T=C>32||P+C>64,M=C+64,O=C+P+64;if(O>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let I=[],D=0,z=0;this.pack=this.encode=function(F,B){if(Se||(Se=new Vw(8192),ri=new DataView(Se.buffer,0,8192),he=0),To=Se.length-10,To-he<2048?(Se=new Vw(Se.length),ri=new DataView(Se.buffer,0,Se.length),To=Se.length-10,he=0):he=he+7&2147483640,a=he,y=_.structuredClone?new Map:null,_.bundleStrings?(Mo=["",""],Se[he++]=214,Se[he++]=98,Mo.position=he-a,he+=4):Mo=null,n=_.structures,n){n.uninitialized&&(n=_._mergeStructures(_.getStructures()));let N=n.sharedLength||0;if(N>C)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+n.sharedLength);if(!n.transitions){n.transitions=Object.create(null);for(let j=0;j<N;j++){let G=n[j];if(!G)continue;let Y,X=n.transitions;for(let $=0,te=G.length;$<te;$++){let ee=G[$];Y=X[ee],Y||(Y=X[ee]=Object.create(null)),X=Y}X[em]=j+64}x=N}S||(n.nextId=N+64)}o&&(o=!1),f=n||[];try{if(k(F),Mo){ri.setUint32(Mo.position+a,he-Mo.position-a);let N=Mo;Mo=null,k(N[0]),k(N[1])}if(_.offset=he,y&&y.idsToInsert){he+=y.idsToInsert.length*6,he>To&&R(he),_.offset=he;let N=uq(Se.subarray(a,he),y.idsToInsert);return y=null,N}return B&rD?(Se.start=a,Se.end=he,Se):Se.subarray(a,he)}finally{if(n){if(z<10&&z++,D>1e4)n.transitions=null,z=0,D=0,I.length>0&&(I=[]);else if(I.length>0&&!S){for(let N=0,j=I.length;N<j;N++)I[N][em]=0;I=[]}if(o&&_.saveStructures){let N=n.sharedLength||C;n.length>N&&(n=n.slice(0,N));let j=Se.subarray(a,he);return _.saveStructures(n,x)===!1?(_._mergeStructures(_.getStructures()),_.pack(F)):(x=N,j)}}B&yq&&(he=a)}};let k=F=>{he>To&&(Se=R(he));var B=typeof F,N;if(B==="string"){let j=F.length;if(Mo&&j>=8&&j<4096){let X=lq.test(F);Mo[X?0:1]+=F,Se[he++]=193,k(X?-j:j);return}let G;j<32?G=1:j<256?G=2:j<65536?G=3:G=5;let Y=j*3;if(he+Y>To&&(Se=R(he+Y)),j<64||!b){let X,$,te,ee=he+G;for(X=0;X<j;X++)$=F.charCodeAt(X),$<128?Se[ee++]=$:$<2048?(Se[ee++]=$>>6|192,Se[ee++]=$&63|128):($&64512)===55296&&((te=F.charCodeAt(X+1))&64512)===56320?($=65536+(($&1023)<<10)+(te&1023),X++,Se[ee++]=$>>18|240,Se[ee++]=$>>12&63|128,Se[ee++]=$>>6&63|128,Se[ee++]=$&63|128):(Se[ee++]=$>>12|224,Se[ee++]=$>>6&63|128,Se[ee++]=$&63|128);N=ee-he-G}else N=b(F,he+G,Y);N<32?Se[he++]=160|N:N<256?(G<2&&Se.copyWithin(he+2,he+1,he+1+N),Se[he++]=217,Se[he++]=N):N<65536?(G<3&&Se.copyWithin(he+3,he+2,he+2+N),Se[he++]=218,Se[he++]=N>>8,Se[he++]=N&255):(G<5&&Se.copyWithin(he+5,he+3,he+3+N),Se[he++]=219,ri.setUint32(he,N),he+=4),he+=N}else if(B==="number")if(F>>>0===F)F<64?Se[he++]=F:F<256?(Se[he++]=204,Se[he++]=F):F<65536?(Se[he++]=205,Se[he++]=F>>8,Se[he++]=F&255):(Se[he++]=206,ri.setUint32(he,F),he+=4);else if(F>>0===F)F>=-32?Se[he++]=256+F:F>=-128?(Se[he++]=208,Se[he++]=F+256):F>=-32768?(Se[he++]=209,ri.setInt16(he,F),he+=2):(Se[he++]=210,ri.setInt32(he,F),he+=4);else{let j;if((j=this.useFloat32)>0&&F<4294967296&&F>=-2147483648){Se[he++]=202,ri.setFloat32(he,F);let G;if(j<4||(G=F*Vv[(Se[he]&127)<<1|Se[he+1]>>7])>>0===G){he+=4;return}else he--}Se[he++]=203,ri.setFloat64(he,F),he+=8}else if(B==="object")if(!F)Se[he++]=192;else{if(y){let G=y.get(F);if(G){if(!G.id){let Y=y.idsToInsert||(y.idsToInsert=[]);G.id=Y.push(G)}Se[he++]=214,Se[he++]=112,ri.setUint32(he,G.id),he+=4;return}else y.set(F,{offset:he-a})}let j=F.constructor;if(j===Object)L(F,!0);else if(j===Array){N=F.length,N<16?Se[he++]=144|N:N<65536?(Se[he++]=220,Se[he++]=N>>8,Se[he++]=N&255):(Se[he++]=221,ri.setUint32(he,N),he+=4);for(let G=0;G<N;G++)k(F[G])}else if(j===Map){N=F.size,N<16?Se[he++]=128|N:N<65536?(Se[he++]=222,Se[he++]=N>>8,Se[he++]=N&255):(Se[he++]=223,ri.setUint32(he,N),he+=4);for(let[G,Y]of F)k(G),k(Y)}else{for(let G=0,Y=Gv.length;G<Y;G++){let X=Uw[G];if(F instanceof X){let $=Gv[G];if($.write){$.type&&(Se[he++]=212,Se[he++]=$.type,Se[he++]=0),k($.write.call(this,F));return}let te=Se,ee=ri,q=he;Se=null;let Z;try{Z=$.pack.call(this,F,U=>(Se=te,te=null,he+=U,he>To&&R(he),{target:Se,targetView:ri,position:he-U}),k)}finally{te&&(Se=te,ri=ee,he=q,To=Se.length-10)}Z&&(Z.length+he>To&&R(Z.length+he),he=cq(Z,Se,he,$.type));return}}L(F,!F.hasOwnProperty)}}else if(B==="boolean")Se[he++]=F?195:194;else if(B==="bigint"){if(F<BigInt(1)<<BigInt(63)&&F>=-(BigInt(1)<<BigInt(63)))Se[he++]=211,ri.setBigInt64(he,F);else if(F<BigInt(1)<<BigInt(64)&&F>0)Se[he++]=207,ri.setBigUint64(he,F);else if(this.largeBigIntToFloat)Se[he++]=203,ri.setFloat64(he,Number(F));else throw new RangeError(F+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");he+=8}else if(B==="undefined")this.encodeUndefinedAsNil?Se[he++]=192:(Se[he++]=212,Se[he++]=0,Se[he++]=0);else if(B==="function")k(this.writeFunction&&this.writeFunction());else throw new Error("Unknown type: "+B)},L=this.useRecords===!1?this.variableMapSize?F=>{let B=Object.keys(F),N=B.length;N<16?Se[he++]=128|N:N<65536?(Se[he++]=222,Se[he++]=N>>8,Se[he++]=N&255):(Se[he++]=223,ri.setUint32(he,N),he+=4);let j;for(let G=0;G<N;G++)k(j=B[G]),k(F[j])}:(F,B)=>{Se[he++]=222;let N=he-a;he+=2;let j=0;for(let G in F)(B||F.hasOwnProperty(G))&&(k(G),k(F[G]),j++);Se[N+++a]=j>>8,Se[N+a]=j&255}:F=>{let B=Object.keys(F),N,j=f.transitions||(f.transitions=Object.create(null)),G=0;for(let X=0,$=B.length;X<$;X++){let te=B[X];N=j[te],N||(N=j[te]=Object.create(null),G++),j=N}let Y=j[em];if(Y)Y>=96&&T?(Se[he++]=((Y-=96)&31)+96,Se[he++]=Y>>5):Se[he++]=Y;else{Y=f.nextId,Y||(Y=64),Y<M&&this.shouldShareStructure&&!this.shouldShareStructure(B)?(Y=f.nextOwnId,Y<O||(Y=M),f.nextOwnId=Y+1):(Y>=O&&(Y=M),f.nextId=Y+1);let X=B.highByte=Y>=96&&T?Y-96>>5:-1;j[em]=Y,f[Y-64]=B,Y<M?(B.isShared=!0,f.sharedLength=Y-63,o=!0,X>=0?(Se[he++]=(Y&31)+96,Se[he++]=X):Se[he++]=Y):(X>=0?(Se[he++]=213,Se[he++]=114,Se[he++]=(Y&31)+96,Se[he++]=X):(Se[he++]=212,Se[he++]=114,Se[he++]=Y),G&&(D+=z*G),I.length>=P&&(I.shift()[em]=0),I.push(j),k(B))}for(let X=0,$=B.length;X<$;X++)k(F[B[X]])},R=F=>{let B;if(F>16777216){if(F-a>ZI)throw new Error("Packed buffer would be larger than maximum buffer size");B=Math.min(ZI,Math.round(Math.max((F-a)*(F>67108864?1.25:2),4194304)/4096)*4096)}else B=(Math.max(F-a<<2,Se.length-1)>>12)+1<<12;let N=new Vw(B);return ri=new DataView(N.buffer,0,B),Se.copy?Se.copy(N,0,a,F):N.set(Se.slice(a,F)),he-=a,a=0,To=N.length-10,Se=N}}useBuffer(r){Se=r,ri=new DataView(Se.buffer,Se.byteOffset,Se.byteLength),he=0}};Uw=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,$p];Gv=[{pack(r,a,n){let o=r.getTime()/1e3;if((this.useTimestamp32||r.getMilliseconds()===0)&&o>=0&&o<4294967296){let{target:f,targetView:y,position:x}=a(6);f[x++]=214,f[x++]=255,y.setUint32(x,o)}else if(o>0&&o<17179869184){let{target:f,targetView:y,position:x}=a(10);f[x++]=215,f[x++]=255,y.setUint32(x,r.getMilliseconds()*4e6+(o/1e3/4294967296>>0)),y.setUint32(x+4,o)}else if(isNaN(o)){if(this.onInvalidDate)return a(0),n(this.onInvalidDate());let{target:f,targetView:y,position:x}=a(3);f[x++]=212,f[x++]=255,f[x++]=255}else{let{target:f,targetView:y,position:x}=a(15);f[x++]=199,f[x++]=12,f[x++]=255,y.setUint32(x,r.getMilliseconds()*1e6),y.setBigInt64(x+4,BigInt(Math.floor(o)))}}},{pack(r,a,n){let o=Array.from(r),{target:f,position:y}=a(this.structuredClone?3:0);this.structuredClone&&(f[y++]=212,f[y++]=115,f[y++]=0),n(o)}},{pack(r,a,n){let{target:o,position:f}=a(this.structuredClone?3:0);this.structuredClone&&(o[f++]=212,o[f++]=101,o[f++]=0),n([r.name,r.message])}},{pack(r,a,n){let{target:o,position:f}=a(this.structuredClone?3:0);this.structuredClone&&(o[f++]=212,o[f++]=120,o[f++]=0),n([r.source,r.flags])}},{pack(r,a){this.structuredClone?JI(r,16,a):$I(jv?Buffer.from(r):new Uint8Array(r),a)}},{pack(r,a){let n=r.constructor;n!==eD&&this.structuredClone?JI(r,Fw.indexOf(n.name),a):$I(r,a)}},{pack(r,a){let{target:n,position:o}=a(1);n[o]=193}}];function JI(r,a,n,o){let f=r.byteLength;if(f+1<256){var{target:y,position:x}=n(4+f);y[x++]=199,y[x++]=f+1}else if(f+1<65536){var{target:y,position:x}=n(5+f);y[x++]=200,y[x++]=f+1>>8,y[x++]=f+1&255}else{var{target:y,position:x,targetView:b}=n(7+f);y[x++]=201,b.setUint32(x,f+1),x+=4}y[x++]=116,y[x++]=a,y.set(new Uint8Array(r.buffer,r.byteOffset,r.byteLength),x)}function $I(r,a){let n=r.byteLength;var o,f;if(n<256){var{target:o,position:f}=a(n+2);o[f++]=196,o[f++]=n}else if(n<65536){var{target:o,position:f}=a(n+3);o[f++]=197,o[f++]=n>>8,o[f++]=n&255}else{var{target:o,position:f,targetView:y}=a(n+5);o[f++]=198,y.setUint32(f,n),f+=4}o.set(r,f)}function cq(r,a,n,o){let f=r.length;switch(f){case 1:a[n++]=212;break;case 2:a[n++]=213;break;case 4:a[n++]=214;break;case 8:a[n++]=215;break;case 16:a[n++]=216;break;default:f<256?(a[n++]=199,a[n++]=f):f<65536?(a[n++]=200,a[n++]=f>>8,a[n++]=f&255):(a[n++]=201,a[n++]=f>>24,a[n++]=f>>16&255,a[n++]=f>>8&255,a[n++]=f&255)}return a[n++]=o,a.set(r,n),n+=f,n}function uq(r,a){let n,o=a.length*6,f=r.length-o;for(a.sort((y,x)=>y.offset>x.offset?1:-1);n=a.pop();){let y=n.offset,x=n.id;r.copyWithin(y+o,y,f),o-=6;let b=y+o;r[b++]=214,r[b++]=105,r[b++]=x>>24,r[b++]=x>>16&255,r[b++]=x>>8&255,r[b++]=x&255,f=y}return r}function Pl(r){if(r.Class){if(!r.pack&&!r.write)throw new Error("Extension has no pack or write function");if(r.pack&&!r.type)throw new Error("Extension has no type (numeric code to identify the extension)");Uw.unshift(r.Class),Gv.unshift(r)}QI(r)}var tD=new zc({useRecords:!1});tD.pack;tD.pack;var rD=512,yq=1024,iD=new zc({structuredClone:!0});Pl({Class:Ze.prototype.constructor,type:1,write(r){return{...r}},read(r){return Object.setPrototypeOf(r,Ze.prototype),r}});Pl({Class:Ue.prototype.constructor,type:2,write(r){return[...r]},read(r){return Object.setPrototypeOf(r,Ue.prototype),r}});Pl({Class:vr.prototype.constructor,type:3,write(r){return[...r]},read(r){return Object.setPrototypeOf(r,vr.prototype),r}});Pl({Class:Zp.prototype.constructor,type:4,write(r){return r.id},read(r){return new Zp(r)}});Pl({Class:Jp.prototype.constructor,type:5,write(r){return r.data},read(r){return new Jp(r)}});Pl({Class:xr.prototype.constructor,type:6,write(r){return{...r}},read(r){return Object.setPrototypeOf(r,xr.prototype),r}});function vq(r){var a=0;if(r.length===0)return a;for(let n=0;n<r.length;n++){let o=r[n];a=(a<<5)-a+o,a=a&a}return a}function zw(r){if(zh(r))return r;if(Array.isArray(r))return r.map(zw);if(typeof r=="object"&&r!==null){let a={};for(let n of Object.keys(r).sort())a[n]=zw(r[n]);return Object.setPrototypeOf(a,Object.getPrototypeOf(r)),a}else return r}var Hv;(r=>{function a(f){return iD.pack(f)}r.serialize=a;function n(f){return iD.unpack(f)}r.deserialize=n;function o(f){return vq(a(zw(f))).toString()}r.checksum=o})(Hv||(Hv={}));var nD;(r=>{function a(o){return o.type==="Conditional"?o.condition.type==="Distance"?"Distance":"StateChange":o.type}r.toEventUIType=a;function n(o){return o==="Distance"||o==="StateChange"?"Conditional":o}r.fromEventUIType=n})(nD||(nD={}));function Gw(r){return r==="MouseDown"||r==="MouseUp"||r==="KeyDown"||r==="KeyUp"||r==="Collision"||r==="Trigger"}var Yi={LookAt:[],Follow:["Create"],DragDrop:["Transition","Animation","Audio","Particles","Create","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseHover:["Transition","Animation","Particles","Create","Destroy","SwitchCamera","SceneTransition","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Scroll:["Transition","Animation","Create","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Start:["Transition","Animation","Audio","Particles","Video","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Conditional:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseDown:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseUp:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MousePress:["Transition","Animation","Audio","Particles","Video","Link","Create","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyDown:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyUp:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyPress:["Transition","Animation","Audio","Particles","Video","Link","Create","SwitchCamera","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],GameControl:["Transition","Animation","Audio","Particles","Create","Conditional"],Collision:["Transition","Animation","Audio","Particles","Video","Create","Destroy","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Trigger:["Transition","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Resize:["Transition","Animation","Audio","Particles","Video","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],VariableChange:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],API:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],WEBHOOK:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],AIAssistantListener:["SetVariable"],AIAssistantTrigger:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"]},sD;(r=>{function a(o){return o.type==="MouseDown"||o.type==="MouseUp"||o.type==="MousePress"||o.type==="KeyDown"||o.type==="KeyUp"||o.type==="KeyPress"}r.is=a;function n(o){return o==="MouseDown"||o==="MouseUp"||o==="MousePress"?{type:o,mode:"Object",disabled:!1,actions:new Ue}:{type:o,disabled:!1,key:void 0,actions:new Ue}}r.defaultData=n})(sD||(sD={}));var Wv;(r=>{function a(n){return{type:"Property",value:[n??null,"position","x"]}}r.propertyDefaultData=a,r.valueDefaultData={type:"Literal",value:0}})(Wv||(Wv={}));var kw;(r=>{function a(f){return{type:"Comparison",operator:"==",lOperand:Wv.propertyDefaultData(f),rOperand:{...Wv.valueDefaultData}}}r.comparisonDefaultData=a;function n(f){return{type:"Distance",toObject:f??null,fromObject:f??null,distance:200}}r.distanceDefaultData=n;function o(f,y){return{type:"State",object:f??null,state:y??null}}r.stateDefaultData=o})(kw||(kw={}));var oD;(r=>{function a(n){return n.find(o=>o==="ifActions"||o==="elseActions")!==void 0}r.isConditionalSubActions=a})(oD||(oD={}));var aD;(r=>{function a(o){return o.type==="Conditional"}r.is=a;function n(o){return{type:"Conditional",disabled:!1,inActions:new Ue,outActions:new Ue,condition:kw.distanceDefaultData(o)}}r.defaultData=n})(aD||(aD={}));var lD;(r=>r.defaultData={type:"DragDrop",cursor:"hand",disabled:!1,dampingFactor:1,objects:[],snapTo:"center",snapSurfaceMode:"bbox",snapSurfaceOffset:0,dropOn:"all",autoOrient:!0,dropDestinations:[],plane:"adaptive",planeMode:"locked",referenceFrame:"global",limits:[-1/0,1/0,-1/0,1/0,-1/0,1/0],drop:!1,resetOnSnapFail:!1,snapSpeed:20,resetSpeed:20,dragDropActions:{drag:new Ue,drop:new Ue}})(lD||(lD={}));var qv;(r=>r.defaultData={type:"Follow",disabled:!1,maxDelta:0,dampingFactor:1,target:"cursor",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledTranslation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5,actions:new Ue})(qv||(qv={}));var Xv;(r=>r.defaultData={type:"LookAt",disabled:!1,distance:1e3,dampingFactor:1,target:"cursor",tilt:"up",axis:"z",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledRotation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5})(Xv||(Xv={}));var cD;(r=>{function a(o){return o.type==="MouseHover"}r.is=a;function n(){return{type:"MouseHover",disabled:!1,actions:new Ue}}r.defaultData=n})(cD||(cD={}));var uD;(r=>{function a(o){return o.type==="Scroll"}r.is=a;function n(){return{type:"Scroll",disabled:!1,steps:100,trigger:"load",startFrom:"enter",enterAnchor:"top",startOffset:0,endAfter:400,actions:new Ue}}r.defaultData=n})(uD||(uD={}));var hD;(r=>{function a(o){return o.type==="Start"}r.is=a;function n(){return{type:"Start",disabled:!1,actions:new Ue}}r.defaultData=n})(hD||(hD={}));var dD;(r=>{function a(o){return o.type==="Collision"}r.is=a;function n(){return{type:"Collision",disabled:!1,target:"character",actions:new Ue}}r.defaultData=n})(dD||(dD={}));var fD;(r=>{function a(o){return o.type==="Trigger"}r.is=a;function n(o,f){return{type:"Trigger",disabled:!1,target:"all",triggeringObjects:[],actions:new Ue,triggerZone:"box",position:f.toArray(),rotation:[0,0,0],size:o.toArray(),radius:o.length()/2,helperVisible:!0}}r.defaultData=n})(fD||(fD={}));var Yv;(r=>{r.defaultSizes={mobile:[480,480],tablet:[768,768],desktop:[1200,1200],custom:[769,1200]};function a(x){return x.type==="Resize"}r.is=a;function n(x){return typeof x=="string"?x:"custom"}r.sizeToDevice=n;function o(x){return typeof x=="string"?[...r.defaultSizes[x]]:[...x]}r.deviceToSize=o;function f(){let x={size:"mobile",operator:"<",actions:new Ue},b={size:"tablet",operator:"<",actions:new Ue},_={size:[...r.defaultSizes.custom],operator:"<>",actions:new Ue},S=new Ue;return S.push({id:we.generateUUID(),fi:0,data:x},{id:we.generateUUID(),fi:1,data:b},{id:we.generateUUID(),fi:2,data:_}),{type:"Resize",disabled:!1,orientation:"horizontal",breakpoints:S}}r.defaultData=f;function y(){return{size:[...r.defaultSizes.custom],operator:"<>",actions:new Ue}}r.defaultBreakpointData=y})(Yv||(Yv={}));var Kv;(r=>{r.propertyPaths={Position:["position"],"Position X":["position","x"],"Position Y":["position","y"],"Position Z":["position","z"],Rotation:["rotation"],"Rotation X":["rotation","x"],"Rotation Y":["rotation","y"],"Rotation Z":["rotation","z"],Scale:["scale"],"Scale X":["scale","x"],"Scale Y":["scale","y"],"Scale Z":["scale","z"],Width:["width"],Height:["height"],Depth:["depth"],"Mouse Position X":["mouse","x"],"Mouse Position Y":["mouse","y"],"Mouse Pressed":["mouse","pressed"],"Screen Width":["mouse","width"],"Screen Height":["mouse","height"],"Hit Position X":["raycast","x"],"Hit Position Y":["raycast","y"],"Hit Position Z":["raycast","z"],"Hit Object Position X":["raycast","objX"],"Hit Object Position Y":["raycast","objY"],"Hit Object Position Z":["raycast","objZ"]};function a(o){return o.type==="VariableChange"}r.is=a;function n(){return{disabled:!1,type:"VariableChange",actions:new Ue,variableId:"",objectId:null,property:"Position X"}}r.defaultData=n})(Kv||(Kv={}));var pD;(r=>{function a(o){return o.type==="API"}r.is=a;function n(){return{disabled:!1,type:"API",successActions:new Ue,errorActions:new Ue,userAPIId:""}}r.defaultData=n})(pD||(pD={}));var mD;(r=>{function a(o){return o.type==="WEBHOOK"}r.is=a;function n(){return{disabled:!1,type:"WEBHOOK",actions:new Ue,userWebhookId:""}}r.defaultData=n})(mD||(mD={}));var gD;(r=>{function a(o){return o.type==="AIAssistantListener"}r.is=a;function n(){return{disabled:!1,type:"AIAssistantListener",actions:new Ue,analysis:"average",analysisRange:[0,71],analysisSingle:0}}r.defaultData=n})(gD||(gD={}));var yD;(r=>{function a(o){return o.type==="AIAssistantTrigger"}r.is=a;function n(){return{disabled:!1,description:"",type:"AIAssistantTrigger",actions:new Ue}}r.defaultData=n})(yD||(yD={}));var fs="personal camera",Il="a218fcc3-276b-49b9-b485-49037fd14f5f",xD=2960946,ni=5526619,zs;(r=>{function a(M,O){return M[0]===O[0]&&M[1]===O[1]}r.isEqual=a;function n(M,O,I){return[M[0]+(O[0]-M[0])*I,M[1]+(O[1]-M[1])*I]}r.lerp=n;function o(M,O){return[M[0]+O[0],M[1]+O[1]]}r.add=o;function f(M,O){return[M[0]-O[0],M[1]-O[1]]}r.sub=f;function y(M,O){return[M[0]*O[0],M[1]*O[1]]}r.multiply=y;function x(M,O){return[M[0]/O[0],M[1]/O[1]]}r.divide=x;function b(M,O){return Math.pow(O[0]-M[0],2)+Math.pow(O[1]-M[1],2)}r.distanceSquared=b;function _(M,O){return Math.sqrt(b(M,O))}r.distance=_;function S(M,O){return M[0]*O[0]+M[1]*O[1]}r.dot=S;function A(M,O){return[M[0]*O,M[1]*O]}r.scalarMultiply=A;function C(M,O,I){let D=r.sub(O,M),z=r.sub(I,M),k=r.dot(D,z)/r.dot(D,D),L=r.scalarMultiply(D,k);return r.add(M,L)}r.projectionOnto=C;function P(M,O,I){return _(M,C(M,O,I))}r.projectionOntoDistance=P;function T(M,O){return[(M[0]+O[0])*.5,(M[1]+O[1])*.5]}r.center=T})(zs||(zs={}));var Co;(r=>{function a(_,S){return _[0]===S[0]&&_[1]===S[1]&&_[2]===S[2]}r.isEqual=a;function n(_,S){return[_[0]+S[0],_[1]+S[1],_[2]+S[2]]}r.add=n;function o(_,S){return[_[0]-S[0],_[1]-S[1],_[2]-S[2]]}r.sub=o;function f(_,S){return[_[0]/S[0],_[1]/S[1],_[2]/S[2]]}r.div=f;function y(_,S){return[_[0]*S[0],_[1]*S[1],_[2]*S[2]]}r.mul=y;function x(_,S){return Math.hypot(_[0]-S[0],_[1]-S[1],_[2]-S[2])}r.dist=x;function b(_,S,A){return[_[0]+(S[0]-_[0])*A,_[1]+(S[1]-_[1])*A,_[2]+(S[2]-_[2])*A]}r.lerp=b})(Co||(Co={}));var tm;(r=>{function a(o,f){return o[0]===f[0]&&o[1]===f[1]&&o[2]===f[2]&&o[3]===f[3]}r.isEqual=a;function n(o,f,y){return[o[0]+(f[0]-o[0])*y,o[1]+(f[1]-o[1])*y,o[2]+(f[2]-o[2])*y,o[3]+(f[3]-o[3])*y]}r.lerp=n})(tm||(tm={}));var vD;(r=>{let a=180/Math.PI,n=Math.PI/180;function o(b){return typeof b=="number"?b*a:b}function f(b){return typeof b=="number"?b*n:b}function y(b){return[o(b[0]),o(b[1]),o(b[2])]}r.radToDeg=y;function x(b){return[f(b[0]),f(b[1]),f(b[2])]}r.degToRad=x})(vD||(vD={}));var _l;(r=>{r.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function a(f,y){for(let x=0;x<16;x++)if(f[x]!==y[x])return!1;return!0}r.isEqual=a;function n(f){return f??r.identity}r.simplify=n;function o(f,y){let x=y.slice(0);for(var b=0,_=y.length;b<_;b+=3){let S=f[3]*y[b]+f[7]*y[b+1]+f[11]*y[b+2]+f[15];x[b]=(f[0]*y[b]+f[4]*y[b+1]+f[8]*y[b+2]+f[12])/S,x[b+1]=(f[1]*y[b]+f[5]*y[b+1]+f[9]*y[b+2]+f[13])/S,x[b+2]=(f[2]*y[b]+f[6]*y[b+1]+f[10]*y[b+2]+f[14])/S}return x}r.applyMatrix4=o})(_l||(_l={}));var ii;(r=>{function a(S){return typeof S=="object"&&typeof S.r=="number"&&typeof S.g=="number"&&typeof S.b=="number"}r.isRGB=a,r.white={r:1,g:1,b:1},r.red={r:1,g:0,b:0},r.black={r:0,g:0,b:0};function n(S){return{r:Math.round(S.r*255),g:Math.round(S.g*255),b:Math.round(S.b*255),a:1}}r.toRgb255a1=n;function o(S){return{r:S.r,g:S.g,b:S.b}}r.clone=o;function f(S){return S=Math.floor(S),{r:(S>>16&255)/255,g:(S>>8&255)/255,b:(S&255)/255}}r.fromHex=f;function y(S){return Math.round(S.r*255)*65536+Math.round(S.g*255)*256+Math.round(S.b*255)}r.toHex=y;function x(S,A){return S.r===A.r&&S.g===A.g&&S.b===A.b}r.equals=x;function b(S,A){return S.r.toFixed(2)===A.r.toFixed(2)&&S.g.toFixed(2)===A.g.toFixed(2)&&S.b.toFixed(2)===A.b.toFixed(2)}r.equalsFixed=b;function _(S,A,C){return{r:S.r+(A.r-S.r)*C,g:S.g+(A.g-S.g)*C,b:S.b+(A.b-S.b)*C}}r.lerp=_})(ii||(ii={}));var Tt;(r=>{r.white={...ii.white,a:1},r.transparent={...ii.white,a:0};function a(_){return{r:_[0],g:_[1],b:_[2],a:_[3]}}r.from0to1=a;function n(_,S){return{...ii.fromHex(_),a:S}}r.fromHexAndA=n;function o(_){return{r:Math.round(_.r*255),g:Math.round(_.g*255),b:Math.round(_.b*255),a:_.a}}r.toRgb255a1=o;function f(_,S){return ii.equals(_,S)&&_.a===S.a}r.equals=f;function y(_,S){return ii.equalsFixed(_,S)&&_.a.toFixed(2)===S.a.toFixed(2)}r.equalsFixed=y;function x(_,S,A){return{r:_.r+(S.r-_.r)*A,g:_.g+(S.g-_.g)*A,b:_.b+(S.b-_.b)*A,a:_.a+(S.a-_.a)*A}}r.lerp=x;function b({r:_,g:S,b:A,a:C}=r.white){return`rgba(${_*255}, ${S*255}, ${A*255}, ${C})`}r.toStyle=b})(Tt||(Tt={}));var Qv;(r=>r.identity={position:[0,0,0],rotation:[0,0,0],scale:[1,1,1]})(Qv||(Qv={}));var rm=(r=>(r[r.LINEAR=0]="LINEAR",r[r.EASE=1]="EASE",r[r.EASE_IN=2]="EASE_IN",r[r.EASE_OUT=3]="EASE_OUT",r[r.EASE_IN_OUT=4]="EASE_IN_OUT",r[r.CUBIC=5]="CUBIC",r[r.SPRING=6]="SPRING",r))(rm||{}),Zv;(r=>r.defaultData={mass:1,stiffness:80,damping:10,velocity:0})(Zv||(Zv={}));var Jv;(r=>r.defaultData={control1:[.5,0],control2:[.5,1]})(Jv||(Jv={}));var Sa;(r=>(r.linear=[0,0,1,1],r.ease=[.25,.1,.25,1],r.easeIn=[.42,0,1,1],r.easeOut=[0,0,.58,1],r.easeInOut=[.42,0,.58,1]))(Sa||(Sa={}));function jw(r){return typeof r=="string"&&r.length===36?/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(r):!1}var ks;(r=>{r.all=["PerspectiveCamera","OrthographicCamera"];function a(n){return r.all.includes(n)}r.is=a})(ks||(ks={}));var Dl;(r=>{r.DefaultUp=[0,1,0],r.DefaultTargetOffset=1e3,r.defaultData={far:1e5,type:"OrthographicCamera",perspective:{near:70,fov:45,zoom:1},orthographic:{near:-1e5,zoom:1},up:r.DefaultUp,isUpVectorFlipped:!1,targetOffset:r.DefaultTargetOffset};function a(n){var o,f;return n.type==="PerspectiveCamera"?((o=n.perspective)==null?void 0:o.zoom)??1:((f=n.orthographic)==null?void 0:f.zoom)??1}r.getZoom=a})(Dl||(Dl={}));var Po;(r=>{function a(o,f=.1){return{disabled:!1,type:"linear",hideBase:!1,count:3,radial:{radius:Math.max(o[0],o[1])*2,start:0,end:360,alignment:!1,axis:"y",scale:[1,1,1],rotation:[0,0,0],position:[0,0,0]},toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},linear:{scale:[1,1,1],rotation:[0,0,0],position:[o[0]+o[0]*f,0,0]},grid:{count:[2,2,2],size:o.map(y=>y*(1+f)),useCenter:!0},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}}}r.defaultData=a;function n(o,f){let y={...o};if(Hw.forEach(x=>{Object.assign(y,{[x]:f[x]??o[x]})}),y.radial={...o.radial},f.radial){let x=o.radial,b=f.radial;Ww.forEach(_=>{Object.assign(y.radial,{[_]:b[_]??x[_]})})}if(y.linear={...o.linear},f.linear){let x=o.linear,b=f.linear;qw.forEach(_=>{Object.assign(y.linear,{[_]:b[_]??x[_]})})}if(y.grid={...o.grid},f.grid){let x=o.grid,b=f.grid;Xw.forEach(_=>{Object.assign(y.grid,{[_]:b[_]??x[_]})})}if(y.toObject={...o.toObject},f.toObject){let x=o.toObject,b=f.toObject;Yw.forEach(_=>{Object.assign(y.toObject,{[_]:b[_]??x[_]})})}if(y.randomnessObject={...o.randomnessObject},f.randomnessObject){let x=o.randomnessObject,b=f.randomnessObject;Kw.forEach(_=>{Object.assign(y.randomnessObject,{[_]:b[_]??x[_]})})}return y}r.merge=n})(Po||(Po={}));var $v;(r=>{r.defaultData={radial:{},linear:{},grid:{},toObject:{},randomnessObject:{}};let a=["radial","linear","grid","toObject","randomnessObject"];function n(o,f){let y=[];o.count!==void 0&&y.push({type:0,path:f,props:{count:o.count}});for(let x of a){let b=o[x];b&&Object.keys(b).length>0&&y.push({type:0,path:[...f,x],props:b})}return y}r.toOps=n})($v||($v={}));var Hw=["count"],Ww=["radius","start","end","position","scale","rotation"],qw=["position","scale","rotation"],Xw=["count","size"],Yw=["count","position","scale","rotation"],Kw=["strength","scale","rotation","position","movement","seed","freqScale"],e0;(r=>{r.all=["PointLight","SpotLight","DirectionalLight","HemisphereLight"];function a(n){return r.all.includes(n)}r.is=a})(e0||(e0={}));var t0;(r=>{function a(o){return n(o)}r.defaultData=a;function n(o){if(o==="PointLight")return{type:o,color:Tt.white,intensity:1,distance:2e3,decay:1,shadows:!0,shadowResolution:1024,shadowRadius:1,penumbraSize:.5,depth:1e5};if(o==="SpotLight")return{type:o,color:Tt.white,intensity:1,distance:2e3,decay:1,shadows:!0,penumbra:0,angle:30/180*Math.PI,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};if(o==="DirectionalLight")return{type:o,color:Tt.white,intensity:1,shadows:!0,size:2e3,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};throw new Error("not implemented")}})(t0||(t0={}));var Xh;(r=>(r.defaultShapeData={type:"PlaneEmitterShape",size:[100,100,100]},r.defaultCollisionData={colliderEntityId:null,collisionBounce:.75},r.defaultData={renderMaterial:{type:"particleMaterial",color:{r:1,g:.2,b:.545,a:1},color2:{r:.945,g:.714,b:.184,a:1},coloring:"gradient",ease:"linearFadeOut",easeSize:"linearFadeOut",transparent:!0,size:[40,40],texture:"pt_default_particle",spriteRotation:[0,0]},birthRatePerSec:50,gravity:1,noiseStrength:0,noiseScale:0,noiseSeed:1,noiseType:"curl",randomRotation:0,randomScale:.2,randomMass:.5,rootObjectType:"instancedMesh",life:1,direction:[0,0,0],directionMode:"axis",speed:10,shape:r.defaultShapeData,autoPlay:!0,emitTimeDelay:0,emitTimeCycle:"infinity",emitTimeDuration:1,...r.defaultCollisionData}))(Xh||(Xh={}));var Ol;(r=>r.defaultData={enabled:"visibility",fusedBody:!0,rigidBody:"positioned",density:1,pointMass:0,gravityScale:1,friction:.5,damping:0,restitution:.2,colliderType:"convex",enabledRotation:[!0,!0,!0],enabledTranslation:[!0,!0,!0]})(Ol||(Ol={}));var Qw;(r=>{r.defaultData={castShadow:!0,receiveShadow:!0};function a(n,o){return n.castShadow===o.castShadow&&n.receiveShadow===o.receiveShadow}r.equals=a})(Qw||(Qw={}));var Zw;(r=>{r.defaultData={flatShading:!1,wireframe:!1,side:0};function a(n,o){return n.flatShading===o.flatShading&&n.side===o.side&&n.wireframe===o.wireframe}r.equals=a})(Zw||(Zw={}));var r0;(r=>r.defaultData={...Zw.defaultData,...Qw.defaultData})(r0||(r0={}));var bD;(r=>{function a(n,o){var y,x;let f=[];if("material"in n){let b=typeof n.material=="string"?o.materials[n.material]??((y=o.lib.materials[n.material])==null?void 0:y.asset):n.material;b&&f.push(b)}else if("materials"in n)for(let b of n.materials){let _=typeof b=="string"?o.materials[b]??((x=o.lib.materials[b])==null?void 0:x.asset):b;_&&f.push(_)}return f}r.getMaterialData=a})(bD||(bD={}));var Yh;(r=>(r.defaultVideo={data:"",thumb:"/_assets/_videos/catThumb.png",type:"video",name:"Cat video"},r.maxSize=3e7))(Yh||(Yh={}));var SD;(r=>{function a(n){return n==="texture"||n==="video"||n==="color"||n==="depth"||n==="normal"||n==="gradient"||n==="noise"||n==="fresnel"||n==="rainbow"||n==="toon"||n==="outline"||n==="particle"||n==="transmission"||n==="matcap"||n==="displace"||n==="pattern"||n==="light"}r.is=a})(SD||(SD={}));function AD(r){return r.type!=="displace"}var wD;(r=>{function a(n){return n==="phong"||n==="toon"||n==="lambert"||n==="physical"}r.is=a})(wD||(wD={}));var i0=["mode","gradientType","noiseType","displacementType","projection","cnormal","crop","axis","side"],ED=["wrapping","image","video","name","minFilter","magFilter"],Wr;(r=>{function a(y,x){let{texture:b,..._}=x;if(Object.assign(y,_),b){let S=y.texture;S&&Object.assign(S,b)}}r.patch=a;function n(y,x){return y==="light"&&x?o(x):f(y)}r.defaultData=n;function o(y){let x={mode:0,isMask:!1,visible:!0,bumpMap:void 0,bumpMapIntensity:5,roughnessMap:void 0,alphaOverride:1};switch(y){case"phong":return{...x,category:"phong",specular:{r:.2,g:.2,b:.2},shininess:5,type:"light",visible:!0,mode:0,occlusion:!0,alpha:.6};case"toon":return{...x,category:"toon",specular:{r:.2,g:.2,b:.2},shininess:10,type:"light",alpha:1};case"lambert":return{...x,category:"lambert",emissive:{r:0,g:0,b:0},type:"light",alpha:1,visible:!0,mode:0,occlusion:!0};case"physical":return{...x,category:"physical",roughness:.2,metalness:.2,reflectivity:.2,type:"light",alpha:1,visible:!0,mode:0,occlusion:!0}}}function f(y){let x={alpha:1,mode:0,isMask:!1,visible:!0};switch(y){case"texture":return{...x,type:"texture",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{image:"image_0",wrapping:1e3,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006},crop:!1};case"video":return{...x,type:"video",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{video:Yh.defaultVideo,wrapping:1001,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006},crop:!1};case"color":return{...x,type:"color",color:ii.fromHex(ni)};case"depth":return{...x,type:"depth",gradientType:1,smooth:!1,isVector:!0,isWorldSpace:!1,origin:[0,0,0],direction:[1,0,0],colors:[[1,1,1,1],[0,0,0,1]],steps:[0,1],near:50,far:200};case"normal":return{...x,type:"normal",cnormal:[1,1,1]};case"gradient":return{...x,type:"gradient",gradientType:0,smooth:!1,colors:[[0,0,0,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,1,1,1,1,1,1,1,1,1],num:2,angle:0,offset:[0,0],morph:[0,0]};case"noise":return{...x,type:"noise",size:[100,100,100],noiseType:0,scale:1,move:1,colorA:{...ii.fromHex(6710886),a:1},colorB:{...ii.fromHex(6710886),a:1},colorC:{...ii.fromHex(16777215),a:1},colorD:{...ii.fromHex(16777215),a:1},distortion:[1,1],fA:[1.7,9.2],fB:[8.3,2.8],voronoiStyle:0,highCut:1,lowCut:0,smoothness:.3,seed:0,quality:1};case"fresnel":return{...x,type:"fresnel",color:Tt.fromHexAndA(16777215,1),bias:.1,scale:1,intensity:2,factor:1};case"rainbow":return{...x,type:"rainbow",filmThickness:30,movement:0,wavelengths:[0,0,0],noiseStrength:0,noiseScale:1,offset:[0,0,0]};case"toon":return{...x,type:"toon",positioning:2,colors:[[0,0,0,1],[.5,.5,.5,1],[.5,.5,.5,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,.475,.525,1,1,1,1,1,1,1],num:4,source:[0,1e3,0],isWorldSpace:!0,noiseStrength:0,noiseScale:1,shadowColor:Tt.fromHexAndA(0,0),offset:[0,0,0]};case"outline":return{...x,type:"outline",outlineColor:Tt.fromHexAndA(0,1),contourColor:Tt.fromHexAndA(0,1),outlineWidth:2,contourWidth:5,outlineThreshold:.4,contourThreshold:0,outlineSmoothing:0,contourFrequency:10,contourDirection:[0,1,0],positionalLines:!1,compensation:!0};case"matcap":return{...x,type:"matcap",texture:{image:"matcap_0",wrapping:1001,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006}};case"transmission":return{...x,type:"transmission",thickness:10,ior:1.5,roughness:1};case"displace":return{visible:!0,type:"displace",displacementType:"noise",noiseType:0,scale:10,movement:1,offset:[0,0,0],intensity:8,voronoiStyle:0,smoothness:.3,seed:0,highCut:1,lowCut:0,quality:1};case"pattern":return{...x,type:"pattern",style:0,projection:0,axis:"y",blending:0,offset:[0,0],colorA:{...ii.fromHex(0),a:1},colorB:{...ii.fromHex(16777215),a:1},frequency:[10,10],size:.5,variation:0,smoothness:.5,zigzag:0,rotation:0,vertical:[0,1],horizontal:[0,1],sides:6}}}})(Wr||(Wr={}));var qr;(r=>{function a(A){return!A.layers.some(C=>C.data.type==="texture"&&C.data.projection!==0||C.data.type==="depth"&&!C.data.isWorldSpace||C.data.type==="noise"||C.data.type==="displace")}r.isMergable=a;function n(A){let C="";return A.layers.forEach(P=>{Object.entries(P.data).forEach(([T,M])=>{C+=`${T}${M}`,Array.isArray(M)?M.forEach(O=>C+=`${O}`):typeof M=="object"?Object.values(M).forEach(O=>{typeof O=="number"?C+=`${O.toFixed(4)}`:C+=`${O}`}):C+=`${M}`})}),C}r.getHash=n;function o(){return{layers:new Ue}}r.defaultEmptyData=o;function f(A="layer1",C="layer2"){return x("phong",A,C)}r.defaultData=f;function y(A,C){return{...A,name:C}}r.withName=y;function x(A,C="layer1",P="layer2"){let T=new Ue;return T.push({fi:0,data:Wr.defaultData("light",A),id:C}),T.push({fi:1,data:Wr.defaultData("color"),id:P}),{layers:T}}r.defaultTwoLayerData=x;function b(A){let C=Wr.defaultData("texture");A&&Object.assign(C.texture,{image:A});let P=new Ue;return P.push({fi:0,data:C,id:"layer1"}),P.push({fi:1,data:{...Wr.defaultData("transmission"),alpha:1},id:"layer2"}),P.push({fi:2,data:{...Wr.defaultData("light","lambert"),alpha:0},id:"layer3"}),{layers:P}}r.defaultUIObjectMaterial=b;function _(A,C="phong",P="layer1",T="layer2"){let M=Wr.defaultData("texture");Object.assign(M.texture,{image:A});let O=new Ue;return O.push({fi:0,data:M,id:P}),O.push({fi:1,data:Wr.defaultData("light",C),id:T}),{layers:O}}r.defaultTwoLayerTextureData=_;function S(A,C="phong",P="layer1",T="layer2"){let M=Wr.defaultData("video");Object.assign(M.texture,{video:A});let O=new Ue;return O.push({fi:0,data:M,id:P}),O.push({fi:1,data:Wr.defaultData("light",C),id:T}),{layers:O}}r.defaultTwoLayerVideoTextureData=S})(qr||(qr={}));var Kh;(r=>{function a(){return{points:new Ue,roundness:0,shapeHoles:[],isClosed:!1}}r.defaultData=a})(Kh||(Kh={}));var Qh;(r=>{function a(){return{points:new Ue,lastInsertionPlane:null,subdivisions:12,isClosed:!1}}r.defaultData=a})(Qh||(Qh={}));var Jw={type:"Ellipse",width:50,height:50,spikes:16,angle:360,innerRadius:0},n0;(r=>{function a(n,o){let f={...n};return $w.forEach(y=>{Object.assign(f,{[y]:o[y]??n[y]})}),f}r.merge=a})(n0||(n0={}));var s0={shape:Jw,depth:1,offset:0,bevel:50,bevelSides:6,angle:0,twist:0,startScale:1,endScale:1,capType:"flat"},$w=["depth","offset","angle","twist","startScale","endScale"],im;(r=>{function a(o){return o==="PolygonGeometry"||o==="RectangleGeometry"||o==="StarGeometry"||o==="TriangleGeometry"||o==="EllipseGeometry"||o==="UIGeometry"}r.is2DParametricMesh=a;function n(o){return o==="PolygonGeometry"||o==="PolygonGeometry"||o==="RectangleGeometry"||o==="StarGeometry"||o==="TriangleGeometry"||o==="EllipseGeometry"||o==="PathGeometry"||o==="VectorGeometry"||o==="ConeGeometry"||o==="CubeGeometry"||o==="CylinderGeometry"||o==="DodecahedronGeometry"||o==="HelixGeometry"||o==="IcosahedronGeometry"||o==="LatheGeometry"||o==="PyramidGeometry"||o==="SphereGeometry"||o==="PlaneGeometry"||o==="BackdropGeometry"||o==="TorusGeometry"||o==="TorusKnotGeometry"||o==="BooleanGeometry"||o==="TextGeometry"||o==="InputGeometry"}r.isParametricMesh=n})(im||(im={}));var o0;(r=>{function a(n,o){let f={...n};return Object.assign(f,o),f.type==="PathGeometry"&&"extrusion"in o&&o.extrusion&&(f.extrusion={...n.extrusion},Object.assign(f.extrusion,n0.merge(f.extrusion,o.extrusion))),f}r.merge=a})(o0||(o0={}));var _o;(r=>{function a(n){if(n==="RectangleGeometry")return{width:320,height:320,type:n,cornerRadius:[0,0,0,0],cornerType:0,depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(n==="UIGeometry")return{type:n,frame:"",cornerRadius:[0,0,0,0],cornerType:0,width:1,height:1};if(n==="PathGeometry")return{type:n,width:1,height:1,depth:1,path:Qh.defaultData(),extrusion:s0};if(n==="VectorGeometry")return{width:1,height:1,type:n,subdivisions:12,shape:Kh.defaultData(),depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(n==="BooleanGeometry")return{type:n,operation:2,width:0,height:0,depth:0,phongAngle:35};if(n==="ShapeBlendGeometry")return{type:n,width:0,height:0,depth:0,resolutionLevel:6,blendRange:100,useChildrenColors:!1};if(n==="TextGeometry")return{type:n,width:100,height:100,depth:0,horizontalAlign:1,verticalAlign:1,fontSize:16,lineHeight:1.2,letterSpacing:0,text:{textValue:""},textTransform:1,font:"Roboto_regular",editable:!1,extrudeBevelSize:0,extrudeBevelSegments:1};if(n==="InputGeometry")return{...r.defaultData("TextGeometry"),type:n,editable:!0};if(n==="SphereGeometry")return{type:"SphereGeometry",width:100,height:100,depth:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180};throw new Error("not implemented")}r.defaultData=a})(_o||(_o={}));var a0=["width","height","depth"],l0;(r=>r.defaultData={enabled:!1,useBackgroundColor:!1,color:ii.white,near:.1,far:2e3})(l0||(l0={}));var Zh;(r=>{let a={opacity:1,blendFunction:13,enabled:!1};r.defaultData={enabled:!1,pixelation:{...a,blendFunction:16,granularity:15},bloom:{...a,blendFunction:16,intensity:1,blurScale:1,luminanceThreshold:.25,luminanceSmoothing:.025,kernelSize:3},chromaticAberration:{...a,offset:[2,2]},vignette:{...a,darkness:1,offset:0},hueSaturation:{...a,hue:3,saturation:0},brightnessContrast:{...a,brightness:.25,contrast:0},depthOfField:{...a,focusDistance:100,focalLength:20,bokehScale:5},noise:{...a,blendFunction:16}}})(Zh||(Zh={}));var eA;(r=>r.defaultData={softShadowQuality:"low"})(eA||(eA={}));var tA;(r=>r.defaultData={enabled:!0,color:{r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},intensity:.75})(tA||(tA={}));var rA;(r=>r.defaultData={occlusion:!1,aoFullRes:!1,radius:256,bias:.5,aoColor:{r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}})(rA||(rA={}));var Rl;(r=>r.defaultData={usePhysics:!1,gravity:-10})(Rl||(Rl={}));var iA;(r=>r.defaultData={playCamera:fs,gameControlObject:null})(iA||(iA={}));var c0;(r=>r.defaultData={backgroundColor:Tt.fromHexAndA(xD,1),postprocessing:Zh.defaultData,fog:l0.defaultData,globalPhysics:Rl.defaultData,ambient:tA.defaultData,ao:rA.defaultData,shadow:eA.defaultData,publish:iA.defaultData})(c0||(c0={}));var u0;(r=>r.defaultData={colliderType:"box",size:[100,100,100],colliderHelperVisible:!0,forceType:"collider",forceRange:"global",forceIntensity:.5,forceDambing:.95})(u0||(u0={}));var TD;(r=>{function a(o){return o==="Component"||o==="Instance"}r.isComponentRelated=a;function n(o){return o==="Empty"||o==="Instance"}r.isEmptyOrComponent=n})(TD||(TD={}));var Jh;(r=>{r.identity={...Qv.identity,hiddenMatrix:_l.identity};function a(f){return{position:f.position,rotation:f.rotation,scale:f.scale,hiddenMatrix:f.hiddenMatrix}}r.fromObject=a;function n(f,y){return{position:(y==null?void 0:y.position)||f.position,rotation:(y==null?void 0:y.rotation)||f.rotation,scale:(y==null?void 0:y.scale)||f.scale,hiddenMatrix:(y==null?void 0:y.hiddenMatrix)||f.hiddenMatrix}}r.merge=n;function o(f,y){return xv({position:Co.isEqual(f.position,y.position)?void 0:y.position,rotation:Co.isEqual(f.rotation,y.rotation)?void 0:y.rotation,scale:Co.isEqual(f.scale,y.scale)?null:y.scale,hiddenMatrix:_l.isEqual(f.hiddenMatrix,y.hiddenMatrix)?void 0:y.hiddenMatrix})}r.diff=o})(Jh||(Jh={}));var si;(r=>r.defaultData={states:new Ue,events:new Ue,visible:!0,raycastLock:!1,physics:Ol.defaultData,pathSnapping:{pathId:null,slide:0,offset:0,orientation:"tangential"},...Jh.identity,cloner:null})(si||(si={}));var h0;(r=>r.defaultData={type:"Empty",...si.defaultData})(h0||(h0={}));var MD;(r=>r.defaultData={type:"ParticleCollider",...u0.defaultData,...si.defaultData})(MD||(MD={}));var CD;(r=>r.defaultData={type:"Component",...si.defaultData})(CD||(CD={}));var PD;(r=>r.defaultData={type:"Particle",...si.defaultData,...Xh.defaultData})(PD||(PD={}));var wa;(r=>r.defaultData={type:"Mesh",...si.defaultData,...r0.defaultData})(wa||(wa={}));var kc;(r=>r.defaultData={...si.defaultData,...Jh.identity,position:[0,0,Dl.DefaultTargetOffset],...Dl.defaultData})(kc||(kc={}));var d0;(r=>{function a(n){return{...si.defaultData,...t0.defaultData(n)}}r.defaultData=a,r.defaultDirectionalLightData={...r.defaultData("DirectionalLight"),position:[200,300,300],name:"Directional Light",intensity:.7}})(d0||(d0={}));var $h;(r=>{function a(o,f,y=0){for(;y<f.length;){let x=o?o[f[y]]:void 0;if(f.length===y+1)return x;if(x)o=x.descendants,y+=1;else return}}r.resolveWithDes=a;function n(o,f,y=0){let x=a(o,f,y);if(x){let b=Object.keys(x);if(b.length===1&&b[0]==="descendants")return}return x}r.resolve=n})($h||($h={}));var Io;(r=>{r.rootOverrideProps=["physics","events"],r.compositeNonOptionalOverrideProps=["geometry"],r.compositeEntireOverrideOverrideProps=["material"];function a(o,f){return{...si.defaultData,...f,component:o,overrides:new xr,physics:void 0,events:void 0,type:"Instance"}}r.ofComponent=a;function n(o){let f=Jh.fromObject(o.data);return a(o.id,f)}r.fromComponentData=n})(Io||(Io={}));var Aa;(r=>{r.defaultData={type:"Page",...si.defaultData,physics:{...Ol.defaultData,fusedBody:!1},...c0.defaultData,camera:kc.defaultData};function a(n){return n.uiScene!==void 0}r.isUIPage=a})(Aa||(Aa={}));var f0;(r=>(r.defaultCamera={position:[0,0,1e3],scale:[1,1,1],rotation:[0,0,0],hiddenMatrix:_l.identity,name:"Play Camera",visible:!0,raycastLock:!1,physics:Ol.defaultData,states:new Ue,events:new Ue,cloner:null,pathSnapping:{pathId:null,orientation:"tangential",slide:0,offset:0},...Dl.defaultData},r.KeysByResetCategory={States:["states"],Events:["events"],Material:["material","materials"],Geometry:["geometry"],Position:["position"],Rotation:["rotation"],Scale:["scale"],Transform:["position","scale","rotation","hiddenMatrix"],Name:["name"],Visibility:["visible","raycastLock","flatShading","wireframe","side"],Shadows:["castShadow","receiveShadow"],Cloner:["cloner"],Physics:["physics"]},r.defaultMeshObject={name:"Rectangle",...si.defaultData,...wa.defaultData,geometry:_o.defaultData("RectangleGeometry"),material:qr.defaultTwoLayerData("phong","layer1","layer2")},r.defaultBooleanObject={name:"Boolean",...si.defaultData,...wa.defaultData,geometry:_o.defaultData("BooleanGeometry"),material:qr.defaultTwoLayerData("phong","layer1","layer2")},r.defaultShapeBlendObject={name:"Shape Blend",...si.defaultData,...wa.defaultData,geometry:_o.defaultData("ShapeBlendGeometry"),material:qr.defaultTwoLayerData("phong","layer1","layer2")},r.defaultTextObject={name:"Text",...si.defaultData,...wa.defaultData,geometry:_o.defaultData("TextGeometry"),material:qr.defaultTwoLayerData("phong","layer1","layer2")},r.defaultInputObject={name:"Input",...si.defaultData,...wa.defaultData,geometry:_o.defaultData("InputGeometry"),material:qr.defaultTwoLayerData("phong","layer1","layer2")}))(f0||(f0={}));var Ea;(r=>{function a(y,x){let b={name:x};return y.type==="Mesh"?(b.geometry={},"material"in y&&(b.material={layers:new xr}),"materials"in y&&(b.materials=y.materials.map(_=>({layers:new xr})))):ks.is(y.type)&&(b.perspective={},b.orthographic={}),b}r.newEmpty=a;function n(y,x){if(x===void 0)return y;let b={...y};return"material"in b&&"material"in x&&x.material&&(b.material=Tl(b.material,_=>{if(typeof _!="string")for(let[S,A]of Object.entries(x.material.layers)){let C=_.layers.data(S);C&&Wr.patch(C,A)}}).data),b.materials&&x.materials&&(b.materials=Tl(b.materials,_=>{var S,A;for(let C=0;C<b.materials.length;C++){let P=x.materials[C];if(typeof P!="string")for(let[T,M]of Object.entries(P.layers)){let O=(A=(S=_[C])==null?void 0:S.layers)==null?void 0:A.data(T);O&&Wr.patch(O,M)}}}).data),b}function o(y,x){let b,_=[],S={orthographic:0,perspective:0,geometry:0};function A(C,P){for(let[T,M]of Object.entries(P.layers)){let{texture:O,...I}=M;if(O!==void 0&&Object.keys(O).length>0){let D={path:[...C,"layers",T,"texture"],props:O,type:0};_.push(D)}if(Object.keys(I).length>0){let D={path:[...C,"layers",T],props:I,type:0};_.push(D)}}}for(let[C,P]of Object.entries(x))if(C!=="name")if(C==="cloner")_.push(...$v.toOps(P,["cloner"]));else if(C==="pathSnapping")_.push({path:[C],props:{slide:P.slide,offset:P.offset},type:0});else if(C==="material")A(["material"],P);else if(C==="materials")for(let[T,M]of Object.entries(P))A(["materials",T],M);else if(S[C]===0){if(C==="geometry"&&P.extrusion!==void 0){let T={path:[C,"extrusion"],props:P.extrusion,type:0};_.push(T),P={...P},delete P.extrusion}if(Object.keys(P).length>0){let T={path:[C],props:P,type:0};_.push(T)}}else b===void 0&&(b={path:[],props:{},type:0},_.push(b)),b.props[C]=P;return _}r.toOps=o;function f(y,x){var _,S,A,C,P,T;if(x===void 0)return y;let b={...y};if(Object.assign(b,Jh.merge(b,x)),Object.assign(b,{pathSnapping:Object.assign({},b.pathSnapping,{slide:((_=x.pathSnapping)==null?void 0:_.slide)??((S=b.pathSnapping)==null?void 0:S.slide)??0,offset:((A=x.pathSnapping)==null?void 0:A.offset)??((C=b.pathSnapping)==null?void 0:C.offset)??0})}),ks.is(y.type)){b.orthographic={...b.orthographic},b.perspective={...b.perspective};let M=x;((P=M.orthographic)==null?void 0:P.zoom)!==void 0&&(b.orthographic.zoom=M.orthographic.zoom),((T=M.perspective)==null?void 0:T.zoom)!==void 0&&(b.perspective.zoom=M.perspective.zoom),M.isUpVectorFlipped!==void 0&&(b.isUpVectorFlipped=M.isUpVectorFlipped),M.targetOffset!==void 0&&(b.targetOffset=M.targetOffset)}else if(y.type==="Mesh")"geometry"in x&&Object.assign(b,{geometry:o0.merge(b.geometry,x.geometry)}),(x.material||x.materials)&&(b=n(b,x)),b.cloner&&"cloner"in x&&Object.assign(b,{cloner:Po.merge(b.cloner,x.cloner)});else if(y.type==="Empty")b.cloner&&"cloner"in x&&Object.assign(b,{cloner:Po.merge(b.cloner,x.cloner)});else if(e0.is(y.type)){let M=x;M.intensity!==void 0&&(b.intensity=M.intensity),M.color!==void 0&&(typeof M.color=="string"?b.color=M.color:b.color=ii.clone(M.color))}return b}r.patch=f})(Ea||(Ea={}));var ed;(r=>r.defaultData={enablePan:!0,enableZoom:!0,enableRotate:!0,enableDamping:!0,rotationLimitsMode:0,rotationVerticalOffset:{min:Math.PI/4,max:Math.PI/4},rotationHorizontalOffset:{min:Math.PI/4,max:Math.PI/4},rotationSoftLimit:2,panLimitsMode:0,panVerticalOffset:{min:250,max:250},panHorizontalOffset:{min:250,max:250},panSoftLimit:2,zoomLimitsEnabled:!1,zoomLimits:{min:.1,max:2},autoRotate:!1,autoRotateSpeed:2,autoRotateClockwise:!0,hoverRotatePanMode:0,hoverRotatePanStrength:20,hoverRotateDamping:.125,isTouchZoom:!0,orbitTouches:2,panTouches:3,resetHoverEffectOnPointerLeave:!0})(ed||(ed={}));var ms;(r=>r.defaultData={orbitControls:ed.defaultData,playPage:Il,withBackground:!0,preventScroll:!1,preventTouchScroll:!1,hideCursor:!1,mouseEventTarget:"canvas",joystickSizeAndXYOffset:Array(12).fill(0).map((a,n)=>{let o=0,f=0;return n<5?f=-30:n<10&&(f=30),n===0||n===10||n===5?o=30:(n===4||n===11||n===9)&&(o=-30),[120,[o,f],"show"]}),settings:{image:{format:"jpg",ratio:1},videoStatic:{fps:60,mbps:150,ratio:1,duration:1e3},video:{format:"mp4",imageFormat:"jpg",fps:30,mbps:80,ratio:Math.max(1,typeof window<"u"?Math.floor(window.devicePixelRatio):1),stopMode:"manual",duration:5e3},web:{logo:!0,compress:!0,preset:1,preload:!0,hint:!1,imageQuality:70}},stopRaycast:!0,hdTransmission:!1})(ms||(ms={}));var nA;(r=>r.defaultData={id:"basic",label:"Basic",style:"None",prompt:""})(nA||(nA={}));var sA;(r=>r.defaultData={weather:0,shadows:0,lightOrigin:0,temperature:0,sun:0,camera:0,environment:0,particles:0,nature:0,floor:0})(sA||(sA={}));var Ta;(r=>(r.defaultData=()=>({mode:"line-art-both",prompt:"",negativePrompt:"",style:{...nA.defaultData},isRandomSeed:!0,seed:r.generateSeed(),guessMode:!1,advanced:!1,steps:20,guidanceScale:7.5,controlNetScale:1,modifiers:sA.defaultData}),r.generateSeed=()=>Math.round(Math.random()*1e5)))(Ta||(Ta={}));var Ll;(r=>{function a(o){return o.find(f=>f.data.type==="Page"&&f.data.globalPhysics.usePhysics)!==void 0}r.physicsEnabled=a;function n(o,f,y){o.scene.objects.traverseFrom(f,(x,b)=>{var _;if(b.type==="Instance"){let S=(_=td.getComponentData(o,b.component))==null?void 0:_.data;S&&y(x,b,S.events)}else y(x,b,b.events)})}r.traverseModuleInstances=n})(Ll||(Ll={}));var Ma;(r=>{r.TRASH_CAN_ID="830a2708-8ed9-49cf-a68e-085299892222",r.defaultLight={fi:-1,data:d0.defaultDirectionalLightData,id:"830a2708-8ed9-49cf-a68e-085299899103",children:[]};function a(f=!0,y=[]){let x=[],b=f0.defaultMeshObject;f&&(x.push({...r.defaultLight}),x.push({fi:1,id:"7ba78968-2a55-48f2-b14c-5191da3e075e",data:b,children:[]})),x.push(...y);let _=new vr;return _.push({fi:1,id:Il,data:{...Aa.defaultData,name:"Scene 1"},children:x}),_}r.createDefaultObjectTreeWithPage=a,r.defaultData={objects:a(),publish:ms.defaultData,styles:Ta.defaultData()},r.emptyDataWithoutPage=function(){return{objects:new vr,publish:ms.defaultData,styles:Ta.defaultData()}},r.emptyDataWithPage=function(f=!0){return{objects:a(f),publish:ms.defaultData,styles:Ta.defaultData()}},r.emptyData=function(){return{objects:new vr,publish:{...ms.defaultData},styles:Ta.defaultData()}};function n(f){return{...r.defaultData,objects:Xi(f,vr.prototype)}}r.withObjs=n;function o(f,y){return n([{id:f,data:y,children:[],fi:0}])}r.withObj=o})(Ma||(Ma={}));var rd;(r=>r.defaultData={preset:"fullscreen",allowResponsive:!1,size:[512,512],coords:[0,0],sceneScale:1,color:{r:0,g:0,b:0,a:.5}})(rd||(rd={}));var p0;(r=>(r.defaultData=a=>({url:a,name:"New Webhook",parametersSchemas:new Ue}),r.defaultParameterValueByType=a=>a==="number"?0:a==="boolean"?!1:""))(p0||(p0={}));var _D;(r=>r.defaultData=(a,n="GET")=>({url:a,method:n,name:"New API",headers:new Ue,queries:new Ue,autoStart:!0}))(_D||(_D={}));var Ur;(r=>{function a(x){return x.textValue!==void 0}r.isTextValue=a;function n(x){return typeof x=="number"}r.isNumber=n;function o(x){return typeof x=="boolean"}r.isBoolean=o;function f(x){return a(x)?"string":o(x)?"boolean":"number"}r.typeOfVariable=f;function y(x){return r.isTextValue(x)?Array.isArray(x.textValue)?x.textValue.map(b=>b.toString().padStart(x.padding??2,"0")).join(x.deliminator??":")+(x.suffix!==void 0?" "+x.suffix:""):x.textValue.toString():r.isBoolean(x)?x?"True":"False":r.isNumber(x)?parseFloat(x.toFixed(3)).toString():x.toString()}r.getDisplayedValue=y})(Ur||(Ur={}));var oA;(r=>r.all=["images","videos","colors","audios","particles","fonts","materials","variables"])(oA||(oA={}));var ID;(r=>r.all=[...oA.all,"components"])(ID||(ID={}));var DD;(r=>{function a(){return{images:new Ze,videos:new Ze,colors:new Ze,audios:new Ze,particles:new Ze,fonts:new Ze,materials:new Ze,components:new Ze,variables:new Ze,userAPIs:new Ze,userWebhooks:new Ze}}r.defaultData=a})(DD||(DD={}));var Gs;(r=>{function a(){return{images:new Ze,videos:new Ze,colors:new Ze,audios:new Ze,particles:new Ze,fonts:new Ze,materials:new Ze,components:new Ze,variables:new Ze,userAPIs:new Ze,userWebhooks:new Ze}}r.defaultData=a})(Gs||(Gs={}));var bn;(r=>{function a(){let x={};return x["89b10010-844c-11ec-a8a3-0242ac120002"]={r:.5,g:.5,b:.5,a:1,name:"Default Color"},Xi(x,Ze.prototype)}r.defaultColors=a;function n(){return Xi({},Ze.prototype)}r.defaultImages=n;function o(){return{catelogs:new Ze,materials:new Ze,images:new Ze,videos:new Ze,colors:new Ze,audios:new Ze,particles:new Ze,fonts:new Ze,variables:new Ue,userAPIs:new Ze,userWebhooks:new Ze,lib:Gs.defaultData()}}r.emptyData=o;function f(x){switch(x){case"number":return{value:0,name:"Number"};case"boolean":return{value:!1,name:"Boolean"};case"string":return{value:{textValue:"String value"},name:"String"};case"time":let b=[0,0,0];return{name:"Time",value:{textValue:b,deliminator:":",padding:2,suffix:"AM"},dynamicVariableType:"time",format:"HH:mm:ss",format12h24h:"12ampm",timeZone:null,hasEnd:!1,endValue:{textValue:b,deliminator:":",padding:2,suffix:"AM"},autoStart:!0,repeat:!1};case"counter":return{name:"Counter",value:0,dynamicVariableType:"counter",updateInterval:1e3,increment:1,autoStart:!0,hasEnd:!0,endValue:60,repeat:!0,randomStart:!1,range:[0,100],decimals:0};case"random":return{name:"Random",value:0,dynamicVariableType:"random",updateInterval:1e3,increment:1,autoStart:!0,isStatic:!1,hasEnd:!0,endValue:60,repeat:!0,min:0,max:100,decimals:0};default:console.error("Unknown variable type",x)}}r.defaultVariables=f;function y(x,b){if(b.format==="HH:mm:ss"){let _=Math.floor(x/3600),S=Math.floor((x-_*3600)/60),A=Math.round(x-_*3600-S*60);return{textValue:[_,S,A]}}else if(b.format==="mm:ss"){let _=Math.floor(x/60),S=Math.round(x-_*60);return{textValue:[_,S]}}else return b.format==="number"?x=Math.round(x):x=Math.round(x*1e3)/1e3,x}r.getFormattedTimerTime=y})(bn||(bn={}));var id;(r=>r.list=["idle","move","jump","run"])(id||(id={}));var nd;(r=>(r.defaultColliderData={type:"capsule",height:200,radius:50,position:[0,0,0],rotation:[0,0,0]},r.defaultDataThirdPerson={moveMode:"walk",forwardDirection:"+z",speedTranslate:1e3,speedRotate:100,runMultiplier:2,rotationMode:"normal",rotBy:"keys",rotByTouch:"drag",delayPos:[.3,.3],delayRot:[.3,.3],keyAssignments:[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","▲"],["rotPosY","◀"],["rotNegX","▼"],["rotNegY","▶"],["jump","Space"],["run","⇧"],["none","Ctrl"]],touchControl:!0,joystickPosLoc:5,joystickRotLoc:11,jumpTouchButtonLoc:9,collider:r.defaultColliderData,colliderHelperVisible:!0,collisionEnabled:!0,jumpPower:100,resetYPosition:3e3,alignToGround:!1,autoOrientMove:!0,orientWith:"camera",orientMode:"radial",delayPosCamera:.3,delayRotCamera:.3,camera:"",cameraXAxis:"Limit",cameraYAxis:"Free",cameraRotXLimits:[0,Math.PI/2],cameraRotYLimits:[-Math.PI/2,Math.PI/2],gameActions:{idle:new Ue,move:new Ue,jump:new Ue,run:new Ue},navmesh:{enabled:!1,ch:6,cs:6,walkableClimb:5,walkableHeight:1,walkableRadius:0,zones:"all",objects:[],helperVisible:!0,destinationHelperRadius:0,destinationHelperColor:Tt.fromHexAndA(3728051,1)}}))(nd||(nd={}));function OD(r){r.layers.forEach(a=>{if(a.type==="depth"&&a.colorA!==void 0){let n=a.colorA,o=a.colorB,f=[[n.r,n.g,n.b,n.a],[o.r,o.g,o.b,o.a]],y=[0,1];for(let b=2;b<10;b++)f.push(f[1]),y.push(1);let x={...In(Hr(a),"type","visible","isVector","isWorldSpace","origin","alpha","mode"),near:Math.max(0,a.near),far:Math.max(0,a.far),colors:f,steps:y,num:2,direction:[1,0,0],smooth:!1,gradientType:1};Object.assign(a,x)}else if(a.type==="depth"&&a.gradientType===1&&(a.near<0||a.far<0)){let n={...Hr(a),near:Math.max(a.near,0),far:Math.max(a.far,0)};Object.assign(a,n)}})}function Ca(r,a){Object.values(r.shared.materials).forEach(n=>a(n))}function Pa(r,a){r.scene.objects.traverse((n,o)=>{"materials"in o?o.materials.forEach((f,y)=>{f===void 0&&(o.materials[y]=qr.defaultData(),f=o.materials[y]),typeof f!="string"&&a(f)}):"material"in o?typeof o.material!="string"&&(o.material===void 0&&(o.material=qr.defaultData()),a(o.material)):o.type==="Mesh"&&(o.material===void 0&&(o.material=qr.defaultData()),a(o.material)),"overrides"in o&&Object.values(o.overrides).forEach(f=>{f.material&&typeof f.material!="string"&&Object.getPrototypeOf(f.material)!==xr.prototype&&a(f.material)})})}function xq(r){Object.assign(r.scene.publish,{orbitControls:{...ed.defaultData,...Hr(r.scene.publish.orbitControls)}})}function bq(r){Object.assign(r.scene.publish.settings,{video:{...ms.defaultData.settings.video,...Hr(r.scene.publish.settings.video)}})}function Sq(r){function a(n){if(n.layers){for(let o of Object.values(n.layers))if(o){for(let[f,y]of Object.entries(o))if((i0.includes(f)||typeof y=="boolean")&&delete o[f],f==="texture")for(let[x,b]of Object.entries(y))(ED.includes(x)||typeof b=="boolean")&&delete y[x]}}}r.scene.objects.traverse((n,o)=>{o.states.forEach(f=>{let y=f;y.material?a(y.material):y.materials&&y.materials.forEach(x=>{a(x)})})})}function wq(r){r.scene.publish.withBackground=!0}function Aq(r){r.scene.publish.settings.web={compress:!0,preload:!0,preset:1,logo:!0,hint:!1}}function Eq(r){r.scene.objects.traverse((a,n)=>{let o=n.cloner;o&&(o.radial.scale=o.radial.scale.map(f=>f+1),o.linear.scale=o.linear.scale.map(f=>f+1))})}function Tq(r){r.scene.objects.traverse((a,n)=>{let o=n.geometry;o&&(o.type==="DodecahedronGeometry"||o.type==="IcosahedronGeometry")&&(o.detail=Math.round(o.detail))})}function Mq(r){r.scene.objects.traverse((a,n)=>{let o=r.scene.objects.unproxy().parent(a);if(o){let f=Hr(r.scene.objects.data(o));f&&f.type==="Mesh"&&f.geometry.type==="BooleanGeometry"&&n.type==="Mesh"&&(n.visible=Hr(n).booleanExclude!==!0)}})}function Cq(r){r.scene.objects.traverse((a,n)=>{if(n.type==="Mesh"){let o=n;n.geometry.type==="NonParametricGeometry"?o.material!==void 0&&delete o.material:o.materials!==void 0&&delete o.materials}})}function Pq(r){function a(o){Object.setPrototypeOf(o,xr.prototype),o.texture&&Object.setPrototypeOf(o.texture,xr.prototype)}function n(o){Object.setPrototypeOf(o,xr.prototype);for(let f in o)a(o[f])}r.scene.objects.traverse((o,f)=>{f.states.forEach(y=>{let x=y;if(x.material){let b=Hr(x.material).layers;n(b),x.material.layers=b}if(x.materials)for(let b=0;b<x.materials.length;b++){let _=x.materials[b],S=Hr(_).layers;n(S),_.layers=S}})})}function RD(r){r.layers===void 0&&Object.assign(r,qr.defaultTwoLayerData("lambert"))}function aA(r){!r.layers||r.layers.forEach(a=>{if(a.type==="depth"&&a.colors.length===10){let n=[...a.colors];n.push(a.colors[9]);let o=[...a.steps];o.push(a.steps[9]);let f={...Hr(a),colors:n,steps:o};Object.assign(a,f)}})}function _q(r){r.scene.objects.traverse((a,n)=>{n.type==="Mesh"&&(n.geometry.type==="BooleanGeometry"||n.geometry.type==="SubdivGeometry")&&(n.geometry.phongAngle=35)})}function LD(r){r.scene.objects.traverse((a,n)=>{"materials"in n?n.materials.forEach(o=>{typeof o!="string"&&aA(o)}):"material"in n&&typeof n.material!="string"&&aA(n.material)}),Object.values(r.shared.materials).forEach(a=>aA(a))}function Iq(r){r.scene.environment.ambientLight.softShadows=!1,r.scene.environment.ambientLight.softShadowQuality="low",r.scene.objects.traverse((a,n)=>{(n.type==="DirectionalLight"||n.type==="SpotLight")&&(n.shadowResolution=1024,n.shadowRadius=1,n.depth=1e5)}),r.shared.penumbraSize=new Array(5).fill(.5)}function Dq(r){r.shared.audios=Xi({},Ze.prototype)}function Oq(r){r.shared.videos=Xi({},Ze.prototype)}function Rq(r){let a=r.shared.materials;Object.entries(a).forEach(([n,o])=>{if(!o.layers){let f={name:"Untitled Material",layers:[{fi:0,data:{type:"light",category:"phong",alpha:.6,visible:!0,mode:0,specular:{r:.2,g:.2,b:.2},shininess:5},id:"layer1"},{fi:1,data:{type:"color",alpha:1,visible:!0,mode:0,color:{r:.2823529411764706,g:.2823529411764706,b:.30196078431372547}},id:"layer2"}]};Object.assign(a,{[n]:f})}})}function Lq(r){Object.entries(Hr(r.shared.images)).filter(a=>a[1].asset===!1).map(a=>a[0]).forEach(a=>{delete r.shared.images[a]}),Object.entries(Hr(r.shared.audios)).filter(a=>a[1].asset===!1).map(a=>a[0]).forEach(a=>{delete r.shared.audios[a]})}function Bq(r){r.scene.publish.settings.web.preload=!1}function BD(r){r.layers&&r.layers.forEach(a=>{a.type==="depth"&&a.num!==void 0&&(a.colors=a.colors.slice(0,a.num),a.steps=a.steps.slice(0,a.num),delete a.num)})}function ND(r){r.layers&&r.layers.forEach(a=>{AD(a)&&a.isMask===void 0&&(a.isMask=!1),(a.type==="texture"||a.type==="video")&&a.blending===void 0&&(a.blending=0),(a.type==="noise"||a.type==="displace"&&a.displacementType==="noise")&&(a.voronoiStyle===void 0&&(a.voronoiStyle=0),a.highCut===void 0&&(a.highCut=1),a.lowCut===void 0&&(a.lowCut=0),a.smoothness===void 0&&(a.smoothness=.3),a.seed===void 0&&(a.seed=0),a.quality===void 0&&(a.quality=1))})}function Nq(r){r.shared.fonts=Xi({},Ze.prototype)}function Fq(r){return r.replace(".typeface","").replace(/optimer/gi,"open sans").replace("space_mono","space mono").replace(/alma_mono/gi,"varela round").replace(/droid_sans_mono/gi,"noto sans mono").replace(/droid_sans|gentilis|gnomon_(simple|foreground)|helvetiker/gi,"roboto").replace(/droid_serif/gi,"roboto slab").replace("_sans"," sans").replace("crimson_text","crimson text").replace("medium_medium","medium").replace("fatface_fatface","fatface").replace("100hairline","thin").replace("200thin","extralight").replace("300light","light").replace("500medium","medium").replace("600semi","semibold").replace("800heavy","extrabold").replace("900black","black").replace(/bodoni_(11|16|24|36|48|72|96)([^_])/gi,"bodoni_$1_$2").replace(/bodoni_(11|16|24|36|48|72|96)/gi,"bodoni moda").replace(/(thin|hairline)(_regular)?/gi,"100").replace(/(extra|ultra)light(_regular)?/gi,"200").replace(/light(_regular)?/gi,"300").replace(/_book|_normal|_roman/gi,"_regular").replace(/medium(_regular)?/gi,"500").replace(/(semi|demi)bold(_regular)?/gi,"600").replace(/(extra|ultra)bold(_regular)?/gi,"800").replace(/bold(_regular)?/gi,"700").replace(/(black|heavy|fatface)(_regular)?/gi,"900").replace(/([1-9]00)_italic/gi,"$1italic").replace(/regularitalic/gi,"italic").replace(/regularitalic/gi,"italic").split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" ")}function Vq(r){let a=[];r.scene.objects.traverse((n,o)=>{let f=o;if(f.type==="TextFrame"){let y=qr.defaultTwoLayerData("phong"),x=typeof f.color=="string"?r.shared.colors[f.color]:f.color;y.layers[1].data.color={r:x.r,g:x.g,b:x.b},y.layers[1].data.alpha=f.alpha;let b=Fq(f.font);r.shared.fonts[b]===void 0&&(r.shared.fonts[b]={name:b});let _={name:f.name,...si.defaultData,...wa.defaultData,flatShading:!1,wireframe:!1,geometry:{..._o.defaultData("TextGeometry"),width:f.width,height:f.height,font:b,depth:0,horizontalAlign:f.horizontalAlign,verticalAlign:f.verticalAlign,fontSize:f.fontSize*1.40625,lineHeight:f.lineHeight/1.40625,letterSpacing:f.letterSpacing-1,text:f.text,textTransform:f.textTransform,extrudeBevelSize:0,extrudeBevelSegments:1},material:y,states:Hr(f.states),events:Hr(f.events),visible:f.visible,raycastLock:f.raycastLock,position:f.position,rotation:f.rotation,scale:f.scale,hiddenMatrix:f.hiddenMatrix},S=Hr(r.scene.objects).parent(n);r.scene.objects.insertAfter(S??null,n,[{id:n+"new",data:_,children:[]}]),a.push(n)}}),a.forEach(n=>{r.scene.objects.delete(n)})}function Uq(r){let a={0:"MouseDown",1:"MouseUp",2:"MouseHover",5:"KeyDown",6:"KeyUp",7:"Start",9:"LookAt",10:"Follow",11:"Scroll",12:"Audio",13:"GameControl"};r.scene.objects.traverse((n,o)=>{o.events.forEach(f=>{if(a[Number(f.type)])if(Object.assign(f,{type:a[Number(f.type)]}),f.type==="Audio"&&"audioEvent"in f&&(Object.assign(f,{playAudio:f.audioEvent}),delete f.audioEvent),f.type==="GameControl")Object.assign(f,{gameActions:{idle:new Ue,move:new Ue,jump:new Ue}});else{let y=new Ue;Object.assign(f,{actions:y}),(f.type==="MouseDown"||f.type==="MouseUp"||f.type==="KeyDown"||f.type==="KeyUp")&&"url"in f&&y.push({fi:0,id:we.generateUUID(),data:{type:"Link",url:f.url,delay:0}}),"targets"in f&&(f.targets.forEach((x,b,_)=>{let S={state:void 0,repeat:0,delay:0,delayDirection:void 0,direction:"normal",duration:0,easing:4},A={easing:x.easing,duration:x.duration};x.easing===6?Object.assign(A,In(x,"mass","stiffness","damping","velocity")):x.easing===5&&Object.assign(A,{control1:{...x.control1},control2:{...x.control2}});let C={repeat:x.repeat?-1:0,delay:x.delay,delayDirection:x.delayDirection,direction:x.cycle&&x.rewind?"pingpong-rewind":x.cycle?"pingpong":"normal"},P={state:x.state,...C,...A},T={allowSlerp:!0,type:"Transition",object:x.object,repeat:0,delay:0,delayDirection:void 0,direction:"normal",tweens:new Ue({fi:0,id:we.generateUUID(),data:S},{fi:1,id:we.generateUUID(),data:P})};y.push({fi:_,id:b,data:T})}),delete f.targets)}})})}function zq(r){r.scene.objects.traverse((a,n)=>{function o(f,y){var _;let x=new Ue,b=[];if(n.events.forEach((S,A,C)=>{if(S.type==="Audio"&&S.trigger===y){let P;b.push(A),S.interaction==="play"?P={...In(S,"interaction","audio","delay","volume","loop"),triggerAfter:"after"in S?S.after:void 0,toggle:"after"in S?S.toggle:void 0,type:"Audio"}:(S.interaction==="pause"||S.interaction==="stop")&&(P={...In(S,"interaction","delay","object","playAudio"),type:"Audio"}),P&&x.push({fi:C,id:A,data:P})}}),b.forEach(S=>n.events.delete(S)),x.length){let S=(_=n.events.find(A=>A.type===f))==null?void 0:_.data;S?"actions"in S&&S.actions.insertBefore(null,x):n.events.insertBefore(null,[{id:we.generateUUID(),data:{type:f,actions:x}}])}}o("Start","start"),o("MouseDown","mouseDown"),o("MouseUp","mouseUp"),o("KeyDown","keyDown"),o("KeyUp","keyUp")})}function FD(r){var n;let a=(n=r.layers.find(o=>o.type==="light"))==null?void 0:n.data;if((a==null?void 0:a.category)==="basic"){let o=Wr.defaultData("light","phong"),f=a;Object.assign(f,o),f.visible=!1}}function VD(r){Ca(r,FD),Pa(r,FD)}function kq(r){r.scene.objects.traverse((a,n)=>{n.type==="Mesh"&&n.geometry.type==="SubdivGeometry"&&(n.geometry.scaleBaked||(n.geometry.scaleBaked=[1,1,1]))})}function Gq(r){r.scene.objects.traverse((a,n)=>{(n.type==="Empty"||n.type==="Mesh")&&n.cloner&&!n.cloner.randomnessObject&&!n.cloner.toObject&&!n.cloner.randomness&&(n.cloner={...n.cloner,toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}})})}function jq(r){r.scene.objects.traverse((a,n)=>{n.type==="Mesh"&&n.geometry.type==="NonParametricGeometry"&&!("material"in n)&&!("materials"in n)&&(n.material=qr.defaultTwoLayerData("phong"))})}function Hq(r){r.scene.publish.orbitControls.autoZoom===void 0&&(r.scene.publish.orbitControls.autoZoom=!1),r.scene.objects.traverse((a,n)=>{(n.type==="OrthographicCamera"||n.type==="PerspectiveCamera")&&(n.orthographic.autoZoom===void 0&&(n.orthographic.autoZoom=!1),n.orthographic.autoZoomFrustumSize===void 0&&(n.orthographic.autoZoomFrustumSize=790))})}function Wq(r){r.scene.objects.traverse((a,n)=>{n.pathSnapping===void 0&&(n.pathSnapping={pathId:null,slide:0,offset:0,orientation:"tangential"}),n.pathSnapping.offset===void 0&&(n.pathSnapping.offset=0)})}function qq(r){r.scene.publish.mouseEventTarget===void 0&&(r.scene.publish.mouseEventTarget="canvas"),r.scene.publish.settings.web.hint===void 0&&(r.scene.publish.settings.web.hint=!1)}function Xq(r){let{video:a}=r.scene.publish.settings;a.format==="gif"&&a.fps>48&&(a.fps=15)}function Yq(r){r.scene.objects.traverse((a,n)=>{n.events.forEach(o=>{o.type==="GameControl"&&(o.resetYPosition=Math.abs(o.resetYPosition-n.position[1]))})})}function Kq(r){let a=r.scene.environment.usePhysics;r.scene.objects.traverse((n,o)=>{a&&o.physics===null?o.collision=!1:o.collision="visibility"})}function Qq(r){r.scene.objects.traverse((a,n)=>{n.events.forEach(o=>{o.type==="GameControl"&&(o.navmesh=nd.defaultDataThirdPerson.navmesh)})})}function Zq(r){r.scene.styles||(r.scene.styles=Ta.defaultData())}function UD(r){r.layers.forEach(a=>{a.type==="light"&&a.category!=="toon"&&a.occlusion===void 0&&(a.occlusion=!0)})}function Jq(r){r.scene.environment.ambientLight.occlusion===void 0&&(r.scene.environment.ambientLight.occlusion=!1),r.scene.environment.ambientLight.aoFullRes===void 0&&(r.scene.environment.ambientLight.aoFullRes=!1),r.scene.environment.ambientLight.radius===void 0&&(r.scene.environment.ambientLight.radius=256),r.scene.environment.ambientLight.bias===void 0&&(r.scene.environment.ambientLight.bias=.5),r.scene.environment.ambientLight.aoColor===void 0&&(r.scene.environment.ambientLight.aoColor={r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}),Pa(r,UD),Ca(r,UD)}function $q(r){r.scene.objects.traverse((a,n)=>{n.events.forEach(o=>{o.type==="GameControl"&&Object.assign(o.gameActions,{run:new Ue})})})}function e7(r){r.scene.objects.traverse((a,n)=>{n.events.forEach(o=>{o.type==="GameControl"&&(o.keyAssignments=[...o.keyAssignments,["run","⇧"],["none","Ctrl"]])})})}function zD(r){r.layers&&r.layers.forEach(a=>{a.type==="light"&&a.bumpMapIntensity===void 0&&(a.bumpMapIntensity=5)})}function kD(r,a){if(a<1&&(Pa(r,OD),Ca(r,OD),r.schema=1),a<2&&(xq(r),r.schema=2),a<3&&(Sq(r),r.schema=3),a<4&&(wq(r),r.schema=4),a<5&&(Aq(r),r.schema=5),a<6&&(Eq(r),r.schema=6),a<7&&(Tq(r),r.schema=7),a<8&&(r.schema=8),a<9&&(LD(r),r.schema=9),a<10&&(_q(r),r.schema=10),a<11&&(Iq(r),r.schema=11),a<12&&(LD(r),r.schema=12),a<13&&(Dq(r),r.schema=13),a<14&&(Rq(r),r.schema=14),a<15&&(Lq(r),r.schema=15),a<16&&(Bq(r),r.schema=16),a<17&&(Pa(r,BD),Ca(r,BD),r.schema=17),a<18&&(Pa(r,RD),Ca(r,RD),r.schema=18),a<19&&(bq(r),r.schema=19),a<20&&(Nq(r),Vq(r),r.schema=20),a<21&&(Uq(r),zq(r),r.schema=21),a<22&&(VD(r),r.schema=22),a<23&&(kq(r),r.schema=23),a<24&&(Gq(r),r.schema=24),(a<25||r.shared.videos===void 0)&&(Oq(r),a<25&&(r.schema=25)),a<26&&(Mq(r),r.schema=26),a<27&&(Cq(r),r.schema=27),a<28&&(VD(r),r.schema=28),a<29&&(Pq(r),r.schema=29),a<30&&(jq(r),r.schema=30),a<31&&(Hq(r),r.schema=31),a<33&&(Wq(r),r.schema=33),a<34&&(qq(r),r.schema=34),a<35&&(Xq(r),r.schema=35),a<36&&(Yq(r),r.schema=36),a<37&&(Kq(r),r.schema=37),a<38&&(Pa(r,ND),Ca(r,ND),r.schema=38),a<39&&(Qq(r),r.schema=39),a<40&&(Zq(r),r.schema=40),a<41&&(Jq(r),r.schema=41),a<42&&($q(r),r.schema=42),a<43&&(e7(r),r.schema=43),a<99){Pa(r,zD),Ca(r,zD),r.scene.publish.playCamera===null&&(r.scene.publish.playCamera=fs);let n=Hr(r.scene.objects),o=r.scene.objects;r.scene.publish.playPage=Il,o.insertBefore(null,null,[{id:Il,data:{...Aa.defaultData,backgroundColor:r.scene.backgroundColor,fog:r.scene.fog,postprocessing:r.scene.postprocessing,ao:In(r.scene.environment.ambientLight,"occlusion","aoFullRes","radius","bias","aoColor"),publish:{playCamera:r.scene.publish.playCamera,gameControlObject:r.scene.publish.gameControlObject},shadow:In(r.scene.environment.ambientLight,"softShadowQuality"),globalPhysics:{...Rl.defaultData,...In(r.scene.environment,"usePhysics","gravity")},camera:Hr(r.scene.ownerCamera)??Aa.defaultData.camera,name:"Scene"},children:[]}]);for(let x of n)x.id!==Ma.TRASH_CAN_ID&&o.move(Il,x.fi,x.id);let f=0,y=0;r.shared.penumbraSize&&r.scene.objects.traverse((x,b)=>{b.type==="DirectionalLight"?(b.penumbraSize=r.shared.penumbraSize[Math.min(f,2)],f+=1):b.type==="SpotLight"&&(b.penumbraSize=r.shared.penumbraSize[3+Math.min(y,1)],y+=1),(b.physics===void 0||b.physics===null)&&b.type!=="Instance"&&(b.physics={},Object.assign(b.physics,Ol.defaultData)),b.physics!==void 0&&b.physics!==null&&(b.physics.enabled=b.collision??"visibility",delete b.collision)}),r.schema=99}}function GD(r){r.layers&&r.layers.forEach(a=>{a.type==="light"&&a.alphaOverride===void 0&&(a.alphaOverride=1)})}function t7(r){r.scene.objects.traverse((a,n)=>{let o=n.geometry;o&&o.type==="PathGeometry"&&(o.extrusion.capType="flat",o.extrusion.bevel=50,o.extrusion.bevelSides=6,o.extrusion.shape.type==="Custom"&&(o.extrusion.shape.shapeQuality="low"))})}function r7(r){var a;Array.isArray(Hr(r.events))&&((a=r.events)==null||a.forEach(n=>{"disabled"in n||(n.disabled=!1),(n.type==="MouseDown"||n.type==="MouseUp"||n.type==="MousePress")&&(n.mode=n.mode||"Object")}))}var sd=180/Math.PI;function jD(r){r.rotation=r.rotation.slice(0,3).map(a=>a*sd)}function HD(r){var n,o;jD(r),r.type==="Page"&&jD(r.camera),(n=r.states)==null||n.forEach(f=>{f.rotation===void 0||f.rotation===null||(f.rotation=f.rotation.slice(0,3).map(y=>y*sd))});let a=r.geometry;a&&a.type==="SphereGeometry"&&(a.thetaLength=(a.thetaLength??180)*sd),a&&a.type==="TorusGeometry"&&(a.arc=a.arc*sd),a&&a.type==="PathGeometry"&&(a.extrusion.angle*=sd,a.extrusion.twist*=sd),r.type==="Mesh"&&r.geometry.type==="TextGeometry"&&(r.geometry.text={textValue:r.geometry.text}),Array.isArray(Hr(r.events))&&((o=r.events)==null||o.forEach(f=>{(f.type==="MouseDown"||f.type==="MouseUp"||f.type==="MousePress"||f.type==="KeyDown"||f.type==="KeyUp"||f.type==="KeyPress"||f.type==="Collision"||f.type==="Trigger")&&(f.runMode=f.toggle?"Toggle":"Repeat")}))}function i7(r){r.shared.variables=Xi({},Ze.prototype)}function n7(r){let a=Hr(r.shared.variables);r.shared.variables=Xi(Object.entries(a??{}).map(([n,o],f)=>({fi:f,id:n,data:o})),Ue.prototype)}var Do=116;function WD(r,a){a(r.data);for(let n of r.children)WD(n,a)}function s7(r){let a=r.schema??104;a!==Do&&a<105&&(WD(r.asset,HD),r.schema=105)}function o7(r){r.shared.particles=Xi({},Ze.prototype),r.shared.lib&&(r.shared.lib.particles=Gs.defaultData().particles)}function a7(r){r.scene.objects.traverse((a,n)=>{n.type==="Particle"&&typeof n.renderMaterial.size=="number"&&Object.assign(n.renderMaterial,{size:[n.renderMaterial.size,n.renderMaterial.size]})})}function l7(r){r.scene.objects.traverse((a,n)=>{n.type==="Page"&&(n.postprocessing.depthOfField.focusDistance=100,n.postprocessing.depthOfField.focalLength=20,n.postprocessing.depthOfField.bokehScale=5)})}function c7(r){r.scene.objects.traverse((a,n)=>{var o;Array.isArray(Hr(n.events))!==!1&&((o=n.events)==null||o.forEach(f=>{var x,b,_,S,A,C,P,T,M,O,I;let y=f.runMode;f.type==="MouseDown"||f.type==="MouseUp"||f.type==="KeyDown"||f.type==="KeyUp"||f.type==="Collision"||f.type==="Trigger"?(x=f.actions)==null||x.forEach(D=>{D.type==="Transition"&&(D.runMode=y??"Repeat"),(D.type==="Animation"||D.type==="SwitchCamera")&&(D.runMode=y==="Toggle"?"Toggle":"Normal")}):f.type==="MouseHover"||f.type==="MousePress"||f.type==="KeyPress"?(b=f.actions)==null||b.forEach(D=>{(D.type==="Transition"||D.type==="Animation"||D.type==="SwitchCamera")&&(D.runMode="Toggle")}):f.type==="GameControl"?(delete f.actions,Object.keys(f.gameActions).forEach(D=>{var z;(z=f.gameActions[D])==null||z.forEach(k=>{k.type==="Transition"&&(k.runMode="Repeat"),k.type==="Animation"&&(k.runMode="Normal")})})):f.type==="DragDrop"?(delete f.actions,(S=(_=f.dragDropActions)==null?void 0:_.drag)==null||S.forEach(D=>{(D.type==="Transition"||D.type==="Animation"||D.type==="SwitchCamera")&&(D.runMode="Toggle")}),(C=(A=f.dragDropActions)==null?void 0:A.drop)==null||C.forEach(D=>{(D.type==="Transition"||D.type==="Animation"||D.type==="SwitchCamera")&&(D.runMode="Toggle")})):f.type==="Resize"?(delete f.actions,(P=f.breakpoints)==null||P.forEach(D=>{var z;(z=D.actions)==null||z.forEach(k=>{(k.type==="Transition"||k.type==="Animation"||k.type==="SwitchCamera")&&(k.runMode="Toggle")})})):f.type==="Start"?(T=f.actions)==null||T.forEach(D=>{D.type==="Transition"&&(D.runMode="Once"),(D.type==="Animation"||D.type==="SwitchCamera")&&(D.runMode="Normal")}):f.type==="VariableChange"||f.type==="Scroll"?(M=f.actions)==null||M.forEach(D=>{D.type==="Transition"&&(D.runMode="Repeat"),(D.type==="Animation"||D.type==="SwitchCamera")&&(D.runMode="Normal")}):f.type==="Conditional"&&(delete f.actions,(O=f.inActions)==null||O.forEach(D=>{D.type==="Transition"&&(D.runMode="Repeat"),(D.type==="Animation"||D.type==="SwitchCamera")&&(D.runMode="Normal")}),(I=f.outActions)==null||I.forEach(D=>{D.type==="Transition"&&(D.runMode="Repeat"),(D.type==="Animation"||D.type==="SwitchCamera")&&(D.runMode="Normal")}))}))})}function u7(r){r.shared.userAPIs=Xi({},Ze.prototype),r.shared.userWebhooks=Xi({},Ze.prototype),r.shared.lib&&(r.shared.lib.userAPIs=Gs.defaultData().userAPIs,r.shared.lib.userWebhooks=Gs.defaultData().userWebhooks)}function h7(r){r.scene.publish.settings.videoStatic===void 0&&(r.scene.publish.settings.videoStatic=ms.defaultData.settings.videoStatic)}function m0(r){let a=r.schema??0;if(a!==Do){console.warn("updating from ",a,"to ",Do),kD(r,a),a<100&&(r.scene.publish.joystickSizeAndXYOffset===void 0&&(r.scene.publish.joystickSizeAndXYOffset=ms.defaultData.joystickSizeAndXYOffset),r.schema=100),a<101&&(Pa(r,GD),Ca(r,GD),r.schema=101),a<102&&(t7(r),r.schema=102),a<104&&(r.shared.catelogs=new Ze,r.shared.lib=Gs.defaultData(),r.schema=104),a<105&&(i7(r),r.scene.objects.traverse((n,o)=>{HD(o)}),r.schema=105);for(let n of Object.values(r.shared.lib.components))s7(n);a<106&&(n7(r),r.schema=106),a<107&&(r.shared.lib.variables=Gs.defaultData().variables,r.schema=107),a<109&&(o7(r),r.schema=109),a<110&&(a7(r),r.schema=110),a<111&&(r.scene.objects.traverse((n,o)=>{r7(o)}),r.schema=111),a<112&&(l7(r),r.schema=112),a<113&&(c7(r),r.schema=113),a<114&&(r.scene.publish.settings.web.imageQuality===void 0&&(r.scene.publish.settings.web.imageQuality=70),r.schema=114),a<115&&(u7(r),r.schema=115),a<116&&(h7(r),r.schema=116)}}var td;(r=>{r.defaultData={schema:Do,scene:Ma.defaultData,frames:new Ze().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",rd.defaultData),shared:{...bn.emptyData(),colors:bn.defaultColors()}},r.emptyDataForImports=function(){let y=Ma.emptyDataWithPage();return{schema:Do,scene:y,frames:new Ze().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",rd.defaultData),shared:{...bn.emptyData(),colors:bn.defaultColors(),images:bn.defaultImages()}}},r.emptyData=function(){return{schema:Do,scene:Ma.emptyDataWithPage(),frames:new Ze().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",rd.defaultData),shared:bn.emptyData()}},r.clipboard2dData=function(){return{schema:Do,scene:Ma.emptyData(),frames:new Ze,shared:bn.emptyData()}},r.collabHelper={...Qp,updateSchema(y){return(y.schema??0)<Do?Tl(y,m0):(y.schema??0)-Do}};function a(y){let x=r.collabHelper.updateSchema(y);return typeof x=="number"?x===0?y:null:x.data}r.updateSchemaDirectly=a;function n(y){return{...y,shared:{...y.shared,lib:Gs.defaultData()}}}r.withoutLib=n;function o(y,x){let b=y.scene.objects.get(x);if(b&&b.data.type==="Component")return b;{let _=y.shared.lib.components[x];if(_)return _.asset}}r.getComponentData=o;function f(y){let x=Object.values(y.shared.userAPIs);for(let b of x){let _=b.headers;for(let S of _)if(S.data.key.toLowerCase()==="authorization"&&S.data.value!=="")return!0}return!1}r.hasSensitiveData=f})(td||(td={}));var g0;(r=>r.emptyImage={data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQYV2NgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII=",name:"empty"})(g0||(g0={}));var qD;(r=>{function a(n){return!0}r.is=a})(qD||(qD={}));var y0;(r=>{r.defaultData={position:[0,0],scale:[1,1],rotation:0,shear:[0,0]};function a(o,f){return{position:(f==null?void 0:f.position)??o.position,rotation:(f==null?void 0:f.rotation)??o.rotation,scale:(f==null?void 0:f.scale)??o.scale,shear:(f==null?void 0:f.shear)??o.shear}}r.merge=a;function n(o,f){return xv({position:zs.isEqual(o.position,f.position)?void 0:f.position,rotation:o.rotation===f.rotation?void 0:f.rotation,scale:zs.isEqual(o.scale,f.scale)?void 0:f.scale,shear:o.shear&&f.shear&&zs.isEqual(o.shear,f.shear)?void 0:f.shear})}r.diff=n})(y0||(y0={}));var lA;(r=>r.defaultData={horizontalConstraint:0,verticalConstraint:0})(lA||(lA={}));var XD;(r=>r.defaultData={direction:"row",wrap:"unwrap",align:"top-left",gap:10,rowGap:10,autoGap:!1,autoRowGap:!1,leftPadding:8,rightPadding:8,topPadding:8,bottomPadding:8})(XD||(XD={}));var v0;(r=>r.defaultData={opacity:1,fill:{color:Tt.fromHexAndA(ni,1),enabled:!0},stroke:{color:Tt.from0to1([0,0,0,1]),thickness:1,enabled:!1,mode:"inside"},layerBlur:{radius:2,enabled:!1},backgroundBlur:{radius:2,enabled:!1},dropShadow:{offset:[10,10],blurRadius:10,color:Tt.from0to1([0,0,0,1]),enabled:!1,spread:0},innerShadow:{offset:[10,10],blurRadius:10,color:Tt.from0to1([0,0,0,1]),enabled:!1,spread:0}})(v0||(v0={}));var _a;(r=>{function a(x,b){return{name:b}}r.newEmpty=a;function n(x,b){if(b===void 0)return x;let _={...x},S=["width","height","cornerRadius"];for(let A of S)A in _&&A in b&&b[A]!==void 0&&Object.assign(_,{[A]:b[A]});return _}function o(x,b){if(b===void 0)return x;let _={...x};return"fill"in _&&"fill"in b&&b.fill!==void 0&&Object.assign(_,{fill:{..._.fill,...b.fill}}),"stroke"in _&&"stroke"in b&&b.stroke!==void 0&&Object.assign(_,{stroke:{..._.stroke,...b.stroke}}),"layerBlur"in _&&"layerBlur"in b&&b.layerBlur!==void 0&&Object.assign(_,{layerBlur:{..._.layerBlur,...b.layerBlur}}),"backgroundBlur"in _&&"backgroundBlur"in b&&b.backgroundBlur!==void 0&&Object.assign(_,{backgroundBlur:{..._.backgroundBlur,...b.backgroundBlur}}),"dropShadow"in _&&"dropShadow"in b&&b.dropShadow!==void 0&&Object.assign(_,{dropShadow:{..._.dropShadow,...b.dropShadow}}),"innerShadow"in _&&"innerShadow"in b&&b.innerShadow!==void 0&&Object.assign(_,{innerShadow:{..._.innerShadow,...b.innerShadow}}),_}function f(x,b){if(b===void 0)return x;let _={...x};return Object.assign(_,y0.merge(_,b)),_=n(_,b),_=o(_,b),_}r.patch=f;function y(x,b){let _,S=[];for(let[A,C]of Object.entries(b))A!=="name"&&(_===void 0&&(_={path:[],props:{},type:0},S.push(_)),_.props[A]=C);return S}r.toOps=y})(_a||(_a={}));var nm$2;(r=>r.defaultData={...y0.defaultData,...lA.defaultData,states:new Ue,events:new Ue,visible:!0,raycastLock:!1})(nm$2||(nm$2={}));var od;(r=>r.defaultData={...nm$2.defaultData,...v0.defaultData})(od||(od={}));var x0;(r=>r.defaultData={cornerRadius:[0,0,0,0]})(x0||(x0={}));var cA;(r=>r.defaultData={...od.defaultData,type:"ellipse2d",width:100,height:100,name:"Ellipse"})(cA||(cA={}));var ad;(r=>r.defaultData={...od.defaultData,...x0.defaultData,type:"rectangle2d",width:100,height:100,name:"Rectangle"})(ad||(ad={}));var uA;(r=>r.defaultData={...od.defaultData,type:"text2d",width:100,height:100,fontSize:12,lineHeight:1.2,letterSpacing:0,text:{textValue:"Hello world"},horizontalAlign:1,verticalAlign:1,textTransform:1,font:"Roboto_regular",name:"Text"})(uA||(uA={}));var hA;(r=>r.defaultData={...od.defaultData,type:"path2d",path:"",name:"Path"})(hA||(hA={}));var YD;(r=>{function a(n){return n.type==="ellipse2d"||n.type==="rectangle2d"||n.type==="text2d"||n.type==="vector2d"||n.type==="path2d"}r.is=a})(YD||(YD={}));var sm;(r=>r.defaultData={...nm$2.defaultData,name:"Group",type:"group2d"})(sm||(sm={}));var dA;(r=>r.defaultData=()=>({...nm$2.defaultData,...x0.defaultData,...v0.defaultData,name:"Frame",type:"frame2d",clipped:!0,width:200,height:200,fill:{color:Tt.fromHexAndA(4737101,1),enabled:!0},stroke:{color:Tt.fromHexAndA(0,1),thickness:1,enabled:!1,mode:"inside"},backgroundBlur:{radius:2,enabled:!1},layerBlur:{radius:2,enabled:!1}}))(dA||(dA={}));var Ia;(r=>{function a(x){switch(x){case"rectangle2d":return{...ad.defaultData};case"ellipse2d":return{...cA.defaultData};case"text2d":return{...uA.defaultData};case"vector2d":return{...ad.defaultData};case"path2d":return{...hA.defaultData};case"frame2d":return{...dA.defaultData()};case"group2d":return{...sm.defaultData}}}r.defaultData=a;function n(x){return"width"in x&&"height"in x?[typeof x.width=="number"?x.width*.5:0,typeof x.height=="number"?x.height*.5:0]:[0,0]}r.getPivot=n;function o(x){return x.type==="rectangle2d"||x.type==="ellipse2d"||x.type==="text2d"||x.type==="frame2d"}r.isResizeable=o;function f(x){return x.type==="frame2d"&&x.autoLayout!==void 0}r.isAutoLayoutable=f;function y(x){return x.type==="rectangle2d"||x.type==="frame2d"}r.hasCorners=y})(Ia||(Ia={}));var b0;(r=>(r.defaultData={name:"UI",type:"scene2d",objects:new vr},r.emptyData=function(){return{type:"scene2d",objects:new vr}}))(b0||(b0={}));function js(r,a=!1){let n=r[0].index!==null,o=new Set(Object.keys(r[0].attributes)),f=new Set(Object.keys(r[0].morphAttributes)),y={},x={},b=r[0].morphTargetsRelative,_=new Ce,S=0;for(let A=0;A<r.length;++A){let C=r[A],P=0;if(n!==(C.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+A+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let T in C.attributes){if(!o.has(T))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+A+'. All geometries must have compatible attributes; make sure "'+T+'" attribute exists among all geometries, or in none of them.'),null;y[T]===void 0&&(y[T]=[]),y[T].push(C.attributes[T]),P++}if(P!==o.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+A+". Make sure all geometries have the same number of attributes."),null;if(b!==C.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+A+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let T in C.morphAttributes){if(!f.has(T))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+A+".  .morphAttributes must be consistent throughout all geometries."),null;x[T]===void 0&&(x[T]=[]),x[T].push(C.morphAttributes[T])}if(a){let T;if(n)T=C.index.count;else if(C.attributes.position!==void 0)T=C.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+A+". The geometry must have either an index or a position attribute"),null;_.addGroup(S,T,A),S+=T}}if(n){let A=0,C=[];for(let P=0;P<r.length;++P){let T=r[P].index;for(let M=0;M<T.count;++M)C.push(T.getX(M)+A);A+=r[P].attributes.position.count}_.setIndex(C)}for(let A in y){let C=KD(y[A]);if(!C)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+A+" attribute."),null;_.setAttribute(A,C)}for(let A in x){let C=x[A][0].length;if(C===0)break;_.morphAttributes=_.morphAttributes||{},_.morphAttributes[A]=[];for(let P=0;P<C;++P){let T=[];for(let O=0;O<x[A].length;++O)T.push(x[A][O][P]);let M=KD(T);if(!M)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+A+" morphAttribute."),null;_.morphAttributes[A].push(M)}}return _}function KD(r){let a,n,o,f=0;for(let b=0;b<r.length;++b){let _=r[b];if(_.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(a===void 0&&(a=_.array.constructor),a!==_.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(n===void 0&&(n=_.itemSize),n!==_.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(o===void 0&&(o=_.normalized),o!==_.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;f+=_.array.length}let y=new a(f),x=0;for(let b=0;b<r.length;++b)y.set(r[b].array,x),x+=r[b].array.length;return new Ge(y,n,o)}function gs(r,a,n){return n.min.x=a[r],n.min.y=a[r+1],n.min.z=a[r+2],n.max.x=a[r+3],n.max.y=a[r+4],n.max.z=a[r+5],n}var Da=32;new Array(Da).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0}));var On=class{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(r,a){let n=1/0,o=-1/0;for(let f=0,y=r.length;f<y;f++){let x=r[f][a];n=x<n?x:n,o=x>o?x:o}this.min=n,this.max=o}setFromPoints(r,a){let n=1/0,o=-1/0;for(let f=0,y=a.length;f<y;f++){let x=a[f],b=r.dot(x);n=b<n?b:n,o=b>o?b:o}this.min=n,this.max=o}isSeparated(r){return this.min>r.max||r.min>this.max}};On.prototype.setFromBox=function(){let r=new E;return function(a,n){let o=n.min,f=n.max,y=1/0,x=-1/0;for(let b=0;b<=1;b++)for(let _=0;_<=1;_++)for(let S=0;S<=1;S++){r.x=o.x*b+f.x*(1-b),r.y=o.y*_+f.y*(1-_),r.z=o.z*S+f.z*(1-S);let A=a.dot(r);y=Math.min(A,y),x=Math.max(A,x)}this.min=y,this.max=x}}();var A7=function(){let r=new E,a=new E,n=new E;return function(o,f,y){let x=o.start,b=r,_=f.start,S=a;n.subVectors(x,_),r.subVectors(o.end,o.start),a.subVectors(f.end,f.start);let A=n.dot(S),C=S.dot(b),P=S.dot(S),T=n.dot(b),M=b.dot(b)*P-C*C,O,I;M!==0?O=(A*C-T*P)/M:O=0,I=(A+O*C)/P,y.x=O,y.y=I}}(),am=function(){let r=new V,a=new E,n=new E;return function(o,f,y,x){A7(o,f,r);let b=r.x,_=r.y;if(b>=0&&b<=1&&_>=0&&_<=1){o.at(b,y),f.at(_,x);return}else if(b>=0&&b<=1){_<0?f.at(0,x):f.at(1,x),o.closestPointToPoint(x,!0,y);return}else if(_>=0&&_<=1){b<0?o.at(0,y):o.at(1,y),f.closestPointToPoint(y,!0,x);return}else{let S;b<0?S=o.start:S=o.end;let A;_<0?A=f.start:A=f.end;let C=a,P=n;if(o.closestPointToPoint(A,!0,a),f.closestPointToPoint(S,!0,n),C.distanceToSquared(A)<=P.distanceToSquared(S)){y.copy(C),x.copy(A);return}else{y.copy(S),x.copy(P);return}}}}(),eO=function(){let r=new E,a=new E,n=new Gr,o=new Pi;return function(f,y){let{radius:x,center:b}=f,{a:_,b:S,c:A}=y;if(o.start=_,o.end=S,o.closestPointToPoint(b,!0,r).distanceTo(b)<=x||(o.start=_,o.end=A,o.closestPointToPoint(b,!0,r).distanceTo(b)<=x)||(o.start=S,o.end=A,o.closestPointToPoint(b,!0,r).distanceTo(b)<=x))return!0;let C=y.getPlane(n);if(Math.abs(C.distanceToPoint(b))<=x){let P=C.projectPoint(b,a);if(y.containsPoint(P))return!0}return!1}}(),E7=1e-15;function cd(r){return Math.abs(r)<E7}var Rn=class extends _r{constructor(...r){super(...r),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new E),this.satBounds=new Array(4).fill().map(()=>new On),this.points=[this.a,this.b,this.c],this.sphere=new Nr,this.plane=new Gr,this.needsUpdate=!0}intersectsSphere(r){return eO(r,this)}update(){let r=this.a,a=this.b,n=this.c,o=this.points,f=this.satAxes,y=this.satBounds,x=f[0],b=y[0];this.getNormal(x),b.setFromPoints(x,o);let _=f[1],S=y[1];_.subVectors(r,a),S.setFromPoints(_,o);let A=f[2],C=y[2];A.subVectors(a,n),C.setFromPoints(A,o);let P=f[3],T=y[3];P.subVectors(n,r),T.setFromPoints(P,o),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(x,r),this.needsUpdate=!1}};Rn.prototype.closestPointToSegment=function(){let r=new E,a=new E,n=new Pi;return function(o,f=null,y=null){let{start:x,end:b}=o,_=this.points,S,A=1/0;for(let C=0;C<3;C++){let P=(C+1)%3;n.start.copy(_[C]),n.end.copy(_[P]),am(n,o,r,a),S=r.distanceToSquared(a),S<A&&(A=S,f&&f.copy(r),y&&y.copy(a))}return this.closestPointToPoint(x,r),S=x.distanceToSquared(r),S<A&&(A=S,f&&f.copy(r),y&&y.copy(x)),this.closestPointToPoint(b,r),S=b.distanceToSquared(r),S<A&&(A=S,f&&f.copy(r),y&&y.copy(b)),Math.sqrt(A)}}();Rn.prototype.intersectsTriangle=function(){let r=new Rn,a=new Array(3),n=new Array(3),o=new On,f=new On,y=new E,x=new E,b=new E,_=new E,S=new Pi,A=new Pi,C=new Pi;return function(P,T=null,M=!1){this.needsUpdate&&this.update(),P.isExtendedTriangle?P.needsUpdate&&P.update():(r.copy(P),r.update(),P=r);let O=this.plane,I=P.plane;if(Math.abs(O.normal.dot(I.normal))>1-1e-10){let D=this.satBounds,z=this.satAxes;n[0]=P.a,n[1]=P.b,n[2]=P.c;for(let R=0;R<4;R++){let F=D[R],B=z[R];if(o.setFromPoints(B,n),F.isSeparated(o))return!1}let k=P.satBounds,L=P.satAxes;a[0]=this.a,a[1]=this.b,a[2]=this.c;for(let R=0;R<4;R++){let F=k[R],B=L[R];if(o.setFromPoints(B,a),F.isSeparated(o))return!1}for(let R=0;R<4;R++){let F=z[R];for(let B=0;B<4;B++){let N=L[B];if(y.crossVectors(F,N),o.setFromPoints(y,a),f.setFromPoints(y,n),o.isSeparated(f))return!1}}return T&&(M||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),T.start.set(0,0,0),T.end.set(0,0,0)),!0}else{let D=this.points,z=!1,k=0;for(let $=0;$<3;$++){let te=D[$],ee=D[($+1)%3];S.start.copy(te),S.end.copy(ee),S.delta(x);let q=z?A.start:A.end,Z=cd(I.distanceToPoint(te));if(cd(I.normal.dot(x))&&Z){A.copy(S),k=2;break}if((I.intersectLine(S,q)||Z)&&!cd(q.distanceTo(ee))){if(k++,z)break;z=!0}}if(k===1&&P.containsPoint(A.end))return T&&(T.start.copy(A.end),T.end.copy(A.end)),!0;if(k!==2)return!1;let L=P.points,R=!1,F=0;for(let $=0;$<3;$++){let te=L[$],ee=L[($+1)%3];S.start.copy(te),S.end.copy(ee),S.delta(b);let q=R?C.start:C.end,Z=cd(O.distanceToPoint(te));if(cd(O.normal.dot(b))&&Z){C.copy(S),F=2;break}if((O.intersectLine(S,q)||Z)&&!cd(q.distanceTo(ee))){if(F++,R)break;R=!0}}if(F===1&&this.containsPoint(C.end))return T&&(T.start.copy(C.end),T.end.copy(C.end)),!0;if(F!==2)return!1;if(A.delta(x),C.delta(b),x.dot(b)<0){let $=C.start;C.start=C.end,C.end=$}let B=A.start.dot(x),N=A.end.dot(x),j=C.start.dot(x),G=C.end.dot(x),Y=N<j,X=B<G;return B!==G&&j!==N&&Y===X?!1:(T&&(_.subVectors(A.start,C.start),_.dot(x)>0?T.start.copy(A.start):T.start.copy(C.start),_.subVectors(A.end,C.end),_.dot(x)<0?T.end.copy(A.end):T.end.copy(C.end)),!0)}}}();Rn.prototype.distanceToPoint=function(){let r=new E;return function(a){return this.closestPointToPoint(a,r),a.distanceTo(r)}}();Rn.prototype.distanceToTriangle=function(){let r=new E,a=new E,n=["a","b","c"],o=new Pi,f=new Pi;return function(y,x=null,b=null){let _=x||b?o:null;if(this.intersectsTriangle(y,_))return(x||b)&&(x&&_.getCenter(x),b&&_.getCenter(b)),0;let S=1/0;for(let A=0;A<3;A++){let C,P=n[A],T=y[P];this.closestPointToPoint(T,r),C=T.distanceToSquared(r),C<S&&(S=C,x&&x.copy(r),b&&b.copy(T));let M=this[P];y.closestPointToPoint(M,r),C=M.distanceToSquared(r),C<S&&(S=C,x&&x.copy(M),b&&b.copy(r))}for(let A=0;A<3;A++){let C=n[A],P=n[(A+1)%3];o.set(this[C],this[P]);for(let T=0;T<3;T++){let M=n[T],O=n[(T+1)%3];f.set(y[M],y[O]),am(o,f,r,a);let I=r.distanceToSquared(a);I<S&&(S=I,x&&x.copy(r),b&&b.copy(a))}}return Math.sqrt(S)}}();var Ln=class{constructor(r,a,n){this.isOrientedBox=!0,this.min=new E,this.max=new E,this.matrix=new ue,this.invMatrix=new ue,this.points=new Array(8).fill().map(()=>new E),this.satAxes=new Array(3).fill().map(()=>new E),this.satBounds=new Array(3).fill().map(()=>new On),this.alignedSatBounds=new Array(3).fill().map(()=>new On),this.needsUpdate=!1,r&&this.min.copy(r),a&&this.max.copy(a),n&&this.matrix.copy(n)}set(r,a,n){this.min.copy(r),this.max.copy(a),this.matrix.copy(n),this.needsUpdate=!0}copy(r){this.min.copy(r.min),this.max.copy(r.max),this.matrix.copy(r.matrix),this.needsUpdate=!0}};Ln.prototype.update=function(){return function(){let r=this.matrix,a=this.min,n=this.max,o=this.points;for(let _=0;_<=1;_++)for(let S=0;S<=1;S++)for(let A=0;A<=1;A++){let C=1*_|2*S|4*A,P=o[C];P.x=_?n.x:a.x,P.y=S?n.y:a.y,P.z=A?n.z:a.z,P.applyMatrix4(r)}let f=this.satBounds,y=this.satAxes,x=o[0];for(let _=0;_<3;_++){let S=y[_],A=f[_],C=1<<_,P=o[C];S.subVectors(x,P),A.setFromPoints(S,o)}let b=this.alignedSatBounds;b[0].setFromPointsField(o,"x"),b[1].setFromPointsField(o,"y"),b[2].setFromPointsField(o,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();Ln.prototype.intersectsBox=function(){let r=new On;return function(a){this.needsUpdate&&this.update();let n=a.min,o=a.max,f=this.satBounds,y=this.satAxes,x=this.alignedSatBounds;if(r.min=n.x,r.max=o.x,x[0].isSeparated(r)||(r.min=n.y,r.max=o.y,x[1].isSeparated(r))||(r.min=n.z,r.max=o.z,x[2].isSeparated(r)))return!1;for(let b=0;b<3;b++){let _=y[b],S=f[b];if(r.setFromBox(_,a),S.isSeparated(r))return!1}return!0}}();Ln.prototype.intersectsTriangle=function(){let r=new Rn,a=new Array(3),n=new On,o=new On,f=new E;return function(y){this.needsUpdate&&this.update(),y.isExtendedTriangle?y.needsUpdate&&y.update():(r.copy(y),r.update(),y=r);let x=this.satBounds,b=this.satAxes;a[0]=y.a,a[1]=y.b,a[2]=y.c;for(let C=0;C<3;C++){let P=x[C],T=b[C];if(n.setFromPoints(T,a),P.isSeparated(n))return!1}let _=y.satBounds,S=y.satAxes,A=this.points;for(let C=0;C<3;C++){let P=_[C],T=S[C];if(n.setFromPoints(T,A),P.isSeparated(n))return!1}for(let C=0;C<3;C++){let P=b[C];for(let T=0;T<4;T++){let M=S[T];if(f.crossVectors(P,M),n.setFromPoints(f,a),o.setFromPoints(f,A),n.isSeparated(o))return!1}}return!0}}();Ln.prototype.closestPointToPoint=function(){return function(r,a){return this.needsUpdate&&this.update(),a.copy(r).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),a}}();Ln.prototype.distanceToPoint=function(){let r=new E;return function(a){return this.closestPointToPoint(a,r),a.distanceTo(r)}}();Ln.prototype.distanceToBox=function(){let r=["x","y","z"],a=new Array(12).fill().map(()=>new Pi),n=new Array(12).fill().map(()=>new Pi),o=new E,f=new E;return function(y,x=0,b=null,_=null){if(this.needsUpdate&&this.update(),this.intersectsBox(y))return(b||_)&&(y.getCenter(f),this.closestPointToPoint(f,o),y.closestPointToPoint(o,f),b&&b.copy(o),_&&_.copy(f)),0;let S=x*x,A=y.min,C=y.max,P=this.points,T=1/0;for(let O=0;O<8;O++){let I=P[O];f.copy(I).clamp(A,C);let D=I.distanceToSquared(f);if(D<T&&(T=D,b&&b.copy(I),_&&_.copy(f),D<S))return Math.sqrt(D)}let M=0;for(let O=0;O<3;O++)for(let I=0;I<=1;I++)for(let D=0;D<=1;D++){let z=(O+1)%3,k=(O+2)%3,L=I<<z|D<<k,R=1<<O|I<<z|D<<k,F=P[L],B=P[R];a[M].set(F,B);let N=r[O],j=r[z],G=r[k],Y=n[M],X=Y.start,$=Y.end;X[N]=A[N],X[j]=I?A[j]:C[j],X[G]=D?A[G]:C[j],$[N]=C[N],$[j]=I?A[j]:C[j],$[G]=D?A[G]:C[j],M++}for(let O=0;O<=1;O++)for(let I=0;I<=1;I++)for(let D=0;D<=1;D++){f.x=O?C.x:A.x,f.y=I?C.y:A.y,f.z=D?C.z:A.z,this.closestPointToPoint(f,o);let z=f.distanceToSquared(o);if(z<T&&(T=z,b&&b.copy(o),_&&_.copy(f),z<S))return Math.sqrt(z)}for(let O=0;O<12;O++){let I=a[O];for(let D=0;D<12;D++){let z=n[D];am(I,z,o,f);let k=o.distanceToSquared(f);if(k<T&&(T=k,b&&b.copy(o),_&&_.copy(f),k<S))return Math.sqrt(k)}}return Math.sqrt(T)}}();new E;new E;new E;new V;new V;new V;new E;new E;new E;new E;function ys(r,a,n,o){let f=r.a,y=r.b,x=r.c,b=a,_=a+1,S=a+2;n&&(b=n.getX(a),_=n.getX(a+1),S=n.getX(a+2)),f.x=o.getX(b),f.y=o.getY(b),f.z=o.getZ(b),y.x=o.getX(_),y.y=o.getY(_),y.z=o.getZ(_),x.x=o.getX(S),x.y=o.getY(S),x.z=o.getZ(S)}function Oa(r,a){return a[r+15]===65535}function jc(r,a){return a[r+6]}function pd(r,a){return a[r+14]}var yd=new Xt;new E;(function(){let r=new Rn,a=new Rn,n=new ue,o=new Ln,f=new Ln;return function y(x,b,_,S,A=null){let C=x*2,P=vd,T=Nl,M=Fl;if(A===null&&(_.boundingBox||_.computeBoundingBox(),o.set(_.boundingBox.min,_.boundingBox.max,S),A=o),Oa(C,T)){let O=b,I=O.index,D=O.attributes.position,z=_.index,k=_.attributes.position,L=jc(x,M),R=pd(C,T);if(n.copy(S).invert(),_.boundsTree)return gs(x,P,f),f.matrix.copy(n),f.needsUpdate=!0,_.boundsTree.shapecast({intersectsBounds:F=>f.intersectsBox(F),intersectsTriangle:F=>{F.a.applyMatrix4(S),F.b.applyMatrix4(S),F.c.applyMatrix4(S),F.needsUpdate=!0;for(let B=L*3,N=(R+L)*3;B<N;B+=3)if(ys(a,B,I,D),a.needsUpdate=!0,F.intersectsTriangle(a))return!0;return!1}});for(let F=L*3,B=R+L*3;F<B;F+=3){ys(r,F,I,D),r.a.applyMatrix4(n),r.b.applyMatrix4(n),r.c.applyMatrix4(n),r.needsUpdate=!0;for(let N=0,j=z.count;N<j;N+=3)if(ys(a,N,z,k),a.needsUpdate=!0,r.intersectsTriangle(a))return!0}}else{let O=x+8,I=M[x+6];return gs(O,P,yd),!!(A.intersectsBox(yd)&&y(O,b,_,S,A)||(gs(I,P,yd),A.intersectsBox(yd)&&y(I,b,_,S,A)))}}})();var vd,Nl,Fl;new Xt;new Xt;new ue;new Ln;new Ln;new E;new E;new E;new E;new E;new Xt;var Ix=Za(hO()),O7=.5*(Math.sqrt(3)-1),hm=(3-Math.sqrt(3))/6,R7=1/3,Lo=1/6,dm=r=>Math.floor(r)|0,dO=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]),MA=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function fO(r=Math.random){let a=mO(r),n=new Float64Array(a).map(f=>dO[f%12*2]),o=new Float64Array(a).map(f=>dO[f%12*2+1]);return function(f,y){let x=0,b=0,_=0,S=(f+y)*O7,A=dm(f+S),C=dm(y+S),P=(A+C)*hm,T=A-P,M=C-P,O=f-T,I=y-M,D,z;O>I?(D=1,z=0):(D=0,z=1);let k=O-D+hm,L=I-z+hm,R=O-1+2*hm,F=I-1+2*hm,B=A&255,N=C&255,j=.5-O*O-I*I;if(j>=0){let X=B+a[N],$=n[X],te=o[X];j*=j,x=j*j*($*O+te*I)}let G=.5-k*k-L*L;if(G>=0){let X=B+D+a[N+z],$=n[X],te=o[X];G*=G,b=G*G*($*k+te*L)}let Y=.5-R*R-F*F;if(Y>=0){let X=B+1+a[N+1],$=n[X],te=o[X];Y*=Y,_=Y*Y*($*R+te*F)}return 70*(x+b+_)}}function pO(r=Math.random){let a=mO(r),n=new Float64Array(a).map(y=>MA[y%12*3]),o=new Float64Array(a).map(y=>MA[y%12*3+1]),f=new Float64Array(a).map(y=>MA[y%12*3+2]);return function(y,x,b){let _,S,A,C,P=(y+x+b)*R7,T=dm(y+P),M=dm(x+P),O=dm(b+P),I=(T+M+O)*Lo,D=T-I,z=M-I,k=O-I,L=y-D,R=x-z,F=b-k,B,N,j,G,Y,X;L>=R?R>=F?(B=1,N=0,j=0,G=1,Y=1,X=0):L>=F?(B=1,N=0,j=0,G=1,Y=0,X=1):(B=0,N=0,j=1,G=1,Y=0,X=1):R<F?(B=0,N=0,j=1,G=0,Y=1,X=1):L<F?(B=0,N=1,j=0,G=0,Y=1,X=1):(B=0,N=1,j=0,G=1,Y=1,X=0);let $=L-B+Lo,te=R-N+Lo,ee=F-j+Lo,q=L-G+2*Lo,Z=R-Y+2*Lo,U=F-X+2*Lo,W=L-1+3*Lo,H=R-1+3*Lo,K=F-1+3*Lo,le=T&255,me=M&255,ne=O&255,pe=.6-L*L-R*R-F*F;if(pe<0)_=0;else{let ve=le+a[me+a[ne]];pe*=pe,_=pe*pe*(n[ve]*L+o[ve]*R+f[ve]*F)}let ge=.6-$*$-te*te-ee*ee;if(ge<0)S=0;else{let ve=le+B+a[me+N+a[ne+j]];ge*=ge,S=ge*ge*(n[ve]*$+o[ve]*te+f[ve]*ee)}let ye=.6-q*q-Z*Z-U*U;if(ye<0)A=0;else{let ve=le+G+a[me+Y+a[ne+X]];ye*=ye,A=ye*ye*(n[ve]*q+o[ve]*Z+f[ve]*U)}let _e=.6-W*W-H*H-K*K;if(_e<0)C=0;else{let ve=le+1+a[me+1+a[ne+1]];_e*=_e,C=_e*_e*(n[ve]*W+o[ve]*H+f[ve]*K)}return 32*(_+S+A+C)}}function mO(r){let a=new Uint8Array(512);for(let n=0;n<512/2;n++)a[n]=n;for(let n=0;n<512/2-1;n++){let o=n+~~(r()*(256-n)),f=a[n];a[n]=a[o],a[o]=f}for(let n=256;n<512;n++)a[n]=a[n-256];return a}var Hs=new _r,R0=class{constructor(r){this.weightAttribute=null;let a=r.geometry;if(!a.isBufferGeometry||a.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");a.index&&(a=a.toNonIndexed()),this.geometry=a,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.distribution=null}build(){let r=this.positionAttribute,a=new Float32Array(r.count/3);for(let o=0;o<r.count;o+=3){let f=1;Hs.a.fromBufferAttribute(r,o),Hs.b.fromBufferAttribute(r,o+1),Hs.c.fromBufferAttribute(r,o+2),f*=Hs.getArea(),a[o/3]=f}this.distribution=new Float32Array(r.count/3);let n=0;for(let o=0;o<a.length;o++)n+=a[o],this.distribution[o]=n;return this}setRandomGenerator(r){return this.randomFunction=r,this}sample(r,a){if(this.distribution){let n=this.distribution[this.distribution.length-1],o=this.binarySearch(this.randomFunction()*n);return this.sampleFace(o,r,a)}}binarySearch(r){if(!this.distribution)return 0;let a=this.distribution,n=0,o=a.length-1,f=-1;for(;n<=o;){let y=Math.ceil((n+o)/2);if(y===0||a[y-1]<=r&&a[y]>r){f=y;break}else r<a[y]?o=y-1:n=y+1}return f}sampleFace(r,a,n){let o=this.randomFunction(),f=this.randomFunction();return o+f>1&&(o=1-o,f=1-f),Hs.a.fromBufferAttribute(this.positionAttribute,r*3),Hs.b.fromBufferAttribute(this.positionAttribute,r*3+1),Hs.c.fromBufferAttribute(this.positionAttribute,r*3+2),a.set(0,0,0).addScaledVector(Hs.a,o).addScaledVector(Hs.b,f).addScaledVector(Hs.c,1-(o+f)),Hs.getNormal(n),this}},yO=Za(CA()),L7=new ue,B7=new ue,N7=new ue,Ra;(r=>{function a(n){return n&&n.__isSPEObject}r.is=a})(Ra||(Ra={}));var Sd=r=>class extends r{constructor(){super(...arguments),this.previousModelViewMatrix=new ue,this.copyPreviousMatrix=!0,this.hiddenMatrix=new ue,this.matrixWorldRigid=new ue,this.shearScale=new ue,this.shearScaleInv=new ue}get __isSPEObject(){return!0}isDescendantOf(a){a instanceof _t&&(a=a.uuid);let n=this;for(;n.parent;){if(n.parent.uuid===a)return!0;n=n.parent}return!1}updateMatrixWorld(a){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||a)&&(this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,a=!0);for(let n of this.children)n.updateMatrixWorld(a)}updateWorldMatrix(a,n){let o=this.parent;if(a&&o!==null&&o.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),n)for(let f of this.children)f.updateWorldMatrix(!1,!0)}traverseChildren(a,n=0){for(let o of this.children)Ra.is(o)&&o.traverseObject(a,n+1)}traverseObject(a,n=0){if(a(this,n)!==!0)for(let o of this.children)Ra.is(o)&&o.traverseObject(a,n+1)}updateMatrixWorldSVD(){let a=this.matrixWorld.elements,n=[[a[0],a[4],a[8]],[a[1],a[5],a[9]],[a[2],a[6],a[10]]],{u:o,v:f,q:y}=(0,yO.SVD)(n),x=L7.set(o[0][0],o[0][1],o[0][2],0,o[1][0],o[1][1],o[1][2],0,o[2][0],o[2][1],o[2][2],0,0,0,0,1),b=B7.set(f[0][0],f[0][1],f[0][2],0,f[1][0],f[1][1],f[1][2],0,f[2][0],f[2][1],f[2][2],0,0,0,0,1),_=N7.copy(b).transpose();this.shearScale.makeScale(y[0],y[1],y[2]).multiply(_).premultiply(b),this.shearScaleInv.copy(this.shearScale).invert(),this.matrixWorldRigid.multiplyMatrices(x,_).copyPosition(this.matrixWorld),y.every(S=>Math.abs(y[0]-S)<.01)?this.hasNonUniformScale=!1:this.hasNonUniformScale=!0}attach(a,n){this.updateWorldMatrix(!0,!1);let o=new ue().copy(this.matrixWorld).invert();return a.parent!==null&&(a.parent.updateWorldMatrix(!0,!1),o.multiply(a.parent.matrixWorld)),"hiddenMatrix"in a&&a.hiddenMatrix instanceof ue?a.hiddenMatrix.premultiply(o):a.applyMatrix4(o),a.updateWorldMatrix(!1,!1),this.add(a),n!==void 0&&(this.children.pop(),this.children.splice(n,0,a)),this}copy(a,n=!1){return super.copy(a,n),this.hasNonUniformScale=a.hasNonUniformScale,this}onAfterRender(a,n,o,f,y,x){this.copyPreviousMatrix&&this.previousModelViewMatrix.copy(this.modelViewMatrix)}},PA=class extends Sd(_t){},F7=r=>r.type==="Mesh",Dr=class extends PA{constructor(r){super(),this.object=r,this.matrixAutoUpdate=!1,this.hasNonUniformScale=r.hasNonUniformScale}raycast(r,a){}expand(){let r=0,a=this.object.entityChildren(r);for(;a;){let n=this.children[r];(n==null?void 0:n.object)!==a&&(n&&this.remove(n),n=new Dr(a),this.add(n),this.children.splice(r,0,this.children.pop()),n.matrixWorldNeedsUpdate=!0,n.matrixAutoUpdate=!1,n.matrix=a.matrix,n.hiddenMatrix=a.hiddenMatrix),n.expand(),r+=1,a=this.object.entityChildren(r)}for(;this.children.length>r;)this.remove(this.children[r])}get visible(){var r;return this.playModeVisible!==void 0?this.playModeVisible:this.object.visible||this.object.dataPatched.visible&&((r=this.object.dataPatched.cloner)==null?void 0:r.hideBase)===!0}set visible(r){}get castShadow(){return this.object.castShadow}set castShadow(r){}get receiveShadow(){return this.object.receiveShadow}set receiveShadow(r){}get isMesh(){return F7(this.object)}get isLight(){return this.object.isLight}get layers(){return this.object.layers}set layers(r){}get isCamera(){return!1}get geometry(){if(this.object.geometry)return this.object.geometry}get material(){if(this.object.material)return this.object.material}},Wc=new E,qc=new E,wd=new ue,xO=[new E(-1,1,1),new E(-1,-1,1),new E(1,-1,1),new E(1,1,1),new E(-1,1,-1),new E(-1,-1,-1),new E(1,-1,-1),new E(1,1,-1)],V7=[[0,3],[1,2],[5,6],[4,7],[0,1],[3,2],[7,6],[4,5],[0,4],[1,5],[2,6],[3,7]],U7=[[0,2],[7,5],[4,1],[3,6],[4,3],[1,6]],vO=(r,a,n)=>{r.updateEntityBoxSize(Wc,qc),wd.copy(a).multiply(r.matrixWorld),qc.x===0&&qc.y===0&&qc.z===0?n.push(new E(Wc.x,Wc.y,Wc.z).applyMatrix4(wd)):xO.forEach(o=>{n.push(o.clone().multiply(qc).add(Wc).applyMatrix4(wd))})},fm=class extends Xt{constructor(){super(...arguments),this.matrix=new ue,this.vertices=[],this.faces=[],this.edges=[],this.centerEdges=[]}copy(r){return super.copy(r),this.matrix.copy(r.matrix),this.vertices=r.vertices.map(a=>a.clone()),this.faces=r.faces.map(a=>a.clone()),this.edges=r.edges.map(a=>a.clone()),this.centerEdges=r.centerEdges.map(a=>a.clone()),this}setFromObjectSize(r,a=!1){r.updateWorldMatrix(!1,a),this.makeEmpty(),this.matrix.copy(r.matrixWorld);let n=new ue().copy(r.matrixWorld).invert();return this.expandByObjectSize(r,n,a)}expandByObjectSize(r,a,n=!1){let o=[];return n===!0?r.traverseEntity(f=>{if(f.visible||f.cloner&&f.data.visible){if(!("geometry"in f)){o.push(new E);return}vO(f,a,o)}}):vO(r,a,o),this.setFromPoints(o)}getCenter(r){return r=super.getCenter(r),r.applyMatrix4(this.matrix),r}getPositionToCenter(r){return r=super.getCenter(r),r.applyMatrix4(wd.copy(this.matrix).setPosition(0,0,0)),r}computeVertices(){this.getSize(qc).multiplyScalar(.5),this.getCenter(Wc),wd.copy(this.matrix).setPosition(Wc),this.vertices=xO.map(r=>r.clone().multiply(qc).applyMatrix4(wd))}computeEdges(){this.vertices.length>0&&this.computeVertices(),this.edges=V7.map(([r,a])=>new Pi(this.vertices[r],this.vertices[a])),this.centerEdges=this.edges.map(r=>r.getCenter(new E))}computeFaces(){this.vertices.length>0&&this.computeVertices(),this.faces=U7.map(([r,a])=>this.vertices[r].clone().add(this.vertices[a]).multiplyScalar(.5))}},Ws={Cloner:()=>{},changeEntityProptotype:()=>{},createEntity:()=>{}},IA=class extends Mp{constructor(){super()}getPoints(r=12){let a=[],n,o=this.getCurveLengths(),f=o[o.length-1]/o.length;for(let y=0,x=this.curves;y<x.length;y++){let b=x[y],_=y===0?o[y]:o[y]-o[y-1],S=Math.ceil(r*_/f),A=b.getPoints(S);for(let C=0;C<A.length;C++){let P=A[C];n&&n.equals(P)||(a.push(P),n=P)}}return this.autoClose&&a.length>1&&!a[a.length-1].equals(a[0])&&a.push(a[0]),a}},DA=.001;function OA(r,a,n){return a.clone().sub(r).cross(a.clone().sub(n)).length()<=DA}function _A(r,a){let n=new E(...r.position),o=new E(...r.controlNext.position),f=new E(...a.controlPrevious.position),y=new E(...a.position);return OA(n,o,y)&&OA(n,f,y)}function B0(r){let a=r.points.map(A=>new E(...A.data.position)),n=[r.points[0]],o=new E(...n[0].data.position);for(let A=0;A<r.points.length-1;A++)OA(o,a[A],a[A+1])||(n.push(r.points[A]),o=a[A]);n.push(r.points[r.points.length-1]);let f=r.isClosed,y=n.length-(f?0:1),x=n.length,b=[];for(let A=0;A<x;A++){let C=n[A].data,P=new E(...C.position),T=new E(...C.controlPrevious.position),M=new E(...C.controlNext.position),O={position:P,baseRoundness:C.roundness,controlPrevious:T,controlNext:M};if(C.roundness===0||!r.isClosed&&(A===0||A===x-1)){b[A]={...O,removedLength:0};continue}let I=f&&A==0?x-1:A-1,D=f&&A==x-1?0:A+1,z=n[I].data,k=n[D].data,L=new E(...z.position),R=new E(...k.position),F=L.clone().sub(P).normalize(),B=R.clone().sub(P).normalize();Object.assign(O,{prevDir:F,nextDir:B});let N=_A(z,C),j=_A(C,k);if(!N||!j)b[A]={...O,removedLength:0};else{let G=F.clone().add(B).normalize(),Y=G.clone().cross(F).length()/F.dot(G);b[A]={...O,tan:Y,removedLength:C.roundness/Y}}}for(let A=0;A<y;A++){let C=A,P=f&&A===x-1?0:A+1,T=b[C],M=b[P];if(T.removedLength!==0||M.removedLength!==0){let O=T.position.distanceTo(M.position);T.removedLength=Math.min(T.removedLength,O/2),M.removedLength=Math.min(M.removedLength,O/2)}}let _=[];for(let A=0;A<y;A++){let C=A,P=f&&A===x-1?0:A+1,T=b[C],M=b[P],O=null;if(!_A(n[C].data,n[P].data))T.position.distanceTo(M.position)>DA&&(O=new Pc(T.position,T.controlNext,M.controlPrevious,M.position));else{let I=T.position.clone(),D=M.position.clone();(T.removedLength!==0||M.removedLength!==0)&&(T.nextDir&&I.add(T.nextDir.clone().setLength(T.removedLength)),M.prevDir&&D.add(M.prevDir.clone().setLength(M.removedLength))),I.distanceTo(D)>DA&&(O=new Pc(I,I.clone().lerp(D,.3),D.clone().lerp(I,.3),D))}_[2*A+1]=O}for(let A=0;A<x;A++){let C=b[A];if(C.removedLength===0){_[2*A]=null;continue}let P=C.position,T=C.prevDir.clone().multiplyScalar(C.removedLength).add(P),M=C.nextDir.clone().multiplyScalar(C.removedLength).add(P),O=C.tan*C.removedLength,I=C.prevDir.clone().add(C.nextDir).normalize(),D=T.clone().lerp(M,.5),z=T.distanceTo(M)/2,k=I.clone().multiplyScalar(Math.sqrt(Math.pow(O,2)-Math.pow(z,2))).add(D),L=I.clone().multiplyScalar(-O).add(k),R=P.distanceTo(L)/P.distanceTo(D),F=C.prevDir.clone().multiplyScalar(R*P.distanceTo(T)).add(P),B=F.clone().lerp(L,2),N=T.clone().lerp(F,4/3),j=M.clone().lerp(B,4/3);_[2*A]=new Pc(T,N,j,M)}let S=new IA;return _.forEach(A=>{A&&S.add(A)}),S}var mt;(r=>{function a(n){return n&&n.__isEntity}r.is=a})(mt||(mt={}));var Bo=r=>mt.is(r),z7={type:"completeState",isfromEntity:!0},k7=["x","y","z"],RA=new E,G7=new E().set(0,1,0),Ad=r=>class extends Sd(r){constructor(){super(...arguments),this.raycastLock=!1,this.scaleLock=!1,this.disposed=!1,this.stateSelection=null,this.destroyedInAction=!1,this.instances=[],this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this._singleBBox=new fm,this._recursiveBBox=new fm,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this._needApplyPathSnapping=!0,this.attachedPaths=new Set}get __isEntity(){return!0}entityChildren(a){let n=this.children[a];if(mt.is(n))return n}entityChildrenCount(){let a=this.children.length;for(;a--;)if(mt.is(this.children[a]))return a+1;return 0}get isConcreteEntity(){return typeof this.identity=="string"}get isVirtualEntity(){return typeof this.identity!="string"}get isInstanceRoot(){return this.isConcreteEntity&&this.data.type==="Instance"}nearestInstanceSelfOrParent(){let a=this;for(;a.data.type!=="Instance";){let n=a.parent;if(mt.is(n))a=n;else return}return a}forInstancesRec(a){this.instances.forEach(n=>{n.disposed||a(n),n.forInstancesRec(a)})}super_Entity(a,n){typeof a=="string"&&(this.uuid=a),this.identity=a,this.data=n,this.matrixAutoUpdate=!1,this.dataPatched=this.data}changeSelectedState(a,n,o=!1){if(!(this.data.states.length===0&&!o)){for(let f of this.data.states)Ea.toOps(this.data,f.data).forEach(y=>{let x=jh.replaceProps(y,this.data);this.dataPatched=this.data,this.updateByPatchedOp(x,this.data,n)});if(a!==null){let f=this.data.states.data(a);f&&(this.dataPatched=Ea.patch(this.data,f),Ea.toOps(this.data,f).forEach(y=>{this.updateByPatchedOp(y,this.dataPatched,n)}))}o&&this.updateTransformState(this.dataPatched,n),this.stateSelection=a,this.updatePathSnapping(this.dataPatched.pathSnapping)}}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges(),this._singleBBox.computeFaces()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges(),this._recursiveBBox.computeFaces()),this._recursiveBBox}updateEntityBoxSize(a,n){a.setScalar(0),n.setScalar(0)}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(a=>{Bo(a)&&a.resetBBoxNeedsUpdateSelf()}),this.traverseEntity(a=>{a.resetBBoxNeedsUpdateSelf()})}find(a){let n;return this.traverseEntity(o=>{o.uuid===a&&(n=o)}),n}traverseSortNextHelper(){let a=this.parent;if(a){let n=a.children,o=n.indexOf(this)+1;if(mt.is(n[o]))return n[o];if(mt.is(a))return a.traverseSortNextHelper()}}sortNext(){let a=this.children;return this.children.length>0&&mt.is(this.children[0])?a[0]:this.traverseSortNextHelper()}goUp(a){let n=this;for(;a>0&&n!==null;)n=n.parent,a-=1;return n}hasAnccestorOrSelf(a){return this===a||this.hasAnccestor(a)}hasAnccestor(a){let n=this.parent;for(;n;){if(a===n)return!0;n=n.parent}return!1}countToAccestor(a){let n=0,o=this;for(;o!==a;){if(o===null)return-1;o=o.parent,n+=1}return n}forEachEntity(a){for(let n of this.children)Bo(n)&&a(n)}traverseEntityAncestors(a){this.traverseAncestors(n=>{mt.is(n)&&a(n)})}traverseConcreteEntity(a,n=0){if(a(this,n)!==!0)for(let o of this.children)Bo(o)&&o.isConcreteEntity&&o.traverseEntity(a,n+1)}traverseEntity(a,n=0){if(a(this,n)!==!0)for(let o of this.children)Bo(o)&&o.traverseEntity(a,n+1)}traverseVisibleEntity(a){a(this);for(let n of this.children)Bo(n)&&n.visible&&n.traverseVisibleEntity(a)}updateMatrix(){super.updateMatrix(),this.cloner&&this.cloner.onObjUpdateMatrix(),this.dispatchEvent({type:"updateMatrix"})}updateMatrixWorld(a){super.updateMatrixWorld(a),this.dispatchEvent({type:"updateMatrixWorld"})}copy(a,n=!1){return super.copy(a,n),this.dataPatched=a.dataPatched,this.raycastLock=a.raycastLock,this.scaleLock=a.scaleLock,this.hiddenMatrix.copy(a.hiddenMatrix),this}hasEntityChild(){return this.children.some(a=>Bo(a))}isAncestorOf(a){if(this.uuid===a)return!1;let n=!1;return this.traverseEntity(o=>{o.uuid===a&&(n=!0)}),n}toObjectTransformState(a=[]){this.updateWorldMatrix(!0,!1);let n={position:this.position.toArray(),rotation:[this.rotation.x*we.RAD2DEG,this.rotation.y*we.RAD2DEG,this.rotation.z*we.RAD2DEG],scale:this.scale.toArray(),hiddenMatrix:this.hiddenMatrix.toArray()};return Nh(n,a)}getTransformValues(a,n,o){return n[a].map((f,y)=>(o==null?void 0:o.shared.getVariable(f,[this.uuid,a,k7[y]]))??f)}updateTransformState(a,n){let o=!1;return a.position&&(this.position.fromArray(this.getTransformValues("position",a,n)),o=!0),a.rotation&&(RA.fromArray(this.getTransformValues("rotation",a,n)).multiplyScalar(we.DEG2RAD),this.rotation.setFromVector3(RA),o=!0),a.scale&&(this.scale.fromArray(this.getTransformValues("scale",a,n)),o=!0),a.hiddenMatrix!==void 0&&(o=!0,this.hiddenMatrix.fromArray(a.hiddenMatrix??_l.identity)),o&&(this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(f=>{f.invalidateClonerTransform(this)})),a.position&&a.rotation&&a.scale&&a.hiddenMatrix!==void 0&&this.updateWorldMatrix(!1,!0),o}onVariableUpdate(a=!1){if(a){this.resetBBoxNeedsUpdate();return}this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(n=>{n.invalidateClonerTransform(this)})}dispose(){this.disposed=!0,this.cloner&&(this.cloner.removeFromParent(),this.cloner=void 0)}disposeChildrenRecursively(){for(let a of this.children)mt.is(a)&&a.disposeRecursively()}disposeRecursively(){this.dispose(),this.children.forEach(a=>{mt.is(a)&&a.disposeRecursively()})}toState(a=[]){let n={name:this.name,visible:this.visible,raycastLock:this.raycastLock,...this.toObjectTransformState(a)};return Nh(n,a)}updateByObjUpdateOp(a,n){a!==void 0&&this.updateByOp({type:0,props:a,path:[]},{...this.data,...a},n,!1)}updateByOp(a,n,o,f){let y=this.data;this.data=n;let x=a,b=Vt(a.path,["states","*"]);if(b!==null){if(a.type===0){let[_]=b;if((this==null?void 0:this.stateSelection)===_){let S={...a.props};if(delete S.name,Object.values(a.props).some(A=>A===void 0)){let A=this.data;if(A!==void 0){let C=Ar.zoom(A,a.path.slice(2));if(C)for(let P in a.props)a.props[P]===void 0&&P in C&&(S[P]=C[P])}}x={...a,props:S,path:a.path.slice(2)}}}}else if(a.type===0){let _=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(_!==void 0){if(a.props.name!==void 0&&_.name){let{name:A,...C}=_;_=C}if(a.props.material!==void 0&&"material"in _){let{material:A,...C}=_;_=C}let S=Ar.removeOverridden(a.path,a.props,_);x={...a,props:S}}}if(this.updateByPatchedOpBase(x,Ea.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),o),Vt(a.path,["overrides"])){let _=[],S=[...a.path];for(_.push(S[1]),S.splice(0,2);S.length>0&&S[0]==="descendants";)_.push(S[1]),S.splice(0,2);if(_[_.length-1]===void 0){if(a.type===0)for(let A of Object.keys(a.props)){_[_.length-1]=A;let C=o.scene.findInstance([this.uuid,..._]);C&&(C.overrideData=a.props[A],C.updateState(wo.apply(C.component.data,C.overrideData),o))}}else{let A=o.scene.findInstance([this.uuid,..._]);if(A){let C=Ar.zoom(A.component.data,S);if(a={...a,path:S},a.type===0){let P=a.props;if(C)for(let[T,M]of Object.entries(a.props))M===void 0&&(P===a.props&&(P={...a.props}),P[T]=C[T]);a={...a,props:P}}A.overrideData=$h.resolve(n.overrides,_),A.updateByOp(a,Vr.applySimple(A.data,a),o,!1)}}}else if(this.instances.length>0){let _;if(a.path.length===0&&a.type===0){let S;for(let A of Io.rootOverrideProps)A in a.props&&(S===void 0&&(S={}),S[A]=a.props[A]);S&&(_={...a,props:S})}else for(let S of Io.rootOverrideProps)if(Vt(a.path,[S])){_=a;break}_!==void 0&&this.instances.forEach(S=>{if(S.isInstanceRoot){let A=wo.filterOp(S.overrideData,_);A&&S.updateByOp(A,Vr.applySimple(S.data,A),o,!0)}}),this.instances.forEach(S=>{if(!S.isInstanceRoot){let A=wo.filterOp(S.overrideData,a);if(A){let C;y===S.data&&a===A?C=n:C=Vr.applySimple(S.data,A),S.updateByOp(A,C,o,!0)}}})}}updateByPatchedOpBase(a,n,o){if(this.dataPatched=n,a.path.length===0&&a.type===0)a.props.type!==void 0&&!ks.is(a.props.type)&&Ws.changeEntityProptotype(this,n,o);else if(a.path.length===1&&a.path[0]==="geometry"&&a.type===0&&"type"in a.props){Ws.changeEntityProptotype(this,n,o);for(let f of this.children)mt.is(f)&&f.updateVisible(o.scene)}this.updateByPatchedOp(a,n,o)}updateByPatchedOp(a,n,o){var f;if(a.path.length===0&&a.type===0?this.updateState(a.props,o):a.type===0&&("resolutionLevel"in a.props||"useChildrenColors"in a.props)&&this.updateState(n,o),a.path[0]==="morphTargetInfluences"&&a.type===0){let y=(f=n.morphTargetInfluences.get(a.path[1]))==null?void 0:f.data.name;y&&this.updateMorphInfluences(y,o.shared.getVariable(a.props.value,[this.uuid,"morphTargetInfluences",y]))}if(Vt(a.path,["pathSnapping"])!==null&&this.updatePathSnapping(n.pathSnapping),Vt(a.path,["cloner"])!==null){let y=Vr.drop(a,1);y.path.length===0&&y.type===0&&y.props.disabled===!0?this.setFromClonerState(null,o):this.cloner?this.cloner.updateState(n.cloner,o.scene):(this.setFromClonerState(n.cloner,o),this.expandCloner(o.scene)),this.updateVisible(o.scene)}}updatePathSnapping(a=this.dataPatched.pathSnapping){this._updatedPathSnapping=a,this._needApplyPathSnapping=!0}get updatedPathSnapping(){return this._updatedPathSnapping}applyPathSnapping(a){var M,O,I,D,z;let n=((M=this._updatedPathSnapping)==null?void 0:M.pathId)??this.dataPatched.pathSnapping.pathId,o=((O=this._updatedPathSnapping)==null?void 0:O.slide)??this.dataPatched.pathSnapping.slide??0,f=((I=this._updatedPathSnapping)==null?void 0:I.offset)??this.dataPatched.pathSnapping.offset??0,y=((D=this._updatedPathSnapping)==null?void 0:D.orientation)??this.dataPatched.pathSnapping.orientation;if(n===null)return;let x=a.find(n);if(!x||this._needApplyPathSnapping===!1)return;this._needApplyPathSnapping=!1;let b=x.data;if(b.geometry.path.points.length<=1)return;let _=B0(b.geometry.path),S=(o+f)%1;o+f===1&&S===0&&(S=1);let A=null;try{A=_.curves.length?_.getPointAt(S):null}catch{}if(A===null)return;let C=this.parent?(z=this.parent)==null?void 0:z.matrixWorld:new ue;x.updateMatrixWorld();let P=new ue().multiplyMatrices(C.clone().invert(),x.matrixWorld);A.applyMatrix4(P);let T={position:A.toArray(),rotation:b.rotation};if(y==="tangential"){let k=new ue().extractRotation(x.matrixWorld),L=_.getTangentAt(S).applyMatrix4(k).add(A),R=new ue().lookAt(A,L,G7),F=RA.setFromEuler(new or().setFromRotationMatrix(R)).multiplyScalar(we.RAD2DEG);T={...T,rotation:F.toArray()}}this.updateTransformState(T),this.traverseEntity(k=>{k._cameraType&&k.dispatchEvent(z7)})}updateVisible(a){var o;if(this.visible=this.dataPatched.visible&&(!this.dataPatched.cloner||(this.dataPatched.cloner.disabled??!1)||((o=this.dataPatched.cloner)==null?void 0:o.hideBase)!==!0),!a)return;let n=!1;this.traverseEntity(f=>{if(f.data.type==="Splat")return n=!0,!0}),n&&a.reloadSplats()}updateState_Entity(a,n){a.name!==void 0&&(this.name=a.name),a.raycastLock!==void 0&&(this.raycastLock=a.raycastLock),a.visible!==void 0&&(this.updateVisible(n==null?void 0:n.scene),this.resetBBoxNeedsUpdate()),n&&"cloner"in a&&a.cloner!==void 0&&(this.setFromClonerState(a.cloner,n),this.updateVisible(n.scene)),this.updateTransformState(a,n)}get attachedSurfaceCloners(){return this.children.filter(a=>a instanceof Ws.Cloner&&a.parameters.type==="toObject")}setFromClonerState(a,n){this.disposed||(a===null||a.disabled?(this.cloner&&this.cloner.removeFromParent(),this.cloner=void 0):this.cloner===void 0?(this.cloner=new Ws.Cloner(this,a),n.scene.addPendingExpandCloner(this)):this.cloner.updateState(a,n.scene))}expandCloner(a){!this.disposed&&this.cloner&&this.cloner.expandClones(a)}invalidateClonerTransform(a){this.cloner&&this.cloner.invalidateTransform(a)}requestRender(){this.dispatchEvent({type:"requestRender"})}},N0=class{static create(r){return this.build(this.normalizeInputs(r))}static normalizeInputs(r,a){var _,S;let n=(_=r.parameters)==null?void 0:_.radiusTop,o=(S=r.parameters)==null?void 0:S.radiusBottom,f=Object.assign({},(a==null?void 0:a.parameters)??{width:100,radialSegments:64,heightSegments:1,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadius:8,cornerSegments:8,hollow:0},r.parameters);f.thetaLength=we.clamp(f.thetaLength,0,360);let y=f.width/2,x=f.radiusTop??y,b=f.radiusBottom??y;if(x===b?(x=y,b=y):x>b?(x=y,b=b*y/x):(x=x*y/b,b=y),f.shapeBlendNode){x=n??y,b=o??y;let A=Math.max(x,b)*2;f.width=A,f.depth=A}return{parameters:Object.assign(f,{width:Math.abs(f.width),height:Math.abs(f.height??f.width),depth:Math.abs(f.depth??f.width),radiusTop:x,radiusBottom:b})}}static build(r){let{width:a,depth:n,height:o,radialSegments:f,heightSegments:y,openEnded:x,thetaStart:b,thetaLength:_,radiusTop:S,radiusBottom:A,cornerRadius:C,cornerSegments:P,hollow:T}=r.parameters,M;return _===0?(M=new Ce,M.setAttribute("position",new Te([],3))):C||T?M=new pm(S,A,o,f,y,x,b,_*Math.PI/180,C,C,P,T):M=new Ic(S,A,o,f,y,x,b,_*Math.PI/180),M.scale(1,1,n/a),Object.assign(M,{userData:{...r,type:"CylinderGeometry"}})}};function Vl(r,a,n){n.x=r.x*a.x,n.y=r.y,n.z=r.x*a.y}function bO(r){return new V(r.y,-r.x)}var pm=class extends Ce{constructor(r,a,n,o,f,y,x,b,_,S,A,C,P=!1){super(),this.type="RoundedCylinderBufferGeometry",r=r!==void 0?r:1,a=a!==void 0?a:1,n=n||1,o=Math.floor(o)||8,f=Math.floor(f)||1,y=y!==void 0?y:!1,x=x!==void 0?x:0,b=b!==void 0?b:Math.PI*2,y&&(_=0,S=0);let T=[],M=[],O=[],I=[],D=0,z=n/2,k=new E,L=new E;P&&r==0&&(r=_),P&&a==0&&(a=S);let R=new V(r,z),F=new V(a,-z),B=null,N=null,j=null,G=null,Y=R.clone().sub(F),X=0,$=0,te=0;C>0&&(X=Math.min(r,a)*(1-C),$=r-X,te=a-X);let ee=R.clone();ee.x-=X;let q=Math.PI-Y.angle(),Z=Y.angle(),U=Math.tan(Z/2),W=Math.tan(q/2),H=U+W,K=C?H:W,le=C?H:U;if(_=Math.min(_,(r-$)/K,Y.length()/H),S=Math.min(S,(a-te)/le,Y.length()/H),_>0){let _e=_/U;B=R.clone().sub(new V(_e,_)),C&&(j=B.clone(),j.x-=X-H*_),R.sub(Y.clone().setLength(_e))}if(S>0){let _e=S/W;N=F.clone().sub(new V(_e,-S)),F.add(Y.clone().setLength(_e)),C&&(G=N.clone(),G.x-=X-H*S,ee.sub(Y.clone().setLength(_e)))}Y=R.clone().sub(F);let me=Y.length()<.5,ne=[];for(let _e=0;_e<=o;_e++){let ve=[],Ee=_e/o,xe=Ee*b+x,Me=new V(Math.sin(xe),Math.cos(xe));G&&N?(pe(ve,Ee,Me,q,S,G,-1,!0),pe(ve,Ee,Me,Z,S,N,-1,!1)):N?(ge(ve,Me,N.x,0,-1),pe(ve,Ee,Me,Z,S,N,-1,!1)):y||ge(ve,Me,a,te,-1);let Pe=bO(Y).normalize();if(Vl(Pe,Me,k),!me)for(let be=0;be<=f;be++){let Oe=be/f,Be=Y.clone().multiplyScalar(Oe).add(F);Vl(Be,Me,L),M.push(L.x,L.y,L.z),O.push(k.x,k.y,k.z),I.push(Ee,.5+L.y/n),ve.push(D++)}if(j&&B?(pe(ve,Ee,Me,q,_,B,1,!1),pe(ve,Ee,Me,Z,_,j,1,!0)):B?(pe(ve,Ee,Me,q,_,B,1,!1),ge(ve,Me,B.x,0,1)):y||ge(ve,Me,r,$,1),C&&!me){let be=bO(Y).multiplyScalar(-1).normalize();Vl(be,Me,k);for(let Oe=0;Oe<=f;Oe++){let Be=Oe/f,oe=Y.clone().multiplyScalar(-Be).add(ee);Vl(oe,Me,L),M.push(L.x,L.y,L.z),O.push(k.x,k.y,k.z),I.push(Ee,.5+L.y/n),ve.push(D++)}}C&&!y&&ve.push(ve[0]),ne.push(ve)}for(let _e=0;_e<ne.length-1;_e++)for(let ve=0;ve<ne[0].length-1;ve++){if(y&&C&&ve==f)continue;let Ee=ne[_e][ve],xe=ne[_e+1][ve],Me=ne[_e+1][ve+1],Pe=ne[_e][ve+1],be=M[Me*3+0],Oe=M[Me*3+2];T.push(Ee,xe,Pe),(be!=0||Oe!=0)&&T.push(xe,Me,Pe)}b<Math.PI*2&&(ye(-1,ne[0],x),ye(1,ne[ne.length-1],x+b)),this.setIndex(T),this.setAttribute("position",new Te(M,3)),this.setAttribute("normal",new Te(O,3)),this.setAttribute("uv",new Te(I,2));function pe(_e,ve,Ee,xe,Me,Pe,be,Oe){for(let Be=0;Be<A+1;Be++){let oe=Be/A,De=be<0?oe:1-oe;Oe&&(De-=1),De*=xe;let ze=new V(Math.sin(De),Math.cos(De)*be),Ne=ze.clone().multiplyScalar(Me).add(Pe);Vl(Ne,Ee,L),M.push(L.x,L.y,L.z),Vl(ze,Ee,k),O.push(k.x,k.y,k.z),I.push(ve,.5+L.y/n),_e.push(D++)}}function ge(_e,ve,Ee,xe,Me){let Pe=new E,be=new V,Oe=[Ee,xe];Me<0&&Oe.reverse();for(let Be of Oe)be.set(Be,z*Me),Vl(be,ve,Pe),M.push(Pe.x,Pe.y,Pe.z),O.push(0,Me,0),I.push(.5,.5),_e.push(D++)}function ye(_e,ve,Ee){let xe=new V(Math.sin(Ee),Math.cos(Ee)),Me=new V(-Math.cos(Ee),Math.sin(Ee)),Pe=new E,be=_e<0?(oe,De,ze)=>T.push(oe,De,ze):(oe,De,ze)=>T.push(oe,ze,De),Oe=new V((r+a+$+te)/4,0);Vl(Oe,xe,Pe),M.push(Pe.x,Pe.y,Pe.z),O.push(Me.x,0,Me.y),I.push(.5,.5);let Be=D++;for(let oe of ve){let De=M.slice(oe*3,oe*3+3);M.push(...De),O.push(Me.x,0,Me.y);let ze=I.slice(oe*2,oe*2+2);I.push(...ze),D++}for(let oe=Be+1;oe<D-1;oe++)be(Be,oe,oe+1);be(Be,D-1,Be+1)}}},SO=class{static create(r){return this.build(this.normalizeInputs(r))}static normalizeInputs(r,a){let n=Object.assign({},(a==null?void 0:a.parameters)??{width:100,radialSegments:32,heightSegments:8,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadiusTop:8,cornerRadiusBottom:8,cornerSegments:8},r.parameters);return n.thetaLength=we.clamp(n.thetaLength,0,360),{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(r){let{width:a,depth:n,height:o,radialSegments:f,heightSegments:y,openEnded:x,thetaStart:b,thetaLength:_,cornerRadiusTop:S,cornerRadiusBottom:A,cornerSegments:C}=r.parameters,P;return _===0?(P=new Ce,P.setAttribute("position",new Te([],3))):S>0||A>0||_<360?P=new pm(0,a/2,o,f,y,x,b,_*Math.PI/180,S,A,C,0,!0):P=new hl(a/2,o,f,y,x),P.scale(1,1,n/a),Object.assign(P,{userData:{...r,type:"ConeGeometry"}})}},wO=class{static create(r){return this.build(this.normalizeInputs(r))}static normalizeInputs(r,a){let n=Object.assign({},(a==null?void 0:a.parameters)??{width:100,widthSegments:1,heightSegments:1,depthSegments:1,cornerRadius:8,cornerSegments:8},r.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(r){let{width:a,height:n,depth:o,widthSegments:f,heightSegments:y,depthSegments:x,cornerRadius:b,cornerSegments:_}=r.parameters,S;return b===0?S=new yi(a,n,o,f,y,x):S=new BA(a,n,o,f,y,x,b,_),Object.assign(S,{userData:{...r,type:"CubeGeometry"}})}},LA=Math.PI/2,BA=class extends Ce{constructor(r=1,a=1,n=1,o=1,f=1,y=1,x=0,b=4){super(),this.type="BoxGeometry",o=Math.floor(o),f=Math.floor(f),y=Math.floor(y),b=Math.floor(b),x=Math.min(x,r/2,a/2,n/2);let _=[],S=[],A=[],C=[],P=0;T("z","y","x",-1,-1,n,a,r,y,f),T("z","y","x",1,-1,n,a,-r,y,f),T("x","z","y",1,1,r,n,a,o,y),T("x","z","y",1,-1,r,n,-a,o,y),T("x","y","z",1,-1,r,a,n,o,f),T("x","y","z",-1,-1,r,a,-n,o,f),x>0&&(M("z","y","x",-1,-1,1,n,a,r,y),M("z","y","x",1,-1,-1,n,a,r,y),M("z","y","x",-1,1,-1,n,a,r,y),M("z","y","x",1,1,1,n,a,r,y),M("x","y","z",-1,-1,-1,r,a,n,o),M("x","y","z",1,-1,1,r,a,n,o),M("x","y","z",-1,1,1,r,a,n,o),M("x","y","z",1,1,-1,r,a,n,o),M("y","x","z",-1,-1,1,a,r,n,f),M("y","x","z",1,-1,-1,a,r,n,f),M("y","x","z",1,1,1,a,r,n,f),M("y","x","z",-1,1,-1,a,r,n,f),O(1,1,1),O(-1,1,1),O(1,-1,1),O(-1,-1,1),O(1,1,-1),O(-1,1,-1),O(1,-1,-1),O(-1,-1,-1)),this.setIndex(_),this.setAttribute("position",new Te(S,3)),this.setAttribute("normal",new Te(A,3)),this.setAttribute("uv",new Te(C,2));function T(I,D,z,k,L,R,F,B,N,j){let G=(R-2*x)/N,Y=(F-2*x)/j,X=R/2-x,$=F/2-x,te=B/2,ee=N+1,q=j+1,Z=0,U=new E;for(let W=0;W<q;W++){let H=W*Y-$;for(let K=0;K<ee;K++){let le=K*G-X;U[I]=le*k,U[D]=H*L,U[z]=te,S.push(U.x,U.y,U.z),U[I]=0,U[D]=0,U[z]=B>0?1:-1,A.push(U.x,U.y,U.z),C.push(K/N),C.push(1-W/j),Z+=1}}for(let W=0;W<j;W++)for(let H=0;H<N;H++){let K=P+H+ee*W,le=P+H+ee*(W+1),me=P+(H+1)+ee*(W+1),ne=P+(H+1)+ee*W;_.push(K,le,ne),_.push(le,me,ne)}P+=Z}function M(I,D,z,k,L,R,F,B,N,j){let G=(F-2*x)/j,Y=F/2-x,X=B/2-x,$=N/2,te=j+1,ee=0,q=new E,Z=new E;for(let U=0;U<b+1;U++){let W=U/b*LA,H=Math.sin(W)*x,K=(1-Math.cos(W))*x,le=Math.sin(W),me=Math.cos(W);q[D]=(X+H)*L,q[z]=($-K)*R,Z[I]=0,Z[D]=le*Math.sign(q[D]),Z[z]=me*Math.sign(q[z]);for(let ne=0;ne<te;ne++){let pe=ne*G-Y;q[I]=pe*k,S.push(q.x,q.y,q.z),A.push(Z.x,Z.y,Z.z),C.push(ne/j),C.push(0),ee+=1}}for(let U=0;U<b;U++)for(let W=0;W<j;W++){let H=P+W+te*U,K=P+W+te*(U+1),le=P+(W+1)+te*(U+1),me=P+(W+1)+te*U;_.push(H,K,me),_.push(K,le,me)}P+=ee}function O(I,D,z){let k=new E,L=new E(r/2,a/2,n/2);L.subScalar(x);let R=[],F=I*D*z>0?(N,j,G)=>_.push(N,j,G):(N,j,G)=>_.push(N,G,j);for(let N=0;N<=b;N++){let j=[],G=LA*(1-N/b),Y=Math.cos(G),X=Math.sin(G),$=0;for(let te=0;te<=N;te++){let ee=Math.cos($),q=Math.sin($);k.x=Y*ee,k.y=X,k.z=Y*q;let Z=L.clone().addScaledVector(k,x);S.push(I*Z.x,D*Z.y,z*Z.z),A.push(I*k.x,D*k.y,z*k.z),C.push(0,0),j.push(P++),$+=LA/N}R.push(j)}let B=R.length-1;for(let N=0;N<B;N++){let j=R[N],G=R[N+1],Y=j.length-1;F(j[0],G[1],G[0]);for(let X=1;X<=Y;X++)F(j[X-1],j[X],G[X]),F(j[X],G[X+1],G[X])}}}},Ul=class extends Ce{constructor(r=[],a=[],n="",o=1,f=.2,y=4){super(),this.type="PolyhedronGeometryRound";let x=[],b=[],_=[];S(),A(),this.setAttribute("position",new Te(x,3)),this.setAttribute("normal",new Te(_,3)),this.setAttribute("uv",new Te(b,2));return;function S(){var Z;f=Math.min(1-1e-5,f),f==0&&(y=0);let C={IcosahedronGeometry:5,DodecahedronGeometry:3,HexahedronGeometry:3,OctahedronGeometry:4,TetrahedronGeometry:3}[n],P=new E,T=P.clone(),M=new _r,O=f*o,I=o-O,D=y+1,z=new E,k=(U,W)=>z.subVectors(U,W).normalize(),L=(U,W)=>Array(U).fill(void 0).map(W),R=L(r.length/3,(U,W)=>new E().fromArray(r,W*3).setLength(o)),F=[],B=1e6;for(let U=0;U<R.length;U++){let W=R[U],H=[],K,le,me,ne=1e10,pe=-1;for(;(pe=a.indexOf(U,pe+1))!=-1;){let ve=pe-pe%3;K=a[ve+(pe+1)%3],le=a[ve+(pe+2)%3],me=W.distanceToSquared(R[K]),ne=Math.min(ne,me),H.push([K,le,me])}ne+=1e-6;let ge=[],ye=0,_e=H.length;for(let ve=0;ve<_e;ve++){[K,le,me]=H[ye];let Ee=((Z=F[K])==null?void 0:Z.includes(U))==!0;me<=ne&&ge.push(K+ +Ee*B),ye=H.findIndex(xe=>xe[0]==le)}F.push(ge)}let N=[];{let U=0,W=0,H,K,le=C==3;for(let me=0;me<=y;me++){H=me*(me+1)/2,K=(me+1)*(me+2)/2;for(let ne=0;ne<y-me;ne++)[U,W]=[H+ne+me+2,K+ne+me+3],N.push(H,K,...le?[W,H]:[U,K],W,U),[H,K]=[U,W];N.push(H,K,H+y+2)}}let j=P.clone(),G=P.clone(),Y=P.clone(),X=P.clone(),$=P.clone(),te=[],ee=L(R.length,()=>L(C,()=>P.clone()));for(let U=0;U<R.length;U++){P.copy(R[U]).normalize(),j.copy(P).multiplyScalar(I);let W=F[U];for(let ge=0;ge<W.length;ge++){let ye=W[ge],_e=W[(ge+1)%C];M.setFromPointsAndIndices(R,U,ye%B,_e%B),M.b.sub(M.a).setLength(1e10).add(M.a),M.c.sub(M.a).setLength(1e10).add(M.a),M.closestPointToPoint(j,ee[U][ge])}let H=[],K=[],le=[],me=new E;y==0&&[...ee[U]].reduce((ge,ye)=>ge.add(ye),me).multiplyScalar(1/C);for(let ge=0;ge<C;ge++){let ye=[],_e=(ge-1+C)%C,ve=ee[U][_e],Ee=ee[U][ge];P.copy(ve).sub(j),T.copy(Ee).sub(j);let xe=j.angleTo(P),Me=P.angleTo(T),Pe=Math.cos(xe)*O;y==0?G.copy(me):G.copy(j).setLength(I+Pe),K.push(Pe);let be=[G,ve,Ee];for(let Oe=0;Oe<2;Oe++){let Be=be[Oe],oe=be[Oe+1];X.subVectors(Be,j),$.subVectors(oe,j),Y.crossVectors(X,$).normalize();for(let De=0;De<D;De++){let ze=[xe,Me][Oe]*De/D;P.copy(X).applyAxisAngle(Y,ze).add(j),H.push(P.clone()),Oe&&(k(P,j),ye.push([De==0?Be:P.clone(),z.clone()]))}Oe&&(k(oe,j),ye.push([oe,z.clone()]))}le.push(ye)}te.push(le);let ne=2*D,pe=2;for(let ge=0;ge<C;ge++){let ye=ne*ge,_e=ne*((ge+1)%C),ve=[H[ye]];for(let xe=1;xe<D;xe++){X=H[ye+xe],$=H[_e+xe],ve.push(X);for(let Me=1,Pe=xe-pe+1;Me<=Pe;Me++)P.lerpVectors(X,$,Me/(Pe+1)),P.sub(j).setLength(K[ge]).add(j),ve.push(P.clone());ve.push($)}for(let xe=0;xe<D;xe++)ve.push(H[xe+D+ye]);ve.push(H[_e+D]);let Ee=N.map(xe=>ve[xe]);x.push(...Ee.map(xe=>[xe.x,xe.y,xe.z]).flat()),_.push(...Ee.map(xe=>(k(xe,j),[z.x,z.y,z.z])).flat())}}let q=[];for(let U=0;U<F.length;U++)for(let W=0;W<C;W++){let H=F[U][W];if(H<B){let K=F[H].findIndex(ne=>ne%B==U),le=te[U][W],me=te[H][K];for(let ne=0;ne<D;ne++){let pe=le[ne],ge=me[D-ne],ye=le[ne+1],_e=me[D-(ne+1)];[pe,ge,ye,ye,ge,_e].forEach(ve=>{x.push(ve[0].x,ve[0].y,ve[0].z),_.push(ve[1].x,ve[1].y,ve[1].z)})}q.push(le[0][0],me[D][0],le[D][0],me[0][0])}}for(;q.length;){let U,W,H,K;[U,W]=q.splice(0,2);let le=[U];for(;U!=W;)le.push(W),H=q.indexOf(W),K=H%2,W=q.splice(H-K,2)[1-K];z.subVectors(le[0],le[1]).cross(P.subVectors(le[0],le[2])).normalize();let me=z.dot(le[0])<0;me&&z.negate();for(let ne=1;ne<=le.length-2;ne++)[le[ne+ +me],le[ne+1-+me],le[0]].forEach(pe=>{x.push(pe.x,pe.y,pe.z),_.push(z.x,z.y,z.z)})}}function A(){let C=new E;for(let F=0;F<x.length;F+=3){C.x=x[F+0],C.y=x[F+1],C.z=x[F+2];let B=L(C)/2/Math.PI+.5,N=R(C)/Math.PI+.5;b.push(B,1-N)}let P=new E,T=new E,M=new E,O=new E,I=new V,D=new V,z=new V,k=(F,B,N,j)=>{j<0&&F.x===1&&(b[B]=F.x-1),N.x===0&&N.z===0&&(b[B]=j/2/Math.PI+.5)};for(let F=0,B=0;F<x.length;F+=9,B+=6){P.set(x[F+0],x[F+1],x[F+2]),T.set(x[F+3],x[F+4],x[F+5]),M.set(x[F+6],x[F+7],x[F+8]),I.set(b[B+0],b[B+1]),D.set(b[B+2],b[B+3]),z.set(b[B+4],b[B+5]),O.copy(P).add(T).add(M).divideScalar(3);let N=L(O);k(I,B+0,P,N),k(D,B+2,T,N),k(z,B+4,M,N)}for(let F=0;F<b.length;F+=6){let B=b[F+0],N=b[F+2],j=b[F+4],G=Math.max(B,N,j),Y=Math.min(B,N,j);G>.9&&Y<.1&&(B<.2&&(b[F+0]+=1),N<.2&&(b[F+2]+=1),j<.2&&(b[F+4]+=1))}function L(F){return Math.atan2(F.z,-F.x)}function R(F){return Math.atan2(-F.y,Math.sqrt(F.x*F.x+F.z*F.z))}}}static fromJSON(r){return new Ul(r.vertices,r.indices,r.radius,r.corner,r.cornerSides)}},AO=class{static create(r){return this.build(this.normalizeInputs(r))}static normalizeInputs(r,a){let n=Object.assign({},(a==null?void 0:a.parameters)??{width:100,detail:0,corner:0,cornerSides:4},r.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(r){let{width:a,height:n,depth:o,detail:f,corner:y,cornerSides:x}=r.parameters,b=f===0&&y!==0?new mm(a*.5,y,x):new Yu(a*.5,f);return b.scale(1,n/a,o/a),Object.assign(b,{userData:{...r,type:"DodecahedronGeometry"}})}},mm=class extends Ul{constructor(r=1,a=.2,n=4){let o=(1+Math.sqrt(5))/2,f=1/o,y=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-f,-o,0,-f,o,0,f,-o,0,f,o,-f,-o,0,-f,o,0,f,-o,0,f,o,0,-o,0,-f,o,0,-f,-o,0,f,o,0,f],x=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],b="DodecahedronGeometry";super(y,x,b,r,a,n),this.type=b}static fromJSON(r){return new mm(r.radius,r.corner,r.cornerSides)}},gm=1e-12,Ed=class{constructor(r){this.position=new V,this.startPosition=new V,this.uuid=we.generateUUID(),this.position=r.clone()}start(){this.reset()}reset(){this.startPosition.copy(this.position)}applyOffset(r){this.position.copy(this.startPosition).add(r)}copy(r){return this.position.copy(r.position),this.startPosition.copy(r.startPosition),this}clone(){return new Ed(this.position).copy(this)}toJSON(){return[this.position.x,this.position.y]}},Td=class extends Ed{constructor(r){super(r.position),this.parent=r}copy(r){return super.copy(r),this}clone(){return new Td(this.parent).copy(this)}},qs=class extends Ed{constructor(r,a){super(a),this.controls=[],this.roundness=0,this.areControlsDirectionsMirrored=!0,this.uuid=r,this.controls.push(new Td(this),new Td(this))}static create(r,a){let n=new qs(r,new V(...a.position));return n.controls[0].position.set(...a.controlPrevious.position),n.controls[1].position.set(...a.controlNext.position),n.roundness=a.roundness,n.areControlsDirectionsMirrored=a.areControlsDirectionsMirrored,n}getOppositeControl(r){let a=this.controls.indexOf(r);return a===0?this.controls[1]:a===1?this.controls[0]:null}applyOffsetToControls(r,a=1){for(let n=0,o=this.controls.length;n<o;n++){let f=this.controls[n];this.position.distanceTo(f.position)<=a?f.position.copy(this.position):f.applyOffset(r)}}controlsMoved(){return!(this.position.equals(this.controls[0].position)&&this.position.equals(this.controls[1].position))}copy(r){return super.copy(r),this.controls[0].copy(r.controls[0]),this.controls[1].copy(r.controls[1]),this.roundness=r.roundness,this.uuid=r.uuid,this}clone(){return new qs(this.uuid,this.position).copy(this)}toJSON(){return super.toJSON().concat(this.controls[0].toJSON(),this.controls[1].toJSON(),[this.roundness])}computeTangents(){var n,o;let r=(n=this.curveBefore)==null?void 0:n.getTangentAt(1),a=(o=this.curveAfter)==null?void 0:o.getTangentAt(0);return[r,a]}computeNormals(r=new V,a=new V){let[n,o]=this.computeTangents();return n&&o&&(EO(n,r),EO(o,a)),[r,a]}computeTangent(r=new V){let[a,n]=this.computeTangents();return a&&n&&r.copy(a).add(n).normalize(),r}computeNormal(r=new V){let[a,n]=this.computeNormals();return r.copy(a).add(n).normalize(),r}};function EO(r,a=new V){let n=r.length();return a.set(-r.y/n,r.x/n)}var FA=r=>r,Md=new V,F0=new V,j7=new V,H7=new V,W7=new V,q7=new V,MO=new E,CO=new E;function PO(r){let a=new V;a.addVectors(r.v0,Md.subVectors(r.v1,r.v0).multiplyScalar(2/3));let n=new V;return n.addVectors(r.v2,F0.subVectors(r.v1,r.v2).multiplyScalar(2/3)),new ln(r.v0,a,n,r.v2)}function ym(r,a,n=Number.EPSILON){return Math.abs(r-a)<n}function X7(r,a,n=Number.EPSILON){return r.distanceTo(a)<n}function Y7(r,a,n=Number.EPSILON){return r.distanceTo(a)<n}function VA(r,a,n){let o=Math.sqrt(Math.pow(a.x-r.x,2)+Math.pow(a.y-r.y,2)),f=Math.sqrt(Math.pow(a.x-n.x,2)+Math.pow(a.y-n.y,2)),y=Math.sqrt(Math.pow(n.x-r.x,2)+Math.pow(n.y-r.y,2));return Math.acos((f*f+o*o-y*y)/(2*f*o))}function _O(r,a,n){return TO(r,a)&&TO(a,n)&&NA(r.position,a.position,n.position)}function NA(r,a,n){return Md.copy(a).sub(r).cross(F0.copy(n).sub(r))===0}function IO(r,a,n,o,f){let y=Math.sqrt(Math.pow(a.x-r.x,2)+Math.pow(a.y-r.y,2)),x=(r.y+a.y)/2,b=(r.x+a.x)/2,_=Math.sqrt(Math.pow(n,2)-Math.pow(y/2,2))*(r.y-a.y)/y,S=Math.sqrt(Math.pow(n,2)-Math.pow(y/2,2))*(a.x-r.x)/y;return o.set(b+_,x+S),f.set(b-_,x-S),[o,f]}function DO(r,a,n){let o=r.distanceTo(n),f=a.distanceTo(n);return o<f?a:r}function OO(r,a,n,o,f,y){let x=a.x-r.x,b=a.y-r.y,_=n.x-r.x,S=n.y-r.y,A=Math.sqrt((x+_)*(x+_)+(b+S)*(b+S)),C;return VA(a,r,n)>Math.PI&&(A*=-1),ym(S,b)?C=(b+S)*(o/A-.5)*8/3/(x-_):C=(x+_)*(o/A-.5)*8/3/(S-b),f.set(a.x-C*b,a.y+C*x),y.set(n.x+C*S,n.y-C*_),[f,y]}function UA(r,a){return r.position.equals(r.controls[1].position)&&a.position.equals(a.controls[0].position)}function TO(r,a){return NA(r.position,r.controls[1].position,a.position)&&NA(r.position,a.controls[0].position,a.position)}function RO(r,a,n,o,f=.5){let y=Md.subVectors(a,r).multiplyScalar(f).add(r),x=F0.subVectors(n,a).multiplyScalar(f).add(a),b=j7.subVectors(o,n).multiplyScalar(f).add(n),_=y,S=H7.subVectors(x,y).multiplyScalar(f).add(y),A=W7.subVectors(b,x).multiplyScalar(f).add(x),C=b,P=q7.subVectors(A,S).multiplyScalar(f).add(S);return[r.x,r.y,_.x,_.y,S.x,S.y,P.x,P.y,A.x,A.y,C.x,C.y,o.x,o.y]}function LO(r,a,n=12,o=!0){let f=CO.set(0,0,0),y,x=0;for(let b=0;b<a.length;b++){let _=FA(a[b]),S=Md,A=zl(_,n);for(let C=0;C<=A;C++)if(_ instanceof ln||_ instanceof Yn||_ instanceof cn){if(_.getPoint(C/A,S),f.set(S.x,S.y,0),y!==void 0&&Y7(y,f))continue;y===void 0&&(y=MO),y.copy(f),r.setXYZ(x,f.x,f.y,f.z),x++}}return o&&x>1&&!(r.getX(x-1)===r.getX(0)&&r.getY(x-1)===r.getY(0)&&r.getZ(x-1)===r.getZ(0))&&(r.setXYZ(x,r.getX(0),r.getY(0),r.getZ(0)),x++),r}function BO(r,a,n,o=12,f=!0){let y=CO.set(0,0,0),x=0,b=[];for(let _=0;_<a.length;_++){if(n[_]===!1)continue;let S,A=FA(a[_]),C=Md,P=zl(A,o);b.push(P);for(let T=0;T<=P;T++)if(A instanceof ln||A instanceof Yn||A instanceof cn){if(A.getPoint(T/P,C),y.set(C.x,C.y,0),S==null?void 0:S.equals(y))continue;S===void 0?S=MO:(r.setXYZ(x,S.x,S.y,S.z),x++,r.setXYZ(x,y.x,y.y,y.z),x++),S.copy(y)}}return f&&x>1&&!(r.getX(x-1)===r.getX(0)&&r.getY(x-1)===r.getY(0)&&r.getZ(x-1)===r.getZ(0))&&(r.setXYZ(x,r.getX(0),r.getY(0),r.getZ(0)),x++),b}function zA(r,a=12,n=!1){let o=[];for(let f=0,y=r.length;f<y;f++){let x=r[f],b=0;if(n&&x.roundedCurveCorner!==void 0){let _=zl(x.roundedCurveCorner,a)*.5;f>0&&(o[f-1]+=_),b+=_}x.curveAfter!==void 0&&(b+=zl(x.curveAfter,a)),o.push(b)}return r.length>0&&n&&r[0].roundedCurveCorner!==void 0&&(o[r.length-1]+=zl(r[0].roundedCurveCorner,a)*.5),o}function zl(r,a=12){return r&&r instanceof Cc?a*2:r&&(r instanceof cn||r instanceof Tp)?1:r&&r instanceof Wu?a*r.points.length:a}function NO(r,a,n=12,o=!0){let f,y=0;for(let x=0;x<a.length;x++){let b=FA(a[x]),_=zl(b,n),S=Md;for(let A=0;A<=_;A++)if(b instanceof ln||b instanceof Yn||b instanceof cn){if(b.getPoint(A/_,S),f!==void 0&&X7(f,S,gm))continue;f===void 0&&(f=F0),f.copy(S),r.push(S.x,S.y),y++}}return ym(r[0],r[r.length-2],gm)&&ym(r[1],r[r.length-1],gm)&&(r.pop(),r.pop()),o&&y>1&&!(ym(r[y-1],r[1],gm)&&ym(r[y-2],r[0],gm))&&(r.push(r[0],r[1]),y++),r}var kA=new V,K7=new V,Q7=new V,Z7=new V,J7=new V,$7=new V,Qt=class extends fa{constructor(r=100,a=100){super(),this.points=[],this.shapeHoles=[],this.plane=new Gr(new E(0,0,-1)),this.subdivision=0,this.controlSnapDistance=4,this.pointIDs=0,this.isMesh2D=!1,this.isText=!1,this._roundness=0,this.isClosed=!1,this.useCubicForRoundedCorners=!0,this.uuid=we.generateUUID(),this.needsUpdate=!1,this.roundedCurves=[],this._width=r,this._height=a}static createFromState(r,a,n){let o=new Qt;return o.isClosed=r.isClosed,o.points=r.points.map(f=>qs.create(f.id,f.data)),typeof r.roundness=="number"&&(o.roundness=r.roundness),o.shapeHoles=r.shapeHoles.map(f=>Qt.createFromState(f)),a!==void 0&&n!==void 0&&o.applySize(a,n),o.update(),o}get width(){return this._width}get height(){return this._height}get roundness(){return this._roundness}set roundness(r){if(this._roundness!==r){this._roundness=r;for(let a=0,n=this.points.length;a<n;a++)this.points[a].roundness=r;this.needsUpdate=!0}}getPointsIndexesByIds(r){return r.map(a=>this.getPointIndexById(a)).filter(a=>a>=0)}getPointIndexById(r){let a=this.points.length,n=this.points.findIndex(o=>o.uuid===r);if(n<0){let o=a;for(let f=0,y=this.shapeHoles.length;f<y;f++){let x=this.shapeHoles[f],b=x.points.length,_=x.getPointIndexById(r);if(_<0)o+=b;else return _+o}}return n}getLineIndexById(r){return this.getPointIndexById(r)}getBezierPoint(r){if(r<=this.points.length-1)return this.points[r];if(this.shapeHoles.length>0){let a=this.points.length;for(let n=0,o=this.shapeHoles.length;n<o;n++){let f=this.shapeHoles[n],y=r-a;if(y<=f.points.length-1)return f.points[y];a+=f.points.length}}throw new Error("This shape does not have a point for this index: "+r)}getBezierPointIndex(r){let a=this.points.indexOf(r);if(a>=0)return a;if(a=this.points.length,this.shapeHoles.length>0)for(let n=0,o=this.shapeHoles.length;n<o;n++){let f=this.shapeHoles[n],y=f.points.indexOf(r);if(y>=0)return a+y;a+=f.points.length}return-1}getAllPoints(){let r=[].concat(...this.shapeHoles.map(a=>a.points));return[...this.points,...r]}applySize(r,a){r===0&&(r=.001),a===0&&(a=.001),this._width=r,this._height=a}applyScale(r,a){let n=kA.set(r,a);for(let o=0,f=this.points.length;o<f;o++){let y=this.points[o];y.position.multiply(n),y.controls[0].position.multiply(n),y.controls[1].position.multiply(n)}for(let o=0,f=this.shapeHoles.length;o<f;o++)this.shapeHoles[o].applyScale(r,a);this._update()}createPoint(r,a=0,n=we.generateUUID()){let o;r instanceof V?o=r:o=new V(r,a);let f=new qs(n,o);return f.roundness=this.roundness,f}addPoint(r){this.points.push(r),this.needsUpdate=!0}addPointAt(r,a){this.points.splice(a,0,r),this.needsUpdate=!0}getPointByUuid(r){for(let a=0,n=this.points.length;a<n;a++){let o=this.points[a];if(o.uuid===r)return o}for(let a=0,n=this.shapeHoles.length;a<n;a++){let o=this.shapeHoles[a].getPointByUuid(r);if(o)return o}}getFirstPoint(){return this.points[0]}getLastPoint(){return this.points[this.points.length-1]}removePoint(r){let a=this.points.indexOf(r);a>=0&&this.points.splice(a,1),this.needsUpdate=!0}removePointById(r){let a=this.points.find(n=>n.uuid===r);a&&this.removePoint(a)}update(){for(let r=0,a=this.shapeHoles.length;r<a;r++)this.shapeHoles[r].update();this._update()}extractShapePointsToBuffer(r,a=12,n=!1){this.subdivision=a,this.curveDivisions===void 0&&this.computeCurveDivisions(a);let o=n?this.roundedCurveDivisions:this.curveDivisions;return LO(r,n?this.roundedCurves:this.curves,a,this.autoClose),o.reduce((f,y)=>f+y,0)+1}computeCurveDivisions(r=12){return this.curveDivisions=zA(this.points,r,!1),this.roundedCurveDivisions=zA(this.points,r,!0),this.curveDivisions}extractFilteredShapePointsToBuffer(r,a,n=12){return BO(r,this.curves,a,n,this.autoClose).reduce((o,f)=>o+f,0)*2}extractShapePointsToFlatArray(r,a=12){return this.subdivision=a,this.curveDivisions===void 0&&this.computeCurveDivisions(a),NO(r,this.roundedCurves,a,this.autoClose)}getCurveIndexFromVertexId(r,a=!1){let n=0;this.curveDivisions===void 0&&this.computeCurveDivisions(this.subdivision);let o=a?this.roundedCurveDivisions:this.curveDivisions,f=0;a&&this.points[0].roundedCurveCorner!==void 0&&(f=zl(this.points[0].roundedCurveCorner,this.subdivision)*.5);let y=r-f;y<0&&(y+=o.reduce((x,b)=>x+b,0));for(let x=0,b=o.length;x<b;x++){let _=o[x];if(y<n+_)return[x,(y-n+1)/_];n+=_}return[0,1]}getCurveT(r,a,n){let o=this.points[r],f=this.points[r>=this.points.length-1?0:r+1],y=this.curveDivisions,x=y[r];if(UA(o,f)){let _=o.position.distanceTo(f.position);return o.position.distanceTo(kA.set(n.x,n.y))/_}let b=0;for(let _=0;_<r;_++)b+=y[_];return(a-b)/x}dispose(){}_applyCurveForPoint(r,a){UA(a,r)?this.lineTo(r.position.x,r.position.y):this.bezierCurveTo(a.controls[1].position.x,a.controls[1].position.y,r.controls[0].position.x,r.controls[0].position.y,r.position.x,r.position.y);let n=this.curves[this.curves.length-1];r.curveBefore=n,a.curveAfter=n;let o=n.clone();r.roundedCurveBefore=o,a.roundedCurveAfter=o,r.roundedCurveCorner=void 0,this.roundedCurves.push(o)}_update(){if(this.curves=[],this.roundedCurves=[],!this.points.length)return;for(let a=0,n=this.points.length;a<n;a++){let o=this.points[a];if(a===0)this.moveTo(o.position.x,o.position.y);else{let f=this.points[a-1];this._applyCurveForPoint(o,f)}}let r=this.getLastPoint();if(r!=null&&r.curveAfter&&(r.curveAfter=void 0),this.isClosed){let a=this.points[0],n=this.points[this.points.length-1];this._applyCurveForPoint(a,n)}if(this.points.length>2){let a=0;for(let n=0,o=this.points.length;n<o;n++){let f=this.points[n],y=this.points[n-1]??this.points[this.points.length-1],x=this.points[n+1]??this.points[0],b=f.roundness,_=y&&x&&_O(y,f,x);if(!f.controlsMoved()&&b>0&&!_){let S=f.curveBefore,A=f.curveAfter;if(S===void 0||A===void 0)continue;let C=f.roundedCurveBefore,P=f.roundedCurveAfter,T=S.getLength(),M=A.getLength(),O=Math.min(b,T*.499),I=Math.min(b,M*.499),D=Math.min(O,I),z=1-D/T,k=D/M,L=S.getPointAt(z,kA),R=A.getPointAt(k,K7);this._subSplitCurve(S,C,z,L,void 0),this._subSplitCurve(A,P,k,void 0,R);let F;if(this.useCubicForRoundedCorners){let B=VA(L,f.position,R)/2,N=Math.tan(B)*L.distanceTo(f.position),[j,G]=IO(L,R,N,Q7,Z7),Y=DO(j,G,f.position),[X,$]=OO(Y,L,R,N,J7,$7);F=new ln(L.clone(),X.clone(),$.clone(),R.clone())}else F=new Yn(L.clone(),f.position.clone(),R.clone());f.roundedCurveCorner=F,this.roundedCurves.splice(n+a,0,F),a++}}}}_subSplitCurve(r,a,n,o,f){if(r instanceof cn)o!==void 0&&a.v2.copy(o),f!==void 0&&a.v1.copy(f);else{let y=r,x=a,b=y.getUtoTmapping(n,0),_=RO(y.v0,y.v1,y.v2,y.v3,b);return o!==void 0&&(x.v0.set(_[0],_[1]),x.v1.set(_[2],_[3]),x.v2.set(_[4],_[5]),x.v3.set(_[6],_[7])),f!==void 0&&(x.v0.set(_[6],_[7]),x.v1.set(_[8],_[9]),x.v2.set(_[10],_[11]),x.v3.set(_[12],_[13])),x}return a}clone(){let r=new Qt(this._width,this._height);return r.points=this.points.map(a=>a.clone()),r.isClosed=this.isClosed,r.roundness=this.roundness,r.isMesh2D=this.isMesh2D,r.shapeHoles=this.shapeHoles.map(a=>a.clone()),r}toJSON(){return{points:this.points.reduce((r,a)=>r.concat(a.toJSON()),[]),shapeHoles:this.shapeHoles.map(r=>r.toJSON()),isClosed:this.isClosed,roundness:this.roundness}}fromJSON(r){var n;this.points=[],this.pointIDs=0;let a=r.points.length/7;for(let o=0;o<a;o++){let f=o*7,y=r.points[f+0],x=r.points[f+1],b=r.points[f+2],_=r.points[f+3],S=r.points[f+4],A=r.points[f+5],C=r.points[f+6],P=new qs(we.generateUUID(),new V(y,x));P.controls[0].position.set(b,_),P.controls[1].position.set(S,A),P.roundness=C,this.points.push(P)}return this.shapeHoles=(n=r.shapeHoles)!=null&&n.length?r.shapeHoles.map(o=>{let f=new Qt;return f.fromJSON(o),f}):[],this.isClosed=r.isClosed,this._roundness=r.roundness,this._update(),this}fromShape(r,a=!1){this.isText=a;let n=(f,y)=>{y instanceof ln&&y.v3.equals(f.position)&&f.controls[0].position.copy(y.v2)},o=f=>{let y=[],x,b;for(x=0,b=f.length;x<b;x++)f[x]instanceof Yn&&(f[x]=PO(f[x]));for(x=0,b=f.length;x<b;x++){let A=f[x],C=x>0?f[x-1]:null,P;A instanceof ln?(P=this.createPoint(A.v0),P.controls[1].position.copy(A.v1)):A instanceof cn&&(P=this.createPoint(A.v1)),P!==void 0&&(C!==null&&n(P,C),y.push(P))}let _=f[f.length-1],S=!1;return _ instanceof ln?_.v3.equals(y[0].position)&&(y[0].controls[0].position.copy(_.v2),S=!0):_ instanceof cn&&_.v2.equals(y[0].position)&&(S=!0),this.isClosed=S,y};return this.points=o(r.curves),r instanceof fa&&(this.shapeHoles=r.holes.map(f=>{let y=new Qt;return y.fromShape(f),y})),this.update(),this}updatePoint(r,a){let n=this.getPointByUuid(r);n&&(a.position!==void 0&&n.position.fromArray(a.position),a.roundness!==void 0&&(n.roundness=a.roundness),a.areControlsDirectionsMirrored!==void 0&&(n.areControlsDirectionsMirrored=a.areControlsDirectionsMirrored),this.needsUpdate=!0)}updatePreviousControl(r,a){var o;let n=(o=this.getPointByUuid(r))==null?void 0:o.controls[0];n&&(a.position&&n.position.fromArray(a.position),this.needsUpdate=!0)}updateNextControl(r,a){var o;let n=(o=this.getPointByUuid(r))==null?void 0:o.controls[1];n&&(a.position&&n.position.fromArray(a.position),this.needsUpdate=!0)}},jA=Math.PI*2;function GA({x:r,y:a},n,o,f,y){return{x:r*n+f,y:a*o+y}}function eX(r,a){let n=a===1.5707963267948966?.551915024494:a===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(a/4),o=Math.cos(r),f=Math.sin(r),y=Math.cos(r+a),x=Math.sin(r+a);return[{x:o-f*n,y:f+o*n},{x:y+x*n,y:x-y*n},{x:y,y:x}]}function FO(r,a,n,o){let f=r*o-a*n<0?-1:1,y=Math.min(1,Math.max(-1,r*n+a*o));return f*Math.acos(y)}function tX(r,a,n,o,f,y,x,b,_,S){let A=Math.pow(f,2),C=Math.pow(y,2),P=Math.pow(x,2),T=Math.pow(b,2),M=A*C-A*T-C*P;M<0&&(M=0),M/=A*T+C*P,M=Math.sqrt(M)*(_===S?-1:1);let O=M*f/y*b,I=M*-y/f*x,D=O+(r+n)/2,z=I+(a+o)/2,k=(x-O)/f,L=(b-I)/y,R=(-x-O)/f,F=(-b-I)/y,B=FO(1,0,k,L),N=FO(k,L,R,F);return N<0&&(N+=jA),{centerx:D,centery:z,ang1:B,ang2:N}}function VO({px:r,py:a,cx:n,cy:o,rx:f,ry:y,largeArcFlag:x,sweepFlag:b}){let _=[];if(f===0||y===0)return[];let S=(r-n)/2,A=(a-o)/2;if(S===0&&A===0)return[];f=Math.abs(f),y=Math.abs(y);let C=Math.pow(S,2)/Math.pow(f,2)+Math.pow(A,2)/Math.pow(y,2);C>1&&(f*=Math.sqrt(C),y*=Math.sqrt(C));let P=tX(r,a,n,o,f,y,S,A,x,b),{ang1:T,ang2:M}=P,{centerx:O,centery:I}=P,D=Math.abs(M)/(jA/4);Math.abs(1-D)<1e-7&&(D=1);let z=Math.max(Math.ceil(D),1);M/=z;for(let k=0;k<z;k++)_.push(eX(T,M)),T+=M;return _.map(k=>{let{x:L,y:R}=GA(k[0],f,y,O,I),{x:F,y:B}=GA(k[1],f,y,O,I),{x:N,y:j}=GA(k[2],f,y,O,I);return{x1:L,y1:R,x2:F,y2:B,x:N,y:j}})}var Wt;(function(r){r[r.ODD=0]="ODD",r[r.NONZERO=1]="NONZERO",r[r.POSITIVE=2]="POSITIVE",r[r.NEGATIVE=3]="NEGATIVE",r[r.ABS_GEQ_TWO=4]="ABS_GEQ_TWO"})(Wt||(Wt={}));var Xr;(function(r){r[r.POLYGONS=0]="POLYGONS",r[r.CONNECTED_POLYGONS=1]="CONNECTED_POLYGONS",r[r.BOUNDARY_CONTOURS=2]="BOUNDARY_CONTOURS"})(Xr||(Xr={}));function ht(r,a){if(!r)throw a||"Assertion Failed!"}var lt=function(){function r(){}return r.vertEq=function(a,n){return a.s===n.s&&a.t===n.t},r.vertLeq=function(a,n){return a.s<n.s||a.s===n.s&&a.t<=n.t},r.transLeq=function(a,n){return a.t<n.t||a.t===n.t&&a.s<=n.s},r.edgeGoesLeft=function(a){return r.vertLeq(a.Dst,a.Org)},r.edgeGoesRight=function(a){return r.vertLeq(a.Org,a.Dst)},r.vertL1dist=function(a,n){return Math.abs(a.s-n.s)+Math.abs(a.t-n.t)},r.edgeEval=function(a,n,o){ht(r.vertLeq(a,n)&&r.vertLeq(n,o));var f=n.s-a.s,y=o.s-n.s;return f+y>0?f<y?n.t-a.t+(a.t-o.t)*(f/(f+y)):n.t-o.t+(o.t-a.t)*(y/(f+y)):0},r.edgeSign=function(a,n,o){ht(r.vertLeq(a,n)&&r.vertLeq(n,o));var f=n.s-a.s,y=o.s-n.s;return f+y>0?(n.t-o.t)*f+(n.t-a.t)*y:0},r.transEval=function(a,n,o){ht(r.transLeq(a,n)&&r.transLeq(n,o));var f=n.t-a.t,y=o.t-n.t;return f+y>0?f<y?n.s-a.s+(a.s-o.s)*(f/(f+y)):n.s-o.s+(o.s-a.s)*(y/(f+y)):0},r.transSign=function(a,n,o){ht(r.transLeq(a,n)&&r.transLeq(n,o));var f=n.t-a.t,y=o.t-n.t;return f+y>0?(n.s-o.s)*f+(n.s-a.s)*y:0},r.vertCCW=function(a,n,o){return a.s*(n.t-o.t)+n.s*(o.t-a.t)+o.s*(a.t-n.t)>=0},r.interpolate=function(a,n,o,f){return a=a<0?0:a,o=o<0?0:o,a<=o?o===0?(n+f)/2:n+(f-n)*(a/(a+o)):f+(n-f)*(o/(a+o))},r.intersect=function(a,n,o,f,y){var x,b,_;r.vertLeq(a,n)||(_=a,a=n,n=_),r.vertLeq(o,f)||(_=o,o=f,f=_),r.vertLeq(a,o)||(_=a,a=o,o=_,_=n,n=f,f=_),r.vertLeq(o,n)?r.vertLeq(n,f)?(x=r.edgeEval(a,o,n),b=r.edgeEval(o,n,f),x+b<0&&(x=-x,b=-b),y.s=r.interpolate(x,o.s,b,n.s)):(x=r.edgeSign(a,o,n),b=-r.edgeSign(a,f,n),x+b<0&&(x=-x,b=-b),y.s=r.interpolate(x,o.s,b,f.s)):y.s=(o.s+n.s)/2,r.transLeq(a,n)||(_=a,a=n,n=_),r.transLeq(o,f)||(_=o,o=f,f=_),r.transLeq(a,o)||(_=a,a=o,o=_,_=n,n=f,f=_),r.transLeq(o,n)?r.transLeq(n,f)?(x=r.transEval(a,o,n),b=r.transEval(o,n,f),x+b<0&&(x=-x,b=-b),y.t=r.interpolate(x,o.t,b,n.t)):(x=r.transSign(a,o,n),b=-r.transSign(a,f,n),x+b<0&&(x=-x,b=-b),y.t=r.interpolate(x,o.t,b,f.t)):y.t=(o.t+n.t)/2},r}(),vm=function(){function r(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1}return r}(),V0=function(){function r(a){this.side=a,this.next=null,this.Org=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Lface=null,this.activeRegion=null,this.winding=0}return Object.defineProperty(r.prototype,"Rface",{get:function(){return this.Sym.Lface},set:function(a){this.Sym.Lface=a},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Dst",{get:function(){return this.Sym.Org},set:function(a){this.Sym.Org=a},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Oprev",{get:function(){return this.Sym.Lnext},set:function(a){this.Sym.Lnext=a},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Lprev",{get:function(){return this.Onext.Sym},set:function(a){this.Onext.Sym=a},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Dprev",{get:function(){return this.Lnext.Sym},set:function(a){this.Lnext.Sym=a},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Rprev",{get:function(){return this.Sym.Onext},set:function(a){this.Sym.Onext=a},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Dnext",{get:function(){return this.Sym.Onext.Sym},set:function(a){this.Sym.Onext.Sym=a},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Rnext",{get:function(){return this.Sym.Lnext.Sym},set:function(a){this.Sym.Lnext.Sym=a},enumerable:!0,configurable:!0}),r}(),Cd=function(){function r(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0}return r}(),UO=function(){function r(){var a=new Cd,n=new vm,o=new V0(0),f=new V0(1);a.next=a.prev=a,a.anEdge=null,n.next=n.prev=n,o.next=o,o.Sym=f,f.next=f,f.Sym=o,this.vHead=a,this.fHead=n,this.eHead=o,this.eHeadSym=f}return r.prototype.makeEdge_=function(a){var n=new V0(0),o=new V0(1);a.Sym.side<a.side&&(a=a.Sym);var f=a.Sym.next;return o.next=f,f.Sym.next=n,n.next=a,a.Sym.next=o,n.Sym=o,n.Onext=n,n.Lnext=o,n.Org=null,n.Lface=null,n.winding=0,n.activeRegion=null,o.Sym=n,o.Onext=o,o.Lnext=n,o.Org=null,o.Lface=null,o.winding=0,o.activeRegion=null,n},r.prototype.splice_=function(a,n){var o=a.Onext,f=n.Onext;o.Sym.Lnext=n,f.Sym.Lnext=a,a.Onext=f,n.Onext=o},r.prototype.makeVertex_=function(a,n,o){var f=a;ht(f,"Vertex can't be null!");var y=o.prev;f.prev=y,y.next=f,f.next=o,o.prev=f,f.anEdge=n;var x=n;do x.Org=f,x=x.Onext;while(x!==n)},r.prototype.makeFace_=function(a,n,o){var f=a;ht(f,"Face can't be null");var y=o.prev;f.prev=y,y.next=f,f.next=o,o.prev=f,f.anEdge=n,f.trail=null,f.marked=!1,f.inside=o.inside;var x=n;do x.Lface=f,x=x.Lnext;while(x!==n)},r.prototype.killEdge_=function(a){a.Sym.side<a.side&&(a=a.Sym);var n=a.next,o=a.Sym.next;n.Sym.next=o,o.Sym.next=n},r.prototype.killVertex_=function(a,n){var o=a.anEdge,f=o;do f.Org=n,f=f.Onext;while(f!==o);var y=a.prev,x=a.next;x.prev=y,y.next=x},r.prototype.killFace_=function(a,n){var o=a.anEdge,f=o;do f.Lface=n,f=f.Lnext;while(f!==o);var y=a.prev,x=a.next;x.prev=y,y.next=x},r.prototype.makeEdge=function(){var a=new Cd,n=new Cd,o=new vm,f=this.makeEdge_(this.eHead);return this.makeVertex_(a,f,this.vHead),this.makeVertex_(n,f.Sym,this.vHead),this.makeFace_(o,f,this.fHead),f},r.prototype.splice=function(a,n){var o=!1,f=!1;if(a!==n){if(n.Org!==a.Org&&(f=!0,this.killVertex_(n.Org,a.Org)),n.Lface!==a.Lface&&(o=!0,this.killFace_(n.Lface,a.Lface)),this.splice_(n,a),!f){var y=new Cd;this.makeVertex_(y,n,a.Org),a.Org.anEdge=a}if(!o){var x=new vm;this.makeFace_(x,n,a.Lface),a.Lface.anEdge=a}}},r.prototype.delete=function(a){var n=a.Sym,o=!1;if(a.Lface!==a.Rface&&(o=!0,this.killFace_(a.Lface,a.Rface)),a.Onext===a)this.killVertex_(a.Org,null);else if(a.Rface.anEdge=a.Oprev,a.Org.anEdge=a.Onext,this.splice_(a,a.Oprev),!o){var f=new vm;this.makeFace_(f,a,a.Lface)}n.Onext===n?(this.killVertex_(n.Org,null),this.killFace_(n.Lface,null)):(a.Lface.anEdge=n.Oprev,n.Org.anEdge=n.Onext,this.splice_(n,n.Oprev)),this.killEdge_(a)},r.prototype.addEdgeVertex=function(a){var n=this.makeEdge_(a),o=n.Sym;this.splice_(n,a.Lnext),n.Org=a.Dst;var f=new Cd;return this.makeVertex_(f,o,n.Org),n.Lface=o.Lface=a.Lface,n},r.prototype.splitEdge=function(a){var n=this.addEdgeVertex(a),o=n.Sym;return this.splice_(a.Sym,a.Sym.Oprev),this.splice_(a.Sym,o),a.Dst=o.Org,o.Dst.anEdge=o.Sym,o.Rface=a.Rface,o.winding=a.winding,o.Sym.winding=a.Sym.winding,o.idx=a.idx,o.Sym.idx=a.Sym.idx,o},r.prototype.connect=function(a,n){var o=!1,f=this.makeEdge_(a),y=f.Sym;if(n.Lface!==a.Lface&&(o=!0,this.killFace_(n.Lface,a.Lface)),this.splice_(f,a.Lnext),this.splice_(y,n),f.Org=a.Dst,y.Org=n.Org,f.Lface=y.Lface=a.Lface,a.Lface.anEdge=y,!o){var x=new vm;this.makeFace_(x,f,a.Lface)}return f},r.prototype.zapFace=function(a){var n=a.anEdge,o,f,y,x,b;f=n.Lnext;do o=f,f=o.Lnext,o.Lface=null,o.Rface===null&&(o.Onext===o?this.killVertex_(o.Org,null):(o.Org.anEdge=o.Onext,this.splice_(o,o.Oprev)),y=o.Sym,y.Onext===y?this.killVertex_(y.Org,null):(y.Org.anEdge=y.Onext,this.splice_(y,y.Oprev)),this.killEdge_(o));while(o!=n);x=a.prev,b=a.next,b.prev=x,x.next=b},r.prototype.countFaceVerts_=function(a){var n=a.anEdge,o=0;do o++,n=n.Lnext;while(n!==a.anEdge);return o},r.prototype.mergeConvexFaces=function(a){var n,o,f,y,x,b,_;for(n=this.fHead.next;n!==this.fHead;n=n.next)if(n.inside)for(o=n.anEdge,x=o.Org;f=o.Lnext,y=o.Sym,y&&y.Lface&&y.Lface.inside&&(b=this.countFaceVerts_(n),_=this.countFaceVerts_(y.Lface),b+_-2<=a&&lt.vertCCW(o.Lprev.Org,o.Org,y.Lnext.Lnext.Org)&&lt.vertCCW(y.Lprev.Org,y.Org,o.Lnext.Lnext.Org)&&(f=y.Lnext,this.delete(y),o=null,y=null)),!(o&&o.Lnext.Org===x);)o=f;return!0},r.prototype.check=function(){var a=this.fHead,n=this.vHead,o=this.eHead,f,y,x,b,_,S;for(y=a,y=a;(f=y.next)!==a;y=f){ht(f.prev===y),_=f.anEdge;do ht(_.Sym!==_),ht(_.Sym.Sym===_),ht(_.Lnext.Onext.Sym===_),ht(_.Onext.Sym.Lnext===_),ht(_.Lface===f),_=_.Lnext;while(_!==f.anEdge)}for(ht(f.prev===y&&f.anEdge===null),b=n,b=n;(x=b.next)!==n;b=x){ht(x.prev===b),_=x.anEdge;do ht(_.Sym!==_),ht(_.Sym.Sym===_),ht(_.Lnext.Onext.Sym===_),ht(_.Onext.Sym.Lnext===_),ht(_.Org===x),_=_.Onext;while(_!==x.anEdge)}for(ht(x.prev===b&&x.anEdge===null),S=o,S=o;(_=S.next)!==o;S=_)ht(_.Sym.next===S.Sym),ht(_.Sym!==_),ht(_.Sym.Sym===_),ht(_.Org!==null),ht(_.Dst!==null),ht(_.Lnext.Onext.Sym===_),ht(_.Onext.Sym.Lnext===_);ht(_.Sym.next===S.Sym&&_.Sym===this.eHeadSym&&_.Sym.Sym===_&&_.Org===null&&_.Dst===null&&_.Lface===null&&_.Rface===null)},r}(),zO=function(){function r(){this.handle=null}return r}(),kO=function(){function r(){this.key=null,this.node=0}return r}(),rX=function(){function r(a,n){this.leq=n,this.max=0,this.nodes=[],this.handles=[],this.initialized=!1,this.freeList=0,this.size=0,this.max=a,this.nodes=[],this.handles=[];for(var o=0;o<a+1;o++)this.nodes[o]=new zO,this.handles[o]=new kO;this.initialized=!1,this.nodes[1].handle=1,this.handles[1].key=null}return r.prototype.floatDown_=function(a){var n=this.nodes,o=this.handles,f,y,x;for(f=n[a].handle;;){if(x=a<<1,x<this.size&&this.leq(o[n[x+1].handle].key,o[n[x].handle].key)&&++x,ht(x<=this.max),y=n[x].handle,x>this.size||this.leq(o[f].key,o[y].key)){n[a].handle=f,o[f].node=a;break}n[a].handle=y,o[y].node=a,a=x}},r.prototype.floatUp_=function(a){var n=this.nodes,o=this.handles,f,y,x;for(f=n[a].handle;;){if(x=a>>1,y=n[x].handle,x===0||this.leq(o[y].key,o[f].key)){n[a].handle=f,o[f].node=a;break}n[a].handle=y,o[y].node=a,a=x}},r.prototype.init=function(){for(var a=this.size;a>=1;--a)this.floatDown_(a);this.initialized=!0},r.prototype.min=function(){return this.handles[this.nodes[1].handle].key},r.prototype.insert=function(a){var n,o;if(n=++this.size,n*2>this.max){this.max*=2;var f,y;for(y=this.nodes.length,this.nodes.length=this.max+1,f=y;f<this.nodes.length;f++)this.nodes[f]=new zO;for(y=this.handles.length,this.handles.length=this.max+1,f=y;f<this.handles.length;f++)this.handles[f]=new kO}return this.freeList===0?o=n:(o=this.freeList,this.freeList=this.handles[o].node),this.nodes[n].handle=o,this.handles[o].node=n,this.handles[o].key=a,this.initialized&&this.floatUp_(n),o},r.prototype.extractMin=function(){var a=this.nodes,n=this.handles,o=a[1].handle,f=n[o].key;return this.size>0&&(a[1].handle=a[this.size].handle,n[a[1].handle].node=1,n[o].key=null,n[o].node=this.freeList,this.freeList=o,--this.size,this.size>0&&this.floatDown_(1)),f},r.prototype.delete=function(a){var n=this.nodes,o=this.handles,f;ht(a>=1&&a<=this.max&&o[a].key!==null),f=o[a].node,n[f].handle=n[this.size].handle,o[n[f].handle].node=f,--this.size,f<=this.size&&(f<=1||this.leq(o[n[f>>1].handle].key,o[n[f].handle].key)?this.floatDown_(f):this.floatUp_(f)),o[a].key=null,o[a].node=this.freeList,this.freeList=a},r}(),HA=function(){function r(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1}return r}(),GO=function(){function r(){this.key=null,this.next=null,this.prev=null}return r}(),iX=function(){function r(a,n){this.frame=a,this.leq=n,this.head=new GO,this.head.next=this.head,this.head.prev=this.head}return r.prototype.min=function(){return this.head.next},r.prototype.max=function(){return this.head.prev},r.prototype.insert=function(a){return this.insertBefore(this.head,a)},r.prototype.search=function(a){var n=this.head;do n=n.next;while(n.key!==null&&!this.leq(this.frame,a,n.key));return n},r.prototype.insertBefore=function(a,n){do a=a.prev;while(a.key!==null&&!this.leq(this.frame,a.key,n));var o=new GO;return o.key=n,o.next=a.next,a.next.prev=o,o.prev=a,a.next=o,o},r.prototype.delete=function(a){a.next.prev=a.prev,a.prev.next=a.next},r}(),nX=function(){function r(){}return r.regionBelow=function(a){return a.nodeUp.prev.key},r.regionAbove=function(a){return a.nodeUp.next.key},r.debugEvent=function(a){},r.addWinding=function(a,n){a.winding+=n.winding,a.Sym.winding+=n.Sym.winding},r.edgeLeq=function(a,n,o){var f=a.event,y=n.eUp,x=o.eUp;if(y.Dst===f)return x.Dst===f?lt.vertLeq(y.Org,x.Org)?lt.edgeSign(x.Dst,y.Org,x.Org)<=0:lt.edgeSign(y.Dst,x.Org,y.Org)>=0:lt.edgeSign(x.Dst,f,x.Org)<=0;if(x.Dst===f)return lt.edgeSign(y.Dst,f,y.Org)>=0;var b=lt.edgeEval(y.Dst,f,y.Org),_=lt.edgeEval(x.Dst,f,x.Org);return b>=_},r.deleteRegion=function(a,n){n.fixUpperEdge&&ht(n.eUp.winding===0),n.eUp.activeRegion=null,a.dict.delete(n.nodeUp)},r.fixUpperEdge=function(a,n,o){ht(n.fixUpperEdge),a.mesh.delete(n.eUp),n.fixUpperEdge=!1,n.eUp=o,o.activeRegion=n},r.topLeftRegion=function(a,n){var o=n.eUp.Org,f;do n=r.regionAbove(n);while(n.eUp.Org===o);if(n.fixUpperEdge){if(f=a.mesh.connect(r.regionBelow(n).eUp.Sym,n.eUp.Lnext),f===null)return null;r.fixUpperEdge(a,n,f),n=r.regionAbove(n)}return n},r.topRightRegion=function(a){var n=a.eUp.Dst;do a=r.regionAbove(a);while(a.eUp.Dst===n);return a},r.addRegionBelow=function(a,n,o){var f=new HA;return f.eUp=o,f.nodeUp=a.dict.insertBefore(n.nodeUp,f),f.fixUpperEdge=!1,f.sentinel=!1,f.dirty=!1,o.activeRegion=f,f},r.isWindingInside=function(a,n){switch(a.windingRule){case Wt.ODD:return(n&1)!==0;case Wt.NONZERO:return n!==0;case Wt.POSITIVE:return n>0;case Wt.NEGATIVE:return n<0;case Wt.ABS_GEQ_TWO:return n>=2||n<=-2}throw new Error("Invalid winding rulle")},r.computeWinding=function(a,n){n.windingNumber=r.regionAbove(n).windingNumber+n.eUp.winding,n.inside=r.isWindingInside(a,n.windingNumber)},r.finishRegion=function(a,n){var o=n.eUp,f=o.Lface;f.inside=n.inside,f.anEdge=o,r.deleteRegion(a,n)},r.finishLeftRegions=function(a,n,o){for(var f,y=null,x=n,b=n.eUp;x!==o;){if(x.fixUpperEdge=!1,y=r.regionBelow(x),f=y.eUp,f.Org!=b.Org){if(!y.fixUpperEdge){r.finishRegion(a,x);break}f=a.mesh.connect(b.Lprev,f.Sym),r.fixUpperEdge(a,y,f)}b.Onext!==f&&(a.mesh.splice(f.Oprev,f),a.mesh.splice(b,f)),r.finishRegion(a,x),b=y.eUp,x=y}return b},r.addRightEdges=function(a,n,o,f,y,x){var b,_,S,A,C=!0;S=o;do ht(lt.vertLeq(S.Org,S.Dst)),r.addRegionBelow(a,n,S.Sym),S=S.Onext;while(S!==f);for(y===null&&(y=r.regionBelow(n).eUp.Rprev),_=n,A=y;b=r.regionBelow(_),S=b.eUp.Sym,S.Org===A.Org;)S.Onext!==A&&(a.mesh.splice(S.Oprev,S),a.mesh.splice(A.Oprev,S)),b.windingNumber=_.windingNumber-S.winding,b.inside=r.isWindingInside(a,b.windingNumber),_.dirty=!0,!C&&r.checkForRightSplice(a,_)&&(r.addWinding(S,A),r.deleteRegion(a,_),a.mesh.delete(A)),C=!1,_=b,A=S;_.dirty=!0,ht(_.windingNumber-S.winding===b.windingNumber),x&&r.walkDirtyRegions(a,_)},r.spliceMergeVertices=function(a,n,o){a.mesh.splice(n,o)},r.vertexWeights=function(a,n,o){var f=lt.vertL1dist(n,a),y=lt.vertL1dist(o,a),x=.5*y/(f+y),b=.5*f/(f+y);a.coords[0]+=x*n.coords[0]+b*o.coords[0],a.coords[1]+=x*n.coords[1]+b*o.coords[1],a.coords[2]+=x*n.coords[2]+b*o.coords[2]},r.getIntersectData=function(a,n,o,f,y,x){n.coords[0]=n.coords[1]=n.coords[2]=0,n.idx=-1,r.vertexWeights(n,o,f),r.vertexWeights(n,y,x)},r.checkForRightSplice=function(a,n){var o=r.regionBelow(n),f=n.eUp,y=o.eUp;if(lt.vertLeq(f.Org,y.Org)){if(lt.edgeSign(y.Dst,f.Org,y.Org)>0)return!1;lt.vertEq(f.Org,y.Org)?f.Org!==y.Org&&(a.pq.delete(f.Org.pqHandle),r.spliceMergeVertices(a,y.Oprev,f)):(a.mesh.splitEdge(y.Sym),a.mesh.splice(f,y.Oprev),n.dirty=o.dirty=!0)}else{if(lt.edgeSign(f.Dst,y.Org,f.Org)<0)return!1;r.regionAbove(n).dirty=n.dirty=!0,a.mesh.splitEdge(f.Sym),a.mesh.splice(y.Oprev,f)}return!0},r.checkForLeftSplice=function(a,n){var o=r.regionBelow(n),f=n.eUp,y=o.eUp,x;if(ht(!lt.vertEq(f.Dst,y.Dst)),lt.vertLeq(f.Dst,y.Dst)){if(lt.edgeSign(f.Dst,y.Dst,f.Org)<0)return!1;r.regionAbove(n).dirty=n.dirty=!0,x=a.mesh.splitEdge(f),a.mesh.splice(y.Sym,x),x.Lface.inside=n.inside}else{if(lt.edgeSign(y.Dst,f.Dst,y.Org)>0)return!1;n.dirty=o.dirty=!0,x=a.mesh.splitEdge(y),a.mesh.splice(f.Lnext,y.Sym),x.Rface.inside=n.inside}return!0},r.checkForIntersect=function(a,n){var o=r.regionBelow(n),f=n.eUp,y=o.eUp,x=f.Org,b=y.Org,_=f.Dst,S=y.Dst,A,C,P=new Cd,T,M;if(ht(!lt.vertEq(S,_)),ht(lt.edgeSign(_,a.event,x)<=0),ht(lt.edgeSign(S,a.event,b)>=0),ht(x!==a.event&&b!==a.event),ht(!n.fixUpperEdge&&!o.fixUpperEdge),x===b||(A=Math.min(x.t,_.t),C=Math.max(b.t,S.t),A>C))return!1;if(lt.vertLeq(x,b)){if(lt.edgeSign(S,x,b)>0)return!1}else if(lt.edgeSign(_,b,x)<0)return!1;return r.debugEvent(a),lt.intersect(_,x,S,b,P),ht(Math.min(x.t,_.t)<=P.t),ht(P.t<=Math.max(b.t,S.t)),ht(Math.min(S.s,_.s)<=P.s),ht(P.s<=Math.max(b.s,x.s)),lt.vertLeq(P,a.event)&&(P.s=a.event.s,P.t=a.event.t),T=lt.vertLeq(x,b)?x:b,lt.vertLeq(T,P)&&(P.s=T.s,P.t=T.t),lt.vertEq(P,x)||lt.vertEq(P,b)?(r.checkForRightSplice(a,n),!1):!lt.vertEq(_,a.event)&&lt.edgeSign(_,a.event,P)>=0||!lt.vertEq(S,a.event)&&lt.edgeSign(S,a.event,P)<=0?S===a.event?(a.mesh.splitEdge(f.Sym),a.mesh.splice(y.Sym,f),n=r.topLeftRegion(a,n),f=r.regionBelow(n).eUp,r.finishLeftRegions(a,r.regionBelow(n),o),r.addRightEdges(a,n,f.Oprev,f,f,!0),!0):_===a.event?(a.mesh.splitEdge(y.Sym),a.mesh.splice(f.Lnext,y.Oprev),o=n,n=r.topRightRegion(n),M=r.regionBelow(n).eUp.Rprev,o.eUp=y.Oprev,y=r.finishLeftRegions(a,o,null),r.addRightEdges(a,n,y.Onext,f.Rprev,M,!0),!0):(lt.edgeSign(_,a.event,P)>=0&&(r.regionAbove(n).dirty=n.dirty=!0,a.mesh.splitEdge(f.Sym),f.Org.s=a.event.s,f.Org.t=a.event.t),lt.edgeSign(S,a.event,P)<=0&&(n.dirty=o.dirty=!0,a.mesh.splitEdge(y.Sym),y.Org.s=a.event.s,y.Org.t=a.event.t),!1):(a.mesh.splitEdge(f.Sym),a.mesh.splitEdge(y.Sym),a.mesh.splice(y.Oprev,f),f.Org.s=P.s,f.Org.t=P.t,f.Org.pqHandle=a.pq.insert(f.Org),r.getIntersectData(a,f.Org,x,_,b,S),r.regionAbove(n).dirty=n.dirty=o.dirty=!0,!1)},r.walkDirtyRegions=function(a,n){for(var o=r.regionBelow(n),f,y;;){for(;o.dirty;)n=o,o=r.regionBelow(o);if(!n.dirty&&(o=n,n=r.regionAbove(n),n===null||!n.dirty))return;if(n.dirty=!1,f=n.eUp,y=o.eUp,f.Dst!==y.Dst&&r.checkForLeftSplice(a,n)&&(o.fixUpperEdge?(r.deleteRegion(a,o),a.mesh.delete(y),o=r.regionBelow(n),y=o.eUp):n.fixUpperEdge&&(r.deleteRegion(a,n),a.mesh.delete(f),n=r.regionAbove(o),f=n.eUp)),f.Org!==y.Org)if(f.Dst!==y.Dst&&!n.fixUpperEdge&&!o.fixUpperEdge&&(f.Dst===a.event||y.Dst===a.event)){if(r.checkForIntersect(a,n))return}else r.checkForRightSplice(a,n);f.Org===y.Org&&f.Dst===y.Dst&&(r.addWinding(y,f),r.deleteRegion(a,n),a.mesh.delete(f),n=r.regionAbove(o))}},r.connectRightVertex=function(a,n,o){var f,y=o.Onext,x=r.regionBelow(n),b=n.eUp,_=x.eUp,S=!1;if(b.Dst!==_.Dst&&r.checkForIntersect(a,n),lt.vertEq(b.Org,a.event)&&(a.mesh.splice(y.Oprev,b),n=r.topLeftRegion(a,n),y=r.regionBelow(n).eUp,r.finishLeftRegions(a,r.regionBelow(n),x),S=!0),lt.vertEq(_.Org,a.event)&&(a.mesh.splice(o,_.Oprev),o=r.finishLeftRegions(a,x,null),S=!0),S){r.addRightEdges(a,n,o.Onext,y,y,!0);return}lt.vertLeq(_.Org,b.Org)?f=_.Oprev:f=b,f=a.mesh.connect(o.Lprev,f),r.addRightEdges(a,n,f,f.Onext,f.Onext,!1),f.Sym.activeRegion.fixUpperEdge=!0,r.walkDirtyRegions(a,n)},r.connectLeftDegenerate=function(a,n,o){var f,y,x,b,_;if(f=n.eUp,lt.vertEq(f.Org,o)){ht(!1),r.spliceMergeVertices(a,f,o.anEdge);return}if(!lt.vertEq(f.Dst,o)){a.mesh.splitEdge(f.Sym),n.fixUpperEdge&&(a.mesh.delete(f.Onext),n.fixUpperEdge=!1),a.mesh.splice(o.anEdge,f),r.sweepEvent(a,o);return}ht(!1),n=r.topRightRegion(n),_=r.regionBelow(n),x=_.eUp.Sym,y=b=x.Onext,_.fixUpperEdge&&(ht(y!==x),r.deleteRegion(a,_),a.mesh.delete(x),x=y.Oprev),a.mesh.splice(o.anEdge,x),lt.edgeGoesLeft(y)||(y=null),r.addRightEdges(a,n,x.Onext,b,y,!0)},r.connectLeftVertex=function(a,n){var o,f,y,x,b,_,S=new HA;if(S.eUp=n.anEdge.Sym,o=a.dict.search(S).key,f=r.regionBelow(o),!!f){if(x=o.eUp,b=f.eUp,lt.edgeSign(x.Dst,n,x.Org)===0){r.connectLeftDegenerate(a,o,n);return}if(y=lt.vertLeq(b.Dst,x.Dst)?o:f,o.inside||y.fixUpperEdge){if(y===o)_=a.mesh.connect(n.anEdge.Sym,x.Lnext);else{var A=a.mesh.connect(b.Dnext,n.anEdge);_=A.Sym}y.fixUpperEdge?r.fixUpperEdge(a,y,_):r.computeWinding(a,r.addRegionBelow(a,o,_)),r.sweepEvent(a,n)}else r.addRightEdges(a,o,n.anEdge,n.anEdge,null,!0)}},r.sweepEvent=function(a,n){a.event=n,r.debugEvent(a);for(var o=n.anEdge;o.activeRegion===null;)if(o=o.Onext,o===n.anEdge){r.connectLeftVertex(a,n);return}var f=r.topLeftRegion(a,o.activeRegion);ht(f!==null);var y=r.regionBelow(f),x=y.eUp,b=r.finishLeftRegions(a,y,null);b.Onext===x?r.connectRightVertex(a,f,b):r.addRightEdges(a,f,b.Onext,x,x,!0)},r.addSentinel=function(a,n,o,f){var y=new HA,x=a.mesh.makeEdge();x.Org.s=o,x.Org.t=f,x.Dst.s=n,x.Dst.t=f,a.event=x.Dst,y.eUp=x,y.windingNumber=0,y.inside=!1,y.fixUpperEdge=!1,y.sentinel=!0,y.dirty=!1,y.nodeUp=a.dict.insert(y)},r.initEdgeDict=function(a){a.dict=new iX(a,r.edgeLeq);var n=a.bmax[0]-a.bmin[0],o=a.bmax[1]-a.bmin[1],f=a.bmin[0]-n,y=a.bmax[0]+n,x=a.bmin[1]-o,b=a.bmax[1]+o;r.addSentinel(a,f,y,x),r.addSentinel(a,f,y,b)},r.doneEdgeDict=function(a){for(var n,o=0;(n=a.dict.min().key)!==null;)n.sentinel||(ht(n.fixUpperEdge),ht(++o===1)),ht(n.windingNumber===0),r.deleteRegion(a,n)},r.removeDegenerateEdges=function(a){var n,o,f,y=a.mesh.eHead;for(n=y.next;n!==y;n=o)o=n.next,f=n.Lnext,lt.vertEq(n.Org,n.Dst)&&n.Lnext.Lnext!==n&&(r.spliceMergeVertices(a,f,n),a.mesh.delete(n),n=f,f=n.Lnext),f.Lnext===n&&(f!==n&&((f===o||f===o.Sym)&&(o=o.next),a.mesh.delete(f)),(n===o||n===o.Sym)&&(o=o.next),a.mesh.delete(n))},r.initPriorityQ=function(a){var n,o,f,y=0;for(f=a.mesh.vHead,o=f.next;o!==f;o=o.next)y++;for(y+=8,n=a.pq=new rX(y,lt.vertLeq),f=a.mesh.vHead,o=f.next;o!==f;o=o.next)o.pqHandle=n.insert(o);return o!==f?!1:(n.init(),!0)},r.donePriorityQ=function(a){a.pq=null},r.removeDegenerateFaces=function(a,n){var o,f,y;for(o=n.fHead.next;o!==n.fHead;o=f)f=o.next,y=o.anEdge,ht(y.Lnext!==y),y.Lnext.Lnext===y&&(r.addWinding(y.Onext,y),a.mesh.delete(y));return!0},r.computeInterior=function(a,n){n===void 0&&(n=!0);var o,f;if(r.removeDegenerateEdges(a),!r.initPriorityQ(a))return!1;for(r.initEdgeDict(a);(o=a.pq.extractMin())!==null;){for(;f=a.pq.min(),!(f===null||!lt.vertEq(f,o));)f=a.pq.extractMin(),r.spliceMergeVertices(a,o.anEdge,f.anEdge);r.sweepEvent(a,o)}return a.event=a.dict.min().key.eUp.Org,r.debugEvent(a),r.doneEdgeDict(a),r.donePriorityQ(a),r.removeDegenerateFaces(a,a.mesh)?(n&&a.mesh.check(),!0):!1},r}(),sX=function(){function r(){this.mesh=new UO,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=Wt.ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}return r.prototype.dot_=function(a,n){return a[0]*n[0]+a[1]*n[1]+a[2]*n[2]},r.prototype.normalize_=function(a){var n=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];if(!n)throw"Zero-size vector!";n=Math.sqrt(n),a[0]/=n,a[1]/=n,a[2]/=n},r.prototype.longAxis_=function(a){var n=0;return Math.abs(a[1])>Math.abs(a[0])&&(n=1),Math.abs(a[2])>Math.abs(a[n])&&(n=2),n},r.prototype.computeNormal_=function(a){var n,o,f,y,x,b,_=[0,0,0],S=[0,0,0],A=[0,0,0],C=[0,0,0],P=[0,0,0],T=[null,null,null],M=[null,null,null],O=this.mesh.vHead;n=O.next;for(var I=0;I<3;++I)y=n.coords[I],S[I]=y,M[I]=n,_[I]=y,T[I]=n;for(n=O.next;n!==O;n=n.next)for(var D=0;D<3;++D)y=n.coords[D],y<S[D]&&(S[D]=y,M[D]=n),y>_[D]&&(_[D]=y,T[D]=n);var z=0;if(_[1]-S[1]>_[0]-S[0]&&(z=1),_[2]-S[2]>_[z]-S[z]&&(z=2),S[z]>=_[z]){a[0]=0,a[1]=0,a[2]=1;return}for(b=0,o=M[z],f=T[z],A[0]=o.coords[0]-f.coords[0],A[1]=o.coords[1]-f.coords[1],A[2]=o.coords[2]-f.coords[2],n=O.next;n!==O;n=n.next)C[0]=n.coords[0]-f.coords[0],C[1]=n.coords[1]-f.coords[1],C[2]=n.coords[2]-f.coords[2],P[0]=A[1]*C[2]-A[2]*C[1],P[1]=A[2]*C[0]-A[0]*C[2],P[2]=A[0]*C[1]-A[1]*C[0],x=P[0]*P[0]+P[1]*P[1]+P[2]*P[2],x>b&&(b=x,a[0]=P[0],a[1]=P[1],a[2]=P[2]);b<=0&&(a[0]=a[1]=a[2]=0,a[this.longAxis_(A)]=1)},r.prototype.checkOrientation_=function(){for(var a=this.mesh.fHead,n,o=this.mesh.vHead,f,y=0,x=a.next;x!==a;x=x.next)if(f=x.anEdge,!(f.winding<=0))do y+=(f.Org.s-f.Dst.s)*(f.Org.t+f.Dst.t),f=f.Lnext;while(f!==x.anEdge);if(y<0){for(n=o.next;n!==o;n=n.next)n.t=-n.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},r.prototype.projectPolygon_=function(){var a=this.mesh.vHead,n=[0,0,0],o,f,y=!1;n[0]=this.normal[0],n[1]=this.normal[1],n[2]=this.normal[2],!n[0]&&!n[1]&&!n[2]&&(this.computeNormal_(n),y=!0),o=this.sUnit,f=this.tUnit;var x=this.longAxis_(n);o[x]=0,o[(x+1)%3]=1,o[(x+2)%3]=0,f[x]=0,f[(x+1)%3]=0,f[(x+2)%3]=n[x]>0?1:-1;for(var b=a.next;b!==a;b=b.next)b.s=this.dot_(b.coords,o),b.t=this.dot_(b.coords,f);y&&this.checkOrientation_();for(var _=!0,S=a.next;S!==a;S=S.next)_?(this.bmin[0]=this.bmax[0]=S.s,this.bmin[1]=this.bmax[1]=S.t,_=!1):(S.s<this.bmin[0]&&(this.bmin[0]=S.s),S.s>this.bmax[0]&&(this.bmax[0]=S.s),S.t<this.bmin[1]&&(this.bmin[1]=S.t),S.t>this.bmax[1]&&(this.bmax[1]=S.t))},r.prototype.addWinding_=function(a,n){a.winding+=n.winding,a.Sym.winding+=n.Sym.winding},r.prototype.tessellateMonoRegion_=function(a,n){var o,f;if(o=n.anEdge,!(o.Lnext!==o&&o.Lnext.Lnext!==o))throw"Mono region invalid";for(;lt.vertLeq(o.Dst,o.Org);o=o.Lprev);for(;lt.vertLeq(o.Org,o.Dst);o=o.Lnext);f=o.Lprev;for(var y=void 0;o.Lnext!==f;)if(lt.vertLeq(o.Dst,f.Org)){for(;f.Lnext!==o&&(lt.edgeGoesLeft(f.Lnext)||lt.edgeSign(f.Org,f.Dst,f.Lnext.Dst)<=0);)y=a.connect(f.Lnext,f),f=y.Sym;f=f.Lprev}else{for(;f.Lnext!==o&&(lt.edgeGoesRight(o.Lprev)||lt.edgeSign(o.Dst,o.Org,o.Lprev.Org)>=0);)y=a.connect(o,o.Lprev),o=y.Sym;o=o.Lnext}if(f.Lnext===o)throw"Mono region invalid";for(;f.Lnext.Lnext!==o;)y=a.connect(f.Lnext,f),f=y.Sym;return!0},r.prototype.tessellateInterior_=function(a){for(var n,o=a.fHead.next;o!==a.fHead;o=n)if(n=o.next,o.inside&&!this.tessellateMonoRegion_(a,o))return!1;return!0},r.prototype.discardExterior_=function(a){for(var n,o=a.fHead.next;o!==a.fHead;o=n)n=o.next,o.inside||a.zapFace(o)},r.prototype.setWindingNumber_=function(a,n,o){for(var f,y=a.eHead.next;y!==a.eHead;y=f)f=y.next,y.Rface.inside!==y.Lface.inside?y.winding=y.Lface.inside?n:-n:o?a.delete(y):y.winding=0},r.prototype.getNeighbourFace_=function(a){return!a.Rface||!a.Rface.inside?-1:a.Rface.n},r.prototype.outputPolymesh_=function(a,n,o,f){var y,x=0,b=0,_;o>3&&a.mergeConvexFaces(o);for(var S=a.vHead.next;S!==a.vHead;S=S.next)S.n=-1;for(var A=a.fHead.next;A!==a.fHead;A=A.next)if(A.n=-1,!!A.inside){y=A.anEdge,_=0;do{var S=y.Org;S.n===-1&&(S.n=b,b++),_++,y=y.Lnext}while(y!==A.anEdge);if(_>o)throw"Face vertex greater that support polygon";A.n=x,++x}this.elementCount=x,n===Xr.CONNECTED_POLYGONS&&(x*=2),this.elements=[],this.elements.length=x*o,this.vertexCount=b,this.vertices=[],this.vertices.length=b*f,this.vertexIndices=[],this.vertexIndices.length=b;for(var S=a.vHead.next;S!==a.vHead;S=S.next)if(S.n!==-1){var C=S.n*f;this.vertices[C+0]=S.coords[0],this.vertices[C+1]=S.coords[1],f>2&&(this.vertices[C+2]=S.coords[2]),this.vertexIndices[S.n]=S.idx}for(var P=0,A=a.fHead.next;A!==a.fHead;A=A.next)if(A.inside){y=A.anEdge,_=0;do{var S=y.Org;this.elements[P++]=S.n,_++,y=y.Lnext}while(y!==A.anEdge);for(var T=_;T<o;++T)this.elements[P++]=-1;if(n===Xr.CONNECTED_POLYGONS){y=A.anEdge;do this.elements[P++]=this.getNeighbourFace_(y),y=y.Lnext;while(y!==A.anEdge);for(var M=_;M<o;++M)this.elements[P++]=-1}}},r.prototype.outputContours_=function(a,n){var o,f,y=0,x=0;this.vertexCount=0,this.elementCount=0;for(var b=a.fHead.next;b!==a.fHead;b=b.next)if(b.inside){f=o=b.anEdge;do this.vertexCount++,o=o.Lnext;while(o!==f);this.elementCount++}this.elements=[],this.elements.length=this.elementCount*2,this.vertices=[],this.vertices.length=this.vertexCount*n,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var _=0,S=0,A=0;y=0;for(var b=a.fHead.next;b!==a.fHead;b=b.next)if(b.inside){x=0,f=o=b.anEdge;do this.vertices[_++]=o.Org.coords[0],this.vertices[_++]=o.Org.coords[1],n>2&&(this.vertices[_++]=o.Org.coords[2]),this.vertexIndices[S++]=this.vertexIdCallback?this.vertexIdCallback(o):o.Org.idx,x++,o=o.Lnext;while(o!==f);this.elements[A++]=y,this.elements[A++]=x,y+=x}},r.prototype.addContour=function(a,n){this.mesh===null&&(this.mesh=new UO),a<2&&(a=2),a>3&&(a=3);for(var o=null,f=0;f<n.length;f+=a)o===null?(o=this.mesh.makeEdge(),this.mesh.splice(o,o.Sym)):(this.mesh.splitEdge(o),o=o.Lnext),o.Org.coords[0]=n[f+0],o.Org.coords[1]=n[f+1],a>2?o.Org.coords[2]=n[f+2]:o.Org.coords[2]=0,o.Org.idx=this.vertexIndexCounter++,this.edgeCreateCallback&&this.edgeCreateCallback(o),o.winding=1,o.Sym.winding=-1},r.prototype.tesselate=function(a,n,o,f,y,x){if(a===void 0&&(a=Wt.ODD),n===void 0&&(n=Xr.POLYGONS),x===void 0&&(x=!0),this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,y&&(this.normal[0]=y[0],this.normal[1]=y[1],this.normal[2]=y[2]),this.windingRule=a,f<2&&(f=2),f>3&&(f=3),!this.mesh)return!1;this.projectPolygon_(),nX.computeInterior(this,x);var b=this.mesh;return n===Xr.BOUNDARY_CONTOURS?this.setWindingNumber_(b,1,!0):this.tessellateInterior_(b),x&&b.check(),n===Xr.BOUNDARY_CONTOURS?this.outputContours_(b,f):this.outputPolymesh_(b,n,o,f),!0},r}();function Xs(r){var a=r.windingRule,n=a===void 0?Wt.ODD:a,o=r.elementType,f=o===void 0?Xr.POLYGONS:o,y=r.polySize,x=y===void 0?3:y,b=r.vertexSize,_=b===void 0?2:b,S=r.normal,A=S===void 0?[0,0,1]:S,C=r.contours,P=C===void 0?[]:C,T=r.strict,M=T===void 0?!0:T,O=r.debug,I=O===void 0?!1:O;if(!P&&M)throw new Error("Contours can't be empty");if(P){var D=new sX;r.edgeCreateCallback&&(D.edgeCreateCallback=r.edgeCreateCallback),r.vertexIdCallback&&(D.vertexIdCallback=r.vertexIdCallback);for(var z=0;z<P.length;z++)D.addContour(_||2,P[z]);return D.tesselate(n,f,x,_,A,M),{vertices:D.vertices,vertexIndices:D.vertexIndices,vertexCount:D.vertexCount,elements:D.elements,elementCount:D.elementCount,mesh:I?D.mesh:void 0}}}Wt.ODD;Wt.NONZERO;Wt.POSITIVE;Wt.NEGATIVE;Wt.ABS_GEQ_TWO;Xr.POLYGONS;Xr.CONNECTED_POLYGONS;Xr.BOUNDARY_CONTOURS;var U0=class{constructor(r=256,a=!1){this.capacity=r,this.size=0,this.debug=a,this.debug&&console.log(`allocating with cap ${r}`);let n=r*U0.eSize;this.buffer=new ArrayBuffer(n);let o=Float32Array.BYTES_PER_ELEMENT,f=0;this.positions=new Float32Array(this.buffer,f*o,3*r),f+=3*r,this.normals=new Float32Array(this.buffer,f*o,3*r),f+=3*r,this.uvs=new Float32Array(this.buffer,f*o,2*r)}realloc(r,a=!1){if(r<this.size)throw Error("cannot shrink buffer");if(r<=this.capacity&&!a)return;this.debug&&console.log(`resizing from ${this.capacity} → ${r}`);let n=r*U0.eSize,o=new ArrayBuffer(n),f=Float32Array.BYTES_PER_ELEMENT,y=0,x=new Float32Array(o,y*f,3*r);y+=3*r;let b=new Float32Array(o,y*f,3*r);y+=3*r;let _=new Float32Array(o,y*f,2*r);a?(x.set(this.positions.subarray(0,this.size*3)),b.set(this.normals.subarray(0,this.size*3)),_.set(this.uvs.subarray(0,this.size*2))):(x.set(this.positions),b.set(this.normals),_.set(this.uvs)),this.buffer=o,this.positions=x,this.normals=b,this.uvs=_,this.capacity=r}get(r=1){let a=this.size+r;if(a>this.capacity){let o=this.capacity;for(;a>o;)o*=2;this.realloc(o)}let n=this.size;return this.size=a,n}reserve(r){let a=this.size+r;a>this.capacity&&this.realloc(a)}shrink(){this.debug&&console.log(`shrinking ${this.capacity} → ${this.size}`),this.realloc(this.size,!0)}},xm=U0;xm.eSize=8*Float32Array.BYTES_PER_ELEMENT;var bm=class{constructor(r=[],a=(n,o)=>n<o?-1:n>o?1:0){if(this.data=r,this.length=this.data.length,this.compare=a,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(r){this.data.push(r),this._up(this.length++)}pop(){if(this.length===0)return;let r=this.data[0],a=this.data.pop();return--this.length>0&&(this.data[0]=a,this._down(0)),r}peek(){return this.data[0]}_up(r){let{data:a,compare:n}=this,o=a[r];for(;r>0;){let f=r-1>>1,y=a[f];if(n(o,y)>=0)break;a[r]=y,r=f}a[r]=o}_down(r){let{data:a,compare:n}=this,o=this.length>>1,f=a[r];for(;r<o;){let y=(r<<1)+1,x=y+1;if(x<this.length&&n(a[x],a[y])<0&&(y=x),n(a[y],f)>=0)break;a[r]=a[y],r=y}a[r]=f}};function WA(r,a,n=1,o=!1){let f=1/0,y=1/0,x=-1/0,b=-1/0;for(let[z,k]of r[0])z<f&&(f=z),k<y&&(y=k),z>x&&(x=z),k>b&&(b=k);let _=x-f,S=b-y,A=Math.max(n,Math.min(_,S));if(A===n){let z=[f,y];return z.distance=0,z.distance}let C=new bm([],(z,k)=>k.max-z.max),P=aX(r),T=new z0(f+_/2,y+S/2,0,r);T.d>P.d&&(P=T);let M=2;function O(z,k,L){let R=new z0(z,k,L,r);if(M++,R.max>P.d+n&&C.push(R),R.d>P.d&&(P=R,o&&console.log(`found best ${Math.round(1e4*R.d)/1e4} after ${M} probes`),P.d>a))return a}let I=A/2;for(let z=f;z<x;z+=A)for(let k=y;k<b;k+=A)O(z+I,k+I,I);for(;C.length;){let{max:z,x:k,y:L,h:R}=C.pop();if(z-P.d<=n)break;I=R/2,O(k-I,L-I,I),O(k+I,L-I,I),O(k-I,L+I,I),O(k+I,L+I,I)}o&&console.log(`num probes: ${M}
best distance: ${P.d}`);let D=[P.x,P.y];return D.distance=P.d,D.distance}function z0(r,a,n,o){this.x=r,this.y=a,this.h=n,this.d=oX(r,a,o),this.max=this.d+this.h*Math.SQRT2}function oX(r,a,n){let o=!1,f=1/0;for(let y of n)for(let x=0,b=y.length,_=b-1;x<b;_=x++){let S=y[x],A=y[_];S[1]>a!=A[1]>a&&r<(A[0]-S[0])*(a-S[1])/(A[1]-S[1])+S[0]&&(o=!o),f=Math.min(f,lX(r,a,S,A))}return f===0?0:(o?1:-1)*Math.sqrt(f)}function aX(r){let a=0,n=0,o=0,f=r[0];for(let x=0,b=f.length,_=b-1;x<b;_=x++){let S=f[x],A=f[_],C=S[0]*A[1]-A[0]*S[1];n+=(S[0]+A[0])*C,o+=(S[1]+A[1])*C,a+=C*3}let y=new z0(n/a,o/a,0,r);return a===0||y.d<0?new z0(f[0][0],f[0][1],0,r):y}function lX(r,a,n,o){let f=n[0],y=n[1],x=o[0]-f,b=o[1]-y;if(x!==0||b!==0){let _=((r-f)*x+(a-y)*b)/(x*x+b*b);_>1?(f=o[0],y=o[1]):_>0&&(f+=x*_,y+=b*_)}return x=r-f,b=a-y,x*x+b*b}var Sm={vertices:[160,160,-160,160,-160,-160,160,-160],vertexIndices:[1,0,3,2],vertexCount:4,elements:[0,4],elementCount:1,mesh:void 0},XA={vertices:[],vertexIndices:[],vertexCount:0,elements:[],elementCount:0,mesh:void 0},YA={vertices:[-160,160,160,-160,160,160,-160,-160],vertexIndices:[1,3,0,2],vertexCount:4,elements:[0,1,2,1,0,3],elementCount:2,mesh:void 0},qA=(r,a)=>([n,o])=>(o<n&&(o+=a),(r>=n?r:r+a)<=o),kl=class extends Ce{constructor(r,a,n=0,o=12,f=3,y=Wt.ODD,x=!1){super(),this.forPathBevel=x,this.type="ShapeGeometry",this.vertexCache={},this._shape=r,this._depth=a,this._curveSegments=o,this._bevelSegmentsInput=f;let b=this._shape.extractShapePointsToFlatArray([],o),_=this._shape.shapeHoles.map(j=>{let G=j.extractShapePointsToFlatArray([],o),Y=[];for(let X=G.length-1;X>=1;X-=2){let $=G[X-1],te=G[X-0];Y.push($,te)}return Y}),S=[],A=[];for(let j=0;j<b.length;j+=2)A.push([b[j],b[j+1]]);S.push(A);for(let j=0;j<_.length;j++){let G=_[j],Y=[];for(let X=0;X<G.length;X+=2)Y.push([G[X],G[X+1]]);S.push(Y)}let C;r.isText?C=new gl().setFromPoints(r.points.map(j=>j.position)).getSize(new V).length()*.1:S[0].length===0?C=n:n>0?C=WA(S,n):C=1e-5,n<=0?(this._bevel=0,this._bevelSegments=0):(this._bevel=Math.min(n,C,a/2),this._bevelSegments=Math.floor(f));let P;try{P=Xs({windingRule:y,elementType:Xr.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[b]})}catch{P=Sm}let T;try{T=Xs({windingRule:Wt.ODD,elementType:Xr.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[..._]})}catch{T=XA}if(!P)throw new Error("error generating geometry");let M=P.elementCount;if(T){P.elementCount+=T.elementCount;for(let j=0;j<T.elements.length;j++){let G=T.elements[j],Y=j%2===0?P.vertexCount:0;P.elements.push(G+Y)}for(let j=0;j<T.vertexIndices.length;j++){let G=T.vertexIndices[j],Y=P.vertexCount;P.vertexIndices.push(G+Y)}for(let j=0;j<T.vertices.length;j++){let G=T.vertices[j];P.vertices.push(G)}}let O=1/0,I=-1/0,D=1/0,z=-1/0;for(let j=0,G=P.vertexCount;j<G;j++){let Y=j*2,X=P.vertices[Y+0],$=P.vertices[Y+1];X<O&&(O=X),X>I&&(I=X),$<D&&(D=$),$>z&&(z=$)}this._minX=O,this._minY=D,this._width=I-O,this._height=z-D,this._buffer=new xm(this._computeBufferEstimatedSize(P));let k=[],L=[];for(let j=P.elementCount-1;j>=0;j--){let G=j>=M,Y=j*2,X=P.elements[Y+0],$=P.elements[Y+1],te=X+$,ee={start:X,count:$,normals:[],continuous:[],concave:[]},q=X,Z=te-1,U=X+1,W=this._shape.roundedCurves.length;do{let ne=q-X,pe=P.vertices[Z*2+0],ge=P.vertices[Z*2+1],ye=P.vertices[q*2+0],_e=P.vertices[q*2+1],ve=P.vertices[U*2+0],Ee=P.vertices[U*2+1],xe=ye-pe,Me=_e-ge,Pe=Math.sqrt(xe*xe+Me*Me);xe/=Pe,Me/=Pe;let be=ye-ve,Oe=_e-Ee,Be=Math.sqrt(be*be+Oe*Oe);be/=Be,Oe/=Be,ee.normals[ne*2+0]=-Oe,ee.normals[ne*2+1]=be,ee.concave[ne]=xe*Oe-Me*be>0;let oe=P.vertexIndices[q];if(Array.isArray(oe))ee.continuous[ne]=!1;else{let[De,ze]=this._shape.getCurveIndexFromVertexId(oe-1,!0);if(ze>0&&ze<1)ee.continuous[ne]=!0;else{let Ne=ze===1?De+1:De-1;Ne=(Ne+W)%W;let Le=ze===1?0:1,bt=this._shape.roundedCurves[De].getTangent(ze),Ve=this._shape.roundedCurves[Ne].getTangent(Le);ee.continuous[ne]=bt.dot(Ve)>.95}}G&&(ee.normals[ne*2+0]*=-1,ee.normals[ne*2+1]*=-1),[Z,q,U]=[q,U,U+1],U>=te&&(U-=$)}while(U!==X+1);let H=[];H.push({bevelI:0,angle:0,size:0,boundary:{vertices:P.vertices.slice(X*2,te*2),vertexCount:$,vertexIndices:new Array($).fill(!0).map((ne,pe)=>[pe,pe]),elements:[0,$],elementCount:1,mesh:null},reverseMap:[],insetPoints:P.vertices.slice(X*2,te*2)});let K=0;for(let ne=1;ne<=this._bevelSegments;ne++){let pe=ne/this._bevelSegments*Math.PI/2,ge=(1-Math.cos(pe))*this._bevel,ye=[],_e=[],ve=0;for(let xe=0;xe<$;xe++){let Me=xe*2,Pe=(xe-1+$)%$*2,be=P.vertices[ee.start*2+Me+0],Oe=P.vertices[ee.start*2+Me+1],Be=-ee.normals[Pe+0]*ge,oe=-ee.normals[Pe+1]*ge,De=-ee.normals[Me+0]*ge,ze=-ee.normals[Me+1]*ge;if(ee.concave[xe]||!ee.concave[xe]&&G){let Ne=Math.atan2(oe,Be),Le=Math.atan2(ze,De);Le>Ne&&(Le-=Math.PI*2);let bt=Le-Ne;if(ee.continuous[xe]||G){let Ve=Ne+bt/2,He=Math.cos(Ve)*ge,tt=Math.sin(Ve)*ge;ye[2*ve+0]=be+He*(G?-1:1),ye[2*ve+1]=Oe+tt*(G?-1:1),_e[ve]=xe,ve++}else{let Ve=Math.max(1,Math.floor(o/4*Math.abs(bt)/Math.PI));for(let He=0;He<=Ve;He++){let tt=Ne+bt*(He/Ve),ie=Math.cos(tt)*ge,We=Math.sin(tt)*ge;ye[2*ve+0]=be+ie,ye[2*ve+1]=Oe+We,_e[ve]=xe,ve++}}}else ye[2*ve+0]=be+Be,ye[2*ve+1]=Oe+oe,_e[ve]=xe,ve++,ye[2*ve+0]=be,ye[2*ve+1]=Oe,_e[ve]=xe,ve++,ye[2*ve+0]=be+De,ye[2*ve+1]=Oe+ze,_e[ve]=xe,ve++}let Ee=Xs({windingRule:Wt.POSITIVE,elementType:Xr.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[ye],edgeCreateCallback:xe=>{let Me=xe.Org.idx,Pe=_e[Me],be=_e[(Me+1)%_e.length];xe.idx=[Pe,be],xe.Sym.idx=[be,Pe]},vertexIdCallback:xe=>{let Me=xe.Lprev.idx;return[Me?Me[1]:0,xe.idx?xe.idx[0]:0]}});if(!Ee)throw console.log("Error"),new Error(`error generating bevel geometry for ${ne}'th loop`);if(!Ee.vertexCount){let xe=(ne-1)/this._bevelSegments*Math.PI/2;K=(1-Math.sin(xe))*this._bevel;break}for(let xe=0;xe<Ee.vertexIndices.length;xe++){let[Me,Pe]=Ee.vertexIndices[xe];if(Me===Pe)continue;let be=Pe;Pe<Me&&(be+=$);for(let Oe=Me;Oe<be;Oe++){let Be=Oe%$,oe=(Oe+1)%$;if(!ee.continuous[Be]||!ee.continuous[oe]){Ee.vertexIndices[xe]=[Me,Be],Ee.vertexIndices.splice(xe+1,0,[oe,Pe]),Ee.vertices.splice((xe+1)*2,0,Ee.vertices[xe*2],Ee.vertices[xe*2+1]);break}}}H.push({bevelI:ne,angle:pe,size:ge,boundary:Ee,reverseMap:_e,insetPoints:ye})}let le=(ne,pe,ge)=>{let ye=0,_e=ne.boundary.vertexIndices.length;for(;ye<_e&&ge(ne.boundary.vertexIndices[pe]);)pe=(pe+1)%_e,ye++;return ye},me=k.length;for(let ne=1;ne<H.length;ne++){let pe=H[ne-1],ge=H[ne],ye=pe.boundary.vertexIndices.length,_e=ge.boundary.vertexIndices.length;if(!ye||!_e)break;let ve=ee.concave.length,Ee=0,xe=qA(Ee,$);for(;!pe.boundary.vertexIndices.filter(xe).length||!ge.boundary.vertexIndices.filter(xe).length;)Ee++,xe=qA(Ee,$);let Me=pe.boundary.vertexIndices.findIndex(xe),Pe=ge.boundary.vertexIndices.findIndex(xe);do Me=(Me+1)%ye;while(xe(pe.boundary.vertexIndices[Me]));do Pe=(Pe+1)%_e;while(xe(ge.boundary.vertexIndices[Pe]));Ee=(Ee+1)%$;let be=Ee,Oe=0,Be=this._buildBevelVert(ee,pe,(Me-1+ye)%ye,void 0,Oe),oe=this._buildBevelVert(ee,ge,(Pe-1+_e)%_e,void 0,Oe),De=Be,ze=oe,Ne,Le,bt=!1;do{Oe=(Ee||ve)/ve,xe=qA(Ee,$);let Ve=le(pe,Me,xe),He=le(ge,Pe,xe),tt=bt;if(bt=!1,Ve&&!He){for(let ie=0;ie<Ve;ie++)Ne=this._buildBevelVert(ee,pe,(Me+ie)%ye,ie/(Ve-1),Oe),k.push(De.topN,Ne.topP,ze.topN),x===!1&&k.push(Ne.bottomP,De.bottomN,ze.bottomN),De=Ne;bt=!0}else if(!Ve&&He)for(let ie=0;ie<He;ie++)Le=this._buildBevelVert(ee,ge,(Pe+ie)%_e,ie/(He-1),Oe),k.push(ze.topN,De.topP,Le.topP),x===!1&&k.push(De.bottomP,ze.bottomN,Le.bottomP),ze=Le;else if(Ve&&He)if(Ne=this._buildBevelVert(ee,pe,Me,0,Oe),Le=this._buildBevelVert(ee,ge,Pe,0,Oe),tt?(k.push(De.topN,Le.topP,ze.topN),k.push(De.topN,Ne.topP,Le.topP),x===!1&&(k.push(Le.bottomP,De.bottomN,ze.bottomN),k.push(Le.bottomP,Ne.bottomP,De.bottomN))):(k.push(ze.topN,De.topN,Ne.topP),k.push(ze.topN,Ne.topP,Le.topP),x===!1&&(k.push(Ne.bottomP,De.bottomN,ze.bottomN),k.push(Ne.bottomP,ze.bottomN,Le.bottomP))),De=Ne,ze=Le,Ve===He)for(let ie=1;ie<Ve;ie++)Ne=this._buildBevelVert(ee,pe,(Me+ie)%ye,ie/(Ve-1),Oe),Le=this._buildBevelVert(ee,ge,(Pe+ie)%_e,ie/(He-1),Oe),k.push(De.topN,Ne.topP,ze.topN),k.push(ze.topN,Ne.topP,Le.topP),x===!1&&(k.push(Ne.bottomP,De.bottomN,ze.bottomN),k.push(Ne.bottomP,ze.bottomN,Le.bottomP)),De=Ne,ze=Le;else if(Ve>He){let ie=Ve/He,We=0;for(let wt=1;wt<Ve;wt++)Ne=this._buildBevelVert(ee,pe,(Me+wt)%ye,wt/(Ve-1),Oe),k.push(De.topN,Ne.topP,ze.topN),x===!1&&k.push(Ne.bottomP,De.bottomN,ze.bottomN),De=Ne,wt>(We+1)*ie&&(We++,Le=this._buildBevelVert(ee,ge,(Pe+We)%_e,We/(He-1),Oe),k.push(ze.topN,Ne.topP,Le.topP),x===!1&&k.push(Ne.bottomP,ze.bottomN,Le.bottomP),ze=Le)}else{let ie=He/Ve,We=0;for(let wt=1;wt<He;wt++)Le=this._buildBevelVert(ee,ge,(Pe+wt)%_e,wt/(He-1),Oe),k.push(ze.topN,Ne.topP,Le.topP),x===!1&&k.push(Ne.bottomP,ze.bottomN,Le.bottomP),ze=Le,wt>(We+1)*ie&&(We++,Ne=this._buildBevelVert(ee,pe,(Me+We)%ye,We/(Ve-1),Oe),k.push(De.topN,Ne.topP,ze.topN),x===!1&&k.push(Ne.bottomP,De.bottomN,ze.bottomN),De=Ne)}Me=(Me+Ve)%ye,Pe=(Pe+He)%_e,Ee=(Ee+1)%ve}while(Ee!==be)}if(x===!1&&this._depth>this._bevel*2&&this._buildWall(H,ee,k),G){let ne=[];for(let pe=k.length-1;pe>=me+2;pe-=3){let ge=k[pe-2],ye=k[pe-1],_e=k[pe-0];ne.push(_e,ye,ge)}k.splice(me,k.length-me,...ne)}if(G){let ne=[];for(let pe=H[H.length-1].boundary.vertices.length-1;pe>=1;pe-=2){let ge=H[H.length-1].boundary.vertices[pe-1],ye=H[H.length-1].boundary.vertices[pe-0];ne.push(ge,ye)}L.push(ne)}if(!G){let ne=H[H.length-1],pe;try{pe=Xs({windingRule:H.length>1?Wt.POSITIVE:Wt.ODD,elementType:Xr.POLYGONS,vertexSize:2,strict:!0,contours:[ne.insetPoints,...L]})}catch{pe=YA}if(!pe)throw new Error("Error generating geometry for surface");_.length===0&&this._bevel<C&&Object.assign(this,{useNgonForTopBottomFaceDuringBake:!0});for(let ge=0;ge<pe.elementCount*3;ge+=3){let ye=this._buildSurfaceVert(pe,pe.elements[ge+0],K),_e=this._buildSurfaceVert(pe,pe.elements[ge+1],K),ve=this._buildSurfaceVert(pe,pe.elements[ge+2],K);k.push(ye.top,_e.top,ve.top),x===!1&&k.push(ve.bottom,_e.bottom,ye.bottom)}}this.vertexCache={}}this._buffer.shrink();let R=new Ge(Uint32Array.from(k),1),F=new Ge(this._buffer.positions,3),B=new Ge(this._buffer.normals,3),N=new Ge(this._buffer.uvs,2);F.needsUpdate=!0,B.needsUpdate=!0,N.needsUpdate=!0,R.needsUpdate=!0,this.setAttribute("position",F),this.setAttribute("normal",B),this.setAttribute("uv",N),this.setIndex(R)}_computeBufferEstimatedSize(r){return r.vertexCount*2*(2+this._bevelSegments)}_buildWall(r,a,n){let o=r[0];for(let f=0,y=o.boundary.vertexCount;f<y;f++){let x=this._buildBevelVert(a,o,f),b=this._buildBevelVert(a,o,(f+1)%y);n.push(b.topP,x.topN,x.bottomN),n.push(b.topP,x.bottomN,b.bottomP)}}_buildSurfaceVert(r,a,n){let o=a.toString();if(o in this.vertexCache)return this.vertexCache[o];let f=r.vertices[a*2+0],y=r.vertices[a*2+1],x=(f-this._minX)/this._width,b=(y-this._minY)/this._height;this.forPathBevel&&(b=1);let _=this._buffer.get(this.forPathBevel?1:2),S=_*3,A=_*2,C={top:_+0,bottom:_+1};return this._buffer.positions[S+0]=f,this._buffer.positions[S+1]=y,this._buffer.positions[S+2]=this.forPathBevel?this._bevel:this._depth-n,this._buffer.normals[S+0]=0,this._buffer.normals[S+1]=0,this._buffer.normals[S+2]=1,this._buffer.uvs[A+0]=x,this._buffer.uvs[A+1]=b,this.forPathBevel===!1&&(this._buffer.positions[S+3]=f,this._buffer.positions[S+4]=y,this._buffer.positions[S+5]=n,this._buffer.normals[S+3]=0,this._buffer.normals[S+4]=0,this._buffer.normals[S+5]=-1,this._buffer.uvs[A+2]=x,this._buffer.uvs[A+3]=b),this.vertexCache[o]=C,C}_buildBevelVert(r,a,n,o=1,f){let y=`${a.bevelI}:${n}`;if(y in this.vertexCache&&f!==0&&f!==1&&(!f||f===this.vertexCache[y].pathBevelUCoord))return this.vertexCache[y];let[x,b]=a.boundary.vertexIndices[n],_,S,A,C;x!==b?(S=x,_=b,C=!1,A=r.continuous[S]&&r.continuous[_]):(_=x,S=(_-1+r.count)%r.count,C=r.concave[_]&&a.bevelI>0,A=r.continuous[_]||C);let P=Math.cos(a.angle),T=Math.sin(a.angle),M=n*2,O=_*2,I=S*2,D=a.boundary.vertices[M+0],z=a.boundary.vertices[M+1],k=(1-T)*this._bevel,L=(D-this._minX)/this._width,R=(z-this._minY)/this._height;this.forPathBevel&&(f!==void 0&&(L=f),R=1);let F=r.normals[O+0],B=r.normals[O+1],N=r.normals[I+0],j=r.normals[I+1];if(C){let te=N-F,ee=j-B;F=F+te*(1-o),B=B+ee*(1-o);let q=Math.sqrt(F*F+B*B);F/=q,B/=q}let G=this.forPathBevel?this._buffer.get(A?1:2):this._buffer.get(A?2:4),Y=G*3,X=G*2,$={i:n,fi:_,topP:G+0,topN:G+0,bottomP:G+1,bottomN:G+1,pathBevelUCoord:f};return this._buffer.positions[Y+0]=D,this._buffer.positions[Y+1]=z,this._buffer.positions[Y+2]=(this.forPathBevel?this._bevel:this._depth)-k,this._buffer.normals[Y+0]=F*P,this._buffer.normals[Y+1]=B*P,this._buffer.normals[Y+2]=T,this._buffer.uvs[X+0]=L,this._buffer.uvs[X+1]=R,this.forPathBevel===!1&&(this._buffer.positions[Y+3]=D,this._buffer.positions[Y+4]=z,this._buffer.positions[Y+5]=k,this._buffer.normals[Y+3]=F*P,this._buffer.normals[Y+4]=B*P,this._buffer.normals[Y+5]=-T,this._buffer.uvs[X+2]=R,this._buffer.uvs[X+3]=L),A||(this.forPathBevel?(G+=1,Y+=3,X+=2):(G+=2,Y+=6,X+=4),$.topP=G+0,$.bottomP=G+1,this._buffer.positions[Y+0]=D,this._buffer.positions[Y+1]=z,this._buffer.positions[Y+2]=(this.forPathBevel?this._bevel:this._depth)-k,this._buffer.normals[Y+0]=N*P,this._buffer.normals[Y+1]=j*P,this._buffer.normals[Y+2]=T,this._buffer.uvs[X+0]=L,this._buffer.uvs[X+1]=R,this.forPathBevel===!1&&(this._buffer.positions[Y+3]=D,this._buffer.positions[Y+4]=z,this._buffer.positions[Y+5]=k,this._buffer.normals[Y+3]=N*P,this._buffer.normals[Y+4]=j*P,this._buffer.normals[Y+5]=-T,this._buffer.uvs[X+2]=R,this._buffer.uvs[X+3]=L)),this.vertexCache[y]=$,$}clone(){let r=new kl(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return r.userData=xa(this.userData),r}},Pd=class extends Ce{constructor(r,a=12,n={}){super(),this.type="ShapeGeometry",this.windingRule=Wt.ODD,this.elementType=Xr.POLYGONS,this.polySize=3,this.vertexSize=2,this.strict=!0,this._shape=r,this._curveSegments=a,this._triangulationOptions=Object.assign({windingRule:Wt.ODD,elementType:Xr.POLYGONS,polySize:3,vertexSize:2,strict:!0},n);let o=this._shape.extractShapePointsToFlatArray([],this._curveSegments),f=this._shape.shapeHoles.map(P=>P.extractShapePointsToFlatArray([],this._curveSegments)),y,x=!0,b=!0,_,S;for(let P=0,T=o.length/2;P<T;P++){let M=P*2,O=o[M+0],I=o[M+1];if(_!==void 0&&O!==_&&(x=!1),S!==void 0&&I!==S&&(b=!1),_=O,S=I,!x&&!b)break}if(!x&&!b)try{y=Xs({contours:[o,...f],windingRule:this._triangulationOptions.windingRule,elementType:this._triangulationOptions.elementType,polySize:this._triangulationOptions.polySize,vertexSize:this._triangulationOptions.vertexSize,strict:this._triangulationOptions.strict})}catch{y=Sm}let A=(y==null?void 0:y.vertexCount)??1,C=(y==null?void 0:y.elementCount)??1;if(this._positionAttribute=new Ge(new Float32Array(A*3),3),this._normalAttribute=new Ge(new Float32Array(A*3),3),this._uvAttribute=new Ge(new Float32Array(A*2),2),this._indexAttribute=new Ge(new Uint32Array(C*3),1),y){let P=1/0,T=-1/0,M=1/0,O=-1/0;for(let z=0,k=A;z<k;z++){let L=z*2,R=y.vertices[L+0],F=y.vertices[L+1];R<P&&(P=R),R>T&&(T=R),F<M&&(M=F),F>O&&(O=F)}let I=T-P,D=O-M;for(let z=0,k=A;z<k;z++){let L=z*2,R=y.vertices[L+0],F=y.vertices[L+1],B=(R-P)/I,N=(F-M)/D;this._positionAttribute.setXYZ(z,R,F,0),this._normalAttribute.setXYZ(z,0,0,1),this._uvAttribute.setXY(z,B,N)}for(let z=0,k=C;z<k;z++){let L=z*3,R=y.elements[L+0],F=y.elements[L+1],B=y.elements[L+2];this._indexAttribute.setX(L+0,R),this._indexAttribute.setX(L+1,F),this._indexAttribute.setX(L+2,B)}}this.setAttribute("position",this._positionAttribute),this.setAttribute("normal",this._normalAttribute),this.setAttribute("uv",this._uvAttribute),this.setIndex(this._indexAttribute),this.setDrawRange(0,((y==null?void 0:y.elementCount)??1)*3)}clone(){let r=new Pd(this._shape,this._curveSegments);return r.userData=xa(this.userData),r}},_d=class extends kl{constructor(r,a,n=0,o=12,f=3,y=Wt.ODD){super(r,a,n,o,f,y),this.type="ShapeGeometry"}_computeBufferEstimatedSize(r){return r.vertexCount*2*(2+this._bevelSegments)}_buildWall(r,a,n){let o=r[0];for(let f=0,y=o.boundary.vertexCount;f<y;f++){let x=this._buildBevelVert(a,o,f),b=this._buildBevelVert(a,o,(f+1)%y);n.push(b.topP,x.topN,x.bottomN),n.push(b.topP,x.bottomN,b.bottomP)}}clone(){let r=new _d(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return r.userData=xa(this.userData),r}},Bn=class{static create(r){return this.build(this.normalizeInputs(r))}static normalizeInputs(r,a){var S,A;let n=Object.assign({},(a==null?void 0:a.parameters)??{width:100,subdivisions:40,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3,windingRule:Wt.ODD},r.parameters),o=Math.abs(n.width),f=Math.abs(n.height??n.width),y=Math.abs(n.depth??0),x=r.shape??(a==null?void 0:a.shape),b=(x==null?void 0:x.roundness)??n.roundness;x!==void 0&&(x instanceof Qt?(x.width!==o||x.height!==f)&&x.applySize(o,f):x=new Qt(o,f).fromJSON(x),((S=r.parameters)==null?void 0:S.roundness)!==void 0&&((A=r.parameters)==null?void 0:A.roundness)>0&&x.update());let _=x??new Qt(o,f);return{parameters:Object.assign(n,{width:o,height:f,depth:y,roundness:b}),shape:_}}static build(r){let{depth:a,extrudeBevelSize:n,extrudeBevelSegments:o,subdivisions:f,roundness:y,windingRule:x}=r.parameters;r.shape.roundness=y;let b;return a<=0?b=new Pd(r.shape,f,{windingRule:x}):b=new _d(r.shape,a,n,f,o,x),Object.assign(b,{userData:{...r,type:"VectorGeometry"}})}},HO=Math.PI*2,Dd=class{static create(r){return this.build(this.normalizeInputs(r))}static normalizeInputs(r,a){let n=Object.assign({},(a==null?void 0:a.parameters)??{width:100,depth:0,spikes:64,angle:360,innerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1},r.parameters);return n.angle=we.clamp(n.angle,0,360),{shape:r.shape&&r.shape instanceof Qt?r.shape:new Qt,parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??0)})}}static build(r){let{width:a,height:n,spikes:o,angle:f,innerRadius:y,depth:x,extrudeBevelSize:b,extrudeBevelSegments:_}=r.parameters,S=r.shape,A=a*.5,C=n*.5,P=cX(S,A,C,f*Math.PI/180,o,y);S.isClosed=!0,S.update();let T;return f===0?(T=new Ce,T.setAttribute("position",new Te([],3))):T=Bn.create({shape:S,parameters:{subdivisions:P,depth:x,extrudeBevelSize:b,extrudeBevelSegments:_}}),Object.assign(T,{userData:{...r,type:"EllipseGeometry"}})}};function cX(r,a,n,o,f,y){if(o>=HO)return f>30||f%4===0?(hX(r,a,n,y),Math.round(f/4)):jO(r,o,f,a,n,y);o=Math.max(o,.001);let x={x:0,y:n},b=o+Math.PI*.5,_={x:Math.cos(b)*a,y:Math.sin(b)*n},S=VO({px:x.x,py:x.y,cx:_.x,cy:_.y,rx:a,ry:n,largeArcFlag:o>Math.PI,sweepFlag:!0});return f>30||f%S.length===0?uX(r,x.x,x.y,S,f,a,n,y):jO(r,o,f,a,n,y)}function uX(r,a,n,o,f,y,x,b){let _=Math.round(f/o.length);r.addPoint(Id(a,n));for(let S=0,A=o.length;S<A;S++){let C=o[S],P=r.points[S],T=Id(C.x,C.y);P.controls[1].position.set(C.x1,C.y1),T.controls[0].position.set(C.x2,C.y2),r.addPoint(T)}return b>0?WO(r,y,x,b):r.addPoint(Id(0,0)),_}function jO(r,a,n,o,f,y){let x=-a/n;for(let b=0;b<=n;b++){let _=x*b,S=Math.sin(_)*o,A=Math.cos(_)*f;r.addPoint(Id(S,A))}return a<HO?y>0?WO(r,o,f,y):r.addPoint(Id(0,0)):(r.removePoint(r.points[r.points.length-1]),y>0&&qO(r,o,f,y)),1}function hX(r,a,n,o=0,f=0,y=0){let x=.5522847498,b=a*x,_=n*x;r.addPoint(k0(f-a,y,f-a,y-_,f-a,y+_)),r.addPoint(k0(f,y+n,f-b,y+n,f+b,y+n)),r.addPoint(k0(f+a,y,f+a,y+_,f+a,y-_)),r.addPoint(k0(f,y-n,f+b,y-n,f-b,y-n)),o>0&&qO(r,a,n,o)}function Id(r,a){return new qs(we.generateUUID(),new V(r,a))}function k0(r,a,n,o,f,y){let x=Id(r,a);return x.controls[0].position.set(n,o),x.controls[1].position.set(f,y),x}function WO(r,a,n,o){XO(r,a,n,o).forEach(f=>r.addPoint(f))}function qO(r,a,n,o){let f=XO(r,a,n,o),y=new Qt;f.forEach(x=>y.addPoint(x)),y.isClosed=!0,r.shapeHoles.push(y)}function XO(r,a,n,o){let f=o*a/100,y=f*(Math.abs(n)/Math.abs(a)),x=new V(f/a,y/n),b=r.points.map(_=>{let S=_.clone();return S.uuid=we.generateUUID(),S}).reverse();return b.forEach(_=>{_.position.multiply(x);let S=_.controls[0].position.clone().multiply(x),A=_.controls[1].position.clone().multiply(x);_.controls[0].position.copy(A),_.controls[1].position.copy(S)}),b}var YO=class{static create(r){return this.build(this.normalizeInputs(r))}static normalizeInputs(r,a){let n=Object.assign({},(a==null?void 0:a.parameters)??{width:100,revolutions:2,segments:40,pathRadius:10,pathType:0,pathSegments:30,cornerRadius:30,cornerSegments:4},r.parameters),o=Math.abs(n.width),f=Math.abs(n.height??o),y=Math.abs(n.depth??o),x=Math.abs(Math.min(o,y))/2;return{parameters:Object.assign(n,{width:o,height:f,depth:y,radius:x,segments:Math.round(n.segments),pathSegments:Math.round(n.pathSegments),cornerSegments:Math.round(n.cornerSegments)})}}static build(r){let{width:a,height:n,depth:o,radius:f,revolutions:y,segments:x,pathRadius:b,pathType:_,pathSegments:S,cornerRadius:A,cornerSegments:C}=r.parameters,P=new wm(!1,a,n,o,f,y,x,b,_,S,A,C);return Object.assign(P,{userData:{...r,type:"HelixGeometry"}})}},KA=new mo([0,0,0],1),wm=class extends Ce{constructor(r=!0,a=1,n=1,o=1,f=1,y=1,x=1,b=1,_=1,S=1,A=1,C=1){if(super(),y===0)return;let P=r&&y===1;P&&(C=0),A>100&&(A=100),A===0&&(C=0);let T=()=>new E,M=new E,O=T(),I=T(),D=T(),z,k,L,R,F,B,N,j,G=T(),Y=T(),X=T(),$=T(),te=T(),ee=T(),q=T(),Z=T(),U=n-2*b+.001,W=U/y,H=Math.ceil(x*y),K=H+1,le=U/H,me=-U/2,ne=S+1,pe=2*Math.PI/S,ge=Math.PI/2/C,ye=.01,_e=Math.min((1-A/100)*b,b-ye),ve=b-_e,Ee=0,xe=2,Me=C*xe+xe,Pe=ne*Me/xe,be=Pe+ne*K,Oe=Math.max(0,ne*(K+Me)),[Be,oe,De]=[3,3,2].map(Ot=>Array(Oe*Ot).fill(0)),ze=[],Ne=f-b;function Le(Ot,ui){let nt=Math.PI/2;B=ui*le,j=2*Math.PI*(B%W)/W+nt,B+=me,N=Math.sin(j)*Ne,F=Math.cos(j)*Ne,r?Ot.set(F,N,B):Ot.set(F,B,N)}Le(M,-1e-10),Le(O,0),G.copy(M),Le(M,1);let bt=M.distanceTo(O),Ve=P?0:ve+_e,He=bt*H+2*Ve,tt=_e,ie=He-Ve;for(let Ot=0;Ot<=H;Ot++){Le(I,Ot),Z.subVectors(I,G).normalize(),G.copy(I),ee.copy(I).setComponent(+r+1,0).normalize(),q.crossVectors(Z,ee).normalize();let ui=Ot===0,nt=Ot===H,Rs=ui?3*Math.PI/2:ge,er=ui?tt:ie,is=ui?ne:be,zt=ui?0:Oe-ne,zr=Z.clone().multiplyScalar(ui?-ve:ve).add(I),Lr=Z.clone().multiplyScalar(ui?-1:1).normalize();for(let st=0;st<ne;st++){let Cr=st*pe;if(Y.addVectors(M.copy(ee).multiplyScalar(b*Math.cos(Cr)),O.copy(q).multiplyScalar(b*Math.sin(Cr))),X.copy(Y).normalize(),ui||nt){P||(Ee=zt+st,[0,1,2].forEach(Rt=>{Be[Ee*3+Rt]=zr.getComponent(Rt),oe[Ee*3+Rt]=Lr.getComponent(Rt)}),De[Ee*2]=+nt,De[Ee*2+1]=st/S),O.copy(X).multiplyScalar(_e),D.addVectors(I,O);for(let Rt=0;Rt<C;Rt++){let Ei=Rt*ge+Rs;$.addVectors(M.copy(Z).multiplyScalar(ve*Math.sin(Ei)),O.copy(X).multiplyScalar(ve*Math.cos(Ei))),te.copy($).normalize(),O.addVectors(D,$),$.normalize(),Ee=is+Rt*ne+st,[0,1,2].forEach(Pr=>{Be[Ee*3+Pr]=O.getComponent(Pr),oe[Ee*3+Pr]=te.getComponent(Pr)});let Bi=+ui+Math.sin(Ei);De[Ee*2]=(er+ve*Bi)/He,De[Ee*2+1]=st/S}}O.addVectors(I,Y),Ee=Pe+Ot*ne+st,[0,1,2].forEach(Rt=>{Be[Ee*3+Rt]=O.getComponent(Rt),oe[Ee*3+Rt]=X.getComponent(Rt)}),De[Ee*2]=(Ve+Ot*bt)/He,De[Ee*2+1]=st/S}}let We=K+2*C+xe,[wt,Nt]=[+P,We-1];for(let Ot=wt;Ot<=Nt-1;Ot++){let ui=P&&Ot===Nt-1;for(let nt=0;nt<ne-1;nt++)z=Ot*ne+nt,k=z+1,L=(ui?nt:z)+ne,R=(ui?nt+1:k)+ne,Ot===0?ze.push(k,R,L):Ot===We-2?ze.push(z,k,L):ze.push(z,k,L,k,R,L)}this.setIndex(ze),this.setAttribute("position",new Te(Be,3)),this.setAttribute("normal",new Te(oe,3)),this.setAttribute("uv",new Te(De,2))}getClosedTorusIndicesForBooleanOrSubdiv(){let r=this.userData.parameters,a=Math.ceil(r.tubularSegments),n=r.radialSegments+1,o=Array.from(this.getIndex().array),f,y,x,b,_=6*(a-1)*r.radialSegments,S=a,A=S===a;for(let C=0;C<r.radialSegments;C++)f=S*n+C,y=f+1,x=(A?C:f)+n,b=(A?C+1:y)+n,o[_++]=f,o[_++]=y,o[_++]=x,o[_++]=y,o[_++]=b,o[_++]=x;return o.length=_,KA.array=o,KA.count=o.length,KA}},KO=class{static create(r){return this.build(this.normalizeInputs(r))}static normalizeInputs(r,a){let n=Object.assign({},(a==null?void 0:a.parameters)??{width:100,detail:0,corner:0,cornerSides:4},r.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(r){let{width:a,height:n,depth:o,detail:f,corner:y,cornerSides:x}=r.parameters,b=f===0&&y!==0?new Am(a*.5,y,x):new Qu(a*.5,f);return b.scale(1,n/a,o/a),Object.assign(b,{userData:{...r,type:"IcosahedronGeometry"}})}},Am=class extends Ul{constructor(r=1,a=.2,n=4){let o=(1+Math.sqrt(5))/2,f=[-1,o,0,1,o,0,-1,-o,0,1,-o,0,0,-1,o,0,1,o,0,-1,-o,0,1,-o,o,0,-1,o,0,1,-o,0,-1,-o,0,1],y=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],x="IcosahedronGeometry";super(f,y,x,r,a,n),this.type=x}static fromJSON(r){return new Am(r.radius,r.corner,r.cornerSides)}},QO=class{static create(r){return this.build(this.normalizeInputs(r))}static normalizeInputs(r,a){var o;(((o=r.parameters)==null?void 0:o.points)??[]).forEach(f=>{Array.isArray(f)&&(f.x=f[0],f.y=f[1])});let n=Object.assign({},(a==null?void 0:a.parameters)??{width:100,segments:64,verticalSegments:64,points:[{x:0,y:-50,id:0},{x:50,y:-50,id:1},{x:50,y:50,id:2},{x:0,y:50,id:3}]},r.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(r){let{points:a,segments:n,verticalSegments:o}=r.parameters,f=new fa;f.moveTo(a[0].x,a[0].y),f.bezierCurveTo(a[1].x,a[1].y,a[2].x,a[2].y,a[3].x,a[3].y);let y=new qu(f.extractPoints(o).shape,n);return y.rotateZ(Math.PI),Object.assign(y,{userData:{...r,type:"LatheGeometry"}})}},No=new ue,QA=new _t,G0=new E,Gl=class extends gr{constructor(){super(),this.uuid=we.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}applyMatrix4(r){let a=new mr().getNormalMatrix(r);for(let n=0,o=this.vertices.length;n<o;n++)this.vertices[n].applyMatrix4(r);for(let n=0,o=this.faces.length;n<o;n++){let f=this.faces[n];f.normal.applyMatrix3(a).normalize();for(let y=0,x=f.vertexNormals.length;y<x;y++)f.vertexNormals[y].applyMatrix3(a).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this}rotateX(r){return No.makeRotationX(r),this.applyMatrix4(No),this}rotateY(r){return No.makeRotationY(r),this.applyMatrix4(No),this}rotateZ(r){return No.makeRotationZ(r),this.applyMatrix4(No),this}translate(r,a,n){return No.makeTranslation(r,a,n),this.applyMatrix4(No),this}scale(r,a,n){return No.makeScale(r,a,n),this.applyMatrix4(No),this}lookAt(r){return QA.lookAt(r),QA.updateMatrix(),this.applyMatrix4(QA.matrix),this}fromBufferGeometry(r){let a=this,n=r.index!==null?r.index:void 0,o=r.attributes;if(o.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;let f=o.position,y=o.normal,x=o.color,b=o.uv,_=o.uv2;_!==void 0&&(this.faceVertexUvs[1]=[]);for(let C=0;C<f.count;C++)a.vertices.push(new E().fromBufferAttribute(f,C)),x!==void 0&&a.colors.push(new qe().fromBufferAttribute(x,C));function S(C,P,T,M){let O=x===void 0?[]:[a.colors[C].clone(),a.colors[P].clone(),a.colors[T].clone()],I=y===void 0?[]:[new E().fromBufferAttribute(y,C),new E().fromBufferAttribute(y,P),new E().fromBufferAttribute(y,T)],D=new Od(C,P,T,I,O,M);a.faces.push(D),b!==void 0&&a.faceVertexUvs[0].push([new V().fromBufferAttribute(b,C),new V().fromBufferAttribute(b,P),new V().fromBufferAttribute(b,T)]),_!==void 0&&a.faceVertexUvs[1].push([new V().fromBufferAttribute(_,C),new V().fromBufferAttribute(_,P),new V().fromBufferAttribute(_,T)])}let A=r.groups;if(A.length>0)for(let C=0;C<A.length;C++){let P=A[C],T=P.start,M=P.count;for(let O=T,I=T+M;O<I;O+=3)n!==void 0?S(n.getX(O),n.getX(O+1),n.getX(O+2),P.materialIndex):S(O,O+1,O+2,P.materialIndex)}else if(n!==void 0)for(let C=0;C<n.count;C+=3)S(n.getX(C),n.getX(C+1),n.getX(C+2));else for(let C=0;C<f.count;C+=3)S(C,C+1,C+2);return this.computeFaceNormals(),r.boundingBox!==null&&(this.boundingBox=r.boundingBox.clone()),r.boundingSphere!==null&&(this.boundingSphere=r.boundingSphere.clone()),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(G0).negate(),this.translate(G0.x,G0.y,G0.z),this}normalize(){this.computeBoundingSphere();let r=this.boundingSphere.center,a=this.boundingSphere.radius,n=a===0?1:1/a,o=new ue;return o.set(n,0,0,-n*r.x,0,n,0,-n*r.y,0,0,n,-n*r.z,0,0,0,1),this.applyMatrix4(o),this}computeFaceNormals(){let r=new E,a=new E;for(let n=0,o=this.faces.length;n<o;n++){let f=this.faces[n],y=this.vertices[f.a],x=this.vertices[f.b],b=this.vertices[f.c];r.subVectors(b,x),a.subVectors(y,x),r.cross(a),r.normalize(),f.normal.copy(r)}}computeVertexNormals(r=!0){let a=new Array(this.vertices.length);for(let n=0,o=this.vertices.length;n<o;n++)a[n]=new E;if(r){let n=new E,o=new E;for(let f=0,y=this.faces.length;f<y;f++){let x=this.faces[f],b=this.vertices[x.a],_=this.vertices[x.b],S=this.vertices[x.c];n.subVectors(S,_),o.subVectors(b,_),n.cross(o),a[x.a].add(n),a[x.b].add(n),a[x.c].add(n)}}else{this.computeFaceNormals();for(let n=0,o=this.faces.length;n<o;n++){let f=this.faces[n];a[f.a].add(f.normal),a[f.b].add(f.normal),a[f.c].add(f.normal)}}for(let n=0,o=this.vertices.length;n<o;n++)a[n].normalize();for(let n=0,o=this.faces.length;n<o;n++){let f=this.faces[n],y=f.vertexNormals;y.length===3?(y[0].copy(a[f.a]),y[1].copy(a[f.b]),y[2].copy(a[f.c])):(y[0]=a[f.a].clone(),y[1]=a[f.b].clone(),y[2]=a[f.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeFlatVertexNormals(){this.computeFaceNormals();for(let r=0,a=this.faces.length;r<a;r++){let n=this.faces[r],o=n.vertexNormals;o.length===3?(o[0].copy(n.normal),o[1].copy(n.normal),o[2].copy(n.normal)):(o[0]=n.normal.clone(),o[1]=n.normal.clone(),o[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeMorphNormals(){for(let a=0,n=this.faces.length;a<n;a++){let o=this.faces[a];o.__originalFaceNormal?o.__originalFaceNormal.copy(o.normal):o.__originalFaceNormal=o.normal.clone(),o.__originalVertexNormals||(o.__originalVertexNormals=[]);for(let f=0,y=o.vertexNormals.length;f<y;f++)o.__originalVertexNormals[f]?o.__originalVertexNormals[f].copy(o.vertexNormals[f]):o.__originalVertexNormals[f]=o.vertexNormals[f].clone()}let r=new Gl;r.faces=this.faces;for(let a=0,n=this.morphTargets.length;a<n;a++){if(!this.morphNormals[a]){this.morphNormals[a]={},this.morphNormals[a].faceNormals=[],this.morphNormals[a].vertexNormals=[];let f=this.morphNormals[a].faceNormals,y=this.morphNormals[a].vertexNormals;for(let x=0,b=this.faces.length;x<b;x++){let _=new E,S={a:new E,b:new E,c:new E};f.push(_),y.push(S)}}let o=this.morphNormals[a];r.vertices=this.morphTargets[a].vertices,r.computeFaceNormals(),r.computeVertexNormals();for(let f=0,y=this.faces.length;f<y;f++){let x=this.faces[f],b=o.faceNormals[f],_=o.vertexNormals[f];b.copy(x.normal),_.a.copy(x.vertexNormals[0]),_.b.copy(x.vertexNormals[1]),_.c.copy(x.vertexNormals[2])}}for(let a=0,n=this.faces.length;a<n;a++){let o=this.faces[a];o.normal=o.__originalFaceNormal,o.vertexNormals=o.__originalVertexNormals}}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Xt),this.boundingBox.setFromPoints(this.vertices)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Nr),this.boundingSphere.setFromPoints(this.vertices)}merge(r,a,n=0){if(!(r&&r.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",r);return}let o,f=this.vertices.length,y=this.vertices,x=r.vertices,b=this.faces,_=r.faces,S=this.colors,A=r.colors;a!==void 0&&(o=new mr().getNormalMatrix(a));for(let C=0,P=x.length;C<P;C++){let T=x[C].clone();a!==void 0&&T.applyMatrix4(a),y.push(T)}for(let C=0,P=A.length;C<P;C++)S.push(A[C].clone());for(let C=0,P=_.length;C<P;C++){let T=_[C],M,O,I=T.vertexNormals,D=T.vertexColors,z=new Od(T.a+f,T.b+f,T.c+f);z.normal.copy(T.normal),o!==void 0&&z.normal.applyMatrix3(o).normalize();for(let k=0,L=I.length;k<L;k++)M=I[k].clone(),o!==void 0&&M.applyMatrix3(o).normalize(),z.vertexNormals.push(M);z.color.copy(T.color);for(let k=0,L=D.length;k<L;k++)O=D[k],z.vertexColors.push(O.clone());z.materialIndex=T.materialIndex+n,b.push(z)}for(let C=0,P=r.faceVertexUvs.length;C<P;C++){let T=r.faceVertexUvs[C];this.faceVertexUvs[C]===void 0&&(this.faceVertexUvs[C]=[]);for(let M=0,O=T.length;M<O;M++){let I=T[M],D=[];for(let z=0,k=I.length;z<k;z++)D.push(I[z].clone());this.faceVertexUvs[C].push(D)}}}mergeMesh(r){if(!(r&&r.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",r);return}r.matrixAutoUpdate&&r.updateMatrix(),this.merge(r.geometry,r.matrix)}mergeVertices(r=4){let a={},n=[],o=[],f=Math.pow(10,r);for(let b=0,_=this.vertices.length;b<_;b++){let S=this.vertices[b],A=Math.round(S.x*f)+"_"+Math.round(S.y*f)+"_"+Math.round(S.z*f);a[A]===void 0?(a[A]=b,n.push(this.vertices[b]),o[b]=n.length-1):o[b]=o[a[A]]}let y=[];for(let b=0,_=this.faces.length;b<_;b++){let S=this.faces[b];S.a=o[S.a],S.b=o[S.b],S.c=o[S.c];let A=[S.a,S.b,S.c];for(let C=0;C<3;C++)if(A[C]===A[(C+1)%3]){y.push(b);break}}for(let b=y.length-1;b>=0;b--){let _=y[b];this.faces.splice(_,1);for(let S=0,A=this.faceVertexUvs.length;S<A;S++)this.faceVertexUvs[S].splice(_,1)}let x=this.vertices.length-n.length;return this.vertices=n,x}setFromPoints(r){this.vertices=[];for(let a=0,n=r.length;a<n;a++){let o=r[a];this.vertices.push(new E(o.x,o.y,o.z||0))}return this}sortFacesByMaterialIndex(){let r=this.faces,a=r.length;for(let b=0;b<a;b++)r[b]._id=b;function n(b,_){return b.materialIndex-_.materialIndex}r.sort(n);let o=this.faceVertexUvs[0],f=this.faceVertexUvs[1],y,x;o&&o.length===a&&(y=[]),f&&f.length===a&&(x=[]);for(let b=0;b<a;b++){let _=r[b]._id;y&&y.push(o[_]),x&&x.push(f[_])}y&&(this.faceVertexUvs[0]=y),x&&(this.faceVertexUvs[1]=x)}toJSON(){let r={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.parameters!==void 0){let T=this.parameters;for(let M in T)T[M]!==void 0&&(r[M]=T[M]);return r}let a=[];for(let T=0;T<this.vertices.length;T++){let M=this.vertices[T];a.push(M.x,M.y,M.z)}let n=[],o=[],f={},y=[],x={},b=[],_={};for(let T=0;T<this.faces.length;T++){let M=this.faces[T],O=!0,I=!1,D=this.faceVertexUvs[0][T]!==void 0,z=M.normal.length()>0,k=M.vertexNormals.length>0,L=M.color.r!==1||M.color.g!==1||M.color.b!==1,R=M.vertexColors.length>0,F=0;if(F=S(F,0,0),F=S(F,1,O),F=S(F,2,I),F=S(F,3,D),F=S(F,4,z),F=S(F,5,k),F=S(F,6,L),F=S(F,7,R),n.push(F),n.push(M.a,M.b,M.c),n.push(M.materialIndex),D){let B=this.faceVertexUvs[0][T];n.push(P(B[0]),P(B[1]),P(B[2]))}if(z&&n.push(A(M.normal)),k){let B=M.vertexNormals;n.push(A(B[0]),A(B[1]),A(B[2]))}if(L&&n.push(C(M.color)),R){let B=M.vertexColors;n.push(C(B[0]),C(B[1]),C(B[2]))}}function S(T,M,O){return O?T|1<<M:T&~(1<<M)}function A(T){let M=T.x.toString()+T.y.toString()+T.z.toString();return f[M]!==void 0||(f[M]=o.length/3,o.push(T.x,T.y,T.z)),f[M]}function C(T){let M=T.r.toString()+T.g.toString()+T.b.toString();return x[M]!==void 0||(x[M]=y.length,y.push(T.getHex())),x[M]}function P(T){let M=T.x.toString()+T.y.toString();return _[M]!==void 0||(_[M]=b.length/2,b.push(T.x,T.y)),_[M]}return r.data={},r.data.vertices=a,r.data.normals=o,y.length>0&&(r.data.colors=y),b.length>0&&(r.data.uvs=[b]),r.data.faces=n,r}clone(){return new Gl().copy(this)}copy(r){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=r.name;let a=r.vertices;for(let C=0,P=a.length;C<P;C++)this.vertices.push(a[C].clone());let n=r.colors;for(let C=0,P=n.length;C<P;C++)this.colors.push(n[C].clone());let o=r.faces;for(let C=0,P=o.length;C<P;C++)this.faces.push(o[C].clone());for(let C=0,P=r.faceVertexUvs.length;C<P;C++){let T=r.faceVertexUvs[C];this.faceVertexUvs[C]===void 0&&(this.faceVertexUvs[C]=[]);for(let M=0,O=T.length;M<O;M++){let I=T[M],D=[];for(let z=0,k=I.length;z<k;z++){let L=I[z];D.push(L.clone())}this.faceVertexUvs[C].push(D)}}let f=r.morphTargets;for(let C=0,P=f.length;C<P;C++){let T={};if(T.name=f[C].name,f[C].vertices!==void 0){T.vertices=[];for(let M=0,O=f[C].vertices.length;M<O;M++)T.vertices.push(f[C].vertices[M].clone())}if(f[C].normals!==void 0){T.normals=[];for(let M=0,O=f[C].normals.length;M<O;M++)T.normals.push(f[C].normals[M].clone())}this.morphTargets.push(T)}let y=r.morphNormals;for(let C=0,P=y.length;C<P;C++){let T={};if(y[C].vertexNormals!==void 0){T.vertexNormals=[];for(let M=0,O=y[C].vertexNormals.length;M<O;M++){let I=y[C].vertexNormals[M],D={};D.a=I.a.clone(),D.b=I.b.clone(),D.c=I.c.clone(),T.vertexNormals.push(D)}}if(y[C].faceNormals!==void 0){T.faceNormals=[];for(let M=0,O=y[C].faceNormals.length;M<O;M++)T.faceNormals.push(y[C].faceNormals[M].clone())}this.morphNormals.push(T)}let x=r.skinWeights;for(let C=0,P=x.length;C<P;C++)this.skinWeights.push(x[C].clone());let b=r.skinIndices;for(let C=0,P=b.length;C<P;C++)this.skinIndices.push(b[C].clone());let _=r.lineDistances;for(let C=0,P=_.length;C<P;C++)this.lineDistances.push(_[C]);let S=r.boundingBox;S!==null&&(this.boundingBox=S.clone());let A=r.boundingSphere;return A!==null&&(this.boundingSphere=A.clone()),this.elementsNeedUpdate=r.elementsNeedUpdate,this.verticesNeedUpdate=r.verticesNeedUpdate,this.uvsNeedUpdate=r.uvsNeedUpdate,this.normalsNeedUpdate=r.normalsNeedUpdate,this.colorsNeedUpdate=r.colorsNeedUpdate,this.lineDistancesNeedUpdate=r.lineDistancesNeedUpdate,this.groupsNeedUpdate=r.groupsNeedUpdate,this}toBufferGeometry(){let r=new ZA().fromGeometry(this),a=new Ce,n=new Float32Array(r.vertices.length*3);if(a.setAttribute("position",j0.call(new Ge(n,3),r.vertices)),r.normals.length>0){let o=new Float32Array(r.normals.length*3);a.setAttribute("normal",j0.call(new Ge(o,3),r.normals))}if(r.colors.length>0){let o=new Float32Array(r.colors.length*3);a.setAttribute("color",ZO.call(new Ge(o,3),r.colors))}if(r.uvs.length>0){let o=new Float32Array(r.uvs.length*2);a.setAttribute("uv",JO.call(new Ge(o,2),r.uvs))}if(r.uvs2.length>0){let o=new Float32Array(r.uvs2.length*2);a.setAttribute("uv2",JO.call(new Ge(o,2),r.uvs2))}a.groups=r.groups;for(let o in r.morphTargets){let f=[],y=r.morphTargets[o];for(let x=0,b=y.length;x<b;x++){let _=y[x],S=new Te(_.data.length*3,3);S.name=_.name,f.push(j0.call(S,_.data))}a.morphAttributes[o]=f}if(r.skinIndices.length>0){let o=new Te(r.skinIndices.length*4,4);a.setAttribute("skinIndex",$O.call(o,r.skinIndices))}if(r.skinWeights.length>0){let o=new Te(r.skinWeights.length*4,4);a.setAttribute("skinWeight",$O.call(o,r.skinWeights))}return r.boundingSphere!==null&&(a.boundingSphere=r.boundingSphere.clone()),r.boundingBox!==null&&(a.boundingBox=r.boundingBox.clone()),a}computeTangents(){console.error("THREE.Geometry: .computeTangents() has been removed.")}computeLineDistances(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}applyMatrix(r){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(r)}dispose(){this.dispatchEvent({type:"dispose"})}static createBufferGeometryFromObject(r){let a=new Ce,n=r.geometry;if(r.isPoints||r.isLine){let o=new Te(n.vertices.length*3,3),f=new Te(n.colors.length*3,3);if(a.setAttribute("position",j0.call(o,n.vertices)),a.setAttribute("color",ZO.call(f,n.colors)),n.lineDistances&&n.lineDistances.length===n.vertices.length){let y=new Te(n.lineDistances.length,1);a.setAttribute("lineDistance",dX.call(y,n.lineDistances))}n.boundingSphere!==null&&(a.boundingSphere=n.boundingSphere.clone()),n.boundingBox!==null&&(a.boundingBox=n.boundingBox.clone())}else r.isMesh&&(a=n.toBufferGeometry());return a}};Gl.prototype.isGeometry=!0;var ZA=class{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(r){let a=[],n,o,f,y=r.faces;for(o=0;o<y.length;o++){let x=y[o];x.materialIndex!==f&&(f=x.materialIndex,n!==void 0&&(n.count=o*3-n.start,a.push(n)),n={start:o*3,materialIndex:f})}n!==void 0&&(n.count=o*3-n.start,a.push(n)),this.groups=a}fromGeometry(r){let a=r.faces,n=r.vertices,o=r.faceVertexUvs,f=o[0]&&o[0].length>0,y=o[1]&&o[1].length>0,x=r.morphTargets,b=x.length,_;if(b>0){_=[];for(let I=0;I<b;I++)_[I]={name:x[I].name,data:[]};this.morphTargets.position=_}let S=r.morphNormals,A=S.length,C;if(A>0){C=[];for(let I=0;I<A;I++)C[I]={name:S[I].name,data:[]};this.morphTargets.normal=C}let P=r.skinIndices,T=r.skinWeights,M=P.length===n.length,O=T.length===n.length;n.length>0&&a.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let I=0;I<a.length;I++){let D=a[I];this.vertices.push(n[D.a],n[D.b],n[D.c]);let z=D.vertexNormals;if(z.length===3)this.normals.push(z[0],z[1],z[2]);else{let L=D.normal;this.normals.push(L,L,L)}let k=D.vertexColors;if(k.length===3)this.colors.push(k[0],k[1],k[2]);else{let L=D.color;this.colors.push(L,L,L)}if(f===!0){let L=o[0][I];L!==void 0?this.uvs.push(L[0],L[1],L[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",I),this.uvs.push(new V,new V,new V))}if(y===!0){let L=o[1][I];L!==void 0?this.uvs2.push(L[0],L[1],L[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",I),this.uvs2.push(new V,new V,new V))}for(let L=0;L<b;L++){let R=x[L].vertices;_[L].data.push(R[D.a],R[D.b],R[D.c])}for(let L=0;L<A;L++){let R=S[L].vertexNormals[I];C[L].data.push(R.a,R.b,R.c)}M&&this.skinIndices.push(P[D.a],P[D.b],P[D.c]),O&&this.skinWeights.push(T[D.a],T[D.b],T[D.c])}return this.computeGroups(r),this.verticesNeedUpdate=r.verticesNeedUpdate,this.normalsNeedUpdate=r.normalsNeedUpdate,this.colorsNeedUpdate=r.colorsNeedUpdate,this.uvsNeedUpdate=r.uvsNeedUpdate,this.groupsNeedUpdate=r.groupsNeedUpdate,r.boundingSphere!==null&&(this.boundingSphere=r.boundingSphere.clone()),r.boundingBox!==null&&(this.boundingBox=r.boundingBox.clone()),this}},Od=class{constructor(r,a,n,o,f,y=0){this.a=r,this.b=a,this.c=n,this.normal=o&&o.isVector3?o:new E,this.vertexNormals=Array.isArray(o)?o:[],this.color=f&&f.isColor?f:new qe,this.vertexColors=Array.isArray(f)?f:[],this.materialIndex=y}clone(){return new this.constructor().copy(this)}copy(r){this.a=r.a,this.b=r.b,this.c=r.c,this.normal.copy(r.normal),this.color.copy(r.color),this.materialIndex=r.materialIndex;for(let a=0,n=r.vertexNormals.length;a<n;a++)this.vertexNormals[a]=r.vertexNormals[a].clone();for(let a=0,n=r.vertexColors.length;a<n;a++)this.vertexColors[a]=r.vertexColors[a].clone();return this}};function dX(r){return this.array.set(r),this}function ZO(r){let a=this.array,n=0;for(let o=0,f=r.length;o<f;o++){let y=r[o];y===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",o),y=new qe),a[n++]=y.r,a[n++]=y.g,a[n++]=y.b}return this}function JO(r){let a=this.array,n=0;for(let o=0,f=r.length;o<f;o++){let y=r[o];y===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",o),y=new V),a[n++]=y.x,a[n++]=y.y}return this}function j0(r){let a=this.array,n=0;for(let o=0,f=r.length;o<f;o++){let y=r[o];y===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",o),y=new E),a[n++]=y.x,a[n++]=y.y,a[n++]=y.z}return this}function $O(r){let a=this.array,n=0;for(let o=0,f=r.length;o<f;o++){let y=r[o];y===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",o),y=new Qe),a[n++]=y.x,a[n++]=y.y,a[n++]=y.z,a[n++]=y.w}return this}var fX=["a","b","c"];function pX(r,a){switch(a){case"c":return r.c;case"b":return r.b;case"a":default:return r.a}}function JA(r,a,n){let o=Math.min(r,a),f=Math.max(r,a),y=o+"_"+f;return n.get(y)}function $A(r,a,n,o,f,y){let x=Math.min(r,a),b=Math.max(r,a),_=x+"_"+b,S;if(o.has(_))S=o.get(_);else{let A=n[x],C=n[b];S={a:A,b:C,newEdge:null,faces:[]},o.set(_,S)}S.faces.push(f),y[r].edges.push(S),y[a].edges.push(S)}function mX(r,a,n,o){let f,y,x;for(f=0,y=r.length;f<y;f++)n[f]={edges:[]};for(f=0,y=a.length;f<y;f++)x=a[f],$A(x.a,x.b,r,o,x,n),$A(x.b,x.c,r,o,x,n),$A(x.c,x.a,r,o,x,n)}function H0(r,a,n,o,f){r.push(new Od(a,n,o,void 0,void 0,f))}function Rd(r,a){return Math.abs(a-r)/2+Math.min(r,a)}function W0(r,a,n,o){r.push([a.clone(),n.clone(),o.clone()])}var q0=class{constructor(r=1){this.subdivisions=r}modify(r){r instanceof Ce?r=new Gl().fromBufferGeometry(r):r=r.clone(),r.mergeVertices();let a=this.subdivisions;for(;a-- >0;)this._smooth(r);return r.computeFaceNormals(),r.computeVertexNormals(),r}_smooth(r){let a=new E,n,o,f,y,x,b=r.vertices,_=r.faces,S=r.faceVertexUvs[0],A=S!==void 0&&S.length>0,C=[],P=new Map;mX(b,_,C,P);let T=[],M,O,I,D,z,k,L;for(let ye of Array.from(P.keys())){for(O=P.get(ye),I=new E,z=3/8,k=1/8,L=O.faces.length,L!=2&&(z=.5,k=0,L!=1),I.addVectors(O.a,O.b).multiplyScalar(z),a.set(0,0,0),y=0;y<L;y++){for(D=O.faces[y],x=0;x<3&&(M=b[pX(D,fX[x])],!(M!==O.a&&M!==O.b));x++);M&&a.add(M)}a.multiplyScalar(k),I.add(a),O.newEdge=T.length,T.push(I)}let R,F,B,N,j,G,Y,X=[];for(o=0,f=b.length;o<f;o++){for(G=b[o],j=C[o].edges,n=j.length,n==3?R=3/16:n>3&&(R=3/(8*n)),F=1-n*Number(R),B=R,n<=2&&(n==2?(F=3/4,B=1/8):n==1||n==0),Y=G.clone().multiplyScalar(F),a.set(0,0,0),y=0;y<n;y++)N=j[y],M=N.a!==G?N.a:N.b,a.add(M);a.multiplyScalar(Number(B)),Y.add(a),X.push(Y)}let $=X.concat(T),te=X.length,ee,q,Z,U=[],W=[],H,K,le,me,ne=new V,pe=new V,ge=new V;for(o=0,f=_.length;o<f;o++)D=_[o],ee=Number(JA(D.a,D.b,P).newEdge)+te,q=Number(JA(D.b,D.c,P).newEdge)+te,Z=Number(JA(D.c,D.a,P).newEdge)+te,H0(U,ee,q,Z,D.materialIndex),H0(U,D.a,ee,Z,D.materialIndex),H0(U,D.b,q,ee,D.materialIndex),H0(U,D.c,Z,q,D.materialIndex),A&&(H=S[o],K=H[0],le=H[1],me=H[2],ne.set(Rd(K.x,le.x),Rd(K.y,le.y)),pe.set(Rd(le.x,me.x),Rd(le.y,me.y)),ge.set(Rd(K.x,me.x),Rd(K.y,me.y)),W0(W,ne,pe,ge),W0(W,K,ne,ge),W0(W,le,pe,ne),W0(W,me,ge,pe));r.vertices=$,r.faces=U,A&&(r.faceVertexUvs[0]=W)}},Di=new E,eR=class{static create(r){return this.build(this.normalizeInputs(r))}static normalizeInputs(r,a){let n=r.geometry??(a==null?void 0:a.geometry)??new Ce().copy(new yi(100,100,100)),o;a===void 0?(n.computeBoundingBox(),n.boundingBox.getSize(Di),o={width:Di.x,height:Di.y,depth:Di.z,subdivisions:0}):o=a.parameters;let f={...o,...r.parameters};return{parameters:{width:Math.abs(f.width),height:Math.abs(f.height),depth:Math.abs(f.depth),subdivisions:Math.abs(f.subdivisions)},geometry:n}}static build(r){let{width:a,height:n,depth:o,subdivisions:f}=r.parameters,y=r.geometry??new Ce().copy(new yi(100,100,100)),x=y.userData.parameters;x===void 0?(y.computeBoundingBox(),y.boundingBox.getSize(Di)):Di.set(x.width,x.height,x.depth),(a!==Di.x||n!==Di.y||o!==Di.z)&&y.scale(Di.x===0?1:a/Di.x,Di.y===0?1:n/Di.y,Di.z===0?1:o/Di.z);let b=y.originalGeometry;try{f>0?(b===void 0||(x==null?void 0:x.subdivisions)!==f)&&(b===void 0&&(b=y),y=new q0(f).modify(b).toBufferGeometry()):(b!==void 0&&(y=b),b=void 0,y.getAttribute("normal")===void 0&&y.computeVertexNormals())}catch{b!==void 0&&(y=b),b=void 0,y.getAttribute("normal")===void 0&&y.computeVertexNormals()}return b!==void 0&&Object.assign(y,{originalGeometry:b}),delete r.geometry,Object.assign(y,{userData:{...r,type:"NonParametricGeometry"}})}static loadFromUrl(r,a,n){new nh(n).load(r,o=>{let f=this.normalizeInputs({geometry:o});o.boundingBox.getSize(Di);let y=100/Di.x;Object.assign(f.parameters,{width:100,height:Di.y*y,depth:Di.z*y}),a(this.build(f))})}},X0=class{static create(r){return this.build(this.normalizeInputs(r))}static normalizeInputs(r,a){let n=Object.assign({},(a==null?void 0:a.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:3},r.parameters);return{shape:r.shape&&r.shape instanceof Qt?r.shape:new Qt,parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??0)})}}static build(r){let{width:a,height:n,spikes:o,cornerRadius:f,depth:y,extrudeBevelSize:x,extrudeBevelSegments:b}=r.parameters,_=r.shape,S=a*.5,A=n*.5,C=0,P=0,T=2*Math.PI/o;for(let O=0;O<o;O++){let I=T*O,D=C+Math.sin(I)*S,z=P+Math.cos(I)*A;_.addPoint(_.createPoint(D,z))}_.isClosed=!0;for(let O=0,I=_.points.length;O<I;O++)_.points[O].roundness=f;_.roundness=f,_.update();let M=Bn.create({shape:_,parameters:{roundness:f,depth:y,extrudeBevelSize:x,extrudeBevelSegments:b}});return Object.assign(M,{userData:{...r,type:"PolygonGeometry"}})}},tR=class{static create(r){return this.build(this.normalizeInputs(r))}static normalizeInputs(r,a){let n=Object.assign({},(a==null?void 0:a.parameters)??{width:100,radialSegments:4,heightSegments:1,cornerRadius:0,cornerSegments:8,openEnded:!1},r.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(r){let{width:a,height:n,depth:o,radialSegments:f,heightSegments:y,openEnded:x,cornerRadius:b,cornerSegments:_}=r.parameters,S=new tE(a*.5,n,f,y,x,b,_);return S.scale(1,1,o/a),Object.assign(S,{userData:{...r,type:"PyramidGeometry"}})}};function Em(r,a,n){n.x=r.x*a.x,n.y=r.y,n.z=r.x*a.y}function eE(r,a,n,o,f,y){let x=a.clone().sub(r),b=n.clone().sub(r),_=x.angleTo(b);if(x.normalize(),b.normalize(),o===f){let S=x.add(b).normalize();y.copy(r).addScaledVector(S,o/Math.sin(_/2))}else{let S=x.angleTo(b);y.copy(r),y.addScaledVector(x,f/Math.sin(S)),y.addScaledVector(b,o/Math.sin(S))}}function gX(r,a,n){let o=r.clone().sub(a),f=n.clone().sub(a);return o.projectOnVector(f),o.add(a)}var tE=class extends Ce{constructor(r=.5,a=1,n=4,o=1,f=!1,y=0,x=4){super(),n=Math.floor(Math.max(3,n)),o=Math.floor(o),x=Math.floor(x);let b=[],_=[],S=[],A=[],C=0,P=a/2,T=Math.PI/n,M=r*Math.cos(Math.PI/n),O=2*Math.PI/n,I=(n-2)*Math.PI/n,D=Math.PI-I,z=new E(0,-P,0),k=new E(0,P,0),L=new V(r,-P),R=new V(M,-P),F=new V(0,k.y).sub(R),B=new V(0,k.y).sub(L),N=new V(F.y,-F.x).normalize(),j=new V(B.y,-B.x).normalize(),G=r*Math.cos(Math.PI/n)*Math.tan((Math.PI-F.angle())/2)-1e-8;y=Math.min(y,G);let Y;{let Z=new E(N.x,N.y,0),U=new E(Math.cos(O)*Z.x,Z.y,Math.sin(O)*Z.x);Y=Z.angleTo(U)}let X=y/Math.tan((Math.PI-F.angle())/2),$=y/Math.tan((Math.PI-Y)/2),te=new E;if(!f){_.push(z.x,z.y,z.z),S.push(0,-1,0),A.push(0,0);let Z=C++,U=[],W=L.clone(),H=X/Math.cos(Math.PI/n);W.x-=H;for(let K=0;K<n;K++){let le=K/n*Math.PI*2+T,me=new V(Math.sin(le),Math.cos(le));Em(W,me,te),_.push(te.x,te.y,te.z),S.push(0,-1,0),A.push(0,0),U.push(C++)}for(let K=0;K<U.length;K++)b.push(U[K],Z,U[(K+1)%U.length])}{let Z=new E,U=new E,W=new E,H=new E,K=new E,le=new E;for(let me=0;me<n;me++){let ne=me/n*Math.PI*2+T,pe=(me+.5)/n*Math.PI*2+T,ge=(me+1)/n*Math.PI*2+T,ye=new V(Math.sin(ne),Math.cos(ne)),_e=new V(Math.sin(pe),Math.cos(pe)),ve=new V(Math.sin(ge),Math.cos(ge));Em(L,ye,U),Em(L,ve,W),Em(N,_e,Z),eE(k,U,W,$,$,H),_.push(H.x,H.y,H.z),eE(U,k,W,$,X,K),_.push(K.x,K.y,K.z),eE(W,U,k,X,$,le),_.push(le.x,le.y,le.z),S.push(Z.x,Z.y,Z.z),S.push(Z.x,Z.y,Z.z),S.push(Z.x,Z.y,Z.z),A.push(0,0),A.push(0,0),A.push(0,0);let Ee=C++,xe=C++,Me=C++;if(b.push(Ee,xe,Me),y>0){{let Oe=U.clone().add(W).multiplyScalar(.5),Be=k.clone().sub(Oe).normalize(),oe=z.clone().sub(Oe).normalize().add(Be).normalize().multiplyScalar(-1),De=le.clone().sub(K);ee(Oe,De,oe,F.angle())}let Pe,be;{let Oe=new E;Em(j,ve,Oe);let Be=le.clone().add(H).multiplyScalar(.5);Be=gX(Be,W,k);let oe=le.clone().sub(H);[Pe,be]=ee(Be,oe,Oe,Y,H.y)}{let Oe=Pe,Be=Oe.clone().setY(0).normalize(),oe=new E(0,-1,0),De=Be.clone().cross(oe);q(Oe,Be,oe,De)}{let Oe=F.angle(),Be=Math.PI-Oe,oe=k.clone();oe.y-=y/Math.sin(Oe-Math.PI/2);let De=new E,ze=[];for(let Le=0;Le<x;Le++){let bt=[],Ve=Math.PI/2-Be*Le/x,He=Math.cos(Ve),tt=Math.sin(Ve),ie=pe;for(let We=0;We<=Le;We++){let wt=Math.cos(ie),Nt=Math.sin(ie);Z.x=He*Nt,Z.y=tt,Z.z=He*wt,De.copy(oe).addScaledVector(Z,y),_.push(De.x,De.y,De.z),S.push(Z.x,Z.y,Z.z),A.push(0,0),bt.push(C++),ie+=Math.PI*2/Le/n}ze.push(bt)}be.reverse(),ze.push(be);let Ne=ze.length-1;for(let Le=0;Le<Ne;Le++){let bt=ze[Le],Ve=ze[Le+1],He=bt.length-1;b.push(Ve[1],bt[0],Ve[0]);for(let tt=1;tt<=He;tt++)b.push(bt[tt],bt[tt-1],Ve[tt]),b.push(Ve[tt+1],bt[tt],Ve[tt])}}}}}this.setIndex(b),this.setAttribute("position",new Te(_,3)),this.setAttribute("normal",new Te(S,3)),this.setAttribute("uv",new Te(A,2));function ee(Z,U,W,H,K){let le=-H/2,me=(Math.PI-H)/2,ne=U.clone().normalize().cross(W);Z.addScaledVector(W,-y/Math.sin(me));let pe=new E,ge=new E,ye=1,_e=C,ve=[];for(let Ee=0;Ee<=x;Ee++){let xe=le+Ee/x*H;ge.set(0,0,0),ge.addScaledVector(ne,Math.sin(xe)),ge.addScaledVector(W,Math.cos(xe));for(let Me=0;Me<=ye;Me++){let Pe=Me/ye-.5;if(pe.copy(Z),pe.addScaledVector(U,Pe),pe.addScaledVector(ge,y),K!=null){let be=Math.max(0,pe.y-K);pe.addScaledVector(U,-be/U.y)}_.push(pe.x,pe.y,pe.z),S.push(ge.x,ge.y,ge.z),A.push(0,0),Me===0&&ve.push(C),C++}}for(let Ee=0;Ee<x;Ee++)for(let xe=0;xe<ye;xe++){let Me=_e+xe+(ye+1)*Ee,Pe=Me+(ye+1),be=Pe+1,Oe=Me+1;b.push(Me,Pe,Oe),b.push(Pe,be,Oe)}return[Z.clone().addScaledVector(U,.5),ve]}function q(Z,U,W,H){let K=Math.PI/2,le=B.angle()-K,me=[],ne=new E,pe=new E;for(let ye=0;ye<=x;ye++){let _e=[],ve=ye/x;for(let Ee=0;Ee<=ye;Ee++){let xe=((ye?Ee/ye:0)-.5)*D,Me=Math.cos(xe),Pe=Math.sin(xe),be=Math.atan(Math.tan(le)*Me),Oe=(K+be)*ve,Be=Math.cos(Oe),oe=Math.sin(Oe);ne.set(0,0,0),ne.addScaledVector(U,oe*Me),ne.addScaledVector(W,Be),ne.addScaledVector(H,oe*Pe),pe.copy(Z).addScaledVector(ne,y),_.push(pe.x,pe.y,pe.z),S.push(ne.x,ne.y,ne.z),A.push(0,0),_e.push(C++)}me.push(_e)}let ge=me.length-1;for(let ye=0;ye<ge;ye++){let _e=me[ye],ve=me[ye+1],Ee=_e.length-1;b.push(_e[0],ve[1],ve[0]);for(let xe=1;xe<=Ee;xe++)b.push(_e[xe-1],_e[xe],ve[xe]),b.push(_e[xe],ve[xe+1],ve[xe])}}}},Ld=class{static create(r){return this.build(this.normalizeInputs(r))}static normalizeInputs(r,a){let n=Object.assign({},(a==null?void 0:a.parameters)??{width:100,depth:0,cornerRadius:[0,0,0,0],cornerType:1,extrudeBevelSize:0,extrudeBevelSegments:1},r.parameters),o=Object.assign((a==null?void 0:a.ui)??{enabledIndieCorners:!1},r.ui);return{shape:r.shape&&r.shape instanceof Qt?r.shape:new Qt,parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??0)}),ui:o}}static build(r){let a=r.shape,{width:n,height:o,cornerRadius:f,cornerType:y,depth:x,extrudeBevelSize:b,extrudeBevelSegments:_}=r.parameters,S={x:n*.5,y:o*.5},A={x:-S.x,y:-S.y},C={x:S.x,y:S.y};function P(L,R,F){return R>n&&F>o?Math.min(L*n/R,L*o/F):R>n?L*n/R:F>o?L*o/F:L}let T=[];T[0]=f[0]===0?0:P(f[0],f[0]+f[3],f[0]+f[1]),T[1]=f[1]===0?0:P(f[1],f[1]+f[2],f[1]+f[0]),T[2]=f[2]===0?0:P(f[2],f[2]+f[1],f[2]+f[3]),T[3]=f[3]===0?0:P(f[3],f[3]+f[0],f[3]+f[2]);let M=A.x,O=C.x,I=C.y,D=A.y;a.addPoint(a.createPoint(M,I)),a.addPoint(a.createPoint(O,I)),a.addPoint(a.createPoint(O,D)),a.addPoint(a.createPoint(M,D)),a.isClosed=!0;let z=!0;for(let L=0,R=a.points.length;L<R;L++)a.points[L].roundness=T[L],L>0&&T[L]!==T[L-1]&&(z=!1);z&&(a.roundness=T[0]),a.useCubicForRoundedCorners=y!==1,a.update();let k=Bn.create({shape:a,parameters:{depth:x,extrudeBevelSize:b,extrudeBevelSegments:_}});return Object.assign(k,{userData:{...r,type:"RectangleGeometry"}})}},rR=class{static create(r){return this.build(this.normalizeInputs(r))}static normalizeInputs(r,a){let n=Object.assign({},(a==null?void 0:a.parameters)??{width:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180},r.parameters);return n.thetaLength=we.clamp(n.thetaLength,0,180),{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(r){let{width:a=100,height:n=a,depth:o=a,widthSegments:f=64,heightSegments:y=64,phiStart:x,phiLength:b,thetaStart:_,thetaLength:S}=r.parameters,A;return S===0?(A=new Ce,A.setAttribute("position",new Te([],3))):A=new Fs(.5*a,f,y,x,b,_,S*we.DEG2RAD),A.scale(1,n/a,o/a),Object.assign(A,{userData:{...r,type:"SphereGeometry"}})}},iR=class{static create(r){return this.build(this.normalizeInputs(r))}static normalizeInputs(r,a){let n=Object.assign({},(a==null?void 0:a.parameters)??{width:100,depth:0,widthSegments:8,heightSegments:8},r.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:0})}}static build(r){let{width:a=100,height:n=a,widthSegments:o=8,heightSegments:f=8}=r.parameters,y=new vi(a,n,o,f);return y.scale(1,1,1),Object.assign(y,{userData:{...r,type:"PlaneGeometry"}})}},nR=class{static create(r){return this.build(this.normalizeInputs(r))}static normalizeInputs(r,a){let n=Object.assign({},(a==null?void 0:a.parameters)??{width:100,angle:90,cornerRadius:24,cornerSegments:8},r.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(r){let{width:a,height:n,depth:o,angle:f,cornerRadius:y,cornerSegments:x}=r.parameters,b=new rE(a,n,o,f,y,x);return Object.assign(b,{userData:{...r,type:"BackdropGeometry"}})}},rE=class extends Ce{constructor(r=1,a=1,n=1,o=90,f=10,y=24){super(),this.type="BackdropGeometry";let x=[],b=[],_=[],S=.001;f==0&&(y=1),y=Math.max(1,Math.floor(y)),f=Math.min(f,100),o=Math.min(180-S,o),o*=Math.PI/180;let A=[],C=Math.PI/2,P=(ye=0,_e=0,ve=0)=>new E(ye,_e,ve),T=P(),M=P(),[O,I,D]=[a/2,r/2,n/2],z=-I,k=+I,[L,R,F]=[P(z,-O,+D),P(z,-O,-D),P(z,+O,-D)],B=(ye,_e=!1)=>Math.sin(ye-Math.PI/(1+ +_e)),N=(ye,_e=!1)=>Math.cos(ye-Math.PI/(1+ +_e));F.y=Math.sin(o)*a-O;let j=Math.cos(o)*a-D,G=L.z-S;o<=C?(F.z=Math.min(j,G),F.z==G&&(F.y-=(j-G)/Math.tan(C-o))):R.z=Math.min(R.z-j-D,L.z-S),T.subVectors(L,R),M.subVectors(F,R);let Y=Math.min(T.length(),M.length())*f/100,X=Y*Math.tan(o/2),$=Y/Math.cos(o/2),te=T.clone().normalize().add(M.normalize()).setLength($).add(R);T.set(0,B(o,!0),N(o,!0)),A.push([F,T.clone()]);let ee=(Math.PI-o)/y;for(let ye=0;ye<=y;ye++){let _e=C+o+ye*ee;T.set(0,Math.sin(_e)*X,Math.cos(_e)*X),T.add(te),M.set(0,B(_e),N(_e)),A.push([T.clone(),M.clone()])}A.push([L,P(0,1,0)]);let q=Math.sin(ee/2)*X*2,Z=A.length-1,U=A[0][0].distanceTo(A[1][0]),W=A[Z-1][0].distanceTo(A[Z][0]),H=U+q*y+W;A[0].push(1);for(let ye=0;ye<=y;ye++)A[ye+1].push(1-(U+ye*q)/H);A[Z].push(0);let[K,le,me]=A[0],ne,pe,ge;for(let ye=1;ye<A.length;ye++)[ne,pe,ge]=A[ye],x.push(z,K.y,K.z,z,ne.y,ne.z,k,K.y,K.z,k,K.y,K.z,z,ne.y,ne.z,k,ne.y,ne.z),b.push(0,le.y,le.z,0,pe.y,pe.z,0,le.y,le.z,0,le.y,le.z,0,pe.y,pe.z,0,pe.y,pe.z),_.push(0,me,0,ge,1,me,1,me,0,ge,1,ge),[K,le,me]=[ne,pe,ge];this.setAttribute("position",new Te(x,3)),this.setAttribute("normal",new Te(b,3)),this.setAttribute("uv",new Te(_,2))}},Y0=class{static create(r){return this.build(this.normalizeInputs(r))}static normalizeInputs(r,a){let n=Object.assign({},(a==null?void 0:a.parameters)??{width:100,depth:0,innerRadiusPercent:38.19,spikes:5,cornerRadius:0,angle:360,extrudeBevelSize:0,extrudeBevelSegments:1},r.parameters);return{shape:r.shape&&r.shape instanceof Qt?r.shape:new Qt,parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??0)})}}static build(r){let{width:a,height:n,innerRadiusPercent:o,spikes:f,cornerRadius:y,angle:x,depth:b,extrudeBevelSize:_,extrudeBevelSegments:S}=r.parameters,A=r.shape,C=a*.5,P=n*.5,T=0,M=0,O=x*Math.PI/360/f,I=Math.PI/2*3*-1,D=C*o/100,z=P*o/100;if(f===3&&o===50){O=2*Math.PI/f;for(let L=0;L<f;L++){let R=O*L,F=T+Math.sin(R)*C,B=M+Math.cos(R)*P;A.addPoint(A.createPoint(F,B))}}else for(let L=0;L<f;L++){let R=T+Math.cos(I)*C,F=M+Math.sin(I)*P;A.addPoint(A.createPoint(R,F)),I+=O,R=T+Math.cos(I)*D,F=M+Math.sin(I)*z,A.addPoint(A.createPoint(R,F)),I+=O}A.isClosed=!0;for(let L=0,R=A.points.length;L<R;L++)A.points[L].roundness=y;A.roundness=y,A.update();let k=Bn.create({shape:A,parameters:{roundness:y,depth:b,extrudeBevelSize:_,extrudeBevelSegments:S}});return Object.assign(k,{userData:{...r,type:"StarGeometry"}})}},sR=class{static create(r){return this.build(this.normalizeInputs(r))}static normalizeInputs(r,a){let n=Object.assign({},(a==null?void 0:a.parameters)??{width:100,depth:0},r.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??0)})}}static build(r){let{width:a,height:n}=r.parameters,o=new vi(a,n);return Object.assign(o,{userData:{...r,type:"TextFrameGeometry"}})}},oR=class{static create(r){return this.build(this.normalizeInputs(r))}static normalizeInputs(r,a){let n=Object.assign({},(a==null?void 0:a.parameters)??{width:100,radialSegments:32,tubularSegments:64,arc:360,cornerRadius:30,cornerSegments:8},r.parameters),o=Math.abs(n.width),f=Math.abs(n.height??n.width);n.shapeBlendNode&&(f=o);let y=Math.round(Math.abs(n.depth??n.width*.25));return{parameters:Object.assign(n,{width:o,height:f,depth:y})}}static build(r){let{width:a,height:n,depth:o,radialSegments:f,tubularSegments:y,arc:x,cornerRadius:b,cornerSegments:_}=r.parameters,S=yX(a,n,o,a*.5,x,y,0,0,f,b,_);return S.scale(1,n/a,1),Object.assign(S,{userData:{...r,type:"TorusGeometry"}})}};function yX(r,a,n,o,f,y,x,b,_,S,A){[a,n]=[n,a],x=a/2;let C=we.clamp(f/360,0,1);if(C===0){let P=new Ce;return P.setAttribute("position",new Te([],3)),P}return C===1&&(S=0),new wm(!0,r,a,n,o,C,y,x,b,_,S,A)}var aR=class{static create(r){return this.build(this.normalizeInputs(r))}static normalizeInputs(r,a){let n=Object.assign({},(a==null?void 0:a.parameters)??{width:100,tubularSegments:64,radialSegments:32,p:2,q:3},r.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width),tube:n.tube??n.width*.125})}}static build(r){let{width:a,tube:n,tubularSegments:o,radialSegments:f,p:y,q:x}=r.parameters,b=a*.5;b!==n&&(b-=n);let _=new Ju(b,n,o,f,y,x);return Object.assign(_,{userData:{...r,type:"TorusKnotGeometry"}})}},lR=class{static create(r){return this.build(this.normalizeInputs(r))}static normalizeInputs(r,a){let n=Object.assign({},(a==null?void 0:a.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1,isRect:!1},r.parameters);return{shape:r.shape&&r.shape instanceof Qt?r.shape:new Qt,parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width*(n.isRect?1:Math.sqrt(3)/2)),depth:Math.abs(n.depth??0)})}}static build(r){let{width:a=100,height:n,cornerRadius:o,depth:f,extrudeBevelSize:y,extrudeBevelSegments:x,isRect:b}=r.parameters,_=r.shape,S=a*.5,A=n*.5;b?(_.addPoint(_.createPoint(-S,A)),_.addPoint(_.createPoint(S,-A)),_.addPoint(_.createPoint(-S,-A))):(_.addPoint(_.createPoint(0,A)),_.addPoint(_.createPoint(S,-A)),_.addPoint(_.createPoint(-S,-A))),_.isClosed=!0;for(let P=0,T=_.points.length;P<T;P++)_.points[P].roundness=o;_.roundness=o,_.update();let C=Bn.create({shape:_,parameters:{roundness:o,depth:f,extrudeBevelSize:y,extrudeBevelSegments:x}});return Object.assign(C,{userData:{...r,type:"TriangleGeometry"}})}};function cR(r,a){let n=2*Math.PI;return(r%n+n)%n===(a%n+n)%n}function vX(r){return/^(rgba)?\(\s*(\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(r.toLowerCase())}function xX(r,a,n){let o,f,y,x=Math.floor(r*6),b=r*6-x,_=n*(1-a),S=n*(1-b*a),A=n*(1-(1-b)*a);switch(x%6){case 0:o=n,f=A,y=_;break;case 1:o=S,f=n,y=_;break;case 2:o=_,f=n,y=A;break;case 3:o=_,f=S,y=n;break;case 4:o=A,f=_,y=n;break;case 5:default:o=n,f=_,y=S;break}return{r:o*255,g:f*255,b:y*255}}function bX(r,a,n){r/=255,a/=255,n/=255;let o=Math.max(r,a,n),f=Math.min(r,a,n),y=o,x=o-f,b=o==0?0:x/o,_;if(o==f)_=0;else{switch(o){case r:_=(a-n)/x+(a<n?6:0);break;case a:_=(n-r)/x+2;break;case n:default:_=(r-a)/x+4;break}_/=6}return{h:_,s:b,v:y}}function SX(r){return r=Math.floor(r),{r:r>>16&255,g:r>>8&255,b:r&255}}function wX(r,a,n){return(r<<16)+(a<<8)+n}function AX(r,a,n){return r=Math.round(r),a=Math.round(a),n=Math.round(n),"#"+[r,a,n].map(o=>o.toString(16).padStart(2,"0")).join("").toUpperCase()}function EX(r){let a=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;r=r.replace(a,(o,f,y,x)=>String(f+f+y+y+x+x));let n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r);return n?{r:parseInt(n[1],16),g:parseInt(n[2],16),b:parseInt(n[3],16)}:null}var uR={parseRgba:vX,hsvToRgb:xX,rgbToHsv:bX,hexToRgb:SX,rgbToHex:wX,rgbToHexString:AX,hexStringToRgb:EX},iE=class{add(r,a,n){if(typeof arguments[0]!="string")for(let o in arguments[0])this.add(o,arguments[0][o],arguments[1]);else(Array.isArray(r)?r:[r]).forEach(function(o){this[o]=this[o]||[],a&&this[o][n?"unshift":"push"](a)},this)}run(r,a){this[r]=this[r]||[],this[r].forEach(function(n){n.call(a&&a.context?a.context:a,a)})}},nE=class{constructor(r){this.jsep=r,this.registered={}}register(...r){r.forEach(a=>{if(typeof a!="object"||!a.name||!a.init)throw new Error("Invalid JSEP plugin format");this.registered[a.name]||(a.init(this.jsep),this.registered[a.name]=a)})}},fe=class{static get version(){return"1.3.8"}static toString(){return"JavaScript Expression Parser (JSEP) v"+fe.version}static addUnaryOp(r){return fe.max_unop_len=Math.max(r.length,fe.max_unop_len),fe.unary_ops[r]=1,fe}static addBinaryOp(r,a,n){return fe.max_binop_len=Math.max(r.length,fe.max_binop_len),fe.binary_ops[r]=a,n?fe.right_associative.add(r):fe.right_associative.delete(r),fe}static addIdentifierChar(r){return fe.additional_identifier_chars.add(r),fe}static addLiteral(r,a){return fe.literals[r]=a,fe}static removeUnaryOp(r){return delete fe.unary_ops[r],r.length===fe.max_unop_len&&(fe.max_unop_len=fe.getMaxKeyLen(fe.unary_ops)),fe}static removeAllUnaryOps(){return fe.unary_ops={},fe.max_unop_len=0,fe}static removeIdentifierChar(r){return fe.additional_identifier_chars.delete(r),fe}static removeBinaryOp(r){return delete fe.binary_ops[r],r.length===fe.max_binop_len&&(fe.max_binop_len=fe.getMaxKeyLen(fe.binary_ops)),fe.right_associative.delete(r),fe}static removeAllBinaryOps(){return fe.binary_ops={},fe.max_binop_len=0,fe}static removeLiteral(r){return delete fe.literals[r],fe}static removeAllLiterals(){return fe.literals={},fe}get char(){return this.expr.charAt(this.index)}get code(){return this.expr.charCodeAt(this.index)}constructor(r){this.expr=r,this.index=0}static parse(r){return new fe(r).parse()}static getMaxKeyLen(r){return Math.max(0,...Object.keys(r).map(a=>a.length))}static isDecimalDigit(r){return r>=48&&r<=57}static binaryPrecedence(r){return fe.binary_ops[r]||0}static isIdentifierStart(r){return r>=65&&r<=90||r>=97&&r<=122||r>=128&&!fe.binary_ops[String.fromCharCode(r)]||fe.additional_identifier_chars.has(String.fromCharCode(r))}static isIdentifierPart(r){return fe.isIdentifierStart(r)||fe.isDecimalDigit(r)}throwError(r){let a=new Error(r+" at character "+this.index);throw a.index=this.index,a.description=r,a}runHook(r,a){if(fe.hooks[r]){let n={context:this,node:a};return fe.hooks.run(r,n),n.node}return a}searchHook(r){if(fe.hooks[r]){let a={context:this};return fe.hooks[r].find(function(n){return n.call(a.context,a),a.node}),a.node}}gobbleSpaces(){let r=this.code;for(;r===fe.SPACE_CODE||r===fe.TAB_CODE||r===fe.LF_CODE||r===fe.CR_CODE;)r=this.expr.charCodeAt(++this.index);this.runHook("gobble-spaces")}parse(){this.runHook("before-all");let r=this.gobbleExpressions(),a=r.length===1?r[0]:{type:fe.COMPOUND,body:r};return this.runHook("after-all",a)}gobbleExpressions(r){let a=[],n,o;for(;this.index<this.expr.length;)if(n=this.code,n===fe.SEMCOL_CODE||n===fe.COMMA_CODE)this.index++;else if(o=this.gobbleExpression())a.push(o);else if(this.index<this.expr.length){if(n===r)break;this.throwError('Unexpected "'+this.char+'"')}return a}gobbleExpression(){let r=this.searchHook("gobble-expression")||this.gobbleBinaryExpression();return this.gobbleSpaces(),this.runHook("after-expression",r)}gobbleBinaryOp(){this.gobbleSpaces();let r=this.expr.substr(this.index,fe.max_binop_len),a=r.length;for(;a>0;){if(fe.binary_ops.hasOwnProperty(r)&&(!fe.isIdentifierStart(this.code)||this.index+r.length<this.expr.length&&!fe.isIdentifierPart(this.expr.charCodeAt(this.index+r.length))))return this.index+=a,r;r=r.substr(0,--a)}return!1}gobbleBinaryExpression(){let r,a,n,o,f,y,x,b,_;if(y=this.gobbleToken(),!y||(a=this.gobbleBinaryOp(),!a))return y;for(f={value:a,prec:fe.binaryPrecedence(a),right_a:fe.right_associative.has(a)},x=this.gobbleToken(),x||this.throwError("Expected expression after "+a),o=[y,f,x];a=this.gobbleBinaryOp();){if(n=fe.binaryPrecedence(a),n===0){this.index-=a.length;break}f={value:a,prec:n,right_a:fe.right_associative.has(a)},_=a;let S=A=>f.right_a&&A.right_a?n>A.prec:n<=A.prec;for(;o.length>2&&S(o[o.length-2]);)x=o.pop(),a=o.pop().value,y=o.pop(),r={type:fe.BINARY_EXP,operator:a,left:y,right:x},o.push(r);r=this.gobbleToken(),r||this.throwError("Expected expression after "+_),o.push(f,r)}for(b=o.length-1,r=o[b];b>1;)r={type:fe.BINARY_EXP,operator:o[b-1].value,left:o[b-2],right:r},b-=2;return r}gobbleToken(){let r,a,n,o;if(this.gobbleSpaces(),o=this.searchHook("gobble-token"),o)return this.runHook("after-token",o);if(r=this.code,fe.isDecimalDigit(r)||r===fe.PERIOD_CODE)return this.gobbleNumericLiteral();if(r===fe.SQUOTE_CODE||r===fe.DQUOTE_CODE)o=this.gobbleStringLiteral();else if(r===fe.OBRACK_CODE)o=this.gobbleArray();else{for(a=this.expr.substr(this.index,fe.max_unop_len),n=a.length;n>0;){if(fe.unary_ops.hasOwnProperty(a)&&(!fe.isIdentifierStart(this.code)||this.index+a.length<this.expr.length&&!fe.isIdentifierPart(this.expr.charCodeAt(this.index+a.length)))){this.index+=n;let f=this.gobbleToken();return f||this.throwError("missing unaryOp argument"),this.runHook("after-token",{type:fe.UNARY_EXP,operator:a,argument:f,prefix:!0})}a=a.substr(0,--n)}fe.isIdentifierStart(r)?(o=this.gobbleIdentifier(),fe.literals.hasOwnProperty(o.name)?o={type:fe.LITERAL,value:fe.literals[o.name],raw:o.name}:o.name===fe.this_str&&(o={type:fe.THIS_EXP})):r===fe.OPAREN_CODE&&(o=this.gobbleGroup())}return o?(o=this.gobbleTokenProperty(o),this.runHook("after-token",o)):this.runHook("after-token",!1)}gobbleTokenProperty(r){this.gobbleSpaces();let a=this.code;for(;a===fe.PERIOD_CODE||a===fe.OBRACK_CODE||a===fe.OPAREN_CODE||a===fe.QUMARK_CODE;){let n;if(a===fe.QUMARK_CODE){if(this.expr.charCodeAt(this.index+1)!==fe.PERIOD_CODE)break;n=!0,this.index+=2,this.gobbleSpaces(),a=this.code}this.index++,a===fe.OBRACK_CODE?(r={type:fe.MEMBER_EXP,computed:!0,object:r,property:this.gobbleExpression()},this.gobbleSpaces(),a=this.code,a!==fe.CBRACK_CODE&&this.throwError("Unclosed ["),this.index++):a===fe.OPAREN_CODE?r={type:fe.CALL_EXP,arguments:this.gobbleArguments(fe.CPAREN_CODE),callee:r}:(a===fe.PERIOD_CODE||n)&&(n&&this.index--,this.gobbleSpaces(),r={type:fe.MEMBER_EXP,computed:!1,object:r,property:this.gobbleIdentifier()}),n&&(r.optional=!0),this.gobbleSpaces(),a=this.code}return r}gobbleNumericLiteral(){let r="",a,n;for(;fe.isDecimalDigit(this.code);)r+=this.expr.charAt(this.index++);if(this.code===fe.PERIOD_CODE)for(r+=this.expr.charAt(this.index++);fe.isDecimalDigit(this.code);)r+=this.expr.charAt(this.index++);if(a=this.char,a==="e"||a==="E"){for(r+=this.expr.charAt(this.index++),a=this.char,(a==="+"||a==="-")&&(r+=this.expr.charAt(this.index++));fe.isDecimalDigit(this.code);)r+=this.expr.charAt(this.index++);fe.isDecimalDigit(this.expr.charCodeAt(this.index-1))||this.throwError("Expected exponent ("+r+this.char+")")}return n=this.code,fe.isIdentifierStart(n)?this.throwError("Variable names cannot start with a number ("+r+this.char+")"):(n===fe.PERIOD_CODE||r.length===1&&r.charCodeAt(0)===fe.PERIOD_CODE)&&this.throwError("Unexpected period"),{type:fe.LITERAL,value:parseFloat(r),raw:r}}gobbleStringLiteral(){let r="",a=this.index,n=this.expr.charAt(this.index++),o=!1;for(;this.index<this.expr.length;){let f=this.expr.charAt(this.index++);if(f===n){o=!0;break}else if(f==="\\")switch(f=this.expr.charAt(this.index++),f){case"n":r+=`
`;break;case"r":r+="\r";break;case"t":r+="	";break;case"b":r+="\b";break;case"f":r+="\f";break;case"v":r+="\v";break;default:r+=f}else r+=f}return o||this.throwError('Unclosed quote after "'+r+'"'),{type:fe.LITERAL,value:r,raw:this.expr.substring(a,this.index)}}gobbleIdentifier(){let r=this.code,a=this.index;for(fe.isIdentifierStart(r)?this.index++:this.throwError("Unexpected "+this.char);this.index<this.expr.length&&(r=this.code,fe.isIdentifierPart(r));)this.index++;return{type:fe.IDENTIFIER,name:this.expr.slice(a,this.index)}}gobbleArguments(r){let a=[],n=!1,o=0;for(;this.index<this.expr.length;){this.gobbleSpaces();let f=this.code;if(f===r){n=!0,this.index++,r===fe.CPAREN_CODE&&o&&o>=a.length&&this.throwError("Unexpected token "+String.fromCharCode(r));break}else if(f===fe.COMMA_CODE){if(this.index++,o++,o!==a.length){if(r===fe.CPAREN_CODE)this.throwError("Unexpected token ,");else if(r===fe.CBRACK_CODE)for(let y=a.length;y<o;y++)a.push(null)}}else if(a.length!==o&&o!==0)this.throwError("Expected comma");else{let y=this.gobbleExpression();(!y||y.type===fe.COMPOUND)&&this.throwError("Expected comma"),a.push(y)}}return n||this.throwError("Expected "+String.fromCharCode(r)),a}gobbleGroup(){this.index++;let r=this.gobbleExpressions(fe.CPAREN_CODE);if(this.code===fe.CPAREN_CODE)return this.index++,r.length===1?r[0]:r.length?{type:fe.SEQUENCE_EXP,expressions:r}:!1;this.throwError("Unclosed (")}gobbleArray(){return this.index++,{type:fe.ARRAY_EXP,elements:this.gobbleArguments(fe.CBRACK_CODE)}}},TX=new iE;Object.assign(fe,{hooks:TX,plugins:new nE(fe),COMPOUND:"Compound",SEQUENCE_EXP:"SequenceExpression",IDENTIFIER:"Identifier",MEMBER_EXP:"MemberExpression",LITERAL:"Literal",THIS_EXP:"ThisExpression",CALL_EXP:"CallExpression",UNARY_EXP:"UnaryExpression",BINARY_EXP:"BinaryExpression",ARRAY_EXP:"ArrayExpression",TAB_CODE:9,LF_CODE:10,CR_CODE:13,SPACE_CODE:32,PERIOD_CODE:46,COMMA_CODE:44,SQUOTE_CODE:39,DQUOTE_CODE:34,OPAREN_CODE:40,CPAREN_CODE:41,OBRACK_CODE:91,CBRACK_CODE:93,QUMARK_CODE:63,SEMCOL_CODE:59,COLON_CODE:58,unary_ops:{"-":1,"!":1,"~":1,"+":1},binary_ops:{"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},right_associative:new Set,additional_identifier_chars:new Set(["$","_"]),literals:{true:!0,false:!1,null:null},this_str:"this"});fe.max_unop_len=fe.getMaxKeyLen(fe.unary_ops);fe.max_binop_len=fe.getMaxKeyLen(fe.binary_ops);var Xc=r=>new fe(r).parse(),MX=Object.getOwnPropertyNames(fe);MX.forEach(r=>{Xc[r]===void 0&&r!=="prototype"&&(Xc[r]=fe[r])});Xc.Jsep=fe;var CX="ConditionalExpression",PX={name:"ternary",init(r){r.hooks.add("after-expression",function(a){if(a.node&&this.code===r.QUMARK_CODE){this.index++;let n=a.node,o=this.gobbleExpression();if(o||this.throwError("Expected expression"),this.gobbleSpaces(),this.code===r.COLON_CODE){this.index++;let f=this.gobbleExpression();if(f||this.throwError("Expected expression"),a.node={type:CX,test:n,consequent:o,alternate:f},n.operator&&r.binary_ops[n.operator]<=.9){let y=n;for(;y.right.operator&&r.binary_ops[y.right.operator]<=.9;)y=y.right;a.node.test=y.right,y.right=a.node,a.node=n}}else this.throwError("Expected :")}})}};Xc.plugins.register(PX);function La(r){return{all:r=r||new Map,on:function(a,n){var o=r.get(a);o?o.push(n):r.set(a,[n])},off:function(a,n){var o=r.get(a);o&&(n?o.splice(o.indexOf(n)>>>0,1):r.set(a,[]))},emit:function(a,n){var o=r.get(a);o&&o.slice().map(function(f){f(n)}),(o=r.get("*"))&&o.slice().map(function(f){f(a,n)})}}}var Bd=class{constructor(r,a,n){var o;this.id=r,this.userAPI=a,this.result=void 0,this.error="null",this.isPrefetched=!1,this.isLoading=!1,this.isLoaded=!1,this.prefetchPromise=new Promise(f=>f()),this.emitter=La(),this._innerCallUserAPI=async f=>{var y,x,b;this.emitter.emit("start",{userAPIId:this.id}),this.isLoading=!0,this.isLoading=!1;try{this.result=await RX(this.userAPI,f),this.error="null",this.emitter.emit("success",{userAPIId:this.id})}catch(_){let S=((b=(x=(y=_.message)==null?void 0:y.split("_:_"))==null?void 0:x[0])==null?void 0:b.replace("status:",""))??"null";this.error=S,this.result=null,this.emitter.emit("error",{userAPIId:this.id})}this.isLoading=!1,this.isPrefetched=!0,this.isLoaded=!0},((o=a==null?void 0:a.integration)==null?void 0:o.type)==="OpenAI"?this.result={content:""}:a.method==="GET"&&a.url!==""&&(this.prefetchPromise=this.prefetch(n)),this._debouncedCallUserAPI=this._innerCallUserAPI,this._updateDebouncedCallUserAPI(),this._debouncedPrefetch=xo(this.prefetch,1e3,{trailing:!0})}_updateDebouncedCallUserAPI(){this._debouncedCallUserAPI=this.userAPI.debounce!==void 0&&this.userAPI.debounce>0?xo(this._innerCallUserAPI,this.userAPI.debounce,{leading:!0,trailing:!0}):this._innerCallUserAPI}async prefetch(r){await this.callUserAPI(r)}async callUserAPI(r){await this._debouncedCallUserAPI(r)}update(r,a,n=!0){this.userAPI=r,this._updateDebouncedCallUserAPI(),this.userAPI.url!==""&&this.userAPI.method==="GET"&&n&&this._debouncedPrefetch(a)}retrieveValue(r){if(this.result)try{return Ar.zoom(this.result,r)}catch(a){console.error(a)}}retrieveZoomedKeyValues(r){if(this.result){let a=r&&r.length?Ar.zoom(this.result,r):this.result;if(OX(a))return Object.entries(a);if(DX(a))return a.map((n,o)=>[o.toString(),n]);throw IX(a)?new Error("This path points to a value, use retrieveValue() instead. "+(r==null?void 0:r.join("."))):new Error("Path error"+(r==null?void 0:r.join(".")))}}dispose(){}on(r,a){this.emitter.on(r,a)}off(r,a){this.emitter.off(r,a)}get autostart(){return this.userAPI.autoStart}};function _X(r){let a=new Headers;return r.headers.forEach(n=>{n.data.key!==""&&a.append(n.data.key,n.data.value)}),a}function IX(r){return typeof r=="string"||typeof r=="number"||typeof r=="boolean"||r===null}function DX(r){return Array.isArray(r)}function OX(r){return typeof r=="object"&&r!==null}async function RX(r,a,n=new AbortController){var _,S,A,C;let o,f=r.url,y=((_=r.proxy)==null?void 0:_.enabled)??!1,x;if(((S=r.integration)==null?void 0:S.type)==="OpenAI"){let P=Tm(r.integration.prompt===""?[]:JSON.parse(r.integration.prompt),a),T=r.integration.behavior===""?[]:Tm(JSON.parse(r.integration.behavior),a);x=`{
		"model": "${r.integration.model}",
		"messages": [${r.integration.useBehavior?`
		{
			"role": "system",
			"content": "${T}"
		},`:""}
		{
			"role": "user",
			"content": "${P}"
		}
		]
	}`}if(y){f=`https://apis.spline.design/file/${r.proxy.fileId}/external-api/request?uuidexternalapi=${r.proxy.proxyId}`;let P;x!==void 0?P=x:r.method==="POST"&&r.body&&(P=Tm(JSON.parse(r.body),a)),P!==void 0&&(f+=`&data=${encodeURIComponent(P.replace(/(\r\n|\n|\r|\t)/gm,""))}`)}else((A=r.integration)==null?void 0:A.type)==="OpenAI"?o=x:r.method==="POST"&&r.body&&(o=Tm(JSON.parse(r.body),a));let b=await fetch(f,{method:y?"GET":r.method,headers:y?void 0:_X(r),signal:n.signal,body:o});if(!b.ok)throw new Error("status:"+b.status+"_:_"+b.statusText);if(((C=r.integration)==null?void 0:C.type)==="OpenAI"){let P=await b.json();return y&&(P=P.response),{content:P.choices[0].message.content}}else{let P=await b.json();return y&&(P=P.response),P}}var hR=(r,a)=>{if(typeof r=="string"){let n=a.getVariable(r);if(n)return hR(n,a)}return Ur.isBoolean(r)?Ur.getDisplayedValue(r).toLowerCase():Ur.getDisplayedValue(r)},Tm=(r,a)=>r.map((n,o)=>{if("text"in n)return n.text;if("type"in n){if(n.type==="paragraph")return(o>0?`
`:"")+Tm(n.children,a);if(n.type==="variable"){let f=a.getVariable(n.variableId);if(f!==void 0)return hR(f,a)}}return""}).join(""),LX=["+","-","*","/","(",")","==","!=",">","<",">=","<=","and","or","!","%","^",","],BX=["0","1","2","3","4","5","6","7","8","9","."],NX=["sin","cos","tan","asin","acos","atan","atan2","sqrt","abs","log","exp","floor","ceil","round","min","max","random"];function FX(r){return typeof r!="string"?!1:!isNaN(r)&&!isNaN(parseFloat(r))}Xc.addBinaryOp("^",11,!0);function K0(r,a,n="number"){let o="";for(let x=0;x<r.length;x++){let b=r[x];if("objType"in b&&b.objType==="api"){let _=JSON.parse(b.id),S=_[0],A=a.getUserAPI(S);if(A!==void 0&&A instanceof Bd){let C=A.retrieveValue(_.slice(1));C!==void 0&&(o+=C)}continue}if("objType"in b&&b.objType==="webhook"){let _=JSON.parse(b.id),[S,A]=_,C=a.getUserWebhook(S);if(C!==void 0){let P=C.getParameterValue(A);P!==void 0&&(o+=P)}continue}if("objType"in b&&b.objType==="aiAssistant"){let _=a.openAIRealtime;if("objId"in b&&b.objId!==void 0){let S;if(a.scene.data.objects.traverse((A,C)=>{var T;let P=(T=C.events)==null?void 0:T.find(M=>M.id===b.objId);P&&(S=P)}),S!==void 0&&S.data.type==="AIAssistantListener"){let A=_==null?void 0:_.computeAnalysisForListenerEvent(S.data);if(A!==void 0){o+=A;continue}}}o+=(_==null?void 0:_.voice)??0;continue}if("id"in b){let _=r[x-1];if(x>0&&"id"in _){console.error("Two variables in a row",r);return}let S=a.getVariable(b.id),A=Ur.getDisplayedValue(S);n==="number"&&Ur.isTextValue(S)&&Array.isArray(S.textValue)&&S.textValue.length===1?A=parseFloat(A).toString():n==="boolean"&&Ur.isBoolean(S)?A=S?"true":"false":n==="boolean"&&Ur.isTextValue(S)&&!Array.isArray(S.textValue)&&(A='"'+A+'"'),o+=A;continue}else if(n==="string"){b.name!=='"'&&(b.name!=="+"||b.escaped)&&(o+=b.name),b.name==="+"&&!b.escaped&&o[o.length-1]==="\\"&&(o=o.slice(0,-1)+b.name);continue}if(b.name==="and"){o+="&&";continue}if(b.name==="or"){o+="||";continue}if(b.name==="True"){o+="true";continue}if(b.name==="False"){o+="false";continue}if(n==="boolean"&&!FX(b.name)&&!BX.includes(b.name)&&!LX.includes(b.name)&&!NX.includes(b.name.replace(/\($/g,""))){o+='"'+b.name+'"';continue}o+=b.name}if(n==="string")return o;if(r.length===0){if(n==="number")return 0;if(n==="boolean")return!1}let f;try{f=Xc(o)}catch(x){console.error(o,x);return}let y;try{y=Yt(f)}catch(x){console.error(o,f,x)}return y}function Yt(r){switch(r.type){case"BinaryExpression":switch(r.operator){case"==":return+(Yt(r.left)===Yt(r.right));case"!=":return+(Yt(r.left)!==Yt(r.right));case">":return+(Yt(r.left)>Yt(r.right));case">=":return+(Yt(r.left)>=Yt(r.right));case"<":return+(Yt(r.left)<Yt(r.right));case"<=":return+(Yt(r.left)<=Yt(r.right));case"+":return Yt(r.left)+Yt(r.right);case"-":return Yt(r.left)-Yt(r.right);case"*":return Yt(r.left)*Yt(r.right);case"/":return Yt(r.left)/Yt(r.right);case"%":return Yt(r.left)%Yt(r.right);case"&&":return Yt(r.left)&&Yt(r.right);case"||":return Yt(r.left)||Yt(r.right);case"^":return Math.pow(Yt(r.left),Yt(r.right));default:throw new Error("Unknown operator: "+r.operator)}case"UnaryExpression":switch(r.operator){case"-":return-Yt(r.argument);case"!":return+!Yt(r.argument);default:throw new Error("Unknown operator: "+r.operator)}case"Identifier":throw new Error("Unknown identifier: "+r.name);case"Literal":return r.value;case"CallExpression":if(r.callee.type==="Identifier"){if(r.callee.name==="random"){let a=0,n=1;if(r.arguments.length>=1)try{a=Yt(r.arguments[0])}catch(o){console.warn(o)}if(r.arguments.length>=2)try{n=Yt(r.arguments[1])}catch(o){console.warn(o)}return a=Math.min(n,a),n=Math.max(n,a),a+Math.random()*(n-a)}return Math[r.callee.name].apply(null,r.arguments.map(Yt))}else throw new Error("Unknown node");default:throw new Error("Unknown node type: "+r.type)}}var VX=new ue,UX=new ue;function zX(r,a,n){let o=[new E,new E,new E],f=[new E,new E,new E];return r.extractBasis(o[0],o[1],o[2]),a.extractBasis(f[0],f[1],f[2]),o.forEach((y,x)=>{let b=f[x],_=we.lerp(y.length(),b.length(),n);y.lerp(b,n).setLength(_)}),new ue().makeBasis(o[0],o[1],o[2])}var dR=class{static create(r){return this.build(this.normalizeInputs(r))}static normalizeInputs(r,a){let n=Object.assign({},(a==null?void 0:a.parameters)??{width:100,height:100,depth:1,subdivisions:12,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3},r.parameters),o=Math.abs(n.width),f=Math.abs(n.height??n.width),y=Math.abs(n.depth??0),x=(a==null?void 0:a.shapeData)??Dd.create({parameters:Jw}).userData.shape;return{path:r.path??Qh.defaultData(),parameters:Object.assign(n,{width:o,height:f,depth:y,extrusion:{...s0,...n.extrusion}}),shapeData:x}}static build(r){if(r.path.points.length>=2){let a=new sE(r);return Object.assign(a,{userData:{...r,type:"PathGeometry"}})}else return Object.assign(new Ce,{userData:{...r,type:"PathGeometry"}})}},sE=class extends Ce{constructor(r){super(),this.type="PathExtrusionGeometry",this.inputs=r,this.build()}_isGeometryClosed(){return this.inputs.path.isClosed&&this.inputs.parameters.extrusion.depth===1}_isOpenEnded(){let r=this.inputs.parameters.extrusion;return!(this.inputs.path.isClosed&&r.depth===1)||!cR(r.twist,0)||r.startScale!==r.endScale}build(){let r=this._extractPathPoints();if(r.length<2)return;let a=this._computeBasisMatrices(r),{depth:n,offset:o}=this.inputs.parameters.extrusion;n=Math.max(0,Math.min(n,1)),o=Math.max(0,Math.min(o,1));let f=this.inputs.path.isClosed?r.length:r.length-1,y=Math.floor(o*f),x=this.inputs.path.isClosed?Math.ceil((n+o)*f):Math.ceil(Math.min(1,n+o)*f),b=Math.min(Math.max(2,x-y+1),f+2),_=[],S=[];for(let Z=0;Z<b;Z++){let U=this.inputs.path.isClosed?(Z+y)%r.length:Math.min(Z+y,r.length-1);_.push(r[U].clone()),S.push(a[U].clone())}let A=(Z,U,W)=>{_[Z]=_[Z].clone().lerp(_[U],W),S[Z]=zX(S[Z],S[U],W)},C=0,P=o*f%1;(!this.inputs.path.isClosed||n<=1)&&(P||o===0)&&(C=P,A(0,1,C));let T=0,M=(o+n)*f%1;if((this.inputs.path.isClosed&&n<=1||!this.inputs.path.isClosed&&o+n<1)&&M&&(T=M,A(_.length-1,_.length-2,1-T)),n===0){let Z=_.length-1;_[Z].copy(_[0]),S[Z].copy(S[0])}this._applyPathModifiers(S,C,T);let{bevel:O,bevelSides:I}=this.inputs.parameters.extrusion,D=O>0?this.inputs.parameters.extrusion.capType:"flat",z=5;this.inputs.parameters.extrusion.shape.type==="Custom"&&(z=this.inputs.parameters.extrusion.shape.shapeQuality==="low"?5:12);let{regions:k,infos:L,vertices:R}=this._computeShapePoints(z),F=0,B;D==="round"&&(B=new kl(this.inputs.shapeData,2*O,O,z,I,void 0,!0),F=B.getAttribute("position").count);let N=0,j=0;L.sort((Z,U)=>Z.start-U.start),L.forEach(Z=>{Z.verticesStart=N,Z.verticesCount=Z.continuous.reduce((U,W,H)=>U+(H===0||!W?2:1),0),j+=Z.verticesCount,N=j});let G=j*b,Y,X=0;if(this._isOpenEnded()&&D==="flat"){try{Y=Xs({windingRule:Wt.ODD,elementType:Xr.POLYGONS,polySize:3,vertexSize:2,strict:!0,contours:k})}catch{Y=YA}X=Y.vertexCount}let $=G+2*X+F*2,te=G+2*X,ee={positions:new Float32Array($*3),normals:new Float32Array($*3),uvs:new Float32Array($*2)},q=[];if(L.forEach(Z=>{this._extrudeRegion(Z,R,S,_,ee,q,this._isGeometryClosed()&&!this._isOpenEnded())}),Y&&(this._closeEnd(Y,G,q,ee,S[0],_[0],!1),this._closeEnd(Y,G+X,q,ee,S[S.length-1],_[_.length-1],!0)),B){ee.positions.set(B.getAttribute("position").array,te*3),ee.normals.set(B.getAttribute("normal").array,te*3),ee.uvs.set(B.getAttribute("uv").array,te*2);for(let H=te;H<te+F;H++)ee.uvs[H*2+1]=1e-4;let Z=q.length;q.push(...B.getIndex().array.map(H=>H+te)),te+=F,ee.positions.set(B.getAttribute("position").array,te*3),ee.normals.set(B.getAttribute("normal").array,te*3),ee.uvs.set(B.getAttribute("uv").array,te*2);let U=q.length;q.push(...B.getIndex().array.map(H=>H+te)),this.setAttribute("position",new Ge(ee.positions,3)),this.setAttribute("normal",new Ge(ee.normals,3)),this.setAttribute("uv",new Ge(ee.uvs,2)),this.setIndex(q);let W=VX;W.copy(S[S.length-1]).setPosition(_[_.length-1]),this.applyMatrix4OnRange(W,te,$),W.copy(S[0]).setPosition(_[0]).multiply(UX.makeScale(1,1,-1)),this.applyMatrix4OnRange(W,te-F,te),this.reverseIndicesOnRange(Z,U)}else this.setAttribute("position",new Ge(ee.positions,3)),this.setAttribute("normal",new Ge(ee.normals,3)),this.setAttribute("uv",new Ge(ee.uvs,2)),this.setIndex(q)}_extractPathPoints(){let r=B0(this.inputs.path).getPoints(this.inputs.path.subdivisions);if(r.length<2)return[];let a=[r[0]];return r.forEach(n=>{a[a.length-1].distanceToSquared(n)>.001&&a.push(n)}),this.inputs.path.isClosed&&a[a.length-1].distanceTo(a[0])<.001&&a.pop(),a}_computeBasisMatrices(r){let a=[],n=r.length,o=this.inputs.path.isClosed,f=new E,y=new E,x=new E,b=new E,_=new E(0,1,0);for(let M=0;M<n;M++){let O=r[M],I;M===0?I=o?r[r.length-2]:O.clone().multiplyScalar(2).sub(r[1]):I=r[M-1];let D;M===n-1?D=o?r[1]:O.clone().multiplyScalar(2).sub(r[M-1]):D=r[M+1];let z=O.clone().sub(I).normalize(),k=D.clone().sub(O).normalize(),L=z.clone().add(k).normalize();x.copy(L),M===0&&(L.equals(_)||L.clone().negate().equals(_))&&_.set(0,0,1);let R=_.clone().cross(L).normalize(),F=L.clone().cross(R).normalize();_.copy(F),b.copy(R),M===0&&(f.copy(F),y.copy(L));let B=new ue().makeBasis(R,F,L);a.push(B)}let S=o?y:x,A=o?f:new E(0,1,0),C=S.clone().cross(b).normalize(),P=Math.acos(A.dot(C));if(isNaN(P))return a;let T=A.clone().cross(C);S.dot(T)>0&&(P*=-1);for(let M=1;M<a.length;M++){let O=new ue().makeRotationZ(P*M/a.length);a[M].multiply(O)}return a}_applyPathModifiers(r,a,n){let o=r.length,{angle:f,twist:y,startScale:x,endScale:b}=this.inputs.parameters.extrusion,_=new ue,S=new ue;return r.forEach((A,C)=>{let P=C===0?0:C===o-1?1:(C-a)/(o-(n===0?0:1)-(a+(1-n)));_.makeRotationZ(we.lerp(f,f+y,P)*we.DEG2RAD);let T=we.lerp(x,b,P);S.makeScale(T,T,T),A.multiply(_).multiply(S)}),r}_computeShapePoints(r=12,a=Wt.ODD){let n=this.inputs.shapeData,o=n.extractShapePointsToFlatArray([],r),f=n.shapeHoles.map(S=>{let A=S.extractShapePointsToFlatArray([],r),C=[];for(let P=A.length-1;P>=1;P-=2){let T=A[P-1],M=A[P-0];C.push(T,M)}return C}),y;try{y=Xs({windingRule:a,elementType:Xr.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[o]})}catch{y=Sm}let x;try{x=Xs({windingRule:Wt.ODD,elementType:Xr.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...f]})}catch{x=XA}if(!y)throw new Error("error generating geometry");let b=y.elementCount;if(x){y.elementCount+=x.elementCount;for(let S=0;S<x.elements.length;S++){let A=x.elements[S],C=S%2===0?y.vertexCount:0;y.elements.push(A+C)}for(let S=0;S<x.vertexIndices.length;S++){let A=x.vertexIndices[S],C=y.vertexCount;y.vertexIndices.push(A+C)}for(let S=0;S<x.vertices.length;S++){let A=x.vertices[S];y.vertices.push(A)}}for(let S=0,A=y.vertexCount;S<A;S++){let C=S*2;y.vertices[C+0],y.vertices[C+1]}let _=[];for(let S=y.elementCount-1;S>=0;S--){let A=S>=b,C=S*2,P=y.elements[C+0],T=y.elements[C+1],M=P+T,O={start:P,count:T,normals:[],isHole:A,continuous:[],verticesStart:0,verticesCount:0};_.push(O);let I=P,D=M-1,z=P+1,k=n.roundedCurves.length;do{let L=I-P;y.vertices[D*2+0],y.vertices[D*2+1];let R=y.vertices[I*2+0],F=y.vertices[I*2+1],B=y.vertices[z*2+0],N=y.vertices[z*2+1],j=R-B,G=F-N,Y=Math.sqrt(j*j+G*G);j/=Y,G/=Y,O.normals[L*2+0]=-G,O.normals[L*2+1]=j;let X=y.vertexIndices[I];if(Array.isArray(X))O.continuous[L]=!1;else{let[$,te]=n.getCurveIndexFromVertexId(X-1,!0);if(te>0&&te<1)O.continuous[L]=!0;else{let ee=te===1?$+1:$-1;ee=(ee+k)%k;let q=te===1?0:1,Z=n.roundedCurves[$].getTangent(te),U=n.roundedCurves[ee].getTangent(q);O.continuous[L]=Z.dot(U)>.95}}A&&(O.normals[L*2+0]*=-1,O.normals[L*2+1]*=-1),[D,I,z]=[I,z,z+1],z>=M&&(z-=T)}while(z!==P+1)}return{regions:[o,...f],infos:_,vertices:y.vertices}}_insertVertex(r,a,n,o,f){let y=a*2,x=a*3;r.positions[x+0]=n.x,r.positions[x+1]=n.y,r.positions[x+2]=n.z,r.normals[x+0]=o.x,r.normals[x+1]=o.y,r.normals[x+2]=o.z,r.uvs[y+0]=f.x,r.uvs[y+1]=f.y}_extrudeRegion(r,a,n,o,f,y,x){let b=new E,_=new E,S=new E,A=new E,C=new V;n.forEach((T,M)=>{let O=o[M],I=r.verticesStart*n.length+r.verticesCount*M;for(let D=0;D<r.count;D++){let z=(r.start+D)*2;if(b.set(a[z+0],a[z+1],0),S.copy(b).applyMatrix4(T).add(O),r.continuous[D])A.set(r.normals[D*2+0],r.normals[D*2+1],0);else{let k=D===0?(r.start+r.count-1)*2:z-2;_.set(a[k+0],a[k+1],0),A.copy(b).sub(_),A.set(-A.y,A.x,0),r.isHole||A.negate()}if(A.applyMatrix4(T).normalize(),C.set(D===0?1:D/r.count,M/(n.length-1)),this._insertVertex(f,I,S,A,C),I++,!r.continuous[D]||D===0){if(D===0)A.set(r.normals[D*2+0],r.normals[D*2+1],0),C.set(0,M/(n.length-1));else{let k=D===r.count-1?r.start*2:z+2;_.set(a[k+0],a[k+1],0),A.copy(_).sub(b),A.set(-A.y,A.x,0),r.isHole||A.negate()}A.applyMatrix4(T).normalize(),this._insertVertex(f,I,S,A,C),I++}}});let P=n.length-1;for(let T=0;T<P;T++){let M=r.verticesStart*n.length+r.verticesCount*T,O=r.verticesStart*n.length+r.verticesCount*(T+1),I=0;for(let D=0;D<r.count;D++){(!r.continuous[D]||D===0)&&I++;let z=D===r.count-1?0:I+1,k=M+I,L=M+z,R=O+z,F=O+I;r.isHole?y.push(k,R,L,k,F,R):y.push(k,L,R,k,R,F),I++}}}_closeEnd(r,a,n,o,f,y,x){let b=r.vertexCount,_=new E(0,0,x?-1:1).applyMatrix4(f),S=new E,A=new V;for(let P=0;P<b;P++){let T=2*P;S.set(r.vertices[T+0],r.vertices[T+1],0).applyMatrix4(f).add(y),this._insertVertex(o,a+P,S,_,A)}let C=r.elements;for(let P=0;P<r.elementCount;P++){let T=3*P,M=C[T+0]+a,O=C[T+(x?1:2)]+a,I=C[T+(x?2:1)]+a;n.push(M,O,I)}}applyMatrix4OnRange(r,a,n){let o=r.elements,f=new mr().getNormalMatrix(r).elements,y,x,b,_,S=this.attributes.position,A=this.attributes.normal;if(!S||!A)return;let C=S.array,P=A.array,T=S.itemSize;for(let M=a*T,O=n*T;M<O;M+=T){if(M===a)debugger;y=C[M+0],x=C[M+1],b=C[M+2],_=1/(o[3]*y+o[7]*x+o[11]*b+o[15]),C[M+0]=(o[0]*y+o[4]*x+o[8]*b+o[12])*_,C[M+1]=(o[1]*y+o[5]*x+o[9]*b+o[13])*_,C[M+2]=(o[2]*y+o[6]*x+o[10]*b+o[14])*_,y=P[M+0],x=P[M+1],b=P[M+2],P[M+0]=f[0]*y+f[3]*x+f[6]*b,P[M+1]=f[1]*y+f[4]*x+f[7]*b,P[M+2]=f[2]*y+f[5]*x+f[8]*b}S.needsUpdate=!0,A.needsUpdate=!0}reverseIndicesOnRange(r,a){let n=this.index;if(n){for(let o=r;o<a;o+=3){let f=n.getX(o),y=n.getX(o+1),x=n.getX(o+2);n.setXYZ(o,x,y,f)}n.needsUpdate=!0}}};function fR(){let r=new Ce;return r.setAttribute("position",new Ge(new Float32Array([]),3)),r.setIndex(new Ge(new Uint16Array([]),1)),r}var GX=fR().attributes,jX=12,HX=1,Yc=class extends Ce{constructor(r,a){super(),this.charWidths=[],this.charCoords=[],this.wrappedText=[],this.isLowResolution=!1,this.vectorShapes=[],Object.assign(this.attributes,GX),this.userData={parameters:r,type:"TextGeometry"};let n=a.getFont(r.font);n!=null&&n.isLoaded?(this.font=n,this.update(r,a)):this.updateFont(r.font,a).then(()=>{this.update(r,a),a==null||a.requestRender()})}async updateFont(r,a){let n=a.getFont(r);n&&(this.font=n,await n.loadingPromise)}update(r,a){let n=this.font;if(this.userData={parameters:r,type:"TextGeometry"},!(n!=null&&n.isLoaded)){console.warn("Cannot update text because its font is not loaded");return}let{width:o,height:f,depth:y,extrudeBevelSize:x,extrudeBevelSegments:b,text:_,textTransform:S}=r,A=Ur.getDisplayedValue(_),C=S===2?A.toUpperCase():S===3?A.toLowerCase():A,P=WX(r,n,C,a),{shapes:T,charWidths:M,charCoords:O}=n.generateShapes(P,r,a),I=(typeof o=="number"?o:Number(a.getVariable(o)))*.5,D=(typeof f=="number"?f:Number(a.getVariable(f)))*.5,z=T.map(R=>new Qt().fromShape(R,!0));this.vectorShapes=z;let k=z.map(R=>Bn.create({shape:R,parameters:{depth:y,extrudeBevelSegments:b,extrudeBevelSize:x,windingRule:y<=0?Wt.NONZERO:Wt.ODD,subdivisions:this.isLowResolution&&y>0?HX:jX}})),L=k.length?js(k):fR();L.translate(-I,D,0),this.dispose(),this.wrappedText=P,this.charCoords=O,this.charWidths=M,this.deleteAttribute("extrudeNormal"),Object.entries(L.attributes).forEach(([R,F])=>{this.setAttribute(R,F)}),this.setIndex(L.index),this.computeBoundingSphere()}clone(){let r=Xi(new Ce,Yc.prototype);return r.copy(this),console.log("CloneGeometry",this,r),r}copy(r){return Object.entries(r.attributes).forEach(([a,n])=>{this.setAttribute(a,n)}),this.setIndex(r.index),this.userData={parameters:{...r.userData.parameters},type:"TextGeometry"},this}async setText(r,a){this.font&&await this.font.loadingPromise,await this.update({...this.userData.parameters,text:{textValue:r}},a)}get text(){return this.userData.parameters.text??""}};function WX(r,a,n,o){let f=typeof r.width=="string"?Number(o.getVariable(r.width)):r.width,y=[""],x="";for(let b of n)x+=b,b===" "||b===`
`?(y[y.length-1]+=x,x="",b===`
`&&y.push("")):a.getTextWidth(y[y.length-1]+x,r)>f&&(y[y.length-1].length&&y.push(""),a.getTextWidth(y[y.length-1]+x,r)>f&&(x.length===1?(y[y.length-1]+=x,x=""):(y[y.length-1]+=x.slice(0,-1),x=x[x.length-1],y.push(""))));return y[y.length-1]+=x,y}var Z0=new Promise(r=>{}),qX=["font"];function Ba(r,a,n,o){var S,A;let f,y,x;r.type==="PathGeometry"?(y=JSON.parse(JSON.stringify(r)),x=[[],["extrusion"]]):(y={...r},x=[[]]);for(let C of x){let P=y;for(let T of C)P=P[T];for(f in P){let T=P[f];jw(T)&&!qX.includes(f)&&(P[f]=a.getVariable(T,[o.uuid,"geometry",...C,f]),jw(P[f])&&(P[f]=1))}}let b={parameters:y,type:y.type};if(y.type==="PathGeometry")b.path=y.path;else if(y.type==="VectorGeometry"){let C=Qt.createFromState(y.shape,y.width,y.height);b.shape=C}else if(y.type==="NonParametricGeometry"){if(y.data.groups&&((S=y.data.groups)==null||S.forEach(C=>C.materialIndex=Math.max(C.materialIndex??0,0))),b.geometry=new nh().parse(y),b.geometry.groups.length===0){let C=b.geometry;C.addGroup(0,Math.max(((A=C.getIndex())==null?void 0:A.count)??0,C.getAttribute("position").count),0)}}else if(y.type==="SubdivGeometry"){let C=new oi(y,n);return C.data=r,C}else{if(y.type==="TextGeometry")return new Yc(y,a);if(y.type==="InputGeometry")return new Yc(y,a);if(y.type==="UIGeometry")return Ld.create({parameters:{width:y.width,height:y.height,cornerRadius:y.cornerRadius,cornerType:y.cornerType}})}let _;try{_=oE(b)}catch(C){console.error(C)}if(!_){let C=Qt.createFromState(Kh.defaultData(),100,100);b.shape=C,_=oE(b)}return _}var XX=new ue;function Mm(r,a,n,o){let f=r.position.array,y=r.normal.array,x=XX.makeScale(a,n,o).invert().elements,b,_,S;for(var A=0,C=f.length;A<C;A+=3)f[A]*=a,f[A+1]*=n,f[A+2]*=o,b=y[A],_=y[A+1],S=y[A+2],y[A]=x[0]*b+x[4]*_+x[8]*S,y[A+1]=x[1]*b+x[5]*_+x[9]*S,y[A+2]=x[2]*b+x[6]*_+x[10]*S;r.position.needsUpdate=!0,r.normal.needsUpdate=!0}var J0=new Xt,Nd=new E,ut;Z0.then(r=>{ut=r});var yR=new Float32Array([10,10,0,-10,10,0,-10,-10,0,10,-10,0]),vR=new Uint32Array([0,1,2,3]),xR=new Uint8Array([4]),oi=class extends Ce{constructor(r,a){super(),this.data=r,this.flatShading=a,this.subdivPointer=0,this.rebuild(),this.freeSubdivPointer()}mutateDirectlyScaleBaked(r,a){this.freeSubdivPointer();let n=this.data.scaleBaked,o=Co.div(a,n);this.subdividedGeometry&&Mm(this.subdividedGeometry.attributes,...o),this.originalGeometry&&Mm(this.originalGeometry.attributes,...o),this.data=r;let f=this.userData.parameters;this.userData.parameters={width:f.width*o[0],height:f.height*o[1],depth:f.depth*o[2]},this.originalGeometry.boundingSphere.center.multiply(Nd.fromArray(o));let y=Nd.set(f.width,f.height,f.depth).length();this.originalGeometry.boundingSphere.radius=y/2}ensureSubdivPointer(){return this.subdivPointer===0&&this.rebuild(),this.subdivPointer}rebuild(){let r,a,n;try{({originalGeometry:r,subdividedGeometry:a,subdivPointer:n}=oi.build(this.data,void 0,!this.flatShading,void 0))}catch{r=new yi(100,100,100),n=0}this.subdivPointer=n,this.originalGeometry=r,this.subdividedGeometry=a??void 0;let o=this.subdividedGeometry??this.originalGeometry;Object.assign(this,o),this.calcBoundingBox()}freeSubdivPointer(){this.subdivPointer&&(oi.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0)}dispose(){super.dispose(),this.freeSubdivPointer()}calcBoundingBox(){let r=this.originalGeometry;r.boundingSphere===null&&(r.boundingSphere=new Nr,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=r.boundingSphere));let a=r.attributes.position,n=r.boundingSphere.center;J0.setFromBufferAttribute(a),J0.getCenter(n),r.boundingSphere.radius=n.distanceTo(J0.max),isNaN(r.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),J0.getSize(Nd);let o={width:Nd.x,height:Nd.y,depth:Nd.z};return this.userData.parameters=o,o}static build(r,a,n,o){let f,y,x,b=(r==null?void 0:r.phongAngle)??35;n===!1&&(b=-1),a&&(ut.free_bvh(a),ut.free_subdivision_surface(a));try{f=oi.allocate(r,o)}catch(_){console.error(_,r),f=oi.allocate({positionWASM:yR,indexWASM:vR,verticesPerFaceWASM:xR},o)}if(ut.set_destination_refinement_level(f,0),y=oi.buildLevel(f,!0,b),r.subdivisions>0)try{ut.set_destination_refinement_level(f,r.subdivisions),x=oi.buildLevel(f,!1,b)}catch{try{ut.set_destination_refinement_level(f,r.subdivisions-1),x=oi.buildLevel(f,!1,b)}catch{x=null}}else x=null;return{subdivPointer:f,originalGeometry:y,subdividedGeometry:x}}static primitiveToQuads(r,a,n){r.widthSegments>16&&(r.widthSegments=16),r.heightSegments>16&&(r.heightSegments=16),r.depthSegments>16&&(r.depthSegments=16),r.radialSegments>16&&(r.radialSegments=16),r.type==="DodecahedronGeometry"&&(r.detail=0);let o=r.shape!==void 0||r.path!==void 0?a.geometry:Ba(r,n,!1),f;r.type==="TorusGeometry"&&r.arc===Math.PI*2?f=o.getClosedTorusIndicesForBooleanOrSubdiv():f=o.getIndex();let y,x,b,_;({positions:y,triIndices:_}=Kc(o.getAttribute("position"),f));let S;if(r.type==="CylinderGeometry"&&r.cornerRadius===0&&r.hollow===0&&r.openEnded===!1){let A=r.radialSegments*r.heightSegments*3*2,C=A+r.radialSegments*3;S=[A,C]}return{indices:x,verticesPerFace:b}=uE(y,_,o,S),{positions:y,indices:x,verticesPerFace:b}}static allocate(r,a){var k;let n,o,f,y=[],x=[];r.positionWASM&&r.positionWASM.length>0?(n=r.positionWASM,o=r.indexWASM,f=r.verticesPerFaceWASM):(n=yR,o=vR,f=xR);let b=n.length,_=o.length,S=f.length,A=n.length+y.length+x.length,C=o.length+f.length,P=A*Float32Array.BYTES_PER_ELEMENT+C*Uint32Array.BYTES_PER_ELEMENT,T=A*Float32Array.BYTES_PER_ELEMENT,M=ut._malloc(P),O=new Float32Array(ut.HEAPF32.buffer,M,A),I=new Uint32Array(ut.HEAPU32.buffer,M+T,C);O.set(n,0),O.set(y,n.length),O.set(x,n.length+y.length),I.set(o,0),I.set(f,o.length);let D;(k=r==null?void 0:r.scaleBaked)!=null&&k.some(L=>L!==1)&&(D=new ue().makeScale(...r.scaleBaked)),a&&(D?D.premultiply(a):D=a);let z=D?ut.alloc_subdivision_surface2(M,b,M+T,_,M+T+o.length*Uint32Array.BYTES_PER_ELEMENT,S,D.elements):ut.alloc_subdivision_surface(M,b,M+T,_,M+T+o.length*Uint32Array.BYTES_PER_ELEMENT,S);return ut._free(M),z}static buildLevel(r,a,n,o,f){let y=f?ut.get_mesh_data2(r,a?ut.Level.CONTROL:ut.Level.REFINED,n,f.elements):ut.get_mesh_data(r,a?ut.Level.CONTROL:ut.Level.REFINED,n),x=8,b=ut.HEAPU32.subarray(y>>2,(y>>2)+x),_=b.subarray(4,8),S=0,A=ut.HEAPU32[b[S]>>2],C=ut.HEAPF32.subarray(A>>2,(A>>2)+_[S]);S++;let P=ut.HEAPU32[b[S]>>2],T=ut.HEAPF32.subarray(P>>2,(P>>2)+_[S]);S++;let M=ut.HEAPU32[b[S]>>2],O=ut.HEAPU32.subarray(M>>2,(M>>2)+_[S]);S++;let I=ut.HEAPU32[b[S]>>2],D=ut.HEAPU32.subarray(I>>2,(I>>2)+_[S]);if(S++,o===void 0){let z=new Ce;if(z.setIndex(new mo(D,1)),z.setAttribute("position",new Te(C,3)),z.setAttribute("normal",new Te(T,3)),a){z.setAttribute("faceMap",new mo(O,1));let k=new Float32Array(T.length/3*4).fill(0);z.setAttribute("color",new Ge(k,4))}return ut.free_mesh_data(y),z.userData.type="SubdivGeometry",z}o.getAttribute("position").copyArray(C),o.getAttribute("normal").copyArray(T),o.attributes.position.needsUpdate=!0,o.attributes.normal.needsUpdate=!0,ut.free_mesh_data(y)}static freeSubdivPointer(r){ut.free_bvh(r),ut.free_subdivision_surface(r)}static buildControlCageWireframe(r,a,n){let o=ut.get_wireframe_data_for_base_level(r),f=4,y=ut.HEAPU32.subarray(o>>2,(o>>2)+f),x=y.subarray(2,4),b=0,_=ut.HEAPU32[y[b]>>2],S=ut.HEAPF32.subarray(_>>2,(_>>2)+x[b]);b++;let A=ut.HEAPU32[y[b]>>2],C=ut.HEAPU32.subarray(A>>2,(A>>2)+x[b]);if(a===void 0){let P=new Ce;P.setAttribute("position",new Te(S,3));let T=new Float32Array(S.length);for(let M=0,O=S.length;M<O;)T[M++]=n.r,T[M++]=n.g,T[M++]=n.b;return P.setAttribute("color",new Ge(T,3)),P.setIndex(new mo(C,1)),ut.free_wireframe_data_for_base_level(o),P}a.getAttribute("position").copyArray(S),a.attributes.position.needsUpdate=!0,ut.free_wireframe_data_for_base_level(o)}static updateCollabMesh(r,a,n){let o=a===0;o||ut.set_destination_refinement_level(r,a);let f=n?ut.get_topological_data2(r,o?ut.Level.CONTROL:ut.Level.REFINED,n.elements):ut.get_topological_data(r,o?ut.Level.CONTROL:ut.Level.REFINED),y=6,x=ut.HEAPU32.subarray(f>>2,(f>>2)+y),b=x.subarray(3,6),_=0,S=ut.HEAPU32[x[_]>>2],A=new Float32Array(ut.HEAPF32.subarray(S>>2,(S>>2)+b[_]));_++;let C=ut.HEAPU32[x[_]>>2],P=new Uint32Array(ut.HEAPU32.subarray(C>>2,(C>>2)+b[_]));_++;let T=ut.HEAPU32[x[_]>>2],M=new Uint8Array(ut.HEAPU32.subarray(T>>2,(T>>2)+b[_]));return ut.free_topological_data(f),{positions:A,indices:P,verticesPerFace:M}}},bR=["getX","getY","getZ"];function Kc(r,a){let n={},o=a?a.count:r.count,f=0,y=[],x=[],b=1e4;for(let S=0;S<o;S++){let A=a?a.getX(S):S,C="";for(let P=0;P<3;P++)C+=`${~~(r[bR[P]](A)*b)},`;if(C in n)y.push(n[C]);else{for(let P=0;P<3;P++)x.push(r[bR[P]](A));n[C]=f,y.push(f),f++}}let _=[];for(let S=0;S<y.length;S+=3)y[S]===y[S+1]||y[S]===y[S+2]||y[S+1]===y[S+2]||_.push(y[S],y[S+1],y[S+2]);return{positions:x,triIndices:_}}var $0=new E,aE=new E,lE=new E,cE=new E;function uE(r,a,n,o){let f=[],y=[];if(n.userData.shape!==void 0&&n.userData.parameters.depth===0&&n.userData.shape.shapeHoles.length===0){let _=n.userData.shape.extractShapePointsToFlatArray([]),S=n.userData.parameters.spikes;if(n.userData.type==="EllipseGeometry"&&S<=24&&S%4===0&&n.userData.parameters.angle>=360){let P=_.length/2/S;_=_.filter((T,M)=>Math.floor(M/2)%P===0)}let A=0;for(let P=0;P<_.length;P+=2)A+=(_[P]-_[(P===0?_.length:P)-2])*(_[P+1]+_[(P===0?_.length:P)-1]);r.length=0;let C=0;if(A<0)for(let P=0;P<_.length;P+=2)r.push(_[P],_[P+1],0),f.push(C++);else for(let P=_.length-2;P>=0;P-=2)r.push(_[P],_[P+1],0),f.push(C++);return y.push(C),{indices:f,verticesPerFace:y}}let x=new Float32Array([n.userData.parameters.depth])[0],b=0;for(;b<a.length;){if(n.useNgonForTopBottomFaceDuringBake){let _=0;if((r[a[b]*3+2]===x||r[a[b]*3+2]===0)&&_++,(r[a[b+1]*3+2]===x||r[a[b+1]*3+2]===0)&&_++,(r[a[b+2]*3+2]===x||r[a[b+2]*3+2]===0)&&_++,_===3)break}if(a[b+1]===a[b+3]&&a[b+2]===a[b+5]||a[b+0]===a[b+3]&&a[b+2]===a[b+4]){$0.set(r[a[b]*3],r[a[b]*3+1],r[a[b]*3+2]),aE.set(r[a[b+1]*3],r[a[b+1]*3+1],r[a[b+1]*3+2]),lE.set(r[a[b+4]*3],r[a[b+4]*3+1],r[a[b+4]*3+2]),cE.set(r[a[b+5]*3],r[a[b+5]*3+1],r[a[b+5]*3+2]),aE.sub($0).normalize(),lE.sub($0).normalize(),cE.sub($0).normalize();let _=aE.cross(lE).dot(cE);Math.abs(_)>.005||o&&o.some((S,A)=>A%2===1?!1:b>=o[A]&&b<o[A+1])?(f.push(a[b],a[b+1],a[b+2]),y.push(3),b+=3):(f.push(a[b],a[b+1],a[b+4],a[b+5]),y.push(4),b+=6)}else f.push(a[b],a[b+1],a[b+2]),y.push(3),b+=3}if(n.useNgonForTopBottomFaceDuringBake){let _=[],S=[],A=0;for(let C=0,P=0;C<r.length;C+=3,P++)r[C+2]===0&&(_.push(P),A++),r[C+2]===x&&S.push(P);if(n.userData.parameters.extrudeBevelSize===0){let C=S[0];S[0]=S[1],S[1]=C}_.reverse(),f.push(..._,...S),y.push(A,A)}return{indices:f,verticesPerFace:y}}var vs={};UF(vs,{calcBoolean:()=>QX,calcBooleanTopological:()=>KX,freeMeshSet:()=>eY,getMeshSet:()=>ZX,hasOpenEdges:()=>JX,transformMeshSet:()=>$X});var wR=new Promise(r=>{}),Ut,Fd;wR.then(r=>Ut=r);function YX(r,a,n){let o,f;r.userData.parameters.type==="TorusGeometry"&&r.userData.parameters.arc===Math.PI*2?f=r.getClosedTorusIndicesForBooleanOrSubdiv():f=r.getIndex();let{positions:y,triIndices:x}=Kc(r.getAttribute("position"),f),b;if(a&&n){let{indices:_,verticesPerFace:S}=uE(y,x,r);b=S.length,o=[];for(let A=0,C=0;A<b;A++){o.push(S[A]);for(let P=0;P<S[A];P++)o.push(_[C++])}}else{let _=x.length;o=Array(_+_/3),b=0;for(let S=0,A=0;A<o.length;)o[A++]=3,b++,o[A++]=x[S++],o[A++]=x[S++],o[A++]=x[S++]}return{positions:y,faceIndices:o,nFaces:b}}function ER(r){let a=r.length,n=a*Uint32Array.BYTES_PER_ELEMENT,o=a*Float32Array.BYTES_PER_ELEMENT,f=Number.isInteger(r[0])?n:o,y=Ut._malloc(f);return(Number.isInteger(r[0])?new Uint32Array(Ut.HEAPU32.buffer,y,a):new Float32Array(Ut.HEAPF32.buffer,y,a)).set(r,0),y}function TR(r){switch(r){case 0:return Ut.OP.UNION;case 1:return Ut.OP.INTERSECTION;case 2:return Ut.OP.A_MINUS_B;default:throw new Error("Unknown boolean operation "+r)}}function KX(r,a){Fd===void 0&&(Fd=Ut.init_csg());let n=ER(r),o=Ut.csg_calc_topological(Fd,n,r.length,TR(a));Ut._free(n);let f=6,y=Ut.HEAPU32.subarray(o>>2,(o>>2)+f),x=y.subarray(3,6),b=0,_=Ut.HEAPU32[y[b]>>2],S=new Float32Array(Ut.HEAPF32.subarray(_>>2,(_>>2)+x[b]));b++;let A=Ut.HEAPU32[y[b]>>2],C=new Uint32Array(Ut.HEAPU32.subarray(A>>2,(A>>2)+x[b]));b++;let P=Ut.HEAPU32[y[b]>>2],T=new Uint8Array(Ut.HEAPU32.subarray(P>>2,(P>>2)+x[b]));return Ut.free_mesh_data(o),{positions:S,indices:C,verticesPerFace:T}}function QX(r,a,n,o){Fd===void 0&&(Fd=Ut.init_csg());let f=ER(r),y=Ut.csg_calc(Fd,f,r.length,o,TR(a));Ut._free(f);let x=5,b=Ut.HEAPU32.subarray(y>>2,(y>>2)+x),_=b.subarray(2,5),S=0,A=Ut.HEAPU32[b[S]>>2],C=Ut.HEAPF32.subarray(A>>2,(A>>2)+_[S]);S++;let P=Ut.HEAPU32[b[S]>>2],T=Ut.HEAPF32.subarray(P>>2,(P>>2)+_[S]);S++;let M=_[S];n.setAttribute("position",new Te(C,3)),n.setAttribute("normal",new Te(T,3));let O=Ut.HEAPF32.subarray((y>>2)+5,(y>>2)+5+6);return n.boundingSphere===null&&(n.boundingSphere=new Nr),n.boundingSphere.center.set(O[0],O[1],O[2]),n.boundingSphere.radius=(O[3]**2+O[4]**2+O[5]**2)**.5,n.userData.parameters={width:O[3]*2,height:O[4]*2,depth:O[5]*2},Ut.free_mesh_data(y),M}function ZX(r,a,n){if(Ut===void 0)return-1;let o,f,y;if(a&&r.userData.positions!==void 0){let I=r.userData;y=I.verticesPerFace.length,o=I.positions,f=Array(I.verticesPerFace.reduce((D,z)=>D+z,0)+y);for(let D=0,z=0,k=0;D<I.verticesPerFace.length;D++){f[k++]=I.verticesPerFace[D];for(let L=0;L<I.verticesPerFace[D];L++)f[k++]=I.indices[z++]}}else({positions:o,faceIndices:f,nFaces:y}=YX(r,a,n));let x=o.length,b=f.length,_=o.length,S=f.length,A=_*Float32Array.BYTES_PER_ELEMENT+S*Uint32Array.BYTES_PER_ELEMENT,C=_*Float32Array.BYTES_PER_ELEMENT,P=Ut._malloc(A),T=new Float32Array(Ut.HEAPF32.buffer,P,_),M=new Uint32Array(Ut.HEAPU32.buffer,P+C,S);T.set(o,0),M.set(f,0);let O=Ut.get_csg_mesh(P,x,P+C,b,y);return Ut._free(P),O}function JX(r){return Ut.has_open_edges(r)}function $X(r,a){Ut.transform_csg_mesh(r,a.elements)}function eY(r){Ut.free_csg_mesh(r)}var tY={ConeGeometry:SO,CubeGeometry:wO,CylinderGeometry:N0,DodecahedronGeometry:AO,EllipseGeometry:Dd,HelixGeometry:YO,IcosahedronGeometry:KO,LatheGeometry:QO,NonParametricGeometry:eR,PolygonGeometry:X0,PyramidGeometry:tR,RectangleGeometry:Ld,SphereGeometry:rR,PlaneGeometry:iR,BackdropGeometry:nR,StarGeometry:Y0,TextFrameGeometry:sR,TorusGeometry:oR,TorusKnotGeometry:aR,TriangleGeometry:lR,PathGeometry:dR,VectorGeometry:Bn},oE=r=>tY[r.type].create(r);function Vd(r){return r!==null&&"booleanOp"in r}var Ud=class extends Ad(Et){constructor(){super(...arguments),this.booleanMeshSetAddress=-1,this.booleanWasTransformed=!1,this.booleanMatrixInvOld=new ue}updateVisible(r){super.updateVisible(r),this.visible=!Vd(this.parent)&&this.visible,Vd(this.parent)&&this.parent.invalidateDownstreamBooleanData()}freeBooleanPointer(){this.booleanMeshSetAddress!==-1&&(vs.freeMeshSet(this.booleanMeshSetAddress),this.booleanMeshSetAddress=-1)}invalidateDownstreamBooleanData(r=!1){return r?this.booleanWasTransformed=!0:this.freeBooleanPointer(),Vd(this.parent)?this.parent.invalidateDownstreamBooleanData():this}invalidateUpstreamBooleanData(){this.freeBooleanPointer();for(let r of this.children)r instanceof Ud&&(r.freeBooleanPointer(),Vd(r)&&r.invalidateUpstreamBooleanData())}updateTransformState(r,a){let n=super.updateTransformState(r,a);return n&&Vd(this.parent)&&this.invalidateDownstreamBooleanData(!0),n}onVariableUpdate(r=!1){super.onVariableUpdate(r),Vd(this.parent)&&this.invalidateDownstreamBooleanData(!0)}},tx=new Xt;function Cm(r,a=0,n=r.count,o,f){let y=1/0,x=1/0,b=1/0,_=-1/0,S=-1/0,A=-1/0;for(let C=a;C<n;C++){let P=r.getX(C),T=r.getY(C),M=r.getZ(C);P<y&&(y=P),T<x&&(x=T),M<b&&(b=M),P>_&&(_=P),T>S&&(S=T),M>A&&(A=M)}tx.min.set(y,x,b),tx.max.set(_,S,A),tx.getCenter(o),tx.getSize(f).multiplyScalar(.5)}var rY=new Ce,iY=new an,yr=class extends Ud{constructor(r,a){super(rY,iY),this.super_Entity(r,a)}updateState(r,a){this.updateState_Entity(r,a)}updateEntityBoxSize(r,a){let n=this.geometry.getAttribute("position");n!==void 0?Cm(n,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:n.count,r,a):super.updateEntityBoxSize(r,a)}},Na=class{constructor(r){if(this.hashProperties=void 0,this.isNode=!0,this.shortcuts={},Na.uuidContext===null)throw new Error("plz startContext");Na.uuidContext===Na.globalContext?this.uuid="_gid"+Na.uuidContext.nodeContextUuid++:this.uuid="_uid"+Na.uuidContext.nodeContextUuid++,this.type=r,this.name=""}static startContext(r){this.uuidContext===null||this.uuidContext===Na.globalContext?this.uuidContext=r:console.error("Can't start context twice")}static endContext(r){this.uuidContext!==r&&console.error("Can't end context twice"),this.uuidContext=null}analyze(r,a){a=a??{},r.analyzing=!0,this.build(r.addFlow(a.slot,a.cache,a.context),"v4"),r.clearVertexNodeCode(),r.clearFragmentNodeCode(),r.removeFlow(),r.analyzing=!1}analyzeAndFlow(r,a,n){return n=n??{},this.analyze(r,n),this.flow(r,a,n)}flow(r,a,n){n=n??{},r.addFlow(n.slot,n.cache,n.context);let o={result:this.build(r,a),code:r.clearNodeCode(),extra:r.context.extra};return r.removeFlow(),o}build(r,a,n){a=a??this.getType(r,a);let o=r.getNodeData(n??this);return r.analyzing&&this.appendDepsNode(r,o,a),r.nodes.indexOf(this)===-1&&r.nodes.push(this),this.updateFrame!==void 0&&r.updaters.indexOf(this)===-1&&r.updaters.push(this),this.generate(r,a,n)}updateFrame(r){}generateReadonly(r,a,n,o,f,y){return""}generate(r,a,n,o,f){return""}parse(r,a,n,o){}appendDepsNode(r,a,n){a.deps=(a.deps||0)+1;let o=r.getTypeLength(n);(o>(a.outputMax||0)||this.getType(r,n))&&(a.outputMax=o,a.output=n)}setName(r){this.name=r}getName(){return this.name}getType(r,a){return a==="sampler2D"||a==="samplerCube"?a:this.type}},lr=Na;lr.globalContext={nodeContextUuid:0},lr.uuidContext=Na.globalContext;var Pm=class{constructor(r){r=r??{},this.name=r.name,this.type=r.type,this.node=r.node,this.size=r.size,this.needsUpdate=r.needsUpdate}get value(){return this.node.value}set value(r){this.node.value=r}},hE=class{constructor(){this.nodes={},this.keywords={}}add(r){this.nodes[r.name]=r}addKeyword(r,a,n){n=n!==void 0?n:!0,this.keywords[r]={callback:a,cache:n}}remove(r){delete this.nodes[r.name]}removeKeyword(r){delete this.keywords[r]}get(r){return this.nodes[r]}getKeyword(r,a){return this.keywords[r].callback(a)}getKeywordData(r){return this.keywords[r]}contains(r){return this.nodes[r]!==void 0}containsKeyword(r){return this.keywords[r]!==void 0}},Oi=new hE,rt=class extends lr{constructor(r,a){super(r),this.scope="",a=a??{},this.shared=a.shared!==void 0?a.shared:!0,this.unique=a.unique!==void 0?a.unique:!1}build(r,a,n,o){if(a=a??this.getType(r),this.getShared(r,a)){let f=this.getUnique(r,a);f&&this.uuid===void 0&&(this.uuid=we.generateUUID()),n=r.getUUID(n??this.getUUID(),!f);let y=r.getNodeData(n),x=y.output||this.getType(r);if(r.analyzing)return(y.deps||0)>0||this.getLabel()?(this.appendDepsNode(r,y,a),this.generate(r,a,n)):super.build(r,a,n);if(f)return y.name=y.name||super.build(r,a,n),y.name;if(!this.getLabel()&&(!this.getShared(r,x)||r.context.ignoreCache||y.deps===1))return super.build(r,a,n);n=this.getUUID(!1);let b=this.getTemp(r,n);if(b)return r.format(b,x,a);{b=super.generate(r,a,n,y.output,o);let _=this.generate(r,x,n);return r.addNodeCode(b+" = "+_+";"),r.format(b,x,a)}}return super.build(r,a,n)}getShared(r,a){return a!=="sampler2D"&&a!=="samplerCube"&&this.shared}getUnique(r,a){return this.unique}setLabel(r){return this.label=r,this}getLabel(){return this.label}getUUID(r){let a=this.uuid;return typeof this.scope=="string"&&(a=this.scope+"-"+a),a}getTemp(r,a){a=a||this.uuid;let n=r.getVars()[a];return n?n.name:void 0}generate(r,a,n,o,f){return this.getShared(r,a)||console.error("TempNode is not shared"),n=n??this.uuid,r.getTempVar(n,o??this.getType(r),f,this.getLabel()).name}},cr=class extends rt{constructor(r,a){a=a??{},a.shared=a.shared!==void 0?a.shared:!1,super(r,a),this.readonly=!1}setReadonly(r){return this.readonly=r,this.hashProperties=this.readonly?["value"]:void 0,this}getReadonly(){return this.readonly}generate(r,a,n,o,f,y){n=r.getUUID(n??this.getUUID()),o=o??this.getType(r);let x=r.getNodeData(n);return this.getReadonly()&&this.generateReadonly!==void 0?this.generateReadonly(r,a,n,o,f,y):r.isShader("vertex")?(x.vertex||(x.vertex=r.createVertexUniform(o,this,f,y,this.getLabel())),r.format(x.vertex.name,o,a)):(x.fragment||(x.fragment=r.createFragmentUniform(o,this,f,y,this.getLabel())),r.format(x.fragment.name,o,a))}},Yr=class extends cr{constructor(r=0,a){super("v2"),this.nodeType="Vector2",this.value=r instanceof V?r:new V(r,a)}get x(){return this.value.x}set x(r){this.value.x=r}get y(){return this.value.y}set y(r){this.value.y=r}generateReadonly(r,a,n,o,f,y){return r.format("vec2("+this.value.x+", "+this.value.y+")",o,a)}},Ki=class extends cr{constructor(r=0,a,n){super("v3"),this.nodeType="Vector3",this.value=r instanceof E?r:new E(r,a,n)}get x(){return this.value.x}set x(r){this.value.x=r}get y(){return this.value.y}set y(r){this.value.y=r}get z(){return this.value.z}set z(r){this.value.z=r}generateReadonly(r,a,n,o,f,y){return r.format("vec3("+this.value.x+", "+this.value.y+", "+this.value.z+")",o,a)}},br=class extends qe{constructor(r,a,n,o){super(r,a,n),this.isColorA=!0,this.a=o}setRGBA(r,a,n,o){super.setRGB(r,a,n),this.a=o}copy(r){return super.copy(r),this.a="a"in r?r.a:1,this}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}equals(r){return super.equals(r)&&this.a===r.a}setStyle(r,a="srgb"){let n;if(r==="transparent")return this.setRGBA(0,0,0,0),this;if(n=/^((?:rgb|hsl)a?)\(([^)]*)\)/.exec(r)){let o,f=n[1],y=n[2];switch(f){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(y))return this.a=f==="rgba"?parseFloat(o[4]):1,super.setStyle(r,a);break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)%\s*,\s*(\d*\.?\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(y))return this.a=f==="hsla"?parseFloat(o[4]):1,super.setStyle(r,a);break}}return super.setStyle(r,a)}get x(){return this.r}get y(){return this.g}get z(){return this.b}get w(){return this.a}set x(r){this.r=r}set y(r){this.g=r}set z(r){this.b=r}set w(r){this.a=r}},Nn=class extends cr{constructor(r){super("v4"),this.nodeType="Vector4",this.value=r instanceof br?r:new br(r.r,r.g,r.b,r.a)}generateReadonly(r,a,n,o,f,y){return r.format("vec4("+this.value.r+", "+this.value.g+", "+this.value.b+", "+this.value.a+")",o,a)}},nY=/^\s*([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,MR=/[a-z_0-9]+/gi,Ae=class extends rt{constructor(r,a,n,o,f){super(f),this.src="",this.nodeType="Function",this.useKeywords=!0,this.includes=[],this.extensions={},this.keywords={},this.isMethod=f===void 0,this.isInterface=!1,this.parse(r,a,n,o)}getShared(r,a){return!this.isMethod}getType(r){return r.getTypeByFormat(this.type)}getInputByName(r){if(this.inputs){let a=this.inputs.length;for(;a--;)if(this.inputs[a].name===r)return this.inputs[a]}}getIncludeByName(r){if(this.includes){let a=this.includes.length;for(;a--;)if(this.includes[a].name===r)return this.includes[a]}}generate(r,a,n,o,f){let y,x=0,b=this.src;if(this.includes)for(let S=0;S<this.includes.length;S++)r.include(this.includes[S],this);for(let S in this.extensions)r.extensions[S]=!0;let _=[];for(;y=MR.exec(this.src);)_.push(y);for(let S=0;S<_.length;S++){let A=_[S],C=A[0],P=this.isMethod?!this.getInputByName(C):!0,T=C;if(this.keywords[C]||this.useKeywords&&P&&Oi.containsKeyword(C)){let M=this.keywords[C];if(!M){let O=Oi.getKeywordData(C);O.cache&&(M=r.keywords[C]),M=M||Oi.getKeyword(C,r),O.cache&&(r.keywords[C]=M)}T=M.build(r)}C!==T&&b[A.index+x-1]!=="."&&(b=b.substring(0,A.index+x)+T+b.substring(A.index+C.length+x),x+=T.length-C.length),this.getIncludeByName(T)===void 0&&Oi.contains(T)&&r.include(Oi.get(T))}return a==="source"?b:this.isMethod?(this.isInterface||r.include(this,void 0,b),this.name):r.format("( "+b+" )",this.getType(r),a)}parse(r,a,n,o){if(this.src=r||"",this.includes=a??[],this.extensions=n??{},this.keywords=o??{},this.isMethod){let f=nY.exec(this.src);if(this.inputs=[],f&&f.length==4){this.type=f[1],this.name=f[2];let y=f[3].match(MR);if(y){let x=0;for(;x<y.length;){let b=y[x++],_;b==="in"||b==="out"||b==="inout"?_=y[x++]:(_=b,b="");let S=y[x++];this.inputs.push({name:S,type:_,qualifier:b})}}this.isInterface=this.src.indexOf("{")===-1}else this.type="",this.name=""}}},sY=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i,dE=class extends rt{constructor(r="",a){super(),this.src="",this.useDefine=!1,this.nodeType="Const",this.parse(r||dE.PI,void 0,void 0,void 0,a)}getType(r){return r.getTypeByFormat(this.type)}parse(r,a,n,o,f){this.src=r||"";let y,x,b="",_=sY.exec(r);this.useDefine=f??this.src.charAt(0)==="#",_&&_.length>1?(x=_[1],y=_[2],b=_[3]):(y=this.src,x="f"),this.name=y,this.type=x,this.value=b}build(r,a){if(a==="source"){if(this.value)return this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";";if(this.useDefine)return this.src}return r.include(this),r.format(this.name,this.getType(r),a)}generate(r,a,n,o,f){return r.format(this.name,this.getType(r),a)}},Gt=dE;Gt.PI="PI",Gt.PI2="PI2",Gt.RECIPROCAL_PI="RECIPROCAL_PI",Gt.RECIPROCAL_PI2="RECIPROCAL_PI2",Gt.LOG2="LOG2",Gt.EPSILON="EPSILON";var oY=new RegExp(`^structs*([a-z_0-9]+)s*{s*((.|
)*?)}`,"gim"),aY=new RegExp("s*(w*?)s*(w*?)(=|;)","gim"),zd=class extends rt{constructor(r=""){super(),this.inputs=[],this.src="",this.nodeType="Struct",this.parse(r)}getType(r){return r.getTypeByFormat(this.name)}getInputByName(r){let a=this.inputs.length;for(;a--;)if(this.inputs[a].name===r)return this.inputs[a]}generate(r,a,n,o,f){return a==="source"?this.src+";":r.format("( "+this.src+" )",this.getType(r),a)}parse(r=""){this.src=r,this.inputs=[];let a=oY.exec(r);if(a){let n=a[2],o;for(;o=aY.exec(n);)this.inputs.push({type:o[1],name:o[2]});this.name=a[1]}else this.name="";this.type=this.name}},kd=class extends rt{constructor(r){super("v2",{shared:!1}),this.nodeType="UV",this.index=r??0}generate(r,a){r.requires.uv[this.index]=!0;let n=this.index>0?this.index+1:"",o=r.isShader("vertex")?"uv"+n:"vUv"+n;return r.format(o,this.getType(r),a)}};Oi.addKeyword("uv",function(){return new kd});Oi.addKeyword("uv2",function(){return new kd(1)});var Qc=class extends rt{constructor(r,a){super("v4"),this.nodeType="ColorSpace",this.input=r,this.method=a??Qc.LINEAR_TO_LINEAR,this.hashProperties=["method"]}static getEncodingComponents(r){switch(r){case gn:return["Linear"];case ct:return["sRGB"];default:return[]}}generate(r,a){var x;let n=this.input.build(r,"v4"),o=this.getType(r),f=Qc.Nodes[this.method],y=r.include(f);if(y===Qc.LINEAR_TO_LINEAR)return r.format(n,o,a);if(((x=f.inputs)==null?void 0:x.length)===2){let b=this.factor.build(r,"f");return r.format(y+"( "+n+", "+b+" )",o,a)}else return r.format(y+"( "+n+" )",o,a)}fromEncoding(r){let a=Qc.getEncodingComponents(r);this.method="LinearTo"+a[0],this.factor=a[1]}fromDecoding(r){let a=Qc.getEncodingComponents(r);this.method=a[0]+"ToLinear",this.factor=a[1]}},Sn=Qc;Sn.Nodes={LinearToLinear:new Ae(["vec4 LinearToLinear( in vec4 value ) {","	return value;","}"].join(`
`)),sRGBToLinear:new Ae(["vec4 sRGBToLinear( in vec4 value ) {","	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join(`
`)),LinearTosRGB:new Ae(["vec4 LinearTosRGB( in vec4 value ) {","	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join(`
`))},Sn.LINEAR_TO_LINEAR="LinearToLinear",Sn.SRGB_TO_LINEAR="sRGBToLinear",Sn.LINEAR_TO_SRGB="LinearTosRGB";var Zt=class extends Ae{constructor(r="",a,n,o,f){super(r,f,o,n,a),this.nodeType="Expression"}},wn=class extends cr{constructor(r=new rr,a,n,o){super("v4",{shared:!0}),this.nodeType="Texture",this.value=r,this.uv=a??new kd,this.bias=n,this.project=o!==void 0?o:!1}getTexture(r,a){return super.generate(r,a,this.value.uuid,"t")}generate(r,a){if(a==="sampler2D")return this.getTexture(r,a);let n=this.getTexture(r,a),o=this.uv.build(r,this.project?"v4":"v2"),f=this.bias?this.bias.build(r,"f"):void 0;f===void 0&&r.context.bias&&(f=r.context.bias.setTexture(this).build(r,"f"));let y,x;this.project?y="texture2DProj":y=f?"tex2DBias":"tex2D",f?x=y+"( "+n+", "+o+", "+f+" )":x=y+"( "+n+", "+o+" )";let b={include:r.isShader("vertex"),ignoreCache:!0},_=this.getType(r);return r.addContext(b),this.colorSpace=this.colorSpace??new Sn(new Zt("",_)),this.colorSpace.fromDecoding(r.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(x),x=this.colorSpace.build(r,_),r.removeContext(),r.format(x,_,a)}},Fe=class extends cr{constructor(r){super("f"),this.nodeType="Float",this.value=r??0}generateReadonly(r,a,n,o,f,y){return r.format(this.value+(this.value%1?"":".0"),o,a)}},_m=class extends rt{constructor(r,a){super(),this.inputs=[],this.nodeType="FunctionCall",this.value=r,this.inputs=a??[]}getFunction(){return this.value}getType(r){return this.value.getType(r)}generate(r,a,n,o,f){o=this.getType(r);let y=this.value,x=y.build(r,a)+"( ",b=[];if(y.inputs){for(let _=0;_<y.inputs.length;_++){let S=y.inputs[_],A=this.inputs[_]||this.inputs[S.name];b.push(A.build(r,r.getTypeByFormat(S.type)))}x+=b.join(", ")+" )"}return r.format(x,o,a)}},fE=class extends rt{constructor(r,a,n=fE.ADD){super(),this.nodeType="Operator",this.type=r.type,this.a=r,this.b=a,this.op=n}getType(r){let a=this.a.getType(r),n=this.b.getType(r);return r.isTypeMatrix(a)?"v4":r.getTypeLength(n)>r.getTypeLength(a)?n:a}generate(r,a){let n=this.getType(r);this.type=n;let o=this.a.build(r,n),f=this.b.build(r,n);return r.format("( "+o+" "+this.op+" "+f+" )",n,a)}},ki=fE;ki.ADD="+",ki.SUB="-",ki.MUL="*",ki.DIV="/";var ur=class extends rt{constructor(r,a=ur.ABS,n,o){super(),this.nodeType="Math",this.a=r,typeof a!="string"?this.b=a:o=a,typeof n!="string"?this.c=n:o=n,this.method=o,this.hashProperties=["method"]}getNumInputs(r){switch(this.method){case ur.MIX:case ur.CLAMP:case ur.REFRACT:case ur.SMOOTHSTEP:case ur.FACEFORWARD:return 3;case ur.MIN:case ur.MAX:case ur.MOD:case ur.STEP:case ur.REFLECT:case ur.DISTANCE:case ur.DOT:case ur.CROSS:case ur.POW:return 2;default:return 1}}getInputType(r){let a=r.getTypeLength(this.a.getType(r)),n=this.b?r.getTypeLength(this.b.getType(r)):0,o=this.c?r.getTypeLength(this.c.getType(r)):0;return a>n&&a>o?this.a.getType(r):n>o?this.b.getType(r):this.c.getType(r)}getType(r){switch(this.method){case ur.LENGTH:case ur.DISTANCE:case ur.DOT:return"f";case ur.CROSS:return"v3"}return this.getInputType(r)}generate(r,a){let n,o,f,y=this.a?r.getTypeLength(this.a.getType(r)):0,x=this.b?r.getTypeLength(this.b.getType(r)):0,b=this.c?r.getTypeLength(this.c.getType(r)):0,_=this.getInputType(r),S=this.getType(r);switch(this.type=S,this.method){case ur.NEGATE:return r.format("( -"+this.a.build(r,_)+" )",_,a);case ur.INVERT:return r.format("( 1.0 - "+this.a.build(r,_)+" )",_,a);case ur.CROSS:n=this.a.build(r,"v3"),o=this.b.build(r,"v3");break;case ur.STEP:n=this.a.build(r,y===1?"f":_),o=this.b.build(r,_);break;case ur.MIN:case ur.MAX:case ur.MOD:n=this.a.build(r,_),o=this.b.build(r,x===1?"f":_);break;case ur.REFRACT:n=this.a.build(r,_),o=this.b.build(r,_),f=this.c.build(r,"f");break;case ur.MIX:n=this.a.build(r,_),o=this.b.build(r,_),f=this.c.build(r,b===1?"f":_);break;default:n=this.a.build(r,_),this.b&&(o=this.b.build(r,_)),this.c&&(f=this.c.build(r,_));break}let A=[];A.push(n),o&&A.push(o),f&&A.push(f);let C=this.getNumInputs(r);if(A.length!==C)throw Error(`Arguments not match used in "${this.method}". Require ${C}, currently ${A.length}.`);return r.format(this.method+"( "+A.join(", ")+" )",S,a)}},pt=ur;pt.RAD="radians",pt.DEG="degrees",pt.EXP="exp",pt.EXP2="exp2",pt.LOG="log",pt.LOG2="log2",pt.SQRT="sqrt",pt.INV_SQRT="inversesqrt",pt.FLOOR="floor",pt.CEIL="ceil",pt.NORMALIZE="normalize",pt.FRACT="fract",pt.SATURATE="saturate",pt.SIN="sin",pt.COS="cos",pt.TAN="tan",pt.ASIN="asin",pt.ACOS="acos",pt.ARCTAN="atan",pt.ABS="abs",pt.SIGN="sign",pt.LENGTH="length",pt.NEGATE="negate",pt.INVERT="invert",pt.MIN="min",pt.MAX="max",pt.MOD="mod",pt.STEP="step",pt.REFLECT="reflect",pt.DISTANCE="distance",pt.DOT="dot",pt.CROSS="cross",pt.POW="pow",pt.MIX="mix",pt.CLAMP="clamp",pt.REFRACT="refract",pt.SMOOTHSTEP="smoothstep",pt.FACEFORWARD="faceforward";var Gd=class extends rt{constructor(r,a,n){super("v4"),this.nodeType="TextureCubeUV",this.value=r,this.uv=a,this.bias=n}bilinearCubeUV(r,a,n,o){let f=new _m(Gd.Nodes.bilinearCubeUV,[a,n,o]);this.colorSpaceTL=this.colorSpaceTL??new Sn(new Zt("","v4")),this.colorSpaceTL.fromDecoding(r.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTL.input.parse(f.build(r)+".tl"),this.colorSpaceTR=this.colorSpaceTR??new Sn(new Zt("","v4")),this.colorSpaceTR.fromDecoding(r.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTR.input.parse(f.build(r)+".tr"),this.colorSpaceBL=this.colorSpaceBL??new Sn(new Zt("","v4")),this.colorSpaceBL.fromDecoding(r.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBL.input.parse(f.build(r)+".bl"),this.colorSpaceBR=this.colorSpaceBR??new Sn(new Zt("","v4")),this.colorSpaceBR.fromDecoding(r.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBR.input.parse(f.build(r)+".br");let y={include:r.isShader("vertex"),ignoreCache:!0};r.addContext(y),this.colorSpaceTLExp=new Zt(this.colorSpaceTL.build(r,"v4"),"v4"),this.colorSpaceTRExp=new Zt(this.colorSpaceTR.build(r,"v4"),"v4"),this.colorSpaceBLExp=new Zt(this.colorSpaceBL.build(r,"v4"),"v4"),this.colorSpaceBRExp=new Zt(this.colorSpaceBR.build(r,"v4"),"v4"),r.removeContext();let x=new Zt("mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )","v4");return x.keywords.cubeUV_TL=this.colorSpaceTLExp,x.keywords.cubeUV_TR=this.colorSpaceTRExp,x.keywords.cubeUV_BL=this.colorSpaceBLExp,x.keywords.cubeUV_BR=this.colorSpaceBRExp,x.keywords.cubeUV=f,x}generate(r,a){if(r.isShader("fragment")){let n=this.uv,o=this.bias||r.context.roughness,f=new _m(Gd.Nodes.roughnessToMip,[o]),y=new pt(f,Gd.Nodes.m0,Gd.Nodes.cubeUV_maxMipLevel,pt.CLAMP),x=new pt(y,pt.FLOOR),b=new pt(y,pt.FRACT),_=this.bilinearCubeUV(r,this.value,n,x),S=this.bilinearCubeUV(r,this.value,n,new ki(x,new Fe(1).setReadonly(!0),ki.ADD)),A=new pt(_,S,b,pt.MIX);return r.format(A.build(r),"v4",a)}else return console.warn("TextureCubeUVNode is not compatible with "+r.shader+" shader."),r.format("vec4( 0.0 )",this.getType(r),a)}},jd=Gd;jd.Nodes=function(){let r=new zd(`struct TextureCubeUVData {
			vec4 tl;
			vec4 tr;
			vec4 br;
			vec4 bl;
			vec2 f;
		}`),a=new Gt("float cubeUV_maxMipLevel 8.0",!0),n=new Gt("float cubeUV_minMipLevel 4.0",!0),o=new Gt("float cubeUV_maxTileSize 256.0",!0),f=new Gt("float cubeUV_minTileSize 16.0",!0),y=new Ae(`float getFace(vec3 direction) {
				vec3 absDirection = abs(direction);
				float face = -1.0;
				if (absDirection.x > absDirection.z) {
					if (absDirection.x > absDirection.y)
						face = direction.x > 0.0 ? 0.0 : 3.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				} else {
					if (absDirection.z > absDirection.y)
						face = direction.z > 0.0 ? 2.0 : 5.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				}
				return face;
		}`);y.useKeywords=!1;let x=new Ae(`vec2 getUV(vec3 direction, float face) {
				vec2 uv;
				if (face == 0.0) {
					uv = vec2(direction.z, direction.y) / abs(direction.x); // pos x
				} else if (face == 1.0) {
					uv = vec2(-direction.x, -direction.z) / abs(direction.y); // pos y
				} else if (face == 2.0) {
					uv = vec2(-direction.x, direction.y) / abs(direction.z); // pos z
				} else if (face == 3.0) {
					uv = vec2(-direction.z, direction.y) / abs(direction.x); // neg x
				} else if (face == 4.0) {
					uv = vec2(-direction.x, direction.z) / abs(direction.y); // neg y
				} else {
					uv = vec2(direction.x, direction.y) / abs(direction.z); // neg z
				}
				return 0.5 * (uv + 1.0);
		}`);x.useKeywords=!1;let b=new Ae(`TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
			float face = getFace(direction);
			float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
			mipInt = max(mipInt, cubeUV_minMipLevel);
			float faceSize = exp2(mipInt);
			float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
			vec2 uv = getUV(direction, face) * (faceSize - 1.0);
			vec2 f = fract(uv);
			uv += 0.5 - f;
			if (face > 2.0) {
				uv.y += faceSize;
				face -= 3.0;
			}
			uv.x += face * faceSize;
			if(mipInt < cubeUV_maxMipLevel){
				uv.y += 2.0 * cubeUV_maxTileSize;
			}
			uv.y += filterInt * 2.0 * cubeUV_minTileSize;
			uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
			uv *= texelSize;
			vec4 tl = texture2D(envMap, uv);
			uv.x += texelSize;
			vec4 tr = texture2D(envMap, uv);
			uv.y += texelSize;
			vec4 br = texture2D(envMap, uv);
			uv.x -= texelSize;
			vec4 bl = texture2D(envMap, uv);
			return TextureCubeUVData( tl, tr, br, bl, f );
		}`,[r,y,x,a,n,o,f]);b.useKeywords=!1;let _=new Gt("float r0 1.0",!0),S=new Gt("float v0 0.339",!0),A=new Gt("float m0 -2.0",!0),C=new Gt("float r1 0.8",!0),P=new Gt("float v1 0.276",!0),T=new Gt("float m1 -1.0",!0),M=new Gt("float r4 0.4",!0),O=new Gt("float v4 0.046",!0),I=new Gt("float m4 2.0",!0),D=new Gt("float r5 0.305",!0),z=new Gt("float v5 0.016",!0),k=new Gt("float m5 3.0",!0),L=new Gt("float r6 0.21",!0),R=new Gt("float v6 0.0038",!0),F=new Gt("float m6 4.0",!0),B=[_,S,A,C,P,T,M,O,I,D,z,k,L,R,F],N=new Ae(`float roughnessToMip(float roughness) {
			float mip = 0.0;
			if (roughness >= r1) {
				mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
			} else if (roughness >= r4) {
				mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
			} else if (roughness >= r5) {
				mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
			} else if (roughness >= r6) {
				mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
			} else {
				mip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25
			}
			return mip;
		}`,B);return{bilinearCubeUV:b,roughnessToMip:N,m0:A,cubeUV_maxMipLevel:a}}();var Zc=class extends rt{constructor(r){super("v3"),this.nodeType="Normal",this.scope=r??Zc.VIEW}getShared(){return this.scope===Zc.WORLD}build(r,a,n,o){let f=r.context[this.scope+"Normal"];return f?f.build(r,a,n,o):super.build(r,a,n)}generate(r,a,n,o,f){let y;switch(this.scope){case Zc.VIEW:r.isShader("vertex")?y="transformedNormal":y="geometryNormal";break;case Zc.LOCAL:r.isShader("vertex")?y="objectNormal":(r.requires.normal=!0,y="vObjectNormal");break;case Zc.WORLD:r.isShader("vertex")?y="inverseTransformDirection( transformedNormal, viewMatrix ).xyz":(r.requires.worldNormal=!0,y="vWNormal");break}return r.format(y,this.getType(r),a)}},Gi=Zc;Gi.LOCAL="local",Gi.WORLD="world",Gi.VIEW="view",Gi.NORMAL="normal";Oi.addKeyword("viewNormal",function(){return new Gi(Gi.VIEW)});Oi.addKeyword("localNormal",function(){return new Gi(Gi.NORMAL)});Oi.addKeyword("worldNormal",function(){return new Gi(Gi.WORLD)});var Fo=class extends rt{constructor(r){super("v3"),this.nodeType="Position",this.scope=r??Fo.LOCAL}getType(){switch(this.scope){case Fo.PROJECTION:return"v4"}return this.type}getShader(){switch(this.scope){case Fo.LOCAL:case Fo.WORLD:return!1}return!0}generate(r,a,n,o,f){let y;switch(this.scope){case Fo.LOCAL:r.isShader("vertex")?y="transformed":(r.requires.position=!0,y="vPosition");break;case Fo.WORLD:if(r.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";r.requires.worldPosition=!0,y="vWPosition";break;case Fo.VIEW:y=r.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case Fo.PROJECTION:y=r.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )";break}return r.format(y,this.getType(),a)}},Fn=Fo;Fn.LOCAL="local",Fn.WORLD="world",Fn.VIEW="view",Fn.PROJECTION="projection";Oi.addKeyword("position",function(){return new Fn});Oi.addKeyword("worldPosition",function(){return new Fn(Fn.WORLD)});Oi.addKeyword("viewPosition",function(){return new Fn(Fn.VIEW)});var Ys=class extends rt{constructor(r){super("v3"),this.nodeType="Reflect",this.scope=r??Ys.CUBE}getUnique(r){return!r.context.viewNormal}getType(){switch(this.scope){case Ys.SPHERE:return"v2"}return this.type}generate(r,a){let n=this.getUnique(r);if(r.isShader("fragment")){let o;switch(this.scope){case Ys.VECTOR:{let f=new Gi(Gi.VIEW),y=r.context.roughness,x=f.build(r,"v3"),b=new Fn(Fn.VIEW).build(r,"v3"),_=y?y.build(r,"f"):void 0,S=`reflect( -normalize( ${b} ), ${x} )`;_&&(S=`normalize( mix( ${S}, ${x}, ${_} * ${_} ) )`);let A=`inverseTransformDirection( ${S}, viewMatrix )`;n?(r.addNodeCode(`vec3 reflectVec = ${A};`),o="reflectVec"):o=A;break}case Ys.CUBE:{let f=new Ys(Ys.VECTOR).build(r,"v3"),y="vec3( -"+f+".x, "+f+".yz )";n?(r.addNodeCode(`vec3 reflectCubeVec = ${y};`),o="reflectCubeVec"):o=y;break}case Ys.SPHERE:{let f="normalize( ( viewMatrix * vec4( "+new Ys(Ys.VECTOR).build(r,"v3")+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5";n?(r.addNodeCode(`vec2 reflectSphereVec = ${f};`),o="reflectSphereVec"):o=f;break}}return r.format(o,this.getType(),a)}else return console.warn("ReflectNode is not compatible with "+r.shader+" shader."),r.format("vec3( 0.0 )",this.type,a)}},Vo=Ys;Vo.CUBE="cube",Vo.SPHERE="sphere",Vo.VECTOR="vector";var rx=class extends rt{constructor(r=new wn,a,n){super("v4"),this.nodeType="TextureCube",this.value=r,this.radianceNode=new jd(this.value,a??new Vo(Vo.VECTOR),n),this.irradianceNode=new jd(this.value,new Gi(Gi.WORLD),new Fe(1).setReadonly(!0))}generate(r,a){return r.isShader("fragment")?(r.require("irradiance"),r.context.bias&&r.context.bias.setTexture(this.value),(r.slot==="irradiance"?this.irradianceNode:this.radianceNode).build(r,a)):(console.warn("TextureCubeNode is not compatible with "+r.shader+" shader."),r.format("vec4( 0.0 )",this.getType(r),a))}},ix=class extends cr{constructor(r=new ju,a,n){super("v4",{shared:!0}),this.nodeType="CubeTexture",this.value=r,this.uv=a??new Vo,this.bias=n}getTexture(r,a){return super.generate(r,a,this.value.uuid,"tc")}generate(r,a){var _;if(a==="samplerCube")return this.getTexture(r,a);let n=this.getTexture(r,a),o=(_=this.uv)==null?void 0:_.build(r,"v3"),f=this.bias?this.bias.build(r,"f"):void 0;f===void 0&&r.context.bias&&(f=r.context.bias.setTexture(this).build(r,"f"));let y;f?y="texCubeBias( "+n+", "+o+", "+f+" )":y="texCube( "+n+", "+o+" )";let x={include:r.isShader("vertex"),ignoreCache:!0},b=this.getType(r);return r.addContext(x),this.colorSpace=this.colorSpace??new Sn(new Zt("",b)),this.colorSpace.fromDecoding(r.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(y),y=this.colorSpace.build(r,b),r.removeContext(),r.format(y,b,a)}},CR=`
uniform int frameIndex;
uniform vec2 resolution;
uniform mat4 previousModelViewMatrix;
uniform mat4 previousProjectionMatrix;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;
`,PR=`
layout(location = 1) out vec4 gVelocity;

uniform int frameIndex;
uniform vec2 resolution;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;

const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

vec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {
  const float goldenAngle = 2.399963f; // radians
  float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));
  float theta = float(sampleIndex) * goldenAngle + angle;
  float sine = sin(theta);
  float cosine = cos(theta);
  return vec2(cosine, sine) * r;
}

// Derived from the interleaved gradient function from Jimenez 2014 http:goo.gl/eomGso
float getNoiseInterleavedGradient(vec2 screenPos) {
    vec3 magic = vec3(0.06711056f, 0.00583715f, 52.9829189f);
    return fract(magic.z * fract(dot(screenPos, magic.xy)));
}

`,_R=`
// TODO: This could be generated CPU side and passed to the shader every frame
const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

// TODO: Pass correct view size
vec2 offset = haltonSequence[frameIndex];
offset.x /= resolution.x;
offset.y /= resolution.y;

vec4 currentPosition = gl_Position;
vec4 currentPositionJittered = currentPosition + (vec4(offset.x, offset.y, 0.0, 0.0) * currentPosition.w);

// We want to calculate the velocity with unjittered positions
// so that things that are not moving get a velocity = 0
vCurrentPosition = currentPosition;
vPreviousPosition = previousProjectionMatrix * previousModelViewMatrix * vec4(transformed, 1.0);
#ifdef OUTLINE_COMPENSATION
vPreviousPosition.xy += OUTLINE_COMPENSATION;
#endif
gl_Position = currentPositionJittered;

`,IR=`
vec2 oldPos = vPreviousPosition.xy;
    oldPos /= vPreviousPosition.w;
    oldPos.xy = (oldPos.xy+1.)/2.0;

vec2 newPos = vCurrentPosition.xy;
    newPos /= vCurrentPosition.w;
    newPos.xy = (newPos.xy+1.)/2.0;

vec2 velocity = (newPos - oldPos);

// Discard fully transparent pixels 
if (gl_FragColor.a <= 0.0) discard;

gVelocity = vec4(velocity, 0.0, 1.0);
`,DR=`
layout(location = 1) out vec4 gVelocity;
`,OR=`
    // Discard fully transparent pixels 
    if (gl_FragColor.a <= 0.0) discard;

    gVelocity = vec4(0.0, 0.0, 0.0, 1.0);
`,RR=["x","y","z","w"],lY=["float","vec2","vec3","vec4"],cY={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b","float[]":"f[]","vec4[]":"v4[]"},uY={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4","f[]":"float[]","v4[]":"vec4[]"},Hd=class{constructor(){this.includes={consts:{},functions:{},structs:{}},this.cache="",this.slot="",this.shader="",this.context={},this.needsJitter=!0,this.getIncludesCode=function(){function r(a,n){return a.deps.length-n.deps.length}return function(a,n){let o=this.getIncludes(a,n);if(!o)return"";let f="";o=o.sort(r);for(let y=0;y<o.length;y++)o[y].src&&(f+=o[y].src+`
`);return f}}(),this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.fragmentVariables={},this.fragmentParsVariables={},this.vertexParsVariables={},this.requires={uv:[],color:[],transparent:!1,irradiance:!1,position:!1,worldPosition:!1,normal:!1,worldNormal:!1,vWorldViewDir:!1,modelMatrix:!1,viewMatrix:!1,projectionMatrix:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCube(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif",`
			// NOTE: Include Spline's blending modes. This could be part of BlendNode
			#define SPE_BLENDING_NORMAL 0
			#define SPE_BLENDING_MULTIPLY 1
			#define SPE_BLENDING_SCREEN 2
			#define SPE_BLENDING_OVERLAY 3

			vec3 spe_normalBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, b, alpha );
			}

			vec3 spe_multiplyBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, a * b, alpha );
			}

			vec3 spe_screenBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = 1.0 - ( 1.0 - a ) * ( 1.0 - b );
				return mix( a, tmp, alpha );
			}

			vec3 spe_overlayBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = mix( 1. - 2. * (1. - a) * (1. - b), 2. * a * b, step( a, vec3(.5) ) );
				return clamp( mix( a, tmp, alpha ), 0.0, 1.0 );
			}

			vec3 spe_blend( vec3 a, vec3 b, float alpha, int mode ) {
				if ( mode == SPE_BLENDING_NORMAL ) return spe_normalBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_MULTIPLY ) return spe_multiplyBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_SCREEN ) return spe_screenBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_OVERLAY ) return spe_overlayBlend( a, b, alpha );
				return vec3( 1.0 );
			}
			`,"#include <packing>","#include <common>"].join(`
`),this.parsCode={vertex:["float neighbor_offset = 0.0001;",""].join(`
`),fragment:["float accumAlpha = 0.0;",`void accumulateAlpha(float alpha) {
					accumAlpha += (1.0 - accumAlpha) * alpha;
				}`,""].join(`
`)},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},arrayUniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.updaters=[],this.nodes=[],this.analyzing=!1}build(r,a){this.addVertexParsCode(CR),this.addFragmentParsCode(PR),this.buildShader("vertex",r),this.buildShader("fragment",a);for(let n=0;n<this.requires.uv.length;n++)if(this.requires.uv[n]){let o=n>0?n+1:"";this.addVaryCode("varying vec2 vUv"+o+";"),n>0&&this.addVertexParsCode("attribute vec2 uv"+o+";"),this.addVertexFinalCode("vUv"+o+" = uv"+o+";")}return this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition,this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode(`
				#ifndef SHAPEBLEND 
					vObjectNormal = normal;
				#else
					vObjectNormal = objectNormal;
				#endif
			`)),this.requires.modelMatrix&&this.addFragmentParsCode("uniform mat4 modelMatrix;"),this.requires.viewMatrix&&this.addFragmentParsCode("uniform mat4 viewMatrix;"),this.requires.projectionMatrix&&this.addFragmentParsCode("uniform mat4 projectionMatrix;"),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;")),this.requires.vWorldViewDir&&(this.addVaryCode("varying vec3 vWorldViewDir;"),this.addVertexFinalCode("vWorldViewDir = isPerspectiveMatrix( projectionMatrix ) ?  ( (modelMatrix * vec4(position, 1.0)).xyz - cameraPosition ) : vec3( -viewMatrix[0][2], -viewMatrix[1][2], -viewMatrix[2][2] );")),this.needsJitter&&(this.addVertexFinalCode(_R),this.addFragmentFinalCode(IR)),this}buildShader(r,a){this.resultCode[r]=a.build(this.setShader(r),"v4")}setMaterial(r,a){return this.defines={},this}addFlow(r,a,n){return this.addSlot(r).addCache(a).addContext(n)}removeFlow(){return this.removeSlot().removeCache().removeContext()}addCache(r){return this.cache=r??"",this.caches.push(this.cache),this}removeCache(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this}addContext(r){return this.context=Object.assign({},this.context,r),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this}removeContext(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this}addSlot(r){return this.slot=r||"",this.slots.push(this.slot),this}removeSlot(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this}addFragmentVariable(r,a){this.fragmentVariables[r]===void 0&&(this.addFragmentCode(`${a} ${r};`),this.fragmentVariables[r]="")}addFragmentParsVariable(r,a){this.fragmentParsVariables[r]===void 0&&(this.addFragmentParsCode(`${a} ${r};`),this.fragmentParsVariables[r]="")}addVertexParsVariable(r,a){this.vertexParsVariables[r]===void 0&&(this.addVertexParsCode(`${a} ${r};`),this.vertexParsVariables[r]="")}addVertexCode(r){this.addCode(r,"vertex")}addFragmentCode(r){this.addCode(r,"fragment")}addCode(r,a){this.code[a??this.shader]+=r+`
`}addVertexNodeCode(r){this.addNodeCode(r,"vertex")}addFragmentNodeCode(r){this.addNodeCode(r,"fragment")}addNodeCode(r,a){this.nodeCode[a??this.shader]+=r+`
`}clearNodeCode(r){r=r??this.shader;let a=this.nodeCode[r];return this.nodeCode[r]="",a}clearVertexNodeCode(){return this.clearNodeCode("vertex")}clearFragmentNodeCode(){return this.clearNodeCode("fragment")}addVertexFinalCode(r){this.addFinalCode(r,"vertex")}addFragmentFinalCode(r){this.addFinalCode(r,"fragment")}addFinalCode(r,a){this.finalCode[a??this.shader]+=r+`
`}addVertexParsCode(r){this.addParsCode(r,"vertex")}addFragmentParsCode(r){this.addParsCode(r,"fragment")}addParsCode(r,a){this.parsCode[a??this.shader]+=r+`
`}addVaryCode(r){this.addVertexParsCode(r),this.addFragmentParsCode(r)}isCache(r){return this.caches.indexOf(r)!==-1}isSlot(r){return this.slots.indexOf(r)!==-1}define(r,a){this.defines[r]=a===void 0?1:a}require(r){this.requires[r]=!0}isDefined(r){return this.defines[r]!==void 0}getVar(r,a,n,o="varying",f="V",y=""){let x=this.getVars(o),b=x[r];if(!b){let _=x.length;b={name:n||"node"+f+_+(y?"_"+y:""),type:a},x.push(b),x[r]=b}return b}getTempVar(r,a,n,o){return this.getVar(r,a,n,this.shader,"T",o)}getAttribute(r,a){if(!this.attributes[r]){let n=this.getVar(r,a);this.addVertexParsCode("attribute "+a+" "+r+";"),this.addVertexFinalCode(n.name+" = "+r+";"),this.attributes[r]={varying:n,name:r,type:a}}return this.attributes[r]}getCode(r){return[this.prefixCode,this.parsCode[r],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[r],"uniform"),this.getVarListCode(this.inputs.arrayUniforms[r],"uniform"),this.getIncludesCode("consts",r),this.getIncludesCode("structs",r),this.getIncludesCode("functions",r),"void main() {",this.getVarListCode(this.getVars(r)),this.code[r],this.resultCode[r],this.finalCode[r],"}"].join(`
`)}getVarListCode(r,a){a=a??"";let n="";for(let o=0,f=r.length;o<f;++o){let y=r[o],x=y.type,b=y.name,_=y.size,S=this.getFormatByType(x);if(S===void 0)throw new Error("Node pars "+S+" not found.");S.includes("[]")?n+=a+" "+S.substring(0,S.length-2)+" "+b+`[${_}];
`:n+=a+" "+S+" "+b+`;
`}return n}getVars(r){return this.inputs.vars[r??this.shader]}getNodeData(r){let a=r instanceof lr?r.uuid:r;return this.nodeData[a]=this.nodeData[a]||{}}createUniform(r,a,n,o,f,y){if(a.includes("[]")){let x=this.inputs.arrayUniforms,b=x.list.length,_=new Pm({type:a,size:n.size,name:o||"nodeUA"+b+(y?"_"+y:""),node:n,needsUpdate:f});return x.list.push(_),x[r].push(_),x[r][_.name]=_,this.uniforms[_.name]=_,_}else{let x=this.inputs.uniforms,b=x.list.length,_=new Pm({type:a,name:o||"nodeU"+b+(y?"_"+y:""),node:n,needsUpdate:f});return x.list.push(_),x[r].push(_),x[r][_.name]=_,this.uniforms[_.name]=_,_}}createVertexUniform(r,a,n,o,f){return this.createUniform("vertex",r,a,n,o,f)}createFragmentUniform(r,a,n,o,f){return this.createUniform("fragment",r,a,n,o,f)}include(r,a,n){var y;let o;if(r=typeof r=="string"?Oi.get(r):r,this.context.include===!1)return r.name;r instanceof Ae?o=this.includes.functions:r instanceof Gt?o=this.includes.consts:r instanceof zd&&(o=this.includes.structs);let f=o[this.shader]=o[this.shader]||[];if(r){let x=f[r.name];if(x||(x=f[r.name]={node:r,deps:[]},f.push(x),x.src=r.build(this,"source")),r instanceof Ae&&a&&f[a.name]&&f[a.name].deps.indexOf(r)===-1&&(f[a.name].deps.push(r),(y=r.includes)==null?void 0:y.length)){let b=0;do this.include(r.includes[b++],a);while(b<r.includes.length)}return n&&(x.src=n),r.name}else throw new Error("Include not found.")}colorToVectorProperties(r){return r.replace("r","x").replace("g","y").replace("b","z").replace("a","w")}colorToVector(r){return r.replace(/c/g,"v3")}getIncludes(r,a){return this.includes[r][a||this.shader]}getConstructorFromLength(r){return lY[r-1]}isTypeMatrix(r){return/^m/.test(r)}getTypeLength(r){return r==="f"?1:parseInt(this.colorToVector(r).substr(1))}getTypeFromLength(r){return r===1?"f":"v"+r}findNode(...r){for(let a=0;a<arguments.length;a++){let n=r[a];if(n!=null&&n.isNode)return n}}resolve(...r){for(let a=0;a<arguments.length;a++){let n=r[a];if(n!==void 0){if(n.isNode)return n;if(n.isTexture)switch(n.mapping){case sl:case ol:return new ix(n);case oh:return new rx(new wn(n));default:return new wn(n)}else{if(n.isVector2)return new Yr(n);if(n.isVector3)return new Ki(n);if(n.isVector4)return new Nn(n)}}}}format(r,a,n){switch(this.colorToVector(n+" <- "+a)){case"f <- v2":return r+".x";case"f <- v3":return r+".x";case"f <- v4":return r+".x";case"f <- i":case"f <- b":return"float( "+r+" )";case"v2 <- f":return"vec2( "+r+" )";case"v2 <- v3":return r+".xy";case"v2 <- v4":return r+".xy";case"v2 <- i":case"v2 <- b":return"vec2( float( "+r+" ) )";case"v3 <- f":return"vec3( "+r+" )";case"v3 <- v2":return"vec3( "+r+", 0.0 )";case"v3 <- v4":return r+".xyz";case"v3 <- i":case"v3 <- b":return"vec2( float( "+r+" ) )";case"v4 <- f":return"vec4( "+r+" )";case"v4 <- v2":return"vec4( "+r+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+r+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+r+" ) )";case"i <- f":case"i <- b":return"int( "+r+" )";case"i <- v2":return"int( "+r+".x )";case"i <- v3":return"int( "+r+".x )";case"i <- v4":return"int( "+r+".x )";case"b <- f":return"( "+r+" != 0.0 )";case"b <- v2":return"( "+r+" != vec2( 0.0 ) )";case"b <- v3":return"( "+r+" != vec3( 0.0 ) )";case"b <- v4":return"( "+r+" != vec4( 0.0 ) )";case"b <- i":return"( "+r+" != 0 )"}return r}getTypeByFormat(r){return cY[r]||r}getFormatByType(r){return uY[r]||r}getUUID(r,a){return a=a!==void 0?a:!0,a&&this.cache&&(r=this.cache+"-"+r),r}getElementByIndex(r){return RR[r]}getIndexByElement(r){return RR.indexOf(r)}isShader(r){return this.shader===r}setShader(r){return this.shader=r,this}mergeDefines(r){for(let a in r)this.defines[a]=r[a];return this.defines}mergeUniform(r){for(let a in r)this.uniforms[a]=r[a];return this.uniforms}getTextureEncodingFromMap(r){let a;return r?r.isTexture&&(a=r.encoding):a=gn,a===gn&&this.context.gamma&&(a=ct),a}},ir=class extends cr{constructor(r=0,a,n,o){super("c"),this.nodeType="Color",this.value=r instanceof br?r:new br(r||0,a,n,o)}setRGBA(r){this.value.setRGBA(r.r,r.g,r.b,r.a)}generate(r,a,n,o,f,y){n=r.getUUID(n??this.getUUID()),o=o??this.getType(r);let x=r.getNodeData(n),b=this.getReadonly()&&this.generateReadonly!==void 0;if(this.alpha){let _=this.alpha.build(r,"f");r.addFragmentNodeCode(`accumAlpha += ( 1.0 - accumAlpha ) * ${_};`)}return b?this.generateReadonly(r,a,n,o,f,y):r.isShader("vertex")?(x.vertex||(x.vertex=r.createVertexUniform(o,this,f,y,this.getLabel())),r.format(x.vertex.name,o,a)):(x.fragment||(x.fragment=r.createFragmentUniform(o,this,f,y,this.getLabel())),r.format(x.fragment.name,o,a))}generateReadonly(r,a,n,o,f,y){return r.format("vec3("+this.value.r+", "+this.value.g+", "+this.value.b+")",o,a)}},Lt=class extends cr{constructor(r){super("i"),this.nodeType="Int",this.value=Math.floor(r??0)}generateReadonly(r,a,n,o,f,y){return r.format(this.value.toString(),o,a)}},Jr=class extends cr{constructor(r){super("b"),this.nodeType="Bool",this.value=r??!1}generateReadonly(r,a,n,o){return r.format(this.value?"true":"false",o,a)}},Ks=class extends cr{constructor(r=1,a){super("f[]"),this.nodeType="FloatArray",this.size=r,this.value=Array.isArray(a)?a:typeof a=="number"?new Array(r).fill(a):new Array(r).fill(0)}},Hl=class extends cr{},nx=class extends Hl{constructor(r){super("v3"),this.image=r,this._value=new E}get value(){return this._value.x=this.image.isVideo?this.image.img.videoWidth??0:this.image.img.width,this._value.y=this.image.isVideo?this.image.img.videoHeight??0:this.image.img.height,this._value}},Jc=class extends Hl{constructor(r,a,n=1008,o=1006){super("t"),this.image=r,this.wrap=a,this.minFilter=n,this.magFilter=o}get value(){return this.image.getTexture(this.wrap,this.minFilter,this.magFilter)}},Wd=class extends cr{constructor(r){super("m3"),this.nodeType="Matrix3",this.value=r??new mr}generateReadonly(r,a,n,o,f,y){return r.format("mat3("+this.value.elements.join(", ")+")",o,a)}get elements(){return this.value.elements}set elements(r){this.value.fromArray(r)}},Qi=class extends cr{constructor(r){super("m4"),this.nodeType="Matrix4",this.value=r??new ue}generateReadonly(r,a,n,o,f,y){return r.format("mat4("+this.value.elements.join(", ")+")",o,a)}get elements(){return this.value.elements}set elements(r){this.value.fromArray(r)}};function LR(r,a,n,o=0){r.setUvTransform(n[0],n[1],a[0],a[1],0,0,0).premultiply(new mr().makeRotation(o*we.DEG2RAD))}var sx=class extends Wd{constructor(r,a,n=0){super(new mr),this.repeat=r,this.offset=a,this.rotation=n,LR(this.value,r,a,n)}updateMatrix(){LR(this.value,this.repeat,this.offset,this.rotation)}},Qs=class extends cr{constructor(r=1,a){super("v4[]"),this.nodeType="Vector4Array",this.size=r,this.value=Array.isArray(a)?a:a instanceof Qe?new Array(r).fill(a):new Array(r).fill(new Qe(0))}},qd=class extends rt{constructor(r,a,n,o){super("v3"),this.nodeType="Blend",this.a=r,this.b=a,this.alpha=n,this.mode=o}generate(r,a){if(r.isShader("fragment")){let n=[];return n.push(this.a.build(r,"c")),n.push(this.b.build(r,"c")),n.push(this.alpha.build(r,"f")),n.push(this.mode.build(r,"i")),r.format("spe_blend("+n.join(",")+")",this.getType(r),a)}else return console.warn("BlendNode is not compatible with "+r.shader+" shader."),r.format("vec3( 0.0 )",this.getType(r),a)}},pE=class extends rt{constructor(r,a){super("v3"),this.nodeType="CustomColor",this.color=r,this.alpha=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(r,a){if(r.isShader("fragment")){let n=r.include(pE.Nodes.customColor);r.addFragmentVariable(this.calpha,"float");let o=[];return o.push(this.color.build(r,"v3")),o.push(this.mask?`luminance(${this.mask.build(r,"v3")})`:"1.0"),o.push(this.alpha.build(r,"f")),o.push(this.calpha),r.format(n+"("+o.join(",")+")",this.getType(r),a)}else return console.warn("CustomColorNode is not compatible with "+r.shader+" shader."),r.format("vec3( 0.0 )",this.getType(r),a)}},$c=pE;$c.Nodes=function(){return{customColor:new Ae(`vec3 customColor(vec3 color, float mask, float alpha, out float calpha) {
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color;
			}`)}}();var mE=class extends rt{constructor(r,a){super("v3"),this.nodeType="CustomNormal",this.cnormal=r,this.alpha=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(r,a){if(r.isShader("fragment")){let n=r.include(mE.Nodes.customNormal);r.addFragmentVariable(this.calpha,"float");let o=[];return o.push(this.cnormal.build(r,"v3")),o.push("normal"),o.push(this.mask?`luminance(${this.mask.flow(r,"v3").result})`:"1.0"),o.push(this.alpha.build(r,"f")),o.push(this.calpha),r.format(n+"("+o.join(",")+")",this.getType(r),a)}else return console.warn("CustomNormalNode is not compatible with "+r.shader+" shader."),r.format("vec3( 0.0 )",this.getType(r),a)}},Xd=mE;Xd.Nodes=function(){return{customNormal:new Ae(`vec3 customNormal(vec3 cnormal, vec3 norm, float mask, float alpha, out float calpha) {
				vec3 normal = packNormalToRGB( norm ).rgb;
				normal *= step( vec3(0.5), cnormal );

				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;

				return normal;
			}`)}}();var Yd=class extends rt{constructor(r,a,n,o,f,y,x,b,_,S,A,C){super("v3"),this.nodeType="CustomTexture",this.texture=r,this.textureSize=a,this.crop=n,this.projection=o,this.axis=f,this.side=y,this.size=x,this.blending=b,this.mat=_,this.isMask=C,this.alpha=S,this.mode=A,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(r,a){r.require("position"),r.require("normal"),r.require("uv"),r.requires.uv=[!0],r.extensions.shaderTextureLOD=!0,r.extensions.derivatives=!0;let n=`g${this.uuid.toString().replace(/-/g,"")}`,o;switch(this.projection.value){case 3:o=r.include(Yd.Nodes.cylindrical);break;case 2:o=r.include(Yd.Nodes.spherical);break;case 1:let y=["vec3(1.0, 0.0, 0.0)","vec3(0.0, 1.0, 0.0)","vec3(0.0, 0.0, 1.0)"][this.axis.value],x=["zy","xz","xy"][this.axis.value],b=new Ae(`
		vec3 ${n}_planarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 projected = (1. + (position.${x})) / 2.;
				vec2 uvs = ( mat * vec3( (projected * 2. - 1.) / (size * .5), 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				${this.side.value===2?"":`lalpha *= step(0.0, ${this.side.value===1?"-1.0 * ":""}dot(vObjectNormal, ${y}));`}

				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`);o=r.include(b);break;case 4:o=r.include(Yd.Nodes.triplanar);break;default:o=r.include(Yd.Nodes.uv);break}r.addFragmentVariable(this.calpha,"float");let f=[];if(f.push("normal"),f.push(this.texture.generate(r,"t")),f.push(this.textureSize.build(r,"v2")),f.push(this.crop.build(r,"f")),f.push(this.mat.build(r,"mat3")),f.push(this.size.build(r,"v2")),f.push(this.blending.build(r,"f")),f.push(this.isMask.build(r,"b")),f.push(this.mask?`luminance(${this.mask.flow(r,"v3").result})`:"1.0"),f.push(this.alpha.build(r,"f")),f.push(this.mode.build(r,"i")),f.push(this.calpha),this.projection.value===4){let y=`${n}_writeUvs`,x=y+"0",b=y+"1",_=y+"2",S=`${n}_triplanarWeights`;r.addFragmentVariable(x,"vec2"),r.addFragmentVariable(b,"vec2"),r.addFragmentVariable(_,"vec2"),r.addFragmentVariable(S,"vec3"),f.push(x),f.push(b),f.push(_),f.push(S)}else{let y=`${n}_writeUvs`;r.addFragmentVariable(y,"vec2"),f.push(y)}return r.format(o+"("+f.join(",")+")",this.getType(r),a)}},Wl=Yd;Wl.Nodes=function(){let r=new Ae(`
vec3 cylindricalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(position);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float scaledHeight = position.y / (size.y * 0.5);
                float v =  (scaledHeight / 2.) + .5;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;

				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),a=new Ae(`
vec3 sphericalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(vPosition);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float v = 0.5 + asin(posN.y) / 3.1415;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;
				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),n=new Ae(`vec3 uvTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 uvs = ( mat * vec3( vUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;

				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`),o=new Ae(`vec3 triplanarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUvs0, out vec2 writeUvs1, out vec2 writeUvs2, out vec3 writeWeights) {
				vec3 p = position;
				vec2 uv0 = (1.0 + p.xy) / 2.0;     
				vec2 uv1 = (1.0 + p.zy) / 2.0;		
				vec2 uv2 = (1.0 + p.xz) / 2.0;		
	
				uv0 = (mat * vec3((uv0 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv1 = (mat * vec3((uv1 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv2 = (mat * vec3((uv2 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;

				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));

				// Write out all sets of UVs that we generated
				writeUvs0 = uv0;
				writeUvs1 = uv1;
				writeUvs2 = uv2;
				writeWeights = weights;

				// Derivatives for LOD
				vec2 df0 = fwidth(uv0);
				vec2 df1 = fwidth(uv1);
				vec2 df2 = fwidth(uv2);
				if (df0.x > 0.5) df0.x = 0.0;
				if (df1.x > 0.5) df1.x = 0.0;
				if (df2.x > 0.5) df2.x = 0.0;

				#ifdef GL_EXT_shader_texture_lod
                	vec4 tmp = 
						texture2DLodEXT(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						texture2DLodEXT(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						texture2DLodEXT(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#else
                	vec4 tmp = 
						textureLod(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						textureLod(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						textureLod(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;

				// Apply cropping across all 3 planes
				if ( crop > 0.5 ) {
					if ( uv0.x < 0.0 || uv0.x > 1.0 || uv0.y < 0.0 || uv0.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv1.x < 0.0 || uv1.x > 1.0 || uv1.y < 0.0 || uv1.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv2.x < 0.0 || uv2.x > 1.0 || uv2.y < 0.0 || uv2.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;//n * 0.5 + 0.5;
			}			
			`);return{cylindrical:r,spherical:a,uv:n,triplanar:o}}();var Kd=class extends rt{constructor(r,a,n,o,f,y,x,b,_,S,A,C){super("v3"),this.nodeType="Depth",this.gradientType=r,this.smooth=a,this.near=n,this.far=o,this.isVector=f,this.isWorldSpace=y,this.origin=x,this.direction=b,this.colors=_,this.steps=S,this.isMask=C,this.alpha=A,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(r,a){let n=`g${this.uuid.toString().replace(/-/g,"")}`,o=new Ae(`vec3 ${n}_sdepth(float near, float far, vec3 origin, vec3 direction, vec4 colors[${n}_MAX_COLORS], float steps[${n}_MAX_COLORS], bool isMask, float mask, float alpha, out float calpha) {
               vec4 color = colors[0];
               #ifdef ${n}_IS_VECTOR
                   #ifdef ${n}_LINEAR
                       #ifdef ${n}_WORLDSPACE
                       float depth = vectorLinearWorldSpaceDepth(direction, origin, near, far);
                       #else
                       float depth = vectorLinearObjectSpaceDepth(direction, origin, near, far);
                       #endif
                   #else
                       #ifdef ${n}_WORLDSPACE
                           float depth = vectorSphericalWorldSpaceDepth(origin, near, far);
                       #else
                           float depth = vectorSphericalObjectSpaceDepth(origin, near, far);
                       #endif
                   #endif
               #else
                   float dist = length(vWPosition - cameraPosition);
			       float depth = ( dist - near ) / ( far - near );
               #endif


              float p;
              #ifdef ${n}_SMOOTH
				for ( int i = 1; i < ${n}_MAX_COLORS; i++ ) {
						p = clamp( ( depth - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}
              #else
                for ( int i = 1; i < ${n}_MAX_COLORS; i++ ) {
                   p = clamp(( depth - steps[i - 1] ) / ( steps[i] - steps[i - 1] ), 0.0, 1.0);
                   color = mix(color, colors[i], p);
                 }
              #endif

               float lalpha = alpha * color.a * mask;
               calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
			   accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
			   
               return color.rgb;
			}`,[Kd.Nodes.vectorLinearWorldSpaceDepth,Kd.Nodes.vectorLinearObjectSpaceDepth,Kd.Nodes.vectorSphericalObjectSpaceDepth,Kd.Nodes.vectorSphericalWorldSpaceDepth]);if(r.isShader("fragment")){r.define(`${n}_MAX_COLORS`,this.colors.value.length),this.smooth.value&&r.define(`${n}_SMOOTH`),this.isVector.value>.5&&r.define(`${n}_IS_VECTOR`),this.gradientType.value===0&&r.define(`${n}_LINEAR`),this.isWorldSpace.value>.5&&r.define(`${n}_WORLDSPACE`),r.require("worldPosition"),r.addFragmentVariable(this.calpha,"float");let f=r.include(o),y=[];return y.push(this.near.build(r,"f")),y.push(this.far.build(r,"f")),y.push(this.origin.build(r,"v3")),y.push(this.direction.build(r,"v3")),y.push(this.colors.build(r,"v4[]")),y.push(this.steps.build(r,"f[]")),y.push(this.isMask.build(r,"b")),y.push(this.mask?`luminance(${this.mask.flow(r,"v3").result})`:"1.0"),y.push(this.alpha.build(r,"f")),y.push(this.calpha),r.format(f+"("+y.join(",")+")",this.getType(r),a)}else return console.warn("DepthNode is not compatible with "+r.shader+" shader."),r.format("vec3( 0.0 )",this.getType(r),a)}},Qd=Kd;Qd.Nodes=function(){let r=new Ae(`float vectorLinearWorldSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(vWPosition.x - origin.x) + n.y*(vWPosition.y - origin.y) + n.z*(vWPosition.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),a=new Ae(`float vectorLinearObjectSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(position.x - origin.x) + n.y*(position.y - origin.y) + n.z*(position.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),n=new Ae(`float vectorSphericalWorldSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(vWPosition - origin);
               return ( dist - near ) / ( far - near );
            }`),o=new Ae(`float vectorSphericalObjectSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(position - origin);
               return ( dist - near ) / ( far - near );
            }`);return{vectorLinearWorldSpaceDepth:r,vectorLinearObjectSpaceDepth:a,vectorSphericalWorldSpaceDepth:n,vectorSphericalObjectSpaceDepth:o}}();var Im=class extends rt{constructor(r,a,n,o,f,y,x,b){super("v3"),this.nodeType="Fresnel",this.color=r,this.bias=a,this.scale=n,this.intensity=o,this.factor=f,this.isMask=b,this.alpha=y,this.mode=x,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(r,a){if(r.require("vWorldViewDir"),r.require("worldNormal"),r.isShader("fragment")){r.addFragmentVariable(this.calpha,"float");let n=new Ae(`vec3 fresnel(vec3 color, float bias, float scale, float intensity, float factor, bool isMask, float mask, float alpha, int mode, out float calpha) {
					float fresnel = bias + scale * pow( abs( factor + dot( normalize( vWorldViewDir ), normalize( vWNormal ) ) ), intensity );

					float lalpha = clamp(fresnel, 0.0, 1.0) * alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return color;
				}`),o=r.include(n),f=[];return f.push(this.color.build(r,"c")),f.push(this.bias.build(r,"f")),f.push(this.scale.build(r,"f")),f.push(this.intensity.build(r,"f")),f.push(this.factor.build(r,"f")),f.push(this.isMask.build(r,"b")),f.push(this.mask?`luminance(${this.mask.flow(r,"v3").result})`:"1.0"),f.push(this.alpha.build(r,"f")),f.push(this.mode.build(r,"i")),f.push(this.calpha),r.format(o+"("+f.join(",")+")",this.getType(r),a)}else return console.warn("FresnelNode is not compatible with "+r.shader+" shader."),r.format("vec3( 0.0 )",this.getType(r),a)}},gE=class extends rt{constructor(r,a,n,o,f,y,x,b,_){super("v3"),this.nodeType="Gradient",this.gradientType=r,this.smooth=a,this.colors=n,this.steps=o,this.offset=f,this.morph=y,this.angle=x,this.isMask=_,this.alpha=b,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(r,a){if(r.isShader("fragment")){r.define("GRAD_MAX",10),r.require("uv"),r.requires.uv=[!0],r.addFragmentVariable(this.calpha,"float");let n=r.include(gE.Nodes.gradient),o=[];return o.push(this.gradientType.build(r,"i")),o.push(this.smooth.build(r,"b")),o.push(this.colors.build(r,"v4[]")),o.push(this.steps.build(r,"f[]")),o.push(this.offset.build(r,"v2")),o.push(this.morph.build(r,"v2")),o.push(this.angle.build(r,"f")),o.push(this.isMask.build(r,"b")),o.push(this.mask?`luminance(${this.mask.flow(r,"v3").result})`:"1.0"),o.push(this.alpha.build(r,"f")),o.push(this.calpha),r.format(n+"("+o.join(",")+")",this.getType(r),a)}else return console.warn("GradientNode is not compatible with "+r.shader+" shader."),r.format("vec3( 0.0 )",this.getType(r),a)}},Zd=gE;Zd.Nodes=function(){return{gradient:new Ae(`vec3 gradient(int gradientType, bool smoothed, vec4 colors[GRAD_MAX], float steps[GRAD_MAX], vec2 offset, vec2 morph, float angle, bool isMask, float mask, float alpha, out float calpha) {
				vec4 color = colors[0];
				vec2 m = morph / vUv.xy;
				vec2 rot = vec2( 0.5 + m.x, m.y );
				vec2 dt = vec2(
					cos( angle ) * rot.x - sin( angle ) * rot.y,
					sin( angle ) * rot.x + cos( angle ) * rot.y
				);
				vec2 pt = ( vUv - 0.5 + offset ) / 2.0 + dt / 2.0;
				float t = dot( pt, dt ) / dot( dt, dt );
				if ( gradientType == 1 ) {
					t = distance (
						( vUv + morph ) * 3.0,
						( vUv + offset ) + 1.0
					) + angle;
				} else if ( gradientType == 2 ) {
					float polar = atan(
						vUv.x + morph.x - 0.5 + offset.x,
						vUv.y + morph.y - 0.5 + offset.y
					) * -1.0;
					t = fract( ( angle / PI / -2.0 ) + 0.5 * ( polar / PI ) );
				}

				float p;
				if (smoothed) {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}

				} else {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], p);
					}
				}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
				
				return color.xyz;
			}`)}}();var yE=class extends rt{constructor(r,a,n,o,f){super("v3"),this.nodeType="Matcap",this.texture=r,this.isMask=o,this.alpha=a,this.mode=n,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`,this.rotation=f}generate(r,a){if(r.isShader("fragment")){r.addFragmentVariable(this.calpha,"float");let n=r.include(yE.Nodes.matcap);r.require("normal"),r.requires.normal=!0;let o=[];return o.push(this.texture.generate(r,"t")),o.push("normal"),o.push(this.isMask.build(r,"b")),o.push(this.mask?`luminance(${this.mask.flow(r,"v3").result})`:"1.0"),o.push(this.alpha.build(r,"f")),o.push(this.mode.build(r,"i")),o.push(this.calpha),o.push(this.rotation.build(r,"f")),r.format(n+"("+o.join(",")+")",this.getType(r),a)}else return console.warn("MatcapNode is not compatible with "+r.shader+" shader."),r.format("vec3( 0.0 )",this.getType(r),a)}},Jd=yE;Jd.Nodes=function(){return{matcap:new Ae(`vec3 matcap(sampler2D matcapTex, vec3 normal, bool isMask, float mask, float alpha, int mode, out float calpha, float rotation) {
					vec3 viewDir = normalize( vViewPosition );
					vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
					vec3 y = cross( viewDir, x );
					vec2 uv = vec2( dot( x, normal ), dot( y, normal ) );
					uv = mat2( cos(rotation), sin(rotation), -sin(rotation), cos(rotation) ) * uv;
					uv = uv * 0.495 + 0.5;
					vec4 matcapColor = texture2D( matcapTex, uv );

					float lalpha = alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
					
					return matcapColor.rgb;
            	}`)}}();var ji=function(){let r=new Ae(`vec3 random3(vec3 c) {
			float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));
			vec3 r;
			r.z = fract(512.0*j);
			j *= .125;
			r.x = fract(512.0*j);
			j *= .125;
			r.y = fract(512.0*j);
			return r-0.5;
		}`),a=new Ae(`float simplexFast(vec3 p) {
			 vec3 s = floor(p + dot(p, vec3(F3)));
			 mediump vec3 x = p - s + dot(s, vec3(G3));
			 mediump vec3 hs = s;
			 
			 mediump vec3 e = step(vec3(0.0), x - x.yzx);
			 mediump vec3 i1 = e*(1.0 - e.zxy);
			 mediump vec3 i2 = 1.0 - e.zxy*(1.0 - e);
				
			 mediump vec3 x1 = x - i1 + G3;
			 mediump vec3 x2 = x - i2 + 2.0*G3;
			 mediump vec3 x3 = x - 1.0 + 3.0*G3;
			 
			 mediump vec4 w, d;
			 
			 w.x = dot(x, x);
			 w.y = dot(x1, x1);
			 w.z = dot(x2, x2);
			 w.w = dot(x3, x3);
			 
			 w = max(0.6 - w, 0.0);
			 
			 d.x = dot(random3(hs), x);
			 d.y = dot(random3(hs + i1), x1);
			 d.z = dot(random3(hs + i2), x2);
			 d.w = dot(random3(hs + 1.0), x3);
			 
			 w *= w;
			 w *= w;
			 d *= w;
			 
			 return dot(d, vec4(52.0));
		}`,[r]);a.keywords.F3=new Gt("float F3 0.3333333"),a.keywords.G3=new Gt("float G3 0.1666667");let n=new Ae(`float simplexPrecise(vec3 p) {
			 vec3 s = floor(p + dot(p, vec3(F3)));
			 vec3 x = p - s + dot(s, vec3(G3));
			 
			 vec3 e = step(vec3(0.0), x - x.yzx);
			 vec3 i1 = e*(1.0 - e.zxy);
			 vec3 i2 = 1.0 - e.zxy*(1.0 - e);
				
			 vec3 x1 = x - i1 + G3;
			 vec3 x2 = x - i2 + 2.0*G3;
			 vec3 x3 = x - 1.0 + 3.0*G3;
			 
			 vec4 w, d;
			 
			 w.x = dot(x, x);
			 w.y = dot(x1, x1);
			 w.z = dot(x2, x2);
			 w.w = dot(x3, x3);
			 
			 w = max(0.6 - w, 0.0);
			 
			 d.x = dot(random3(s), x);
			 d.y = dot(random3(s + i1), x1);
			 d.z = dot(random3(s + i2), x2);
			 d.w = dot(random3(s + 1.0), x3);
			 
			 w *= w;
			 w *= w;
			 d *= w;
			 
			 return dot(d, vec4(52.0));
		}`,[r]);n.keywords.F3=new Gt("float F3 0.3333333"),n.keywords.G3=new Gt("float G3 0.1666667");let o=new Ae(`float simplexFractal(vec3 m) {
			mat3 rot1 = mat3(-0.37, 0.36, 0.85,-0.14,-0.93, 0.34,0.92, 0.01,0.4);
			mat3 rot2 = mat3(-0.55,-0.39, 0.74, 0.33,-0.91,-0.24,0.77, 0.12,0.63);
			mat3 rot3 = mat3(-0.71, 0.52,-0.47,-0.08,-0.72,-0.68,-0.7,-0.45,0.56);
			return 0.5333333 * simplexFast(m * rot1)
				 + 0.2666667 * simplexFast(2.0 * m * rot2)
				 + 0.1333333 * simplexFast(4.0 * m * rot3)
				 + 0.0666667 * simplexFast(8.0 * m);
		}`,[a]),f=new Ae("vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}"),y=new Ae("vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}"),x=new Ae(`float simplexAshima(vec3 v) {
		  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
		  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
		  vec3 i  = floor(v + dot(v, C.yyy) );
		  vec3 x0 =   v - i + dot(i, C.xxx) ;
		  vec3 g = step(x0.yzx, x0.xyz);
		  vec3 l = 1.0 - g;
		  vec3 i1 = min( g.xyz, l.zxy );
		  vec3 i2 = max( g.xyz, l.zxy );
		  vec3 x1 = x0 - i1 + 1.0 * C.xxx;
		  vec3 x2 = x0 - i2 + 2.0 * C.xxx;
		  vec3 x3 = x0 - 1. + 3.0 * C.xxx;
		  i = mod(i, 289.0 ); 
		  vec4 p = permute( permute( permute( 
					 i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
				   + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) 
				   + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
		  float n_ = 1.0/7.0; // N=7
		  vec3  ns = n_ * D.wyz - D.xzx;
		  vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)
		  vec4 x_ = floor(j * ns.z);
		  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
		  vec4 x = x_ *ns.x + ns.yyyy;
		  vec4 y = y_ *ns.x + ns.yyyy;
		  vec4 h = 1.0 - abs(x) - abs(y);
		  vec4 b0 = vec4( x.xy, y.xy );
		  vec4 b1 = vec4( x.zw, y.zw );
		  vec4 s0 = floor(b0)*2.0 + 1.0;
		  vec4 s1 = floor(b1)*2.0 + 1.0;
		  vec4 sh = -step(h, vec4(0.0));
		  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
		  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
		  vec3 p0 = vec3(a0.xy,h.x);
		  vec3 p1 = vec3(a0.zw,h.y);
		  vec3 p2 = vec3(a1.xy,h.z);
		  vec3 p3 = vec3(a1.zw,h.w);
		  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
		  p0 *= norm.x;
		  p1 *= norm.y;
		  p2 *= norm.z;
		  p3 *= norm.w;
		  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
		  m = m * m;
		  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), 
										dot(p2,x2), dot(p3,x3) ) );
		}`,[f,y]),b=new Ae("vec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}"),_=new Ae("vec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}",[b]),S=new Ae(`float noise(vec3 p){
			vec3 a = floor(p);
			vec3 d = p - a;
			d = d * d * (3.0 - 2.0 * d);
			vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);
			vec4 k1 = perm(b.xyxy);
			vec4 k2 = perm(k1.xyxy + b.zzww);
			vec4 c = k2 + a.zzzz;
			vec4 k3 = perm(c);
			vec4 k4 = perm(c + 1.0);
			vec4 o1 = fract(k3 * (1.0 / 41.0));
			vec4 o2 = fract(k4 * (1.0 / 41.0));
			vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);
			vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);
			return o4.y * d.y + o4.x * (1.0 - d.y);
		}`,[_]),A=new Ae(`float fbm(vec3 x) {
			float v = 0.0;
			float a = 0.5;
			vec3 shift = vec3(100);
			for (int i = 0; i < NUM_OCTAVES; ++i) {
				v += a * noise(x);
				x = x * 2.0 + shift;
				a *= 0.5;
			}
			return v;
		}`,[S]);A.keywords.NUM_OCTAVES=new Gt("int NUM_OCTAVES 5");let C=new Ae("vec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}"),P=new Ae(`float perlin(vec3 P){
		  vec3 Pi0 = floor(P);
		  vec3 Pi1 = Pi0 + vec3(1.0);
		  Pi0 = mod(Pi0, 289.0);
		  Pi1 = mod(Pi1, 289.0);
		  vec3 Pf0 = fract(P);
		  vec3 Pf1 = Pf0 - vec3(1.0);
		  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
		  vec4 iy = vec4(Pi0.yy, Pi1.yy);
		  vec4 iz0 = Pi0.zzzz;
		  vec4 iz1 = Pi1.zzzz;
		  vec4 ixy = permute(permute(ix) + iy);
		  vec4 ixy0 = permute(ixy + iz0);
		  vec4 ixy1 = permute(ixy + iz1);
		  vec4 gx0 = ixy0 / 7.0;
		  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;
		  gx0 = fract(gx0);
		  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
		  vec4 sz0 = step(gz0, vec4(0.0));
		  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
		  gy0 -= sz0 * (step(0.0, gy0) - 0.5);
		  vec4 gx1 = ixy1 / 7.0;
		  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;
		  gx1 = fract(gx1);
		  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
		  vec4 sz1 = step(gz1, vec4(0.0));
		  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
		  gy1 -= sz1 * (step(0.0, gy1) - 0.5);
		  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
		  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
		  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
		  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
		  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
		  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
		  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
		  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);
		  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
		  g000 *= norm0.x;
		  g010 *= norm0.y;
		  g100 *= norm0.z;
		  g110 *= norm0.w;
		  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
		  g001 *= norm1.x;
		  g011 *= norm1.y;
		  g101 *= norm1.z;
		  g111 *= norm1.w;
		  float n000 = dot(g000, Pf0);
		  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
		  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
		  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
		  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
		  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
		  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
		  float n111 = dot(g111, Pf1);
		  vec3 fade_xyz = fade(Pf0);
		  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
		  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
		  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
		  return 2.2 * n_xyz;
		}`,[f,y,C]),T=new Ae(`float hashwithoutsine13(vec3 p3)
		{
			p3  = fract(p3 * .1031);
			p3 += dot(p3, p3.yzx + 33.33);
			return fract((p3.x + p3.y) * p3.z);
		}`),M=new Ae(`vec3 hashwithoutsine33(vec3 p3)
		{
			p3 = fract(p3 * vec3(.1031, .1030, .0973));
			p3 += dot(p3, p3.yxz+33.33);
			return fract((p3.xxy + p3.yxx)*p3.zyx);
		}`),O=new Ae(`float metric(in vec3 p)
		{
			// L2 
			return length(p);

			// Chebyshev 
			// vec3 a = abs(p);
			// return max(a.x, max(a.y, a.z));
		}`),I=new Ae(`float smin( float a, float b, float k )
		{
			float h = smoothstep(0.0, 1.0, 0.5 + 0.5 * (b - a) / k);
			float correction = k * h * (1.0 - h);
			return mix(b, a, h) - correction;
		}`),D=new Ae(`float smax( float a, float b, float k )
		{
			float h = smoothstep(1.0, 0.0, 0.5 + 0.5 * (a - b) / k);
			float correction = k * h * (1.0 - h);
			return mix(a, b, h) + correction;
		}`),z=new Ae(`float remap(float value, float input_min, float input_max, float output_min, float output_max) {
			// Compute width of each interval
			float input_width = input_max - input_min;
			float output_width = output_max - output_min;
		
			// Convert input range into a 0-1 range 
			float scaled = (value - input_min) / input_width;
		
			// Convert the 0-1 range into a value in output range
			return output_min + (scaled * output_width);
		}`),k=new Ae(`float voronoi(in vec3 x, in int style, in float smoothness, in float seed, in int quality) 
		{
			// Integer and fractional parts of this point's coordinates
			ivec3 p = ivec3(floor(x));
			vec3 f = fract(x);

			// Different variables that we will use to construct noise:
			//
			// f1: distance to the closest feature point
			// f2: distance to the second closest feature point
			// e: distance to the closest edge (cell boundary)
			//
			// We also compute "smooth" versions of all of the above quantites, essentially
			// replacing "hard" minimums with "smooth" minimums (described by IQ)
			float f1_smooth = 8.0;
			float f1 = 8.0;
			float f2_smooth = 8.0;
			float f2 = 8.0;
			float e_smooth = 8.0;
			float e = 8.0;

			// Variables stored from closest cell
			ivec3 mb;
			vec3 mr; 

			int steps = quality;
			
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				ivec3 b = ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d = length(r);
				
				f1_smooth = smin(d, f1_smooth, smoothness);

				// Store un-smoothed distances too 
				if (d < f1) 
				{
					f2 = f1;
					f1 = d;

					mb = ivec3(x, y, z);
					mr = r;
				} 
				else if (d < f2) 
				{
					f2 = d;
				}
			}	
			
			// Second pass for edge distance  
			// skip for styles don't need
			if (style != 0 &&  style != 5 && style != 7)
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				// Start search at the cell that contains the closest point to "x" (found in 1st pass)
				ivec3 b = mb + ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d1 = dot(0.5 * (mr + r), (r - mr)); 				// IQ normalizes "r - mr" but that breaks things for the smooth version?
				float d2 = dot(0.5 * (mr + r), normalize(r - mr));

				e_smooth = smin(d1, e_smooth, smoothness);

				e = min(e, d2);

				// Also compute a smooth version of F2 in this pass
				{
					ivec3 b = ivec3(x, y, z);
					if (b != mb) 
					{
						vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
						float d = length(r);

						f2_smooth = smin(d, f2_smooth, smoothness);
					}
				}
			}

			// Different visualization modes 
			if (style == 0) 
			{
				return f1_smooth;
			}
			if (style == 1) 
			{
				return f2_smooth;
			}
			if (style == 2) 
			{
				return f2_smooth - f1_smooth;
				
				// "Pebbles" also cool
				//return step(0.2, f2_smooth - f1_smooth);
			}
			if (style == 3) 
			{
				// This one is really good for rock / stone effects
				float a = f1; 
				float b = f2;
				float k = 3.0;
				float h = max(k - abs(a - b), 0.0) / k;
				float final = min(a, b) - h * h * k * (1.0 / 4.0);
				return final;
			}
			if (style == 4) 
			{
				// Some random adjustments to make this style stand out more 
				return exp(5.0 * e_smooth);
			}
			if (style == 5) 
			{
				return pow(f1_smooth, 3.0);
			}
			if (style == 6) 
			{				
				const float eps = 0.0125;

				// Thicker lines as the user increases the smoothness slider
				float thickness = smoothness * 0.25 + eps;

				// Blurrier lines as the user increases the smoothness slider
				float blur = pow(smoothness, 3.0) * 0.25 + eps;

				return smoothstep(
					thickness - thickness * blur, 
					thickness + thickness * blur, 
					e
				);
			}
			if (style == 7) 
			{
				return hashwithoutsine13(vec3(p + mb) + seed);
			}
		}
	`,[T,M,O,I,D,z]);return{simplexFast:a,simplexPrecise:n,simplexFractal:o,simplexAshima:x,fbm:A,perlin:P,voronoi:k}}(),$d=class extends rt{constructor(r,a,n,o,f,y,x,b,_,S,A,C,P,T,M,O,I,D,z){super("v3"),this.nodeType="Noise",this.scale=r,this.size=a,this.move=n,this.fA=o,this.fB=f,this.distortion=y,this.colorA=x,this.colorB=b,this.colorC=_,this.colorD=S,this.noiseType=C,this.voronoiStyle=T,this.highCut=M,this.lowCut=O,this.smoothness=I,this.seed=D,this.quality=z,this.isMask=P,this.alpha=A,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(r,a,n,o,f){r.require("uv"),r.requires.uv=[!0],r.addFragmentVariable(this.calpha,"float");let y=["simplexFast","simplexFractal","simplexAshima","fbm","perlin","voronoi"][this.noiseType.value],x=y=="voronoi"?`
		float v = ${y}(st + move, voronoiStyle, smoothness, seed, quality);

		// Apply clipping to colors
		v = remap(v, lowCut, highCut, 0.0, 1.0);
		v = smax(v, 0.0, smoothness * 0.25);
		v = smin(v, 1.0, smoothness * 0.25);

		// Note that the voronoi mode only uses colors "A" and "C" from the UI 
		vec4 color = mix(colorA, colorC, v); 
		`:`
		vec3 q = vec3(${y}(st),
					   ${y}(st + vec3(1.0)),
					   ${y}(st + vec3(1.0)));
		vec3 r = vec3(${y}(st + vec3(distortion, 1.0) * q + vec3(fA, 1.0) + move),
					  ${y}(st + vec3(distortion, 1.0) * q + vec3(fB, 1.0) + move), 
					  ${y}(st * q));
		float f = ${y}(st + r);
		vec4 color;
		color = mix(colorA, colorB, clamp((f * f) * 4.0, 0.0, 1.0));
		color = mix(color, colorC, clamp(length(q), 0.0, 1.0));
		color = mix(color, colorD, clamp(length(r.x), 0.0, 1.0));
		`,b=new Ae(`vec3 ${y}customNoise(float scale, vec3 size, float move, vec2 fA, vec2 fB, vec2 distortion, vec4 colorA, vec4 colorB, vec4 colorC, vec4 colorD, int voronoiStyle, float highCut, float lowCut, float smoothness, float seed, int quality, bool isMask, float mask, float alpha, out float calpha) 
			{
                // Prevent scale of zero 
				scale = max(abs(scale), 0.001);

				vec3 st = position / size;
				st /= scale;

				${x}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return clamp(color, 0.0, 1.0).rgb;
			}`,[ji.simplexFast,ji.simplexFractal,ji.simplexAshima,ji.fbm,ji.perlin,ji.voronoi]),_=r.include(b),S=[];return S.push(this.scale.build(r,"f")),S.push(this.size.build(r,"v3")),S.push(this.move.build(r,"f")),S.push(this.fA.build(r,"v2")),S.push(this.fB.build(r,"v2")),S.push(this.distortion.build(r,"v2")),S.push(this.colorA.build(r,"v4")),S.push(this.colorB.build(r,"v4")),S.push(this.colorC.build(r,"v4")),S.push(this.colorD.build(r,"v4")),S.push(this.voronoiStyle.build(r,"i")),S.push(this.highCut.build(r,"f")),S.push(this.lowCut.build(r,"f")),S.push(this.smoothness.build(r,"f")),S.push(this.seed.build(r,"f")),S.push(this.quality.build(r,"i")),S.push(this.isMask.build(r,"b")),S.push(this.mask?`luminance(${this.mask.flow(r,"v3").result})`:"1.0"),S.push(this.alpha.build(r,"f")),S.push(this.calpha),r.format(_+"("+S.join(",")+")",this.getType(r),a)}};$d.numOctaves=5;var vE=class extends rt{constructor(r,a,n,o,f,y,x,b,_,S,A,C,P,T,M,O){super("v3"),this.nodeType="Outline",this.firstTime=!0,this.outlineColor=r,this.contourColor=a,this.outlineWidth=n,this.contourWidth=o,this.contourThreshold=f,this.outlineThreshold=y,this.contourFrequency=x,this.outlineSmoothing=b,this.contourDirection=_,this.positionalLines=S,this.compensation=A,this.resolution=C,this.normalMap=P,this.depthMap=T,this.pixelRatio=M,this.alpha=O,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(r,a){let n=`g${this.uuid.toString().replace(/-/g,"")}`;if(r.require("vWorldViewDir"),r.require("worldNormal"),r.extensions.derivatives=!0,this.compensation.value&&r.define("OUTLINE_COMPENSATION",`${n}_offset`),this.firstTime){let o=this.outlineWidth.build(r,"f"),f=this.resolution.build(r,"v2"),y=this.compensation.build(r,"b"),x=this.pixelRatio.build(r,"f");r.addVertexParsVariable("randomColor","attribute vec3"),r.addVertexParsVariable("extrudeNormal","attribute vec3"),r.addVertexParsVariable(o,"uniform float"),r.addVertexParsVariable(f,"uniform vec2"),r.addVertexParsVariable(y,"uniform bool"),r.addVertexParsVariable(x,"uniform float"),r.addVertexParsVariable("vID","flat out float"),r.addFragmentParsVariable("vID","flat in float"),r.addVertexFinalCode(`
                vID = randomColor.r;
                vec2 ${n}_offset = vec2(0.0);
                if (${y}) {
                    vec4 ${n}_clipPosition = projectionMatrix * (modelViewMatrix * vec4(transformed, 1.0));
                    // NOTE: For certain shapes, like spheres, we get incorrect extrusion when the
                    // normals face the camera directly. So we hackily fix this by offsetting the normal
                    // by a tiny amount.
                    vec3 ${n}_clipNormal = mat3(projectionMatrix) * (mat3(modelViewMatrix) * extrudeNormal) + 0.0000001;
                    ${n}_offset = normalize(${n}_clipNormal.xy) / ${f} * (${o} / 2.0) * ${n}_clipPosition.w * 2.0 * ${x};
                    ${n}_clipPosition.xy += ${n}_offset;
                    // TODO(MAX): To handle multiple outline layers, we only want to extrude
                    // if this offset is the biggest of all the potential offsets
                    gl_Position = ${n}_clipPosition;
                }
            `)}if(r.isShader("fragment")){r.require("uv"),r.requires.uv=[!0],r.addFragmentVariable(this.calpha,"float");let o=r.include(vE.Nodes.outline),f=[];return f.push(this.outlineColor.build(r,"c")),f.push(this.contourColor.build(r,"c")),f.push(this.outlineWidth.build(r,"f")),f.push(this.contourWidth.build(r,"f")),f.push(this.contourThreshold.build(r,"f")),f.push(this.outlineThreshold.build(r,"f")),f.push(this.contourFrequency.build(r,"f")),f.push(this.outlineSmoothing.build(r,"f")),f.push(this.contourDirection.build(r,"v3")),f.push(this.positionalLines.build(r,"b")),f.push(this.resolution.build(r,"v2")),f.push(this.normalMap.getTexture(r,"t")),f.push(this.depthMap.getTexture(r,"t")),f.push(this.pixelRatio.build(r,"f")),f.push(this.compensation.build(r,"b")),f.push(this.mask?`luminance(${this.mask.flow(r,"v3").result})`:"1.0"),f.push(this.alpha.build(r,"f")),f.push(this.calpha),this.firstTime=!this.firstTime,r.format(o+"("+f.join(",")+")",this.getType(r),a)}else return console.warn("OutlineNode is not compatible with "+r.shader+" shader."),""}},ef=vE;ef.Nodes=function(){let r=new Ae(`
float sobelSample(sampler2D t, sampler2D d, vec2 uv, vec2 resolution, float outlineWidth, float pixelRatio)
{
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    vec2 texelSize = (vec2(1.0) / resolution);
    vec2 offsetSize = texelSize * outlineWidth * pixelRatio;

    vec2 uvSamples[9];
    vec4 normalSamples[9];

	uvSamples[0] = uv + vec2( -offsetSize.x, -offsetSize.y) + (vogelDiskSample(0, 9, temporalAngle) * texelSize);
	uvSamples[1] = uv + vec2(0.0, -offsetSize.y) + (vogelDiskSample(1, 9, temporalAngle) * texelSize);
	uvSamples[2] = uv + vec2(  offsetSize.x, -offsetSize.y) + (vogelDiskSample(2, 9, temporalAngle) * texelSize);
	uvSamples[3] = uv + vec2( -offsetSize.x, 0.0) + (vogelDiskSample(3, 9, temporalAngle) * texelSize);
	uvSamples[4] = uv;
	uvSamples[5] = uv + vec2(  offsetSize.x, 0.0) + (vogelDiskSample(5, 9, temporalAngle) * texelSize);
	uvSamples[6] = uv + vec2( -offsetSize.x, offsetSize.y) + (vogelDiskSample(6, 9, temporalAngle) * texelSize);
	uvSamples[7] = uv + vec2(0.0, offsetSize.y) + (vogelDiskSample(7, 9, temporalAngle) * texelSize);
	uvSamples[8] = uv + vec2(  offsetSize.x, offsetSize.y) + (vogelDiskSample(8, 9, temporalAngle) * texelSize);


    normalSamples[0] = texture2D(t, uvSamples[0]);
    normalSamples[1] = texture2D(t, uvSamples[1]);
    normalSamples[2] = texture2D(t, uvSamples[2]);
    normalSamples[3] = texture2D(t, uvSamples[3]);
    normalSamples[4] = texture2D(t, uvSamples[4]);
    normalSamples[5] = texture2D(t, uvSamples[5]);
    normalSamples[6] = texture2D(t, uvSamples[6]);
    normalSamples[7] = texture2D(t, uvSamples[7]);
    normalSamples[8] = texture2D(t, uvSamples[8]);

    float depthBias = 0.0001;
    // TODO(MAX): Can we somehow reduce the number of conditionals here with MATH?!
    if (normalSamples[0].a != vID && normalSamples[0].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[0]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[1].a != vID && normalSamples[1].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[1]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[2].a != vID && normalSamples[2].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[2]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[3].a != vID && normalSamples[3].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[3]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }


    if (normalSamples[4].a != vID && normalSamples[4].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[4]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[5].a != vID && normalSamples[5].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[5]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[6].a != vID && normalSamples[6].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[6]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[7].a != vID && normalSamples[7].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[7]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[8].a != vID && normalSamples[8].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[8]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    vec3 sobel_edge_h = normalSamples[2].rgb + (2.0*normalSamples[5].rgb) + normalSamples[8].rgb - (normalSamples[0].rgb + (2.0*normalSamples[3].rgb) + normalSamples[6].rgb);
  	vec3 sobel_edge_v = normalSamples[0].rgb + (2.0*normalSamples[1].rgb) + normalSamples[2].rgb - (normalSamples[6].rgb + (2.0*normalSamples[7].rgb) + normalSamples[8].rgb);

    float edgeNormal = sqrt(dot(sobel_edge_h, sobel_edge_h) + dot(sobel_edge_v, sobel_edge_v));
    return edgeNormal;
}
`);return{outline:new Ae(`vec3 outline(vec3 outlineColor, vec3 contourColor, float outlineWidth, float contourWidth, float outlineThreshold, float contourThreshold, float outlineSmoothing, float contourFrequency, vec3 contourDirection, bool positionalLines, vec2 resolution, sampler2D normalMap, sampler2D depthMap, float pixelRatio, bool compensation, float mask, float alpha, out float calpha) {
                vec3 result = outlineColor;
                float resultAlpha = 0.0;

                vec3 N = normalize(vWNormal);
                vec2 nuv = (gl_FragCoord.xy / resolution);
                float sobelSample = compensation ? sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth / 2., pixelRatio) : sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth, pixelRatio);
                resultAlpha = smoothstep(outlineThreshold - outlineSmoothing, outlineThreshold + outlineSmoothing, sobelSample);

                //resultAlpha = 1.0;
                //result = vec3(sobelSample);

                float t = 1.0 - contourThreshold;
                if(positionalLines) {
                    vec3 NDir = position * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float f  = fract(NT * contourFrequency * 0.01);
                    float df = fwidth(NT * contourFrequency);

                    float g = smoothstep(df * (contourWidth * 0.01), df * (contourWidth * 0.01 * 2.0), f);
                    if (g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0;
                    }
                 }
                 else {
                    vec3 NDir = N * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float df = fwidth(NT * contourThreshold);
                    float f = sin(NT * 1.0 * contourFrequency);
                    float g = smoothstep(0.0, df * contourWidth, 1.0 - f);

                    if (df > (t * 0.5) && g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0 - g;
                    }
                 }

                 float lalpha = alpha * resultAlpha * mask;
                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				 
                 return result;
             }`,[r])}}();var Uo=class extends rt{constructor(r,a,n,o,f,y,x,b,_,S,A,C,P,T,M,O,I,D){super("v3"),this.nodeType="Pattern",this.style=r,this.projection=a,this.axis=n,this.blending=o,this.offset=f,this.colorA=y,this.colorB=x,this.frequency=b,this.size=_,this.variation=S,this.smoothness=A,this.zigzag=C,this.rotation=P,this.vertical=T,this.horizontal=M,this.sides=O,this.isMask=D,this.alpha=I,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(r,a){if(r.isShader("fragment")){r.require("position"),r.require("uv"),r.requires.uv=[!0],r.require("normal"),r.requires.normal=!0,r.addFragmentVariable(this.calpha,"float");let n;switch(this.style.value){case 0:n="circle";break;case 1:n="ring";break;case 2:n="polygon";break;case 3:n="xcross";break;case 4:n="diamond";break;case 5:n="checkerboard";break;case 6:n="line";break;case 7:n="wave";break;default:n="circle";break}let o=`g${this.uuid.toString().replace(/-/g,"")}`,f=new Ae(`float hashwithoutsine12(vec2 p)
				{
					vec3 p3 = fract(vec3(p.xyx) * .1031);
					p3 += dot(p3, p3.yzx + 33.33);
					return fract((p3.x + p3.y) * p3.z);
				}`),y=new Ae(`vec2 rotate_uv(in vec2 uv, float a, bool repeat) 
				{
					const float mid = 0.5;
					float radians = a * (PI / 180.0);
					vec2 rotated = vec2(
						cos(radians) * (uv.x - mid) + sin(radians) * (uv.y - mid) + mid,
						cos(radians) * (uv.y - mid) - sin(radians) * (uv.x - mid) + mid
					);
					return repeat ? fract(rotated): rotated;
				}`),x="";if(this.projection.value===4){let A=this.style.value===2?`${n}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${n}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,C=this.style.value===2?`${n}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${n}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,P=this.style.value===2?`${n}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${n}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation)`;x=`
				vec3 p = position;
				float factor = 0.0125;
				vec2 uv0 = fract(p.xy * factor);
				vec2 uv1 = fract(p.zy * factor);
				vec2 uv2 = fract(p.xz * factor);
				
				uv0 = rotate_uv(uv0 + offset, rotation, true);
				uv1 = rotate_uv(uv1 + offset, rotation, true);
				uv2 = rotate_uv(uv2 + offset, rotation, true);
	
				float d0 = ${A};
				float d1 = ${C};
				float d2 = ${P};
				
				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));
				d0 *= weights.z;
				d1 *= weights.x;
				d2 *= weights.y;
				float draw = d0 + d1 + d2;
	
				vec2 custom_uv = uv0 * weights.z + uv1 * weights.x + uv2 * weights.y;
				`}else{let A=this.style.value===2?`${n}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${n}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,C="";this.axis.value===0?C=`float radius = length(p);
					float theta = atan(p.y, p.z);
					float phi = acos(p.x / radius);`:this.axis.value===1?C=`float radius = length(p);
					float theta = atan(p.x, p.z);
					float phi = acos(p.y / radius);`:(this.axis.value,C=`float radius = length(p);
					float theta = atan(p.y, p.x);
					float phi = acos(p.z / radius);`);let P="";switch(this.projection.value){case 0:P="custom_uv = vUv.st;";break;case 1:break;case 2:P=`
							vec3 p = position;
							${C}
							custom_uv = vec2(theta, phi);
							custom_uv /= PI;
							`;break}x=`
				vec2 custom_uv;
				${P}
	
				custom_uv += offset;
				custom_uv = fract(custom_uv);
				custom_uv = rotate_uv(custom_uv, rotation, true);
	
				float draw = ${A};
				`}let b=new Ae(`vec3 ${o}_pattern(vec3 normal, float blending, int style, vec2 offset, vec4 colorA, vec4 colorB, vec2 frequency, float size, float variation, float smoothness, float zigzag, float rotation, vec2 vertical, vec2 horizontal, int sides, bool isMask, float mask, float alpha, out float calpha) {
					const float TWO_PI = PI * 2.0;
					float smoothness_remapped = pow(smoothness, 5.0);	

					${x}

					// Construct final output color
					vec4 color = mix(colorA, colorB, draw);
					color.a = clamp(color.a, 0.0, 1.0);

					// Apply cuts
					color.a *= 
						step(vertical.x, custom_uv.y) * 
						step(custom_uv.y, vertical.y);
					color.a *= 
						step(horizontal.x, abs(custom_uv.x)) * 
						step(abs(custom_uv.x), horizontal.y);

					// Accumulate alpha 
					float lalpha = alpha * clamp(color.a, 0.0, 1.0) * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return clamp(color, 0.0, 1.0).rgb;
				}`,[y,f,Uo.DrawFunctions.circle,Uo.DrawFunctions.ring,Uo.DrawFunctions.polygon,Uo.DrawFunctions.cross,Uo.DrawFunctions.diamond,Uo.DrawFunctions.checkerboard,Uo.DrawFunctions.line,Uo.DrawFunctions.wave]),_=r.include(b),S=[];return S.push("normal"),S.push(this.blending.build(r,"f")),S.push(this.style.build(r,"i")),S.push(this.offset.build(r,"v2")),S.push(this.colorA.build(r,"v4")),S.push(this.colorB.build(r,"v4")),S.push(this.frequency.build(r,"v2")),S.push(this.size.build(r,"f")),S.push(this.variation.build(r,"f")),S.push(this.smoothness.build(r,"f")),S.push(this.zigzag.build(r,"f")),S.push(this.rotation.build(r,"f")),S.push(this.vertical.build(r,"v2")),S.push(this.horizontal.build(r,"v2")),S.push(this.sides.build(r,"i")),S.push(this.isMask.build(r,"b")),S.push(this.mask?`luminance(${this.mask.flow(r,"v3").result})`:"1.0"),S.push(this.alpha.build(r,"f")),S.push(this.calpha),r.format(_+"("+S.join(",")+")",this.getType(r),a)}else return console.warn("PatterNode is not compatible with "+r.shader+" shader."),r.format("vec3(0.0)",this.getType(r),a)}},tf=Uo;tf.DrawFunctions=function(){let r=new Ae(`float hashwithoutsine12(vec2 p) {
				vec3 p3 = fract(vec3(p.xyx) * 0.1031);
				p3 += dot(p3, p3.yzx + 33.33);
				return fract((p3.x + p3.y) * p3.z);
			}`),a=new Ae(`vec2 tile_and_center(in vec2 uv, in vec2 frequency, in float variation, in float zigzag, in float rotation) {
                // Create tiles in UV-space
                uv *= frequency;

                // Integer coords
                vec2 i = floor(uv);

                // Offset every other row based on zigzag param, then compute fractional coords
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = fract(uv);

				// Rotate the tile itself:
				// const float mid = 0.5;
				// f = vec2(
				// 	cos(rotation) * (f.x - mid) + sin(rotation) * (f.y - mid) + mid,
				// 	cos(rotation) * (f.y - mid) - sin(rotation) * (f.x - mid) + mid
				// );
				// f = fract(f);

                f = f * 2.0 - 1.0;

				// Recompute integer coords after shifting - then, random value per tile 
				i = floor(uv);
				float rand = (hashwithoutsine12(i) * 5.0 + 1.0);
				float jitter = mix(1.0, rand, variation);
				f *= jitter;

                return f;
            }`,[r]),n=new Ae(`float circle(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(
                    -smoothness, 
                     smoothness, 
                     length(f) - size
                );
            }`,[a]),o=new Ae(`float ring(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);

				float d = length(f);
                const float inner_width = 0.5;

                float outer = smoothstep(-smoothness, smoothness, d - size);
                float inner = smoothstep(-smoothness, smoothness, d - size * inner_width);
				return outer + (1.0 - inner);   
            }`,[a]),f=new Ae(`float sdf_ngon(in vec2 p, in float r, in int n) {
                float an = (PI * 2.0) / float(n);
                float he = r * tan(0.5 * an);
                
                // Rotate to first sector
                p = -p.yx; 
                float bn = an * floor((atan(p.y, p.x) + 0.5 * an) / an);
                vec2  cs = vec2(cos(bn), sin(bn));
                p = mat2(cs.x, -cs.y, cs.y, cs.x)*p;
            
                // Side of polygon
                return length(p - vec2(r, clamp(p.y, -he, he))) * sign(p.x - r);
            }
            
            float polygon(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation, in int sides) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_ngon(f, size, sides));
            }`,[a]),y=new Ae(`float sdf_cross(in vec2 p, in vec2 b, float r ) {
                p = abs(p); 
				p = (p.y > p.x) ? p.yx : p.xy;
                vec2  q = p - b;
                float k = max(q.y, q.x);
                vec2  w = (k > 0.0) ? q : vec2(b.y - p.x, -k);
                return sign(k) * length(max(w, 0.0)) + r;
            }
            
            // Avoid namespace conflicts 
            float xcross(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_cross(f, vec2(size, size * 0.25), smoothness));
            }`,[a]),x=new Ae(`float ndot(vec2 a, vec2 b) { 
                return a.x*b.x - a.y*b.y; 
            }
            
            float sdf_diamond(in vec2 p, in vec2 b) {
                p = abs(p);
                float h = clamp(ndot(b - 2.0 * p, b) / dot(b, b), -1.0, 1.0);
                float d = length(p - 0.5 * b * vec2(1.0 - h, 1.0 + h));
                return d * sign(p.x * b.y + p.y * b.x - b.x * b.y);
            }

            float diamond(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
	            return smoothstep(-smoothness, smoothness, sdf_diamond(f, vec2(size)));
            }`,[a]),b=new Ae(`float checkerboard(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                uv *= frequency;
                vec2 i = floor(uv);

                float offset = mod(i.y, 2.0);

                uv.x += offset + zigzag * offset;
                float x = floor(uv.x);
                
                return mod(x, 2.0);
            }`),_=new Ae(`float line(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, 0.0, zigzag, rotation);
				
				// Different approach for variation param here
				float row = floor(uv * frequency).y;
				float rand = hashwithoutsine12(vec2(row));
				float s = mix(size, size * rand, variation);

				return smoothstep(
					s - smoothness, 
					s + smoothness, 
					abs(f.y)
				);
            }`,[a]),S=new Ae(`// Uses bisection 
            float udf_cos(in vec2 p, in float a, in float b, in float c, in float d) {
                // Convert all data to a primitive cosine wave
                p = c * (p - vec2(d, a));
                
                const float TWO_PI = PI * 2.0;

                // Reduce to principal half cycle
                p.x = mod(p.x, TWO_PI); 
                if (p.x > PI) {
                    p.x = TWO_PI - p.x;
                }
            
                // Find zero of derivative (minimize distance)
                float xa = 0.0;
                float xb = TWO_PI;

                // 24 bit precision
                for (int i = 0; i < 24; i++) {
                    float x = 0.5 * (xa + xb);
                    float y = x - p.x + b * c * sin(x) * (p.y - b * c * cos(x));
                    if (y < 0.0) xa = x; 
                    else xb = x;
                }
                float x = 0.5 * (xa + xb);
                
                // Compute distance    
                vec2 q = vec2(x, b * c * cos(x));
                return length(p - q) / c;
            }

            float wave(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                float repeat = frequency.x;
                uv *= repeat;
                vec2 i = floor(uv);
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = vec2(uv.x, fract(uv.y));

                // Generalized cosine: y(x) = a + b * cos(cx + d)
                const float amplitude = 0.125;
                float wave_frequency = frequency.y * 0.1;
                float distance_estimate = udf_cos(f, 0.50, amplitude, wave_frequency * (2.0 * PI), 0.0);

				// Different approach for variation param here
				float rand = hashwithoutsine12(vec2(i.y));
				float s = mix(size, size * rand, variation);

                return smoothstep(-smoothness, smoothness, distance_estimate - s * 0.5);
            }`);return{tileAndCenter:a,circle:n,ring:o,polygon:f,cross:y,diamond:x,checkerboard:b,line:_,wave:S}}();var xE=class extends rt{constructor(r,a,n,o,f,y,x,b){super("v3"),this.nodeType="Rainbow",this.filmThickness=r,this.movement=a,this.wavelengths=n,this.noiseStrength=o,this.noiseScale=f,this.offset=y,this.isMask=b,this.alpha=x,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(r,a){if(r.require("vWorldViewDir"),r.require("worldNormal"),r.isShader("fragment")){r.require("uv"),r.requires.uv=[!0],r.addFragmentVariable(this.calpha,"float");let n=r.include(xE.Nodes.rainbow),o=[];return o.push(this.filmThickness.build(r,"f")),o.push(this.movement.build(r,"f")),o.push(this.wavelengths.build(r,"v3")),o.push(this.noiseStrength.build(r,"f")),o.push(this.noiseScale.build(r,"f")),o.push(this.offset.build(r,"v3")),o.push(this.isMask.build(r,"b")),o.push(this.mask?`luminance(${this.mask.flow(r,"v3").result})`:"1.0"),o.push(this.alpha.build(r,"f")),o.push(this.calpha),r.format(n+"("+o.join(",")+")",this.getType(r),a)}else return console.warn("RainbowNode is not compatible with "+r.shader+" shader."),r.format("vec3( 0.0 )",this.getType(r),a)}},rf=xE;rf.Nodes=function(){let r=new Ae(`vec3 attenuation(vec3 wavelengths, float filmThickness, float movement, float noiseStrength, float noiseScale, vec3 offset) {
				float f = 0.0;
				
				if (noiseStrength != 0.0) {
					vec3 st = position / noiseScale;
					float noise = simplexFast(1.6 * st + vec3(1.8, 1.5, 1.9) * simplexFast(st) + vec3(1.7, 9.2, 1.0));
					f = noise * noiseStrength;
				}

				vec3 waves = wavelengths * vec3(1.0, 0.8, 0.6) + 1.0;
				float angle = dot(normalize(vWorldViewDir + (offset * -0.001)), normalize(vWNormal));

				mediump vec3 color = cos((((filmThickness + f) / waves) * angle) + movement);
				return .5 + .5 * color;
			 }`,[ji.simplexFast]);return{rainbow:new Ae(`vec3 rainbow(float filmThickness, float movement, vec3 wavelengths, float noiseStrength, float noiseScale, vec3 offset, bool isMask, float mask, float alpha, out float calpha) {
				mediump vec3 res = clamp(attenuation(wavelengths, filmThickness, movement, noiseStrength, noiseScale, offset), 0.0, 2.0);

				float rainbowContribution = clamp(res.r + res.g + res.b, 0.0, 1.0);

				float lalpha = alpha * rainbowContribution * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return res;
			 }`,[r])}}();var bE=class extends rt{constructor(r,a,n,o,f,y,x,b,_,S){super("v3"),this.nodeType="Toon",this.positioning=r,this.colors=a,this.steps=n,this.source=o,this.isWorldSpace=f,this.noiseStrength=y,this.noiseScale=x,this.shadowColor=b,this.offset=_,this.alpha=S,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(r,a){if(r.require("worldNormal"),r.require("worldPosition"),r.isShader("fragment")){r.define("COLORS_MAX",10),r.addFragmentVariable(this.calpha,"float");let n=r.include(bE.Nodes.toon),o=[];return o.push(this.positioning.build(r,"i")),o.push(this.colors.build(r,"v4[]")),o.push(this.steps.build(r,"f[]")),o.push(this.source.build(r,"v3")),o.push(this.isWorldSpace.build(r,"b")),o.push(this.noiseStrength.build(r,"f")),o.push(this.noiseScale.build(r,"f")),o.push(this.shadowColor.build(r,"v4")),o.push(this.offset.build(r,"v3")),o.push(this.mask?`luminance(${this.mask.flow(r,"v3").result})`:"1.0"),o.push(this.alpha.build(r,"f")),o.push(this.calpha),r.format(n+"("+o.join(",")+")",this.getType(r),a)}else return console.warn("ToonNode is not compatible with "+r.shader+" shader."),r.format("vec3( 0.0 )",this.getType(r),a)}},nf=bE;nf.Nodes=function(){let r=new Ae(`float rand(float n) {
				return fract(sin(n) * 43758.5453123);
			}`),a=new Ae(`float hash1(float p) { 
				p = fract(p * 0.011); 
				p *= p + 7.5; 
				p *= p + p; 
				return fract(p); 
			}`),n=new Ae(`float valueNoise(vec3 x) {
				const vec3 step = vec3(110, 241, 171);
			
				vec3 i = floor(x);
				vec3 f = fract(x);
			 
				// For performance, compute the base input to a 1D hash from the integer part of the argument and the 
				// incremental change to the 1D based on the 3D -> 1D wrapping
				float n = dot(i, step);
			
				vec3 u = f * f * (3.0 - 2.0 * f);
				return mix(mix(mix( hash1(n + dot(step, vec3(0, 0, 0))), hash1(n + dot(step, vec3(1, 0, 0))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 0))), hash1(n + dot(step, vec3(1, 1, 0))), u.x), u.y),
						   mix(mix( hash1(n + dot(step, vec3(0, 0, 1))), hash1(n + dot(step, vec3(1, 0, 1))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 1))), hash1(n + dot(step, vec3(1, 1, 1))), u.x), u.y), u.z);
			}`,[a]),o=new Ae(`vec3 hash3(vec3 x) {
				x = vec3(dot(x,vec3(127.1, 311.7, 74.7)),
						 dot(x,vec3(269.5, 183.3, 246.1)),
						 dot(x,vec3(113.5, 271.9, 124.6)));
			
				return fract(sin(x)*43758.5453123);
			}`),f=new Ae(`vec3 voronoiNoise(in vec3 x)
			{
				vec3 p = floor(x);
				vec3 f = fract(x);

				float id = 0.0;
				vec2 res = vec2(100.0);

				for(int k=-1; k<=1; k++)
				for(int j=-1; j<=1; j++)
				for(int i=-1; i<=1; i++)
				{
					vec3 b = vec3(float(i), float(j), float(k));

					// Comment out the "+ hash(p + b);" part below to get "square" cells
					vec3 r = vec3(b) - f + hash3(p + b);
					float d = dot(r, r);

					if (d < res.x)
					{
						id = dot(p + b, vec3(1.0, 57.0, 113.0));
						res = vec2(d, res.x);			
					}
					else if (d < res.y)
					{
						res.y = d;
					}
				}

				return vec3(sqrt(res), abs(id));
			}
			`,[o]);return{toon:new Ae(`vec3 toon(int positioning, vec4 colors[COLORS_MAX], float steps[COLORS_MAX], vec3 source, bool isWorldSpace, float noiseStrength, float noiseScale, vec4 shadowColor, vec3 offset, float mask, float alpha, out float calpha) {
				float t = 0.0;
				float shadow = 1.0;

				if (positioning == 0) {

					// Can't do this mode if lighting is "none"
					#if (defined(PHONG) || defined(LAMBERT) || defined(STANDARD))

						// Algorithm from Chapter 10 of Graphics Shaders
						const vec3 weights = vec3(0.2125, 0.7154, 0.0721);
						vec3 lpos;
						vec3 l;
						float dproduct;

						#if (NUM_POINT_LIGHTS > 0)

							#if defined(USE_SHADOWMAP) && (NUM_POINT_LIGHT_SHADOWS > 0)
								PointLightShadow pointLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_POINT_LIGHTS; i++) {
								// Light positions are in view-space for some reason?
								lpos = (inverse(viewMatrix) * vec4(pointLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								
								// TODO: we want to use "intensity" but it isn't available in the shader code
								//dproduct += dot(pointLights[UNROLLED_LOOP_INDEX].color, weights);

								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS)
									pointLightShadow = pointLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getPointShadow( 
											pointShadowMap[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowMapSize, 
											pointLightShadow.shadowBias, 
											pointLightShadow.shadowRadius,
											vPointShadowCoord[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowCameraNear, 
											pointLightShadow.shadowCameraFar);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_DIR_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_DIR_LIGHT_SHADOWS > 0)
								DirectionalLightShadow directionalLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_DIR_LIGHTS; i++) {
								// Use the direction vector for directional lights instead
								l = (inverse(viewMatrix) * vec4(directionalLights[UNROLLED_LOOP_INDEX].direction, 0.0)).xyz;
		
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS)
									directionalLightShadow = directionalLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow( 
										UNROLLED_LOOP_INDEX,
										directionalShadowMap[UNROLLED_LOOP_INDEX], 
										directionalLightShadow.shadowMapSize, 
										directionalLightShadow.shadowBias, 
										directionalLightShadow.shadowRadius, 
										vDirectionalShadowCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_SPOT_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_SPOT_LIGHT_SHADOWS > 0)
								SpotLightShadow spotLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_SPOT_LIGHTS; i++) {
								lpos = (inverse(viewMatrix) * vec4(spotLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS)
									spotLightShadow = spotLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow(
										UNROLLED_LOOP_INDEX,
										spotShadowMap[UNROLLED_LOOP_INDEX], 
										spotLightShadow.shadowMapSize, 
										spotLightShadow.shadowBias, 
										spotLightShadow.shadowRadius, 
										vSpotLightCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						t = clamp(t, 0.0, 1.0);
				
					#endif

				} else if (positioning == 1) {
					
					vec3 origin = mix(position, worldPosition, float(isWorldSpace));
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	

				} else {

					vec3 origin = worldPosition;
					vec3 source = cameraPosition - offset;
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	
					
				}

				if (noiseStrength > 0.0) {
					// Distort with noise
					vec3 st = position / noiseScale;
					
					// Voronoi "smooth" noise
					float noise = 1.0 - voronoiNoise(st).x;

					// Voronoi cellular noise
					//float noise = 1.0 - rand(voronoiNoise(st).z);

					// Position warp noise
					// vec3 offset = vec3(
					// 	simplexFast(st),
					// 	simplexFast(st + vec3(111.1, 143.89, 217.19)),
					// 	simplexFast(st + vec3(171.1, 247.89, 117.23))
					// );
					// st += offset;
					// float noise = valueNoise(st);

					t += noise * noiseStrength;
				}

				t = clamp(t, 0.0, 1.0);

				// Compute ramp color
				float p;
				vec4 color = colors[0];
				for (int i = 1; i < COLORS_MAX; i++) {
					p = clamp((t - steps[i-1]) / (steps[i] - steps[i-1]), 0.0, 1.0);
					color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
				}

				// Incorporate custom shadow color
				if (positioning == 0) {

					vec3 blendedShadow = mix(color.rgb, shadowColor.rgb, shadowColor.a);
					color.rgb = mix(blendedShadow, color.rgb, shadow);
				
				}

				// Accumulate alpha as usual
				float lalpha = alpha * color.a * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color.xyz;

            }`,[ji.simplexFast,r,n,f])}}();var BR=function(){return{textureBicubic:new Ae(`float w0( float a ) {
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
        }
    
        float w1( float a ) {
            return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
        }
    
        float w2( float a ){
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
        }
    
        float w3( float a ) {
            return ( 1.0 / 6.0 ) * ( a * a * a );
        }
    
        // g0 and g1 are the two amplitude functions
        float g0( float a ) {
            return w0( a ) + w1( a );
        }
    
        float g1( float a ) {
            return w2( a ) + w3( a );
        }
    
        // h0 and h1 are the two offset functions
        float h0( float a ) {
            return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
        }
    
        float h1( float a ) {
            return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
        }
    
        vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
            uv = uv * texelSize.zw + 0.5;
    
            vec2 iuv = floor( uv );
            vec2 fuv = fract( uv );
    
            float g0x = g0( fuv.x );
            float g1x = g1( fuv.x );
            float h0x = h0( fuv.x );
            float h1x = h1( fuv.x );
            float h0y = h0( fuv.y );
            float h1y = h1( fuv.y );
    
            vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
            vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
    
            return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) + 
                   g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
        }

        vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
            vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
            vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
            vec2 fLodSizeInv = 1.0 / fLodSize;
            vec2 cLodSizeInv = 1.0 / cLodSize;
            vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
            vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
            return mix( fSample, cSample, fract( lod ) );
        }`)}}(),SE=class extends rt{constructor(r,a,n,o,f,y,x,b){super("v3"),this.nodeType="Transmission",this.thickness=r,this.ior=a,this.roughness=n,this.transmissionSamplerSize=o,this.transmissionSamplerMap=f,this.transmissionDepthMap=y,this.aspectRatio=x,this.alpha=b,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(r,a){if(r.extensions.shaderTextureLOD=!0,r.extensions.derivatives=!0,r.isShader("fragment")){r.define("NUM_SAMPLES",6),r.define("BLUR_SLOD",Math.pow(2,et.transmissionLod.value)),r.require("worldPosition"),r.requires.worldNormal=!0,r.requires.modelMatrix=!0,r.requires.projectionMatrix=!0,r.addFragmentVariable(this.calpha,"float");let n=r.include(SE.Nodes.transmission),o=[];return o.push(this.thickness.build(r,"f")),o.push(this.ior.build(r,"f")),o.push(this.roughness.build(r,"f")),o.push(this.transmissionSamplerSize.build(r,"v2")),o.push(this.transmissionSamplerMap.getTexture(r,"t")),o.push(this.transmissionDepthMap.getTexture(r,"t")),o.push(this.aspectRatio.build(r,"v2")),o.push("normal"),o.push(this.mask?`luminance(${this.mask.flow(r,"v3").result})`:"1.0"),o.push(this.alpha.build(r,"f")),o.push(this.calpha),r.format(n+"("+o.join(",")+")",this.getType(r),a)}else return console.warn("TransmissionNode is not compatible with "+r.shader+" shader."),r.format("vec3( 0.0 )",this.getType(r),a)}},sf=SE;sf.Nodes=function(){let r=new Ae(`vec3 blur(sampler2D sp, vec2 U, vec2 scale, float lod, sampler2D dm, vec2 unrefractedU, vec2 aspectRatio) {
                // Slightly modified version of this:
                // https://www.shadertoy.com/view/ltScRG

				// Special case for blur == 0.0
				if (lod == 0.0) {
					#ifdef TEXTURE_LOD_EXT
					return texture2DLodEXT( sp, U, 0.0).rgb;
					#else
					return textureLod( sp, U, 0.0).rgb;
					#endif
				}
				
				vec2 texelSize = vec2(1.0) / resolution;
                vec2 halton = haltonSequence[frameIndex];
                float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
                float temporalAngle  = temporalOffset * PI2;
				vec3 res = vec3(0.0);
                vec2 uv = vec2(0.0);
                vec2 offset = vec2(0.0);
                vec2 vogelSample = vec2(0.0);
                for (int i = 0; i < NUM_SAMPLES; i++) {
                    vogelSample =  vogelDiskSample(i, NUM_SAMPLES, temporalAngle) * texelSize;
                    offset = vogelSample * scale * (lod * 10.0); // TODO: used to be hardcoded to 20
                    uv = U + offset;
                    float opaqueDepth = unpackRGBAToDepth(textureLod(dm, uv, lod));
                    if (opaqueDepth != 0.0 && opaqueDepth < gl_FragCoord.z) {
                        uv = unrefractedU;
                        lod = lod > 4.0 ? lod : lod / 2.0;
                    }
                    res += textureLod(sp, uv, lod).rgb;
                }
                return res / float(NUM_SAMPLES);
            }`),a=new Ae(`vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {
		        // Direction of refracted light.
		        vec3 refractionVector = refract( -v,  n, 1.0 / ior );
		        
				// Compute rotation-independant scaling of the model matrix.
		        vec3 modelScale;
		        modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		        modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		        modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );

		        // The thickness is specified in local space
		        return normalize( refractionVector ) * thickness * modelScale;
	        }`),n=new Ae(`float applyIorToRoughness( float roughness, float ior ) {
				// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
				// an IOR of 1.5 results in the default amount of microfacet refraction.
				return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
			}`),o=new Ae(`vec3 getTransmissionSample( vec2 fragCoord, float roughness, float ior, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 unrefractedCoords, vec2 aspectRatio) {
				// Threejs exports do not pass a depth map to this shader, so we have to fallback to the "Threejs method of blurring" - see
				// also the code in convertTransmission.ts, which runs during export
				#ifdef IS_THREEJS_EXPORT
					float lod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness / 5.0, ior);
					return textureBicubic(transmissionSamplerMap, fragCoord.xy, lod).rgb;
				#else
					float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
					float lod = applyIorToRoughness(roughness, ior);
					return blur(transmissionSamplerMap, fragCoord, vec2(lod), min(framebufferLod / 5.5, 8.5), transmissionDepthMap, unrefractedCoords, aspectRatio);
				#endif
			}`,[BR.textureBicubic,n,r]),f=new Ae(`vec3 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;

				// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
				vec4 ndcPos = projMatrix * viewMatrix *  vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;

				vec4 ndcPosUnrefracted = projMatrix * viewMatrix * vec4(position, 1.0 );
				vec2 unrefractedCoords = ndcPosUnrefracted.xy / ndcPosUnrefracted.w;
				unrefractedCoords += 1.0;
				unrefractedCoords /= 2.0;

				// Sample framebuffer to get pixel the refracted ray hits.
				return getTransmissionSample( refractionCoords, roughness, ior, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, unrefractedCoords, aspectRatio );
    		}`,[o,a]);return{transmission:new Ae(`vec3 transmission(float thickness, float ior, float roughness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio, vec3 normal, float mask, float alpha, out float calpha) {
                vec3 v = vec3(0.);
                if (isOrthographic) {
                    v = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
                } else {
                    v = normalize(vWPosition - cameraPosition);
                }
                vec3 transmission = getIBLVolumeRefraction(vWNormal, -v, roughness,  vWPosition, modelMatrix, viewMatrix, projectionMatrix, ior, thickness, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, aspectRatio );
                
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * alpha;

				return transmission;
            }`,[f])}}();var wE=(r=>(r.NOISE="noise",r.MAP="map",r))(wE||{}),AE=class extends rt{constructor(r,a,n,o,f,y,x,b,_,S,A){super("v3"),this.displacementTypeIndex=new Lt(0),this.nodeType="VertexDisplacement",this.intensity=r,this.movementOrTexture=a,Object.values(wE)[this.displacementTypeIndex.value]==="map"&&(this.mat=new Wd(this.movementOrTexture.value.matrix)),this.cropOrOffset=n,this.scale=S,this.noiseFunctionIndex=A,this.voronoiStyle=o,this.smoothness=f,this.seed=y,this.highCut=x,this.lowCut=b,this.quality=_}generate(r,a){if(r.isShader("vertex")){r.define("USE_LAYER_DISPLACE");let n,o=[];switch(o.push("displaced_position"),o.push("displaced_normal"),Object.values(wE)[this.displacementTypeIndex.value]){case"map":{n=r.include(AE.Nodes.map),o.push(this.movementOrTexture.getTexture(r,"t")),o.push("uv"),o.push(this.cropOrOffset.build(r,"f")),this.mat&&o.push(this.mat.build(r,"mat3"));break}case"noise":{let f=["simplexPrecise","simplexFractal","simplexAshima","fbm","perlin","voronoi"][this.noiseFunctionIndex.value],y=new Ae(`vec3 orthogonal(vec3 v) {
							return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
						}`),x=f=="voronoi"?`
					float v = ${f}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1), voronoiStyle, smoothness, seed, quality);
					v = remap(v, lowCut, highCut, 0.0, 1.0);
					v = smax(v, 0.0, smoothness * 0.25);
					v = smin(v, 1.0, smoothness * 0.25);

					return p + n * v * intensity;
					`:`
					return p + n * ${f}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1)) * intensity;
					`,b=new Ae(`vec3 distorted(vec3 p, vec3 n, float scale, float intensity, vec3 offset, float neighbour_offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality) {
							${x}
						}`,[ji.simplexPrecise,ji.simplexFractal,ji.simplexAshima,ji.fbm,ji.perlin,ji.voronoi]),_=new Ae(`vec3 vertexDisplacementNoise(vec3 position, vec3 normal, float scale, vec3 offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality, float intensity, out vec3 displaced_normal) {
							vec3 displaced_position = distorted(position, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 tangent1 = orthogonal(normal);
							vec3 tangent2 = normalize(cross(normal, tangent1));

                            // TODO(Max): The distance to the neighbors was originally scaled by 0.1.
                            // This caused some small oval/circular visual artifacts in the lighting.
                            // For now, simply using neighbors further away betters the problem,
                            // but we should figure out the underlying cause when we have some time.
                            // Maybe its related to how we calculate the tangent and bitangent?
							vec3 nearby1 = position + tangent1;
							vec3 nearby2 = position + tangent2;
							vec3 distorted1 = distorted(nearby1, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 distorted2 = distorted(nearby2, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
							return displaced_position;
						}`,[b,y]);n=r.include(_),o.push(this.scale.build(r,"f")),o.push(this.cropOrOffset.build(r,"v3")),o.push(this.movementOrTexture.build(r,"f")),o.push(this.voronoiStyle.build(r,"i")),o.push(this.smoothness.build(r,"f")),o.push(this.seed.build(r,"f")),o.push(this.highCut.build(r,"f")),o.push(this.lowCut.build(r,"f")),o.push(this.quality.build(r,"i"));break}}return o.push(this.intensity.build(r,"f")),o.push("displaced_normal"),r.format(n+"("+o.join(",")+")",this.getType(r),a)}else return console.warn("VertexDisplacementNode is not compatible with "+r.shader+" shader."),r.format("vec3( 0.0 )",this.getType(r),a)}},of=AE;of.Nodes=function(){let r=new Ae(`vec3 orthogonal(vec3 v) {
				return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
			}`),a=new Ae(`float displacementMapTexture(sampler2D tex, float crop, vec2 uv, mat3 mat, vec2 offset) {
				vec2 uvs = (mat * vec3(uv * 2.0 - 1.0, 1.0) / 2.0 + 0.5).xy + offset;
				vec4 tmp = texture2D(tex, uvs);
				vec3 col = tmp.rgb;
				if (crop > 0.5) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						return 0.0;
					}
				}
				return col.r;
			}`);return{map:new Ae(`vec3 vertexDisplacementMap(vec3 position, vec3 normal, sampler2D tex, vec2 uv, float crop, mat3 mat, float intensity, out vec3 displaced_normal) {
				vec3 displaced_position = position + normal * displacementMapTexture(tex, crop, uv, mat, vec2(0.0)) * intensity;
				vec3 tangent1 = normalize(orthogonal(normal));
				vec3 tangent2 = normalize(cross(normal, tangent1));
				vec3 nearby1 = position + tangent1 * 0.1;
				vec3 nearby2 = position + tangent2 * 0.1;
				vec3 distorted1 = nearby1 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				vec3 distorted2 = nearby2 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
				return displaced_position;
			}`,[r,a])}}();var et={normalRenderTarget:new wn,normalRenderTargetDepth:new wn,transmissionRenderTarget:new wn,aspectRatio:new Yr,transmissionSize:new Yr(2048,2048),transmissionRenderTargetDepth:new wn,aoRenderTarget:new wn,aoEnabled:new Jr,pixelRatioNode:new Fe(1),resolution:new Yr,penumbraSize:new Ks(5,.5),frameIndex:new Lt(0),transmissionLod:new Lt(2)};for(let r of Object.values(et))r.isRenderGlobal=!0;var ox={skiaWasmUrl:"https://unpkg.com/@splinetool/ui-wasm@1.10.22/build/ui.wasm"},Fa=class extends lr{constructor(){super("basic"),this.nodeType="Basic",this.color=new ir(ni),this.shadingAlpha=new Fe(1),this.shadingBlend=new Lt(0),this.previousModelViewMatrix=new Qi,this.previouseProjectionMatrix=new Qi}get category(){return"phong"}generate(r){let a;if(r.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(r,"v3",{cache:"position"}):void 0;r.mergeUniform({frameIndex:et.frameIndex}),r.mergeUniform({resolution:et.resolution}),r.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),r.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),r.mergeUniform(Vs.merge([Ie.fog])),r.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>"].join(`
`));let o=["#include <beginnormal_vertex>","#include <morphnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];n&&o.push(n.code,n.result?"displaced_position = "+n.result+";":""),o.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","	vNormal = transformedNormal;","#endif"),o.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>"),o.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),a=o.join(`
`)}else{this.color===void 0&&(this.color=new ir(ni)),this.color.analyze(r,{slot:"color"}),this.alpha&&this.alpha.analyze(r),this.afterColor&&this.afterColor.analyze(r,{slot:"afterColor"});let n=this.color.flow(r,"c",{slot:"color"}),o=this.alpha?this.alpha.flow(r,"f"):void 0,f=this.alphaOverride?this.alphaOverride.flow(r,"f"):void 0,y=this.afterColor?this.afterColor.flow(r,"c",{slot:"afterColor"}):void 0;r.requires.transparent=o!==void 0,r.addParsCode(["varying vec3 vWPosition;","#include <fog_pars_fragment>","#include <dithering_pars_fragment>","varying vec3 vViewPosition;","#include <normal_pars_fragment>"].join(`
`));let x=["#include <normal_fragment_begin>",n.code];o&&x.push(o.code,"#ifdef ALPHATEST"," if ( "+o.result+" <= ALPHATEST ) discard;","#endif"),y?x.push(y.code,`vec3 outgoingLight = ${n.result};`,`vec3 finalColor = spe_blend(outgoingLight, ${y.result}, 1.0, SPE_BLENDING_NORMAL);`):x.push(`vec3 finalColor = ${n.result};`);let b="1.0";this.mask&&(this.mask.analyze(r),b=`luminance(${this.mask.flow(r,"v3").result})`),o?x.push(`gl_FragColor = vec4( finalColor, accumAlpha * ${o.result} * ${b} );`):x.push("gl_FragColor = vec4("+n.result+", 1.0 );"),f&&x.push(`gl_FragColor.a *= ${f.result};`),x.push("#include <fog_fragment>","#include <dithering_fragment>"),a=x.join(`
`)}return a}},Dm=class extends lr{constructor(){super("lambert"),this.nodeType="Lambert",this.color=new ir(ni),this.emissive=new ir(0),this.emissiveIntensity=new Fe(1),this.previousModelViewMatrix=new Qi,this.previouseProjectionMatrix=new Qi,this.shadingAlpha=new Fe(1),this.shadingBlend=new Lt(0),this.occlusion=new Jr(!0)}get category(){return"lambert"}build(r){let a;if(r.define("LAMBERT"),r.requires.lights=!0,r.extensions.derivatives=!0,r.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(r,"v3",{cache:"position"}):void 0;r.mergeUniform({frameIndex:et.frameIndex}),r.mergeUniform({resolution:et.resolution}),r.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),r.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),r.mergeUniform(Vs.merge([Ie.fog,Ie.lights])),r.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let o=["#include <beginnormal_vertex>","#include <morphnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];n&&o.push(n.code,n.result?"displaced_position = "+n.result+";":""),o.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),o.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>",`
					vec3 diffuse = vec3( 1.0 );
					GeometricContext geometry;
					geometry.position = mvPosition.xyz;
					geometry.normal = normalize( transformedNormal );
					geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
				`),o.push(`
					GeometricContext backGeometry;
					backGeometry.position = geometry.position;
					backGeometry.normal = -geometry.normal;
					backGeometry.viewDir = geometry.viewDir;
					vLightFront = vec3( 0.0 );
					vIndirectFront = vec3( 0.0 );
					#ifdef DOUBLE_SIDED
						vLightBack = vec3( 0.0 );
						vIndirectBack = vec3( 0.0 );
					#endif
					IncidentLight directLight;
					float dotNL;
					vec3 directLightColor_Diffuse;
					vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
					vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
					#ifdef DOUBLE_SIDED
						vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
						vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
					#endif
					#if NUM_POINT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
							getPointLightInfo( pointLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_SPOT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
							getSpotLightInfo( spotLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_DIR_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
							getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_HEMI_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
							vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
							#ifdef DOUBLE_SIDED
								vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
							#endif
						}
						#pragma unroll_loop_end
					#endif
				`,"	#include <shadowmap_vertex>","	#include <fog_vertex>"),o.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),a=o.join(`
`)}else{r.mergeUniform({penumbraSize:et.penumbraSize}),r.mergeUniform({frameIndex:et.frameIndex}),r.mergeUniform({aoMap:et.aoRenderTarget}),r.mergeUniform({aoEnabled:et.aoEnabled}),this.color===void 0&&(this.color=new ir(ni)),this.color.analyze(r,{slot:"color"}),this.shadingAlpha.analyze(r),this.shadingBlend.analyze(r),this.afterColor&&this.afterColor.analyze(r,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(r);let n=this.color.flow(r,"c",{slot:"color"}),o=this.emissive.flow(r,"c",{slot:"emissive"}),f=this.emissiveIntensity.flow(r,"f",{slot:"emissive"}),y=this.occlusion.flow(r,"b",{slot:"occlusion"}),x=this.shadingAlpha.flow(r,"f"),b=this.shadingBlend.flow(r,"i"),_=this.afterColor?this.afterColor.flow(r,"c",{slot:"afterColor"}):void 0,S=this.alpha?this.alpha.flow(r,"f"):void 0,A=this.alphaOverride?this.alphaOverride.flow(r,"f"):void 0;r.requires.transparent=S!==void 0,r.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#include <normal_pars_fragment>","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <fog_pars_fragment>","#include <shadowmap_pars_fragment>","#include <shadowmask_pars_fragment>","#include <clipping_planes_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let C=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx, viewdy));
				bool isFrontFacing = (dot(normal, faceNormal) >= 0.0);
				`,"#include <clipping_planes_fragment>"];C.push(n.code,"vec3 diffuseColor = "+n.result+";","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );"),S&&C.push(S.code,"#ifdef ALPHATEST","if ( "+S.result+" <= ALPHATEST ) discard;","#endif"),C.push("#ifdef DOUBLE_SIDED","	reflectedLight.indirectDiffuse += ( isFrontFacing ) ? vIndirectFront : vIndirectBack;","#else","	reflectedLight.indirectDiffuse += vIndirectFront;","#endif","#include <lightmap_fragment>","reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );","#ifdef DOUBLE_SIDED","	reflectedLight.directDiffuse = ( isFrontFacing ) ? vLightFront : vLightBack;","#else","	reflectedLight.directDiffuse = vLightFront;","#endif","reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();"),o&&C.push(o.code,"reflectedLight.directDiffuse += "+o.result+" * "+f.result+";"),C.push("vec3 ao = aoEnabled && "+y.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = (reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) ;");let P="1.0";this.mask&&(this.mask.analyze(r),P=`luminance(${this.mask.flow(r,"v3").result})`),C.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${x.result} * ${P} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${x.result} * ${P}, ${b.result} );

					outgoingLight *= ao;
				}
				`),_&&C.push(_.code,`outgoingLight = spe_blend(outgoingLight, ${_.result}, 1.0, SPE_BLENDING_NORMAL);`),S?C.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${S.result} );`):C.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),A&&C.push(`gl_FragColor.a *= ${A.result};`),C.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),a=C.join(`
`)}return a}},Va=function(){let r=new Ae(`vec2 dHdxy(sampler2D bumpMap, vec2 bumpMapUv, float bumpScale) {

            // Gradient of UVs w.r.t. X coordinate (in screen-space)
            vec2 dSTdx = dFdx(bumpMapUv);

            // Gradient of UVs w.r.t. Y coordinate (in screen-space)
            vec2 dSTdy = dFdy(bumpMapUv);
            
            // Forward differencing
            float Hll = bumpScale * luminance(texture(bumpMap, bumpMapUv).rgb);
            float dBx = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdx).rgb) - Hll;
            float dBy = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdy).rgb) - Hll;
            
            return vec2( dBx, dBy );
        }`),a=new Ae(`vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
            vec3 vSigmaX = dFdx( surf_pos.xyz );
            vec3 vSigmaY = dFdy( surf_pos.xyz );
            vec3 vN = surf_norm; // normalized
            
            vN = normalize(vN);

            vec3 R1 = cross( vSigmaY, vN );
            vec3 R2 = cross( vN, vSigmaX );

            R1 = normalize(R1);
            R2 = normalize(R2);
    
            float fDet = dot( vSigmaX, R1 ) * faceDirection;
    
            vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
            return normalize( abs( fDet ) * vN - vGrad );
        }`);return{dHdxy:r,perturbNormalArb:a}}(),Om=class extends lr{constructor(){super("phong"),this.nodeType="Phong",this.color=new ir(ni),this.specular=new ir(1118481),this.shininess=new Fe(30),this.previousModelViewMatrix=new Qi,this.previouseProjectionMatrix=new Qi,this.shadingAlpha=new Fe(1),this.shadingBlend=new Lt(0),this.occlusion=new Jr(!0)}get category(){return"phong"}build(r){let a;if(r.define("PHONG"),r.requires.lights=!0,r.extensions.derivatives=!0,r.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(r,"v3",{cache:"position"}):void 0;r.mergeUniform({frameIndex:et.frameIndex}),r.mergeUniform({resolution:et.resolution}),r.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),r.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),r.mergeUniform(Vs.merge([Ie.fog,Ie.lights])),r.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let o=["#include <beginnormal_vertex>","#include <morphnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];n&&o.push(n.code,n.result?"displaced_position = "+n.result+";":""),o.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),o.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),o.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),a=o.join(`
`)}else{r.mergeUniform({penumbraSize:et.penumbraSize}),r.mergeUniform({frameIndex:et.frameIndex}),r.mergeUniform({aoMap:et.aoRenderTarget}),r.mergeUniform({aoEnabled:et.aoEnabled}),this.color===void 0&&(this.color=new ir(ni)),this.color.analyze(r,{slot:"color"}),this.specular.analyze(r),this.shininess.analyze(r);let n=this.occlusion.flow(r,"b",{slot:"occlusion"});this.shadingAlpha.analyze(r),this.shadingBlend.analyze(r),this.afterColor&&this.afterColor.analyze(r,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(r);let o=this.color.flow(r,"c",{slot:"color"}),f=this.specular.flow(r,"c"),y=this.shininess.flow(r,"f"),x=this.shadingAlpha.flow(r,"f"),b=this.shadingBlend.flow(r,"i"),_=this.afterColor?this.afterColor.flow(r,"c",{slot:"afterColor"}):void 0,S=this.alpha?this.alpha.flow(r,"f"):void 0,A=this.alphaOverride?this.alphaOverride.flow(r,"f"):void 0;r.requires.transparent=S!==void 0,r.addParsCode(["varying vec3 vWPosition;","uniform vec3 emissive;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let C=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	BlinnPhongMaterial material;"];if(this.bumpMap){r.include(Va.dHdxy),r.include(Va.perturbNormalArb);let T=this.bumpMap.texture.flow(r,"t"),M=this.bumpMap.flow(r,"v3"),O=this.bumpMapIntensity?this.bumpMapIntensity.flow(r,"f").result:"1.0",I="";this.bumpMap.projection.value===4?I=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${T.result}, uv0, ${O});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${T.result}, uv1, ${O});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${T.result}, uv2, ${O});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:I=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${T.result}, bumpMapCachedUv, ${O});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,C.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${M.result};
					${I}
					`)}C.push(o.code,"	vec3 diffuseColor = "+o.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","	vec3 totalEmissiveRadiance = emissive;",f.code,"	vec3 specular = "+f.result+";",y.code,"	float shininess = max( 0.0001, "+y.result+" );","	float specularStrength = 1.0;"),S&&C.push(S.code,"#ifdef ALPHATEST","if ( "+S.result+" <= ALPHATEST ) discard;","#endif"),C.push("material.diffuseColor = diffuseColor;"),C.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),C.push("vec3 ao = aoEnabled && "+n.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;");let P="1.0";this.mask&&(this.mask.analyze(r),P=`luminance(${this.mask.flow(r,"v3").result})`),C.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${x.result} * ${P} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${x.result} * ${P}, ${b.result} );
					
					outgoingLight *= ao;
				}
				`),_&&C.push(_.code,`outgoingLight = spe_blend(outgoingLight, ${_.result}, 1.0, SPE_BLENDING_NORMAL);`),S?C.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${S.result});`):C.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),A&&C.push(`gl_FragColor.a *= ${A.result};`),C.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),a=C.join(`
`)}return a}},Rm=class extends lr{constructor(){super("standard"),this.nodeType="Standard",this.color=new ir(ni),this.roughness=new Fe(.3),this.metalness=new Fe(0),this.reflectivity=new Fe(.5),this.previousModelViewMatrix=new Qi,this.previouseProjectionMatrix=new Qi,this.shadingAlpha=new Fe(1),this.shadingBlend=new Lt(0),this.occlusion=new Jr(!0)}get category(){return"physical"}build(r){let a;if(r.define("STANDARD"),r.requires.lights=!0,r.extensions.derivatives=!0,r.extensions.shaderTextureLOD=!0,r.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(r,"v3",{cache:"position"}):void 0;r.mergeUniform({frameIndex:et.frameIndex}),r.mergeUniform({resolution:et.resolution}),r.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),r.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),r.mergeUniform(Vs.merge([Ie.fog,Ie.lights])),Ie.LTC_1&&(r.uniforms.ltc_1={value:void 0},r.uniforms.ltc_2={value:void 0}),r.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let o=["#include <beginnormal_vertex>","#include <morphnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];n&&o.push(n.code,n.result?"displaced_position = "+n.result+";":""),o.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),o.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),o.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),a=o.join(`
`)}else{r.mergeUniform({penumbraSize:et.penumbraSize}),r.mergeUniform({frameIndex:et.frameIndex}),r.mergeUniform({aoMap:et.aoRenderTarget}),r.mergeUniform({aoEnabled:et.aoEnabled});let n={gamma:!0};this.color===void 0&&(this.color=new ir(ni)),this.color.analyze(r,{slot:"color",context:n}),this.roughness.analyze(r),this.metalness.analyze(r);let o=this.occlusion.flow(r,"b",{slot:"occlusion"});this.shadingAlpha.analyze(r),this.shadingBlend.analyze(r),this.afterColor&&this.afterColor.analyze(r,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(r),this.reflectivity&&this.reflectivity.analyze(r);let f=this.color.flow(r,"c",{slot:"color",context:n}),y=this.roughness.flow(r,"f"),x=this.metalness.flow(r,"f"),b=this.shadingAlpha.flow(r,"f"),_=this.shadingBlend.flow(r,"i"),S=this.afterColor?this.afterColor.flow(r,"c",{slot:"afterColor"}):void 0,A=this.alpha?this.alpha.flow(r,"f"):void 0,C=this.alphaOverride?this.alphaOverride.flow(r,"f"):void 0,P=this.reflectivity?this.reflectivity.flow(r,"f"):void 0;r.requires.transparent=A!==void 0,r.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>"].join(`
`));let T=["#include <clipping_planes_fragment>","	#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	PhysicalMaterial material;","	material.diffuseColor = vec3( 1.0 );"];if(this.bumpMap){r.include(Va.dHdxy),r.include(Va.perturbNormalArb);let O=this.bumpMap.texture.flow(r,"t"),I=this.bumpMap.flow(r,"v3"),D=this.bumpMapIntensity?this.bumpMapIntensity.flow(r,"f").result:"1.0",z="";this.bumpMap.projection.value===4?z=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${O.result}, uv0, ${D});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${O.result}, uv1, ${D});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${O.result}, uv2, ${D});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:z=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${O.result}, bumpMapCachedUv, ${D});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,T.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${I.result};
					${z}
					`)}if(T.push(f.code,"	vec3 diffuseColor = "+f.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",x.code,"	float metalnessFactor = "+x.result+";"),this.roughnessMap){let O=this.roughnessMap.texture.flow(r,"t"),I=this.roughnessMap.flow(r,"v3"),D="";this.roughnessMap.projection.value===4?D=`
					float roughnessChange = 1.0;
					{
						vec2 uv0 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						float r0 = luminance(texture(${O.result}, uv0).rgb) * roughnessScale;
						float r1 = luminance(texture(${O.result}, uv1).rgb) * roughnessScale;
						float r2 = luminance(texture(${O.result}, uv2).rgb) * roughnessScale;

						roughnessChange = (r0 * weights.z + r1 * weights.x + r2 * weights.y);
					}
					float roughnessFactor = roughnessChange * ${y.result};
					`:D=`
					vec2 roughnessMapCachedUv = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs;

					vec4 vals = texture(${O.result},  roughnessMapCachedUv);
					float roughnessFactor = luminance(vals.rgb) * ${y.result};
					`,T.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${I.result};

					const float roughnessScale = 1.0;

					${D}
				`)}else T.push(y.code,"	float roughnessFactor = "+y.result+";");A&&T.push(A.code,"#ifdef ALPHATEST","	if ( "+A.result+" <= ALPHATEST ) discard;","#endif"),T.push("vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );"),T.push("material.diffuseColor = diffuseColor * ( 1.0 - metalnessFactor );","material.roughness = max( roughnessFactor, 0.0525 );","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.roughness = clamp( roughnessFactor, 0.04, 1.0 );"),P?T.push(P.code,"material.specularColor = mix( vec3( 0.16 * pow2( "+P.result+" ) ), diffuseColor, metalnessFactor );"):T.push("material.specularColor = mix( vec3( 0.04 ), diffuseColor, metalnessFactor );"),T.push("#include <lights_fragment_begin>"),T.push("#include <lights_fragment_end>"),T.push("vec3 ao = aoEnabled && "+o.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular;");let M="1.0";this.mask&&(this.mask.analyze(r),M=`luminance(${this.mask.flow(r,"v3").result})`),T.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${b.result} * ${M} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${b.result} * ${M}, ${_.result} );
					
					outgoingLight *= ao;
				}
				`),S&&T.push(S.code,`outgoingLight = spe_blend(outgoingLight, ${S.result}, 1.0, SPE_BLENDING_NORMAL);`),A?T.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${A.result} );`):T.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),C&&T.push(`gl_FragColor.a *= ${C.result};`),T.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),a=T.join(`
`)}return a}},Lm=class extends lr{constructor(){super("toon"),this.nodeType="Toon",this.color=new ir(ni),this.specular=new ir(1118481),this.shininess=new Fe(30),this.previousModelViewMatrix=new Qi,this.previouseProjectionMatrix=new Qi,this.shadingAlpha=new Fe(1),this.shadingBlend=new Lt(0)}get category(){return"toon"}build(r){let a;if(r.define("TOON"),r.requires.lights=!0,r.extensions.derivatives=!0,r.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(r,"v3",{cache:"position"}):void 0;r.mergeUniform({frameIndex:et.frameIndex}),r.mergeUniform({resolution:et.resolution}),r.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),r.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),r.mergeUniform(Vs.merge([Ie.fog,Ie.lights])),r.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let o=["#include <beginnormal_vertex>","#include <morphnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];n&&o.push(n.code,n.result?"displaced_position = "+n.result+";":""),o.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),o.push("	#include <project_vertex>","	#include <fog_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),o.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),a=o.join(`
`)}else{r.mergeUniform({penumbraSize:et.penumbraSize}),r.mergeUniform({frameIndex:et.frameIndex}),r.mergeUniform({aoMap:et.aoRenderTarget}),r.mergeUniform({aoEnabled:et.aoEnabled}),this.color===void 0&&(this.color=new ir(ni)),this.color.analyze(r,{slot:"color"}),this.specular.analyze(r),this.shininess.analyze(r),this.shadingAlpha.analyze(r),this.shadingBlend.analyze(r),this.afterColor&&this.afterColor.analyze(r,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(r);let n=this.color.flow(r,"c",{slot:"color"}),o=this.specular.flow(r,"c"),f=this.shininess.flow(r,"f"),y=this.shadingAlpha.flow(r,"f"),x=this.shadingBlend.flow(r,"i"),b=this.afterColor?this.afterColor.flow(r,"c",{slot:"afterColor"}):void 0,_=this.alpha?this.alpha.flow(r,"f"):void 0,S=this.alphaOverride?this.alphaOverride.flow(r,"f"):void 0;r.requires.transparent=_!==void 0,r.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vWPosition;","#include <normal_pars_fragment>","#include <gradientmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <dithering_pars_fragment>",`
					varying vec3 vViewPosition;
					struct ToonMaterial {
						vec3	diffuseColor;
						vec3	specularColor;
						float	specularShininess;
						float	specularStrength;
					};
					void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
			
						reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
						reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
					}
					void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
					}
					#define RE_Direct				RE_Direct_Toon
					#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
					#define Material_LightProbeLOD( material )	(0)
					`,"#include <shadowmap_pars_fragment>","#include <bumpmap_pars_fragment>","#include <normalmap_pars_fragment>"].join(`
`));let A=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	ToonMaterial material;"];if(this.bumpMap){r.include(Va.dHdxy),r.include(Va.perturbNormalArb);let P=this.bumpMap.texture.flow(r,"t"),T=this.bumpMap.flow(r,"v3"),M=this.bumpMapIntensity?this.bumpMapIntensity.flow(r,"f").result:"1.0",O="";this.bumpMap.projection.value===4?O=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${P.result}, uv0, ${M});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${P.result}, uv1, ${M});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${P.result}, uv2, ${M});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:O=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${P.result}, bumpMapCachedUv, ${M});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,A.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${T.result};
					${O}
					`)}A.push(n.code,"	vec3 diffuseColor = "+n.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",o.code,"	vec3 specular = "+o.result+";",f.code,"	float shininess = max( 0.0001, "+f.result+" );","	float specularStrength = 1.0;"),_&&A.push(_.code,"#ifdef ALPHATEST","if ( "+_.result+" <= ALPHATEST ) discard;","#endif"),A.push("material.diffuseColor = diffuseColor;"),A.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),A.push("vec3 ao = aoEnabled ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) * ao) + reflectedLight.directSpecular;");let C="1.0";this.mask&&(this.mask.analyze(r),C=`luminance(${this.mask.flow(r,"v3").result})`),A.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${y.result} * ${C} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${y.result} * ${C}, ${x.result} );
				}
				`),b&&A.push(b.code,`outgoingLight = spe_blend(outgoingLight, ${b.result}, 1.0, SPE_BLENDING_NORMAL);`),_?A.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${_.result} );`):A.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),S&&A.push(`gl_FragColor.a *= ${S.result};`),A.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),a=A.join(`
`)}return a}},ax=class{constructor(r=1e3*10){this.timeout=r,this.cache=new Map,this.head={data:null,time:0,src:null,next:null,prev:null},this.tail={data:null,time:1/0,src:null,next:null,prev:null},this.hasClean=!1,this.head.next=this.tail,this.tail.prev=this.head}log(...r){}remove(r){let a=this.cache.get(r);a&&(this.dispose(r,a.data),this.cache.delete(r),a.prev.next=a.next,a.next.prev=a.prev)}scheduleCleanup(){this.hasClean||(this.log("scheduled cleanup"),this.hasClean=!0,setTimeout(()=>{this.hasClean=!1,this.log("cleaning");let r=Date.now(),a=this.head.next;for(;a.time<r-this.timeout;)this.dispose(a.src,a.data),this.cache.delete(a.src),a=a.next,a.prev=this.head,this.head.next=a;this.head.next!==this.tail?this.scheduleCleanup():this.log("no more cleanup")},this.timeout+1e3))}has(r){var a;return(a=this.cache.get(r))==null?void 0:a.data}load(r){let a=Date.now(),n=this.cache.get(r);return n===void 0?(n={data:this.create(r),src:r,time:a,next:null,prev:null},this.cache.set(r,n)):(n.time=a,n.prev.next=n.next,n.next.prev=n.prev),n.prev=this.tail.prev,n.next=this.tail,this.tail.prev.next=n,this.tail.prev=n,this.scheduleCleanup(),n.data}},TE=class extends ax{create(r){return URL.createObjectURL(new Blob([r]))}dispose(r,a){URL.revokeObjectURL(a)}},EE;function FR(r){return typeof r=="string"?r:(EE||(EE=new TE),EE.load(r))}var lx=class{constructor(r,a){this.data=r,this.cache=a,this.refCount=0}deref(){this.refCount,this.refCount-=1,this.refCount===0&&(this.cache.remove(this),this.dispose())}dispose(){this.refCount}},cx=class{constructor(){this.cache=new Map}remove(r){this.cache.delete(r.data)}load(r){let a=this.cache.get(r);return a===void 0&&(a=this.create(r),this.cache.set(r,a)),a.refCount+=1,a}},af=class extends lx{constructor(r,a){super(r,a.imageHolderCache),this.data=r,this.shared=a,this.loaded=!1,this.isVideo=!1,this.isBuffer=!1,this._cache={1e3:{},1001:{},1002:{}},this.isVideo=r.type==="video",this.isBuffer=r.isWebGLRenderTarget===!0,this.loadPromise=this.updateSrc(this.isBuffer?r:r.data)}async updateSrc(r){if(typeof document>"u")return;this.disposeTextures(),this.loaded=!1;let a=()=>{this.loaded=!0;for(let o of Object.values(this._cache))for(let f of Object.values(o))for(let y of Object.values(f))y&&(y.image=this.img,y.needsUpdate=!0);this.shared.requestRender()};if(this.isBuffer)this.img=r,this.loaded=!0;else if(this.isVideo){if(this.img=document.createElement("video"),this.img.preload="auto",this.img.playsInline=!0,this.img.currentTime=.01,typeof r!="string"){var n=new FileReader;n.readAsDataURL(new Blob([r],{type:"video/mp4"}));let o;await new Promise(f=>{n.onloadend=y=>{var x;o=(x=y.target)==null?void 0:x.result,f(null)}}),this.img.src=o}else this.img.src=r;this.img.onloadeddata=()=>{a()}}else this.img=new Image,this.img.src=FR(r),this.img.onload=a,await new Promise(o=>{this.img.onload=()=>{a(),o(null)}})}getTexture(r,a=1008,n=1006){var f,y;let o=(y=(f=this._cache[r])==null?void 0:f[a])==null?void 0:y[n];if(o)return o;{let x;return this.isBuffer?x=this.img.texture:this.isVideo?x=new Ty(this.img,void 0,r,r):x=new rr(this.img,void 0,r,r,n,a),this.loaded&&(x.needsUpdate=!0),this._cache[r]===void 0&&(this._cache[r]={}),this._cache[r][a]===void 0&&(this._cache[r][a]={}),this._cache[r][a][n]=x,x}}setNeedsUpdate(r){for(let a of Object.values(this._cache))for(let n of Object.values(a))for(let o of Object.values(n))o&&(o.needsUpdate=r)}disposeTextures(){for(let[r,a]of Object.entries(this._cache))for(let[n,o]of Object.entries(a))for(let[f,y]of Object.entries(o))y==null||y.dispose(),this._cache[r]!==void 0&&this._cache[r][n]!==void 0&&(this._cache[r][n][f]=void 0)}dispose(){super.dispose(),this.disposeTextures()}},$n=class extends af{};Za(GR(),1);Za(HR(),1);function Zi(r,a){return a.color(r)}function JR(r,a){switch(r.type){case"fresnel":return RY(r,a);case"gradient":return LY(r,a);case"depth":return BY(r,a);case"normal":return NY(r,a);case"noise":return FY(r,a);case"rainbow":return VY(r,a);case"toon":return UY(r,a);case"outline":return zY(r,a);case"transmission":return kY(r,a);case"color":return OY(r,a);case"pattern":return GY(r,a)}}function DY(r){return{type:r.type}}function Zs(r,a){let{alpha:n,mode:o,isMask:f}=r,y=typeof n=="string"?(Number(a.getVariable(n))??100)/100:n;return{...DY(r),alpha:y,mode:o,isMask:f}}function OY(r,a){return{...Zs(r,a),color:Zi(r.color,a)}}function RY(r,a){let{bias:n,scale:o,intensity:f,factor:y,color:x}=r;return{...Zs(r,a),color:Zi(x,a),bias:n,scale:o,intensity:f,factor:y}}function LY(r,a){let{gradientType:n,smooth:o,colors:f,steps:y,angle:x,offset:b,morph:_}=r;return{...Zs(r,a),gradientType:n,smooth:o,colors:f.map(S=>new Qe(S[0],S[1],S[2],S[3])),num:f.length,steps:y,offset:new V(...b),morph:new V(..._),angle:x}}function BY(r,a){let{gradientType:n,near:o,far:f,isVector:y,isWorldSpace:x,origin:b,direction:_,colors:S,steps:A,smooth:C}=r;return{...Zs(r,a),gradientType:n,near:o,far:f,isVector:y,isWorldSpace:x,origin:new E(...b),direction:_?new E(..._):new E(1,0,0),colors:S.map(P=>P!==void 0?new Qe(P[0],P[1],P[2],P[3]):new Qe(0,0,0,0)),steps:A.slice(0,S.length),smooth:C}}function NY(r,a){let{cnormal:n}=r;return{...Zs(r,a),cnormal:new E(n[0],n[1],n[2])}}function FY(r,a){return{...Zs(r,a),scale:r.scale,move:r.move,fA:new V(...r.fA),fB:new V(...r.fB),size:new E(...r.size),distortion:new V(...r.distortion),colorA:Zi(r.colorA,a),colorB:Zi(r.colorB,a),colorC:Zi(r.colorC,a),colorD:Zi(r.colorD,a),noiseType:r.noiseType,voronoiStyle:r.voronoiStyle,highCut:r.highCut,lowCut:r.lowCut,smoothness:r.smoothness,seed:r.seed,quality:r.quality}}function VY(r,a){return{...Zs(r,a),filmThickness:r.filmThickness,movement:r.movement,wavelengths:new E(...r.wavelengths),noiseStrength:r.noiseStrength,noiseScale:r.noiseScale,offset:new E(...r.offset)}}function UY(r,a){return{...Zs(r,a),positioning:r.positioning,colors:r.colors.map(n=>new Qe(n[0],n[1],n[2],n[3])),num:r.colors.length,steps:r.steps,source:new E(...r.source),isWorldSpace:r.isWorldSpace,noiseStrength:r.noiseStrength,noiseScale:r.noiseScale,shadowColor:Zi(r.shadowColor,a),offset:new E(...r.offset)}}function zY(r,a){return{...Zs(r,a),outlineColor:Zi(r.outlineColor,a),contourColor:Zi(r.contourColor,a),outlineWidth:r.outlineWidth,contourWidth:r.contourWidth,outlineThreshold:r.outlineThreshold,contourThreshold:r.contourThreshold,outlineSmoothing:r.outlineSmoothing,contourFrequency:r.contourFrequency,contourDirection:new E(...r.contourDirection),positionalLines:r.positionalLines,compensation:r.compensation}}function kY(r,a){return{...Zs(r,a),thickness:r.thickness,ior:r.ior,roughness:r.roughness}}function GY(r,a){return{...Zs(r,a),style:r.style,projection:r.projection,axis:r.axis,blending:r.blending,offset:new V(...r.offset),colorA:Zi(r.colorA,a),colorB:Zi(r.colorB,a),frequency:new V(...r.frequency),size:r.size,variation:r.variation,smoothness:r.smoothness,zigzag:r.zigzag,rotation:r.rotation,vertical:new V(...r.vertical),horizontal:new V(...r.horizontal),sides:r.sides}}var ql=class extends br{},jY={noise:["noiseType"],texture:["projection","axis","side"],video:["projection","axis","side"],displace:["noiseType"],light:["roughnessMap","bumpMap"],depth:["smooth","isWorldSpace","gradientType","isVector"],pattern:["style","projection","axis"]},HY={depth:["colors"]};function WY(r,a,n){var y,x;if(a==="isMask")return!0;let o=jY[r.type],f=HY[r.type];if(f!==void 0){let b=r.color;if(f.includes(a)){let _=(x=(y=b[a])==null?void 0:y.value)==null?void 0:x.length;if(_!==void 0&&_!==n.length)return!0}}return o!==void 0?o.includes(a):!1}function BE(r,a,n){let o=n.uniforms[`f${n.id}_texture`];if(!o)return!1;let f=!1,y=r;if("image"in y){let x=y.image,b=a.image(x),_=o;_.image instanceof $n||_.image.deref(),_.image=b}if("video"in y){let x=y.video,b=a.video(x),_=o;_.image instanceof $n||_.image.deref(),_.image=b}if("wrapping"in y){let x=o;x.wrap=y.wrapping}if("minFilter"in y){let x=o;x.minFilter=y.minFilter}if("magFilter"in y){let x=o;x.magFilter=y.magFilter}if("rotation"in y&&n.uniforms[`f${n.id}_rotation`])return n.uniforms[`f${n.id}_rotation`].value=(y.rotation??0)*we.DEG2RAD,f;if("repeat"in y||"offset"in y||"rotation"in y){let x="mat",b=n.uniforms[`f${n.id}_${x}`];"repeat"in y&&(b.repeat=y.repeat),"offset"in y&&(b.offset=y.offset),"rotation"in y&&(b.rotation=y.rotation??0),b.updateMatrix()}return f}function $R(r,a,n,o){let f=!1;for(let[y,x]of Object.entries(r)){if(y==="bumpMap"||y==="roughnessMap"){f=!0;continue}if(!y||x===void 0)continue;if(NE(y,n,o,a)){y==="visible"&&n.type==="light"&&(f=!0);continue}n.visible=o.visible;let b=n.uniforms[`f${n.id}_${y}`];if(b&&!(b instanceof Hl))switch(f=f||WY(n,y,x),b.constructor){case ir:if(typeof x=="string"){let _=a.getColor(x);_&&(b.value=_);break}else{let _=x;b.value instanceof ql?b.value=new br(_.r,_.g,_.b,_.a):b.setRGBA(_);break}case Nn:if(typeof x=="string"){let _=a.getColor(x);_&&(b.value=_);break}else{let _=x;b.value instanceof ql?b.value=new br(_.r,_.g,_.b,_.a):b.value.setRGBA(_.r,_.g,_.b,_.a);break}case Yr:{let _=x;b.value.setX(_[0]),b.value.setY(_[1]);break}case Ki:{let _=x;b.value.setX(_[0]),b.value.setY(_[1]),b.value.setZ(_[2]);break}case wn:{BE(x,a,n);break}case Qs:{b.value=x.map(_=>new Qe(..._));break}default:{b.value=x;break}}}return f}var Xl=(r,a,n)=>Math.max(0,Math.min(1,Number(a.getVariable(typeof r=="number"?r*100:r,n)??100)/100))??1,Yl=class{constructor(r,a,n,o,f){this.id=r,this.uuid=a,this.data=n,this.uniforms={};for(let y in o)this.uniforms[`f${this.id}_${y}`]=o[y];for(let y in n)NE(y,this,n,f)}get type(){return this.data.type}static create(r,a,n,o){if(n.type==="light")return En.createLightLayer(r,a,n,o);if(n.type==="texture"||n.type==="video"){let f=n.type==="texture"?o.uiBuffer(n.texture.image)??o.image(n.texture.image):o.video(n.texture.video),y=new Jc(f,n.texture.wrapping,n.texture.minFilter??1008,n.texture.magFilter??1006),x=new nx(f),b=new sx(n.texture.repeat,n.texture.offset,n.texture.rotation??0),_=new Fe(n.crop?1:0),S=new Lt(n.projection??0),A=new Lt(["x","y","z"].indexOf(n.axis)??0),C=new Lt(n.side??0),P=new Yr(n.size?new V(n.size[0],n.size[1]):new V(100,100)),T=new Fe(n.blending??0),M=new Fe(Xl(n.alpha,o)),O=new Lt(n.mode??0),I=new Jr(n.isMask??!1),D=new Wl(y,x,_,S,A,C,P,T,b,M,O,I),z=new Zt(D.calpha,"f");return new Br(r,a,n,{texture:y,textureSize:x,crop:_,projection:S,axis:A,side:C,size:P,blending:T,mat:b,alpha:M,mode:O,isMask:I},D,O,z,I,o)}else if(n.type==="matcap"){let f=o.image(n.texture.image),y=new Jc(f,n.texture.wrapping,n.texture.minFilter??1008,n.texture.magFilter??1006),x=new Fe(Xl(n.alpha,o)),b=new Lt(n.mode??0),_=new Jr(n.isMask??!1),S=new Fe((n.texture.rotation??0)*we.DEG2RAD),A=new Jd(y,x,b,_,S),C=new Zt(A.calpha,"f");return new Br(r,a,n,{texture:y,alpha:x,mode:b,isMask:_,rotation:S},A,b,C,_,o)}else if(n.type==="displace")if(n.displacementType==="noise"){let f=new Ki(new E(...n.offset)),y=new Fe(n.scale??10),x=new Fe(n.intensity??8),b=new Fe(n.movement??1),_=new Lt(n.noiseType??0),S=new Lt(n.voronoiStyle??0),A=new Fe(n.smoothness??.5),C=new Fe(n.seed??0),P=new Fe(n.highCut??1),T=new Fe(n.lowCut??0),M=new Lt(n.quality??1),O=new of(x,b,f,S,A,C,P,T,M,y,_);return new Nm(r,a,n,{offset:f,scale:y,intensity:x,movement:b,noiseType:_,voronoiStyle:S,smoothness:A,seed:C,highCut:P,lowCut:T,quality:M},O,o)}else throw new Error;else return YY(r,a,n,o)}updateByOp(r,a,n){let o=r;if(o.path[0]===void 0){if(o.type===0)return"type"in o.props||"category"in o.props||"visible"in o.props||"noiseType"in o.props?(n.scene.markNeedsUpdateRendererDirty(),!0):$R(o.props,n.shared,this,a)}else if(o.path[0]==="texture")return"texture"in a||"video"in a?BE(o.props,n.shared,this):!0;return!1}dispose(){if(qY(this)){let r=this.uniforms[`f${this.id}_texture`];if(!r)return!1;let a=r;a.image instanceof $n||a.image.deref()}}hasValueByKey(r){return this.uniforms[r]!==void 0}hasValue(r){return this.hasValueByKey(`f${this.id}_${r}`)}setValue(r,a){let n=`f${this.id}_${r}`;this.hasValueByKey(n)&&a!==void 0&&(this.uniforms[n].value=a)}getNode(r){let a=`f${this.id}_${r}`;if(this.hasValueByKey(a))return this.uniforms[a]}getValue(r){let a=`f${this.id}_${r}`;if(this.hasValueByKey(a))return this.uniforms[a].value}getName(r){let a=/f\d+_(.*)/.exec(r);if(a&&a.length>1)return a[1];console.log(`Layer.getName: error ${r}`)}getNames(){let r=[];for(let a in this.uniforms){let n=this.getName(a);n&&r.push(n)}return r}},Br=class extends Yl{constructor(r,a,n,o,f,y,x,b,_){super(r,a,n,o,_),this.params=o,this.color=f,this.mode=y,this.alpha=x,this.isMask=b}},Nm=class extends Yl{constructor(r,a,n,o,f,y){super(r,a,n,o,y),this.position=f}},En=class extends Yl{constructor(r,a,n,o,f,y){super(r,a,n,f,y),this.node=o}static createLightLayer(r,a,n,o){let f,y=new Fe(Xl(n.alpha,o)),x=new Lt(n.mode),b=new Fe(n.bumpMapIntensity),_=new Fe(Xl(n.alphaOverride,o)),S;if(!n.visible)f=new Fa,S={};else if(n.category==="lambert"){f=new Dm;let A=new ir(o.color(n.emissive)??0),C=new Jr(n.occlusion??!0);S={emissive:A,occlusion:C},f.emissive=A,f.occlusion=C}else if(n.category==="toon"){f=new Lm;let A=new Fe(n.shininess??30),C=new ir(o.color(n.specular)??1118481);S={shininess:A,specular:C},f.shininess=A,f.specular=C}else if(n.category==="physical"){f=new Rm;let A=new Fe(n.roughness??.3),C=new Fe(n.metalness??0),P=new Fe(n.reflectivity??.5),T=new Jr(n.occlusion??!0);S={roughness:A,metalness:C,reflectivity:P,occlusion:T},f.roughness=A,f.metalness=C,f.reflectivity=P,f.occlusion=T}else{f=new Om;let A=new Fe(n.shininess??30),C=new ir(n.specular!==void 0?o.color(n.specular)??1118481:1118481),P=new Jr(n.occlusion??!0);S={shininess:A,specular:C,occlusion:P},f.shininess=A,f.specular=C,f.occlusion=P}return f.alpha=new Fe(1),f.shadingAlpha=y,f.shadingBlend=x,f.bumpMapIntensity=b,f.alphaOverride=_,S.alpha=f.shadingAlpha,S.mode=f.shadingBlend,S.bumpMapIntensity=f.bumpMapIntensity,S.alphaOverride=f.alphaOverride,new En(r,a,n,f,S,o)}get category(){return this.node.category}};function qY(r){let a=r instanceof Yl?r.type:r;return a==="texture"||a==="video"||a==="displace_map"||a==="matcap"}function xs(r){return{alpha:new Fe(r.alpha??1),mode:new Lt(r.mode??0),isMask:new Jr(r.isMask??!1)}}function XY(r,a,n,o,f){switch(r.type){case"color":{let y=new ir(o.color??ni),x=xs(o),b=new $c(y,x.alpha),_=new Zt(b.calpha,"f");return new Br(a,n,r,{color:y,...x},b,x.mode,_,x.isMask,f)}case"fresnel":{let y=new ir(o.color??16777215),x=new Fe(o.bias??.1),b=new Fe(o.scale??1),_=new Fe(o.intensity??2),S=new Fe(o.factor??1),A=xs(o),C=new Im(y,x,b,_,S,A.alpha,A.mode,A.isMask),P=new Zt(C.calpha,"f");return new Br(a,n,r,{color:y,bias:x,scale:b,intensity:_,factor:S,...A},C,A.mode,P,A.isMask,f)}case"rainbow":{let y=new Fe(o.filmThickness??30),x=new Fe(o.movement??0),b=new Ki(o.wavelengths??new E(0,0,0)),_=new Fe(o.noiseStrength??0),S=new Fe(o.noiseScale??1),A=new Ki(o.offset??new E(0,0,0)),C=xs(o),P=new rf(y,x,b,_,S,A,C.alpha,C.isMask),T=new Zt(P.calpha,"f");return new Br(a,n,r,{filmThickness:y,movement:x,wavelengths:b,noiseStrength:_,noiseScale:S,offset:A,...C},P,C.mode,T,C.isMask,f)}case"transmission":{let y=new Fe(o.thickness??10),x=new Fe(o.ior??1.5),b=new Fe(o.roughness??.5),_=et.transmissionSize,S=et.transmissionRenderTarget,A=et.transmissionRenderTargetDepth,C=window.innerWidth,P=window.innerHeight,T=C>=P?new Yr(P/C,1):new Yr(1,C/P),M=xs(o),O=new sf(y,x,b,_,S,A,T,M.alpha),I=new Zt(O.calpha,"f");return new Br(a,n,r,{thickness:y,ior:x,roughness:b,aspectRatio:T,...M},O,M.mode,I,M.isMask,f)}case"toon":{let y=new Lt(o.positioning??0),x;o.colors?x=new Qs(o.colors.length,o.colors):(x=new Qs(10,new Qe(0,0,0,1)),x.value[1]=new Qe(1,1,1,1));let b;o.steps?b=new Ks(o.steps.length,o.steps):(b=new Ks(10,1),b.value[0]=0);let _=new Ki(o.source??new E(0,0,0)),S=new Jr(o.isWorldSpace??!0),A=new Fe(o.noiseStrength??0),C=new Fe(o.noiseScale??1),P=new Nn(o.shadowColor),T=new Ki(o.offset??new E(0,0,0)),M=xs(o),O=new nf(y,x,b,_,S,A,C,P,T,M.alpha),I=new Zt(O.calpha,"f");return new Br(a,n,r,{positioning:y,colors:x,steps:b,source:_,isWorldSpace:S,noiseStrength:A,noiseScale:C,shadowColor:P,offset:T,...M},O,M.mode,I,M.isMask,f)}case"outline":{let y=new ir(o.outlineColor??16777215),x=new ir(o.contourColor??16777215),b=new Fe(o.outlineWidth??.1),_=new Fe(o.contourWidth??.1),S=new Fe(o.outlineThreshold??.1),A=new Fe(o.contourThreshold??.1),C=new Fe(o.outlineSmoothing??.1),P=new Fe(o.contourFrequency??.1),T=new Ki(o.contourDirection??new E(0,1,0)),M=new Jr(o.positionalLines??!1),O=new Jr(o.compensation??!0),I=et.normalRenderTarget,D=et.normalRenderTargetDepth,z=et.pixelRatioNode,k=et.resolution,L=xs(o),R=new ef(y,x,b,_,S,A,C,P,T,M,O,k,I,D,z,L.alpha),F=new Zt(R.calpha,"f");return new Br(a,n,r,{outlineColor:y,contourColor:x,outlineWidth:b,contourWidth:_,outlineThreshold:S,contourThreshold:A,outlineSmoothing:C,contourFrequency:P,contourDirection:T,positionalLines:M,compensation:O,...L},R,L.mode,F,L.isMask,f)}case"depth":{let y=new Lt(o.gradientType??0),x=new Jr(o.smooth??!1),b=new Fe(o.near??50),_=new Fe(o.far??200),S=new Fe(o.isVector??1),A=new Fe(o.isWorldSpace??0),C=new Ki(o.origin??new E),P=new Ki(o.direction??new E),T;o.colors?T=new Qs(o.colors.length,o.colors):(T=new Qs(2,new Qe(0,0,0,1)),T.value[1]=new Qe(1,1,1,1));let M;o.steps?M=new Ks(o.steps.length,o.steps):(M=new Ks(2,1),M.value[0]=0);let O=xs(o),I=new Qd(y,x,b,_,S,A,C,P,T,M,O.alpha,O.isMask),D=new Zt(I.calpha,"f");return new Br(a,n,r,{gradientType:y,smooth:x,near:b,far:_,isVector:S,isWorldSpace:A,origin:C,direction:P,colors:T,steps:M,...O},I,O.mode,D,O.isMask,f)}case"noise":{let y=new Fe(o.scale??1),x=new Ki(o.size??new E(100,100,100)),b=new Fe(o.move??1),_=new Yr(o.fA??new V(1.7,9.2)),S=new Yr(o.fB??new V(8.3,2.8)),A=new Yr(o.distortion??new V(1,1)),C=new Nn(o.colorA),P=new Nn(o.colorB),T=new Nn(o.colorC),M=new Nn(o.colorD),O=new Lt(o.noiseType??0),I=new Lt(o.voronoiStyle??0),D=new Fe(o.highCut??1),z=new Fe(o.lowCut??0),k=new Fe(o.smoothness??.5),L=new Fe(o.seed??.5),R=new Lt(o.quality??1),F=xs(o),B=new $d(y,x,b,_,S,A,C,P,T,M,F.alpha,O,F.isMask,I,D,z,k,L,R),N=new Zt(B.calpha,"f");return new Br(a,n,r,{scale:y,size:x,move:b,fA:_,fB:S,distortion:A,colorA:C,colorB:P,colorC:T,colorD:M,noiseType:O,...F,voronoiStyle:I,highCut:D,lowCut:z,smoothness:k,seed:L,quality:R},B,F.mode,N,F.isMask,f)}case"normal":{let y=new Ki(o.cnormal??new E(1,1,1)),x=xs(o),b=new Xd(y,x.alpha),_=new Zt(b.calpha,"f");return new Br(a,n,r,{cnormal:y,...x},b,x.mode,_,x.isMask,f)}case"gradient":{let y=new Lt(o.gradientType??0),x=new Jr(o.smooth??!1),b;o.colors?b=new Qs(o.colors.length,o.colors):(b=new Qs(10,new Qe(0,0,0,1)),b.value[1]=new Qe(1,1,1,1));let _;o.steps?_=new Ks(o.steps.length,o.steps):(_=new Ks(10,1),_.value[0]=0);let S=new Yr(o.offset??new V(0,0)),A=new Yr(o.morph??new V(0,0)),C=new Fe(o.angle??0),P=xs(o),T=new Zd(y,x,b,_,S,A,C,P.alpha,P.isMask),M=new Zt(T.calpha,"f");return new Br(a,n,r,{gradientType:y,smooth:x,colors:b,steps:_,offset:S,morph:A,angle:C,...P},T,P.mode,M,P.isMask,f)}case"pattern":{let y=new Lt(o.style??0),x=new Lt(o.projection??0),b=new Lt(["x","y","z"].indexOf(o.axis)??0),_=new Fe(o.blending??0),S=new Yr(o.offset??new V(0,0)),A=new Nn(o.colorA),C=new Nn(o.colorB),P=new Yr(o.frequency??new V(10,10)),T=new Fe(o.size??.5),M=new Fe(o.variation??0),O=new Fe(o.smoothness??.5),I=new Fe(o.zigzag??0),D=new Fe(o.rotation??0),z=new Yr(o.vertical??new V(0,1)),k=new Yr(o.horizontal??new V(0,1)),L=new Lt(o.sides??6),R=xs(o),F=new tf(y,x,b,_,S,A,C,P,T,M,O,I,D,z,k,L,R.alpha,R.isMask),B=new Zt(F.calpha,"f");return new Br(a,n,r,{style:y,projection:x,axis:b,blending:_,offset:S,colorA:A,colorB:C,frequency:P,size:T,variation:M,smoothness:O,zigzag:I,rotation:D,vertical:z,horizontal:k,sides:L,...R},F,R.mode,B,R.isMask,f)}default:{let y=new ir(1,0,0,1),x=xs(o),b=new $c(y,x.alpha),_=new Zt(b.calpha,"f");return new Br(a,n,r,{color:y,...x},b,x.mode,_,x.isMask,f)}}}function YY(r,a,n,o){let f=JR(n,o);return XY(n,r,a,f,o)}function NE(r,a,n,o){if(n.type==="displace"&&(r==="intensity"||r==="visible")){let f=a.uniforms[`f${a.id}_intensity`];return f?(f.value=n.intensity*(n.visible?1:0),f):void 0}if(n.type!=="displace"&&(r==="alpha"||r==="visible")){let f=a.uniforms[`f${a.id}_alpha`];if(!f)return;if(f.value=Xl(n.alpha,o)*(n.visible?1:0),n.type==="outline"&&r==="visible"){let y=a.uniforms[`f${a.id}_compensation`];y&&(y.value=n.compensation&&n.visible)}return f}}function tu(r,a){let n=0,o=r.layers.find(f=>f.data.type==="light");if(o){let f=o.data,y=Number(a.getVariable(f.alphaOverride));if((typeof f.alphaOverride=="string"?y/100:f.alphaOverride)<1)return!0}for(let f of r.layers){if(f.data.type!=="displace"&&f.data.isMask)return!0;if(f.data.type!=="displace"&&"alpha"in f.data&&f.data.type!=="light"&&f.data.type!=="fresnel"&&f.data.type!=="texture"&&f.data.type!=="matcap"&&f.data.type!=="rainbow"&&f.data.type!=="outline"&&f.data.type!=="pattern"){let y=f.data.visible?f.data.alpha:0;if(typeof y=="string"&&(y=Math.max(0,Math.min(1,Number(a.getVariable(y)??100)/100))),y===1&&f.data.type==="depth"||f.data.type==="gradient"){for(let x of f.data.colors)if(x[3]<1){y=x[3];break}}else if(y===1&&f.data.type==="noise"){let x=a.color(f.data.colorA).a,b=a.color(f.data.colorB).a,_=a.color(f.data.colorC).a,S=a.color(f.data.colorD).a,A=Math.min(x,Math.min(b,Math.min(_,S)));A<1&&(y=A)}n+=(1-n)*y}}return n<1}var Vn=class extends Je{constructor(){super(void 0),this.flatShading=!1,this.needsJitter=!0,this.shadersPatchedForShapeBlend=!1,this.nodeContextUuid=0,this.fog=!0,this.dithering=!0,this.vertexColors=!0,this.transparent=!0}customProgramCacheKey(){return""}},px=class extends Vn{constructor(r,a,n,o){super(),this.flatShading=r,this.side=a,this.wireframe=n,this.root=o}updateAfterBuild(){let r=this.root;this.lights=r.lights,this.vertexShader=r.vertexShader,this.fragmentShader=r.fragmentShader,Object.assign(this.defines,r.defines),Object.assign(this.uniforms,r.uniforms),this.extensions=r.extensions,this.transparent=r.transparent,this.cacheKey=r.customProgramCacheKey()+"flat"+this.flatShading+this.side}onBeforeCompile(r,a){this.root.onBeforeCompile(r)}get data(){return this.root.data}get category(){return this.root.category}get hasAO(){return this.root.hasAO}getFlavor(r,a,n,o){return this.root.getFlavor(r,a,n,o)}get layers(){return this.root.layers}get fragment(){return this.root.fragment}getLayersOfType(r){return this.root.getLayersOfType(r)}getLayerByUuid(r){return this.root.getLayerByUuid(r)}updateByOp(r,a,n){this.root.updateByOp(r,a,n)}nodeMaterialDispose(){this.root.nodeMaterialDispose()}},Ua=class extends Vn{constructor(r,a,n=!0){super(),this.data=r,this.allowVariableSaves=n,this.layerIdGen=0,this.flavors=[],this.masks={},this.type="NodeMaterial",this.updaters=[],this.needsJitter=a.shared.needsJitter,lr.startContext(this),this.reset0(r,a),lr.endContext(this)}get nodeMaterial(){return this}getFlavor(r,a,n,o){let f=n?6:(r?3:0)+a;if(f+=(((o==null?void 0:o.resolutionLevel)??0)-(o!=null&&o.useChildrenColors?4:0))*7,f===0)return this;this.flavors===void 0&&(this.flavors=[]),f-=1;let y=this.flavors[f];return y===void 0&&(y=new px(r,a,n,this),y.needsJitter=this.needsJitter,this.flavors[f]=y,y.flatShading=r,y.side=a,y.updateAfterBuild(),o&&(y.defines.SHAPEBLEND=o.resolutionLevel,y.defines.SHAPEBLEND_C=o.useChildrenColors?1:0)),y}get fragment(){return this.lightLayer.node}get category(){return this.lightLayer.category}get hasAO(){var r;return((r=this.lightLayer.getNode("occlusion"))==null?void 0:r.value)??!1}reset(r,a,n=!1){lr.startContext(this),(this.data!==r||n)&&this.reset0(r,a),lr.endContext(this)}reset0(r,a){this.data=r;let n=r.layers??qr.defaultTwoLayerData("phong").layers;try{this.layers=n.map(o=>Yl.create(this.layerIdGen++,o.id,o.data,a.shared))}catch{this.layers=[]}this.layers.reverse(),this.name=r.name??"Untitled Material",this.onUpdate(a.shared),this.transparent=tu(r,a.shared),this.saveVariableLocations(a)}onVariableUpdate(r,a,n){if(r[0]==="alphaOverride")this.transparent=tu(this.data,n.shared),this.lightLayer.setValue("alphaOverride",Math.max(0,Math.min(Number(a)/100,1)));else if(r[0]==="layer"){let o=r[1],f=r[2];if(o&&f){let y=this.layers.find(x=>x.uuid===o);y!=null&&y.hasValue(f)&&(f==="alpha"?(this.transparent=tu(this.data,n.shared),y.setValue(f,Math.max(0,Math.min(Number(a)/100,1)))):y.setValue(f,a))}}}saveVariableLocations(r){if(!this.allowVariableSaves)return;let a=this.data.layers.find(n=>n.data.type==="light");a&&r.shared.getVariable(a.data.alphaOverride,["material",this.uuid,"alphaOverride"]),this.data.layers.forEach(n=>{"alpha"in n.data&&typeof n.data.alpha=="string"&&r.shared.getVariable(n.data.alpha,["material",this.uuid,"layer",n.id,"alpha"])})}getLayersOfType(r){return this.layers.filter(a=>a.type===r)}getLayerByUuid(r){return this.layers.find(a=>a.uuid===r)}onUpdate(r){this.lightLayer=this.layers.find(a=>a instanceof En),this.lightLayer===void 0&&(this.lightLayer=new En(0,"",{...Wr.defaultData("light","phong"),visible:!1},new Fa,{},r)),this.dispose();for(let a of this.flavors)a&&a.dispose();this.applyTextureMaps(),this.applyMasks(),this.blendColors(),this.blendAfterColors(),this.blendPositions(),this.build(),this.nodeContextUuid=0}applyTextureMaps(){let r=this.layers.find(f=>f instanceof En);if(!r)return;let a=r.data,n=a.bumpMap,o=a.roughnessMap;r.node.bumpMap=void 0,r.node.roughnessMap=void 0;for(let f=0;f<this.layers.length;++f){let y=this.layers[f];y instanceof Br&&y.color instanceof Wl&&(y.uuid===n&&(r.node.bumpMap=y.color),y.uuid===o&&(r.node.roughnessMap=y.color))}}updateByOp(r,a,n){if(lr.startContext(this),a!==void 0?this.data=a:a=this.data,this.transparent=tu(a,n.shared),r.path[0]==="layers"){let o=n.shared,f=r.path[1];if(f===void 0)n.scene.markNeedsUpdateRendererDirty(),this.reset0(a,n);else{r.type===0&&r.props.occlusion!==void 0&&n.scene.markNeedsUpdateRendererDirty();let y=this.layers.find(x=>x.uuid===f);if(y){let x=a.layers.data(f),b;r.type===0&&("alpha"in r.props||"alphaOverride"in r.props)&&("alpha"in r.props?b={...r.props,alpha:Xl(r.props.alpha,o,["material",this.uuid,"layer",f,"alpha"])}:b={...r.props,alphaOverride:Xl(r.props.alphaOverride,o,["material",this.uuid,"alphaOverride"])}),y.updateByOp({...r,...b?{props:b}:{},path:r.path.slice(2)},x,n)&&this.reset0(a,n)}}}else this.reset0(a,n);lr.endContext(this)}applyMasks(){for(let r=0;r<this.layers.length;++r){let a=this.layers[r];a instanceof Br?a.color.mask=void 0:a instanceof En&&(a.node.mask=void 0)}for(let r=0;r<this.layers.length;++r){let a=this.layers[r];if(a instanceof Br&&a.isMask.value&&a.data.visible&&r>0){let n=r-1,o=this.layers[n];o instanceof En?o.node.mask=new ki(a.color,a.alpha,ki.MUL):o instanceof Br&&(o.isMask.value||(o.color.mask=new ki(a.color,a.alpha,ki.MUL)))}}}blendColors(){let r=this.layers.findIndex(n=>n instanceof Br),a=this.layers.findIndex(n=>n instanceof En);if(r!==-1&&r<a){let n=this.layers[r].color;for(let o=r+1;o<a;++o){let f=this.layers[o];if(f instanceof Br){if(f.isMask.value)continue;n=new qd(n,f.color,f.alpha,f.mode)}}this.fragment.color=n}else this.fragment.color=void 0}blendAfterColors(){let r=new Zt("outgoingLight","f"),a=this.layers.findIndex(n=>n instanceof En);if(this.layers.length>a+1){for(let n=a+1;n<this.layers.length;++n){let o=this.layers[n];if(o instanceof Br){if(o.isMask.value)continue;r=new qd(r,o.color,o.alpha,o.mode)}}this.fragment.afterColor=r}else this.fragment.afterColor=void 0}blendPositions(){let r=this.layers.filter(a=>a instanceof Nm);if(r.length>0){let a=r[0].position;for(let n=1;n<r.length;++n)r[n]&&(a=new ki(a,r[n].position,ki.ADD),a=new ki(a,new Fe(.5).setReadonly(!0),ki.MUL));this.fragment.position=a}else this.fragment.position=void 0}getDefines(){return this.defines}getUniforms(){return this.uniforms}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}onBeforeCompile(r){this.shapeBlendhack&&this.shapeBlendhack(this),r.uniforms=this.uniforms,r.vertexShader=this.vertexShader,r.fragmentShader=this.fragmentShader,r.extensionDerivatives=this.extensions.derivatives===!0,r.extensionFragDepth=this.extensions.fragDepth===!0,r.extensionDrawBuffers=this.extensions.drawBuffers===!0,r.extensionShaderTextureLOD=this.extensions.shaderTextureLOD===!0}clampUniformsForPreview(r,a){let n=(o,f,y)=>Math.min(Math.max(o,f),y);for(let o of this.layers)if(o.type==="displace"){let f=n(o.uniforms[`f${o.id}_intensity`].value,r,a);o.uniforms[`f${o.id}_intensity`].value=f}}updateFrame(r){for(let a=0;a<this.updaters.length;++a)r.updateNode(this.updaters[a])}build(){let r=new Hd;r.needsJitter=this.needsJitter,this.lights=this.lightLayer.data.visible,r.build(this.fragment,this.fragment),this.vertexShader=r.getCode("vertex"),this.fragmentShader=r.getCode("fragment"),this.defines=r.defines,this.uniforms=r.uniforms,this.extensions=r.extensions,this.updaters=r.updaters;for(let a of this.flavors)a&&a.updateAfterBuild();return this.shadersPatchedForShapeBlend=!1,this}nodeMaterialDispose(){this.layers.forEach(r=>r.dispose()),super.dispose();for(let r of this.flavors)r&&r.dispose()}assetsLoaded(){for(let r of this.layers)if(r instanceof Br){let a=r.params.texture;if(a instanceof Jc&&!a.image.loaded)return!1}return!0}};Object.defineProperties(Vn.prototype,{properties:{get:function(){return this.fragment.properties}}});var ru=class extends Ua{constructor(r,a,n){super(r,a,!1),this.uuid=n,this.allowVariableSaves=!0,this.saveVariableLocations(a)}},e3=new Map;function t3(r){if(typeof r=="string")return r;let a=e3.get(r);return a||(a={url:URL.createObjectURL(new Blob([r]))},e3.set(r,a)),a.url}var n3=new Promise(r=>{}),a3;n3.then(r=>a3=r);var za=class{constructor({src:r,volume:a,delay:n,loop:o}){this._volume=1,this.delay=0,this._loop=1,this.loopsRemaining=0,this._status="stopped",this.onEnd=()=>{this.loopsRemaining===1/0?this.replay():this.loopsRemaining>1?(this.replay(),this.loopsRemaining--):(this._status="stopped",this.loopsRemaining=this._loop)};let f;typeof r=="string"?f={src:r}:f={src:t3(r),format:"wav"},this.sound=new a3.Howl(f),this.sound.on("end",this.onEnd),this.src=r,a!==void 0&&(this.volume=a),n!==void 0&&(this.delay=n),o!==void 0&&(this.loop=o)}get status(){return this._status}get volume(){return this._volume}set volume(r){this._volume=r,this.sound.volume(r)}get loop(){return this._loop}set loop(r){this._loop=r,this.loopsRemaining=r}replay(){this.clearDelay(),this.delayTimerId=window.setTimeout(()=>{this.sound.play(),this.clearDelay()},this.delay)}fade(r,a=1e3){r?(this.sound.volume(this._volume),this.clearFade(),this.fadeTimerId=window.setTimeout(()=>{this.sound.fade(this._volume,0,a),this.clearFade()},r)):this.sound.fade(this._volume,0,a)}on(r,a,n){this.sound.on(r,a,n)}off(r,a,n){this.sound.off(r,a,n)}play(){this._status==="playing"||this.sound.playing()||(this._status==="paused"?(this.sound.seek()===0?this.replay():this.sound.play(),this._status="playing"):this._status==="stopped"&&(this.replay(),this._status="playing"))}pause(){this._status==="playing"&&(this.sound.pause(),this.clearFade(),this.clearDelay(),this._status="paused")}stop(){this.sound.stop(),this.loopsRemaining=this._loop,this.clearFade(),this.clearDelay(),this._status="stopped"}clearFade(){this.fadeTimerId&&(clearTimeout(this.fadeTimerId),delete this.fadeTimerId)}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}dispose(r=!1){this.off(),this.stop(),this.clearFade(),this.clearDelay()}},gx=class{constructor(){this.type="ShapePath",this.color=new qe,this.subPaths=[],this.currentPath=null}moveTo(r,a){return this.currentPath=new _c,this.subPaths.push(this.currentPath),this.currentPath.moveTo(r,a),this}lineTo(r,a){var n;return(n=this.currentPath)==null||n.lineTo(r,a),this}quadraticCurveTo(r,a,n,o){var f;return(f=this.currentPath)==null||f.quadraticCurveTo(r,a,n,o),this}bezierCurveTo(r,a,n,o,f,y){var x;return(x=this.currentPath)==null||x.bezierCurveTo(r,a,n,o,f,y),this}splineThru(r){var a;return(a=this.currentPath)==null||a.splineThru(r),this}toShapes(){let r={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},a={loc:r.ORIGIN,t:0};function n(T,M,O,I){let D=T.x,z=M.x,k=O.x,L=I.x,R=T.y,F=M.y,B=O.y,N=I.y,j=(L-k)*(R-B)-(N-B)*(D-k),G=(z-D)*(R-B)-(F-R)*(D-k),Y=(N-B)*(z-D)-(L-k)*(F-R),X=j/Y,$=G/Y;if(Y===0&&j!==0||X<=0||X>=1||$<0||$>1)return null;if(j===0&&Y===0){for(let te=0;te<2;te++)if(o(te===0?O:I,T,M),a.loc===r.ORIGIN){let ee=te===0?O:I;return{x:ee.x,y:ee.y,t:a.t}}else if(a.loc===r.BETWEEN){let ee=+(D+a.t*(z-D)).toPrecision(10),q=+(R+a.t*(F-R)).toPrecision(10);return{x:ee,y:q,t:a.t}}return null}else{for(let q=0;q<2;q++)if(o(q===0?O:I,T,M),a.loc===r.ORIGIN){let Z=q===0?O:I;return{x:Z.x,y:Z.y,t:a.t}}let te=+(D+X*(z-D)).toPrecision(10),ee=+(R+X*(F-R)).toPrecision(10);return{x:te,y:ee,t:X}}}function o(T,M,O){let I=O.x-M.x,D=O.y-M.y,z=T.x-M.x,k=T.y-M.y,L=I*k-z*D;if(T.x===M.x&&T.y===M.y){a.loc=r.ORIGIN,a.t=0;return}if(T.x===O.x&&T.y===O.y){a.loc=r.DESTINATION,a.t=1;return}if(L<-Number.EPSILON){a.loc=r.LEFT;return}if(L>Number.EPSILON){a.loc=r.RIGHT;return}if(I*z<0||D*k<0){a.loc=r.BEHIND;return}if(Math.sqrt(I*I+D*D)<Math.sqrt(z*z+k*k)){a.loc=r.BEYOND;return}let R;I!==0?R=z/I:R=k/D,a.loc=r.BETWEEN,a.t=R}function f(T,M){let O=[],I=[];for(let D=1;D<T.length;D++){let z=T[D-1],k=T[D];for(let L=1;L<M.length;L++){let R=M[L-1],F=M[L],B=n(z,k,R,F);B!==null&&O.find(N=>N.t<=B.t+Number.EPSILON&&N.t>=B.t-Number.EPSILON)===void 0&&(O.push(B),I.push(new V(B.x,B.y)))}}return I}function y(T,M,O){let I=new V;M.getCenter(I);let D=[];return O.forEach(z=>{z.boundingBox.containsPoint(I)&&f(T,z.points).forEach(k=>{D.push({identifier:z.identifier,isCW:z.isCW,point:k})})}),D.sort((z,k)=>z.point.x-k.point.x),D}function x(T,M,O,I,D){(D==null||D==="")&&(D="nonzero");let z=new V;T.boundingBox.getCenter(z);let k=[new V(O,z.y),new V(I,z.y)],L=y(k,T.boundingBox,M);L.sort((G,Y)=>G.point.x-Y.point.x);let R=[],F=[];L.forEach(G=>{G.identifier===T.identifier?R.push(G):F.push(G)});let B=R[0].point.x,N=[],j=0;for(;j<F.length&&F[j].point.x<B;)N.length>0&&N[N.length-1]===F[j].identifier?N.pop():N.push(F[j].identifier),j++;if(N.push(T.identifier),D==="evenodd"){let G=N.length%2===0,Y=N[N.length-2];return{identifier:T.identifier,isHole:G,for:Y}}else if(D==="nonzero"){let G=!0,Y=null,X=null;for(let $=0;$<N.length;$++){let te=N[$];M[te]&&(G?(X=M[te].isCW,G=!1,Y=te):X!==M[te].isCW&&(X=M[te].isCW,G=!0))}return{identifier:T.identifier,isHole:G,for:Y}}else console.warn('fill-rule: "'+D+'" is currently not implemented.')}let b=0,_=999999999,S=-999999999,A=[];this.subPaths.forEach(T=>{let M=T.getPoints(),O=-999999999,I=999999999,D=-999999999,z=999999999;for(let k=0;k<M.length;k++){let L=M[k];L.y>O&&(O=L.y),L.y<I&&(I=L.y),L.x>D&&(D=L.x),L.x<z&&(z=L.x)}S<=D&&(S=D+1),_>=z&&(_=z-1),M.length&&A.push({curves:T.curves,points:M,isCW:Ku.isClockWise(M),identifier:b++,boundingBox:new gl(new V(z,I),new V(D,O))})});let C=A.map(T=>{var M;return x(T,A,_,S,(M=this.userData)==null?void 0:M.style.fillRule)}),P=[];return A.forEach(T=>{let M=C[T.identifier];if(M&&!M.isHole){let O=new fa;O.curves=T.curves,C.filter(I=>(I==null?void 0:I.isHole)&&I.for===T.identifier).forEach(I=>{if(I){let D=A[I.identifier],z=new _c;z.curves=D.curves,O.holes.push(z)}}),P.push(O)}}),P}};new Promise(r=>{});async function KY(r){return await(await fetch(r)).arrayBuffer()}async function UE(r){let a,n,o=!1;if(r.url?(a=await KY(r.url),n=r.url,o=r.url.startsWith("/")):r.data&&(a=r.data.buffer.slice(r.data.byteOffset,r.data.byteOffset+r.data.byteLength)),a)return{font:void 0,url:n,intercepted:o,arr:a,bidi:null}}function ZY(r,a){return a.state.glyphIndex===r||a.state.fina===r||a.state.medi===r||a.state.init===r}var vx=class{constructor(r){this._arrayBuffer=new ArrayBuffer(1),this._isLoaded=!1,this._intercepted=!1,this._isUserFont=r.isUserFont??!1,this._loadingPromise=UE(r).then(a=>{a&&(this._arrayBuffer=a.arr,this._url=a.url,this.font=a.font,this._intercepted=a.intercepted,this._isLoaded=!0,this._bidi=a.bidi)})}update(r){this._isLoaded=!1,this._isUserFont=r.isUserFont??!1,this._loadingPromise=UE(r).then(a=>{a&&(this._arrayBuffer=a.arr,this._url=a.url,this.font=a.font,this._intercepted=a.intercepted,this._isLoaded=!0,this._bidi=a.bidi)})}get url(){return this._url}get intercepted(){return this._intercepted}get isLoaded(){return this._isLoaded}get loadingPromise(){return this._loadingPromise}reverseLigaturesTable(r,a,n){if(!this._bidi)return[];let o=this._bidi;o.getTextGlyphs(a);let f=o.tokenizer.tokens,y=[],x=0,b=n.length===f.length;for(let _=0;_<n.length;_++){let S=n[_].index,A=String.fromCharCode(n[_].unicode),C=f[x];if(ZY(S,C)||b)y.push({char:A,index:S,replacements:[C.state.glyphIndex],replacementChars:[C.char]}),x++;else{let P=C.char,T="",M=[C.state.glyphIndex],O=[],I=!1;for(;!I;)x++,T=a.charAt(x),P+=T,M.push(r.charToGlyphIndex(T)),O=r.stringToGlyphs(P),O.length===1&&O[0].index===S&&(I=!0),x>a.length&&(I=!0);y.push({char:A,index:S,replacements:M,replacementChars:Array.from(P)}),x++}}return y}generateShapes(r,a,n){var D;if(!this._isLoaded)return;let o=this.font,f=a.fontSize/this.unitsPerEm,y=a.fontSize*a.lineHeight,x=r.map(z=>this.getTextWidth(z,a)),b=typeof a.width=="string"?Number(n.getVariable(a.width)):a.width,_=typeof a.height=="string"?Number(n.getVariable(a.height)):a.height,S=this.getCharWidth(`
`,a),A=a.horizontalAlign===1?S:0,C=this.getLineInitialOffsetX(x[0],b,a.horizontalAlign,r[0],S),P=this.getLineInitialOffsetY(y,r.length,_,f,a.verticalAlign),T=[],M=r.map(z=>[]),O=r.map(z=>[]);for(let z=0;z<r.length;z++){let k=r[z],L={features:{liga:!0},letterSpacing:a.letterSpacing},R=[];try{R=o.stringToGlyphs(k,L)}catch(G){console.warn(G)}C=this.getLineInitialOffsetX(x[z],b,a.horizontalAlign,k,S);let F=[];try{F=this.reverseLigaturesTable(o,k,R)}catch(G){console.warn(G)}let B=this.computeSpaceWidthForLine(r,z,a,n),N=0,j=R[0];j&&a.horizontalAlign===2&&j.leftSideBearing!==void 0&&(C-=j.leftSideBearing*f),(D=this.font)==null||D.forEachGlyph(k,C,P,a.fontSize,L,(G,Y,X,$,te)=>{let ee=G.index===0?`
`:G.unicode?String.fromCharCode(G.unicode):void 0,q=F[N],Z=0;if(ee===`
`)Z=A;else if(ee===" ")Z=B;else{let U=this.createPath(G,f,Y,X,a);U&&(Z=U.offsetX,T.push(U.path))}if(q.replacements.length===1)O[z].push([Y,X]),M[z].push(Z);else{let U=q.replacements.map(le=>(o.glyphs.get(le).advanceWidth??0)*f),W=U.reduce((le,me)=>le+=me,0),H=U.map(le=>le/W),K=Y;for(let le=0;le<H.length;le++){let me=Z*H[le];O[z].push([K,X]),M[z].push(me),K+=me}}N++}),P-=y}let I=[];for(let z=0,k=T.length;z<k;z++)I.push(...T[z].toShapes());return{shapes:I,charWidths:M,lineWidths:x,charCoords:O}}get isUserFont(){return this._isUserFont}get arrayBuffer(){return this._arrayBuffer}get ascender(){var r;return((r=this.font)==null?void 0:r.ascender)??0}get descender(){var r;return((r=this.font)==null?void 0:r.descender)??0}get familyName(){var r;return((r=this.font)==null?void 0:r.names.fontFamily)??""}get subfamilyName(){var r;return((r=this.font)==null?void 0:r.names.fontSubfamily)??""}get unitsPerEm(){var r;return((r=this.font)==null?void 0:r.unitsPerEm)??1}getLineInitialOffsetX(r,a,n,o,f){return(n===3||n===2)&&o.indexOf(`
`)>=0&&(r-=f),n===3?a*.5-r*.5:n===2?a-r:0}getLineInitialOffsetY(r,a,n,o,f){let y=a*r,x=Math.abs(this.ascender-this.descender)*o,b=r-x,_=-this.ascender*o-b/2;return f===3?-(n-y-_):f===2?-(n*.5-y*.5-_):_}createPath(r,a,n,o,f){var _;let y=r.getPath(n,-o,f.fontSize,{kerning:!1,letterSpacing:f.letterSpacing});if(!y){console.error('THREE.Font: character "'+r+'" does not exists in font family '+this.familyName+".");return}let x=new gx,b=(r.advanceWidth??1)*a;if(r)for(let S of y.commands){let A=(_=x.currentPath)==null?void 0:_.currentPoint;if(!(A&&S.type!=="Z"&&A.x===S.x&&-A.y===S.y))switch(S.type){case"M":x.moveTo(S.x,-S.y);break;case"L":x.lineTo(S.x,-S.y);break;case"Q":x.quadraticCurveTo(S.x1,-S.y1,S.x,-S.y);break;case"C":x.bezierCurveTo(S.x1,-S.y1,S.x2,-S.y2,S.x,-S.y);break}}return x.subPaths.forEach(S=>{let A=JY(S.curves);A!==void 0&&S.currentPoint.distanceTo(A)>0&&S.lineTo(A.x,A.y)}),{offsetX:b,path:x}}getCharWidth(r,a){var n;return((n=this.font)==null?void 0:n.getAdvanceWidth(r,a.fontSize,{kerning:!0,letterSpacing:a.letterSpacing}))??0}getTextWidth(r,a){var n;return((n=this.font)==null?void 0:n.getAdvanceWidth(r,a.fontSize,{kerning:!0,letterSpacing:a.letterSpacing}))??0}computeSpaceWidthForLine(r,a,n,o){let f=this.getCharWidth(" ",n),y=r[a];if(y){let x=this.countSpaces(y.trimEnd());if(n.horizontalAlign===4&&a<r.length-1&&x){let b=typeof n.width=="string"?Number(o.getVariable(n.width)):n.width,_=this.getTextWidth(y,n);return(b-(_-x*f))/x}}return f}countSpaces(r){return(r.match(/ /g)||[]).length}};function JY(r){if(r.length){let a=r[0];if(a instanceof cn)return a.v1;if(a instanceof ln||a instanceof Yn)return a.v0}}var zE=class{constructor(){this.objects=new Map,this.unreachable=new Set}getCached(r){return this.objects.get(r)}get size(){return this.objects.size}get(r,a,n){let o=this.objects.get(r);return o===void 0?(o=this.createObject(r,a,n),this.objects.set(r,o)):o.isShared=!0,o}forceDelete(r){let a=this.objects.get(r);a&&(this.disposeObject(a),this.objects.delete(r))}mutateIfUnique(r,a){let n=this.objects.get(r);if(n&&n.isShared!==!0)return this.objects.delete(r),this.objects.set(a,n),n}startGc(){this.unreachable=new Set(this.objects.keys())}markAsReachable(r,a){let n=this.objects.get(r);a===n&&this.unreachable.delete(r)}endGc(){this.unreachable.forEach(r=>{this.disposeObject(this.objects.get(r)),this.objects.delete(r)}),this.unreachable.clear()}dispose(){this.objects.forEach(r=>{this.disposeObject(r)}),this.objects.clear()}},Vm=class extends zE{constructor(r){super(),this.flatShading=r}disposeObject(r){r.dispose()}createObject(r,a,n){let o=Ba(r,a,this.flatShading,n);return o.computeBoundingSphere(),o}},d3={markNeedsUpdateRendererDirty:()=>{}},xx=1e3,f3=512*xx;function $Y(r,a){let n=typeof r;return!!((a==="string"||a==="number")&&n===a||a==="boolean"&&(r==="true"||r==="false"||r===!0||r===!1)||a==="image"&&n==="string"&&r.startsWith("http"))}var p3="https://hooks.spline.design",eK=`${p3}/events?hashFile=`,bx=class{constructor(r,a){this.id=r,this.userWebhook=a,this.result=void 0,this._connected=!1,this.emitter=La(),this.reconnectWaitFor=xx,this._onError=n=>{var o,f,y;(o=this.eventSource)==null||o.removeEventListener("message",this._onMessage),(f=this.eventSource)==null||f.removeEventListener("error",this._onError),(y=this.eventSource)==null||y.removeEventListener("open",this._onConnected),this._scheduleReconnect()},this._onConnected=n=>{clearTimeout(this.scheduledReconnectHandle),this.reconnectWaitFor=xx,this._connected=!0},this._onDisconnected=()=>{clearTimeout(this.scheduledReconnectHandle),this.reconnectWaitFor=xx,this._connected=!1},this._onMessage=n=>{let o=n.data,f;try{f=JSON.parse(o)}catch(y){console.error("Error parsing webhook message",y)}if(f){let y=!1;this.userWebhook.parametersSchemas.forEach(({data:x})=>{f[x.name]!==void 0&&$Y(f[x.name],x.type)&&(this.result===void 0&&(this.result={}),this.result[x.name]=f[x.name],y=!0)}),y&&this.emitter.emit("message",{userWebhookId:this.id})}}}connect(){clearTimeout(this.scheduledReconnectHandle),this.userWebhook.url&&(this.eventSource=new EventSource(eK+this.userWebhook.url),this.eventSource.addEventListener("message",this._onMessage),this.eventSource.addEventListener("error",this._onError),this.eventSource.addEventListener("open",this._onConnected))}disconnect(){var r,a,n,o;(r=this.eventSource)==null||r.removeEventListener("message",this._onMessage),(a=this.eventSource)==null||a.removeEventListener("error",this._onError),(n=this.eventSource)==null||n.removeEventListener("open",this._onConnected),(o=this.eventSource)==null||o.close(),this._onDisconnected(),clearTimeout(this.scheduledReconnectHandle)}_scheduleReconnect(){this.reconnectWaitFor*=2,this.reconnectWaitFor>f3&&(this.reconnectWaitFor=f3),clearTimeout(this.scheduledReconnectHandle),this.scheduledReconnectHandle=setTimeout(()=>{this.scheduledReconnectHandle=void 0,this.connect()},this.reconnectWaitFor)}update(r){this.userWebhook=r}dispose(){this._connected&&this.disconnect()}get connected(){return this._connected}on(r,a){this.emitter.on(r,a)}off(r,a){this.emitter.off(r,a)}getParametersKeys(){return this.userWebhook.parametersSchemas.map(r=>r.data.name)}getParameterValue(r){var a;if(this.getParametersKeys().includes(r)){if(this.result)return(a=this.result)==null?void 0:a[r];for(let n of this.userWebhook.parametersSchemas)if(n.data.name===r)return p0.defaultParameterValueByType(n.data.type)}}},m3=[4186.01,4434.92,4698.63,4978.03,5274.04,5587.65,5919.91,6271.93,6644.88,7040,7458.62,7902.13],tK=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],ka=[],wx=[];for(let r=1;r<=8;r++)for(let a=0;a<m3.length;a++){let n=m3[a];ka.push(n/Math.pow(2,8-r)),wx.push(tK[a]+r)}var Sx=[32,2e3],kE=ka.filter((r,a)=>ka[a]>Sx[0]&&ka[a]<Sx[1]),g3=wx.filter((r,a)=>ka[a]>Sx[0]&&ka[a]<Sx[1]),Ax=class{static getFrequencies(r,a,n,o="frequency",f=-100,y=-30){n||(n=new Float32Array(r.frequencyBinCount),r.getFloatFrequencyData(n));let x=a/2,b=1/n.length*x,_,S,A;if(o==="music"||o==="voice"){let P=o==="voice"?kE:ka,T=Array(P.length).fill(f);for(let M=0;M<n.length;M++){let O=M*b,I=n[M];for(let D=P.length-1;D>=0;D--)if(O>P[D]){T[D]=Math.max(T[D],I);break}}_=T,S=o==="voice"?kE:ka,A=o==="voice"?g3:wx}else _=Array.from(n),S=_.map((P,T)=>b*T),A=S.map(P=>`${P.toFixed(2)} Hz`);let C=_.map(P=>Math.max(0,Math.min((P-f)/(y-f),1)));return{values:new Float32Array(C),frequencies:S,labels:A}}},rK="gpt-4o-realtime-preview-2024-12-17",iK=()=>"https://relayserver.spline.design/";async function nK(r){try{return(await(await fetch(iK()+"session?uuidfile="+r)).json()).token}catch(a){console.error("Token generation error:",a)}}var GE=class{constructor(r){this.value=0,this.frequencies=new Float32Array(0);let a=new AudioContext;this.source=a.createMediaStreamSource(r),this.analyser=a.createAnalyser(),this.source.connect(this.analyser),this.analyser.fftSize=8192,this.analyser.smoothingTimeConstant=.1}getFrequencies(r=-100,a=-30){if(!this.analyser)throw new Error("Not connected, please call .connect() first");return Ax.getFrequencies(this.analyser,44100,void 0,"voice",r,a)}update(){let r=this.getFrequencies(),a=r.values.reduce((n,o)=>n+o,0)/r.values.length;this.value=a,this.frequencies=r.values}disconnect(){this.source.disconnect(),this.analyser.disconnect()}},Um=class{constructor(r,a,n){this.data=r,this.id=a,this.shared=n,this.emitter=La(),this.rafId=0,this.voice=0,this.frequencies=new Float32Array([0]),this.events=[],this.isConnected=!1,this.isToolsAdded=!1,this.tools=[],this.onMessage=o=>{var y;let f=JSON.parse(o.data);if(this.appendEvent(f),f.type==="session.created"&&this.onSessionCreated(),f.type==="response.done"&&((y=f.response)==null?void 0:y.output)){for(let x of f.response.output)if(x.type==="function_call")for(let[b,_]of this.tools)x.name===b.name&&(_(JSON.parse(x.arguments)),setTimeout(()=>{this.sendClientEvent({type:"response.create",response:{instructions:"notice the user about what you just did"}})}))}},this.onSessionCreated=()=>{this.isToolsAdded||this.registerTools()},this.onOpen=()=>{this.events=[],this.isConnected=!0,this.sendClientEvent({type:"response.create",response:{instructions:"Say hi"}})},this.animate=()=>{if(this.rafId=requestAnimationFrame(this.animate),this.isConnected&&this.analyser){this.analyser.update();let o=this.analyser.value,f=this.analyser.frequencies;this.voice=o,this.frequencies=f,this.emitter.emit("voice",{value:o,frequencies:f})}}}update(r){this.data=r}setColorByName(r,a){let n=this.shared.getColorByName(r);if(n){let{id:o}=n,{r:f,g:y,b:x}=uR.hexStringToRgb(a)??{r:0,g:0,b:0};this.shared.updateColor(o,{r:f/255,g:y/255,b:x/255})}}async connect(){if(this.isConnected)return;let r=await nK(this.data.integration.hash);this.pc=new RTCPeerConnection,this.audioElement=document.createElement("audio"),this.audioElement.autoplay=!0,this.pc.ontrack=f=>{let y=f.streams[0];this.audioElement.srcObject=y,this.analyser=new GE(y)};let a=await navigator.mediaDevices.getUserMedia({audio:!0});this.pc.addTrack(a.getTracks()[0]),this.dc=this.pc.createDataChannel("oai-events"),this.dc.addEventListener("message",this.onMessage),this.dc.addEventListener("open",this.onOpen);let n=await this.pc.createOffer();await this.pc.setLocalDescription(n);let o={type:"answer",sdp:await(await fetch(`https://api.openai.com/v1/realtime?model=${rK}`,{method:"POST",body:n.sdp,headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/sdp"}})).text()};await this.pc.setRemoteDescription(o),this.animate()}appendEvent(r){this.events=[r,...this.events]}sendClientEvent(r){this.dc?(r.event_id=r.event_id||crypto.randomUUID(),this.dc.send(JSON.stringify(r)),this.appendEvent(r)):console.error("Failed to send message - no data channel available",r)}registerTools(){this.isToolsAdded=!0,this.registerTool({type:"function",name:"set_personality_color",description:"returns a color based on the voice personality of the ai assistant. This should be called by the voice assistant each time it is asks to speak differently. If a color cannot be associated to the personality, the color should be a neutral color.",parameters:{type:"object",properties:{color:{type:"string",description:"css hex color string, reflecting the personality"},personality:{type:"string",description:"the personality of the voice assistant"}},required:["color","personality"]}},({color:f})=>{this.setColorByName("Voice Assistant Color",f)});let r=this.shared.getVariablesNames().join(", ");this.registerTool({type:"function",name:"set_variable",description:"Sets a Spline variable value when asked by the user.",parameters:{type:"object",properties:{name:{type:"string",description:`The name of the variable that needs to be set. Here's a list of available variables: ${r}. It the variable does not exist, don't call the function and warn the user about it.`},value:{type:"string",description:"The new value for this variable, should always be a string even for number and boolean variables, assume that the value will be cast to the proper type afterwards."}},required:["name","value","type"]}},({name:f,value:y})=>{let x=this.shared.getVariableByName(f);if(x){let b=this.shared.getVariable(x.id),_;typeof b=="number"?_=parseFloat(y):typeof b=="boolean"?_=y.toLowerCase()==="true":_={textValue:y},this.shared.updateVariable(x.id,_)}});let a=this.shared.getColorNames().join(", ");this.registerTool({type:"function",name:"set_color",description:"Sets a Spline color asset value when asked by the user.",parameters:{type:"object",properties:{name:{type:"string",description:`The name of the color asset that needs to be set. Here's a list of available color assets: ${a}. It the color asset does not exist, don't call the function and warn the user about it.`},value:{type:"string",description:"css hex color string"}},required:["name","value"]}},({name:f,value:y})=>{this.setColorByName(f,y)});let n=this.shared.scene,o=[];n.traverseEntity(f=>{f.data.events.forEach(y=>{if(y.data.type==="AIAssistantTrigger"){let{description:x}=y.data;o.push(x)}})}),this.registerTool({type:"function",name:"trigger_event",description:"Trigger an event by name, here are the available events, please match what the user is asking for to one of these if it applies, otherwise don't call the function and warn the user.",parameters:{type:"object",properties:{description:{type:"string",description:`The name of the event that needs to be triggered. Here's a list of available events: ${JSON.stringify(o)}.`},direction:{type:"string",description:"default is forward, but can be forward or backward. Always set to forward unless the user ask to reverse or cancel the event, then set to backward."}},required:["description","direction"]}},({description:f,direction:y})=>{this.emitter.emit("trigger_event",{description:f,direction:y})}),this.sendClientEvent({type:"session.update",session:{tools:this.tools.map(([f])=>f)}})}registerTool(r,a){this.tools.push([r,a])}disconnect(){var r,a,n,o,f,y;cancelAnimationFrame(this.rafId),(r=this.analyser)==null||r.disconnect(),this.voice=0,this.isConnected=!1,this.isToolsAdded=!1,(a=this.dc)==null||a.removeEventListener("message",this.onMessage),(n=this.dc)==null||n.removeEventListener("open",this.onOpen),(o=this.dc)==null||o.close(),(f=this.pc)==null||f.getSenders().forEach(x=>{x.track&&x.track.stop()}),(y=this.pc)==null||y.close(),this.pc=void 0}computeAnalysisForListenerEvent(r){if(r.analysis==="range"){let a=this.frequencies.slice(...r.analysisRange);return a.reduce((n,o)=>n+o,0)/a.length}return r.analysis==="single"?this.frequencies[r.analysisSingle]:this.voice}on(r,a){this.emitter.on(r,a)}off(r,a){this.emitter.off(r,a)}};function Ex(r){return"variable_"+r}var jE=class extends cx{constructor(r){super(),this.shared=r}create(r){return new af(r,this.shared)}},iu=class{constructor(r,a={},n=!0,o=!1){if(this.data=r,this.needsJitter=n,this.enableLocalStorageForPersistentVariables=o,this.geometryCache=new Vm(!0),this.geometryCache2=new Vm(!1),this.imageHolderCache=new jE(this),this.thisContext={scene:d3,shared:this},this.deletedMaterial=new ru(qr.defaultTwoLayerData("phong"),this.thisContext,""),this.deletedImage=new $n(g0.emptyImage,this),this.deletedVideo=new $n(Yh.defaultVideo,this),this.materials={},this.images={},this.uiBuffers={},this.videos={},this.colors={},this.audios={},this.particles={},this.fonts={},this.variables={},this.userAPIs={},this.userWebhooks={},this.mouseProperty=null,this.raycastProperty=null,this.requestRender=()=>{this._requestRender&&this._requestRender()},a.images)for(let[f,y]of Object.entries(a.images))this.addImage(f,y);if(a.videos)for(let[f,y]of Object.entries(a.videos))this.addVideo(f,y);if(a.audios)for(let[f,y]of Object.entries(a.audios))this.addAudio(f,y);if(a.particles)for(let[f,y]of Object.entries(a.particles))this.addParticle(f,y);this.reset(r)}setRequestRender(r){this._requestRender=r}getImageLoadPromises(){return Object.values(this.images).map(r=>r.loadPromise)}setEntityOpContext(r){this.entityOpContext=r}reset(r,a=!1,n=!1){this.data=r,this.resetLib(r.lib);for(let{id:o,data:f}of r.variables)this.addVariableHolder(o,f),a&&this.updateVariableHolder(o,f);for(let[o,f]of Object.entries(r.userAPIs))this.addUserAPI(o,f);for(let[o,f]of Object.entries(r.userWebhooks))this.addUserWebhook(o,f);if(!n){for(let[o,f]of Object.entries(r.images))this.addImage(o,f);for(let[o,f]of Object.entries(r.videos))this.addVideo(o,f)}for(let[o,f]of Object.entries(r.colors))this.addColor(o,f);for(let[o,f]of Object.entries(r.materials))this.addMaterial(o,f);for(let[o,f]of Object.entries(r.audios))this.addAudio(o,f);for(let[o,f]of Object.entries(r.particles))this.addParticle(o,f);for(let[o,f]of Object.entries(r.fonts))this.addFont(o,f)}addMaterial(r,a){if(this.materials[r]){let n=this.materials[r];n.reset(a,this.thisContext),n.dispose()}else{let n=new ru(a,this.thisContext,r);this.materials[r]=n}}deleteMaterial(r){this.materials[r]&&(this.materials[r].nodeMaterialDispose(),delete this.materials[r])}getMaterial(r){return this.materials[r]}getMaterialOrDeletedPlaceholder(r){return this.materials[r]??this.deletedMaterial}material(r){return typeof r=="string"?this.getMaterialOrDeletedPlaceholder(r):r==null?(console.error("material is undefined or null"),this.deletedMaterial):new Ua(r,this.thisContext)}getMaterials(){return this.materials}addImage(r,a){return this.images[r]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.images[r].updateSrc(a.data),!0):(this.images[r]=new $n(a,this),!1)}deleteImage(r){let a=this.images[r];a&&(a.dispose(),delete this.images[r])}getDefaultImage(){return this.images.image_0}getImage(r){return this.images[r]??this.deletedImage}image(r){return typeof r=="string"?this.getImage(r):this.imageHolderCache.load(r)}addUIBuffer(r,a){return this.uiBuffers[r]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.uiBuffers[r].updateSrc(a),!0):(this.uiBuffers[r]=new $n(a,this),!1)}uiBuffer(r){return this.uiBuffers[r]}addVideo(r,a){return this.videos[r]?(this.videos[r].updateSrc(a.data),!0):(this.videos[r]=new $n(a,this),!1)}deleteVideo(r){let a=this.videos[r];a&&(a.dispose(),delete this.videos[r])}getVideo(r){return this.videos[r]??this.deletedVideo}video(r){return typeof r=="string"?this.getVideo(r):this.imageHolderCache.load(r)}addColor(r,a){return this.colors[r]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),"a"in a?this.colors[r].setRGBA(a.r,a.g,a.b,a.a):this.colors[r].setRGBA(a.r,a.g,a.b,1),!0):("a"in a?this.colors[r]=new ql(a.r,a.g,a.b,a.a):this.colors[r]=new ql(a.r,a.g,a.b,1),!1)}updateColor(r,a){if(this.colors[r]){this.onColorOrImageUpdate&&this.onColorOrImageUpdate();let n=this.colors[r];return this.colors[r].r=a.r??n.r,this.colors[r].g=a.g??n.g,this.colors[r].b=a.b??n.b,this.colors[r].a=a.a??n.a,!0}return!1}deleteColor(r){this.colors[r]&&delete this.colors[r]}getColor(r){return this.colors[r]}getColorNames(){return Object.values(this.data.colors).map(r=>r.name)}getColorByName(r){for(let a in this.data.colors)if(this.data.colors[a].name===r)return{color:this.colors[a],id:a}}color(r){let a;if(typeof r=="string"){let n=this.getColor(r);n?a=n:(console.warn("Tried to create color layer params with a color key that does not exist in the assets manager"),a=new br(0,0,0,0))}else return"a"in r?new br(r.r,r.g,r.b,r.a):new br(r.r,r.g,r.b,1);return a}addAudio(r,a){this.audios[r]=a}getAudio(r){let a=this.audios[r];if(a instanceof za)return a;{let n=new za({src:a.data});return this.audios[r]=n,n}}addParticle(r,a){this.particles[r]=a}getParticle(r){return this.particles[r]}deleteParticle(r){this.particles[r]&&delete this.particles[r]}deleteAudio(r){let a=this.audios[r];a&&(a instanceof za&&a.dispose(),delete this.audios[r])}addFont(r,a){this.fonts[r]=new vx(a),this.fonts[r].loadingPromise.then(()=>this.requestRender())}getFont(r){return this.fonts[r]}deleteFont(r){this.fonts[r]&&delete this.fonts[r]}dispose(){Object.keys(this.materials).forEach(r=>this.deleteMaterial(r)),this._requestRender=void 0,Object.values(this.audios).forEach(r=>{r instanceof za&&r.dispose()}),this.audios={},this.particles={},this.geometryCache.dispose(),this.geometryCache2.dispose()}addVariableHolder(r,a){if(this.variables[r]===void 0){let n=a.value;if(this.enableLocalStorageForPersistentVariables&&a.persistent){let o=localStorage.getItem(Ex(r));n=o!==null?JSON.parse(o):a.value}return this.variables[r]={value:n,locations:[],persistent:a.persistent},"dynamicVariableType"in a&&(this.variables[r].dynamicVariablePlayState="Playing",this.variables[r].dynamicVariableToggleIsForward=void 0),!0}return this.variables[r].value=a.value,!1}resetDynamicVariablePlayState(){for(let r in this.variables)this.variables[r].dynamicVariablePlayState!==void 0&&(this.variables[r].dynamicVariablePlayState="Playing",this.variables[r].dynamicVariableToggleIsForward=void 0)}updateVariableHolder(r,a){this.updateVariable(r,a.value)}updateVariable(r,a){if(this.variables[r]===void 0)return!1;this.variables[r].value=a,this.enableLocalStorageForPersistentVariables&&this.variables[r].persistent&&localStorage.setItem(Ex(r),JSON.stringify(a));let n=a;for(;typeof n=="string";)n=this.variables[n].value;let o=this.entityOpContext.scene;for(let f=this.variables[r].locations.length-1;f>=0;f--){let y=this.variables[r].locations[f];if(y[0]==="material"){let x=y[1],b=n,_={scene:o,shared:this},S=y.slice(2);o.traverseMaterial(C=>{let P=C.root??C;P.uuid===x&&P.onVariableUpdate(S,b,_)});let A=this.materials[x];A&&A.onVariableUpdate(S,b,_)}else{let x=o.find(y[0]);if(x===void 0){this.variables[r].locations.splice(f,1);continue}if(y[1]!=="geometry"&&y[1]!=="particles"){for(let b=1;b<y.length-1;b++)x=x[y[b]];y[1]==="rotation"?x[y[y.length-1]]=n*we.DEG2RAD:x[y[y.length-1]]=n}if(x=o.find(y[0]),x.type==="ParticleEmitter"&&x.updateVariableState(n,y),mt.is(x))if(y[1]==="position"||y[1]==="rotation"||y[1]==="scale")x.onVariableUpdate();else if(y[1]==="geometry"){let b=x;x.component&&(b=x.component);let _=b.dataPatched;b.chooseGeoemtryCache(this).forceDelete(_.geometry),b.createGeometryDelayed(this.entityOpContext),b.onVariableUpdate(!0),b.invalidateDownstreamBooleanData(),b.instances.forEach(S=>{let A=S.dataPatched;S.chooseGeoemtryCache(this).forceDelete(A.geometry),S.createGeometryDelayed(this.entityOpContext),S.onVariableUpdate(!0),S.invalidateDownstreamBooleanData()})}else y[1]==="morphTargetInfluences"&&x.updateMorphInfluences(y[2],n)}}return this.requestRender(),!0}deleteVariable(r){this.variables[r]&&delete this.variables[r]}getVariable(r,a){var n,o,f;if(Array.isArray(r)){if(r[0]==="mouse")return((n=this.mouseProperty)==null?void 0:n[r[1]])??0;if(r[0]==="raycast")return((o=this.raycastProperty)==null?void 0:o[r[1]])??0;let y=this.entityOpContext.scene.find(r[0]);if(r[1]==="width"||r[1]==="height"||r[1]==="depth")return y.geometry.userData.parameters[r[1]];for(let x=1;x<r.length;x++)y=y[r[x]];return r[1]==="rotation"&&(y*=we.RAD2DEG),y}for(let y in this.variables){if(a===void 0)break;let x=this.variables[y],b=(f=x.locations)==null?void 0:f.findIndex(_=>Ar.equal(_,a));b!==void 0&&b!==-1&&x.locations.splice(b,1)}if(typeof r=="string"){let y=r,x=r;do{if(x=y,this.variables[y]===void 0)break;let b=this.variables[y].value;a&&this.variables[x]!==void 0&&this.variables[x].locations.push(a),y=b}while(typeof y=="string");return y}else return r}getVariables(){return this.variables}getVariablesNames(){return this.data.variables.map(r=>r.data.name)}getVariableByName(r){for(let a of this.data.variables)if(a.data.name===r)return{variable:a.data,id:a.id}}getDynamicVariablePlayState(r){var a;return(a=this.variables[r])==null?void 0:a.dynamicVariablePlayState}setDynamicVariablePlayState(r,a){this.variables[r]!==void 0&&(this.variables[r].dynamicVariablePlayState=a)}getDynamicVariableToggleIsForward(r){var a;return(a=this.variables[r])==null?void 0:a.dynamicVariableToggleIsForward}setDynamicVariableToggleIsForward(r,a){this.variables[r]!==void 0&&(this.variables[r].dynamicVariableToggleIsForward=a)}resetLib(r){for(let[a,n]of Object.entries(r.images))this.addImage(a,n.asset);for(let[a,n]of Object.entries(r.audios))this.addAudio(a,n.asset);for(let[a,n]of Object.entries(r.particles))this.addParticle(a,n.asset);for(let[a,n]of Object.entries(r.colors))this.addColor(a,n.asset);for(let[a,n]of Object.entries(r.fonts))this.addFont(a,n.asset);for(let[a,n]of Object.entries(r.materials))this.addMaterial(a,n.asset);for(let[a,n]of Object.entries(r.videos))this.addVideo(a,n.asset);for(let[a,n]of Object.entries(r.variables))this.addVariableHolder(a,n.asset)}updateLibByOp(r,a){r.path[0]==="images"?r.path.length===1&&r.type===1?this.addImage(r.id,r.data.asset):r.path.length===1&&r.type===2&&this.deleteImage(r.id):r.path[0]==="videos"?r.path.length===1&&r.type===1?this.addVideo(r.id,r.data.asset):r.path.length===1&&r.type===2&&this.deleteVideo(r.id):r.path[0]==="audios"?r.path.length===1&&r.type===1?this.addAudio(r.id,r.data.asset):r.path.length===1&&r.type===2&&this.deleteAudio(r.id):r.path[0]==="particles"?r.path.length===1&&r.type===1?this.addParticle(r.id,r.data.asset):r.path.length===1&&r.type===2&&this.deleteParticle(r.id):r.path[0]==="colors"?r.path.length===1&&r.type===1?this.addColor(r.id,r.data.asset):r.path.length===1&&r.type===2&&this.deleteColor(r.id):r.path[0]==="materials"?r.path.length===1&&r.type===1?this.addMaterial(r.id,r.data.asset):r.path.length===1&&r.type===2&&this.deleteMaterial(r.id):r.path[0]==="fonts"?r.path.length===1&&r.type===1?this.addFont(r.id,r.data.asset):r.path.length===1&&r.type===2&&this.deleteFont(r.id):r.path[0]==="variables"?r.path.length===1&&r.type===1?this.addVariableHolder(r.id,r.data.asset):r.path.length===1&&r.type===2&&this.deleteVariable(r.id):r.path[0]==="components"&&a.updateByLibOp(r,this)}updateByOp(r,a,n){var o;if(this.data=a,r.path[0]==="images")r.path.length===2&&r.type===0?r.props.data&&this.getImage(r.path[1]).updateSrc(r.props.data):r.path.length===1&&r.type===1?this.addImage(r.id,r.data):r.path.length===1&&r.type===2&&this.deleteImage(r.id);else if(r.path[0]==="videos")r.path.length===2&&r.type===0?r.props.data&&this.getVideo(r.path[1]).updateSrc(r.props.data):r.path.length===1&&r.type===1?this.addVideo(r.id,r.data):r.path.length===1&&r.type===2&&this.deleteVideo(r.id);else if(r.path[0]==="audios")r.path.length===2&&r.type===0?r.props.data&&this.addAudio(r.path[1],a.audios[r.path[1]]):r.path.length===1&&r.type===1?this.addAudio(r.id,r.data):r.path.length===1&&r.type===2&&this.deleteAudio(r.id);else if(r.path[0]==="particles")r.path.length===2&&r.type===0?r.props.data&&this.addParticle(r.path[1],a.particles[r.path[1]]):r.path.length===1&&r.type===1?this.addParticle(r.id,r.data):r.path.length===1&&r.type===2&&this.deleteParticle(r.id);else if(r.path[0]==="colors")r.path.length===2&&r.type===0?this.updateColor(r.path[1],r.props):r.path.length===1&&r.type===1?this.addColor(r.id,r.data):r.path.length===1&&r.type===2&&this.deleteColor(r.id);else if(r.path[0]==="materials")r.path.length===1&&r.type===1?this.addMaterial(r.id,r.data):r.path.length===1&&r.type===2?this.deleteMaterial(r.id):r.path.length>1&&this.getMaterial(r.path[1]).updateByOp(Vr.drop(r,2),a.materials[r.path[1]],{shared:this,scene:n});else if(r.path[0]==="fonts")r.path.length===2&&r.type===0?this.updateFont(r.path[1],r,n):r.path.length===1&&r.type===1?this.addFont(r.id,r.data):r.path.length===1&&r.type===2&&this.deleteFont(r.id);else if(r.path[0]==="variables")r.path.length===2&&r.type===0?"value"in r.props?this.updateVariable(r.path[1],r.props.value):"persistent"in r.props&&(this.variables[r.path[1]].persistent=r.props.persistent):r.path.length===1&&r.type===4?this.addVariableHolder(r.id,r.data):r.path.length===1&&r.type===5&&this.deleteVariable(r.id);else if(r.path[0]==="userAPIs"){if(r.path.length===1&&r.type===1)this.addUserAPI(r.id,r.data);else if(r.path.length===1&&r.type===2)this.deleteUserAPI(r.id);else if(typeof r.path[1]=="string"){let f=a.userAPIs[r.path[1]];if(f){let y=r.type===0&&r.props.debounce===void 0,x=this.getUserAPI(r.path[1]);x instanceof Um?x.update(f):x==null||x.update(f,this,y)}}}else if(r.path[0]==="userWebhooks"){if(r.path.length===1&&r.type===1)this.addUserWebhook(r.id,r.data);else if(r.path.length===1&&r.type===2)this.deleteUserWebhook(r.id);else if(typeof r.path[1]=="string"){let f=a.userWebhooks[r.path[1]];f&&((o=this.getUserWebhook(r.path[1]))==null||o.update(f))}}else r.path[0]==="lib"&&this.updateLibByOp(Vr.drop(r,1),n)}updateFont(r,a,n){if(a.props.url){let o=this.getFont(r),f={...this.data.fonts[r],url:a.props.url};o.update(f),o.loadingPromise.then(()=>this.requestRender()),n.updateFont(r,this)}}addUserAPI(r,a){var n,o;return this.userAPIs[r]?(this.userAPIs[r].update(a,this),!0):((n=this.openAIRealtime)==null?void 0:n.id)===r?(this.openAIRealtime.update(a),!0):((o=a.integration)==null?void 0:o.type)==="VoiceAssistant"?(this.openAIRealtime=new Um(a,r,this),!1):(this.userAPIs[r]=new Bd(r,a,this),!1)}getUserAPI(r){var a;return((a=this.openAIRealtime)==null?void 0:a.id)===r?this.openAIRealtime:this.userAPIs[r]}getUserAPIs(){return this.userAPIs}deleteUserAPI(r){let a=this.userAPIs[r];a&&(a.dispose(),delete this.userAPIs[r])}addUserWebhook(r,a){return this.userWebhooks[r]?(this.userWebhooks[r].update(a),!0):(this.userWebhooks[r]=new bx(r,a),!1)}getUserWebhook(r){return this.userWebhooks[r]}getUserWebhooks(){return this.userWebhooks}deleteUserWebhook(r){let a=this.userWebhooks[r];a&&(a.dispose(),delete this.userWebhooks[r])}get scene(){return this.entityOpContext.scene}};new iu(bn.emptyData());var bs=class extends yr{updateByPatchedOp(r,a,n){if(super.updateByPatchedOp(r,a,n),NI(r.path,["materials"])!==null&&r.type===0&&Array.isArray(this.material))for(let[o,f]of Object.entries(r.props)){let y=n.shared.material(f);this.material[Number(o)]=y}else if(Vt(r.path,["material"])&&this.material instanceof Vn)"material"in a&&typeof a.material!="string"&&this.material.updateByOp(Vr.drop(r,1),a.material,n);else if(Vt(r.path,["materials","*"])&&Array.isArray(this.material)){let o=r.path[1];if("materials"in a&&o<this.material.length){let f=a.materials[o];typeof f!="string"&&this.material[o].updateByOp(Vr.drop(r,2),f,n)}}}get needsAO(){return this.material!==void 0?(Array.isArray(this.material)?this.material[0]:this.material).hasAO:!1}updateState(r,a){var f,y;super.updateState(r,a),r.castShadow!==void 0&&(this.castShadow=r.castShadow),r.receiveShadow!==void 0&&(this.receiveShadow=r.receiveShadow);let n=this.dataPatched;this.dataPatched.type==="Mesh"&&this.dataPatched.geometry.shapeBlendNode&&this.layers.set(9);let o;if(this.dataPatched.type==="Mesh"&&this.dataPatched.geometry.type==="ShapeBlendGeometry"&&(o={resolutionLevel:this.dataPatched.geometry.resolutionLevel,useChildrenColors:this.dataPatched.geometry.useChildrenColors}),((f=r.geometry)==null?void 0:f.type)!=="NonParametricGeometry"&&"material"in r&&r.material!==void 0&&(this.disposeMaterial(),this.material=a.shared.material(r.material).getFlavor(n.flatShading,n.side,n.wireframe,o),a.scene.markNeedsUpdateRendererDirty()),(((y=r.geometry)==null?void 0:y.type)==="NonParametricGeometry"||"materials"in r)&&("materials"in r&&r.materials!==void 0?(this.disposeMaterial(),this.material=r.materials.map(x=>a.shared.material(x).getFlavor(n.flatShading,n.side,n.wireframe)),a.scene.markNeedsUpdateRendererDirty()):"material"in r&&r.material!==void 0&&(this.disposeMaterial(),this.material=[a.shared.material(r.material).getFlavor(n.flatShading,n.side,n.wireframe)],a.scene.markNeedsUpdateRendererDirty())),r.flatShading!==void 0||r.wireframe!==void 0||r.side!==void 0)if(Array.isArray(this.material))for(let x=0;x<this.material.length;x++)this.material[x]=this.material[x].getFlavor(n.flatShading,n.side,n.wireframe);else this.material=this.material.getFlavor(n.flatShading,n.side,n.wireframe,o)}disposeMaterial(){this.material&&bv(this.material).forEach(r=>{r instanceof Vn&&(r instanceof ru||r.nodeMaterialDispose())})}dispose(){this.disposeMaterial(),super.dispose()}},y3=new E,v3=new Qe,x3=new Qe,oK=new E,b3=new ue,jt=class extends bs{constructor(r,a,n){super(r,a),this.data=a,this.isSkinnedMesh=!1,this.localGeometry=void 0,a.bindMode&&a.bindMatrix&&(this.bindMode=a.bindMode,this.bindMatrix=new ue().fromArray(a.bindMatrix),this.bindMatrixInverse=new ue)}chooseGeoemtryCache(r){return r.geometryCache}markGeometryAsReachable(r){this.geometryCreateDeleyed instanceof Ce&&this.chooseGeoemtryCache(r).markAsReachable(this.dataPatched.geometry,this.geometryCreateDeleyed)}get geometry(){if(this.localGeometry!==void 0)return this.localGeometry;if(this.geometryCreateDeleyed instanceof iu){let r=this.geometryCreateDeleyed,a=this.chooseGeoemtryCache(r);this.geometryCreateDeleyed=a.get(this.dataPatched.geometry,r,this)}return this.geometryCreateDeleyed}set geometry(r){this.localGeometry=r}get is2DAndNoDepth(){let r=this.dataPatched.geometry;return im.is2DParametricMesh(r.type)&&r.depth===0}get is2DType(){return im.is2DParametricMesh(this.geometry.userData.type)}get isNonParametric(){return this.geometry.userData.type==="NonParametricGeometry"}updateByPatchedOp(r,a,n){super.updateByPatchedOp(r,a,n),Vt(r.path,["geometry"])&&this.updateByPatchedOpGeometry(Vr.drop(r,1),a.geometry,n)}removeInteractionGeometry(r){var a;(a=this.localGeometry)==null||a.dispose(),this.localGeometry=void 0}updateGeometryInteractions(r,a){var o;this.invalidateDownstreamBooleanData();let n=this.data.geometry.type;if(n==="NonParametricGeometry"||n==="SubdivGeometry"){let f=r;if(this.localGeometry===void 0){let S={...this.data.geometry,...f};this.localGeometry=Ba(S,a,this.data.flatShading,this)}let y,x,b;f.scaleBaked?[y,x,b]=f.scaleBaked:{width:y,height:x,depth:b}=f;let _=this.localGeometry.userData;_.sxPrev!==void 0&&Mm(this.localGeometry.attributes,y/_.sxPrev,x/_.syPrev,b/_.szPrev),_.sxPrev=y,_.syPrev=x,_.szPrev=b}else{let f={...this.data.geometry,...r};(o=this.localGeometry)==null||o.dispose(),this.localGeometry=Ba(f,a,this.data.flatShading,this)}}refreshAttachedClonersInteractions(){for(let r of this.attachedSurfaceCloners)r.update()}refreshAttachedCloners(r){for(let a of this.attachedSurfaceCloners)r.scene.addPendingUpdateCloner(a.object)}refreshAttachedPaths(r){for(let a of this.attachedPaths)r.scene.addPendingCommand(()=>a.updateShape())}createGeometryDelayed(r){this.geometryCreateDeleyed=r.shared,this.refreshAttachedCloners(r),this.refreshAttachedPaths(r)}updateByPatchedOpGeometry(r,a,n){var f;let o=!1;r.type===0&&r.path.length===0&&Object.keys(r.props).includes("scaleBaked")&&this.geometryCreateDeleyed instanceof oi&&this.chooseGeoemtryCache(n.shared).mutateIfUnique(this.geometryCreateDeleyed.data,a)===this.geometryCreateDeleyed&&(o=!0,this.geometryCreateDeleyed.mutateDirectlyScaleBaked(a,r.props.scaleBaked),this.refreshAttachedCloners(n),this.refreshAttachedPaths(n)),o||((f=n.scene)==null||f.markGeometryCacheDirty(),this.createGeometryDelayed(n)),this.resetBBoxNeedsUpdate(),this.invalidateDownstreamBooleanData()}updateGeometryOnStateUpdate(r,a){this.createGeometryDelayed(a)}updateState(r,a){r.geometry!==void 0&&this.updateGeometryOnStateUpdate(r.geometry,a);let n=r.morphTargetInfluences;if(n){this.updateMorphTargets(),this.geometry.morphTargetsRelative=!0;for(let{data:{name:o,value:f}}of n)this.updateMorphInfluences(o,a.shared.getVariable(f,[this.uuid,"morphTargetInfluences",o]))}super.updateState(r,a)}updateMorphInfluences(r,a){if(this.morphTargetDictionary===void 0)return;let n=this.morphTargetDictionary[r];n!==void 0&&(this.morphTargetInfluences[n]=a)}updateGeometryGroupsIfNeeded(){var r;Array.isArray(this.material)&&this.geometry.groups.length===0&&this.geometry.addGroup(0,Math.max(((r=this.geometry.getIndex())==null?void 0:r.count)??0,this.geometry.getAttribute("position").count),0)}updateEntityBoxSize(r,a){let n=this.geometry.userData.parameters;this.is2DType?r.set(0,0,n.depth*.5):this.isNonParametric?(r.setScalar(0),this.geometry.boundingSphere&&r.copy(this.geometry.boundingSphere.center),a.set(n.width,n.height,n.depth??0).multiplyScalar(.5)):n.centerOffset?r.fromArray(n.centerOffset):r.setScalar(0),a.set(n.width,n.height,n.depth??0).multiplyScalar(.5)}updateMatrixWorld(r){super.updateMatrixWorld(r),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"&&this.bindMatrixInverse.copy(this.bindMatrix).invert()}bind(r,a){this.skeleton=r,this.isSkinnedMesh=!0,a===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),a=this.matrixWorld),this.bindMatrix.copy(a),this.bindMatrixInverse.copy(a).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(r){let a=new Qe,n=this.geometry.attributes.skinWeight;for(let o=0,f=n.count;o<f;o++){a.fromBufferAttribute(n,o);let y=1/a.manhattanLength();y!==1/0?a.multiplyScalar(y):a.set(1,0,0,0),n.setXYZW(o,a.x,a.y,a.z,a.w)}}boneTransform(r,a){let n=this.skeleton;if(n===void 0)return;let o=this.geometry;v3.fromBufferAttribute(o.attributes.skinIndex,r),x3.fromBufferAttribute(o.attributes.skinWeight,r),y3.copy(a).applyMatrix4(this.bindMatrix),a.set(0,0,0);for(let f=0;f<4;f++){let y=x3.getComponent(f);if(y!==0){let x=v3.getComponent(f);b3.multiplyMatrices(n.bones[x].matrixWorld,n.boneInverses[x]),a.addScaledVector(oK.copy(y3).applyMatrix4(b3),y)}}return a.applyMatrix4(this.bindMatrixInverse)}};function aK(r){var x,b;if(r.geometry.attributes.extrudeNormal||!r.geometry.attributes.position||!r.geometry.attributes.normal)return;let a=new Map,n=r.geometry.attributes,o=n.position.array,f=n.normal.array,y=new Float32Array(o.length);for(let _=0;_<o.length;_+=3){let S=`${o[_]}_${o[_+1]}_${o[_+2]}`,A=new E(f[_],f[_+1],f[_+2]);a.has(S)?(x=a.get(S))==null||x.normals.push(A):a.set(S,{normals:[A],result:new E})}a.forEach((_,S)=>{for(let A of _.normals)_.result.add(A);_.result.divideScalar(_.normals.length)});for(let _=0;_<o.length;_+=3){let S=`${o[_]}_${o[_+1]}_${o[_+2]}`,A=(b=a.get(S))==null?void 0:b.result;A&&(y[_]=A.x,y[_+1]=A.y,y[_+2]=A.z)}r.geometry.setAttribute("extrudeNormal",new Te(y,3))}function lK(r){if(r.geometry.attributes.extrudeNormals||!r.geometry.attributes.position)return;let a=r.geometry.attributes.position.array,n=new Float32Array(a.length),o=new E;for(let f=0;f<a.length;f+=3)o.set(a[f],a[f+1],a[f+2]).normalize(),n[f]=o.x,n[f+1]=o.y,n[f+2]=o.z;r.geometry.setAttribute("extrudeNormal",new Te(n,3))}function lf(r){if(Array.isArray(r.material)){for(let a of r.material)if(a.getLayersOfType("outline").length===0)return}else if(!(r.material instanceof Vn)||r.material.getLayersOfType("outline").length===0)return;r instanceof jt&&r.is2DAndNoDepth?lK(r):aK(r)}function cf(r){if(!r.geometry.attributes.position)return;let a=r.geometry.attributes.position.array,n=new Float32Array(a.length),o=parseInt(r.uuid.replace(/\D/g,"")),f=[we.seededRandom(o),we.seededRandom(o+1e4),we.seededRandom(o+2e4)];for(let y=0;y<a.length;y++)n[y]=f[y%3];r.geometry.setAttribute("randomColor",new Ge(n,3))}var zo=new Xt,zm=new E,Js=class extends jt{constructor(r,a,n){super(r,a,n),this.data=a,this.hiddenMatrixOld=new ue,this.smoothShading=!0,this.skipReactionUpdate=!1}chooseGeoemtryCache(r){return this.dataPatched.flatShading?r.geometryCache:r.geometryCache2}get subdivPointerNew(){return this.localGeometry!==void 0?this.subdivPointer:this.geometry.ensureSubdivPointer()}get originalGeometryNew(){return this.localGeometry!==void 0?this.originalGeometry:this.geometry.originalGeometry}get phongAngle(){return this.data.geometry.phongAngle??45}updateEntityBoxSize(r,a){let n=this.geometry.userData.parameters;r.copy(this.originalGeometryNew.boundingSphere.center),a.set(n.width,n.height,n.depth??0).multiplyScalar(.5)}createGeometryByControls(r){var y,x,b;if(this.skipReactionUpdate===!0)return;let a=(y=this.localGeometry)==null?void 0:y.uuid,{originalGeometry:n,subdividedGeometry:o,subdivPointer:f}=oi.build(r,this.subdivPointer,this.smoothShading,this.hasNonUniformScale?this.shearScale:void 0);this.subdivPointer=f,n!==void 0&&((x=this.originalGeometry)==null||x.dispose(),this.originalGeometry=n),o!==void 0&&((b=this.subdividedGeometry)==null||b.dispose(),this.subdividedGeometry=o??void 0),this.localGeometry=this.subdividedGeometry??this.originalGeometry,lf(this),cf(this),this.calcBoundingBox(),a&&(this.localGeometry.uuid=a)}updateState(r,a){if(super.updateState(r,a),r.flatShading!==void 0){let n=this.material;this.material=Array.isArray(n)?n.map(o=>o.getFlavor(!1,o.side,o.wireframe)):n.getFlavor(!1,n.side,n.wireframe),this.smoothShading=!r.flatShading,this.createGeometryDelayed(a)}}updateMesh(r=!1){oi.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1,this.originalGeometry,r&&this.hasNonUniformScale?this.shearScaleInv:void 0),this.subdividedGeometry&&oi.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1,this.subdividedGeometry,r&&this.hasNonUniformScale?this.shearScaleInv:void 0)}updateTopology(){this.originalGeometry.dispose(),this.originalGeometry=oi.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1),this.subdividedGeometry&&(this.subdividedGeometry.dispose(),this.subdividedGeometry=oi.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1)),this.localGeometry=this.subdividedGeometry??this.originalGeometry}raycast(r,a){let n=this.localGeometry;this.localGeometry=this.originalGeometryNew,yr.prototype.raycast.call(this,r,a),this.localGeometry=n}activateSVDCompensation(){!this.hasNonUniformScale||(this.matrix.copy(this.matrixWorldRigid),this.hiddenMatrixOld.copy(this.hiddenMatrix),this.hiddenMatrix.copy(this.parent.matrixWorld).invert())}deactivateSVDCompensation(){!this.hasNonUniformScale||(this.updateMatrix(),this.hasNonUniformScale=void 0,this.hiddenMatrix.copy(this.hiddenMatrixOld))}calcBoundingBox(){let r=this.originalGeometry;r.boundingSphere===null&&(r.boundingSphere=new Nr,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=r.boundingSphere));let a=r.attributes.position,n=r.boundingSphere.center;zo.setFromBufferAttribute(a),zo.getCenter(n),r.boundingSphere.radius=n.distanceTo(zo.max),isNaN(r.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),zo.getSize(zm),this.hasNonUniformScale&&zm.divide(this.scale);let o={width:zm.x,height:zm.y,depth:zm.z};return this.geometry.userData.parameters=o,o}updateBoundingSphere(r){let a=this.originalGeometry;zo.min.set(r[0],r[2],r[4]),zo.max.set(r[1],r[3],r[5]),this.hasNonUniformScale&&(zo.min.applyMatrix4(this.shearScaleInv),zo.max.applyMatrix4(this.shearScaleInv)),a.boundingSphere===null&&(a.boundingSphere=new Nr);let n=a.boundingSphere.center;zo.getCenter(n),a.boundingSphere.radius=n.distanceTo(zo.max)}freeSubdivPointer(){var r,a;this.subdivPointer&&(oi.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0),this.localGeometry=void 0,(r=this.originalGeometry)==null||r.dispose(),(a=this.subdividedGeometry)==null||a.dispose()}dispose(){super.dispose(),this.freeSubdivPointer()}updateByPatchedOpGeometry(r,a,n){super.updateByPatchedOpGeometry(r,a,n),this.localGeometry&&this.createGeometryByControls(a)}},w3=-1,cK=1,A3={x:[1,0,0],"-x":[-1,0,0],y:[0,1,0],"-y":[0,-1,0],z:[0,0,1],"-z":[0,0,-1]},E3={polygon_center:0,edge:1,vertex:2},km=(r,a)=>(n,o)=>!a||n===0||r===0?0:r*o/100,xt=(r,a)=>{let n=Math.abs(a),o=n*-1;return(r-w3)*(n-o)/(cK-w3)+o},uK=new E,Mx=new E,hK=new E,dK=new E;function uf(r,a){let n=hK.fromArray(r),o=dK.fromArray(a);Mx.copy(o).sub(n);let f=Mx.length();return Mx.normalize().multiplyScalar(f*.5),uK.copy(n).add(Mx).toArray()}var Ss=new _r,Cx=new E,Px=new E,nu=new E;function T3(r){let a=[];for(let n=0;n<=r.index.count;n++)if(Cx.fromArray(r.index.array,n*3),Ss.setFromAttributeAndIndices(r.attributes.position,Cx.x,Cx.y,Cx.z),Ss.getNormal(Px),Ss.getMidpoint(nu),!(isNaN(nu.x)||isNaN(nu.y)||isNaN(nu.z))){let{a:o,b:f,c:y}=Ss,x=o.toArray(),b=f.toArray(),_=y.toArray(),S=o.distanceTo(f),A=f.distanceTo(y),C=y.distanceTo(o),P=uf(x,b),T=uf(b,_),M=uf(_,x),O=[S,A,C],I=Math.max(...O),D=O.filter(L=>Math.round(L)===Math.round(I)).length>1,z=[],k=Ss.getMidpoint(nu).toArray();I===S&&!D&&(z=[T,M,M],k=P),I===A&&!D&&(z=[P,M,M],k=T),I===C&&!D&&(z=[P,T,T],k=M),D&&(z=[P,T,M]),a.push({vertices:[x,b,_],faceCenters:z,midpoint:k,norm:Ss.getNormal(Px).toArray()})}return a}function M3(r){let a=[],{position:n}=r.attributes;for(let o=0;o<n.count;o++){Ss.setFromAttributeAndIndices(n,o*3,o*3+1,o*3+2),Ss.getNormal(Px),Ss.getMidpoint(nu);let f=Ss.a.toArray(),y=Ss.b.toArray(),x=Ss.c.toArray();a.push({vertices:[f,y,x],faceCenters:[uf(f,y),uf(y,x),uf(x,f)],midpoint:nu.toArray(),norm:Px.toArray()})}return a}var fK=4,pK=.5,HE=r=>.5*(1-Math.cos(r*Math.PI)),WE=class{constructor(){this.perlin=new Array(4096)}noise(r,a=0,n=0){if(this.perlin==null){this.perlin=new Array(4096);for(let I=0;I<4096;I++)this.perlin[I]=Math.random()}r<0&&(r=-r),a<0&&(a=-a),n<0&&(n=-n);let o=Math.floor(r),f=Math.floor(a),y=Math.floor(n),x=r-o,b=a-f,_=n-y,S,A,C=0,P=.5,T,M,O;for(let I=0;I<fK;I++){let D=o+(f<<4)+(y<<8);S=HE(x),A=HE(b),T=this.perlin[D&4095],T+=S*(this.perlin[D+1&4095]-T),M=this.perlin[D+16&4095],M+=S*(this.perlin[D+16+1&4095]-M),T+=A*(M-T),D+=256,M=this.perlin[D&4095],M+=S*(this.perlin[D+1&4095]-M),O=this.perlin[D+16&4095],O+=S*(this.perlin[D+16+1&4095]-O),M+=A*(O-M),T+=HE(_)*(M-T),C+=T*P,P*=pK,o<<=1,x*=2,f<<=1,b*=2,y<<=1,_*=2,x>=1&&(o++,x--),b>=1&&(f++,b--),_>=1&&(y++,_--)}return C}noiseSeed(r){let a=(()=>{let n,o;return{setSeed(f){o=n=(f??Math.random()*4294967296)>>>0},getSeed(){return n},rand(){return o=(1664525*o+1013904223)%4294967296,o/4294967296}}})();a.setSeed(r),this.perlin=new Array(4096);for(let n=0;n<4096;n++)this.perlin[n]=a.rand()}},C3=WE,P3=new E,_3=new ue,I3=new Ns,Kl=class extends jt{constructor(r,a,n){super(r,a,n),this.data=a}get textGeometry(){return this.geometry}get charWidths(){return this.textGeometry.charWidths}get charCoords(){return this.textGeometry.charCoords}get wrappedText(){return this.textGeometry.wrappedText}get font(){return this.textGeometry.font}get initialOffsetY(){var a;let r=this.dataPatched;return((a=this.font)==null?void 0:a.getLineInitialOffsetY(this.lineHeight,this.wrappedText.length,r.geometry.height,this.fontScale,r.geometry.verticalAlign))??0}get fontScale(){let r=this.dataPatched;return this.font?r.geometry.fontSize/this.font.unitsPerEm:1}get AD(){return Math.abs(this.ascender-this.descender)}get ascender(){var r;return(((r=this.font)==null?void 0:r.ascender)??1)*this.fontScale}get descender(){var r;return(((r=this.font)==null?void 0:r.descender)??1)*this.fontScale}get lineHeight(){let r=this.dataPatched;return r.geometry.fontSize*r.geometry.lineHeight}raycast(r,a){let{matrixWorld:n}=this;if(!(isNaN(r.ray.origin.x)||this.scale.x===0||this.scale.y===0||this.scale.z===0)&&(_3.copy(n).invert(),I3.copy(r.ray).applyMatrix4(_3),I3.intersectBox(this.singleBBox,P3))){let o=P3.applyMatrix4(n),f=r.ray.origin.distanceTo(o);a.push({distance:f,point:o.clone(),object:this})}}},Tn=1e-4,ko,R3,L3,B3,D3=new E,O3=new E;Z0.then(r=>{ko=r,R3=[ko.get_face_center,ko.get_edge_midpoint,ko.get_vertex_position],L3=[ko.get_face_normal,ko.get_edge_normal,ko.get_vertex_normal],B3=[ko.face_count,ko.edge_count,ko.vertex_count]});var mK=new ue,gK=new ue,Ql=new E,_x=new E,Gm=new E,XE=new E,yK=new E,vK=new E,YE=class{constructor(r,a){this.data=r,this.is3D=a,this.perlin=new C3,r.noiseType==="perlin"?(this.perlin.noiseSeed(r.seed),a?this.noise=(n,o,f)=>this.perlin.noise(n,o,f):this.noise=n=>this.perlin.noise(n)):a?this.noise=pO((0,Ix.default)(r.seed)):this.noise=fO((0,Ix.default)(r.seed))}},bi=class extends Sd(_t){constructor(r,a){super(),this.parameters=a,this.objectForSample=void 0,this._pendingMediaLoad=!1,this.random=null,this.object=r}resetOnMove(){this.removeFromParent(),this.parent=null}expandClones(r){if(this.parent===null)this.updateState(this.parameters,r);else for(let a of this.children)a instanceof Dr&&a.expand()}invalidateTransform(r){this.matrixWorldNeedsUpdate=!0,this.traverse(a=>{a instanceof Dr&&a.object===r&&(a.matrixWorldNeedsUpdate=!0)})}onObjUpdateMatrix(){this.parameters.type!=="toObject"&&(this.matrixWorldNeedsUpdate=!0)}update(){switch(this._updateCount(),this.parameters.type){case"radial":this._updateRadial(this.parameters);break;case"linear":this._updateLinear(this.parameters);break;case"grid":this._updateGrid(this.parameters);break;case"toObject":this._updateToObject(this.parameters)}for(let r of this.children)r.updateMatrix(),r.hasNonUniformScale&&(r.updateMatrixWorld(),r.updateMatrixWorldSVD())}_updateCount(r){let a;if(r!==void 0?a=r:a=this.parameters.type==="grid"?Math.round(this.parameters.grid.count[0])*Math.round(this.parameters.grid.count[1])*Math.round(this.parameters.grid.count[2]):this.parameters.count,this.parameters.type==="toObject"){if(!this.parameters.toObject.object)a=0;else if(r===void 0&&this.parameters.toObject.spreadType!=="random")return}if(this.parameters.type==="toObject"&&this.objectForSample){let n=this.children;if(n.length===a)return;if(n.length<a)for(let o=0,f=a-n.length;o<f;++o){let y=new Dr(this.object);y.expand(),this.add(y)}else for(let o=0,f=n.length-a;o<f;++o)this.remove(n[o])}else{if(this.children.length===a)return;if(this.children.length<a)for(let n=0,o=a-this.children.length;n<o;++n){let f=new Dr(this.object);f.expand(),this.add(f)}else for(let n=0,o=this.children.length-a;n<o;++n)this.remove(this.children[n])}}getRandom(r,a=!1){return(this.random===null||this.random.data.seed!==r.seed||this.random.is3D!==a)&&(this.random=new YE(r,a)),this.random}_updateRadial(r){let a=r.radial,n=a.start*we.DEG2RAD,o=a.end*we.DEG2RAD,f=n-o,y=new or(a.rotation[0],a.rotation[1],a.rotation[2]),x;switch(a.axis){case"z":x=new E(0,0,1);break;case"y":x=new E(0,1,0);break;default:case"x":x=new E(1,0,0);break}let b=r.randomnessObject??Po.defaultData([1,1,1]).randomnessObject,_=this.getRandom(b),S=km(b.strength,this.parameters.randomness);for(let[A,C]of this.children.entries()){let P=A*(b.freqScale/10)+b.movement,T=_.noise(P,P,P),M=A+1;C.scale.x=a.scale[0]+S(M,xt(T,b.scale[0]))||Tn,C.scale.y=a.scale[1]+S(M,xt(T,b.scale[1]))||Tn,C.scale.z=a.scale[2]+S(M,xt(T,b.scale[2]))||Tn,C.position.setScalar(0);let O=f/r.count*A-n;switch(a.axis){case"x":C.rotation.set(0,O,0);break;case"y":C.rotation.set(0,0,O);break;case"z":C.rotation.set(O,0,0);break}C.translateOnAxis(x,a.radius),C.position.x+=a.position[0]+S(M,xt(T,b.position[0])),C.position.y+=a.position[1]+S(M,xt(T,b.position[1])),C.position.z+=a.position[2]+S(M,xt(T,b.position[2]));let I=S(M,xt(T,b.rotation[0])),D=S(M,xt(T,b.rotation[1])),z=S(M,xt(T,b.rotation[2]));a.alignment===!0?(C.rotation.x+=y.x+I,C.rotation.y+=y.y+D,C.rotation.z+=y.z+z):C.rotation.set(y.x+I,y.y+D,y.z+z)}}_updateLinear(r){if(r.type!=="linear")throw new Error;let a=r.linear,n=new or(a.rotation[0],a.rotation[1],a.rotation[2]),o=r.randomnessObject??Po.defaultData([1,1,1]).randomnessObject,f=this.getRandom(o),y=km(o.strength,this.parameters.randomness);for(let[x,b]of this.children.entries()){let _=x*(o.freqScale/10)+o.movement,S=f.noise(_,_,_),A=x+1,C=y(A,xt(S,o.rotation[0])),P=y(A,xt(S,o.rotation[1])),T=y(A,xt(S,o.rotation[2]));b.scale.x=1+(a.scale[0]-1)*x+y(A,xt(S,o.scale[0]))||Tn,b.scale.y=1+(a.scale[1]-1)*x+y(A,xt(S,o.scale[1]))||Tn,b.scale.z=1+(a.scale[2]-1)*x+y(A,xt(S,o.scale[2]))||Tn,b.rotation.x=n.x*x+C,b.rotation.y=n.y*x+P,b.rotation.z=n.z*x+T,b.position.x=a.position[0]*x+y(A,xt(S,o.position[0])),b.position.y=a.position[1]*x+y(A,xt(S,o.position[1])),b.position.z=a.position[2]*x+y(A,xt(S,o.position[2]))}}_updateGrid(r){let a=0,n=r.grid,o=r.randomnessObject??Po.defaultData([1,1,1]).randomnessObject,f=this.getRandom(o,!0),y=km(o.strength,this.parameters.randomness);if(n.useCenter===!0){let x={x:n.count[0]%2===0?2:1,y:n.count[1]%2===0?2:1,z:n.count[2]%2===0?2:1},b=new E(n.size[0]*(n.count[0]-x.x)*.5,n.size[1]*(n.count[1]-x.y)*.5,n.size[2]*(n.count[2]-x.z)*.5);for(let _=0;_<n.count[0];_++)for(let S=0;S<n.count[1];S++)for(let A=0;A<n.count[2];A++){let C=f.noise((_+1)*(o.freqScale/10)+o.movement,(S+1)*(o.freqScale/10)+o.movement,(A+1)*(o.freqScale/10)+o.movement),P=this.children[a++];P.scale.x=1+y(a,xt(C,o.scale[0]))||Tn,P.scale.y=1+y(a,xt(C,o.scale[1]))||Tn,P.scale.z=1+y(a,xt(C,o.scale[2]))||Tn;let T=y(a,xt(C,o.rotation[0])),M=y(a,xt(C,o.rotation[1])),O=y(a,xt(C,o.rotation[2]));P.rotation.set(T,M,O),P.position.x=n.size[0]*_-b.x+y(a,xt(C,o.position[0])),P.position.y=n.size[1]*S-b.y+y(a,xt(C,o.position[1])),P.position.z=n.size[2]*A-b.z+y(a,xt(C,o.position[2]))}}else for(let x=0;x<n.count[0];x++)for(let b=0;b<n.count[1];b++)for(let _=0;_<n.count[2];_++){let S=f.noise((x+1)*(o.freqScale/10)+o.movement,(b+1)*(o.freqScale/10)+o.movement,(_+1)*(o.freqScale/10)+o.movement),A=this.children[a++];A.scale.x=1+y(a,xt(S,o.scale[0]))||Tn,A.scale.y=1+y(a,xt(S,o.scale[1]))||Tn,A.scale.z=1+y(a,xt(S,o.scale[2]))||Tn;let C=y(a,xt(S,o.rotation[0])),P=y(a,xt(S,o.rotation[1])),T=y(a,xt(S,o.rotation[2]));A.rotation.set(C,P,T),A.position.x=n.size[0]*x+y(a,xt(S,o.position[0])),A.position.y=-n.size[1]*b+y(a,xt(S,o.position[1])),A.position.z=-n.size[2]*_+y(a,xt(S,o.position[2]))}}_updateToObject(r){var A;if(r.type!=="toObject")throw new Error;let{toObject:a}=r,n=new or(a.rotation[0],a.rotation[1],a.rotation[2]),o=r.randomnessObject??Po.defaultData([1,1,1]).randomnessObject,f=this.getRandom(o),y=km(o.strength,this.parameters.randomness);if(!a.object){for(let[,C]of this.children.entries())C.position.set(0,0,0),C.scale.setScalar(1),C.rotation.set(0,0,0);this.objectForSample=void 0;return}if(!this.objectForSample)return;if(this.objectForSample instanceof Kl)if(!((A=this.objectForSample.font)!=null&&A.isLoaded)||this.objectForSample.geometry.attributes.position===void 0){this._pendingMediaLoad=!0;return}else this._pendingMediaLoad=!1;if(this.objectForSample.geometry===void 0&&this.objectForSample.isAncestorOf(this.object.uuid)){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) seem to be a child/descendant of the object it's being cloned to. Please re-parent it so that they are siblings instead.`);return}let x=this.getSubdivData();if(x.length>0){let C=Math.round(x.length*a.count/100);this._updateCount(C)}else{let C=this.objectForSample.geometry.getAttribute("position");if(!C||isNaN(C.count)||C.count===0){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) cannot be cloned on the surface of "${this.objectForSample.name}" (${this.objectForSample.uuid}) because the latter does not have a valid geometry.`);return}}this.objectForSample.updateMatrixWorld();let b=new R0(this.objectForSample).build(),_=A3[a.axis],S=this.children;b.setRandomGenerator((0,Ix.default)(this.object.uuid+a.seed));for(let[C,P]of S.entries()){let T=C*(o.freqScale/10)+o.movement,M=f.noise(T,T,T),O=C+1,I=y(O,xt(M,o.rotation[0])),D=y(O,xt(M,o.rotation[1])),z=y(O,xt(M,o.rotation[2]));a.spreadType==="random"?b.sample(Gm,XE):(x.length&&(Gm.fromArray(x[C].pos),XE.fromArray(x[C].norm)),this.objectForSample instanceof Js&&Gm.applyMatrix4(mK.copy(this.objectForSample.matrixWorld).invert())),Gm.applyMatrix4(this.object.hiddenMatrix.clone().invert()),P.position.copy(Gm),Ql.fromArray(_);let k=a.align==="normal"?XE:this.object.getWorldDirection(vK),L=_x.fromArray(a.position);_x.x+=y(O,xt(M,o.position[0])),_x.y+=y(O,xt(M,o.position[1])),_x.z+=y(O,xt(M,o.position[2]));let R=Math.acos(k.dot(Ql)),F=yK.crossVectors(Ql,k).normalize(),B=gK.makeRotationAxis(F,R),N=k.clone().cross(this.object.up).normalize(),j=N.clone().cross(k).normalize(),G=new ue().makeBasis(N,k,j),Y=new E(Ql.y,Ql.z,Ql.x).normalize(),X=Y.clone().cross(Ql).normalize(),$=new ue().makeBasis(Y,Ql,X).invert(),te=new ue().multiplyMatrices(G,$);P.rotation.setFromRotationMatrix(te),L.applyMatrix4(B),P.position.add(L),P.rotation.x=P.rotation.x+n.x+I,P.rotation.y=P.rotation.y+n.y+D,P.rotation.z=P.rotation.z+n.z+z,P.scale.setScalar(1),P.scale.x=P.scale.x+a.scale[0]+y(O,xt(M,o.scale[0]))||Tn,P.scale.y=P.scale.y+a.scale[1]+y(O,xt(M,o.scale[1]))||Tn,P.scale.z=P.scale.z+a.scale[2]+y(O,xt(M,o.scale[2]))||Tn,P.scale.multiply(this.object.scale),P.hiddenMatrix=this.object.hiddenMatrix}}getSubdivData(){if(!this.objectForSample)return[];let r=this.parameters.toObject.spreadType,a=new Map,n=(f,y)=>{let x=Math.round(f[0]*1e4)+"_"+Math.round(f[1]*1e4)+"_"+Math.round(f[2]*1e4),b=a.get(x);b?(b.pos[0]+=f[0],b.pos[1]+=f[1],b.pos[2]+=f[2],b.norm[0]+=y[0],b.norm[1]+=y[1],b.norm[2]+=y[2],b.count+=1):a.set(x,{pos:[...f],norm:[...y],count:1})};if(r==="random")return[];if(this.objectForSample instanceof Js){let f=this.objectForSample,y=E3[r],x=B3[y],b=R3[y],_=L3[y],S=x(f.subdivPointerNew);for(let A=0;A<=S-1;A++){let C=b(f.subdivPointerNew,A),P=_(f.subdivPointerNew,A);D3.fromArray(C).applyMatrix4(f.matrixWorld),O3.fromArray(P),n(D3.toArray(),O3.toArray())}}else(this.objectForSample.geometry.index?T3(this.objectForSample.geometry):M3(this.objectForSample.geometry)).forEach((f,y)=>{r==="polygon_center"&&n(f.midpoint,f.norm),r==="vertex"&&(n(f.vertices[0],f.norm),n(f.vertices[1],f.norm),n(f.vertices[2],f.norm)),r==="edge"&&(n(f.faceCenters[0],f.norm),n(f.faceCenters[1],f.norm),n(f.faceCenters[2],f.norm))});let o=Array.from(a.values());for(let f of o)f.pos[0]/=f.count,f.pos[1]/=f.count,f.pos[2]/=f.count,f.norm[0]/=f.count,f.norm[1]/=f.count,f.norm[2]/=f.count;return o}updateState(r,a){var n;if(this.parameters=xa(r),this.parameters.type!=="toObject")(this.parent===null||this.parent!==this.object)&&(this.removeFromParent(),(n=this.object.parent)==null||n.add(this),this.matrix=this.object.matrix,this.hiddenMatrix=this.object.hiddenMatrix,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1);else if(this.parent===null||this.parent.uuid!==this.parameters.toObject.object){this.removeFromParent();let o=a.find(this.parameters.toObject.object);o instanceof yr?this.objectForSample=o:this.objectForSample=void 0,this.matrix=new ue,this.hiddenMatrix=new ue,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1,o&&o.add(this)}this.update()}get pendingMediaLoad(){return this._pendingMediaLoad}},Go=r=>{var a;return a=class extends r{},a.geometryHelper=new yi(30,30,30),a},Dx=new Ns,KE=new Nr,N3=new ue,jo=(r,a,n,o,f=!1,y=r)=>{let x=a,b=y.matrixWorld;if(x.boundingSphere===null&&x.computeBoundingSphere(),KE.copy(x.boundingSphere),KE.applyMatrix4(b),n.ray.intersectsSphere(KE)===!1||(N3.copy(b).invert(),Dx.copy(n.ray).applyMatrix4(N3),x.boundingBox!==null&&Dx.intersectsBox(x.boundingBox)===!1))return;let _,S,A,C,P=x.index,T=x.attributes.position,M=x.drawRange,O,I;if(f===!1){let z=Math.max(0,M.start),k=Math.min(P.count,M.start+M.count);for(O=z,I=k;O<I;O+=3)if(S=P.getX(O),A=P.getX(O+1),C=P.getX(O+2),_=D(r,n,Dx,T,S,A,C),_){_.faceIndex=Math.floor(O/3),o.push(_);return}}else{let z=x.attributes.position,k=new E,L=new E,R=new E,F=new E,B=2,N=1/((y.scale.x+y.scale.y+y.scale.z)/3),j=N*N,G=Math.max(0,M.start),Y=Math.min(z.count,M.start+M.count);for(let X=G,$=Y-1;X<$;X+=B){if(k.fromBufferAttribute(z,X),L.fromBufferAttribute(z,X+1),Dx.distanceSqToSegment(k,L,F,R)>j)continue;F.applyMatrix4(y.matrixWorld);let te=n.ray.origin.distanceTo(F);te<n.near||te>n.far||o.push({distance:te,point:R.clone().applyMatrix4(y.matrixWorld),object:r})}}function D(z,k,L,R,F,B,N){let j=new E,G=new E,Y=new E,X=new E,$=new E;if(j.fromBufferAttribute(R,F),G.fromBufferAttribute(R,B),Y.fromBufferAttribute(R,N),L.intersectTriangle(j,G,Y,!1,X)===null)return null;$.copy(X),$.applyMatrix4(z.matrixWorld);let te=k.ray.origin.distanceTo($);return te<k.near||te>k.far?null:{faceIndex:1,distance:te,point:$.clone(),object:z}}},Ox=new E,ws=new yn,QE=class extends ul{constructor(r){let a=new Ce,n=new as({color:16777215,vertexColors:!0,toneMapped:!1}),o=[],f=[],y={},x=new qe(15711266),b=new qe(15711266),_=new qe(2857471);S("n1","n2",x),S("n2","n4",x),S("n4","n3",x),S("n3","n1",x),S("f1","f2",x),S("f2","f4",x),S("f4","f3",x),S("f3","f1",x),S("n1","f1",x),S("n2","f2",x),S("n3","f3",x),S("n4","f4",x),S("p","n1",b),S("p","n2",b),S("p","n3",b),S("p","n4",b),S("u1","u2",_),S("u2","u3",_),S("u3","u1",_);function S(C,P,T){A(C,T),A(P,T)}function A(C,P){o.push(0,0,0),f.push(P.r,P.g,P.b),y[C]===void 0&&(y[C]=[]),y[C].push(o.length/3-1)}a.setAttribute("position",new Te(o,3)),a.setAttribute("color",new Te(f,3)),super(a,n),this.type="CameraHelper",this.camera=r,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=r.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=y,this.update()}update(){let r=this.geometry,a=this.pointMap;ws.projectionMatrixInverse.elements=[.5112609807824982,-0,-0,-0,-0,.41421356237309503,-0,-0,-0,-0,-0,-.099999,-0,-0,-1.0000000000000002,.100001];let n=1,o=1,f=.8;$s("n1",a,r,ws,-1,-1,f),$s("n2",a,r,ws,n,-1,f),$s("n3",a,r,ws,-1,o,f),$s("n4",a,r,ws,n,o,f);let y=f;$s("f1",a,r,ws,-1,-1,y),$s("f2",a,r,ws,n,-1,y),$s("f3",a,r,ws,-1,o,y),$s("f4",a,r,ws,n,o,y);let x=y,b=.5;$s("u1",a,r,ws,n*.7*b,o*1.1,x),$s("u2",a,r,ws,-1*.7*b,o*1.1,x),$s("u3",a,r,ws,0,o*(1.1+.9*b),x),r.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function $s(r,a,n,o,f,y,x){Ox.set(f,y,x).unproject(o);let b=a[r];if(b!==void 0){let _=n.getAttribute("position");for(let S=0,A=b.length;S<A;S++)_.setXYZ(b[S],Ox.x,Ox.y,Ox.z)}}var Rx=class extends Go(QE){constructor(r){super(r),this.object=r,this.object=r,this.name=`CombinedCameraHelper: ${r.uuid}`}updateMatrixWorld(r){super.updateMatrixWorld(r),this.updateTarget()}updateTarget(){let r=this.object.getTarget();this.updateWorldMatrix(!0,!1),this.worldToLocal(r)}raycast(r,a){jo(this.object,this.geometry,r,a,!0)}},Lx;(r=>r.is=a=>"objectHelper"in a)(Lx||(Lx={}));var As=(r,a)=>class extends Ad(r){constructor(){super(...arguments),this.objectHelper=new a(this),this.gizmos={}}get geometryHelper(){return a.geometryHelper}raycast(n,o){this.objectHelper.raycast(n,o)}showGizmos(){for(let n in this.gizmos){let o=this.gizmos[n];o instanceof vl&&(o.visible=!0)}}updateEntityBoxSize(n,o){this.objectHelper.visible&&this.geometryHelper instanceof yi?(n.setScalar(0),o.set(this.geometryHelper.parameters.width,this.geometryHelper.parameters.height,this.geometryHelper.parameters.height).multiplyScalar(.5)):super.updateEntityBoxSize(n,o)}hideGizmos(){for(let n in this.gizmos){let o=this.gizmos[n];o instanceof vl&&(o.visible=!1)}}},Bx=790,hf=new E,ZE=new E,JE=new Ke,$E=new E,jm=new E,eT=new E,Er=class extends As(yn,Rx){constructor(r="",a={...kc.defaultData,name:""}){super(),this._cameraType="OrthographicCamera",this.targetOffset=Dl.DefaultTargetOffset,this.isUpVectorFlipped=!1,this.angleOffsetFromUp=0,this.wasMovedByUser=!1,this.wasMovedBySwitchCameraAction=!1,this.super_Entity(r,a),this.previousProjectionMatrix=new ue,this.matrixAutoUpdate=!0,this.width=window.innerWidth,this.height=window.innerHeight;let n=this.width,o=this.height;this.orthoCamera=new ll(n*-.5,n*.5,o*.5,o*-.5,-5e4,1e4),this.perspCamera=new ti(45,n/o,50,1e4),this.left=this.orthoCamera.left,this.right=this.orthoCamera.right,this.top=this.orthoCamera.top,this.bottom=this.orthoCamera.bottom,this.far=this.orthoCamera.far,this.view=this.orthoCamera.view,this.aspect=this.perspCamera.aspect,this.focus=this.perspCamera.focus,this.filmGauge=this.perspCamera.filmGauge,this.filmOffset=this.perspCamera.filmOffset,this.objectHelper.update()}get isPerspectiveCamera(){return this.cameraType==="PerspectiveCamera"}get isOrthographicCamera(){return!this.isPerspectiveCamera}get cameraType(){return this._cameraType}set fov(r){this.perspCamera.fov=r}get fov(){return this.perspCamera.fov}setNear(r,a){r==="PerspectiveCamera"?this.perspCamera.near=a:this.orthoCamera.near=a}setZoom(r,a){a>=0&&(r==="PerspectiveCamera"?this.perspCamera.zoom=a:this.orthoCamera.zoom=a)}set cameraType(r){r==="PerspectiveCamera"?this.toPerspective():r==="OrthographicCamera"&&this.toOrthographic()}get near(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.near:this.orthoCamera.near}set near(r){this._cameraType==="PerspectiveCamera"?this.perspCamera.near=r:this.orthoCamera.near=r}get zoom(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom:this.orthoCamera.zoom}set zoom(r){r>=0&&(this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom=r:this.orthoCamera.zoom=r)}lookAt(r,a,n){typeof r=="number"&&(r=new E(r,a,n)),super.lookAt(r),this.getWorldPosition(hf),this.targetOffset=hf.distanceTo(r)}getTarget(r=new E){return this.getWorldDirection(ZE),this.getWorldPosition(hf),ZE.multiplyScalar(this.targetOffset),r.copy(hf).add(ZE),r}getDistanceToTarget(){let r=this.getTarget();return this.getWorldPosition(hf),hf.distanceTo(r)}updateUp(){this.getWorldQuaternion(JE),$E.set(0,0,1).applyQuaternion(JE),jm.copy(_t.DEFAULT_UP),this.isUpVectorFlipped&&jm.negate(),jm.applyQuaternion(JE),eT.copy(_t.DEFAULT_UP).projectOnPlane($E),this.angleOffsetFromUp=eT.angleTo(jm),this.angleOffsetFromUp*=eT.cross(jm).dot($E)>=0?1:-1}updateTransformState(r,a){let n=super.updateTransformState(r,a);return r.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=r.isUpVectorFlipped),this.updateUp(),n}getViewFrontToObject(r){let a=r.getWorldPosition(new E),n=r.getWorldDirection(new E).multiplyScalar(this.targetOffset);return{position:a.clone().add(n),target:a}}getViewToTarget(r){let a=this.getWorldDirection(new E).multiplyScalar(this.targetOffset);return{position:r.clone().sub(a),target:r}}getViewToObject(r){let a=new E;return r.getWorldPosition(a),this.getViewToTarget(a)}setViewplaneSize(r,a,n=!1){if(this.aspect=r/a,n){let o=r>a?this.aspect:1,f=r>a?1:this.aspect;this.left=-790*.5*o,this.right=Bx*.5*o,this.top=Bx*.5*(1/f),this.bottom=-790*.5*(1/f)}else this.left=-r*.5,this.right=r*.5,this.top=a*.5,this.bottom=-a*.5;this.updateProjectionMatrix()}copyViewPlaneSize(r){this.aspect=r.aspect,this.left=r.left,this.right=r.right,this.top=r.top,this.bottom=r.bottom,this.updateProjectionMatrix()}toOrthographic(){this.orthoCamera.left=this.left,this.orthoCamera.right=this.right,this.orthoCamera.top=this.top,this.orthoCamera.bottom=this.bottom,this.orthoCamera.view=this.view,this.orthoCamera.far=this.far,this.orthoCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthoCamera.projectionMatrix,this.projectionMatrixInverse=this.orthoCamera.projectionMatrixInverse,this._cameraType="OrthographicCamera",this.objectHelper&&this.objectHelper.update()}toPerspective(){this.perspCamera.aspect=this.aspect,this.perspCamera.fov=this.fov,this.perspCamera.view=this.view,this.perspCamera.far=this.far,this.perspCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspCamera.projectionMatrix,this.projectionMatrixInverse=this.perspCamera.projectionMatrixInverse,this._cameraType="PerspectiveCamera",this.objectHelper&&this.objectHelper.update()}setFocalLength(r){this.perspCamera.setFocalLength(r),this.toPerspective()}getFocalLength(){return this.perspCamera.getFocalLength()}getEffectiveFOV(){return this.perspCamera.getEffectiveFOV()}getFilmWidth(){return this.perspCamera.getFilmWidth()}getFilmHeight(){return this.perspCamera.getFilmHeight()}setViewOffset(r,a,n,o,f,y){this._cameraType==="PerspectiveCamera"?this.perspCamera.setViewOffset(r,a,n,o,f,y):this.orthoCamera.setViewOffset(r,a,n,o,f,y)}clearViewOffset(){this._cameraType==="PerspectiveCamera"?(this.perspCamera.clearViewOffset(),this.toPerspective()):(this.orthoCamera.clearViewOffset(),this.toOrthographic())}copyHistory(){this.previousProjectionMatrix&&this.previousProjectionMatrix.copy(this.projectionMatrix)}updateProjectionMatrix(){this._cameraType==="PerspectiveCamera"?this.toPerspective():this._cameraType==="OrthographicCamera"&&this.toOrthographic()}updateMatrixWorld(r){super.updateMatrixWorld(r),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(r,a){super.updateWorldMatrix(r,a),this.matrixWorldInverse.copy(this.matrixWorld).invert()}copy(r,a){return super.copy(r,a),this.parent=r.parent,this.orthoCamera.copy(r.orthoCamera),this.perspCamera.copy(r.perspCamera),this.left=r.left,this.right=r.right,this.top=r.top,this.bottom=r.bottom,this.far=r.far,this.view=r.view===null?null:Object.assign({},r.view),this._cameraType=r._cameraType,this.aspect=r.aspect,this.fov=r.fov,this.focus=r.focus,this.filmGauge=r.filmGauge,this.filmOffset=r.filmOffset,this.targetOffset=r.targetOffset,this.updateProjectionMatrix(),this}toCameraState(r=[]){let a={type:this.cameraType,far:this.far,orthographic:{near:this.orthoCamera.near,zoom:this.orthoCamera.zoom},perspective:{near:this.perspCamera.near,fov:this.perspCamera.fov,zoom:this.perspCamera.zoom},up:this.up.toArray(),targetOffset:this.targetOffset,isUpVectorFlipped:this.isUpVectorFlipped};return Nh(a,r)}updateCameraSubtype(r,a){let n=r==="perspective"?"PerspectiveCamera":"OrthographicCamera";a.zoom!==void 0&&this.setZoom(n,a.zoom),a.near!==void 0&&this.setNear(n,a.near),a.fov!==void 0&&n==="PerspectiveCamera"&&(this.fov=a.fov)}updateState(r,a){this.updateCameraState(r,a)}updateCameraState(r,a){this.updateState_Entity(r,a),r.far!==void 0&&(this.far=r.far),r.orthographic!==void 0&&this.updateCameraSubtype("orthographic",r.orthographic),r.perspective!==void 0&&this.updateCameraSubtype("perspective",r.perspective),r.type!==void 0&&(this.cameraType=r.type),r.up!==void 0&&this.up.fromArray(r.up),r.targetOffset!==void 0&&(this.targetOffset=r.targetOffset),r.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=r.isUpVectorFlipped),this.updateProjectionMatrix()}updateByPatchedOp(r,a,n){super.updateByPatchedOp(r,a,n),r.path.length===1&&r.type===0&&this.updateCameraSubtype(r.path[0],r.props)}toState(r){return{...super.toState(r),...this.toCameraState(r),type:this.cameraType}}},df=new ue,SK=new ue,Un=class extends bs{constructor(r,a,n){super(r,a),this.data=a,this.meshSetAddresses=[],this.needsTransformForDownstream=!1,this.geometry=new Ce,this.onAfterRender=(o,f,y,x,b,_)=>{super.onAfterRender(o,f,y,x,b,_),this.recomputeBoolean()},this.geometry.userData.parameters={width:0,height:0,depth:0}}get booleanOp(){return this.data.geometry.operation}get phongAngle(){return this.data.geometry.phongAngle??45}get isLOD(){return this.recomputeBoolean(),!1}updateByPatchedOp(r,a,n){super.updateByPatchedOp(r,a,n),r.path.length===1&&r.path[0]==="geometry"&&r.type===0&&r.props.operation!==void 0&&(this.freeBooleanPointer(),this.resetBBoxNeedsUpdate())}freeBooleanPointer(){super.freeBooleanPointer(),this.geometry.dispose()}recomputeBoolean(r,a=!0){var o;if(this.booleanMeshSetAddress!==-1&&!r)return;for(let f=0;f<this.children.length;f++){let y=this.children[f];y instanceof Un&&y.dataPatched.visible===!0&&y.recomputeBoolean(r===!0,a)}this.meshSetAddresses=[];for(let f=0;f<this.children.length;f++){let y=this.children[f];if(y instanceof yr&&y.dataPatched.visible===!0&&((o=y.geometry.attributes.position)==null?void 0:o.count)>0&&y.geometry.drawRange.count>0&&y.booleanMeshSetAddress!==0){df.multiplyMatrices(y.hiddenMatrix,y.matrix);try{if(y.booleanMeshSetAddress===-1){if((y.geometry.index??y.geometry.getAttribute("position")).count/3<15e5&&(y.booleanMeshSetAddress=vs.getMeshSet(y.geometry,r===!0,a)),y.booleanMeshSetAddress===-1)return;vs.transformMeshSet(y.booleanMeshSetAddress,df),y.booleanMatrixInvOld.copy(df).invert(),y.booleanWasTransformed=!1}else y instanceof Un&&y.needsTransformForDownstream===!0?(vs.transformMeshSet(y.booleanMeshSetAddress,df),y.needsTransformForDownstream=!1):y.booleanWasTransformed===!0&&(vs.transformMeshSet(y.booleanMeshSetAddress,SK.multiplyMatrices(df,y.booleanMatrixInvOld)),y.booleanMatrixInvOld.copy(df).invert(),y.booleanWasTransformed=!1)}catch(x){console.error(x),y.booleanMeshSetAddress=0,y.geometry.userData.booleanOperationDidFail=!0;continue}vs.hasOpenEdges(y.booleanMeshSetAddress)===!1||f===this.children.length-1&&this.booleanOp===2?(this.meshSetAddresses.push(y.booleanMeshSetAddress),y.geometry.userData.booleanOperationDidFail=!1):y.geometry.userData.booleanOperationDidFail="openEdges"}}if(this.meshSetAddresses.length===0){this.geometry.setAttribute("position",new Te([],0)),this.geometry.setDrawRange(0,0);return}if(r===!0)return vs.calcBooleanTopological(this.meshSetAddresses,this.booleanOp);let n=this.geometry;n.dispose(),this.geometry=new Ce,this.geometry.userData=n.userData,this.geometry.boundingSphere=n.boundingSphere;try{this.booleanMeshSetAddress=vs.calcBoolean(this.meshSetAddresses,this.booleanOp,this.geometry,this.phongAngle)}catch(f){this.booleanMeshSetAddress=0,this.geometry.userData.booleanOperationDidFail=!0,console.error(f)}this.booleanMatrixInvOld.copy(this.matrix).invert(),this.needsTransformForDownstream=!0,lf(this),cf(this)}dispose(){super.dispose(),this.geometry.dispose()}},Nx;(r=>{function a(n){return mt.is(n)&&n instanceof ml}r.is=a})(Nx||(Nx={}));var ff=(r,a)=>class extends As(r,a){updateState_Light(n,o){this.updateState_Entity(n,o),n.color!==void 0&&(this.color=o.shared.color(n.color)),n.intensity!==void 0&&(this.intensity=n.intensity),n.depth!==void 0&&(this.shadow.camera.far=n.depth,this.shadow.needsUpdate=!0),n.shadows!==void 0&&(this.castShadow=n.shadows)}},un=r=>r instanceof yr,Mn=r=>r!==null&&r instanceof Un,F3=r=>r instanceof Er,V3=r=>Nx.is(r),Hm=r=>Lx.is(r),wK=new E(1,1,1),U3=new E,AK=new E,z3=new Ke,Es=class extends Go(ky){constructor(r,a=15){super(a),this.object=r,this.dummy=new on,this.object.updateMatrixWorld(),this.name=`EmptyObjectHelper: ${r.uuid}`,this.matrix=this.dummy.matrixWorld,this.matrixAutoUpdate=!1,this.object.isBone&&(this.visible=!1)}raycast(r,a){jo(this.object,Es.geometryHelper,r,a,!1,this.dummy)}update(){}updateMatrix(){}updateMatrixWorld(r){this.object.matrixWorld.decompose(U3,z3,AK),this.matrix.compose(U3,z3,wK),super.updateMatrixWorld(r)}updateWorldMatrix(r,a){}},Ts=class extends As(on,Es){constructor(r,a){super(),this.super_Entity(r,a),this.objectHelper.update()}updateState(r,a){this.updateState_Entity(r,a),"buffer"in r&&Object.keys(r).length===1&&a.scene.reloadSplats()}},Ho=class extends As(on,Es){constructor(r,a,n){super(),this.super_Entity(r,a),this.context=n,this.objectHelper.update()}updateState(r,a){this.updateState_Entity(r,a)}};new yn;new qe;new E;new ue;new qe;new E;new E;new wr;new Je({transparent:!0,vertexShader:`
        void main() {
            gl_Position = vec4(0.0);
        }
    `,fragmentShader:`
        layout(location = 1) out vec4 gVelocity;

        void main() {
            gl_FragColor = vec4(0.0);
			gVelocity = vec4(0.0);
        }
    `});new Je({name:"CombineMaterial",uniforms:{inputBufferA:new ce(null),inputBufferB:new ce(null)},blending:tr,depthWrite:!1,depthTest:!1,vertexShader:`
varying vec2 vUv;
void main() {
    gl_Position = vec4(position.xy, 1.0, 1.0);
    vUv = position.xy * 0.5 + 0.5;
}
`,fragmentShader:`
    varying vec2 vUv;
    uniform sampler2D inputBufferA;
    uniform sampler2D inputBufferB;

    // TODO: Why do we need these when postpro of framemode is enabled???
    layout(location = 1) out vec4 gVelocity;

    void main() {
	vec4 resA = texture2D(inputBufferA, vUv);
	vec4 resB = texture2D(inputBufferB, vUv);
    float a = resA.a + resB.a * ( 1.0 - resA.a );

	vec4 res;
	res.rgb =  resA.rgb + (resB.rgb * (1.0 - resA.a));
	res.a = resA.a + resB.a * (1.0 - resA.a);
	gl_FragColor = res;
    gVelocity = vec4(0.0);
    }
`});var dL=`#define GLSLIFY 1
#include <skinning_pars_vertex>
#include <morphtarget_pars_vertex>
out vec3 n;void main(){
#include <beginnormal_vertex>
#include <morphnormal_vertex>
#include <skinbase_vertex>
#include <skinnormal_vertex>
#include <defaultnormal_vertex>
#include <begin_vertex>
#include <morphtarget_vertex>
#include <skinning_vertex>
vec4 view_space=viewMatrix*modelMatrix*vec4(transformed,1.0);gl_Position=projectionMatrix*view_space;n=normalize(transformedNormal);}`,fL=`#define GLSLIFY 1
in vec3 n;void main(){gl_FragColor=vec4(n,1.0);}`,gL=`#define GLSLIFY 1
out vec2 v_uv;void main(){gl_Position=vec4(position.xy,1.0,1.0);v_uv=uv;}`,yL=`#define GLSLIFY 1
in vec2 v_uv;uniform sampler2D texture_ao_lrez;uniform sampler2D texture_depth_lrez;uniform sampler2D texture_depth_hrez;uniform float near;uniform float far;float linearize_depth(float depth_sampled){float z=depth_sampled*2.0-1.0;return(2.0*near*far)/(far+near-z*(far-near));}vec2 nearest_depth_filter(in vec2 uv){vec2 resolution=vec2(textureSize(texture_depth_lrez,0));vec2 texel_size=1.0/resolution;vec2 offset=uv-0.5*texel_size;float d_hrez=texture(texture_depth_hrez,uv).r;float a=abs(d_hrez-texture(texture_depth_lrez,offset).r);float b=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,0.0)).r);float c=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(0.0,texel_size.y)).r);float d=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,texel_size.y)).r);float min_diff=min(a,min(b,min(c,d)));if(min_diff==a)return offset;if(min_diff==b)return offset+vec2(texel_size.x,0.0);if(min_diff==c)return offset+vec2(0.0,texel_size.y);if(min_diff==d)return offset+vec2(texel_size.x,texel_size.y);}void main(){
#ifdef DEBUG
float d_lrez=texture(texture_depth_lrez,v_uv).r;float d_hrez=texture(texture_depth_hrez,v_uv).r;float output_d=mix(linearize_depth(d_lrez)/far,linearize_depth(d_hrez)/far,step(0.5,v_uv.x));gl_FragColor=vec4(vec3(output_d),1.0);
#else
vec2 filtered_uv=nearest_depth_filter(v_uv);vec4 ao=texture(texture_ao_lrez,filtered_uv);gl_FragColor=vec4(ao.rgb,1.0);gl_FragColor=ao;
#endif
}`;new Je({vertexShader:dL,fragmentShader:fL});new Je({vertexShader:gL,fragmentShader:yL,uniforms:{texture_ao_lrez:new ce(null),texture_depth_lrez:new ce(null),texture_depth_hrez:new ce(null),near:new ce(null),far:new ce(null)}});var $Q=r=>`

// PCSS implementation based on:
// https://www.gamedev.net/articles/programming/graphics/contact-hardening-soft-shadows-made-fast-r4906/
// NOTE: This number affects how big the shadow blur can
// possibly get. Bigger number == bigger blur, but less precise results

const float  gPenumbraFilterSize = 80.0;
const int   gPenumbraSamples = ${r};
const int gShadowSamples = ${r};
const float gShadowSamplesRpc = 1.0f / float(gShadowSamples);

#ifdef USE_SHADOWMAP
    #if NUM_DIR_LIGHT_SHADOWS > 0

        uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
        varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

        struct DirectionalLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

    #endif

    #if NUM_SPOT_LIGHT_SHADOWS > 0

        uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
        varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_SHADOWS ];

        struct SpotLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

    #endif

    #if NUM_POINT_LIGHT_SHADOWS > 0

        uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
        varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

        struct PointLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
            float shadowCameraNear;
            float shadowCameraFar;
        };

        uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

    #endif

    /*
    #if NUM_RECT_AREA_LIGHTS > 0

        // TODO (abelnation): create uniforms for area light shadows

    #endif
    */

float computePenumbra(int index, sampler2D shadowMap, float temporalAngle, float texelSize, vec2 uv, float compare, float texelScalar, float shadowRadius)
{
    float penumbra = 1.0;
    float blockerDepthAvg = 0.0;
    float blockerCount = 0.0;

    #pragma unroll_loop_start
    for(int i = 0; i < gPenumbraSamples; i ++)
    {
        vec2 offset = (vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize) * texelScalar;
        float depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) );

        if(depth < compare + 0.0001)
        {
            blockerDepthAvg += depth;
            blockerCount++;
        }
    }
    #pragma unroll_loop_end

    if (blockerCount > 0.0)
    {
        blockerDepthAvg /= blockerCount;

        // Compute penumbra
        penumbra = (compare - blockerDepthAvg) / (blockerDepthAvg);
        penumbra *= penumbra;
        penumbra *= 200.0 * penumbraSize[min(index, 5 - 1)]; // Magic number that affects how quickly the penumbra grows

        return clamp(penumbra, 0.00, 1.0);
    }
    return 0.0;
}

float vogelShadow(int index, sampler2D shadowMap, vec2 uv, float texelSize, float compare, float shadowRadius)
{
    float shadow         = 0.0f;

    // NOTE: When using TAA, we should use screen space interleaved gradient noise
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    float texelScalar = (gPenumbraFilterSize) / (texelSize * 1024.);
    float penumbra = computePenumbra(index, shadowMap, temporalAngle, texelSize, uv, compare, texelScalar, shadowRadius);
    if (penumbra == -1.0) {
        return 1.0;
    }

    #pragma unroll_loop_start
    for (int i = 0; i < gShadowSamples; i++)
    {
        vec2 vogelSample =  vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;
        // Overall blurring offset
        vec2 offset = vogelSample * (shadowRadius * 2.);

        // Penumbra offset
        offset += vogelSample * (penumbra * texelScalar);

        shadow += step( compare, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );
    }
    #pragma unroll_loop_end

    return shadow * gShadowSamplesRpc;
}


    float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {

        return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );

    }

    vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {

        return unpackRGBATo2Half( texture2D( shadow, uv ) );

    }

    float VSMShadow (sampler2D shadow, vec2 uv, float compare ){

        float occlusion = 1.0;

        vec2 distribution = texture2DDistribution( shadow, uv );

        float hard_shadow = step( compare , distribution.x ); // Hard Shadow

        if (hard_shadow != 1.0 ) {

            float distance = compare - distribution.x ;
            float variance = max( 0.00000, distribution.y * distribution.y );
            float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality
            softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed
            occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );

        }
        return occlusion;

    }

    float getShadow( int i, sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {

        float shadow = 1.0;

        shadowCoord.xyz /= shadowCoord.w;
        shadowCoord.z += shadowBias;

        // if ( something && something ) breaks ATI OpenGL shader compiler
        // if ( all( something, something ) ) using this instead

        bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
        bool inFrustum = all( inFrustumVec );

        bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );

        bool frustumTest = all( frustumTestVec );

        if ( frustumTest ) {

        #if defined( SHADOWMAP_TYPE_PCF )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            return vogelShadow(i, shadowMap, shadowCoord.xy, texelSize.x, shadowCoord.z, shadowRadius );

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            float dx = texelSize.x;
            float dy = texelSize.y;

            vec2 uv = shadowCoord.xy;
            vec2 f = fract( uv * shadowMapSize + 0.5 );
            uv -= f * texelSize;

            shadow = (
                texture2DCompare( shadowMap, uv, shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
                          f.x ),
                     mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
                          f.x ),
                     f.y )
            ) * ( 1.0 / 9.0 );

        #elif defined( SHADOWMAP_TYPE_VSM )

            shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );

        #else // no percentage-closer filtering:

            shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );

        #endif

        }

        return shadow;

    }

    // cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D
    // vector suitable for 2D texture mapping. This code uses the following layout for the
    // 2D texture:
    //
    // xzXZ
    //  y Y
    //
    // Y - Positive y direction
    // y - Negative y direction
    // X - Positive x direction
    // x - Negative x direction
    // Z - Positive z direction
    // z - Negative z direction
    //
    // Source and test bed:
    // https://gist.github.com/tschw/da10c43c467ce8afd0c4

    vec2 cubeToUV( vec3 v, float texelSizeY ) {

        // Number of texels to avoid at the edge of each square

        vec3 absV = abs( v );

        // Intersect unit cube

        float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
        absV *= scaleToCube;

        // Apply scale to avoid seams

        // two texels less per square (one texel will do for NEAREST)
        v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );

        // Unwrap

        // space: -1 ... 1 range for each square
        //
        // #X##         dim    := ( 4 , 2 )
        //  # #         center := ( 1 , 1 )

        vec2 planar = v.xy;

        float almostATexel = 1.5 * texelSizeY;
        float almostOne = 1.0 - almostATexel;

        if ( absV.z >= almostOne ) {

            if ( v.z > 0.0 )
                planar.x = 4.0 - v.x;

        } else if ( absV.x >= almostOne ) {

            float signX = sign( v.x );
            planar.x = v.z * signX + 2.0 * signX;

        } else if ( absV.y >= almostOne ) {

            float signY = sign( v.y );
            planar.x = v.x + 2.0 * signY + 2.0;
            planar.y = v.z * signY - 2.0;

        }

        // Transform to UV space

        // scale := 0.5 / dim
        // translate := ( center + 0.5 ) / dim
        return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );

    }

    float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {

        float shadow = 1.0;
        vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );

        // for point lights, the uniform @vShadowCoord is re-purposed to hold
        // the vector from the light to the world-space position of the fragment.
        vec3 lightToPosition = shadowCoord.xyz;

        // dp = normalized distance from light to fragment position
        float compare = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?
        compare += shadowBias;

        // bd3D = base direction 3D
        vec3 bd3D = normalize( lightToPosition );

        vec2 halton = haltonSequence[frameIndex];
        float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
        float temporalAngle  = temporalOffset * PI2;

        #if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_VSM )
            for (int i = 0; i < gShadowSamples; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                // NOTE: Removed for now
                // Penumbra offset
                //offset += vec3(vogelSample.x, vogelSample.y, vogelSample.y)  * (penumbra * gPenumbraFilterSize);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * gShadowSamplesRpc;

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )
            for (int i = 0; i < 16; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * (1.0 / 16.0);
        #else // no percentage-closer filtering

            return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), compare );

        #endif

    }

#endif
`,eZ=St.lights_fragment_begin,tZ=St.shadowmask_pars_fragment,bL=null,rZ=r=>{switch(r){case"low":return 8;case"medium":return 16;case"high":return 32;default:return 16}},SL=(r="medium")=>{if(bL===r)return!1;bL=r;let a=rZ(r);St.shadowmap_pars_fragment=$Q(a);let n=eZ.slice();n=n.replace("getShadow( spotShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX + 3, spotShadowMap[ i ]"),n=n.replace("getShadow( directionalShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX, directionalShadowMap[ i ]"),St.lights_fragment_begin=n;let o=tZ.slice();return o=o.replaceAll("getShadow(","getShadow( UNROLLED_LOOP_INDEX, "),St.shadowmask_pars_fragment=o,!0},iZ=`
attribute vec3 randomColor;
varying vec3 vNormal;
flat out vec3 vColor;
#include <skinning_pars_vertex>
#include <morphtarget_pars_vertex>
	
void main()
{
#include <beginnormal_vertex>
#include <morphnormal_vertex>
#include <skinbase_vertex>
#include <skinnormal_vertex>
vec3 transformed = vec3(position);
#include <morphtarget_vertex>
#include <skinning_vertex>

vNormal = normal;
vColor = randomColor;
gl_Position = projectionMatrix * (modelViewMatrix * vec4(transformed, 1.0));
}
`,nZ=`
uniform float depthContrast;
varying vec3 vNormal;
flat in vec3 vColor;
void main()
{
vec3 normal = (normalize(vNormal)).rgb;

float contrastDepth = (gl_FragCoord.z - 0.5) * depthContrast + 0.5;

vec3 resultColor = mix(mix(vColor, normal, 0.2), vec3(contrastDepth), 0.4);
gl_FragColor = vec4(resultColor, vColor.r);
gl_FragColor = vec4(resultColor, vColor.r);
}
`;new Je({vertexShader:iZ,fragmentShader:nZ,uniforms:{depthContrast:{value:1}}});new rr;new V;var Cf=class extends Go(zy){constructor(r,a=15,n=10066329){super(r,a,n),this.object=r,this.added=!1,this.name=`DirectionalLightHelper: ${r.uuid}`}raycast(r,a){jo(this.object,Cf.geometryHelper,r,a)}},Pf=class extends Go(Uy){constructor(r,a=15,n=6710886){super(r,a,n),this.object=r,this.name=`PointLightHelper: ${r.uuid}`}raycast(r,a){jo(this.object,Pf.geometryHelper,r,a)}},$x=class extends Go(Vy){constructor(r,a=6710886){super(r,a),this.object=r,this.name=`SpotLightHelper: ${r.uuid}`}raycast(r,a){jo(this.object,$x.geometryHelper,r,a)}update(){if(this.object!==void 0){let r=$x._vector,a=this.object.distance?this.object.distance:1e3,n=a*Math.tan(this.object.angle);this.cone.scale.set(n,n,a),r.setFromMatrixPosition(this.object.target.matrixWorld),this.cone.lookAt(r);let o=this.color!==void 0?this.color:this.light.color;if(this.cone.material instanceof Array)for(let f=0,y=this.cone.material.length;f<y;f++)this.cone.material[f].color.set(o);else this.cone.material.color.set(o)}}},Km=$x;Km._vector=new E;function uZ(r,a){r.shadow.camera.right=a/2,r.shadow.camera.left=-a/2,r.shadow.camera.top=a/2,r.shadow.camera.bottom=-a/2,r.shadow.needsUpdate=!0}var If=class extends ff(By,Cf){constructor(r,a,n){super(),this.super_Entity(r,a),this.castShadow=!0,this.shadow.mapSize.width=2048,this.shadow.mapSize.height=2048,this.shadow.normalBias=1,this.layers.enable(3);let o=this.shadow.camera;o.top=1250,o.bottom=-1250,o.right=1250,o.left=-1250,o.near=-1e4,o.far=2500;let f=new yl(this.shadow.camera);f.visible=!1,this.gizmos.shadowmap=f}update(){this.shadow.camera.updateProjectionMatrix();for(let r in this.gizmos){let a=this.gizmos[r];a instanceof yl&&a.update()}}updateMatrixWorld(r){super.updateMatrixWorld(r),this.objectHelper&&this.objectHelper.update()}updateState(r,a){this.updateState_Light(r,a);let n=r.depth!==void 0&&r.depth!==this.shadow.camera.far||r.size!==void 0&&r.size/2!==this.shadow.camera.right;r.size!==void 0&&uZ(this,r.size),r.shadowRadius!==void 0&&(this.shadow.radius=r.shadowRadius),r.shadowResolution!==void 0&&(this.shadow.mapSize.set(r.shadowResolution,r.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null)),r.penumbraSize!==void 0&&a.scene.markPenumbraSizeDirty(),n&&this.update()}},TL=new E,ML=new E,CL=new Ke,Df=class extends ff(Ry,Km){constructor(r,a,n){super(),this.super_Entity(r,a),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let o=this.shadow.camera;o.fov=we.RAD2DEG*2*this.angle,o.aspect=1,o.near=100,o.far=2500;let f=new yl(this.shadow.camera);f.visible=!1,this.gizmos.shadowmap=f,this.update()}update(){this.shadow.camera.updateProjectionMatrix();for(let r in this.gizmos){let a=this.gizmos[r];a instanceof yl&&a.update()}}updateMatrixWorld(r){super.updateMatrixWorld(r),ML.setFromMatrixPosition(this.matrixWorld),CL.setFromRotationMatrix(this.matrixWorld),TL.copy(this.up).applyQuaternion(CL).negate().multiplyScalar(this.distance),this.target.position.copy(ML).add(TL),this.target.updateMatrixWorld(),this.objectHelper&&this.objectHelper.update()}updateState(r,a){this.updateState_Light(r,a),r.distance!==void 0&&(this.distance=r.distance),r.decay!==void 0&&(this.decay=r.decay),r.angle!==void 0&&(this.angle=r.angle),r.penumbra!==void 0&&(this.penumbra=r.penumbra),r.shadowRadius!==void 0&&(this.shadow.radius=r.shadowRadius),r.penumbraSize!==void 0&&a.scene.markPenumbraSizeDirty(),r.shadowResolution!==void 0&&(this.shadow.mapSize.set(r.shadowResolution,r.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}};function hZ(r){let a=(r[0][0]+r[1][1])/2,n=(r[0][0]-r[1][1])/2,o=(r[1][0]+r[0][1])/2,f=(r[1][0]-r[0][1])/2,y=Math.sqrt(a*a+f*f),x=Math.sqrt(n*n+o*o),b=y+x,_=y-x,S=Math.atan2(o,n),A=Math.atan2(f,a),C=(A-S)/2,P=(A+S)/2,T=[[Math.cos(P),Math.sin(P)],[-Math.sin(P),Math.cos(P)]],M=[[b,0],[0,_]],O=[[Math.cos(C),Math.sin(C)],[-Math.sin(C),Math.cos(C)]];return T[0][0]*=-1,T[0][1]*=-1,O[0][0]*=-1,O[1][0]*=-1,[T,M,O]}function tb(r,a){return[[r[0][0]*a[0][0]+r[0][1]*a[1][0],r[0][0]*a[0][1]+r[0][1]*a[1][1]],[r[1][0]*a[0][0]+r[1][1]*a[1][0],r[1][0]*a[0][1]+r[1][1]*a[1][1]]]}function PL(r){return[[r[0][0],r[1][0]],[r[0][1],r[1][1]]]}function _L(r){let[a,n,o]=hZ(r),f=tb(a,PL(o)),y=tb(tb(o,n),PL(o)),x=Math.atan2(f[1][0],f[0][0]),b=[y[0][0],y[1][1]],_=[y[0][1]/y[1][1],y[1][0]/y[0][0]];return{rotation:x,scale:b,shear:_}}function IL({rotation:r,scale:a,shear:n}){let o=Math.cos(r),f=Math.sin(r),y=[[o,-f],[f,o]],x=[[a[0],n[0]*a[1]],[n[1]*a[0],a[1]]],b=tb(y,x);return[b[0][0],b[1][0],b[0][1],b[1][1]]}var Mt;(r=>{function a(){return[1,0,0,0,1,0,0,0,1]}r.identity=a;function n(F,B=r.identity()){for(let N=0,j=F.length;N<j;N++)B[N]=F[N];return B}r.copy=n;function o(F,B,N,j,G,Y){return r.setAbcdef(r.identity(),F,B,N,j,G,Y)}r.create=o;function f(F,B,N,j,G,Y,X){return F[0]=B,F[1]=j,F[2]=Y,F[3]=N,F[4]=G,F[5]=X,F}r.setAbcdef=f;function y(F,B){let[N,j,G,Y,X,$]=b(F),[te,ee,q,Z,U,W]=b(B),H=te*N+ee*G,K=te*j+ee*Y,le=q*N+Z*G,me=q*j+Z*Y,ne=U*N+W*G+X,pe=U*j+W*Y+$;return r.create(H,K,le,me,ne,pe)}r.append=y;function x(F,B){let[N,j,G,Y,X,$]=b(F),[te,ee,q,Z,U,W]=b(B),H=N,K=j,le=G,me=Y;(te!==1||ee!==0||q!==0||Z!==1)&&(H=N*te+j*q,K=N*ee+j*Z,le=G*te+Y*q,me=G*ee+Y*Z);let ne=X*te+$*q+U,pe=X*ee+$*Z+W;return r.create(H,K,le,me,ne,pe)}r.prepend=x;function b(F){return[F[0],F[3],F[1],F[4],F[2],F[5]]}r.getAbcdef=b;function _(F){let[B,N,j,G,Y,X]=r.getAbcdef(F),$=B*G-N*j,te=G/$,ee=-N/$,q=-j/$,Z=B/$,U=(j*X-G*Y)/$,W=-(B*X-N*Y)/$;return r.create(te,ee,q,Z,U,W)}r.invert=_;function S([F,B],N){let[j,G,Y,X,$,te]=r.getAbcdef(N);return[j*F+Y*B+$,G*F+X*B+te]}r.apply=S;function A(F,B){let[N,j,G,Y,X,$]=r.getAbcdef(B),te=1/(N*Y+G*-j),[ee,q]=F;return[Y*te*ee+-G*te*q+($*G-X*Y)*te,N*te*q+-j*te*ee+(-$*N+X*j)*te]}r.applyInverse=A;function C(F,B,N=B){let[j,G,Y,X,$,te]=r.getAbcdef(F);return r.setAbcdef(F,j*B,G*N,Y*B,X*N,$*B,te*N),F}r.scale=C;function P(F,B){let N=Math.cos(B),j=Math.sin(B),[G,Y,X,$,te,ee]=r.getAbcdef(F);return r.setAbcdef(F,G*N-Y*j,G*j+Y*N,X*N-$*j,X*j+$*N,te*N-ee*j,te*j+ee*N),F}r.rotate=P;function T(F,B,N){let[j,G]=N,Y=r.translate(F,-j,-G);return Y=r.rotate(Y,B),Y=r.translate(Y,j,G),Y}r.rotateAround=T;function M(F,B,N){let[j,G,Y,X,$,te]=r.getAbcdef(F);return r.setAbcdef(F,j,G,Y,X,$+B,te+N),F}r.translate=M;function O(F,B,N){let[j,G,Y,X]=r.getAbcdef(F);return r.setAbcdef(F,j,G,Y,X,B,N),F}r.setTranslate=O;function I(F,B,N){let[j,G,Y,X]=r.getAbcdef(F);return r.setAbcdef(F,j,G,Y,X,B,N),F}r.setPosition=I;function D(F){let[B,N,j,G]=r.getAbcdef(F),Y=Math.sqrt(B*B+N*N),X=Math.sqrt(j*j+G*G);return[Y,X]}r.getScale=D;function z(F){let[,,,,B,N]=r.getAbcdef(F);return[B,N]}r.getPosition=z;function k(F,B){return r.decompose(F,B).rotation}r.getRotation=k;function L(F,B){let[N,j,G,Y,X,$]=r.getAbcdef(F),{rotation:te,scale:ee,shear:q}=_L([[N,G],[j,Y]]);return{position:[X+(B[0]*N+B[1]*G)-B[0],$+(B[0]*j+B[1]*Y)-B[1]],scale:ee,rotation:te,shear:q,pivot:B}}r.decompose=L;function R(F,B,N,j,G=[0,0]){let[Y,X]=F,[$,te]=j,[ee,q,Z,U]=IL({rotation:N,scale:B,shear:G}),W=Y-($*ee+te*Z)+$,H=X-($*q+te*U)+te;return r.create(ee,q,Z,U,W,H)}r.compose=R})(Mt||(Mt={}));var dZ=Math.PI/180;function DL(r,a,n,o,f,y){let x=r-n,b=a-o;return x*x/(f*f)+b*b/(y*y)<=1}function OL(r){return r*dZ}var nr=class{constructor(r,a,n){this.uuid=r,this.data=a,this.localMatrix=Mt.identity(),this.worldMatrix=Mt.identity(),this.ignoreCameraZoom=!1,this.visible=!0,this._singleBBox=new ec,this._recursiveBBox=new ec,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this.stateSelection=null,this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this.name="",this.position=[0,0],this.scale=[1,1],this.rotation=0,this.shear=[0,0],this.emitter=La(),this.dpr=n.dpr??1,this.dataPatched=a}project(r,a){let n=this.worldMatrix;return a&&(n=Mt.append(a.worldMatrix,n)),Mt.applyInverse(r,n)}intersects(r,a,n,o=!1){return this.visible&&!this.data.raycastLock&&this.intersectsInLocalSpace(...this.project([r,a],n),o)}intersectsInLocalSpace(r,a,n=!1){let{min:o,max:f}=n?this.recursiveBBox:this.singleBBox;return r>=o[0]&&r<=f[0]&&a>=o[1]&&a<=f[1]}applyTransforms(r){r.setTransform(this.worldMatrix,this.ignoreCameraZoom)}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges()),this._recursiveBBox}updateLocalMatrix(){this.localMatrix=Mt.compose(this.position,this.scale,OL(this.rotation),Ia.getPivot(this.dataPatched),this.shear)}updateWorldMatrix(r,a,n){let o=this.parent;a&&o!==null&&o!==void 0&&o.updateWorldMatrix(r,!0,!1),r&&this.updateLocalMatrix(),this.parent?this.worldMatrix=Mt.append(this.parent.worldMatrix,this.localMatrix):this.worldMatrix=Mt.copy(this.localMatrix),this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}get pivot(){return Ia.getPivot(this.data)}getCenter(){return[0,0]}getHalfSize(){return[0,0]}get id(){return this.uuid}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(r=>{r.resetBBoxNeedsUpdateSelf()})}updateTransformState(r){let a=!1;r.position!==void 0&&(a=!0,this.position=r.position),r.rotation!==void 0&&(a=!0,this.rotation=r.rotation),r.scale!==void 0&&(a=!0,this.scale=r.scale),r.shear!==void 0&&(a=!0,this.shear=r.shear),a&&(this.updateWorldMatrix(!0,!1,!0),this.resetBBoxNeedsUpdate())}updateByOp(r,a,n){r.type===0&&r.props.visible!==void 0&&(this.visible=r.props.visible),this.data=a,this.data=a;let o=r,f=Vt(r.path,["states","*"]);if(f!==null){if(r.type===0){let[y]=f;if((this==null?void 0:this.stateSelection)===y){let x={...r.props};if(delete x.name,Object.values(r.props).some(b=>b===void 0)){let b=this.data;if(b!==void 0){let _=Ar.zoom(b,r.path.slice(2));if(_)for(let S in r.props)r.props[S]===void 0&&S in _&&(x[S]=_[S])}}o={...r,props:x,path:r.path.slice(2)}}}}else if(r.type===0){let y=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(y!==void 0){if(r.props.name!==void 0&&y.name){let{name:b,..._}=y;y=_}let x=Ar.removeOverridden(r.path,r.props,y);o={...r,props:x}}}this.updateByPatchedOpBase(o,_a.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),n)}changeSelectedState(r,a,n=!1){if(!(this.data.states.length===0&&!n)){for(let o of this.data.states)_a.toOps(this.data,o.data).forEach(f=>{let y=jh.replaceProps(f,this.data);this.dataPatched=this.data,this.updateByPatchedOp(y,this.data,a)});if(r!==null){let o=this.data.states.data(r);o&&(this.dataPatched=_a.patch(this.data,o),_a.toOps(this.data,o).forEach(f=>{this.updateByPatchedOp(f,this.dataPatched,a)}))}n&&this.updateTransformState(this.dataPatched),this.stateSelection=r}}updateState(r,a){r.name!==void 0&&(this.name=r.name),r.visible!==void 0&&(this.visible=r.visible),this.updateTransformState(r)}updateByPatchedOpBase(r,a,n){this.dataPatched=a,this.updateByPatchedOp(r,a,n)}updateByPatchedOp(r,a,n){r.path.length===0&&r.type===0&&this.updateState(r.props,n),this.requestRender()}traverseFrameAncestors(r){this.traverseAncestors(a=>{a.data.type==="frame2d"&&r(a)})}traverseAncestors(r){let a=this.parent;for(;a;)r(a),a=a.parent}requestRender(){this.traverseFrameAncestors(r=>{r.requestRender()})}clone(r){let a=new nr(this.uuid,this.data,r);return a.parent=void 0,a}addEventListener(r,a){this.emitter.on(r,a)}removeEventListener(r,a){this.emitter.off(r,a)}dispatchEvent(r){this.emitter.emit(r.type,{...r,target:r.target??this})}traverseSortNextHelper(){let r=this.parent;if(r){let a=r.children;if(a){let n=a.indexOf(this)+1;return a[n]?a[n]:r.traverseSortNextHelper()}}}sortNext(){let r=this.children;return r&&r.length>0&&r[0]?r[0]:this.traverseSortNextHelper()}isDescendantOf(r){r instanceof nr&&(r=r.uuid);let a=this;for(;a.parent;){if(a.parent.uuid===r)return!0;a=a.parent}return!1}},Ji=class extends nr{constructor(r,a,n){super(r,a,n),this.uuid=r,this.data=a,this.context=n,this.children=[]}add(r){r.parent&&r.parent instanceof Ji&&r.parent.remove(r),this.children.push(r),r.parent=this}remove(r){let a=this.children.indexOf(r);a>=0&&(this.children.splice(a,1),r.parent=void 0)}traverse(r){let a=r(this);if(a!==!0)for(let n of this.children)n instanceof Ji?n.traverse(r):a=r(n)}intersectsChildrenHelper(r,a,n,o,f){for(let y of this.children)if(y.intersects(r,a,n,!1)&&(f.push(y),o)||y instanceof Ji&&y.intersectsChildrenHelper(r,a,n,o,f))return!0;return!1}intersectsChildren(r,a,n,o=!1,f=[],y=!1){return this.intersectsChildrenHelper(r,a,n,o,f),f}intersectsChildrenHelperReverse(r,a,n,o,f){for(let y of this.children)if(y instanceof Ji&&y.intersectsChildrenHelperReverse(r,a,n,o,f)||y.intersects(r,a,n,!1)&&(f.push(y),o))return!0;return!1}intersectsChildrenReverse(r,a,n,o=!1,f=[],y=!1){return this.intersectsChildrenHelperReverse(r,a,n,o,f),f}updateWorldMatrix(r,a,n){if(super.updateWorldMatrix(r,a,n),n&&this.children)for(let o of this.children)o.updateWorldMatrix(r,!1,!0)}find(r){let a;return this.traverse(n=>{n.uuid===r&&(a=n)}),a}innerDrawChildren(r){for(let a=this.children.length-1;a>=0;a--)this.children[a].draw(r)}resetBBoxNeedsUpdate(){super.resetBBoxNeedsUpdate(),this.traverse(r=>{r.resetBBoxNeedsUpdateSelf()})}clone(r){let a=new Ji(this.uuid,this.data,r);a.parent=void 0;for(let n of this.children)a.add(n.clone(r));return a}},kn=class extends Ji{constructor(r,a,n){super(r,a,n),this.uuid=r,this.data=a,this.updateState(a,n)}draw(r){!this.visible||(r.save(),this.applyTransforms(r),this.innerDrawChildren(r),r.restore())}clone(r){let a=new kn(this.uuid,this.data,r);a.parent=void 0;for(let n of this.children)a.add(n.clone(r));return a}};function fZ(r,a){let[[n,o],[f,y]]=r,[[x,b],[_,S]]=a,A=(n-f)*(b-S)-(o-y)*(x-_);if(A===0)return!1;let C=((n-x)*(b-S)-(o-b)*(x-_))/A,P=-((n-f)*(o-b)-(o-y)*(n-x))/A;return C>=0&&C<=1&&P>=0&&P<=1}var LL=[[-1,1],[-1,-1],[1,-1],[1,1]],RL=(r,a,n)=>{let o=r.getCenter(),f=r.getHalfSize(),y=Mt.append(a,r.worldMatrix);f[0]===0&&f[1]===0?n.push(Mt.apply(o,y)):LL.forEach(x=>{let b=[x[0]*f[0]+o[0],x[1]*f[1]+o[1]];n.push(Mt.apply(b,y))})},ec=class{constructor(){this.matrix=Mt.identity(),this.min=[1/0,1/0],this.max=[-1/0,-1/0],this.vertices=[],this.edges=[]}setFromObjectSize(r,a=!1){r.updateWorldMatrix(),this.makeEmpty(),Mt.copy(r.worldMatrix,this.matrix);let n=Mt.invert(r.worldMatrix);this.expandByObjectSize(r,n,a)}expandByObjectSize(r,a,n=!1){let o=[];n===!0&&r instanceof Ji?r.traverse(f=>{f.visible&&RL(f,a,o)}):RL(r,a,o),this.setFromPoints(o)}setFromSize(r,a,n){this.makeEmpty(),Mt.copy(n,this.matrix),this.expandBySize(r,a,n)}expandBySize(r,a,n){[Mt.apply([0,0],n),Mt.apply([0,a],n),Mt.apply([r,a],n),Mt.apply([r,0],n)].forEach(o=>this.expandByPoint(o))}getCenter(){let[r,a]=this.min,[n,o]=this.getHalfSize();return Mt.apply([r+n,a+o],this.matrix)}getSize(){return[this.max[0]-this.min[0],this.max[1]-this.min[1]]}getHalfSize(){return[(this.max[0]-this.min[0])*.5,(this.max[1]-this.min[1])*.5]}makeEmpty(){this.min=[1/0,1/0],this.max=[-1/0,-1/0]}setFromPoints(r){this.makeEmpty();for(let a of r)this.expandByPoint(a)}expandByPoint(r){this.min=[Math.min(this.min[0],r[0]),Math.min(this.min[1],r[1])],this.max=[Math.max(this.max[0],r[0]),Math.max(this.max[1],r[1])]}computeVertices(){let[r,a]=this.getHalfSize(),n=this.getCenter(),[o,f,y,x]=Mt.getAbcdef(this.matrix),b=Mt.create(o,f,y,x,n[0],n[1]);this.vertices=LL.map(([_,S])=>Mt.apply([_*r,S*a],b))}computeEdges(){this.edges=[];for(let r=0,a=this.vertices.length;r<a;++r)this.edges.push([this.vertices[r],this.vertices[(r+1)%a]])}project(r,a){let n=this.matrix;return a&&(n=Mt.append(a.worldMatrix,n)),Mt.applyInverse(r,n)}intersects(r,a,n){return this.intersectsInLocalSpace(...this.project([r,a],n))}intersectsInLocalSpace(r,a){let{min:n,max:o}=this;return r>=n[0]&&r<=o[0]&&a>=n[1]&&a<=o[1]}containsPoint(r){let[a,n]=r,[o,f]=this.min,[y,x]=this.max;return a>=o&&a<=y&&n>=f&&n<=x}intersectsBBox2D(r){for(let a=0,n=this.edges.length;a<n;a++){let o=this.edges[a];for(let f=0,y=r.edges.length;f<y;f++){let x=r.edges[f];if(fZ(o,x))return!0}}for(let a=0,n=r.vertices.length;a<n;a++){let o=r.vertices[a];if(this.containsPoint(o))return!0}return!1}ensureMinMax(){let r=this.min,a=this.max;this.min=[Math.min(r[0],a[0]),Math.min(r[1],a[1])],this.max=[Math.max(r[0],a[0]),Math.max(r[1],a[1])]}copy(r){this.min=[...r.min],this.max=[...r.max],Mt.copy(r.matrix,this.matrix),this.computeVertices(),this.computeEdges()}clone(){let r=new ec;return r.copy(this),r}},FL=new Promise(r=>{}),gt,dT;async function pZ(r){let a=await FL;gt||(dT||(dT=a({locateFile:()=>r})),gt=await dT)}var UL=Mt.identity(),Qm=class{constructor(r,a=1){this.canvas=r,this._dpr=a,this._width=0,this._height=0,this._strokeMode="inside",this._layerBlur=0,this._backgroundBlur=0,this._dropShadowBlur=0,this._dropShadowOffsetX=0,this._dropShadowOffsetY=0,this._dropShadowColor=Tt.transparent,this._innerShadowBlur=0,this._innerShadowOffsetX=0,this._innerShadowOffsetY=0,this._innerShadowSpread=0,this._innerShadowColor=Tt.transparent,this._fonts=new Map,this._isSizeDirty=!1;try{let n=r.getBoundingClientRect();r.width=n.width*a,r.height=n.height*a}catch{console.log(r.width,a)}this._currentM3Transform=UL,this._currentTransform=new Float32Array(UL)}get dpr(){return this._dpr}set dpr(r){this._dpr=r,this._isSizeDirty=!0}async init(){var r,a;if(!this.wasmURL)throw Error("Your must set the wasm binary url with renderer.wasmURL = ... before you can call renderer.init");await pZ(this.wasmURL),this._surface=gt.MakeWebGLCanvasSurface(this.canvas),this.ctx=(r=this._surface)==null?void 0:r.getCanvas(),this._paint=new gt.Paint,this._paint.setAntiAlias(!0),this._paintFill=this._paint.copy(),this._paintFill.setStyle(gt.PaintStyle.Fill),this._paintStroke=this._paint.copy(),this._paintStroke.setStyle(gt.PaintStyle.Stroke),(a=this.ctx)==null||a.scale(this.dpr,this.dpr)}get currentTransform(){return this._currentM3Transform}get currentTransformBuffer(){return this._currentTransform}set currentTransform(r){this._currentM3Transform=r,this._currentTransform.set(r)}async loadFont(r,a){let n=await(await fetch(r)).arrayBuffer();this.registerFont(n,a)}registerFont(r,a){if(this._fonts.has(a))return;let n=gt.FontMgr.FromData(r);if(n)this._fonts.set(a,n);else throw new Error("Invalid font data for "+a)}get width(){return this._width}get height(){return this._height}set strokeColor(r){this._paintStroke&&this._paintStroke.setColor(ib(r),gt.ColorSpace.DISPLAY_P3)}set fillColor(r){this._paintFill&&this._paintFill.setColor(ib(r),gt.ColorSpace.DISPLAY_P3)}set lineWidth(r){this._paintStroke&&this._paintStroke.setStrokeWidth(this._strokeMode==="center"?r:r*2)}set strokeMode(r){this._strokeMode=r}set dropShadowBlur(r){this._dropShadowBlur=r}set dropShadowColor(r){this._dropShadowColor=r}set dropShadowOffsetX(r){this._dropShadowOffsetX=r}set dropShadowOffsetY(r){this._dropShadowOffsetY=r}set innerShadowBlur(r){this._innerShadowBlur=r}set innerShadowColor(r){this._innerShadowColor=r}set innerShadowOffsetX(r){this._innerShadowOffsetX=r}set innerShadowOffsetY(r){this._innerShadowOffsetY=r}set innerShadowSpread(r){this._innerShadowSpread=r}set layerBlur(r){this._layerBlur=r}set backgroundBlur(r){this._backgroundBlur=r}clear(){var r;(r=this.ctx)==null||r.clear(gt.TRANSPARENT)}save(){var r;(r=this.ctx)==null||r.save()}restore(){var r;(r=this.ctx)==null||r.restore()}beginPath(){var r;(r=this._currentPath)==null||r.delete(),this._currentPath=new gt.Path}closePath(){let r=this._currentPath;if(r){if(r.isEmpty())return;let a=r.getBounds();(a[3]-a[1]||a[2]-a[0])&&r.close()}}fill(){this._paintInner(this._paintFill,!0)}stroke(){this._paintInner(this._paintStroke,!1)}clipRect(r,a,n,o,f=0,y=0,x=0,b=0){var S,A;let _=gt.XYWHRect(r,a,n,o);if(f===0&&y===0&&b===0&&x===0)(S=this.ctx)==null||S.clipRect(_,gt.ClipOp.Intersect,!0);else{let C=gt.RRectXY(_,f,f);C[4]=C[5]=f,C[6]=C[7]=y,C[8]=C[9]=x,C[10]=C[11]=b,(A=this.ctx)==null||A.clipRRect(C,gt.ClipOp.Intersect,!0)}}_applyShadowOffsetMatrix(){if(this.ctx){let r=Mt.invert(this.currentTransform);this.ctx.concat(r);let a=Mt.translate(Mt.identity(),this._dropShadowOffsetX,this._dropShadowOffsetY);this.ctx.concat(a),this.ctx.concat(this._currentTransform)}}_applyEffectsToPaint(r,a,n=!0){var o,f,y,x;if(this.ctx&&this._currentPath){let b,_=!1;if(n&&this._hasDropShadow()){let S=r.copy();S.setColor(ib(this._dropShadowColor));let A;this._dropShadowBlur>0&&(A=gt.MaskFilter.MakeBlur(gt.BlurStyle.Normal,this._dropShadowBlur*this.dpr*(((o=this.camera)==null?void 0:o.scale)??1),!1),S.setMaskFilter(A)),this.ctx.save(),this.ctx.clipPath(this._currentPath,gt.ClipOp.Difference,!0),this._applyShadowOffsetMatrix(),a(S),this.ctx.restore(),S.delete(),A==null||A.delete()}if(this._backgroundBlur>0&&n){this.ctx.save(),this.ctx.clipPath(this._currentPath,gt.ClipOp.Intersect,!0);let S=gt.ImageFilter.MakeBlur(this._backgroundBlur,this._backgroundBlur,gt.TileMode.Clamp,null),A=r.copy();A.setImageFilter(S),A.setAlphaf(1);let C=this._currentPath.computeTightBounds();this.ctx.saveLayer(A,C,null,gt.SaveLayerInitWithPrevious),this.ctx.drawColor(r.getColor()),this.ctx.restore(),this.ctx.restore(),A.delete(),S.delete(),_=!0}if(this._layerBlur>0){let S=r.copy();b=gt.MaskFilter.MakeBlur(gt.BlurStyle.Normal,this._layerBlur*this.dpr*(((f=this.camera)==null?void 0:f.scale)??1),!1),S.setMaskFilter(b),a(S),S.delete(),b.delete(),_=!0}if(_||a(r),n&&this._hasInnerShadow()){let S=new gt.Paint;S.setAntiAlias(!0),S.setStyle(gt.PaintStyle.Fill),S.setColor(ib(this._innerShadowColor));let A;this._innerShadowBlur>0&&(A=gt.MaskFilter.MakeBlur(gt.BlurStyle.Normal,this._innerShadowBlur*this.dpr*(((y=this.camera)==null?void 0:y.scale)??1),!1),S.setMaskFilter(A));let C=this._currentPath.computeTightBounds(),[P,T,M,O]=C,I=M-P,D=O-T;this.ctx.save(),this.ctx.clipPath(this._currentPath,gt.ClipOp.Intersect,!0),this.ctx.saveLayer(S,C,null,gt.SaveLayerInitWithPrevious),(x=this.ctx)==null||x.translate(this._innerShadowOffsetX,this._innerShadowOffsetY),this.ctx.drawRect(gt.XYWHRect(-1e3-this._innerShadowOffsetX,-1e3-this._innerShadowOffsetY,2e3+I+Math.abs(this._innerShadowOffsetX*2),2e3+D+Math.abs(this._innerShadowOffsetY*2)),S),S.setBlendMode(gt.BlendMode.Clear),this.ctx.drawPath(this._currentPath,S),this.ctx.restore(),this.ctx.restore(),S.delete(),A==null||A.delete()}}}_paintInner(r,a=!0){if(this.ctx&&this._currentPath&&r){let n=this.ctx,o=this._currentPath;this._applyEffectsToPaint(r,f=>{let y=!1;!a&&this._strokeMode!=="center"&&(n.save(),n.clipPath(o,this._strokeMode==="outside"?gt.ClipOp.Difference:gt.ClipOp.Intersect,!0),y=!0),n.drawPath(o,f),y&&n.restore()},a)}}_hasDropShadow(){var r;return((r=this._dropShadowColor)==null?void 0:r.a)>0}_hasInnerShadow(){var r;return((r=this._innerShadowColor)==null?void 0:r.a)>0}path(r){var a;(a=this._currentPath)==null||a.addPath(gt.Path.MakeFromSVGString(r))}ellipse(r,a,n,o,f,y,x,b){var S;if(!zL([r,a,n,o])||!this._currentPath)return;if(n<0||o<0)throw Error("radii cannot be negative");let _=gt.XYWHRect(r-n,a-o,n*2,o*2);(S=this._currentPath)==null||S.addOval(_)}rect(r,a,n,o,f=0,y=0,x=0,b=0){var S,A;let _=gt.XYWHRect(r,a,n,o);if(zL(_))if(f===0&&y===0&&b===0&&x===0)(S=this._currentPath)==null||S.addRect(_);else{let C=gt.RRectXY(_,f,f);C[4]=C[5]=f,C[6]=C[7]=y,C[8]=C[9]=x,C[10]=C[11]=b,(A=this._currentPath)==null||A.addRRect(C)}}getHorizontalAlign(r){switch(r){case 2:return gt.TextAlign.Right;case 3:return gt.TextAlign.Center;case 4:return gt.TextAlign.Justify;case 1:default:return gt.TextAlign.Left}}drawTextInner(r,a,n,[o,f,y,x],b,_,S=!0){let A=0,{ctx:C}=this;if(!C)return A;let P=_.copy(),T=_.copy();return T.setAlphaf(0),this._applyEffectsToPaint(P,M=>{a.pushPaintStyle(n,M,T),a.addText(r);let O=a.build();O.layout(y);let I=f;b===2?I+=(x-O.getHeight())/2:b===3&&(I+=x-O.getHeight()),C.drawParagraph(O,o,I),A=O.getHeight(),a.reset(),O.delete()},S),P.delete(),T.delete(),A}drawText(r,a){let n=0,o=this._fonts.get(a.font),{ctx:f,_paintFill:y,_paintStroke:x}=this;if(o&&f){let b=new gt.TextStyle({fontFamilies:[a.font],fontSize:a.fontSize,heightMultiplier:a.lineHeight,letterSpacing:a.letterSpacing}),_=new gt.ParagraphStyle({textStyle:b,textAlign:this.getHorizontalAlign(a.horizontalAlign)}),S=gt.XYWHRect(a.x,a.y,a.width,a.height),A=gt.ParagraphBuilder.Make(_,o);y&&(n=this.drawTextInner(r,A,b,S,a.verticalAlign,y,!0)),x&&(n=this.drawTextInner(r,A,b,S,a.verticalAlign,x,!1)),A.delete()}return{height:n}}render(){var r;(r=this._surface)==null||r.flush()}moveTo(r,a){var n;(n=this._currentPath)==null||n.moveTo(r,a)}lineTo(r,a){var n;(n=this._currentPath)==null||n.lineTo(r,a)}bezierCurveTo(r,a,n,o,f,y){var x;(x=this._currentPath)==null||x.cubicTo(r,a,n,o,f,y)}quadraticCurveTo(r,a,n,o){var f;(f=this._currentPath)==null||f.quadTo(r,a,n,o)}setTransform(r,a=!1){var f,y,x,b,_;if(!this.ctx)return;let n=this.ctx.getTotalMatrix(),o=Mt.invert(n);if(o&&this.ctx.concat(o),(f=this.ctx)==null||f.scale(this.dpr,this.dpr),((y=this.camera)==null?void 0:y.enabled)&&((x=this.ctx)==null||x.concat(this.camera.worldMatrix),a)){let S=Mt.getScale(this.camera.worldMatrix);(b=this.ctx)==null||b.scale(1/S[0],1/S[1])}(_=this.ctx)==null||_.concat(r),this.currentTransform=r}transform(r){var a;(a=this.ctx)==null||a.concat(r)}setSize(r,a){var n;!this._isSizeDirty&&r===this._width&&a===this._height||(this._isSizeDirty=!1,this._width=r,this._height=a,this.canvas.style.width=r+"px",this.canvas.style.height=a+"px",this.canvas.width=r*this.dpr,this.canvas.height=a*this.dpr,this._surface&&(this._surface=gt.MakeWebGLCanvasSurface(this.canvas),this.ctx=(n=this._surface)==null?void 0:n.getCanvas()))}};function zL(r){for(let a=0;a<r.length;a++)if(r[a]!==void 0&&!Number.isFinite(r[a]))return!1;return!0}function ib({r,g:a,b:n,a:o}){return gt.Color4f(r,a,n,o)}var Zm=class{constructor(r,a,n){this.uuid=r,this.data=a,this.enabled=!1,this.color=Tt.transparent,this.blurRadius=0,this.offset=[0,0],this.spread=0,this.update(a)}update(r){r.color!==void 0&&(this.color=r.color),r.enabled!==void 0&&(this.enabled=r.enabled),r.blurRadius!==void 0&&(this.blurRadius=r.blurRadius),r.offset!==void 0&&(this.offset=r.offset),r.spread!==void 0&&(this.spread=r.spread)}},Jm=class{constructor(r,a,n){this.uuid=r,this.data=a,this.enabled=!1,this.radius=0,this.update(a)}update(r){r.enabled!==void 0&&(this.enabled=r.enabled),r.radius!==void 0&&(this.radius=r.radius)}},nb=class{constructor(r,a,n){this.uuid=r,this.data=a,this.enabled=!1,this.color=Tt.transparent,this.update(a)}update(r){r.enabled!==void 0&&(this.enabled=r.enabled),r.color!==void 0&&(this.color=r.color)}},sb=class{constructor(r,a,n){this.uuid=r,this.data=a,this.enabled=!1,this.color=Tt.transparent,this.thickness=0,this.mode="inside",this.update(a)}update(r){r.enabled!==void 0&&(this.enabled=r.enabled),r.color!==void 0&&(this.color=r.color),r.thickness!==void 0&&(this.thickness=r.thickness),r.mode!==void 0&&(this.mode=r.mode)}},Tr=class extends nr{constructor(r,a,n){super(r,a,n),this.uuid=r,this.data=a,this.autoClose=!0,this.fill=new nb(r+"-fill",a.fill,n),this.stroke=new sb(r+"-stroke",a.stroke,n),this.dropShadow=new Zm(r+"-dropShadow",a.dropShadow,n),this.innerShadow=new Zm(r+"-innerShadow",a.innerShadow,n),this.backgroundBlur=new Jm(r+"-backgroundBlur",a.backgroundBlur,n),this.layerBlur=new Jm(r+"-layerBlur",a.layerBlur,n)}applyFillStroke(r){r.fillColor=this.fill.enabled?this.fill.color:Tt.transparent,r.strokeColor=this.stroke.enabled&&this.stroke.thickness>0?this.stroke.color:Tt.transparent,r.strokeMode=this.stroke.mode,r.lineWidth=this.stroke.thickness}applyFilters(r){this.layerBlur.enabled?r.layerBlur=this.layerBlur.radius*5:r.layerBlur=0,this.backgroundBlur.enabled?r.backgroundBlur=this.backgroundBlur.radius*5:r.backgroundBlur=0,this.dropShadow.enabled?(r.dropShadowBlur=this.dropShadow.blurRadius*5,r.dropShadowColor=this.dropShadow.color,r.dropShadowOffsetX=this.dropShadow.offset[0],r.dropShadowOffsetY=this.dropShadow.offset[1]):r.dropShadowColor=Tt.transparent,this.innerShadow.enabled?(r.innerShadowSpread=this.innerShadow.spread,r.innerShadowBlur=this.innerShadow.blurRadius*5,r.innerShadowColor=this.innerShadow.color,r.innerShadowOffsetX=this.innerShadow.offset[0],r.innerShadowOffsetY=this.innerShadow.offset[1]):r.innerShadowColor=Tt.transparent}innerDraw(r){}draw(r){!this.visible||(r.save(),this.applyTransforms(r),this.applyFilters(r),this.applyFillStroke(r),r.beginPath(),this.innerDraw(r),this.autoClose&&r.closePath(),this.fill.enabled&&r.fill(),this.stroke.enabled&&r.stroke(),r.restore())}updateByPatchedOp(r,a,n){super.updateByPatchedOp(r,a,n),r.type===0&&(Vt(r.path,["fill"])?this.fill.update(r.props):Vt(r.path,["stroke"])?this.stroke.update(r.props):Vt(r.path,["dropShadow"])?this.dropShadow.update(r.props):Vt(r.path,["innerShadow"])?this.innerShadow.update(r.props):Vt(r.path,["layerBlur"])?this.layerBlur.update(r.props):Vt(r.path,["backgroundBlur"])?this.backgroundBlur.update(r.props):this.resetBBoxNeedsUpdate())}updateState(r,a){super.updateState(r,a),r.fill!==void 0&&this.fill.update(r.fill),r.stroke!==void 0&&this.stroke.update(r.stroke),r.dropShadow!==void 0&&this.dropShadow.update(r.dropShadow),r.innerShadow!==void 0&&this.innerShadow.update(r.innerShadow),r.layerBlur!==void 0&&this.layerBlur.update(r.layerBlur),r.backgroundBlur!==void 0&&this.backgroundBlur.update(r.backgroundBlur)}clone(r){let a=new Tr(this.uuid,this.data,r);return a.parent=void 0,a}},tc=class extends Tr{constructor(r,a,n){super(r,a,n),this.uuid=r,this.data=a,this.width=0,this.height=0,this.updateState(a,n)}innerDraw(r){r.ellipse(this.width*.5,this.height*.5,this.width*.5,this.height*.5,0,0,Math.PI*2)}intersectsInLocalSpace(r,a){return DL(r,a,this.width*.5,this.height*.5,this.width*.5,this.height*.5)}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateSizeState(r){let a=!1;r.width!==void 0&&(this.width=typeof r.width=="number"?r.width:this.width,a=!0),r.height!==void 0&&(this.height=typeof r.height=="number"?r.height:this.height,a=!0),a&&this.updateWorldMatrix(!0,!1,!0)}updateState(r,a){super.updateState(r,a),this.updateSizeState(r)}clone(r){let a=new tc(this.uuid,this.data,r);return a.parent=void 0,a}},Ms=class extends Tr{constructor(r,a,n){super(r,a,n),this.uuid=r,this.data=a,this.width=0,this.height=0,this.cornerRadius=[0,0,0,0],this.updateState(a,n)}innerDraw(r){r.rect(0,0,this.width,this.height,...this.cornerRadius)}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateCornerState(r){r.cornerRadius!==void 0&&(this.cornerRadius=r.cornerRadius)}updateSizeState(r){let a=!1;r.width!==void 0&&(this.width=typeof r.width=="number"?r.width:this.width,a=!0),r.height!==void 0&&(this.height=typeof r.height=="number"?r.height:this.height,a=!0),a&&this.updateWorldMatrix(!0,!1,!0)}updateState(r,a){super.updateState(r,a),this.updateSizeState(r),this.updateCornerState(r)}clone(r){let a=new Ms(this.uuid,this.data,r);return a.parent=void 0,a}},rc=class extends Tr{constructor(r,a,n){super(r,a,n),this.uuid=r,this.data=a,this._textHeight=0,this._textHeightDirty=!0,this.width=0,this.height=0,this.updateState(a,n)}get textHeight(){return this._textHeight}applyFillStroke(r){r.fillColor=this.fill.enabled?this.fill.color:Tt.transparent,r.strokeColor=this.stroke.enabled&&this.stroke.thickness>0?this.stroke.color:Tt.transparent,r.strokeMode="center",r.lineWidth=this.stroke.thickness}innerDraw(r){var y;(y=this._fontHolder)!=null&&y.arrayBuffer&&this._fontHolder.arrayBuffer.byteLength>1&&this.data.font&&r.registerFont(this._fontHolder.arrayBuffer,this.data.font);let a=this.data.textTransform,n=this.data.text.textValue.toString(),o=a===2?n.toUpperCase():a===3?n.toLowerCase():n,{height:f}=r.drawText(o,{x:0,y:0,width:this.width,height:this.height,fontSize:this.data.fontSize,lineHeight:this.data.lineHeight??1,letterSpacing:this.data.letterSpacing??0,horizontalAlign:this.data.horizontalAlign,verticalAlign:this.data.verticalAlign,font:this.data.font});this._textHeight=f}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateSizeState(r){let a=!1;r.width!==void 0&&(this.width=typeof r.width=="number"?r.width:this.width,a=!0),r.height!==void 0&&(this.height=typeof r.height=="number"?r.height:this.height,a=!0),a&&this.updateWorldMatrix(!0,!1,!0)}updateFontState(r,{shared:a}){r.font!==void 0&&(this._fontHolder=a.getFont(r.font),this._fontHolder&&!this._fontHolder.isLoaded&&this._fontHolder.loadingPromise.then(()=>{this.requestRender()}))}updateState(r,a){super.updateState(r,a),this.updateSizeState(r),this.updateFontState(r,a)}clone(r){let a=new rc(this.uuid,this.data,r);return a.parent=void 0,a}},Of=class extends Tr{constructor(r,a,n){super(r,a,n),this.uuid=r,this.data=a,this.curves=[],this.extremasBBox={min:[0,0],max:[0,0]},this.updateState(a,n)}computeExtremas(){this.curves.length===0&&this.computeCurves();let r=this.curves.map(o=>ob.extremas(o)),a=[1/0,1/0],n=[-1/0,-1/0];for(let o=0,f=r.length;o<f;o++){let y=r[o];y[0][0]<a[0]&&(a[0]=y[0][0]),y[0][1]<a[1]&&(a[1]=y[0][1]),y[1][0]>n[0]&&(n[0]=y[1][0]),y[1][1]>n[1]&&(n[1]=y[1][1])}return this.extremasBBox.min=[a[0],a[1]],this.extremasBBox.max=[n[0],n[1]],this.extremasBBox}computeCurves(){this.curves=[];for(let n=1,o=this.data.points.length;n<o;n++){let f=this.data.points[n].data,y=this.data.points[n-1].data,x={start:y.position,cp1:y.controlNext.position,cp2:f.controlPrevious.position,end:f.position};this.curves.push(x)}let r=this.data.points[0].data,a=this.data.points[this.data.points.length-1].data;if(this.data.isClosed){let n={start:a.position,cp1:a.controlNext.position,cp2:r.controlPrevious.position,end:r.position};this.curves.push(n)}}getCenter(){let[r,a]=this.extremasBBox.min,[n,o]=this.getHalfSize();return[r+n,a+o]}getHalfSize(){let{min:r,max:a}=this.extremasBBox;return[(a[0]-r[0])*.5,(a[1]-r[1])*.5]}innerDraw(r){for(let o=0,f=this.data.points.length;o<f;o++){let y=this.data.points[o].data;if(o===0){let[x,b]=y.position;r.moveTo(x,b)}else{let x=this.data.points[o-1].data,[b,_]=x.controlNext.position,[S,A]=y.controlPrevious.position,[C,P]=y.position,T={start:x.position,cp1:x.controlNext.position,cp2:y.controlPrevious.position,end:y.position};ob.derive(T),r.bezierCurveTo(b,_,S,A,C,P)}}let a=this.data.points[0].data,n=this.data.points[this.data.points.length-1].data;if(this.data.isClosed){let[o,f]=n.controlNext.position,[y,x]=a.controlPrevious.position,[b,_]=a.position;r.bezierCurveTo(o,f,y,x,b,_)}}updateState(r,a){super.updateState(r,a),this.computeExtremas()}clone(r){let a=new Of(this.uuid,this.data,r);return a.parent=void 0,a}},ob;(r=>{function a(x){let b=x.start,_=x.cp1,S=x.cp2,A=x.end,C=[3*(_[0]-b[0]),3*(_[1]-b[1])],P=[3*(S[0]-_[0]),3*(S[1]-_[1])],T=[3*(A[0]-S[0]),3*(A[1]-S[1])],M={start:C,cp:P,end:T};return x.derivative=M,M.derivative=pT.derive(M),M}r.derive=a;function n(x,b,_,S=!1){let A=x-2*b+_;if(A!==0){let C=-Math.sqrt(Math.abs(b*b-x*_)),P=-x+b,T=-(C+P)/A,M=-(-C+P)/A;return[T,M]}else if(b!==_&&A===0)return[(2*b-_)/(2*(b-_))];return[]}function o(x){let b=x.derivative??r.derive(x),_=b.start,S=b.cp,A=b.end;return[n(_[0],S[0],A[0]),n(_[1],S[1],A[1])]}r.droot=o;function f(x){let[b,_]=r.droot(x),S=[x.start[0],x.end[0]],A=[x.start[1],x.end[1]];for(let C of b)S.push(r.compute(x,Math.min(1,Math.max(0,C)))[0]);for(let C of _)A.push(r.compute(x,Math.min(1,Math.max(0,C)))[1]);return S.sort((C,P)=>C-P),A.sort((C,P)=>C-P),[[S[0],A[0]],[S[S.length-1],A[A.length-1]]]}r.extremas=f;function y(x,b){if(b===0)return[...x.start];if(b===1)return[...x.end];let _=1-b,S=_*_,A=b*b,C=S*_,P=S*b*3,T=_*A*3,M=b*A;return[C*x.start[0]+P*x.cp1[0]+T*x.cp2[0]+M*x.end[0],C*x.start[1]+P*x.cp1[1]+T*x.cp2[1]+M*x.end[1]]}r.compute=y})(ob||(ob={}));var pT;(r=>{function a(f){let y=f.start,x=f.cp,b=f.end,_=[2*(x[0]-y[0]),2*(x[1]-y[1])],S=[2*(b[0]-x[0]),2*(b[1]-x[1])],A={start:_,end:S};return A.derivative=mT.derive(A),f.derivative=A,A}r.derive=a;function n(f){let y=f.derivative??r.derive(f),x=y.start,b=y.end;return[x[0]!==b[0]?x[0]/(x[0]-b[0]):0,x[1]!==b[1]?x[1]/(x[1]-b[1]):0]}r.droot=n;function o(f,y){if(y===0)return[...f.start];if(y===1)return[...f.end];let x=1-y,b=x*x,_=y*y,S=b,A=x*y*2,C=_;return[S*f.start[0]+A*f.cp[0]+C*f.end[0],S*f.start[1]+A*f.cp[1]+C*f.end[1]]}r.compute=o})(pT||(pT={}));var mT;(r=>{function a(o){let f=o.start,y=o.end,x=[y[0]-f[0],y[1]-f[1]];return o.derivative=x,o.derivative}r.derive=a;function n(o,f){if(f===0)return[...o.start];if(f===1)return[...o.end];let y=o.start,x=o.end;return[y[0]+(x[0]-y[0])*f,y[1]+(x[1]-y[1])*f]}r.compute=n})(mT||(mT={}));var $i=class extends Ji{constructor(r,a,n){super(r,a,n),this.uuid=r,this.width=0,this.height=0,this.clipped=!0,this.background=new Ms(r+"-background",ad.defaultData,n),this.background.parent=this,this.updateState(a,n)}get fill(){return this.background.fill}get stroke(){return this.background.stroke}get backgroundBlur(){return this.background.backgroundBlur}get layerBlur(){return this.background.layerBlur}get dropShadow(){return this.background.dropShadow}get innerShadow(){return this.background.innerShadow}get cornerRadius(){return this.background.cornerRadius}set cornerRadius(r){this.background.cornerRadius=r}updateLocalMatrix(){var r;super.updateLocalMatrix(),(r=this.background)==null||r.updateLocalMatrix()}updateWorldMatrix(r,a,n){var o;super.updateWorldMatrix(r,a,n),(o=this.background)==null||o.updateWorldMatrix(r,a,n)}draw(r){if(!this.visible)return;r.save();let a=this.width,n=this.height;this.applyTransforms(r),this.background.width=a,this.background.height=n,this.background.draw(r),this.clipped&&r.clipRect(0,0,a,n,...this.cornerRadius),this.innerDrawChildren(r),r.restore()}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateCornerState(r){r.cornerRadius!==void 0&&(this.cornerRadius=r.cornerRadius)}updateSizeState(r){let a=!1;r.width!==void 0&&(this.width=typeof r.width=="number"?r.width:this.width,a=!0),r.height!==void 0&&(this.height=typeof r.height=="number"?r.height:this.height,a=!0),a&&this.updateWorldMatrix(!0,!1,!0)}updateState(r,a){super.updateState(r,a),this.updateSizeState(r),this.updateCornerState(r),r.fill!==void 0&&this.fill.update(r.fill),r.stroke!==void 0&&this.stroke.update(r.stroke),r.dropShadow!==void 0&&this.dropShadow.update(r.dropShadow),r.innerShadow!==void 0&&this.innerShadow.update(r.innerShadow),r.layerBlur!==void 0&&this.layerBlur.update(r.layerBlur),r.backgroundBlur!==void 0&&this.backgroundBlur.update(r.backgroundBlur),r.clipped!==void 0&&(this.clipped=r.clipped)}requestRender(){super.requestRender(),this.dispatchEvent({type:"render"})}dispose(){this.removeEventListener("render")}updateByPatchedOp(r,a,n){super.updateByPatchedOp(r,a,n),r.type===0&&(Vt(r.path,["fill"])?this.fill.update(r.props):Vt(r.path,["stroke"])?this.stroke.update(r.props):Vt(r.path,["dropShadow"])?this.dropShadow.update(r.props):Vt(r.path,["innerShadow"])?this.innerShadow.update(r.props):Vt(r.path,["layerBlur"])?this.layerBlur.update(r.props):Vt(r.path,["backgroundBlur"])?this.backgroundBlur.update(r.props):this.resetBBoxNeedsUpdate())}clone(r){let a=new $i(this.uuid,this.data,r);a.parent=void 0;for(let n of this.children)a.add(n.clone(r));return a}},HL=Za(gT(),1),ja=class extends Tr{constructor(r,a,n){super(r,a,n),this.uuid=r,this.data=a,this._pathBBox=new DOMRect,this.path="",this.updateState(a,n),this.autoClose=!1,this.computeSVGBBox()}computeSVGBBox(){let r=document.createElementNS("http://www.w3.org/2000/svg","svg"),a=document.createElementNS("http://www.w3.org/2000/svg","path");document.body.appendChild(r),a.setAttribute("d",this.path),r.appendChild(a),this._pathBBox=a.getBBox(),r.remove()}innerDraw(r){r.path(this.path)}intersectsInLocalSpace(r,a){return r>=this._pathBBox.x&&r<=this._pathBBox.x+this._pathBBox.width&&a>=this._pathBBox.y&&a<=this._pathBBox.y+this._pathBBox.height}getCenter(){return[(this._pathBBox.x+this._pathBBox.width)/2,(this._pathBBox.y+this._pathBBox.height)/2]}getHalfSize(){return[(this._pathBBox.x+this._pathBBox.width)/2,(this._pathBBox.y+this._pathBBox.height)/2]}updateState(r,a){super.updateState(r,a),r.path!==void 0&&(this.path=r.path,this.computeSVGBBox())}clone(r){let a=new ja(this.uuid,this.data,r);return a.parent=void 0,a}};function WL(r,a=1,n=1){if(a<=0||n<=0)return r;let o=(0,HL.parseSVG)(r).map(f=>{let y={...f};return"x"in y&&(y.x=y.x*a),"y"in y&&(y.y=y.y*n),"x1"in y&&(y.x1=y.x1*a),"x2"in y&&(y.x2=y.x2*a),"y1"in y&&(y.y1=y.y1*n),"y2"in y&&(y.y2=y.y2*n),"rx"in y&&(y.rx=y.rx*a),"ry"in y&&(y.ry=y.ry*n),y});return qL(o)}function qL(r){let a=["rx","ry","xAxisRotation","largeArc","sweep","x1","y1","x2","y2","x","y"],n;return r.map(o=>{let f=[];a.forEach(x=>{if(x in o){let b=o[x]*1;f.length&&b>=0&&f.push(","),f.push(b)}});let y=(n===o.code?f[0]<0?"":",":o.code)+f.join("");return n=o.code,y}).join("")}function XL(r,a,n){switch(a.type){case"ellipse2d":return new tc(r,a,n);case"rectangle2d":return new Ms(r,a,n);case"text2d":return new rc(r,a,n);case"vector2d":return new Of(r,a,n);case"path2d":return new ja(r,a,n);case"frame2d":return new $i(r,a,n);case"group2d":default:return new kn(r,a,n)}}var yT=class{constructor(r,a,n){this.uuid=r,this.data=a,this.group=new kn(yT.GROUP_ID,{...sm.defaultData},n),this.createChildrenObjects(a.objects,this.group,n)}createObject(r,a,n,o,f,y){let x=XL(r,a,y);x&&(o.add(x),o.children.splice(f,0,o.children.pop()),x.updateWorldMatrix(),n.length>0&&(x instanceof kn||x instanceof $i)&&this.createChildrenObjects(n,x,y))}createChildrenObjects(r,a,n){let o=0;for(let f of r)this.createObject(f.id,f.data,f.children,a,o,n),o+=1}draw(r){this.group.draw(r)}updateEntityByOp(r,a,n,o){let f=this.find(r);if(f)try{f.updateByOp(a,n,{shared:o})}catch(y){console.error(y)}}updateTreeByOp(r,a){if(r.path.length===0&&r.type===7){let n=r.parent===null?this.group:this.find(r.parent);n!==void 0&&n instanceof Ji&&(this.createObject(r.id,r.data,r.children,n,r.localIndex,a),n.requestRender())}else if(r.path.length===0&&r.type===8){let n=this.find(r.id);if(n!==void 0&&n.parent!==void 0&&n.parent instanceof Ji){let o=n.parent;n.resetBBoxNeedsUpdate(),o==null||o.remove(n),o==null||o.requestRender()}}else if(r.path.length===0&&r.type===9){let n=this.find(r.id);if(n!==void 0){let o=n.parent,f=r.parent===null?this:this.find(r.parent);if(f instanceof Ji||f===this){f.add(n);let y=r.localIndex;f.children.splice(y,0,f.children.pop()),n.updateWorldMatrix(!0,!1,!0),o==null||o.requestRender(),n.requestRender()}n.resetBBoxNeedsUpdate()}}}add(r){this.group.add(r)}remove(r){this.group.remove(r)}traverse(r){this.group.traverse(a=>{a!==this.group&&r(a)})}intersectsChildren(r,a,n,o=!1,f=[]){return this.group.intersectsChildren(r,a,n,o,f,!0)}intersectsChildrenReverse(r,a,n,o=!1,f=[]){return this.group.intersectsChildrenReverse(r,a,n,o,f,!0)}find(r){return this.group.find(r)}get children(){return this.group.children}project(r,a){return this.group.project(r,a)}getWithSortKey(r){let a=this.find(r);if(a===void 0)return;let n=[],o=a;for(;o!==this.group;){let f=o;o=o.parent;let y=o.children.indexOf(f);n.splice(0,0,y)}return{entity:a,sortKey:n}}getAllSorted(r){let a=[];for(let n of r){let o=this.getWithSortKey(n.id);o!==void 0&&a.push(o)}return a.sort((n,o)=>Sv(n.sortKey,o.sortKey)),a.map(n=>n.entity)}},cu=yT;cu.GROUP_ID="scene2d";function vT({constraints:r,newParentWidth:a,newParentHeight:n,initialParentWidth:o,initialParentHeight:f,objectInitialWidth:y,objectInitialHeight:x,objectInitialPosition:b}){let{horizontalConstraint:_,verticalConstraint:S}=r,A=a-o,C=n-f,P=y,T=x,M=b[0],O=b[1];if(_!==0){if(_===1)M+=A;else if(_===3)M+=A/2;else if(_===2)P=Math.max(1,P+A);else if(_===4){let I=a/o;P*=I,M*=I}}if(S!==0){if(S===1)O+=C;else if(S===3)O+=C/2;else if(S===2)T=Math.max(1,T+C);else if(S===4){let I=n/f;T*=I,O*=I}}return{width:P,height:T,position:[M,O]}}Za(gT(),1);var bZ=`
	varying vec2 vUv;
	void main() {
		vUv = uv;
		gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
	}`,SZ=`
	uniform sampler2D tDiffuse;
	varying vec2 vUv;
	void main() {
		vec4 texel = texture2D( tDiffuse, vUv );
		gl_FragColor = texel;
	}`,wZ=new ll(-1,1,1,-1,0,1),ST=class extends Ce{constructor(){super(),this.setAttribute("position",new Te([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Te([0,2,0,0,2,0],2))}},AZ=new ST,wT=class{constructor(r){this._mesh=new Et(AZ,r)}dispose(){this._mesh.geometry.dispose()}render(r){r.render(this._mesh,wZ)}get material(){return this._mesh.material}set material(r){this._mesh.material=r}},YL=new Je({defines:{},uniforms:{tDiffuse:new ce(null)},vertexShader:bZ,fragmentShader:SZ}),EZ=new wT(YL),xT=null,bT=null,TZ=()=>(xT===null&&(xT=document.createElement("canvas")),xT),MZ=r=>(bT===null&&(bT=new Qm(r)),bT),CZ=Mt.identity(),Rf=class{constructor(r,a,n,o){this.uuid=r,this.width=a,this.height=n,this.context=o,this.enabled=!0,this.isScreenSpace=!1,this.dpr=window.devicePixelRatio,this.isFrameDirty=!1,this.onRenderRequestedDownstream=()=>{this.isFrameDirty=!0,this.context.shared.requestRender()},this._innerApplySize=()=>{let f=this.width,y=this.height,x=this.dpr;this.renderer.dpr=this.isScreenSpace?x:Math.floor(2048/Math.max(f,y)),this.renderer.setSize(f,y)},this.onFrameOverrideObjectEvent=f=>{var y,x;if(((y=f.target)==null?void 0:y.uuid)!==void 0){let b=(x=this.frameRoot)==null?void 0:x.find(f.target.uuid);b&&b.dispatchEvent({...f,target:b})}},this.scene2d=new cu(we.generateUUID(),b0.defaultData,{dpr:window.devicePixelRatio,shared:o.shared}),this.canvas=TZ(),this.renderer=MZ(this.canvas),this.promise=this.init(),this.renderTarget=new at(1,1,{type:Xn,stencilBuffer:!1,depthBuffer:!1}),o.shared.addUIBuffer(this.uuid,this.renderTarget),this.textureHolder=o.shared.uiBuffer(this.uuid)}get canvasTexture(){return this._canvasTexture||(this._canvasTexture=new My(this.canvas)),this._canvasTexture}async init(){this.renderer instanceof Qm&&(this.renderer.wasmURL=ox.skiaWasmUrl),await this.renderer.init()}render(r){var a,n;if(this.isFrameDirty){this.isFrameDirty=!1,this._innerApplySize(),this.renderer.clear(),(a=this.frameOverride)==null||a.draw(this.renderer),this.renderer.render(),YL.uniforms.tDiffuse.value=this.canvasTexture,this.canvasTexture.needsUpdate=!0;let o=r.getRenderTarget();r.setRenderTarget(this.renderTarget),r.clear(),EZ.render(r),r.setRenderTarget(o),(n=this.textureHolder)==null||n.setNeedsUpdate(!0)}}updateEntity2DByOp(r,a,n,o){this.scene2d.updateEntityByOp(r,a,n,o),this.applySize()}updateTreeByOp(r,a){this.scene2d.updateTreeByOp(r,a),this.applySize()}applyOverrides(r){if(this.frameOverride&&this.frameRoot){this.frameOverride.position=[0,0],this.frameOverride.rotation=0;let a=(r==null?void 0:r.width)??this.width,n=(r==null?void 0:r.height)??this.height;this.frameOverride.width=a,this.frameOverride.height=n,this.frameOverride.localMatrix=CZ,this.isScreenSpace&&(this.frameOverride.fill.color=Tt.from0to1([0,0,0,0])),this.frameOverride.data={...this.frameOverride.data,width:a,height:n},KL({objectOverride:this.frameOverride,objectRoot:this.frameRoot,newParentWidth:this.frameOverride.width,newParentHeight:this.frameOverride.height,initialParentWidth:this.frameRoot.width,initialParentHeight:this.frameRoot.height}),this.frameOverride.updateWorldMatrix(!0,!1,!0)}}applySize(r,a=window.devicePixelRatio){var b,_;let n=Math.max(1,(r==null?void 0:r.width)??this.width),o=Math.max(1,(r==null?void 0:r.height)??this.height);this.dpr=a,this.width=n,this.height=o,this._innerApplySize();let f=1,y=512,x=512;(n*a<y||o*a<x)&&(f=Math.max(y/(n*a),x/(o*a))),this.renderTarget.setSize(n*a*f,o*a*f),(b=this._canvasTexture)==null||b.dispose(),this._canvasTexture=void 0,this.applyOverrides(r),(_=this.frameOverride)==null||_.requestRender()}applyFrame(r){var n,o;let a=this.context.scene.find2D(r);if(!(!a||!(a instanceof $i)))return this.disposeFrameOverride(),this.frameRoot=a,this.frameOverride=a.clone({dpr:this.renderer.dpr,shared:this.context.shared}),this.scene2d.add(this.frameOverride),this.applySize(),(n=this.frame)==null||n.addEventListener("render",this.onRenderRequestedDownstream),this.frameOverride.traverse(f=>{f.addEventListener("beginState",this.onFrameOverrideObjectEvent)}),this.frameOverride.traverse(f=>{f.addEventListener("completeState",this.onFrameOverrideObjectEvent)}),(o=this.frame)==null||o.requestRender(),a}get frame(){return this.frameOverride}get frameId(){var r;return(r=this.frame)==null?void 0:r.uuid}find(r){return this.scene2d.find(r)}get texture(){var r;return(r=this.textureHolder)==null?void 0:r.getTexture(1001)}disposeFrameOverride(){var r,a,n;(r=this.frameOverride)==null||r.removeEventListener("render",this.onRenderRequestedDownstream),(a=this.frameOverride)==null||a.traverse(o=>{o.removeEventListener("beginStateChange",this.onFrameOverrideObjectEvent)}),(n=this.frameOverride)==null||n.traverse(o=>{o.removeEventListener("completeState",this.onFrameOverrideObjectEvent)}),this.frameOverride&&this.scene2d.remove(this.frameOverride)}};function KL({objectOverride:r,objectRoot:a,newParentWidth:n,newParentHeight:o,initialParentWidth:f,initialParentHeight:y}){if(r instanceof $i&&a instanceof $i||r instanceof kn&&a instanceof kn)for(let x=0,b=r.children.length;x<b;x++){let _=r.children[x],S=a.children[x];_&&S&&_.uuid===S.uuid&&_Z({objectOverride:_,objectRoot:S,newParentWidth:n,newParentHeight:o,initialParentWidth:f,initialParentHeight:y})}}function PZ(r){if(AT(r))return[r.width,r.height];if(r instanceof ja){let[a,n]=r.getHalfSize();return[a*2,n*2]}else if(r instanceof kn){let[a,n]=r.recursiveBBox.getHalfSize();return[a*2,n*2]}return[0,0]}function _Z({objectOverride:r,objectRoot:a,newParentWidth:n,newParentHeight:o,initialParentWidth:f,initialParentHeight:y}){let[x,b]=PZ(a),{width:_,height:S,position:A}=vT({constraints:r.data,newParentWidth:n,newParentHeight:o,initialParentWidth:f,initialParentHeight:y,objectInitialWidth:x,objectInitialHeight:b,objectInitialPosition:a.position});if(r.position=A,r.data={...r.data,position:A},r.states)for(let C in r.states)IZ({stateId:C,objectOverride:r,objectRoot:a,newParentWidth:n,newParentHeight:o,initialParentWidth:f,initialParentHeight:y});if(AT(r)||r instanceof kn)AT(r)&&(r.width=_,r.height=S,r.data={...r.data,width:_,height:S}),KL({objectOverride:r,objectRoot:a,newParentWidth:_,newParentHeight:S,initialParentWidth:x,initialParentHeight:b});else if(r instanceof ja){let C=a,P=x!==0?_/x:1,T=b!==0?S/b:1;r.path=WL(C.path,P,T),r.data={...r.data,path:r.path}}}function IZ({stateId:r,objectOverride:a,objectRoot:n,newParentWidth:o,newParentHeight:f,initialParentWidth:y,initialParentHeight:x}){var S,A;let b=(S=a.states)==null?void 0:S[r],_=(A=n.states)==null?void 0:A[r];if(b&&_){let{width:C,height:P,position:T}=vT({constraints:a.data,newParentWidth:o,newParentHeight:f,initialParentWidth:y,initialParentHeight:x,objectInitialWidth:Ia.isResizeable(_)?_.width:0,objectInitialHeight:Ia.isResizeable(_)?_.height:0,objectInitialPosition:_.position});Object.assign(a.states[r],{position:T}),Ia.isResizeable(b)&&Object.assign(a.states[r],{width:C,height:P})}}function AT(r){return r instanceof Ms||r instanceof $i||r instanceof tc||r instanceof rc}var hr=class extends Ad(wr){constructor(r,a,n){super(),this.data=a,this.bgColor=new br(1,1,1,1),this.fog=null,this.backupFog=new Hu(16777215,.1,2e3),this.fogUseBGColor=!1,this.isActive=!1,this.aoColor=new qe,this.penumbraSizeArrayCache=null,this.super_Entity(r,a),this.personalCamera=new Er(fs,{...kc.defaultData,...a.camera,name:"Personal Camera"}),this.personalCamera.objectHelper.visible=!1,this.add(this.personalCamera),this.activeCamera=this.personalCamera,this.ambientLight=new Oy(13882323,8553090,.75),this.ambientLight.name="Default Ambient Light",this.ambientLight.layers.enable(3),this.ambientLight.removeFromParent(),this.add(this.ambientLight),a.uiScene?this.uiScene=new cu((Array.isArray(r)?r[0]:r)+"-ui",a.uiScene,{dpr:window.devicePixelRatio,shared:n.shared}):a.uiFrame&&this.createUICanvas(a.uiFrame,n)}get scene(){return this.parent}get postprocessing(){return this.data.postprocessing}get frameId(){return this.data.uiFrame}get frame(){var r;return(r=this.uiCanvas)==null?void 0:r.frame}createUICanvas(r,a){this.uiCanvas=new Rf(this.uuid+"-uiscreen",window.innerWidth,window.innerHeight,a),this.uiCanvas.isScreenSpace=!0,this.uiCanvas.promise.then(()=>{var n,o;(n=this.uiCanvas)==null||n.applyFrame(r),(o=this.uiCanvas)==null||o.applySize()})}updateVisible(){}setBackgroundColor(r){this.bgColor=r,this.fogUseBGColor===!0&&(this.backupFog.color=r)}entityChildrenCount(){return this.uiScene?this.uiScene.children.length:super.entityChildrenCount()}updateAmbientLight(r,a){r.color!==void 0&&(this.ambientLight.color=Zi(r.color,a)),r.intensity!==void 0&&(this.ambientLight.intensity=r.intensity),r.enabled!==void 0&&(r.enabled?this.add(this.ambientLight):this.remove(this.ambientLight))}onDeactive(){this.isActive=!1}onActive(r){this.isActive=!0,r.fog=this.fog,this.traverseEntity(a=>{a instanceof Un&&a.recomputeBoolean()}),this.updateShadow(this.data.shadow)}forceMaterialsUpdate(){this.traverseEntity(r=>{if(r instanceof bs)if(Array.isArray(r.material))for(let a of r.material)a.needsUpdate=!0;else r.material.needsUpdate=!0,r.material.dispose()})}updateShadow(r){r.softShadowQuality!==void 0&&this.isActive&&SL(r.softShadowQuality)&&this.forceMaterialsUpdate()}updateFog(r,a){if(r.enabled?this.fog=this.backupFog:this.fog=null,this.isActive){let n=this.scene;n.fog=this.fog}this.fogUseBGColor=r.useBackgroundColor,r.useBackgroundColor?this.backupFog.color.set(this.bgColor):this.backupFog.color=Zi(r.color,a),this.backupFog.near=r.near,this.backupFog.far=r.far}updateAo(r,a){r.aoColor!==void 0&&(this.aoColor=Zi(r.aoColor,a))}updateByOp(r,a,n,o){let f=this.data.uiFrame;super.updateByOp(r,a,n,o);let y=a;Vt(r.path,["fog"])?this.updateFog(y.fog,n.shared):Vt(r.path,["ao"])?this.updateAo(y.ao,n.shared):Vt(r.path,["ambient"])?this.updateAmbientLight(y.ambient,n.shared):Vt(r.path,["shadow"])?this.updateShadow(y.shadow):r.type===0&&r.path.length===0&&(r.props.uiFrame!==void 0||f!==y.uiFrame)&&this.updateUIFrame(r.props.uiFrame,n)}updateUIFrame(r,a){r?(this.uiCanvas||this.createUICanvas(r,a),this.uiCanvas.enabled=!0,this.uiCanvas.applyFrame(r)):this.uiCanvas&&(this.uiCanvas.enabled=!1)}updateState(r,a){this.updateState_Entity(r,a),r.backgroundColor!==void 0&&this.setBackgroundColor(Zi(r.backgroundColor,a.shared)),r.fog!==void 0&&this.updateFog(r.fog,a.shared),r.ambient!==void 0&&this.updateAmbientLight(r.ambient,a.shared),r.ao!==void 0&&this.updateAo(r.ao,a.shared),r.shadow!==void 0&&this.updateShadow(r.shadow)}createFrame(r,a){}raycast(r,a){super.raycast(r,a)}switchActiveCamera(r){r&&r.isDescendantOf(this)&&(this.activeCamera!==this.personalCamera&&(this.activeCamera.objectHelper.visible=!0),this.activeCamera=r,r.objectHelper.visible=!1)}get playCamera(){var r;return((r=this.scene)==null?void 0:r.find(this.data.publish.playCamera))??this.personalCamera}switchToPlayCamera(){this.switchActiveCamera(this.playCamera)}get penumbraSizeArray(){return this.penumbraSizeArrayCache===null&&this.updatePenumbraSizeArray(),this.penumbraSizeArrayCache}updatePenumbraSizeArray(){this.penumbraSizeArrayCache=new Array(5).fill(.5);let r=0,a=0;this.traverseEntity(n=>{if(!n.visible)return!0;n instanceof If&&n.visible&&r<3&&(this.penumbraSizeArrayCache[r]=n.data.penumbraSize??.5,r+=1),n instanceof Df&&n.visible&&r<2&&(this.penumbraSizeArrayCache[3+a]=n.data.penumbraSize??.5,a+=1)})}raycastWithClones(r){let a=[],n=o=>{for(let f of o.children){let y=f.cloner;mt.is(f)&&(f.visible||y!=null&&y.object.data.visible)&&((un(f)||Hm(f)&&this.scene.enableHelpers&&f.objectHelper.visible)&&(r.intersectObject(f,!1,a),$m(f,r,a,!0)),n(f))}};return n(this),a}updateEntity2DByOp(r,a,n,o){var f;(f=this.uiCanvas)==null||f.updateEntity2DByOp(r,a,n,o)}},lb=class extends ff(Ly,Pf){constructor(r,a,n){super(),this.super_Entity(r,a),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let o=this.shadow.camera;o.fov=90,o.aspect=1,o.near=100,o.far=2500;let f=new E(-o.far+this.position.x,-o.far+this.position.y,-o.far+this.position.z),y=new E(o.far+this.position.x,o.far+this.position.y,o.far+this.position.z),x=new Xt(f,y),b=new vl(x,new qe(16755200));b.visible=!1,this.gizmos.shadowmap=b,this.update()}update(){if(this.shadow&&(this.shadow.camera.updateProjectionMatrix(),this.gizmos))for(let r in this.gizmos){let a=this.gizmos[r];if(a instanceof vl){let n=this.shadow.camera,o=new E(-n.far+this.position.x,-n.far+this.position.y,-n.far+this.position.z),f=new E(n.far+this.position.x,n.far+this.position.y,n.far+this.position.z);a.box.set(o,f),a.updateMatrixWorld(!0)}}}updateMatrixWorld(r){super.updateMatrixWorld(r),this.objectHelper&&this.objectHelper.update()}updateState(r,a){this.updateState_Light(r,a),r.distance!==void 0&&(this.distance=r.distance),r.decay!==void 0&&(this.decay=r.decay),r.shadowRadius!==void 0&&(this.shadow.radius=r.shadowRadius),r.shadowResolution!==void 0&&(this.shadow.mapSize.set(r.shadowResolution,r.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},cb=class extends jt{get forceComputeSize(){return!0}get shape(){return this.geometry.userData.shape}updateEntityBoxSize(r,a){let n=this.geometry.getAttribute("position");n!==void 0?Cm(n,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:n.count,r,a):super.updateEntityBoxSize(r,a)}},ic=class extends jt{constructor(r,a,n){super(r,a,n),this._shapeId=null,this._context=n}updateState(r,a){super.updateState(r,a),this.updateShape(),this.refreshAttachedCloners(a)}updateShape(){var o;let r={...this.data.geometry.extrusion.shape};for(let f in r)typeof r[f]=="string"&&(r[f]=this._context.shared.getVariable(r[f],[this.uuid,"geometry","extrusion","shape",f]));let a;if(r.type==="Custom"){let f=r.shapeId;if(f!==this._shapeId&&this.detachShape(),f){this._shapeId=f;let y=this._context.scene.find(f);y!=null&&y.data&&(y.attachedPaths.add(this),a=(o=y.geometry.userData)==null?void 0:o.shape),a||this._context.scene.addPendingCommand(()=>this.updateShape())}}else{let f;switch(r.type){case"Rectangle":f=Ld;break;case"Ellipse":f=Dd;break;case"Polygon":f=X0;break;case"Star":f=Y0;break;default:throw new Error(`Unknown shape type: ${r.type}`)}a=f.create({parameters:r}).userData.shape}let n=this.geometry;a&&n.inputs&&(n.inputs.shapeData=a,n.build())}detachShape(){var r;this._shapeId!==null&&((r=this._context.scene.find(this._shapeId))==null||r.attachedPaths.delete(this))}createGeometryDelayed(r){this.geometryCreateDeleyed=r.shared,this.updateShape(),this.refreshAttachedPaths(r)}updateTransformState(r,a){return super.updateTransformState(r,a)}updateGeometryInteractions(r,a){super.updateGeometryInteractions(r,a),this.updateShape()}updateEntityBoxSize(r,a){let n=this.geometry.getAttribute("position");n!==void 0?Cm(n,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:n.count,r,a):super.updateEntityBoxSize(r,a)}},nc=class extends Kl{constructor(r,a,n){super(r,a,n),this.data=a}},to=class extends As(on,Es){constructor(r,a,n){super(),a.type==="Instance"&&typeof r=="string"&&(a=this.transformAssignData(a,n)),this.super_Entity(r,a),this.objectHelper.update()}get isComponentRoot(){return this.data.type==="Component"&&typeof this.identity=="string"}get isInstanceRoot(){return this.data.type==="Instance"&&typeof this.identity=="string"}transformAssignData(r,a){let n=td.getComponentData({scene:a.scene.data,shared:a.shared.data},r.component);if(n){let o,f;for(let y of Io.rootOverrideProps)r[y]===void 0?(o===void 0&&(o={...r}),o[y]=n.data[y]):(f===void 0&&(f={}),f[y]=r[y],o===void 0&&(o={...r}),o[y]=wo.apply(n.data[y],r[y]));return this.overrideData=f,o}else return{...si.defaultData,...r,...In(si.defaultData,Io.rootOverrideProps)}}updateByOp(r,a,n,o){let f;if(this.isInstanceRoot&&!o){if(a=this.transformAssignData(a,n),r.type===0&&r.path.length===0&&this.component)for(let y of Io.rootOverrideProps)y in r.props&&r.props[y]===void 0&&(f===void 0&&(f={...r,props:{...r.props}}),f.props[y]=this.component.data[y]);else if(r.type===0&&r.path.length>0&&Io.rootOverrideProps.includes(r.path[0])){let y=r.path[0];f===void 0&&(f={...r,path:[],props:{[y]:a[y]}})}}super.updateByOp(f??r,a,n,o)}updateState(r,a){this.updateState_Entity(r,a)}expandInstanceChildren(r){let a=this.data;if(this.component===void 0){let n=r.scene.find(a.component)??null,o=!1;if(n!==this.oldComponent){if(this.oldComponent){let f=0;for(let y of this.children)if(mt.is(y))r.scene.disposeAndUnregisterEntityRecursivelyIfNotReregistered(y),ub(y),f+=1;else break;this.children.splice(0,f)}o=!0}if(n){let f={};ZL(r,[this.uuid],a.overrides,this,n,n,0,o,f);for(let y of this.children)if(mt.is(y)){let x=y.data;x.type==="Empty"&&x.animations&&y.traverseEntity(b=>{let _=b.dataPatched;if(b instanceof jt&&_.bones&&_.boneInverses){let S=b.dataPatched;if(S.bones&&S.boneInverses){let A=S.bones.map(T=>r.scene.find(f[T])),C=S.boneInverses.map(T=>new ue().fromArray(T)),P=new cl(A,C);b.bind(P,b.bindMatrix)}}else b.matrixAutoUpdate=!0})}}this.oldComponent=this.component}}};function ub(r){if(r.component){let a=r.component.instances.indexOf(r);a>=0&&r.component.instances.splice(a,1);for(let n of r.children)mt.is(n)&&ub(n)}}function QL(r,a,n,o){return r.component===a&&Fc(r.identity,o)?r.overrideData===n?2:1:0}function ZL(r,a,n,o,f,y,x,b,_){if(x>50)return!1;if(o.component!==f){if(o.component){let A=o.component.instances.indexOf(o);A>=0&&o.component.instances.splice(A,1)}f.instances.find(A=>A===o)||f.instances.push(o),o.component=f}f instanceof to&&f.isInstanceRoot&&f.expandInstanceChildren(r);let S=0;for(let A of f.children)if(mt.is(A)){let C=[...a,...typeof A.identity=="string"?[A.identity]:A.identity],P=$h.resolve(n,C,1);P!=null&&!(P instanceof xr)&&(Object.setPrototypeOf(P,xr.prototype),console.error("wrong prototype"));let T=null,M;if(!b){let O=o.children[S];if(T=mt.is(O)?O:null,T!==null){let I=QL(T,A,P,C);M=I>=1?T.stateSelection:void 0,I!==2&&(T=null)}if(T===null&&(T=r.scene.findInstance(C)??null,T!==null)){let I=QL(T,A,P,C);if(M=I>=1?T.stateSelection:void 0,I!==2)T=null;else{let D=T.parent.children.indexOf(T);T.parent.children.splice(D,1),o.children.splice(S,0,T),T.parent===o?D<=S&&console.error("not possible"):(T.parent=o,T.matrixWorldNeedsUpdate=!0,T.resetBBoxNeedsUpdate(),T.updateVisible(),r.pendingDeletes.delete(T))}}}if(T===null){let O=P?wo.apply(A.data,P):A.data;ks.is(O.type)&&(O={...O,type:"Empty"}),T=Ws.createEntity(C,O,r),T.overrideData=P,o.add(T),o.children.splice(o.children.length-1,1),o.children.splice(S,0,T),T.updateState(T.data,r),M&&T.changeSelectedState(M,r),r.scene.registerInstanceAndSetUuid(T)}if(T.isBone){let O=T.identity[T.identity.length-1];_[O]=T.uuid}S+=1,ZL(r,a,n,T,A,y,x+1,b,_)}if(!b){let A=S;for(;;){let C=o.children[S];if(mt.is(C))r.pendingDeletes.add(C);else break;S+=1}o.children.splice(A,S-A)}return!0}var hb=class extends As(Ep,Es){constructor(r,a){super(),this.super_Entity(r,a),this.objectHelper.update(),this.matrixAutoUpdate=!0}updateState(r,a){this.updateState_Entity(r,a)}},Mr=class extends jt{constructor(r,a,n){super(r,a,n),this.onBeforeRender=o=>{this.uiCanvas.render(o)},this.uiCanvas=new Rf(r+"-canvas",a.geometry.width,a.geometry.height,n),this.uiCanvas.promise.then(()=>{this.applyFrame(this.dataPatched.geometry.frame,n.shared)})}updateByPatchedOpGeometry(r,a,n){super.updateByPatchedOpGeometry(r,a,n),r.type===0&&(r.props.frame!==void 0&&this.applyFrame(r.props.frame,n.shared),(r.props.width!==void 0||r.props.height!==void 0)&&this.applySize(r.props,n.shared))}applySize(r,a){let n=(r==null?void 0:r.width)??this.dataPatched.geometry.width,o=(r==null?void 0:r.height)??this.dataPatched.geometry.height;this.uiCanvas.applySize({width:n,height:o}),this.applyGeometryParametersFromFrame(a)}applyFrame(r,a){this.uiCanvas.applyFrame(r),this.applyGeometryParametersFromFrame(a),this.applyMaterialParametersFromFrame({shared:a})}applyGeometryParametersFromFrame(r){var n;let a=this.frame;a&&(Object.assign(this.data,{geometry:Object.assign(this.data.geometry,{cornerRadius:a.cornerRadius,cornerType:0})}),Object.assign(this.dataPatched,{geometry:Object.assign(this.dataPatched.geometry,{cornerRadius:a.cornerRadius,cornerType:0})}),(n=this.localGeometry)==null||n.dispose(),this.localGeometry=Ba(this.dataPatched.geometry,r,this.data.flatShading,this))}applyMaterialParametersFromFrame(r){let a=this.frame;if(a){let n=a.data.backgroundBlur;Object.assign(this.data.material.layers[0].data.texture,{image:this.uiCanvas.uuid}),Object.assign(this.data.material.layers[1].data,{roughness:n.radius,alpha:n.enabled?1:0}),Object.assign(this.dataPatched.material.layers[0].data.texture,{image:this.uiCanvas.uuid}),Object.assign(this.dataPatched.material.layers[1].data,{roughness:n.radius,alpha:n.enabled?1:0}),this.material.reset(this.dataPatched.material,r,!0)}}updateEntity2DByOp(r,a,n,o){this.uiCanvas.updateEntity2DByOp(r,a,n,o),r===this.frameId&&a.type===0&&(a.props.cornerRadius!==void 0?this.applyGeometryParametersFromFrame(o):Vt(a.path,["backgroundBlur"])&&this.applyMaterialParametersFromFrame({shared:o}))}get frame(){return this.uiCanvas.frame}get frameId(){var r;return(r=this.frame)==null?void 0:r.uuid}removeInteractionGeometry(r){super.removeInteractionGeometry(r),this.applySize({},r)}updateGeometryInteractions(r,a){super.updateGeometryInteractions(r,a),this.applySize({width:r.width,height:r.height},a)}},db=class{constructor(r,a,n){this.variables=[],this.currentTextureIndex=0;let o=Ft,f=new wr,y=new yn;y.position.z=1;let x={passThruTexture:{value:null}},b=A(P(),x),_=new Et(new vi(2,2),b);f.add(_),this.setDataType=function(T){return o=T,this},this.addVariable=function(T,M,O){let I=this.createShaderMaterial(M),D={name:T,initialValueTexture:O,material:I,dependencies:null,renderTargets:[],wrapS:null,wrapT:null,minFilter:yt,magFilter:yt};return this.variables.push(D),D},this.setVariableDependencies=function(T,M){T.dependencies=M},this.init=function(){if(n.capabilities.isWebGL2===!1&&n.extensions.has("OES_texture_float")===!1)return"No OES_texture_float support for float textures.";if(n.capabilities.maxVertexTextures===0)return"No support for vertex shader textures.";for(let T=0;T<this.variables.length;T++){let M=this.variables[T];M.renderTargets[0]=this.createRenderTarget(r,a,M.wrapS,M.wrapT,M.minFilter,M.magFilter),M.renderTargets[1]=this.createRenderTarget(r,a,M.wrapS,M.wrapT,M.minFilter,M.magFilter),this.renderTexture(M.initialValueTexture,M.renderTargets[0]),this.renderTexture(M.initialValueTexture,M.renderTargets[1]);let O=M.material,I=O.uniforms;if(M.dependencies!==null)for(let D=0;D<M.dependencies.length;D++){let z=M.dependencies[D];if(z.name!==M.name){let k=!1;for(let L=0;L<this.variables.length;L++)if(z.name===this.variables[L].name){k=!0;break}if(!k)return"Variable dependency not found. Variable="+M.name+", dependency="+z.name}I[z.name]={value:null},O.fragmentShader=`
uniform sampler2D `+z.name+`;
`+O.fragmentShader}}return this.currentTextureIndex=0,null},this.compute=function(){let T=this.currentTextureIndex,M=this.currentTextureIndex===0?1:0;for(let O=0,I=this.variables.length;O<I;O++){let D=this.variables[O];if(D.dependencies!==null){let z=D.material.uniforms;for(let k=0,L=D.dependencies.length;k<L;k++){let R=D.dependencies[k];z[R.name].value=R.renderTargets[T].texture}}this.doRenderTarget(D.material,D.renderTargets[M])}this.currentTextureIndex=M},this.getCurrentRenderTarget=function(T){return T.renderTargets[this.currentTextureIndex]},this.getAlternateRenderTarget=function(T){return T.renderTargets[this.currentTextureIndex===0?1:0]},this.dispose=function(){_.geometry.dispose(),_.material.dispose();let T=this.variables;for(let M=0;M<T.length;M++){let O=T[M];O.initialValueTexture&&O.initialValueTexture.dispose();let I=O.renderTargets;for(let D=0;D<I.length;D++)I[D].dispose()}};function S(T){T.defines.resolution="vec2( "+r.toFixed(1)+", "+a.toFixed(1)+" )"}this.addResolutionDefine=S;function A(T,M){M=M||{};let O=new Je({uniforms:M,vertexShader:C(),fragmentShader:T});return S(O),O}this.createShaderMaterial=A,this.createRenderTarget=function(T,M,O,I,D,z){return T=T||r,M=M||a,O=O||Jt,I=I||Jt,D=D||yt,z=z||yt,new at(T,M,{wrapS:O,wrapT:I,minFilter:D,magFilter:z,format:pr,type:o,depthBuffer:!1})},this.createTexture=function(){let T=new Float32Array(r*a*4),M=new Fr(T,r,a,pr,Ft);return M.needsUpdate=!0,M},this.renderTexture=function(T,M){x.passThruTexture.value=T,this.doRenderTarget(b,M),x.passThruTexture.value=null},this.doRenderTarget=function(T,M){let O=n.getRenderTarget(),I=n.xr.enabled,D=n.shadowMap.autoUpdate,z=n.outputEncoding,k=n.toneMapping;n.xr.enabled=!1,n.shadowMap.autoUpdate=!1,n.outputEncoding=gn,n.toneMapping=Ls,_.material=T,n.setRenderTarget(M),n.render(f,y),_.material=b,n.xr.enabled=I,n.shadowMap.autoUpdate=D,n.outputEncoding=z,n.toneMapping=k,n.setRenderTarget(O)};function C(){return`void main()	{

	gl_Position = vec4( position, 1.0 );

}
`}function P(){return`uniform sampler2D passThruTexture;

void main() {

	vec2 uv = gl_FragCoord.xy / resolution.xy;

	gl_FragColor = texture2D( passThruTexture, uv );

}
`}}},en=new _r,fb=new E,pb=class{constructor(r){let a=r.geometry;if(!a.isBufferGeometry||a.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");a.index&&(console.warn("THREE.MeshSurfaceSampler: Converting geometry to non-indexed BufferGeometry."),a=a.toNonIndexed()),this.geometry=a,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.colorAttribute=this.geometry.getAttribute("color"),this.weightAttribute=null,this.distribution=null}setWeightAttribute(r){return this.weightAttribute=r?this.geometry.getAttribute(r):null,this}build(){let r=this.positionAttribute,a=this.weightAttribute,n=new Float32Array(r.count/3);for(let f=0;f<r.count;f+=3){let y=1;a&&(y=a.getX(f)+a.getX(f+1)+a.getX(f+2)),en.a.fromBufferAttribute(r,f),en.b.fromBufferAttribute(r,f+1),en.c.fromBufferAttribute(r,f+2),y*=en.getArea(),n[f/3]=y}this.distribution=new Float32Array(r.count/3);let o=0;for(let f=0;f<n.length;f++)o+=n[f],this.distribution[f]=o;return this}setRandomGenerator(r){return this.randomFunction=r,this}sample(r,a,n){let o=this.distribution[this.distribution.length-1],f=this.binarySearch(this.randomFunction()*o);return this.sampleFace(f,r,a,n)}binarySearch(r){let a=this.distribution,n=0,o=a.length-1,f=-1;for(;n<=o;){let y=Math.ceil((n+o)/2);if(y===0||a[y-1]<=r&&a[y]>r){f=y;break}else r<a[y]?o=y-1:n=y+1}return f}sampleFace(r,a,n,o){let f=this.randomFunction(),y=this.randomFunction();return f+y>1&&(f=1-f,y=1-y),en.a.fromBufferAttribute(this.positionAttribute,r*3),en.b.fromBufferAttribute(this.positionAttribute,r*3+1),en.c.fromBufferAttribute(this.positionAttribute,r*3+2),a.set(0,0,0).addScaledVector(en.a,f).addScaledVector(en.b,y).addScaledVector(en.c,1-(f+y)),n!==void 0&&en.getNormal(n),o!==void 0&&this.colorAttribute!==void 0&&(en.a.fromBufferAttribute(this.colorAttribute,r*3),en.b.fromBufferAttribute(this.colorAttribute,r*3+1),en.c.fromBufferAttribute(this.colorAttribute,r*3+2),fb.set(0,0,0).addScaledVector(en.a,f).addScaledVector(en.b,y).addScaledVector(en.c,1-(f+y)),o.r=fb.x,o.g=fb.y,o.b=fb.z),this}};function JL(r){let a=new Float32Array(r*r*2);for(let n=0;n<r;n++)for(let o=0;o<r;o++){let f=n*r+o;a[f*2+0]=n/(r-1),a[f*2+1]=o/(r-1)}return a}function $L(r){let a=Math.ceil(Math.sqrt(r));return Math.max(a,1)}function eB(r,a){let n=new Et(r.geometry,r.material),o=[],f=[],y=new E,x=new E;n.geometry.index!==null&&(n.geometry=n.geometry.toNonIndexed());let b=new pb(n).build();for(let A=0;A<a;A++)b.sample(y,x),o.push(y.x,y.y,y.z),f.push(x.x,x.y,x.z);let _=new Float32Array(o),S=new Float32Array(f);return{positions:_,normals:S}}function ET(r,a){let n=r,o=new Float32Array(4*a*a);for(let y=0;y<a*a;y++)o[4*y]=n[3*y],o[4*y+1]=n[3*y+1],o[4*y+2]=n[3*y+2],o[4*y+3]=0;let f=new Fr(o,a,a,pr,Ft);return f.needsUpdate=!0,f}function tB({size:r}){let a=new Float32Array(4*r*r);for(let o=0;o<r*r;o++)a[4*o]=o,a[4*o+1]=0,a[4*o+2]=0,a[4*o+3]=0;let n=new Fr(a,r,r,pr,Ft);return n.needsUpdate=!0,n}function rB(r){let a=new Float32Array(4*r*r);for(let o=0;o<r*r;o++)a[4*o]=0,a[4*o+1]=0,a[4*o+2]=0,a[4*o+3]=0;let n=new Fr(a,r,r,pr,Ft);return n.needsUpdate=!0,n}var iB=`
// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU
uniform sampler2D uOriginalPosition;
uniform float uTime;
uniform float uSpeed;     // update speed of the particles
uniform vec3 uWorldOffset;    
uniform vec4 uWorldQuaternion;
uniform float uMaxLifeTime;
uniform vec3 uEmitterSize;
uniform float uFPSRatio;     // 1  for 60 FPS

float random (vec2 st) {
    return fract(sin(dot(st.xy,
        vec2(12.9898,78.233)))*
        43758.5453123);
}
vec3 applyQuaternionToVector( vec4 q, vec3 v ){
    return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );
}

vec3 applyForce(vec3 force, float mass) {
    vec3 acceleration = force / mass;
    
    return acceleration;
  }
  

void main() {
    vec2 vUv = gl_FragCoord.xy / resolution.xy;
    vec3 position = texture2D( uCurrentPosition, vUv ).xyz;
    float currentLife = texture2D( uCurrentPosition, vUv ).w;   // from 1 to 0
    float isSpawning = texture2D( uCurrentEmissionRate, vUv ).r;        // 1. = spawning, 0. = not spawning
    float isActive = texture2D( uCurrentEmissionRate, vUv ).g;          // 1. = active, 0. = not active
    float timeStart = texture2D( uCurrentEmissionRate, vUv ).b;         // timeStart in seconds when the particle was emitted
    vec3 originalPosition = ((texture2D( uOriginalPosition, vUv ).xyz) * uEmitterSize);
    vec3 velocity = texture2D( uCurrentVelocity, vUv ).xyz;
    float collisionFlag = texture2D( uCurrentVelocity, vUv ).w;             // 1. = collided, 0. = not collided
    float lifeTime = uMaxLifeTime;

    // Calculate the position adjustment based on collision
    //     if (collisionFlag > .5) {  
    float isColliding = step(0.5, collisionFlag); // 1.0 if collisionFlag > 0.5, otherwise 0.0
    float bounceOffset = 3.0 * isColliding; // Becomes 3.0 if colliding, 0.0 otherwise
    vec3 collisionAdjustedVelocity = velocity * (1.0 + bounceOffset);

    // Update position based on collision or normal movement
    vec3 fpsVelocity = velocity * min(uFPSRatio, 5.0);
    position += mix(fpsVelocity, collisionAdjustedVelocity, isColliding);

    // EMISSION RATE - BIRTH
    // if (isSpawning == 1.0) {
    // Better Approach to avoid If statement
    vec3 newPosition = applyQuaternionToVector(uWorldQuaternion, originalPosition) + uWorldOffset;
    originalPosition = mix(originalPosition, newPosition, isSpawning);
    position = mix(position, originalPosition, isSpawning);;
    timeStart = mix(timeStart, uTime, isSpawning);

    // Calculate timeLeft for life normalization
    float timeLeft = max(lifeTime - (uTime - timeStart), 0.0);
    float life_Normalize = timeLeft / lifeTime;

    // Use isActive to blend between the calculated color and black
    vec4 activeColor = vec4(position, life_Normalize);
    // if (isActive == 1.0) {
    gl_FragColor = mix(vec4(0.0), activeColor, isActive);

}
`,nB=`

    vec3 mod289(vec3 x) {
      return x - floor(x * (1.0 / 289.0)) * 289.0;
    }
    
    vec4 mod289(vec4 x) {
    return x - floor(x * (1.0 / 289.0)) * 289.0;
    }
    
    vec4 permute(vec4 x) {
        return mod289(((x*34.0)+1.0)*x);
    }
    
    vec4 taylorInvSqrt(vec4 r)
    {
    return 1.79284291400159 - 0.85373472095314 * r;
    }
    
    vec3 fade(vec3 t) {
  return t*t*t*(t*(t*6.0-15.0)+10.0);
}

    float snoise(vec3 v)
    {
    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
    vec3 i  = floor(v + dot(v, C.yyy) );
    vec3 x0 =   v - i + dot(i, C.xxx) ;
    vec3 g = step(x0.yzx, x0.xyz);
    vec3 l = 1.0 - g;
    vec3 i1 = min( g.xyz, l.zxy );
    vec3 i2 = max( g.xyz, l.zxy );
    vec3 x1 = x0 - i1 + C.xxx;
    vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y
    vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y
    
    // Permutations
    i = mod289(i);
    vec4 p = permute( permute( permute(
                i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
              + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))
              + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
    
    // Gradients: 7x7 points over a square, mapped onto an octahedron.
    // The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)
    float n_ = 0.142857142857; // 1.0/7.0
    vec3  ns = n_ * D.wyz - D.xzx;
    
    vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)
    
    vec4 x_ = floor(j * ns.z);
    vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
    
    vec4 x = x_ *ns.x + ns.yyyy;
    vec4 y = y_ *ns.x + ns.yyyy;
    vec4 h = 1.0 - abs(x) - abs(y);
    
    vec4 b0 = vec4( x.xy, y.xy );
    vec4 b1 = vec4( x.zw, y.zw );
    
    vec4 s0 = floor(b0)*2.0 + 1.0;
    vec4 s1 = floor(b1)*2.0 + 1.0;
    vec4 sh = -step(h, vec4(0.0));
    
    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
    
    vec3 p0 = vec3(a0.xy,h.x);
    vec3 p1 = vec3(a0.zw,h.y);
    vec3 p2 = vec3(a1.xy,h.z);
    vec3 p3 = vec3(a1.zw,h.w);
    
    //Normalise gradients
    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
    p0 *= norm.x;
    p1 *= norm.y;
    p2 *= norm.z;
    p3 *= norm.w;
    
    // Mix final noise value
    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
    m = m * m;
    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),
                                  dot(p2,x2), dot(p3,x3) ) );
    }
    
    vec3 snoiseVec3( vec3 x ){
    
      float s  = snoise(vec3( x ));
      float s1 = snoise(vec3( x.y - 19.1 , x.z + 33.4 , x.x + 47.2 ));
      float s2 = snoise(vec3( x.z + 74.2 , x.x - 124.5 , x.y + 99.4 ));
      vec3 c = vec3( s , s1 , s2 );
      return c;
    
    }
    
      
    vec3 curlNoise( vec3 p, float seed){
      p += seed;
      const float e = .1;
      vec3 dx = vec3( e   , 0.0 , 0.0 );
      vec3 dy = vec3( 0.0 , e   , 0.0 );
      vec3 dz = vec3( 0.0 , 0.0 , e   );
    
      vec3 p_x0 = snoiseVec3( p - dx );
      vec3 p_x1 = snoiseVec3( p + dx );
      vec3 p_y0 = snoiseVec3( p - dy );
      vec3 p_y1 = snoiseVec3( p + dy );
      vec3 p_z0 = snoiseVec3( p - dz );
      vec3 p_z1 = snoiseVec3( p + dz );
    
      float x = p_y1.z - p_y0.z - p_z1.y + p_z0.y;
      float y = p_z1.x - p_z0.x - p_x1.z + p_x0.z;
      float z = p_x1.y - p_x0.y - p_y1.x + p_y0.x;
    
      const float divisor = 1.0 / ( 2.0 * e );
      return normalize( vec3( x , y , z ) * divisor );
    
    }


// Classic Perlin noise
float cnoise(vec3 P)
{
  vec3 Pi0 = floor(P); // Integer part for indexing
  vec3 Pi1 = Pi0 + vec3(1.0); // Integer part + 1
  Pi0 = mod289(Pi0);
  Pi1 = mod289(Pi1);
  vec3 Pf0 = fract(P); // Fractional part for interpolation
  vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0
  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
  vec4 iy = vec4(Pi0.yy, Pi1.yy);
  vec4 iz0 = Pi0.zzzz;
  vec4 iz1 = Pi1.zzzz;

  vec4 ixy = permute(permute(ix) + iy);
  vec4 ixy0 = permute(ixy + iz0);
  vec4 ixy1 = permute(ixy + iz1);

  vec4 gx0 = ixy0 * (1.0 / 7.0);
  vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;
  gx0 = fract(gx0);
  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
  vec4 sz0 = step(gz0, vec4(0.0));
  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
  gy0 -= sz0 * (step(0.0, gy0) - 0.5);

  vec4 gx1 = ixy1 * (1.0 / 7.0);
  vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;
  gx1 = fract(gx1);
  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
  vec4 sz1 = step(gz1, vec4(0.0));
  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
  gy1 -= sz1 * (step(0.0, gy1) - 0.5);

  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);

  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
  g000 *= norm0.x;
  g010 *= norm0.y;
  g100 *= norm0.z;
  g110 *= norm0.w;
  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
  g001 *= norm1.x;
  g011 *= norm1.y;
  g101 *= norm1.z;
  g111 *= norm1.w;

  float n000 = dot(g000, Pf0);
  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
  float n111 = dot(g111, Pf1);

  vec3 fade_xyz = fade(Pf0);
  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
  return 2.2 * n_xyz;
}


vec3 fbm_vec3(vec3 p, float frequency, float offset)
{
  return vec3(
    cnoise((p+vec3(offset))*frequency),
    cnoise((p+vec3(offset+20.0))*frequency),
    cnoise((p+vec3(offset-30.0))*frequency)
  );
}

`,sB=`
  #ifdef USE_COLLIDER
    float restitution = max(uBounce * 2., .01); // Energy Loss
    // SPHERE COLLIDER
    // **************************************************************
    #ifdef USE_SPHERE_COLLIDER       
      // Convert collider size to radii (assuming uColliderSize is the diameter in each axis)
      vec3 radii = uColliderSize;
      // Adjust position relative to collider
      vec3 relPos = position - uColliderPos;
      // Apply rotation of the collider to the relative position
      relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            
      // Scale relative position by radii (for ellipsoid collision detection)
      vec3 scaledPos = relPos / radii;
      // Calculate ellipsoidal distance
      float dist = length(scaledPos); // Distance in terms of ellipsoid
      
      // Check for collision
      if (dist <= 1. + particleSize / length(radii) && collisionFlag == 0.0) {
          // Compute the normal at the collision point, accounting for particle size
        vec3 adjustedPos = scaledPos * (1.0 + particleSize / length(radii));          
        // Compute the normal at the collision point
        vec3 normal = ellipsoidNormal(adjustedPos, radii);
        // Rotate the normal back to world space
        normal = applyQuaternionToVector(uColliderQuaternion, normal);
        // Reflect the velocity vector off the normal
        velocity = reflect(velocity, normal) * restitution;

        collisionFlag = 1.0;
      } else {
        collisionFlag = 0.0;
      }
    #endif

    // BOX COLLIDER or PLANE COLLIDER 
    // **************************************************************
    #ifdef USE_BOX_COLLIDER
      // Box dimensions and repulsion variables
      vec3 boxHalfSize = uColliderSize / 2.0;
      // Convert world position to box's local space
      vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      
      // Collision detection
      vec3 localDistance = abs(localPos) - boxHalfSize;
      float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));    

      // Collision Detected
      if (distToSurface <= particleSize * 0.5 && collisionFlag == 0.0) {      
        // Find the nearest face normal for bounce direction
        vec3 normal;
        if (localDistance.x > localDistance.y && localDistance.x > localDistance.z) {
            normal = vec3(sign(localPos.x), 0.0, 0.0);
        } else if (localDistance.y > localDistance.z) {
            normal = vec3(0.0, sign(localPos.y), 0.0);
        } else {
            normal = vec3(0.0, 0.0, sign(localPos.z));
        }            
        // Rotate normal back to world space
        normal = applyQuaternionToVector(uColliderQuaternion, normal);      
        // Reflect velocity and apply repulsion force
        velocity = reflect(velocity, normal) * restitution;
        
        collisionFlag = 1.0;
      } else {
        collisionFlag = 0.0;
      }
    #endif      
  #endif      
  // END COLLIDER    
`,oB=`
  #ifdef USE_ATTRACTOR

      #ifdef USE_SPHERE_COLLIDER      
        // Convert collider size to radii (assuming uColliderSize is the diameter in each axis)
        vec3 radii = uColliderSize;
        // Adjust position relative to collider
        vec3 relPos = position - uColliderPos;
        // Apply rotation of the collider to the relative position
        relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            
        // Scale relative position by radii (for ellipsoid collision detection)
        vec3 scaledPos = relPos / radii;
        // Calculate ellipsoidal distance
        float distToSurface = length(scaledPos); // Distance in terms of ellipsoid
        float insideCheck = 1.0;

      #endif


      #ifdef USE_BOX_COLLIDER
        // Box dimensions
        vec3 boxHalfSize = uColliderSize / 2.0;
        // Convert world position to box's local space
        vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      
        vec3 localDistance = abs(localPos) - boxHalfSize;
        float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));
        float insideCheck = particleSize;
      #endif      
  
      // Apply vortex force inside the Helper
      #ifdef USE_FORCE_LOCAL_SPACE
        if (distToSurface <= insideCheck ) {    
            // Define parameters for the attractor field
            #ifdef USE_SPHERE_COLLIDER      
              float attractorStrength = (1.0 - distToSurface ) * uForceIntensity; // Adjust as needed
            #endif

            #ifdef USE_BOX_COLLIDER
              float attractorStrength = max((1.0 - insideCheck / distToSurface), 0.) * uForceIntensity; // Adjust as needed
              #endif

            float attractorDamping = uForceDamping;  // Adjust as needed (higher values will attenuate velocity more)
          
            // Use the same radii calculation code as for the collider
            vec3 attractorRadii = uColliderSize;
            // Adjust position relative to attractor center
            vec3 relPos = position - uColliderPos;
            // Apply rotation of the collider to the relative position
            relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            
            // Scale relative position by radii (for ellipsoid attraction)
            vec3 scaledPos = relPos / attractorRadii;

            // Calculate ellipsoidal distance as attractor radius
            float attractorRadius = length(scaledPos);
            // Calculate the distance from the attractor center
            vec3 relativePosition = position - uColliderPos;
            // Calculate the force vector towards the attractor center
            vec3 attractorForce = normalize(relativePosition) * attractorStrength;
            // Apply the attractor force to the particle
            velocity -= attractorForce;
            // Attenuate the particle's velocity
            velocity *= attractorDamping;
        }
      #else 
            // Calculate the distance from the attractor center
            vec3 relativePosition = position - uColliderPos;
            // Calculate the force vector towards the attractor center
            vec3 attractorForce = normalize(relativePosition) * uForceIntensity;
            // Apply the attractor force to the particle
            velocity -= attractorForce;
            // Attenuate the particle's velocity
            velocity *= uForceDamping;
      #endif    
  #endif      
`,aB=`
  #ifdef USE_VORTEX
    // Box dimensions
    vec3 boxHalfSize = uColliderSize / 2.0;
    // Convert world position to box's local space
    vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      
    vec3 localDistance = abs(localPos) - boxHalfSize;
    float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));

    // Apply vortex force inside the box
    if (distToSurface <= particleSize) {
      float vortexStrength = uForceIntensity;
      vec3 localTopCenter = vec3(0.0, 0., 0.0);

      // Transform the local top center to the world space
      vec3 vortexCenter = uColliderPos + applyQuaternionToVector(uColliderQuaternion, localTopCenter);
      // Calculate the vector from particle to vortex center
      vec3 vortexVector = vortexCenter - position;

      // Calculate the rotation axis from the inverse of the collider's quaternion and the fixed up vector
      // Note: important to add a tiny z component to the up vector to avoid instability
      vec3 upVector = vec3(0.0, 1.0, 0.01);
      vec3 rotationAxis = cross(upVector, applyQuaternionToVector(uColliderQuaternion, vortexVector));
      rotationAxis = normalize(rotationAxis);

      // Add rotational component to velocity
      float rotationSpeed = length(vortexVector * vortexStrength * 3.0) ; 

      vec3 rotationVelocity = rotationAxis * rotationSpeed;
      // velocity += rotationVelocity * 0.005 ;
      velocity = rotationVelocity * 0.005 ;

      // Calculate vortex force
      // vec3 vortexForce = normalize(vortexVector) * uSpeed * .1 ;
      // Apply the vortex force to the particle
      vec3 originDirection = applyQuaternionToVector(uWorldQuaternion, directions);
      velocity += applyForce( originDirection * uSpeed * (1. - uForceDamping) , mass * .5);
    }
  #endif      
`,lB=`
// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU
uniform sampler2D uOriginalPosition;
uniform sampler2D uDirections;     
uniform vec3 uDirectionsAxis;
uniform vec4 uWorldQuaternion;
uniform vec3 uGravity;        
uniform float uNoiseStrength;     // Variation of the noise
uniform float uNoiseScale;        // Scale of the noise
uniform float uNoiseSeed;         // Seed of the noise
uniform float particleSize;
uniform float uSpeed;     // update speed of the particles
uniform float uRandomMassFactor;

// COLLIDER
uniform vec3 uColliderPos;                // Collider Position
uniform vec3 uColliderSize;               // Collider Dimension
uniform vec4 uColliderQuaternion;         // Collider Rotation
uniform vec4 uColliderQuaternionInvert;   // Collider Rotation
uniform float uBounce;                    // Bounce factor
uniform float uForceDamping;
uniform float uForceIntensity;


`+nB+`
float rand(vec2 co){
    return fract(sin(dot(co, vec2(12.9898, 78.233))) * 43758.5453);
}
vec3 applyQuaternionToVector( vec4 q, vec3 v ){
    return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );
 } 
vec3 applyForce(vec3 force, float mass) {
  vec3 acceleration = force / mass;
  
  return acceleration;
}

vec4 conjugate(vec4 q) {
  return vec4(q.w, -q.x, -q.y, -q.z);
}

// Function to compute the normal of the ellipsoid at a given point
vec3 ellipsoidNormal(vec3 p, vec3 radii) {
  return normalize(p / (radii * radii));
}

float friction = .3;

void main() {
    vec2 vUv = gl_FragCoord.xy / resolution.xy;
    vec3 position = texture2D( uCurrentPosition, vUv ).xyz;
    vec3 originalPosition = texture2D( uOriginalPosition, vUv ).xyz;
    float timeLeft = texture2D( uCurrentPosition, vUv ).w;
    vec3 directions = texture2D( uDirections, vUv ).xyz;    
    vec3 velocity = texture2D( uCurrentVelocity, vUv ).xyz;
    float mass = rand(originalPosition.xy) * 0.5 + 0.5;
    float isSpawning = texture2D( uCurrentEmissionRate, vUv ).x;        // 1. = spawning, 0. = not spawning
    float isActive = texture2D( uCurrentEmissionRate, vUv ).y;          // 1. = active, 0. = not active
    float collisionFlag =texture2D( uCurrentVelocity, vUv ).w;          // Indicate collision

    // Randomness Mass
    mass = (1.0 - (uRandomMassFactor * mass));
    
    if (isActive == 1.0) {
      // **************************************************************
      // FORCES NOISES
      // **************************************************************
      #ifdef USE_CURL_NOISE
        if (uNoiseScale > 0.0 ) {
          velocity = curlNoise(position * uNoiseScale * .002, uNoiseSeed) * ( uNoiseStrength + 1.0) * .05 * uSpeed;
        }
        // Variation of the noise Over Time
        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0 ) {
          velocity += curlNoise( position, uNoiseSeed)  * uNoiseStrength * 0.05 * uSpeed;
        }
      #endif
      // **************************************************************
      #ifdef USE_SIMPLEX_NOISE
        if (uNoiseScale > 0.0 ) {
          velocity = vec3(snoise(position * uNoiseScale * .001) * ( uNoiseStrength + 1.0) * .1);
          velocity *= uSpeed;
        }
        // Variation of the noise Over Time
        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0) {
          velocity += vec3(snoise(position * uNoiseStrength * .001) * .05 * uSpeed);
        }
      #endif
      // ************************************************************** 
      #ifdef USE_FBM_NOISE
        if (uNoiseScale > 0.0 ) {
          velocity = fbm_vec3(position * uNoiseScale * .001, ( uNoiseStrength + 1.0), uNoiseSeed);
          velocity *= uSpeed;
        }
        // Variation of the noise Over Time
        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0 ) {      
          velocity += fbm_vec3(position * uNoiseStrength * .001, ( uNoiseStrength + 1.0), uNoiseSeed) * .1 * uSpeed;
        }
      #endif

      // COLLIDER
      ${sB}
      // ATTRACTION
      ${oB}  
      // VORTEX
      ${aB}
    } 
    // End isActive

    // SPAWN BIRTH 
    // **************************************************************
    // if (isSpawning == 1.)
    #ifdef USE_NORMALS
      velocity = mix(velocity, applyQuaternionToVector(uWorldQuaternion, directions) * uSpeed, isSpawning);
    #else
      velocity = mix(velocity, applyQuaternionToVector(uWorldQuaternion, uDirectionsAxis) * uSpeed, isSpawning);    
    #endif
    
    // if (collisionFlag == 0.0)
    velocity += applyForce(uGravity, mass * .5) * (1.0 - collisionFlag);

    gl_FragColor = vec4(velocity, collisionFlag);
}
`,TT=`

  // Linear Fade In
  float linearFadeIn(float t) {
    return t;
  }


  // linear fade out
  float linearFadeOut(float t) {
    return 1.0 - t;
  }
  
  float linearInOut(float t) {
    return t < 0.5 ? t :  (1.0 - t);  
  }

    // lerp
    float lerp(float a, float b, float t) {
      return a + (b - a) * t;
    }

  // Ease In Out Quart
  float exponentialInOut(float t) {
    return t < 0.4 ? lerp(0.0, 1.0, t / 0.4) :
    t > 0.6 ? lerp(1.0, 0.0, (t - 0.6) / 0.4) :
    1.0;
   }

  // constant
  float constant(float t) {
    return 1.0;
  } 
`,cB=`

float rand(vec3 co){
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

vec3 applyQuaternionToVector( vec4 q, vec3 v ){
  return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );
}

vec3 applyForce(vec3 force, float mass) {
  vec3 acceleration = force / mass;
    
  return acceleration;
}
`,uB=`
vec3 rgb2xyz (in vec3 rgb) {
    float r = rgb.r;
	float g = rgb.g;
	float b = rgb.b;

	r = r > 0.04045 ? pow(((r + 0.055) / 1.055), 2.4) : (r / 12.92);
	g = g > 0.04045 ? pow(((g + 0.055) / 1.055), 2.4) : (g / 12.92);
	b = b > 0.04045 ? pow(((b + 0.055) / 1.055), 2.4) : (b / 12.92);

	float x = (r * 0.4124) + (g * 0.3576) + (b * 0.1805);
	float y = (r * 0.2126) + (g * 0.7152) + (b * 0.0722);
	float z = (r * 0.0193) + (g * 0.1192) + (b * 0.9505);
    
    vec3 xyz = vec3(
        (r * 0.4124) + (g * 0.3576) + (b * 0.1805) * 100.0,
        (r * 0.2126) + (g * 0.7152) + (b * 0.0722) * 100.0,
        (r * 0.0193) + (g * 0.1192) + (b * 0.9505) * 100.0
    );
    return(xyz);
}

vec3 xyz2lab (in vec3 xyz) {
	float x = xyz.x / 95.047;
	float y = xyz.y / 100.0;
	float z = xyz.z / 108.883;

	x = x > 0.008856 ? pow(x, 1.0 / 3.0) : (7.787 * x) + (16.0 / 116.0);
	y = y > 0.008856 ? pow(y, 1.0 / 3.0) : (7.787 * y) + (16.0 / 116.0);
	z = z > 0.008856 ? pow(z, 1.0 / 3.0) : (7.787 * z) + (16.0 / 116.0);

    vec3 lab = vec3((116.0 * y) - 16.0, 500.0 * (x - y), 200.0 * (y - z));
    return(lab);
}

vec3 rgb2lab(in vec3 rgb) {
    vec3 xyz = rgb2xyz(rgb);
    vec3 lab = xyz2lab(xyz);
    return(lab);
}

vec3 xyz2rgb (in vec3 xyz) {
	float x = xyz.x / 100.0;
	float y = xyz.y / 100.0;
	float z = xyz.z / 100.0;
	
    
	float r = (x *  3.2406) + (y * -1.5372) + (z * -0.4986);
	float g = (x * -0.9689) + (y *  1.8758) + (z *  0.0415);
	float b = (x *  0.0557) + (y * -0.2040) + (z *  1.0570);

	r = r > 0.0031308 ? ((1.055 * pow(r, 1.0 / 2.4)) - 0.055) : r * 12.92;
	g = g > 0.0031308 ? ((1.055 * pow(g, 1.0 / 2.4)) - 0.055) : g * 12.92;
	b = b > 0.0031308 ? ((1.055 * pow(b, 1.0 / 2.4)) - 0.055) : b * 12.92;

	r = min(max(0.0, r), 1.0);
	g = min(max(0.0, g), 1.0);
	b = min(max(0.0, b), 1.0);

	return(vec3(r, g, b));
}

vec3 lab2xyz (in vec3 lab) {
    float l = lab.x;
	float a = lab.y;
	float b = lab.z;

  	float y = (l + 16.0) / 116.0;
	float x = a / 500.0 + y;
	float z = y - b / 200.0;

	float y2 = pow(y, 3.0);
	float x2 = pow(x, 3.0);
	float z2 = pow(z, 3.0);

  	y = y2 > 0.008856 ? y2 : (y - 16.0 / 116.0) / 7.787;
	x = x2 > 0.008856 ? x2 : (x - 16.0 / 116.0) / 7.787;
	z = z2 > 0.008856 ? z2 : (z - 16.0 / 116.0) / 7.787;

	x *= 95.047;
	y *= 100.0;
	z *= 108.883;

	return(vec3(x, y, z));
}
vec3 lab2rgb (in vec3 lab) {
    vec3 xyz = lab2xyz(lab);
    vec3 rgb = xyz2rgb(xyz);
    return(rgb);
}

`,hB=`
  uniform sampler2D uPosition;
  uniform float uSize;
  uniform float uSizeEnd;
  uniform vec3 uWorldOffset;
  uniform vec4 uWorldQuaternion;
  // Billboard Behavior - Currently at Zero, but we can change that
  uniform float uRotation;
  uniform float uRotationEnd;
  uniform vec2 center;

  // Randomness
  uniform float uRandScaleFactor;
  uniform float uRandRotationFactor;

  attribute vec2 ref;

  varying float v_LifeLeft;    // normalized lifetime 1 to 0
  varying vec2 vUv;
  varying vec2 vRef;

  ${cB}
  ${TT}
`,dB=({easeSize:r="linearFadeOut"})=>`
  vUv = uv;  
  vRef = ref;
  // Normalized LifeTime 1 to 0
  float lifeLeft = texture2D(uPosition, ref).w;
  v_LifeLeft = lifeLeft;
  // Position From DataTexture Simulation
  vec3 pos = texture2D(uPosition, ref).rgb - uWorldOffset;
  // Apply World Quaternion
  pos = applyQuaternionToVector(uWorldQuaternion, pos);  
            
  #ifdef  USE_SIZE_END
    // Scaled Over Time
    float t = 1. - lifeLeft;
    float currentSize = mix(uSize, uSizeEnd, t); // Linearly interpolate between uSize and uSizeEnd
    vec3 scaledPosition = position * vec3(currentSize);
  #else
    // Change Size Behavior over LifeTime
    float easeSize = ${r}(1. - lifeLeft);
    // Scaled Over Time
    vec3 scaledPosition = position * vec3(uSize * easeSize);
  #endif

  // Billboard Behavior
  vec2 scale;
  scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
  scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );    
  // Randomness 
  float randRef = rand(ref);
  scale *= (1.0 - (uRandScaleFactor * randRef));
  // Rotation
  float randRotation =  2.0 * PI * ( uRandRotationFactor * randRef);
  float originalRotation = (1.0 - uRotation) * 2.0 * PI;
  float originalRotationEnd = (1.0 - uRotationEnd) * 2.0 * PI;
  // OverTime
  float finalRotation = mix(originalRotation + randRotation, originalRotationEnd + randRotation, lifeLeft);

  vec2 alignedPosition = ( scaledPosition.xy - ( center - vec2( 0.5 ) ) ) * scale;
  vec2 rotatedPosition;
  rotatedPosition.x = cos( finalRotation ) * alignedPosition.x - sin( finalRotation ) * alignedPosition.y;
  rotatedPosition.y = sin( finalRotation ) * alignedPosition.x + cos( finalRotation ) * alignedPosition.y;
  
  mat4 instanceMatrix = mat4(
    vec4(1.0, 0.0, 0.0, 0.0),
    vec4(0.0, 1.0, 0.0, 0.0),
    vec4(0.0, 0.0, 1.0, 0.0),
    vec4(pos.x, pos.y, pos.z, 1.0)
  );  

  mvPosition = modelViewMatrix * instanceMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
  mvPosition.xy += rotatedPosition;
  gl_Position = projectionMatrix  * mvPosition;   
`,fB=`
  uniform vec4 uColor;                // start color
  uniform vec4 uColor2;               // end color
  uniform sampler2D uTexture;         // texture
  varying float v_LifeLeft;   // normalized lifetime 1 to 0
  varying vec2 vUv;
  varying vec2 vRef;

  float random(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
  }
  `+TT+`  
  ${uB}

`,pB=({easeOpacity:r="linearFadeOut"})=>`  
  // if Particle is dead, hide it
  if (v_LifeLeft <= 0.005 ) {
    discard;
  }

  #ifdef USE_RANDOM_COLORING
    float randVal = random(vRef); // Generate a random value based on the reference
    vec4 color = mix(uColor, uColor2, randVal); // Interpolate between the two colors
  #else
    vec4 color = mix(uColor, uColor2, 1. - v_LifeLeft);
  #endif

  // Opacity over Life Time
  float finalAlpha = ${r}(1. - v_LifeLeft);  
  vec4 textureColor = texture2D(uTexture, vUv).rgba; 
  finalColor = textureColor.rgb * color.rgb;
  finalAlpha = color.a * textureColor.a * finalAlpha;
  
  gl_FragColor = vec4(finalColor, finalAlpha);     

`,mb=class extends Je{constructor(r,a){super(),this.needsJitter=!0,this.type="ParticleMaterial",this.easeOpacity="linearFadeIn",this.easeSize="linearFadeIn",this.useSizeEnd=!1,this.isColoringRandom=!1,this.init(r,a),this.context=a}reset(){}init(r,a){this.transparent=!0,this.depthTest=!0,this.depthWrite=!1,this.easeOpacity=r.ease,this.easeSize=r.easeSize,this.layers=[],lr.startContext(lr.globalContext),this.lightLayer=new En(0,"",{...Wr.defaultData("light","phong"),visible:!1},new Fa,{},a.shared),lr.endContext(lr.globalContext),this.build()}updateState(r){r.coloring!==void 0&&(this.isColoringRandom=r.coloring==="random"),r.color!==void 0&&(r.color instanceof Array?this.uniforms.uColor.value=r.color:this.uniforms.uColor.value=this.context.shared.color(r.color)),r.color2!==void 0&&(r.color2 instanceof Array?this.uniforms.uColor2.value=r.color2:this.uniforms.uColor2.value=this.context.shared.color(r.color2)),r.size!==void 0&&(this.uniforms.uSize.value=r.size[0],this.uniforms.uSizeEnd.value=r.size[1],r.size[0]!==r.size[1]?this.useSizeEnd=!0:this.useSizeEnd=!1),r.ease!==void 0&&(this.easeOpacity=r.ease,this.build()),r.easeSize!==void 0&&(this.easeSize=r.easeSize,this.build()),this.needsUpdate=!0}onBeforeCompile(r){this.build(),r.defines=this.defines,r.uniforms=this.uniforms,r.vertexShader=this.vertexShader,r.fragmentShader=this.fragmentShader}build(){let r=new Hd;return r.needsJitter=this.needsJitter,r.addFragmentParsCode(DR),r.buildShader("vertex",this.fragment),r.buildShader("fragment",this.fragment),r.addFragmentFinalCode(OR),this.isColoringRandom&&r.define("USE_RANDOM_COLORING"),this.useSizeEnd&&r.define("USE_SIZE_END"),r.addVertexParsCode(hB),r.addFragmentParsCode(fB),r.addVertexFinalCode(dB({easeSize:this.easeSize})),r.addFragmentFinalCode(pB({easeOpacity:this.easeOpacity})),this.vertexShader=r.getCode("vertex"),this.fragmentShader=r.getCode("fragment"),this.defines=r.defines,this.uniforms={...r.uniforms,...this.uniforms},this.extensions=r.extensions,this}get nodeMaterial(){return this}get fragment(){return this.lightLayer.node}getDefines(){return this.defines}nodeMaterialDispose(){this.layers.forEach(r=>r.dispose()),super.dispose()}},Lf=class{constructor(r,a,n,o){this.type="SphereEmitterShape",this.targetMesh=void 0,this.size=r,this.type=n,this.textureSize=$L(a);let f=1;this.targetMesh=(o==null?void 0:o.geometry.type)==="BufferGeometry"||(o==null?void 0:o.type)==="Mesh"&&o&&o.geometry.hasAttribute("position")&&o.geometry.hasAttribute("normal")?o:this.getMesh(n,f);let{positions:y,dataTexture:x,dataTextureNormals:b}=this.createPositions(this.textureSize,this.targetMesh??this.getMesh(n,f));this.positionsTexture=x,this.positionsAttribute=y,this.directionsTexture=b}createPositions(r,a){let{positions:n,normals:o}=eB(a,r*r),f=ET(n,r),y=ET(o,r);return{dataTexture:f,positions:n,dataTextureNormals:y}}getMesh(r,a){let n=null;switch(r){case"SphereEmitterShape":{n=new Fs(a*.5,32,32);break}case"TorusEmitterShape":{n=new Zu(a*.5,.3,15,40);break}case"ConeEmitterShape":{n=new hl(a,a,15);break}case"BoxEmitterShape":{n=new yi(a,a,a);break}case"PlaneEmitterShape":{n=new vi(a,a),n.rotateX(-Math.PI/2);break}case"MeshEmitterShape":{n=new Fs(a,32,32);break}default:{n=new Fs(a,32,32);break}}return new Et(n,new an({color:16711680}))}applyToShader(r,a){this.size=new E().fromArray(a.size),r.uEmitterSize.value=this.size}dispose(){this.positionsTexture.dispose(),this.directionsTexture.dispose(),this.positionsAttribute=new Float32Array}};function sc(r){let a={...r},n=Xh.defaultData;a.forceFieldObjectId&&(a.colliderEntityId=a.forceFieldObjectId);let o={...n.shape,...a.shape},f={...n.renderMaterial,...a.renderMaterial};return{...n,...a,shape:o,renderMaterial:f}}var mB=`
// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU

uniform sampler2D uIndex; // Texture with corresponding index
uniform float uLastIndexEmitted; // Last emitted index
uniform float uParticlesToEmit; // Number of particles to emit on that frame
uniform float uTime;

void main() {
    vec2 vUv = gl_FragCoord.xy / resolution.xy;
    float particleIndex = texture(uIndex, vUv).x;
    float timeLeft = texture2D( uCurrentPosition, vUv ).w;
    float isActive = texture2D( uCurrentEmissionRate, vUv ).g;    // 1. = active, 0. = not active
    float timeStart = texture2D( uCurrentEmissionRate, vUv ).b;


    // ********** Detect Colision to Create a flag and use it in position **********
    // We are doing this here, so

    // ********** Emit Particles **********
    // X = isSpawning 0.0 or 1.0
    // Y = isActive 0.0 or 1.0
    // Check if the vertex index is between the first value and the last value
    // if (particleIndex >= uLastIndexEmitted && particleIndex < uLastIndexEmitted + uParticlesToEmit) {
    //     // Emit a particle by writing 1 to the red channel of the color output
    //     // r: 1. == emit the particle
    //     // g: 1. == particle is now active
    //     timeStart = uTime;
    //     gl_FragColor = vec4(1.0, 1.0, timeStart, 1.0);
    // } else {
    //     // The Particle is either already emitted or not in the range of the particles to emit
    //     // Do not emit a particle by writing 0 to the red channel of the color output        
    //     gl_FragColor = vec4(0.0, isActive, timeStart, 1.0);
    // }
    // Determine if the particle is within the emission range
    float emitLowerBound = step(uLastIndexEmitted, particleIndex);
    float emitUpperBound = step(particleIndex, uLastIndexEmitted + uParticlesToEmit - 1.0);
    float emitParticle = emitLowerBound * emitUpperBound; // 1.0 if in range, 0.0 otherwise

    // Set timeStart and color
    timeStart = mix(timeStart, uTime, emitParticle);
    gl_FragColor = vec4(emitParticle, mix(isActive, 1.0, emitParticle), timeStart, 1.0);


}
`,MT=10,gb=class extends _t{constructor(r,a){super(),this.type="ParticleEmitter",this.debugMode=!1,this.worldSpace=!0,this.rootObject=null,this.gpuCompute=null,this.positionSimRT=null,this.velocitySimRT=null,this.emissionRateSimRT=null,this.emitterShape=void 0,this.isEmitting=!1,this.hasBeenReset=!1,this.emittedParticlesAmount=0,this.lastEmitTime=0,this.globalTime=0,this.targetFPS=60,this.previousRatio=1,this.lerpFactor=.4,this.particlesAmount=0,this.noiseStrength=0,this.noiseScale=0,this.isBillboardBased=!0,this.simFeaturesDefinition={USE_COLLIDER:!1,USE_ATTRACTOR:!1,USE_VORTEX:!1,USE_SPHERE_COLLIDER:!1,USE_BOX_COLLIDER:!1,USE_FORCE_LOCAL_SPACE:!1,USE_NORMALS:!1,USE_CURL_NOISE:!0,USE_SIMPLEX_NOISE:!1,USE_FBM_NOISE:!1},this.textureLoader=new Dy,this.currentWorldPosition=new E,this.systemQuaternion=new Ke,this.worldGravity=new E(0,0,0),this.directionAxis=new E(0,0,0),this.colliderV3=new E(0,0,0),this.colliderQuaternion=new Ke(0,0,0,1),this.matrixAutoUpdate=!0,this.renderer=r,this.system=a,this.shared=a.context.shared;let n=a.data;this.material=new mb(n.renderMaterial,a.context),this.material.uniforms={uSize:{value:0},uSizeEnd:{value:0},uColor:{value:n.renderMaterial.color},uColor2:{value:n.renderMaterial.color2},uPosition:{value:new E(0,0,0)},uEmissionData:{value:new E(0,0,0)},uTexture:{value:this.defaultTexture},uWorldOffset:{value:new E(0,0,0)},uWorldQuaternion:{value:new Qe(0,0,0,1)},uRandScaleFactor:{value:n.randomScale??0},uRandRotationFactor:{value:n.randomRotation??0},uRotation:{value:n.renderMaterial.spriteRotation[0]??0},uRotationEnd:{value:n.renderMaterial.spriteRotation[1]??0}},this.setTexture(this.material.uniforms,n.renderMaterial.texture),this.init(n)}setTexture(r,a){let n=a.data;if(typeof a=="string"){let o=this.shared.image(a),f=new rr(o.img);f.needsUpdate=!0,r.uTexture.value=f;return}if(typeof n!="string"){let o=new Image;o.onload=()=>{let x=new rr(o);x.needsUpdate=!0,r.uTexture.value=x};let f=new Blob([n],{type:"image/*"}),y=URL.createObjectURL(f);o.src=y}}updateGeometryAttributes(r,a){var o;let n=JL(a);!((o=this.emitterShape)!=null&&o.positionsAttribute)||r.geometry.setAttribute("ref",new go(n,2))}applyWorldSpace(){if(!this.system.started||!this.worldSpace||!this.positionSimRT||!this.velocitySimRT)return;let r=this.system;r.getWorldQuaternion(this.systemQuaternion),this.systemQuaternion.invert(),r.getWorldPosition(this.currentWorldPosition),this.material.uniforms.uWorldOffset.value=this.currentWorldPosition,this.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize()),this.positionSimRT.material.uniforms.uWorldOffset.value=this.currentWorldPosition,this.systemQuaternion.invert(),this.positionSimRT.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize()),this.velocitySimRT.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize())}update(r,a){var x;if(!this.gpuCompute||!this.positionSimRT||!this.velocitySimRT||!this.emissionRateSimRT||this.hasBeenReset)return;if(this.checkIfAllParticlesAreDead()&&!this.hasBeenReset){this.reset();return}this.applyWorldSpace(),this.globalTime=r,this.positionSimRT.material.uniforms.uTime.value=r,this.emissionRateSimRT.material.uniforms.uTime.value=r;let n=1e3/a,o=this.targetFPS/n,f=this.previousRatio+(o-this.previousRatio)*this.lerpFactor;this.positionSimRT.material.uniforms.uFPSRatio.value=f,this.previousRatio=f;let y=this.isEmitting?this.GoEmitSomeParticles(r,this.system.data.birthRatePerSec):0;this.emissionRateSimRT.material.uniforms.uLastIndexEmitted.value=this.emittedParticlesAmount,this.emissionRateSimRT.material.uniforms.uParticlesToEmit.value=y,this.material.uniforms.uPosition.value=(x=this.gpuCompute.getCurrentRenderTarget(this.positionSimRT))==null?void 0:x.texture,this.system.colliderEntities.length>0&&this.renderColliders(),this.gpuCompute.compute()}renderColliders(){if(!this.velocitySimRT)return;let r=this.system.colliderEntities[0],a=this.simFeaturesDefinition.USE_COLLIDER||this.simFeaturesDefinition.USE_ATTRACTOR||this.simFeaturesDefinition.USE_VORTEX;if(r.destroyedInAction&&a&&this.init(sc({...this.system.data,colliderEntityId:null})),!r||r.destroyedInAction)return;r.getWorldPosition(this.colliderV3),this.colliderV3.y===0&&(this.colliderV3.y=1e-4),this.velocitySimRT.material.uniforms.uColliderPos.value.copy(this.colliderV3);let n=r.data.size;this.colliderV3.fromArray(n),this.velocitySimRT.material.uniforms.uColliderSize.value.copy(this.simFeaturesDefinition.USE_SPHERE_COLLIDER?this.colliderV3.multiplyScalar(.5):this.colliderV3),r.getWorldQuaternion(this.colliderQuaternion),this.velocitySimRT.material.uniforms.uColliderQuaternion.value.copy(this.colliderQuaternion.normalize()),this.velocitySimRT.material.uniforms.uColliderQuaternionInvert.value.copy(this.colliderQuaternion.normalize().invert())}updateState(r){!this.velocitySimRT||!this.positionSimRT||(r.renderMaterial&&this.updateMaterialState(r.renderMaterial),this.updateParticleState(r))}updateVariableState(r,a){if(!this.velocitySimRT||!this.positionSimRT)return;a[2]==="size"&&this.material.updateState({size:[r,this.material.uniforms.uSizeEnd.value]}),a[2]==="sizeEnd"&&this.material.updateState({size:[this.material.uniforms.uSize.value,r]});let n=(o,f)=>{let y=[...this.system.data.shape.size];y[o]=f,this.updateParticleState({shape:{...this.system.data.shape,size:y}})};a[2]==="shape_size_0"&&n(0,r),a[2]==="shape_size_1"&&n(1,r),a[2]==="shape_size_2"&&n(2,r),a[2]==="speed"&&(this.velocitySimRT.material.uniforms.uSpeed.value=r/MT),a[2]==="gravity"&&this.worldGravity.set(0,r/100,0),a[2]==="noiseStrength"&&(this.noiseStrength=r,this.velocitySimRT.material.uniforms.uNoiseStrength.value=this.noiseStrength),a[2]==="noiseScale"&&(this.noiseScale=r,this.velocitySimRT.material.uniforms.uNoiseScale.value=this.noiseScale),a[2]==="direction_x"&&(this.directionAxis=this.getDirectionAxis([Number(r),this.system.data.direction[1],this.system.data.direction[2]])),a[2]==="direction_y"&&(this.directionAxis=this.getDirectionAxis([this.system.data.direction[0],Number(r),this.system.data.direction[2]])),a[2]==="direction_z"&&(this.directionAxis=this.getDirectionAxis([this.system.data.direction[0],this.system.data.direction[1],Number(r)]))}updateMaterialState(r){this.material.updateState({...r,size:r.size?[Number(this.shared.getVariable(r.size[0],[this.uuid,"particles","size"])),Number(this.shared.getVariable(r.size[1],[this.uuid,"particles","sizeEnd"]))]:[0,0]}),r.texture&&(this.setTexture(this.material.uniforms,r.texture),this.material.needsUpdate=!0)}updateParticleState(r){var a,n,o;if(!(!this.positionSimRT||!this.velocitySimRT)){if(this.shouldReInitGPUCompute(r)&&this.init(sc(this.system.data)),r.life!==void 0&&(this.positionSimRT.material.uniforms.uMaxLifeTime.value=r.life),r.speed!==void 0&&(this.velocitySimRT.material.uniforms.uSpeed.value=Number(this.shared.getVariable(r.speed,[this.uuid,"particles","speed"]))/MT),r.collisionBounce!==void 0&&(this.velocitySimRT.material.uniforms.uBounce.value=r.collisionBounce),r.noiseStrength!==void 0&&(this.noiseStrength=Number(this.shared.getVariable(r.noiseStrength,[this.uuid,"particles","noiseStrength"])),this.velocitySimRT.material.uniforms.uNoiseStrength.value=this.noiseStrength),r.noiseScale!==void 0&&(this.noiseScale=Number(this.shared.getVariable(r.noiseScale,[this.uuid,"particles","noiseScale"])),this.velocitySimRT.material.uniforms.uNoiseScale.value=this.noiseScale),r.noiseSeed!==void 0&&(this.velocitySimRT.material.uniforms.uNoiseSeed.value=r.noiseSeed),r.randomMass!==void 0&&(this.velocitySimRT.material.uniforms.uRandomMassFactor.value=r.randomMass),((a=r.renderMaterial)==null?void 0:a.size)!==void 0){let f=this.shared.getVariable(r.renderMaterial.size[0],[this.uuid,"particles","size"]);this.velocitySimRT.material.uniforms.particleSize.value=Number(f)}if(((n=r.renderMaterial)==null?void 0:n.spriteRotation)!==void 0&&(this.material.uniforms.uRotation.value=r.renderMaterial.spriteRotation[0],this.material.uniforms.uRotationEnd.value=r.renderMaterial.spriteRotation[1]),r.shape!==void 0){let f=r.shape.size??this.system.data.shape.size,y=[Number(this.shared.getVariable(f[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(f[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(f[2],[this.uuid,"particles","shape_size_2"]))],x={...sc(this.system.data).shape,size:y};(o=this.emitterShape)==null||o.applyToShader(this.positionSimRT.material.uniforms,x)}if(r.gravity!==void 0&&(this.worldGravity.set(0,Number(this.shared.getVariable(this.system.data.gravity,[this.uuid,"particles","gravity"]))/100,0),this.velocitySimRT.material.uniforms.uGravity={value:this.worldGravity}),r.direction!==void 0){let f=this.getDirectionFromVariable(r.direction);this.directionAxis=this.getDirectionAxis(f),this.velocitySimRT.material.uniforms.uDirectionsAxis.value=this.directionAxis}r.randomRotation!==void 0&&(this.material.uniforms.uRandRotationFactor.value=r.randomRotation),r.randomScale!==void 0&&(this.material.uniforms.uRandScaleFactor.value=r.randomScale)}}updateForceFieldParameters(r){!this.velocitySimRT||(r.forceIntensity!==void 0&&(this.velocitySimRT.material.uniforms.uForceIntensity.value=r.forceIntensity),r.forceDambing!==void 0&&(this.velocitySimRT.material.uniforms.uForceDamping.value=r.forceDambing))}getDirectionAxis(r){let a=[Number(r[0])*we.DEG2RAD,Number(r[1])*we.DEG2RAD,Number(r[2])*we.DEG2RAD],n=new or(a[0],a[1],a[2],"XYZ");return this.directionAxis.set(0,1,0).applyEuler(n).normalize(),this.velocitySimRT&&(this.velocitySimRT.material.uniforms.uDirectionsAxis.value=this.directionAxis),this.directionAxis}shouldReInitGPUCompute(r){let{birthRatePerSec:a,rootObjectType:n,colliderEntityId:o,shape:f,emitTimeDuration:y,emitTimeCycle:x,life:b,directionMode:_,noiseType:S}=r;return a!==void 0||n!==void 0||o||o===null||x!==void 0||f!==void 0||b!==void 0||y!==void 0||_!==void 0||S!==void 0}init(r){this.dispose(),this.particlesAmount=this.getMaxParticlesAmount({birthRatePerSecond:r.birthRatePerSec,particleMaxLifeTime:r.life,loopDuration:r.emitTimeCycle==="infinity"?0:r.emitTimeDuration}),this.particlesAmount>1e5&&(console.warn("The maximum number of particles is limited to 100000."),this.particlesAmount=1e5),this.emitterShape=this.createShape(r.shape,this.particlesAmount);let a=setInterval(()=>{if(this.emitterShape)if(isNaN(this.emitterShape.positionsTexture.source.data.data[0])){this.init(r);return}else clearInterval(a)},100);if(!this.emitterShape)return;let n=new db(this.emitterShape.textureSize,this.emitterShape.textureSize,this.renderer),o=this.updateSimulationDefinition(r),f=n.addVariable("uCurrentPosition",o+iB,this.emitterShape.positionsTexture),y=n.addVariable("uCurrentVelocity",o+lB,this.emitterShape.directionsTexture),x=n.addVariable("uCurrentEmissionRate",mB,rB(this.emitterShape.textureSize));n.setVariableDependencies(f,[f,y,x]),n.setVariableDependencies(y,[f,y,x]),n.setVariableDependencies(x,[f,y,x]);let b=tB({size:this.emitterShape.textureSize}),_={uOriginalPosition:{value:this.emitterShape.positionsTexture},uWorldOffset:{value:new E(0,0,0)},uWorldQuaternion:{value:new Qe(0,0,0,1)},uTime:{value:0},uFPSRatio:{value:1},uMaxLifeTime:{value:r.life},uEmitterSize:{value:new E(Number(this.shared.getVariable(r.shape.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(r.shape.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(r.shape.size[2],[this.uuid,"particles","shape_size_2"])))},particleSize:{value:0}};f.material.uniforms=_;let S=this.getDirectionFromVariable(r.direction);this.directionAxis=this.getDirectionAxis(S),this.worldGravity.set(0,Number(this.shared.getVariable(this.system.data.gravity,[this.uuid,"particles","gravity"]))/100,0),this.noiseStrength=Number(this.shared.getVariable(r.noiseStrength,[this.uuid,"particles","noiseStrength"])),this.noiseScale=Number(this.shared.getVariable(r.noiseScale,[this.uuid,"particles","noiseScale"]));let A=r.colliderEntityId&&this.system.getColliderData(r.colliderEntityId),C={uOriginalPosition:{value:this.emitterShape.positionsTexture},uDirections:{value:this.emitterShape.directionsTexture},uDirectionsAxis:{value:this.directionAxis},uWorldQuaternion:{value:new Qe(0,0,0,1)},uColliderPos:{value:new E(0,0,0)},uColliderSize:{value:new E(0,0,0)},uForceIntensity:{value:A?A.forceIntensity:0},uForceDamping:{value:A?A.forceDambing:0},uColliderQuaternion:{value:new Qe(0,0,0,1)},uColliderQuaternionInvert:{value:new Qe(0,0,0,1)},particleSize:{value:0},uGravity:{value:this.worldGravity},uNoiseStrength:{value:this.noiseStrength},uNoiseScale:{value:this.noiseScale},uNoiseSeed:{value:r.noiseSeed},uRandomMassFactor:{value:r.randomMass},uBounce:{value:r.collisionBounce},uSpeed:{value:Number(this.shared.getVariable(r.speed,[this.uuid,"particles","speed"]))/MT}};y.material.uniforms=C;let P={uIndex:{value:b},uTime:{value:0},uLastIndexEmitted:{value:0},uParticlesToEmit:{value:0}};x.material.uniforms=P;let T=[Number(this.shared.getVariable(r.shape.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(r.shape.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(r.shape.size[2],[this.uuid,"particles","shape_size_2"]))],M={...sc(this.system.data).shape,size:T};this.emitterShape.applyToShader(f.material.uniforms,M),n.init(),this.gpuCompute=n,this.positionSimRT=f,this.velocitySimRT=y,this.emissionRateSimRT=x,this.rootObject=this.createPrimaryEmitter(this.emitterShape.textureSize),this.add(this.rootObject),this.material.needsUpdate=!0}getDirectionFromVariable(r){let a=Number(this.shared.getVariable(r[0],[this.uuid,"particles","direction_x"])),n=Number(this.shared.getVariable(r[1],[this.uuid,"particles","direction_y"])),o=Number(this.shared.getVariable(r[2],[this.uuid,"particles","direction_z"]));return[a,n,o]}updateSimulationDefinition(r){if(this.simFeaturesDefinition.USE_COLLIDER=!1,this.simFeaturesDefinition.USE_ATTRACTOR=!1,this.simFeaturesDefinition.USE_VORTEX=!1,this.simFeaturesDefinition.USE_SPHERE_COLLIDER=!1,this.simFeaturesDefinition.USE_BOX_COLLIDER=!1,this.simFeaturesDefinition.USE_FORCE_LOCAL_SPACE=!1,this.simFeaturesDefinition.USE_NORMALS=!1,this.simFeaturesDefinition.USE_CURL_NOISE=!1,this.simFeaturesDefinition.USE_SIMPLEX_NOISE=!1,this.simFeaturesDefinition.USE_FBM_NOISE=!1,r.colliderEntityId&&this.system.colliderEntities.length>0){let n=this.system.getColliderData(r.colliderEntityId);switch(n==null?void 0:n.forceType){case"attractor":this.simFeaturesDefinition.USE_ATTRACTOR=!0;break;case"collider":this.simFeaturesDefinition.USE_COLLIDER=!0;break;case"vortex":this.simFeaturesDefinition.USE_VORTEX=!0;break}let o=n==null?void 0:n.colliderType;o==="sphere"&&(this.simFeaturesDefinition.USE_SPHERE_COLLIDER=!0),o==="box"&&(this.simFeaturesDefinition.USE_BOX_COLLIDER=!0),(n==null?void 0:n.forceRange)==="helper"&&(this.simFeaturesDefinition.USE_FORCE_LOCAL_SPACE=!0)}r.directionMode==="normals"&&(this.simFeaturesDefinition.USE_NORMALS=!0),r.noiseType==="curl"&&(this.simFeaturesDefinition.USE_CURL_NOISE=!0),r.noiseType==="simplex"&&(this.simFeaturesDefinition.USE_SIMPLEX_NOISE=!0),r.noiseType==="fbm"&&(this.simFeaturesDefinition.USE_FBM_NOISE=!0);let a="";for(let[n,o]of Object.entries(this.simFeaturesDefinition))o&&(a+=`#define ${n}
`);return a}createShape(r,a){this.emitterShape&&this.emitterShape.dispose();let n=new E(Number(this.shared.getVariable(r.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(r.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(r.size[2],[this.uuid,"particles","shape_size_2"])));if(r.type==="MeshEmitterShape"){let o=null;return this.system.context.scene.traverseEntity(f=>{f.uuid===r.fromMeshId&&(o=f)}),o?new Lf(n,a,r.type,o):new Lf(n,a,"SphereEmitterShape")}else return new Lf(n,a,r.type)}createPrimaryEmitter(r){let a,n=r*r;return a=new Ey(new vi(1,1,1),this.material,n),this.updateGeometryAttributes(a,r),this.material.needsUpdate=!0,a.onBeforeRender=()=>{this.applyWorldSpace()},a}getMaxParticlesAmount({birthRatePerSecond:r,particleMaxLifeTime:a,loopDuration:n=0}){return Math.ceil(r*(a+n))}dispose(){var r,a,n;!this.gpuCompute||((a=(r=this.rootObject)==null?void 0:r.parent)==null||a.remove(this.rootObject),this.gpuCompute.dispose(),this.material.nodeMaterialDispose(),(n=this.emitterShape)==null||n.dispose())}GoEmitSomeParticles(r,a){let n=r-this.lastEmitTime,o=1/a;if(n>=o){let f=Math.max(1,Math.floor(n/o));return this.lastEmitTime=r,this.emittedParticlesAmount+f>this.particlesAmount&&(this.emittedParticlesAmount=0),this.emittedParticlesAmount+=f,f}return 0}checkIfAllParticlesAreDead(){return this.lastEmitTime+this.system.data.life+1<this.globalTime}reset(){this.hasBeenReset=!0,this.lastEmitTime=0,this.emittedParticlesAmount=0,this.gpuCompute&&this.init(sc(this.system.data))}startEmitting(r){this.isEmitting=!0,this.hasBeenReset=!1,this.lastEmitTime=r}stopEmitting(){this.isEmitting=!1}},Xo=class extends yr{constructor(r,a,n){super(r,a),this.type="ParticleSystem",this.geometry=new Ce,this.actualTime=0,this.currentLoopTime=0,this.started=!1,this.stopped=!1,this.timeoutId=void 0,this.isFrozen=!1,this.isIdle=!0,this.emitter=null,this.colliderEntities=[],this.renderer=null,this.isPreWarm=!1,this._hasOnAfterRenderBeenCalled=!1,this.onAfterRender=o=>{this._hasOnAfterRenderBeenCalled||(this._hasOnAfterRenderBeenCalled=!0,this.init(o))},this.context=n,this.data={...a,...sc(a)},this.geometry.setAttribute("position",new Te([],3)),this.material=new an({colorWrite:!1}),this.frustumCulled=!1}init(r){this.renderer=r,this.emitter=new gb(r,this),this.add(this.emitter),this.updateParticleState(this.data)}update(r){if(!this.isReady||!this.started||this.isFrozen||this.isIdle)return;this.actualTime+=r,this.stopped||(this.currentLoopTime+=r);let a=this.data.emitTimeCycle==="one_time";if((this.data.emitTimeCycle==="loop"||a)&&this.currentLoopTime>this.data.emitTimeDuration*1e3&&(this.stopped||(this.stop(),a||this.start(this.data.emitTimeDelay*1e3))),this.emitter&&this.started){let n=this.actualTime/1e3;this.emitter.update(n,r)}this.scale.set(1,1,1),this.updateMatrix()}isReady(){return!!this.emitter}hasCollider(r){return this.colliderEntities.some(a=>a.identity===r)}getColliderData(r){let a=this.colliderEntities.find(n=>n.identity===r);return a?a.data:null}updateByPatchedOp(r,a,n){super.updateByPatchedOp(r,a,n),Vt(r.path,["renderMaterial"])&&this.updateParticleState({renderMaterial:{...this.data.renderMaterial,...Vr.drop(r,1).props}}),Vt(r.path,["shape"])&&this.updateParticleState({shape:{...this.data.shape,...Vr.drop(r,1).props}})}updateState(r,a){super.updateState(r,a),this.updateParticleState(r)}updateParticleState(r){if(this.emitter){if(r.colliderEntityId!==void 0&&r.colliderEntityId!==null){let a=this.context.scene.find(r.colliderEntityId);this.colliderEntities=a?[a]:[]}r.colliderEntityId===null&&(this.colliderEntities=[]),this.emitter.updateState(r),r.emitTimeCycle&&this.started&&this.start()}}updateFromColliderEntity(r){!this.emitter||(this.emitter.updateForceFieldParameters(r),this.stop(),this.start())}start(r=0){var a;if(this.currentLoopTime=0,r){this.timeoutId=window.setTimeout(()=>{this.start(0)},r);return}this.started=!0,this.stopped=!1,this.isFrozen=!1,(a=this.emitter)==null||a.startEmitting(this.actualTime/1e3)}froze(){this.isFrozen=!0}unFroze(){this.isFrozen=!1}stop(){var r;this.stopped=!0,this.currentLoopTime=0,(r=this.emitter)==null||r.stopEmitting(),clearTimeout(this.timeoutId)}reset(){var r;this.started=!1,this.stopped=!1,(r=this.emitter)==null||r.reset()}wakeUp(){this.isIdle=!1}sleep(){this.isIdle=!0,this.reset()}};function DZ(){try{let r=window.location.href;if(r.includes("reducesubdiv=")){let a=r.indexOf("reducesubdiv=")+13;return parseInt(r.slice(a,a+1))}}catch{}}var CT=DZ();function OZ(r,a,n){var f;CT!==void 0&&(((f=a==null?void 0:a.geometry)==null?void 0:f.subdivisions)??0)>CT&&(console.log("reducing subdivisions",a.name,a.geometry.subdivisions),a.geometry.subdivisions=CT);let o;return a.geometry.type==="TextGeometry"?new Kl(r,a,n):a.geometry.type==="InputGeometry"?new nc(r,a,n):(a.geometry.type==="SubdivGeometry"?o=new Js(r,a,n):a.geometry.type==="PathGeometry"?o=new ic(r,a,n):a.geometry.type==="VectorGeometry"?o=new cb(r,a,n):a.geometry.type==="BooleanGeometry"?o=new Un(r,a,n):a.geometry.type==="ShapeBlendGeometry"?o=new ts(r,a,n):a.geometry.type==="UIGeometry"?o=new Mr(r,a,n):o=new jt(r,a,n),o)}function yb(r,a,n){return console.assert(a.type!==void 0),a.type==="Mesh"?OZ(r,a,n):a.type==="Empty"?new Ts(r,a):a.type==="Particle"?new Xo(r,a,n):a.type==="ParticleCollider"?new Ho(r,a,n):a.type==="Splat"?new Ts(r,a):a.type==="Bone"?new hb(r,a):a.type==="Page"?new hr(r,a,n):a.type==="PointLight"?new lb(r,a,n):a.type==="SpotLight"?new Df(r,a,n):a.type==="DirectionalLight"?new If(r,a,n):a.type==="Component"||a.type==="Instance"?new to(r,a,n):ks.is(a.type)?new Er(r,a):(console.error(a),new Ts(r,a))}Ws.createEntity=yb;function RZ(r,a,n){let o=yb(r.identity,a,n),f=r.children,y=r.attachedPaths,x=r.parent,b=r.component,_=r.instances,S=r.overrideData,A=r.uuid,C=r.stateSelection;r.dispose();for(let P of Object.keys(r))delete r[P];Object.setPrototypeOf(r,Object.getPrototypeOf(o));for(let P of Object.keys(o))r[P]=o[P];r.children=[...r.children,...f],r.attachedPaths=y,r.parent=x,r.component=b,r.instances=_,r.uuid=A,r.overrideData=S,r.updateState(r.data,n),C&&r.changeSelectedState(C,n),r.resetBBoxNeedsUpdate()}Ws.changeEntityProptotype=RZ;Ws.Cloner=bi;var oc=5,Bf=new Ce;Bf.setAttribute("position",new Ge(new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),3));var uu=class extends Cy{constructor(r){super({...r,depthTest:!1,depthWrite:!1,glslVersion:my,vertexShader:`
				precision highp float;
				in vec3 position;
				void main() {
					gl_Position = vec4(position, 1);
				}
			`})}customProgramCacheKey(){return""}};function vB(){return{shapeInput:()=>`
			const float posRowCoord = ${.5/oc};  // vec4: px py pz opType
			const float quatRowCoord = ${1.5/oc};  // vec4: qx qy qz qw
			const float param1RowCoord = ${2.5/oc};// vec4: type param1 param2 param3
			const float param2RowCoord = ${3.5/oc};// vec4: blendRange roundness scale param4
			const float colorRowCoord = ${4.5/oc}; // vec4: r g b a
			uniform sampler2D shapesDataTexture;
			vec4 shapePos(float iin) { 
				vec4 r = texture(shapesDataTexture, vec2(iin, posRowCoord));
				return r;
			}
			vec4 shapeQuat(float iin) {
				vec4 r = texture(shapesDataTexture, vec2(iin, quatRowCoord));
				return r;
			}
			vec4 shapeParams1(float iin) {
				vec4 r = texture(shapesDataTexture, vec2(iin, param1RowCoord));
				return r;
			}
			vec4 shapeParams2(float iin) {
				vec4 r = texture(shapesDataTexture, vec2(iin, param2RowCoord));
				return r;
			}
			vec4 shapeColor(float iin) {
				vec4 r = texture(shapesDataTexture, vec2(iin, colorRowCoord));
				return r;
			}
		`,getxyzi:`
			// this code must complement lookup
			float xi = mod(gl_FragCoord.x - 0.5, VOXEL_RESOLUTION);
			float yi = mod(gl_FragCoord.y - 0.5, VOXEL_RESOLUTION);
			float zi = floor((gl_FragCoord.x - 0.5) * INV_VOXEL_RESOLUTION) + floor((gl_FragCoord.y - 0.5) * INV_VOXEL_RESOLUTION) * Z_LAYERS_PER_ROW;
		`,lookup:`
			uniform sampler2D potentialPassTexture;
			uniform sampler2D voxelPassTexture; // includes normal (in xyz) and key (in w)
			
			// box or marching cube lookup value in value texture, integer box coord inputs
			// this code must complement codebits.getxyzi
			vec4 look(float xi, float yi, float zi, sampler2D rt) {// range 0 .. numv etc
				vec2 uv = vec2(
					mod(zi, Z_LAYERS_PER_ROW) + (xi + 0.5) / VOXEL_RESOLUTION,
					floor(zi / Z_LAYERS_PER_ROW) + (yi + 0.5) / VOXEL_RESOLUTION
				); 
				uv /= Z_LAYERS_PER_ROW;
				return texture(rt, uv);
			}
		`,getpart:`
			float getpart(inout float a, float b) {
				float t = floor(a/b);
				float r = a - t*b;
				a = t;
				return r;
			}
		`,triTable:new Float32Array([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,1,1,8,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,2,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,0,10,2,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,2,9,9,2,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,2,8,10,2,8,9,10,-1,-1,-1,-1,-1,-1,-1,2,11,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,11,0,0,11,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,9,1,11,3,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,11,1,11,9,1,11,8,9,-1,-1,-1,-1,-1,-1,-1,1,10,3,3,10,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,10,0,10,8,0,10,11,8,-1,-1,-1,-1,-1,-1,-1,0,9,3,9,11,3,9,10,11,-1,-1,-1,-1,-1,-1,-1,10,8,9,11,8,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,7,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,4,4,3,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,0,7,4,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,4,1,7,4,1,3,7,-1,-1,-1,-1,-1,-1,-1,10,2,1,7,4,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,4,3,4,0,3,10,2,1,-1,-1,-1,-1,-1,-1,-1,10,2,9,2,0,9,7,4,8,-1,-1,-1,-1,-1,-1,-1,9,10,2,7,9,2,3,7,2,4,9,7,-1,-1,-1,-1,7,4,8,2,11,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,4,11,4,2,11,4,0,2,-1,-1,-1,-1,-1,-1,-1,1,0,9,7,4,8,11,3,2,-1,-1,-1,-1,-1,-1,-1,11,7,4,11,4,9,2,11,9,1,2,9,-1,-1,-1,-1,1,10,3,10,11,3,4,8,7,-1,-1,-1,-1,-1,-1,-1,10,11,1,11,4,1,4,0,1,4,11,7,-1,-1,-1,-1,8,7,4,11,0,9,10,11,9,3,0,11,-1,-1,-1,-1,11,7,4,9,11,4,10,11,9,-1,-1,-1,-1,-1,-1,-1,4,5,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,5,9,3,8,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,5,0,0,5,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,5,8,5,3,8,5,1,3,-1,-1,-1,-1,-1,-1,-1,10,2,1,4,5,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,0,3,10,2,1,5,9,4,-1,-1,-1,-1,-1,-1,-1,10,2,5,2,4,5,2,0,4,-1,-1,-1,-1,-1,-1,-1,5,10,2,5,2,3,4,5,3,8,4,3,-1,-1,-1,-1,4,5,9,11,3,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,11,0,11,8,0,5,9,4,-1,-1,-1,-1,-1,-1,-1,4,5,0,5,1,0,11,3,2,-1,-1,-1,-1,-1,-1,-1,5,1,2,8,5,2,11,8,2,5,8,4,-1,-1,-1,-1,11,3,10,3,1,10,4,5,9,-1,-1,-1,-1,-1,-1,-1,5,9,4,1,8,0,1,10,8,10,11,8,-1,-1,-1,-1,0,4,5,11,0,5,10,11,5,3,0,11,-1,-1,-1,-1,8,4,5,10,8,5,11,8,10,-1,-1,-1,-1,-1,-1,-1,8,7,9,9,7,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,9,3,5,9,3,7,5,-1,-1,-1,-1,-1,-1,-1,8,7,0,7,1,0,7,5,1,-1,-1,-1,-1,-1,-1,-1,3,5,1,7,5,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,7,9,7,5,9,2,1,10,-1,-1,-1,-1,-1,-1,-1,2,1,10,0,5,9,0,3,5,3,7,5,-1,-1,-1,-1,2,0,8,5,2,8,7,5,8,2,5,10,-1,-1,-1,-1,5,10,2,3,5,2,7,5,3,-1,-1,-1,-1,-1,-1,-1,5,9,7,9,8,7,2,11,3,-1,-1,-1,-1,-1,-1,-1,7,5,9,2,7,9,0,2,9,11,7,2,-1,-1,-1,-1,11,3,2,8,1,0,8,7,1,7,5,1,-1,-1,-1,-1,1,2,11,7,1,11,5,1,7,-1,-1,-1,-1,-1,-1,-1,8,5,9,7,5,8,3,1,10,11,3,10,-1,-1,-1,-1,0,7,5,9,0,5,0,11,7,10,0,1,0,10,11,-1,0,10,11,3,0,11,0,5,10,7,0,8,0,7,5,-1,5,10,11,5,11,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,0,6,10,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,0,9,6,10,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,1,8,9,1,6,10,5,-1,-1,-1,-1,-1,-1,-1,5,6,1,1,6,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,6,1,6,2,1,8,0,3,-1,-1,-1,-1,-1,-1,-1,5,6,9,6,0,9,6,2,0,-1,-1,-1,-1,-1,-1,-1,8,9,5,2,8,5,6,2,5,8,2,3,-1,-1,-1,-1,11,3,2,5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,0,11,0,2,11,5,6,10,-1,-1,-1,-1,-1,-1,-1,9,1,0,11,3,2,6,10,5,-1,-1,-1,-1,-1,-1,-1,6,10,5,2,9,1,2,11,9,11,8,9,-1,-1,-1,-1,11,3,6,3,5,6,3,1,5,-1,-1,-1,-1,-1,-1,-1,11,8,0,5,11,0,1,5,0,6,11,5,-1,-1,-1,-1,6,11,3,6,3,0,5,6,0,9,5,0,-1,-1,-1,-1,9,5,6,11,9,6,8,9,11,-1,-1,-1,-1,-1,-1,-1,6,10,5,8,7,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,4,3,7,4,10,5,6,-1,-1,-1,-1,-1,-1,-1,0,9,1,6,10,5,7,4,8,-1,-1,-1,-1,-1,-1,-1,5,6,10,7,9,1,3,7,1,4,9,7,-1,-1,-1,-1,2,1,6,1,5,6,8,7,4,-1,-1,-1,-1,-1,-1,-1,5,2,1,6,2,5,4,0,3,7,4,3,-1,-1,-1,-1,7,4,8,5,0,9,5,6,0,6,2,0,-1,-1,-1,-1,9,3,7,4,9,7,9,2,3,6,9,5,9,6,2,-1,2,11,3,4,8,7,5,6,10,-1,-1,-1,-1,-1,-1,-1,6,10,5,2,7,4,0,2,4,11,7,2,-1,-1,-1,-1,9,1,0,8,7,4,11,3,2,6,10,5,-1,-1,-1,-1,1,2,9,2,11,9,11,4,9,4,11,7,6,10,5,-1,7,4,8,5,11,3,1,5,3,6,11,5,-1,-1,-1,-1,11,1,5,6,11,5,11,0,1,4,11,7,11,4,0,-1,9,5,0,5,6,0,6,3,0,3,6,11,7,4,8,-1,9,5,6,11,9,6,9,7,4,9,11,7,-1,-1,-1,-1,9,4,10,10,4,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,10,4,10,9,4,3,8,0,-1,-1,-1,-1,-1,-1,-1,1,0,10,0,6,10,0,4,6,-1,-1,-1,-1,-1,-1,-1,1,3,8,6,1,8,4,6,8,10,1,6,-1,-1,-1,-1,9,4,1,4,2,1,4,6,2,-1,-1,-1,-1,-1,-1,-1,8,0,3,9,2,1,9,4,2,4,6,2,-1,-1,-1,-1,4,2,0,6,2,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,4,2,8,6,2,4,-1,-1,-1,-1,-1,-1,-1,9,4,10,4,6,10,3,2,11,-1,-1,-1,-1,-1,-1,-1,2,8,0,11,8,2,10,9,4,6,10,4,-1,-1,-1,-1,2,11,3,6,1,0,4,6,0,10,1,6,-1,-1,-1,-1,1,4,6,10,1,6,1,8,4,11,1,2,1,11,8,-1,4,6,9,6,3,9,3,1,9,3,6,11,-1,-1,-1,-1,1,11,8,0,1,8,1,6,11,4,1,9,1,4,6,-1,6,11,3,0,6,3,4,6,0,-1,-1,-1,-1,-1,-1,-1,8,4,6,8,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,10,7,10,8,7,10,9,8,-1,-1,-1,-1,-1,-1,-1,3,7,0,7,10,0,10,9,0,10,7,6,-1,-1,-1,-1,7,6,10,7,10,1,8,7,1,0,8,1,-1,-1,-1,-1,7,6,10,1,7,10,3,7,1,-1,-1,-1,-1,-1,-1,-1,6,2,1,8,6,1,9,8,1,7,6,8,-1,-1,-1,-1,9,6,2,1,9,2,9,7,6,3,9,0,9,3,7,-1,0,8,7,6,0,7,2,0,6,-1,-1,-1,-1,-1,-1,-1,2,3,7,2,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,3,2,8,6,10,9,8,10,7,6,8,-1,-1,-1,-1,7,0,2,11,7,2,7,9,0,10,7,6,7,10,9,-1,0,8,1,8,7,1,7,10,1,10,7,6,11,3,2,-1,1,2,11,7,1,11,1,6,10,1,7,6,-1,-1,-1,-1,6,9,8,7,6,8,6,1,9,3,6,11,6,3,1,-1,1,9,0,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,7,6,0,7,0,11,3,0,6,11,-1,-1,-1,-1,6,11,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,6,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,0,3,6,7,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,0,6,7,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,8,1,3,8,6,7,11,-1,-1,-1,-1,-1,-1,-1,2,1,10,7,11,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,2,1,8,0,3,7,11,6,-1,-1,-1,-1,-1,-1,-1,0,9,2,9,10,2,7,11,6,-1,-1,-1,-1,-1,-1,-1,7,11,6,3,10,2,3,8,10,8,9,10,-1,-1,-1,-1,3,2,7,7,2,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,0,7,0,6,7,0,2,6,-1,-1,-1,-1,-1,-1,-1,6,7,2,7,3,2,9,1,0,-1,-1,-1,-1,-1,-1,-1,2,6,1,6,8,1,8,9,1,6,7,8,-1,-1,-1,-1,6,7,10,7,1,10,7,3,1,-1,-1,-1,-1,-1,-1,-1,6,7,10,10,7,1,7,8,1,8,0,1,-1,-1,-1,-1,7,3,0,10,7,0,9,10,0,7,10,6,-1,-1,-1,-1,10,6,7,8,10,7,9,10,8,-1,-1,-1,-1,-1,-1,-1,4,8,6,6,8,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,6,3,6,0,3,6,4,0,-1,-1,-1,-1,-1,-1,-1,11,6,8,6,4,8,1,0,9,-1,-1,-1,-1,-1,-1,-1,6,4,9,3,6,9,1,3,9,6,3,11,-1,-1,-1,-1,4,8,6,8,11,6,1,10,2,-1,-1,-1,-1,-1,-1,-1,10,2,1,11,0,3,11,6,0,6,4,0,-1,-1,-1,-1,8,11,4,11,6,4,9,2,0,9,10,2,-1,-1,-1,-1,3,9,10,2,3,10,3,4,9,6,3,11,3,6,4,-1,3,2,8,2,4,8,2,6,4,-1,-1,-1,-1,-1,-1,-1,2,4,0,2,6,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,9,1,4,3,2,6,4,2,8,3,4,-1,-1,-1,-1,4,9,1,2,4,1,6,4,2,-1,-1,-1,-1,-1,-1,-1,3,1,8,1,6,8,6,4,8,1,10,6,-1,-1,-1,-1,0,1,10,6,0,10,4,0,6,-1,-1,-1,-1,-1,-1,-1,3,6,4,8,3,4,3,10,6,9,3,0,3,9,10,-1,4,9,10,4,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,9,4,11,6,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,0,5,9,4,6,7,11,-1,-1,-1,-1,-1,-1,-1,1,0,5,0,4,5,11,6,7,-1,-1,-1,-1,-1,-1,-1,6,7,11,4,3,8,4,5,3,5,1,3,-1,-1,-1,-1,4,5,9,2,1,10,11,6,7,-1,-1,-1,-1,-1,-1,-1,7,11,6,10,2,1,3,8,0,5,9,4,-1,-1,-1,-1,11,6,7,10,4,5,10,2,4,2,0,4,-1,-1,-1,-1,8,4,3,4,5,3,5,2,3,2,5,10,6,7,11,-1,3,2,7,2,6,7,9,4,5,-1,-1,-1,-1,-1,-1,-1,4,5,9,6,8,0,2,6,0,7,8,6,-1,-1,-1,-1,2,6,3,6,7,3,0,5,1,0,4,5,-1,-1,-1,-1,8,2,6,7,8,6,8,1,2,5,8,4,8,5,1,-1,4,5,9,6,1,10,6,7,1,7,3,1,-1,-1,-1,-1,10,6,1,6,7,1,7,0,1,0,7,8,4,5,9,-1,10,0,4,5,10,4,10,3,0,7,10,6,10,7,3,-1,10,6,7,8,10,7,10,4,5,10,8,4,-1,-1,-1,-1,5,9,6,9,11,6,9,8,11,-1,-1,-1,-1,-1,-1,-1,11,6,3,3,6,0,6,5,0,5,9,0,-1,-1,-1,-1,8,11,0,11,5,0,5,1,0,11,6,5,-1,-1,-1,-1,3,11,6,5,3,6,1,3,5,-1,-1,-1,-1,-1,-1,-1,10,2,1,11,5,9,8,11,9,6,5,11,-1,-1,-1,-1,3,11,0,11,6,0,6,9,0,9,6,5,10,2,1,-1,5,8,11,6,5,11,5,0,8,2,5,10,5,2,0,-1,3,11,6,5,3,6,3,10,2,3,5,10,-1,-1,-1,-1,9,8,5,8,2,5,2,6,5,2,8,3,-1,-1,-1,-1,6,5,9,0,6,9,2,6,0,-1,-1,-1,-1,-1,-1,-1,8,5,1,0,8,1,8,6,5,2,8,3,8,2,6,-1,6,5,1,6,1,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,3,1,10,6,1,6,8,3,9,6,5,6,9,8,-1,0,1,10,6,0,10,0,5,9,0,6,5,-1,-1,-1,-1,8,3,0,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,5,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,11,11,5,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,11,5,7,11,0,3,8,-1,-1,-1,-1,-1,-1,-1,7,11,5,11,10,5,0,9,1,-1,-1,-1,-1,-1,-1,-1,5,7,10,7,11,10,1,8,9,1,3,8,-1,-1,-1,-1,2,1,11,1,7,11,1,5,7,-1,-1,-1,-1,-1,-1,-1,3,8,0,7,2,1,5,7,1,11,2,7,-1,-1,-1,-1,5,7,9,7,2,9,2,0,9,7,11,2,-1,-1,-1,-1,2,5,7,11,2,7,2,9,5,8,2,3,2,8,9,-1,10,5,2,5,3,2,5,7,3,-1,-1,-1,-1,-1,-1,-1,0,2,8,2,5,8,5,7,8,5,2,10,-1,-1,-1,-1,1,0,9,3,10,5,7,3,5,2,10,3,-1,-1,-1,-1,2,8,9,1,2,9,2,7,8,5,2,10,2,5,7,-1,5,3,1,5,7,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,8,0,1,7,0,5,7,1,-1,-1,-1,-1,-1,-1,-1,3,0,9,5,3,9,7,3,5,-1,-1,-1,-1,-1,-1,-1,7,8,9,7,9,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,8,5,8,10,5,8,11,10,-1,-1,-1,-1,-1,-1,-1,4,0,5,0,11,5,11,10,5,0,3,11,-1,-1,-1,-1,9,1,0,10,4,8,11,10,8,5,4,10,-1,-1,-1,-1,4,11,10,5,4,10,4,3,11,1,4,9,4,1,3,-1,1,5,2,5,8,2,8,11,2,8,5,4,-1,-1,-1,-1,11,4,0,3,11,0,11,5,4,1,11,2,11,1,5,-1,5,2,0,9,5,0,5,11,2,8,5,4,5,8,11,-1,5,4,9,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,2,2,5,3,5,4,3,4,8,3,-1,-1,-1,-1,2,10,5,4,2,5,0,2,4,-1,-1,-1,-1,-1,-1,-1,2,10,3,10,5,3,5,8,3,8,5,4,9,1,0,-1,2,10,5,4,2,5,2,9,1,2,4,9,-1,-1,-1,-1,5,4,8,3,5,8,1,5,3,-1,-1,-1,-1,-1,-1,-1,5,4,0,5,0,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,4,8,3,5,8,5,0,9,5,3,0,-1,-1,-1,-1,5,4,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,11,4,11,9,4,11,10,9,-1,-1,-1,-1,-1,-1,-1,3,8,0,7,9,4,7,11,9,11,10,9,-1,-1,-1,-1,11,10,1,4,11,1,0,4,1,11,4,7,-1,-1,-1,-1,4,1,3,8,4,3,4,10,1,11,4,7,4,11,10,-1,7,11,4,4,11,9,11,2,9,2,1,9,-1,-1,-1,-1,4,7,9,7,11,9,11,1,9,1,11,2,3,8,0,-1,4,7,11,2,4,11,0,4,2,-1,-1,-1,-1,-1,-1,-1,4,7,11,2,4,11,4,3,8,4,2,3,-1,-1,-1,-1,10,9,2,9,7,2,7,3,2,9,4,7,-1,-1,-1,-1,7,10,9,4,7,9,7,2,10,0,7,8,7,0,2,-1,10,7,3,2,10,3,10,4,7,0,10,1,10,0,4,-1,2,10,1,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,4,7,1,4,3,1,7,-1,-1,-1,-1,-1,-1,-1,1,9,4,7,1,4,1,8,0,1,7,8,-1,-1,-1,-1,3,0,4,3,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,8,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,10,9,8,11,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,0,3,11,9,3,10,9,11,-1,-1,-1,-1,-1,-1,-1,10,1,0,8,10,0,11,10,8,-1,-1,-1,-1,-1,-1,-1,10,1,3,10,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,2,1,9,11,1,8,11,9,-1,-1,-1,-1,-1,-1,-1,9,0,3,11,9,3,9,2,1,9,11,2,-1,-1,-1,-1,11,2,0,11,0,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,2,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,2,10,8,2,9,8,10,-1,-1,-1,-1,-1,-1,-1,2,10,9,2,9,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,2,10,8,2,8,1,0,8,10,1,-1,-1,-1,-1,2,10,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,1,8,1,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),numTrisTable:new Float32Array([0,1,1,2,1,2,2,3,1,2,2,3,2,3,3,2,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,3,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,3,2,3,3,2,3,4,4,3,3,4,4,3,4,5,5,2,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,3,2,3,3,4,3,4,4,5,3,4,4,5,4,5,5,4,2,3,3,4,3,4,2,3,3,4,4,5,4,5,3,2,3,4,4,3,4,5,3,2,4,5,5,4,5,2,4,1,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,3,2,3,3,4,3,4,4,5,3,2,4,3,4,3,5,2,2,3,3,4,3,4,4,5,3,4,4,5,4,5,5,4,3,4,4,3,4,5,5,4,4,3,5,2,5,4,2,1,2,3,3,4,3,4,4,5,3,4,4,5,2,3,3,2,3,4,4,5,4,5,5,2,4,3,5,4,3,2,4,1,3,4,4,5,4,5,3,4,4,5,5,2,3,4,2,1,2,3,3,2,3,4,2,1,3,2,4,1,2,1,1,0])}}var eg=new yn,vb=class{constructor(){this.pyramidPassScene=new wr,this.pyramidPassMaterial=new uu({name:"PyramidPass"}),this.pyramidPassUniforms={inputTexture:{value:void 0},inputWidth:{value:0},inputHeight:{value:0},inputShiftX:{value:0},outputShiftX:{value:0}},this.pyramidTopLevelReadPixelBuffer=new Float32Array(4);let r=`
			precision highp float;
			precision highp sampler2D;
			layout(location = 0) out vec4 pc_FragColor;
			uniform sampler2D inputTexture;
			uniform float inputWidth;
			uniform float inputHeight;
			uniform float inputShiftX;
			uniform float outputShiftX;
			const vec2 half_unit_coord = vec2(0.5);
			const vec4 one = vec4(1.0);
			void main() {
				vec2 inputSize = vec2(inputWidth, inputHeight);
				vec2 input_pixel_uv = 1. / inputSize;
				vec2 coord = gl_FragCoord.xy - half_unit_coord;
				coord.x -= outputShiftX;
				coord = coord * 2. + half_unit_coord;
				coord.x += inputShiftX;

				// sample bottom left corner
				vec2 input_uv = coord / inputSize;
				float bl = texture(inputTexture, input_uv).r;

				// sample bottom right corner
				input_uv.x += input_pixel_uv.x;
				float br = texture(inputTexture, input_uv).r;

				// sample top right corner
				input_uv.y += input_pixel_uv.y;
				float tr = texture(inputTexture, input_uv).r;

				// sample top left corner
				input_uv.x -= input_pixel_uv.x;
				float tl = texture(inputTexture, input_uv).r;

				pc_FragColor.a = bl;
				pc_FragColor.b = pc_FragColor.a + br;
				pc_FragColor.g = pc_FragColor.b + tr;
				pc_FragColor.r = pc_FragColor.g + tl; 
			}
		`;this.pyramidPassMaterial.fragmentShader=r,this.pyramidPassMaterial.uniforms=this.pyramidPassUniforms,this.pyramidPassMaterial.depthTest=!1,this.pyramidPassMaterial.depthWrite=!1;let a=new Et(Bf,this.pyramidPassMaterial);a.frustumCulled=!1,this.pyramidPassScene.add(a)}renderPyramid(r,a,n,o,f){new gl().min.setScalar(0);let y=a.length-1,x=new Qe;n.getViewport(x),this.pyramidPassUniforms.inputShiftX.value=0,this.pyramidPassUniforms.outputShiftX.value=0;let b=y-1;for(let S=b;S>=0;S--){let A=S%2===b%2?f[0]:f[1],C=S===b?o:S%2===b%2?f[1]:f[0];this.pyramidPassUniforms.inputTexture.value=Array.isArray(C.texture)?C.texture[1]:C.texture,this.pyramidPassUniforms.inputWidth.value=C.width,this.pyramidPassUniforms.inputHeight.value=C.height,n.setRenderTarget(A);let P=a[S],T=n.getPixelRatio();n.setViewport(this.pyramidPassUniforms.outputShiftX.value/T,0,P/T,P/T),S===2&&r%2!==0&&n.setViewport(this.pyramidPassUniforms.outputShiftX.value/T,0,3/T,3/T),n.render(this.pyramidPassScene,eg);let M=this.pyramidPassUniforms.inputShiftX.value;this.pyramidPassUniforms.inputShiftX.value=this.pyramidPassUniforms.outputShiftX.value,this.pyramidPassUniforms.outputShiftX.value=M,S<b&&(this.pyramidPassUniforms.outputShiftX.value+=a[S+1])}n.setViewport(x);let _=a.length%2===0?0:1;return n.readRenderTargetPixelsAsync(f[_],f[_].width-1,0,1,1,this.pyramidTopLevelReadPixelBuffer).then(()=>this.pyramidTopLevelReadPixelBuffer[0])}},ro=24,tn=96,Yo=vB(),Ha=2,PT=class extends jt{constructor(r,a,n){super(r,a,n),this.data=a,this.needsRebuild=!0,this.customDepthMaterialNeedsUpdate=!1,this._npart=-1,this.spatialn=1,this.drawRangeNeedsForceUpdate=!0,this._resolutionLevel=-1,this.resolution=64,this.spatialDivisions=25,this.zLayersPerRow=8,this.basePyramidSize=512,this.pyramidTexture1Width=341,this.pyramidTexture1Height=256,this.pyramidTexture2Width=170,this.pyramidTexture2Height=128,this.numLevels=9,this.pyramidLevelSizes=[1,2,4,8,16,32,64,128,256,512],this.bboxSize=0,this.bboxOffset=0,this.shapesDataTexture={value:void 0},this.spatialscene=new wr,this.potentialPassScene=new wr,this.voxelPassScene=new wr,this._spatialPassRenderTargets=[],this._potentialPassRenderTargets=[],this._voxelPassRenderTargets=[],this._pyramidRenderTargets=[],this.geometry=new Ce,this.geometry.drawRange.count=0,this.spatialPassUniforms={span:{value:-1},shapesDataTexture:this.shapesDataTexture,npart:{value:this.npart},spatialn:{value:this.spatialn}},this.spatialMesh=new Et(Bf,this.spatialPassMaterial()),this.spatialMesh.frustumCulled=!1,this.spatialscene.add(this.spatialMesh);let o=new Fr(Yo.triTable,16,256,Lp,Ft);o.needsUpdate=!0;let f=new Fr(Yo.numTrisTable,256,1,Lp,Ft);f.needsUpdate=!0,this.voxelPassUniforms={potentialPassTexture:{value:void 0},numTrisTable:{value:f}},this.voxelMesh=new Et(Bf,this.voxelPassMaterial()),this.voxelMesh.frustumCulled=!1,this.voxelPassScene.add(this.voxelMesh),this.potentialPassUniforms={shapesDataTexture:this.shapesDataTexture,spatialPassTexture:{value:void 0},npart:{value:this.npart},spatialn:{value:this.spatialn}},this.potentialMesh=new Et(Bf,this.potentialPassMaterial()),this.potentialMesh.frustumCulled=!1,this.potentialPassScene.add(this.potentialMesh),this.marchPassUniforms={triTable:{value:o},potentialPassTexture:{value:void 0},voxelPassTexture:{value:void 0},pyramidTexture1:{value:void 0},pyramidTexture1Size:{value:void 0},pyramidTexture2:{value:void 0},pyramidTexture2Size:{value:void 0}},this.frustumCulled=!1,this.onBeforeShadowPass=y=>{if(VZ.call(this),this.npart===0){this.geometry.drawRange.count=0;return}let x=this.material.root;if(!x.shadersPatchedForShapeBlend)this.patchVertexShaderForShapeBlend(x),x.shadersPatchedForShapeBlend=!0,this.customDepthMaterialNeedsUpdate=!0;else if(this.customDepthMaterialNeedsUpdate){this.customDepthMaterialNeedsUpdate=!1,this.customDepthMaterial=new Je({vertexShader:x.vertexShader,fragmentShader:`
						#include <packing>
						void main()
						{
							gl_FragColor = packDepthToRGBA(gl_FragCoord.z);
						}
					`,uniforms:x.uniforms,defines:this.material.defines}),this.isMeshDepthMaterial=!0,this.customDistanceMaterial=new Je({vertexShader:x.vertexShader,fragmentShader:`
					#include <common>
					#include <packing>
					uniform vec3 referencePosition;
					uniform float nearDistance;
					uniform float farDistance;
					// World-space position
					varying vec3 vWPosition;
					void main()
					{
						float dist = length(vWPosition - referencePosition);
						dist = (dist - nearDistance) / (farDistance - nearDistance);
						dist = saturate(dist);
						// Required by Three.js for this to work
						gl_FragColor = packDepthToRGBA( dist );
					}`,uniforms:{nearDistance:{value:0},farDistance:{value:0},referencePosition:{value:new E},opacity:{value:0},...x.uniforms},defines:this.material.defines});let S=this.customDistanceMaterial;S.referencePosition=new E,S.nearDistance=0,S.farDistance=0,S.opacity=1,S.isMeshDistanceMaterial=!0}if(this.spatialPassUniforms.npart.value=this.npart,this.spatialPassUniforms.spatialn.value=this.spatialn,this.potentialPassUniforms.npart.value=this.npart,this.potentialPassUniforms.spatialn.value=this.spatialn,this.needsRebuild){this.needsRebuild=!1,this.spatialMesh.material.defines.RES=this.resolutionLevel,this.spatialMesh.material.needsUpdate=!0,this.potentialMesh.material.defines.RES=this.resolutionLevel,this.potentialPassUniforms.spatialPassTexture.value=this.spatialPassRenderTarget.texture,this.potentialMesh.material.needsUpdate=!0,this.voxelMesh.material.defines.RES=this.resolutionLevel,this.voxelMesh.material.needsUpdate=!0,this.voxelPassUniforms.potentialPassTexture.value=this.potentialPassRenderTarget.texture,this.marchPassUniforms.potentialPassTexture.value=this.potentialPassRenderTarget.texture,this.marchPassUniforms.voxelPassTexture.value=this.voxelPassRenderTarget.texture[0],this.material.defines.RES=this.resolutionLevel,this.material.defines.LEVELS=this.pyramidLevelSizes.length,this.material.defines.LOOP=this.pyramidLevelSizes.length%2===0?this.pyramidLevelSizes.length-3:this.pyramidLevelSizes.length-2,this.material.defines.HALF=this.pyramidLevelSizes.length%2===0?1:0,this.material.needsUpdate=!0;let S=this.pyramidLevelSizes.length%2===0?0:1,A=this.pyramidLevelSizes.length%2===0?1:0;this.marchPassUniforms.pyramidTexture2.value=this.pyramidRenderTarget[S].texture,this.marchPassUniforms.pyramidTexture2Size.value=new V(this.pyramidRenderTarget[S].width,this.pyramidRenderTarget[S].height),this.marchPassUniforms.pyramidTexture1.value=this.pyramidRenderTarget[A].texture,this.marchPassUniforms.pyramidTexture1Size.value=new V(this.pyramidRenderTarget[A].width,this.pyramidRenderTarget[A].height),Object.assign(this.material.uniforms,this.marchPassUniforms)}let b=y.shadowMap.enabled;y.shadowMap.enabled=!1;let _=y.getRenderTarget();y.setRenderTarget(this.spatialPassRenderTarget),y.render(this.spatialscene,eg),y.setRenderTarget(this.potentialPassRenderTarget),y.render(this.potentialPassScene,eg),y.setRenderTarget(this.voxelPassRenderTarget),y.render(this.voxelPassScene,eg),PT.streamCompaction.renderPyramid(this.resolutionLevel,this.pyramidLevelSizes,y,this.voxelPassRenderTarget,this.pyramidRenderTarget).then(S=>{this.material.wireframe&&(S*3>this.geometry.attributes.position.count||this.drawRangeNeedsForceUpdate)&&(this.geometry.dispose(),this.geometry=new Ce,this.geometry.userData.parameters={width:this.bboxSize,height:this.bboxSize,depth:this.bboxSize,centerOffset:[this.bboxOffset,this.bboxOffset,this.bboxOffset]},this.geometry.attributes.position=new Ge(new Float32Array(S*3*2),3)),(S*3>this.geometry.drawRange.count||this.drawRangeNeedsForceUpdate)&&(this.geometry.drawRange.count=Math.floor(S*1.2)*3),this.drawRangeNeedsForceUpdate=!1}),y.shadowMap.enabled=b,y.setRenderTarget(_)}}set npart(r){r!==this._npart&&(this.drawRangeNeedsForceUpdate=!0,this._npart=r,this.spatialn=Math.ceil(r/(4*ro)))}get npart(){return this._npart}set resolutionLevel(r){let a=Math.min(8,Math.max(5,r));if(a!==this._resolutionLevel){switch(this._resolutionLevel=a,this.resolution=Math.pow(2,a),this.resolutionLevel){case 5:this.pyramidLevelSizes=[1,2,4,6,12,24,48,96,192],this.bboxSize=31*8*Ha,this.bboxOffset=8*Ha*-1/2;break;case 6:this.pyramidLevelSizes=[1,2,4,8,16,32,64,128,256,512],this.bboxSize=63*4*Ha,this.bboxOffset=4*Ha*-1/2;break;case 7:this.pyramidLevelSizes=[1,2,4,6,12,24,48,96,192,384,768,1536],this.bboxSize=127*2*Ha,this.bboxOffset=2*Ha*-1/2;break;case 8:this.pyramidLevelSizes=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096],this.bboxSize=255*Ha,this.bboxOffset=Ha*-1/2;break}this.pyramidTexture1Width=0,this.pyramidTexture2Width=0,this.pyramidTexture1Height=this.pyramidLevelSizes[this.pyramidLevelSizes.length-2],this.pyramidTexture2Height=this.pyramidLevelSizes[this.pyramidLevelSizes.length-3];for(let n=this.pyramidLevelSizes.length-2;n>=0;n--)(this.pyramidLevelSizes.length-2)%2===n%2?this.pyramidTexture1Width+=this.pyramidLevelSizes[n]:this.pyramidTexture2Width+=this.pyramidLevelSizes[n];this.basePyramidSize=this.pyramidLevelSizes[this.pyramidLevelSizes.length-1],this.zLayersPerRow=this.basePyramidSize/this.resolution,this.numLevels=this.pyramidLevelSizes.length-1,this.geometry.userData.parameters={width:this.bboxSize,height:this.bboxSize,depth:this.bboxSize,centerOffset:[this.bboxOffset,this.bboxOffset,this.bboxOffset]},this.needsRebuild=!0,this.customDepthMaterialNeedsUpdate=!0}}get resolutionLevel(){return this._resolutionLevel}get spatialPassRenderTarget(){let r=this._spatialPassRenderTargets[this.resolutionLevel];return r||(r=new at(this.spatialDivisions*this.spatialn,this.spatialDivisions**2,{format:pr,type:Ft,stencilBuffer:!1,depthBuffer:!1,generateMipmaps:!1,minFilter:yt,magFilter:yt}),this._spatialPassRenderTargets[this.resolutionLevel]=r),r}get potentialPassRenderTarget(){let r=this._potentialPassRenderTargets[this.resolutionLevel];return r||(r=new at(this.basePyramidSize,this.basePyramidSize,{format:pr,type:Ft,stencilBuffer:!1,depthBuffer:!1,generateMipmaps:!1,minFilter:yt,magFilter:yt}),this._potentialPassRenderTargets[this.resolutionLevel]=r),r}get voxelPassRenderTarget(){let r=this._voxelPassRenderTargets[this.resolutionLevel];return r||(r=new ku(this.basePyramidSize,this.basePyramidSize,2,{stencilBuffer:!1,depthBuffer:!1,generateMipmaps:!1,minFilter:yt,magFilter:yt}),r.texture[0].format=pr,r.texture[0].type=Ft,r.texture[1].format=Lp,r.texture[1].type=Ft,this._voxelPassRenderTargets[this.resolutionLevel]=r),r}get pyramidRenderTarget(){let r=this._pyramidRenderTargets[this.resolutionLevel];if(!r){let a=new at(this.pyramidTexture1Width,this.pyramidTexture1Height,{format:pr,type:Ft,stencilBuffer:!1,depthBuffer:!1,magFilter:yt,minFilter:yt}),n=new at(this.pyramidTexture2Width,this.pyramidTexture2Height,{format:pr,type:Ft,stencilBuffer:!1,depthBuffer:!1,magFilter:yt,minFilter:yt});r=[a,n],this._pyramidRenderTargets[this.resolutionLevel]=r}return r}updateState(r,a){let n=this.material;super.updateState(r,a),n!==this.material&&(this.needsRebuild=!0),r.geometry&&(this.resolutionLevel=r.geometry.resolutionLevel,this.geometry.userData.parameters={width:this.bboxSize,height:this.bboxSize,depth:this.bboxSize,centerOffset:[this.bboxOffset,this.bboxOffset,this.bboxOffset]}),r.wireframe&&!this.geometry.getAttribute("position")?this.geometry.setAttribute("position",new Ge(new Float32Array(this.geometry.drawRange.count*3),3)):!r.wireframe&&this.geometry.getAttribute("position")&&this.geometry.deleteAttribute("position")}spatialPassMaterial(){let r=`
			precision highp float;
			out vec4 pc_FragColor;
			const float spatialDivisions = ${this.spatialDivisions}.;
			uniform float span;
			uniform float npart;
			uniform float spatialn;
			${Yo.shapeInput()}

			vec3 low, high;     // range of current div; subset of -1 .. 1 with span border

			// lookup one element/channel's worth of spheres for current division
			// stating with low sphere number lowi
			// gives a key to which spheres from lowi..lowi+23 are active within given div (low..high)
			float spatialKey(float lowi) {
				float t = 0.;
				for (float ii = ${ro-1}.; ii >= 0.; ii--) {
					float i = ii + lowi;
					float iin = (i + 0.5) / ${tn}.;
					vec4 shape = shapePos(iin);
					vec3 d = shape.xyz;
					float op = shape.w;
	
					t *= 2.;
					t += (
						low.x < d.x && d.x < high.x &&
						low.y < d.y && d.y < high.y &&
						low.z < d.z && d.z < high.z &&
						i < npart || op == -2. // always include if op is -2, which is the intersection operation
					) ? 1. : 0.;
				}
				return t;
			}

			${Yo.getpart}

			void main() {               // spatialial fragment shader
				// find active div
				vec3 div;                               // which div is current
				// out holds x=> x, lowi faster moving and y=> z, y faster moving
				float yz = float(gl_FragCoord.y - 0.5);     // contains  z, y faster moving
				div.y = getpart(yz, spatialDivisions);
				div.z = yz; // getpart(yz, spatialDivisions.z); // what's left, should be the same as getpart

				float lx = float(gl_FragCoord.x - 0.5);     // contains x, lowi faster moving
				float lowi = getpart(lx, spatialn) * ${4*ro}.;
				div.x = lx;

				low = div / spatialDivisions * 2. - 1. - span;
				high = (div+1.) / spatialDivisions * 2. - 1. + span;

				// find active range of spheres
				pc_FragColor.x = spatialKey(lowi);
				pc_FragColor.y = spatialKey(lowi+${ro}.);
				pc_FragColor.z = spatialKey(lowi+${2*ro}.);
				pc_FragColor.w = spatialKey(lowi+${3*ro}.);
			}
		`;return new uu({name:"Spatial Pass",fragmentShader:r,uniforms:this.spatialPassUniforms})}potentialPassMaterial(){let r=`
			precision highp float;
			out vec4 pc_FragColor;

			${Yo.shapeInput()}
			uniform sampler2D spatialPassTexture;

			const float res = float(RES);
			const float VOXEL_RESOLUTION = pow(2., res);
			const float Z_LAYERS_PER_ROW = ceil(pow(2., res / 2.));
			const float VOXEL_RESOLUTION_SUB1 = VOXEL_RESOLUTION - 1.;
			const float INV_VOXEL_RESOLUTION = 1.0 / VOXEL_RESOLUTION;

			uniform float npart;
			uniform float spatialn;
			const float spatialDivisions = ${this.spatialDivisions}.;
			const float spatialDivisions2 = spatialDivisions * spatialDivisions;
			const float spatialDivisionsSub1 = spatialDivisions - 1.;

			${Yo.getpart}

			vec3 packRGBAToVec3(vec4 color) {
				uint r = uint(color.r * 255.);
				uint g = uint(color.g * 255.);
				uint combined = (r << 8) | g; 
				return vec3(float(combined) * 0.00001525902, color.b, color.a); // 1/65535
			}

			void applyQuaternionToVector(in vec4 q, inout vec3 v) {
				v += 2.0 * cross(q.xyz, cross(q.xyz, v) + q.w * v);
			}

			/**
			 * SDF functions (reference: https://iquilezles.org/articles/distfunctions/)
			 */

			// branchless version of "Smooth Union, Subtraction and Intersection - bound, bound, bound" in above reference
			float smoothOperation(float op, float sdf, float d, float k) {
			  //        union: op =  1 => signSubtract =  1, signIntersection =  1
			  //     subtract: op = -1 => signSubtract = -1, signIntersection =  1
				// intersection: op = -2 => signSubtract = -1, signIntersection = -1

				float signSubtract = clamp(op, -1., 1.);
				float signIntersection = 2. * (op - signSubtract) + 1.;
				float h = clamp(
					0.5 + signSubtract * 0.5 * (sdf - signSubtract * signIntersection * d) / k,
					0.0,
					1.0
				);
				return mix(sdf, signSubtract * signIntersection * d, h) - 
							 signSubtract * k * h * (1.0 - h);
			}

			float sdSphere( vec3 p, float s )
			{
				return length(p)-s;
			}

			float sdEllipsoid( vec3 p, vec3 r )
			{
				float k0 = length(p/r);
				float k1 = length(p/(r*r));
				return k0*(k0-1.0)/k1;
			}

			float sdBox( vec3 p, vec3 b )
			{
				vec3 q = abs(p) - b;
				return length(max(q,0.0)) + min(max(q.x,max(q.y,q.z)),0.0);
			}

			float sdTorus( vec3 p, vec2 t )
			{
				vec2 q = vec2(length(p.xy)-t.x,p.z);
				return length(q)-t.y;
			}

			float sdCappedTorus( vec3 p, vec2 sc, float ra, float rb)
			{
				p.x = abs(p.x);
				float k = (sc.y*p.x>sc.x*p.y) ? dot(p.xy,sc) : length(p.xy);
				return sqrt( dot(p,p) + ra*ra - 2.0*ra*k ) - rb;
			}

			float dot2( in vec2 v ) { return dot(v,v); }
			float sdCappedCone( vec3 p, float h, float r1, float r2 )
			{
				vec2 q = vec2( length(p.xz), p.y );
				vec2 k1 = vec2(r2,h);
				vec2 k2 = vec2(r2-r1,2.0*h);
				vec2 ca = vec2(q.x-min(q.x,(q.y<0.0)?r1:r2), abs(q.y)-h);
				vec2 cb = q - k1 + k2*clamp( dot(k1-q,k2)/dot2(k2), 0.0, 1.0 );
				float s = (cb.x<0.0 && ca.y<0.0) ? -1.0 : 1.0;
				return s*sqrt( min(dot2(ca),dot2(cb)) );
			}

			float sdCappedCylinder( vec3 p, float h, float r )
			{
				vec2 d = abs(vec2(length(p.xz),p.y)) - vec2(r,h);
				return min(max(d.x,d.y),0.0) + length(max(d,0.0));
			}

			float maxBlend = 0.0;
			// compute potential from A (=24) spheres, using the bit flags in 'activeKey'
			// to avoid lookup/compute for inactive spheres
			// return field potential, side effect updates track,
			// compute and return +ve and -ve values separately
			void fillSpatialInner(
				float ii,
				float activeKey,
				vec3 corner,
				inout float sdf,
				inout float colorDivisor,
				inout vec4 trackColor
			) {
				for (float i = 0.; i < ${ro}.; i++) {
					if (activeKey < 1.) break; // activeKey exhausted, no more active spheres
					activeKey *= 0.5;
					if (fract(activeKey) < 0.5) continue;

					float iin = (i + ii + 0.5) * ${1/tn};
					vec4 shape = shapePos(iin);
					vec4 quat = shapeQuat(iin);
					vec4 params1 = shapeParams1(iin);
					vec4 params2 = shapeParams2(iin);

					vec3 p = corner - shape.xyz;
					applyQuaternionToVector(quat, p);
					p /= params2.z; // scale
					float d; // d in -1..1 coordinates
					switch (int(params1.x)) {
						case 0: d = sdSphere(p, params1.y); break;
						case 1: d = sdEllipsoid(p, params1.yzw); break;
						case 2: d = sdBox(p, params1.yzw); break;
						case 3: d = sdCappedCylinder(p, params1.y, params1.z); break;
						case 4: d = sdCappedCone(p, params1.y, params1.z, params1.w); break;
						case 5: d = sdTorus(p, params1.yz); break;
						case 6: d = sdCappedTorus(p, params1.yz, params1.w, params2.w); break;
					}
					d -= params2.y; // rounded edge
					d *= params2.z; // scale

					float k = params2.x;
					float op = shape.w;

					sdf = smoothOperation(shape.w, sdf, d, k);

					float isNegativeOne = step(-1.5, op) * step(op, -0.5); // 1 when op == -1, 0 otherwise
					float colorCull = smoothstep(maxBlend, 0., -d);
					float cullFactor = mix(1.0, colorCull, isNegativeOne);
					trackColor *= cullFactor;
					colorDivisor *= cullFactor;

					maxBlend = max(maxBlend, k);

					k += 2. * INV_VOXEL_RESOLUTION; // avoid division by zero, and other color artifacts with very small k
					float nearness = smoothstep(k, 0., d);

					vec4 color = shapeColor(iin);
					nearness *= float(color.a >= 0.);

					colorDivisor += nearness;
					trackColor += color * nearness;
				}
			}

			vec3 div;
			// compute potential from all spheres; collect +ve and =ve values separately
			// work in blocks of A*4 (=96) spheres, using the bit flags in 4 float channel 'activeKey' values
			// TODO check if extra vec3 output useful, not really used at present
			float fillSpatial(vec3 corner, inout vec4 trackColor) {
				float sdf = 1e3; // hack: initialize to large value
				float colorDivisor = 0.;
				// spatialPassTexture holds x=> lowi, x faster moving and y=> z, y faster moving
				float divyz = (div.y + div.z * spatialDivisions + 0.5) / (spatialDivisions2);
				for (float ii = 0.; ii < spatialn; ii++) {
					float i = ii * ${4*ro}.;

					vec4 activeKey = texture(spatialPassTexture, vec2((div.x * spatialn + ii + 0.5)/(spatialn * spatialDivisions), divyz));
					fillSpatialInner(i, activeKey.x, corner, sdf, colorDivisor, trackColor);
					fillSpatialInner(i+${ro}., activeKey.y, corner, sdf, colorDivisor, trackColor);
					fillSpatialInner(i+${2*ro}., activeKey.z, corner, sdf, colorDivisor, trackColor);
					fillSpatialInner(i+${3*ro}., activeKey.w, corner, sdf, colorDivisor, trackColor);
				}

				trackColor /= colorDivisor;
				return mix(sdf, 0.0, step(1e20 - 0.1, sdf));
			}

			void main() {
				${Yo.getxyzi}    // get xi yi zi from 2d position

				vec3 xyzi = vec3(xi,yi,zi);
				vec3 corner = xyzi / VOXEL_RESOLUTION_SUB1 * 2. - 1.;  // -1..1 coords

				div = floor(xyzi / VOXEL_RESOLUTION_SUB1 * spatialDivisionsSub1);

				vec4 c = vec4(0.);
				float t = fillSpatial(corner, c);

				pc_FragColor = vec4(t, packRGBAToVec3(c)); // RGB texture
			}
		`;return new uu({name:"PotentialPass",fragmentShader:r,uniforms:this.potentialPassUniforms})}voxelPassMaterial(){let r=`
			precision highp float;
			layout(location = 0) out vec4 pc_FragColor;
			layout(location = 1) out vec4 numTris;

			const float res = float(RES);
			const float VOXEL_RESOLUTION = pow(2., res);
			const float VOXEL_RESOLUTION_SUB1 = VOXEL_RESOLUTION - 1.; 
			const float Z_LAYERS_PER_ROW = ceil(pow(2., res / 2.));
			const float INV_VOXEL_RESOLUTION = 1.0 / VOXEL_RESOLUTION;
			uniform sampler2D numTrisTable; // 256 x 1

			float keyi(float f000, float f100, float f010, float f110, float f001, float f101, float f011, float f111) {
				return (float(f000 < 0.) * 1.) +
							 (float(f100 < 0.) * 2.) +
							 (float(f010 < 0.) * 8.) +
							 (float(f110 < 0.) * 4.) +
							 (float(f001 < 0.) * 16.) +
							 (float(f101 < 0.) * 32.) +
							 (float(f011 < 0.) * 128.) +
							 (float(f111 < 0.) * 64.);
			}

			${Yo.lookup}

			vec3 compNormi(float xi, float yi, float zi) {
				float dx = look(xi + 1., yi, zi, potentialPassTexture).r - look(xi - 1., yi, zi, potentialPassTexture).r;
				float dy = look(xi, yi + 1., zi, potentialPassTexture).r - look(xi, yi - 1., zi, potentialPassTexture).r;
				float dz = look(xi, yi, zi + 1., potentialPassTexture).r - look(xi, yi, zi - 1., potentialPassTexture).r;
				// if we allow (common) 0,0,0 case through then NaN can spread
				// eg r = vec4(compNorm i(???), 1.) will pollute r.w
				if (dx == 0.0 && dy == 0.0 && dz == 0.0) {
					return vec3(0.199, 0.299, 0.399);
				}
				return normalize(vec3(dx, dy, dz));
			}

			void main() {
				${Yo.getxyzi}    // get xi yi zi from 2d

				vec3 normal = compNormi(xi, yi, zi);  // even if our key is -1 this may be needed by a neighbouring voxel

				if (xi >= VOXEL_RESOLUTION_SUB1 || yi >= VOXEL_RESOLUTION_SUB1 || zi >= VOXEL_RESOLUTION_SUB1) {
					pc_FragColor = vec4(normal, 0.);
					numTris = vec4(0.);
					return;
				}

				float
					f000 = look(xi, yi, zi, potentialPassTexture).r,
					f100 = look(xi+1., yi, zi, potentialPassTexture).r,
					f010 = look(xi, yi+1., zi, potentialPassTexture).r,
					f110 = look(xi+1., yi+1., zi, potentialPassTexture).r,
					f001 = look(xi, yi, zi+1., potentialPassTexture).r,
					f101 = look(xi+1., yi, zi+1., potentialPassTexture).r,
					f011 = look(xi, yi+1., zi+1., potentialPassTexture).r,
					f111 = look(xi+1., yi+1., zi+1., potentialPassTexture).r;
				float key = keyi(f000, f100, f010, f110, f001, f101, f011, f111);

				pc_FragColor = vec4(normal, key);

				numTris = texture(numTrisTable, vec2((key + 0.5) / 256., 0.5));
			}
		`;return new uu({name:"VoxelPass",fragmentShader:r,uniforms:this.voxelPassUniforms})}patchVertexShaderForShapeBlend(r){let a=`
		#ifdef SHAPEBLEND 
			precision highp sampler2D;

			uniform float isol;

			uniform sampler2D triTable;     // 256 x 16
			uniform sampler2D pyramidTexture1;
			uniform vec2 pyramidTexture1Size;
			uniform sampler2D pyramidTexture2;
			uniform vec2 pyramidTexture2Size;

			const vec2 halfPixelOffset = vec2(0.5, 0.5);

			const vec2 rShift = vec2(0., 1.);
			const vec2 gShift = vec2(1., 1.);
			const vec2 bShift = vec2(1., 0.);

			const float res = float(RES);
			const float VOXEL_RESOLUTION = pow(2., res);
			const float Z_LAYERS_PER_ROW = ceil(pow(2., res / 2.));
			const float INV_VOXEL_RESOLUTION = 1.0 / VOXEL_RESOLUTION;

			const float scale_factor = ${Ha}.;

			#if SHAPEBLEND == 5
				const float levelShiftX[7] = float[7](4., 6., 12., 24., 48., 96., 192.);
				const float scale = 8. * scale_factor;
				const vec3 originOffset = vec3(16.);
			#elif SHAPEBLEND == 7
				const float levelShiftX[10] = float[10](4., 6., 12., 24., 48., 96., 192., 384., 768., 1536.); 
				const float scale = 2. * scale_factor;
				const vec3 originOffset = vec3(64.);
			#elif SHAPEBLEND == 8
				const float levelShiftX[11] = float[11](4., 8., 16., 32., 64., 128., 256., 512., 1024., 2048., 4096.);
				const float scale = scale_factor;
				const vec3 originOffset = vec3(128.);
			#else
				const float levelShiftX[8] = float[8](4., 8., 16., 32., 64., 128., 256., 512.);
				const float scale = 4. * scale_factor;
				const vec3 originOffset = vec3(32.);
			#endif

			${Yo.lookup}

			const vec3 offsets[24] = vec3[](
				vec3(0., 0., 0.), vec3(1., 0., 0.),
				vec3(1., 0., 0.), vec3(1., 1., 0.),
				vec3(0., 1., 0.), vec3(1., 1., 0.),
				vec3(0., 0., 0.), vec3(0., 1., 0.),
				vec3(0., 0., 1.), vec3(1., 0., 1.),
				vec3(1., 0., 1.), vec3(1., 1., 1.),
				vec3(0., 1., 1.), vec3(1., 1., 1.),
				vec3(0., 0., 1.), vec3(0., 1., 1.),
				vec3(0., 0., 0.), vec3(0., 0., 1.),
				vec3(1., 0., 0.), vec3(1., 0., 1.),
				vec3(1., 1., 0.), vec3(1., 1., 1.),
				vec3(0., 1., 0.), vec3(0., 1., 1.)
			);

			vec2 computeShiftedPosition1(vec2 xy, float levelOriginX) {
				vec2 xyShifted = xy;
				xyShifted.x += levelOriginX;
				return (xyShifted + halfPixelOffset) / pyramidTexture1Size;
			}

			vec2 computeShiftedPosition2(vec2 xy, float levelOriginX) {
				vec2 xyShifted = xy;
				xyShifted.x += levelOriginX;
				return (xyShifted + halfPixelOffset) / pyramidTexture2Size;
			}

			vec4 unpackVec3ToRGBA(vec3 vec) {
				uint combined = uint(vec.x * 65535.0 + 0.5); // Add 0.5 for rounding
				float g = float(combined & uint(0xFF)) * 0.00392156862; // 1/255
				float r = float((combined >> 8) & uint(0xFF)) * 0.00392156862; 
		
				return vec4(r, g, vec.y, vec.z);
			}

			out vec4 marchColor;
			// end of marchvertPre
		#endif
		`,n=`
		#ifdef SHAPEBLEND
			float triIndex = floor(float(gl_VertexID/3));
			float vertexIndex = float(gl_VertexID);
			
			// Initial pyramid lookup
			float levelOriginX1 = pyramidTexture1Size.x - 2.;
			float levelOriginX2 = pyramidTexture2Size.x - 1.;
			vec2 xy = vec2(0.);
			vec4 lookUp = texture(pyramidTexture2, computeShiftedPosition2(xy, levelOriginX2));
			
			// Early exit check
			if (triIndex >= lookUp.r) return;
			
			// Optimize loop variables
			float start = 0.;
			vec4 triIndexVec = vec4(triIndex);
			
			// Main position computation loop
			for (int i = 0; i < LOOP;) {
				// Compute boundaries
				vec4 ends = lookUp + vec4(start);
				vec4 starts = vec4(ends.gba, start);
				vec4 check = vec4(greaterThanEqual(triIndexVec, starts)) * 
											vec4(lessThan(triIndexVec, ends));
				
				// Update position
				xy *= 2.;
				xy += check.r * rShift + check.g * gShift + check.b * bShift;
				
				// Update loop variables
				start = dot(check, starts);
				levelOriginX2 -= levelShiftX[i];
				
				// Update lookup
				lookUp = texture(pyramidTexture1, computeShiftedPosition1(xy, levelOriginX1));
				i++;

				ends = lookUp + vec4(start);
				starts = vec4(ends.gba, start);
				check = vec4(greaterThanEqual(triIndexVec, starts)) * 
											vec4(lessThan(triIndexVec, ends));
				
				// Update position
				xy *= 2.;
				xy += check.r * rShift + check.g * gShift + check.b * bShift;
				
				// Update loop variables
				start = dot(check, starts);
				levelOriginX1 -= levelShiftX[i];
				
				// Update lookup
				lookUp = texture(pyramidTexture2, computeShiftedPosition2(xy, levelOriginX2));

				i++;
			}

			#if HALF == 1
				vec4 ends = lookUp + vec4(start);
				vec4 starts = vec4(ends.gba, start);
				vec4 check = vec4(greaterThanEqual(triIndexVec, starts)) * vec4(lessThan(triIndexVec, ends));
			
				// Update position
				xy *= 2.;
				xy += check.r * rShift + check.g * gShift + check.b * bShift;
			
				// Update loop variables
				start = dot(check, starts);
			#endif
			
			// Compute final coordinates
			vec3 gridPos;
			gridPos.x = mod(xy.x, VOXEL_RESOLUTION);
			gridPos.y = mod(xy.y, VOXEL_RESOLUTION);
			gridPos.z = floor(xy.x * INV_VOXEL_RESOLUTION) + 
									floor(xy.y * INV_VOXEL_RESOLUTION) * Z_LAYERS_PER_ROW;
			
			// Vertex key computation
			vertexIndex -= start * 3.;
			float vk = vertexIndex * 0.0625 + 0.03125; // Optimized division by 16 and addition of 1/32
			
			// Voxel lookup and edge computation
			vec4 voxel = look(gridPos.x, gridPos.y, gridPos.z, voxelPassTexture);
			float key = (voxel.w + 0.5) * 0.00390625; // Optimized division by 256
			
			// Edge lookup and offset computation
			float edgeNum = texture(triTable, vec2(vk, key)).x;
			int edgeIndex = int(edgeNum) * 2;
			
			// Compute edge positions
			vec3 p1 = gridPos + offsets[edgeIndex];
			vec3 p2 = gridPos + offsets[edgeIndex + 1];
			
			// Compute potentials and normals
			vec4 potential1 = look(p1.x, p1.y, p1.z, potentialPassTexture);
			vec4 potential2 = look(p2.x, p2.y, p2.z, potentialPassTexture);
			
			// Final position and normal computation
			float mu = potential1.r / (potential1.r - potential2.r);

			marchColor = mix(
				unpackVec3ToRGBA(potential1.gba),
				unpackVec3ToRGBA(potential2.gba),
				mu
			);

			transformed = p1 + (p2 - p1) * mu;
			transformed -= originOffset;
			transformed *= scale;
			vec4 data1 = look(p1.x, p1.y, p1.z, voxelPassTexture);
			vec4 data2 = look(p2.x, p2.y, p2.z, voxelPassTexture);
			objectNormal = normalize(mix(data1.xyz, data2.xyz, mu));
			transformedNormal = normalMatrix * objectNormal;
			#ifndef FLAT_SHADED
				vNormal = transformedNormal;
			#endif
		#endif
		`;r.vertexShader=a+r.vertexShader.replace("#include <project_vertex>",n+`
#include <project_vertex>`);let o=r.fragmentShader.match(/vec3 diffuseColor[^\n]*\n/);if(!o)return;let f=`
		#ifdef SHAPEBLEND_C
			#if SHAPEBLEND_C == 1
				${o[0].replace(/nodeU0,/g,"marchColor.rgb,").replace(/nodeU\d+(?=,g_uid\d+_calpha\))/g,"marchColor.a")}
			#else
				${o[0]}
			#endif
		#else
			${o[0]}
		#endif
		`;r.fragmentShader=`in vec4 marchColor;
`+r.fragmentShader.replace(o[0],f),Object.assign(r.uniforms,this.marchPassUniforms)}initDebugPass(r){console.log("fboToDebug.width",r.width,r.height),this.geometry=new vi(r.width,r.height),this.geometry.userData={parameters:{width:4,height:4}};let a={inputTexture:{value:Array.isArray(r.texture)?r.texture[1]:r.texture},pyramidTextureSize:{value:void 0}},n=o=>{o.vertexShader=`
				precision highp float;

				varying vec2 vUv;

				void main() {
						gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
						vUv = uv;
				}
			`,o.fragmentShader=`
				layout(location = 1) out vec4 gVelocity;

				precision highp float;
				
				uniform sampler2D inputTexture;
				varying vec2 vUv;

				uniform vec2 pyramidTextureSize;

				void main() {
						// Sample the input texture using UV coordinates
						gl_FragColor = texture(inputTexture, vUv);
						gVelocity = vec4(0.0);
				}
			`,a.pyramidTextureSize.value=new V(this.pyramidRenderTarget.width,this.pyramidRenderTarget.height),Object.assign(o.uniforms,a)};this.material.shapeBlendhack=n,this.material.root.shapeBlendhack=n}},ts=PT;ts.streamCompaction=new vb;var LZ=new ue,BZ=new ue,Nf=new Ke,ac=new E,xb=new E,NZ=new Ke;function FZ(r,a=0){let n=this.children.length;for(;n--;){let o=this.children[n];Ra.is(o)&&xB.call(o,r,a+1)}}function xB(r,a=0){if(r(this,a)!==!0){let n=this.children.length;for(;n--;){let o=this.children[n];Ra.is(o)&&xB.call(o,r,a+1)}}}function VZ(){if(this.shapesDataTexture.value===void 0){let x=new Fr(new Float32Array(4*tn*oc),tn,oc,pr,Ft);this.shapesDataTexture.value=x}let r=this.shapesDataTexture.value,a=r.image.data;r.needsUpdate=!0;let n=0,o=this.data.geometry.blendRange,f=LZ.copy(this.matrixWorld).invert(),y=0;FZ.call(this,x=>{var D;if(x.visible===!1)return!0;let b;if(x instanceof bi||x instanceof Ho||x instanceof Xo)return;x instanceof Dr?b=x.object:b=x;let _=(D=x.data)==null?void 0:D.cloner;if(mt.is(x)&&_&&!_.hideBase&&_.type!=="radial"&&_.disabled!==!0||!(b instanceof jt))return;let S=b.geometry.userData.parameters,A=S.shapeBlendNode;if(A===void 0)return;if(BZ.multiplyMatrices(f,x.matrixWorld).decompose(xb,Nf,ac),S.type==="TorusGeometry"&&S.arc!==360){let z=S.arc*Math.PI/180;z=z/4,Nf.multiply(NZ.set(0,0,Math.sin(z),Math.cos(z)))}let C=A.overrideGlobalBlend?A.blendRange:o;C=C/this.bboxSize*2,a[y*4]=(xb.x-this.bboxOffset)/this.bboxSize*2,a[y*4+1]=(xb.y-this.bboxOffset)/this.bboxSize*2,a[y*4+2]=(xb.z-this.bboxOffset)/this.bboxSize*2,a[y*4+3]=A.operation===0?1:A.operation===2?-1:-2,a[tn*4+y*4]=-Nf.x,a[tn*4+y*4+1]=-Nf.y,a[tn*4+y*4+2]=-Nf.z,a[tn*4+y*4+3]=Nf.w;let P=new Float32Array(4),T=0;if(S.type==="SphereGeometry")S.width===S.height&&S.width===S.depth?P[0]=0:P[0]=1,P[1]=S.width/this.bboxSize,P[2]=S.height/this.bboxSize,P[3]=S.depth/this.bboxSize,n=Math.max(n,P[1]*ac.x+C,P[2]*ac.x+C,P[3]*ac.x+C);else if(S.type==="CubeGeometry"){T=S.cornerRadius;let z=S.width,k=S.height,L=S.depth;P[0]=2,P[1]=(z-2*T)/this.bboxSize,P[2]=(k-2*T)/this.bboxSize,P[3]=(L-2*T)/this.bboxSize,n=Math.max(n,Math.sqrt(z**2+k**2+L**2)/this.bboxSize*ac.x+C)}else if(S.type==="CylinderGeometry"){T=S.cornerRadius;let z=S.height,k=S.radiusBottom,L=S.radiusTop;if(L>=k){let R=Math.atan2(L-k,z),F=(Math.PI/2-R)/2;L-=T/Math.tan(F),k-=T*Math.tan(F)}else if(k>L){let R=Math.atan2(k-L,z),F=(Math.PI/2-R)/2;L-=T*Math.tan(F),k-=T/Math.tan(F)}P[1]=(S.height-2*T)/this.bboxSize,k===L?(P[0]=3,P[2]=k/this.bboxSize*2):(P[0]=4,P[2]=k/this.bboxSize*2,P[3]=L/this.bboxSize*2),n=Math.max(n,P[1]*4*ac.x+C)}else if(S.type==="TorusGeometry"){if(P[0]=5,P[1]=(S.width-S.depth)/this.bboxSize,P[2]=S.depth/this.bboxSize,S.arc!==360){P[0]=6,P[3]=P[1],a[tn*12+y*4+3]=P[2];let z=2*Math.atan2(P[2]/2,P[1]),k=S.arc*Math.PI/180/2-z;P[1]=Math.sin(k),P[2]=Math.cos(k)}n=Math.max(n,S.width*ac.x/this.bboxSize+C)}a.set(P,tn*8+y*4),a[tn*12+y*4]=C,a[tn*12+y*4+1]=T/this.bboxSize*2,a[tn*12+y*4+2]=ac.x;let M=b.material,O=M.uniforms.nodeU0.node.value,I=M.uniforms.nodeU1.value;A.operation!==0&&!A.useColor&&(I=-1),a[tn*16+y*4]=O.r,a[tn*16+y*4+1]=O.g,a[tn*16+y*4+2]=O.b,a[tn*16+y*4+3]=I,I<1&&this.material.defines.SHAPEBLEND_C===1&&(this.material.transparent=!0),y++}),this.npart=y,this.spatialPassUniforms.span.value=n*1.4}var UZ=new sh,zZ=new ue,kZ=new Ns;function $m(r,a,n,o=!1){let f=r.cloner;if(f)for(let y of f.children){let x=zZ.copy(y.matrixWorld).invert(),b=kZ.copy(a.ray).applyMatrix4(x),_=r.matrixWorld;b.applyMatrix4(_);let S=UZ;S.set(b.origin,b.direction),S.near=a.near,S.far=a.far;let A=S.intersectObject(r,!1);A.length>0&&n.push({...A[0],object:o?y:r})}}var Ko=class{};mc(Ko,"DepthMapRange",65536),mc(Ko,"MemoryPageSize",65536),mc(Ko,"BytesPerFloat",4),mc(Ko,"BytesPerInt",4);(function(){let r=new Float32Array(1),a=new Int32Array(r.buffer);return function(n){return r[0]=n,a[0]}})();new V;var _T=new Promise(r=>{});_T.then(r=>r);var Jx=new an;Jx.wireframe=!0;new E;var rg=(r,a)=>{let n=a.x-r.x,o=a.y-r.y;return Math.sqrt(n*n+o*o)},OB=(r,a)=>{let n=a.x-r.x,o=a.y-r.y;return jZ(Math.atan2(o,n))},RB=(r,a,n)=>{let o={x:0,y:0};return n=Tb(n),o.x=r.x-a*Math.cos(n),o.y=r.y-a*Math.sin(n),o},Tb=r=>r*(Math.PI/180),jZ=r=>r*(180/Math.PI),LB=r=>isNaN(r.buttons)?r.pressure!==0:r.buttons!==0,DT=new Map,OT=r=>{DT.has(r)&&clearTimeout(DT.get(r)),DT.set(r,setTimeout(r,100))},Ff=(r,a,n)=>{let o=a.split(/[ ,]+/g),f;for(let y=0;y<o.length;y+=1)f=o[y],r.addEventListener?r.addEventListener(f,n,!1):r.attachEvent&&r.attachEvent(f,n)},RT=(r,a,n)=>{let o=a.split(/[ ,]+/g),f;for(let y=0;y<o.length;y+=1)f=o[y],r.removeEventListener?r.removeEventListener(f,n):r.detachEvent&&r.detachEvent(f,n)},Mb=r=>(r.preventDefault(),r.type.match(/^touch/)?r.changedTouches:r),LT=()=>{if(typeof window>"u")return;let r=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,a=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:r,y:a}},Cb=(r,a)=>{a.top||a.right||a.bottom||a.left?(r.style.top=a.top,r.style.right=a.right,r.style.bottom=a.bottom,r.style.left=a.left):(r.style.left=a.x+"px",r.style.top=a.y+"px")},Pb=(r,a,n)=>{let o=NB(r);for(let f in o)if(o.hasOwnProperty(f))if(typeof a=="string")o[f]=a+" "+n;else{let y="";for(let x=0,b=a.length;x<b;x+=1)y+=a[x]+" "+n+", ";o[f]=y.slice(0,-2)}return o},BB=(r,a)=>{let n=NB(r);for(let o in n)n.hasOwnProperty(o)&&(n[o]=a);return n},NB=r=>{let a={};return a[r]="",["webkit","Moz","o"].forEach(function(n){a[n+r.charAt(0).toUpperCase()+r.slice(1)]=""}),a},_b=(r,a)=>{for(let n in a)a.hasOwnProperty(n)&&(r[n]=a[n]);return r},FB=(r,a)=>{let n={};for(let o in r)r.hasOwnProperty(o)&&a.hasOwnProperty(o)?n[o]=a[o]:r.hasOwnProperty(o)&&(n[o]=r[o]);return n},ig=(r,a)=>{if(r.length)for(let n=0,o=r.length;n<o;n+=1)a(r[n]);else a(r)},VB=(r,a,n)=>({x:Math.min(Math.max(r.x,a.x-n),a.x+n),y:Math.min(Math.max(r.y,a.y-n),a.y+n)});typeof window<"u"&&(UB="ontouchstart"in window,zB=!!window.PointerEvent,kB=!!window.MSPointerEvent);var UB,zB,kB,ng={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},Vf,sg={};zB?Vf=ng.pointer:kB?Vf=ng.MSPointer:UB?(Vf=ng.touch,sg=ng.mouse):Vf=ng.mouse;function hu(){}hu.prototype.on=function(r,a){var n=this,o=r.split(/[ ,]+/g),f;n._handlers_=n._handlers_||{};for(var y=0;y<o.length;y+=1)f=o[y],n._handlers_[f]=n._handlers_[f]||[],n._handlers_[f].push(a);return n};hu.prototype.off=function(r,a){var n=this;return n._handlers_=n._handlers_||{},r===void 0?n._handlers_={}:a===void 0?n._handlers_[r]=null:n._handlers_[r]&&n._handlers_[r].indexOf(a)>=0&&n._handlers_[r].splice(n._handlers_[r].indexOf(a),1),n};hu.prototype.trigger=function(r,a){var n=this,o=r.split(/[ ,]+/g),f;n._handlers_=n._handlers_||{};for(var y=0;y<o.length;y+=1)f=o[y],n._handlers_[f]&&n._handlers_[f].length&&n._handlers_[f].forEach(function(x){x.call(n,{type:f,target:n},a)})};hu.prototype.config=function(r){var a=this;a.options=a.defaults||{},r&&(a.options=FB(a.options,r))};hu.prototype.bindEvt=function(r,a){var n=this;return n._domHandlers_=n._domHandlers_||{},n._domHandlers_[a]=function(){typeof n["on"+a]=="function"?n["on"+a].apply(n,arguments):console.warn('[WARNING] : Missing "on'+a+'" handler.')},Ff(r,Vf[a],n._domHandlers_[a]),sg[a]&&Ff(r,sg[a],n._domHandlers_[a]),n};hu.prototype.unbindEvt=function(r,a){var n=this;return n._domHandlers_=n._domHandlers_||{},RT(r,Vf[a],n._domHandlers_[a]),sg[a]&&RT(r,sg[a],n._domHandlers_[a]),delete n._domHandlers_[a],this};var Uf=hu;function Ri(r,a){return this.identifier=a.identifier,this.position=a.position,this.frontPosition=a.frontPosition,this.collection=r,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(a),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=Ri.id,Ri.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}Ri.prototype=new Uf;Ri.constructor=Ri;Ri.id=0;Ri.prototype.buildEl=function(r){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};Ri.prototype.stylize=function(){if(this.options.dataOnly)return this;var r=this.options.fadeTime+"ms",a=BB("borderRadius","50%"),n=Pb("transition","opacity",r),o={};return o.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},o.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:"rgba(255, 255, 255, .4)",border:"solid 2px rgba(0, 0, 0, .1)"},o.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:"rgba(255, 255, 255, .8)",border:"solid 2px rgba(0, 0, 0, .1)"},_b(o.el,n),this.options.shape==="circle"&&_b(o.back,a),_b(o.front,a),this.applyStyles(o),this};Ri.prototype.applyStyles=function(r){for(var a in this.ui)if(this.ui.hasOwnProperty(a))for(var n in r[a])this.ui[a].style[n]=r[a][n];return this};Ri.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};Ri.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};Ri.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};Ri.prototype.show=function(r){var a=this;return a.options.dataOnly||(clearTimeout(a.removeTimeout),clearTimeout(a.showTimeout),clearTimeout(a.restTimeout),a.addToDom(),a.restCallback(),setTimeout(function(){a.ui.el.style.opacity=1},0),a.showTimeout=setTimeout(function(){a.trigger("shown",a.instance),typeof r=="function"&&r.call(this)},a.options.fadeTime)),a};Ri.prototype.hide=function(r){var a=this;if(a.options.dataOnly)return a;if(a.ui.el.style.opacity=a.options.restOpacity,clearTimeout(a.removeTimeout),clearTimeout(a.showTimeout),clearTimeout(a.restTimeout),a.removeTimeout=setTimeout(function(){var n=a.options.mode==="dynamic"?"none":"block";a.ui.el.style.display=n,typeof r=="function"&&r.call(a),a.trigger("hidden",a.instance)},a.options.fadeTime),a.options.restJoystick){let n=a.options.restJoystick,o={};o.x=n===!0||n.x!==!1?0:a.instance.frontPosition.x,o.y=n===!0||n.y!==!1?0:a.instance.frontPosition.y,a.setPosition(r,o)}return a};Ri.prototype.setPosition=function(r,a){var n=this;n.frontPosition={x:a.x,y:a.y};var o=n.options.fadeTime+"ms",f={};f.front=Pb("transition",["top","left"],o);var y={front:{}};y.front={left:n.frontPosition.x+"px",top:n.frontPosition.y+"px"},n.applyStyles(f),n.applyStyles(y),n.restTimeout=setTimeout(function(){typeof r=="function"&&r.call(n),n.restCallback()},n.options.fadeTime)};Ri.prototype.restCallback=function(){var r=this,a={};a.front=Pb("transition","none",""),r.applyStyles(a),r.trigger("rested",r.instance)};Ri.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};Ri.prototype.computeDirection=function(r){var a=r.angle.radian,n=Math.PI/4,o=Math.PI/2,f,y,x;if(a>n&&a<n*3&&!r.lockX?f="up":a>-n&&a<=n&&!r.lockY?f="left":a>-n*3&&a<=-n&&!r.lockX?f="down":r.lockY||(f="right"),r.lockY||(a>-o&&a<o?y="left":y="right"),r.lockX||(a>0?x="up":x="down"),r.force>this.options.threshold){var b={},_;for(_ in this.direction)this.direction.hasOwnProperty(_)&&(b[_]=this.direction[_]);var S={};this.direction={x:y,y:x,angle:f},r.direction=this.direction;for(_ in b)b[_]===this.direction[_]&&(S[_]=!0);if(S.x&&S.y&&S.angle)return r;(!S.x||!S.y)&&this.trigger("plain",r),S.x||this.trigger("plain:"+y,r),S.y||this.trigger("plain:"+x,r),S.angle||this.trigger("dir dir:"+f,r)}else this.resetDirection();return r};var GB=Ri;function li(r,a){var n=this;n.nipples=[],n.idles=[],n.actives=[],n.ids=[],n.pressureIntervals={},n.manager=r,n.id=li.id,li.id+=1,n.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},n.config(a),(n.options.mode==="static"||n.options.mode==="semi")&&(n.options.multitouch=!1),n.options.multitouch||(n.options.maxNumberOfNipples=1);let o=getComputedStyle(n.options.zone.parentElement);return o&&o.display==="flex"&&(n.parentIsFlex=!0),n.updateBox(),n.prepareNipples(),n.bindings(),n.begin(),n.nipples}li.prototype=new Uf;li.constructor=li;li.id=0;li.prototype.prepareNipples=function(){var r=this,a=r.nipples;a.on=r.on.bind(r),a.off=r.off.bind(r),a.options=r.options,a.destroy=r.destroy.bind(r),a.ids=r.ids,a.id=r.id,a.processOnMove=r.processOnMove.bind(r),a.processOnEnd=r.processOnEnd.bind(r),a.get=function(n){if(n===void 0)return a[0];for(var o=0,f=a.length;o<f;o+=1)if(a[o].identifier===n)return a[o];return!1}};li.prototype.bindings=function(){var r=this;r.bindEvt(r.options.zone,"start"),r.options.zone.style.touchAction="none",r.options.zone.style.msTouchAction="none"};li.prototype.begin=function(){var r=this,a=r.options;if(a.mode==="static"){var n=r.createNipple(a.position,r.manager.getIdentifier());n.add(),r.idles.push(n)}};li.prototype.createNipple=function(r,a){var n=this,o=n.manager.scroll,f={},y=n.options,x={x:n.parentIsFlex?o.x:o.x+n.box.left,y:n.parentIsFlex?o.y:o.y+n.box.top};if(r.x&&r.y)f={x:r.x-x.x,y:r.y-x.y};else if(r.top||r.right||r.bottom||r.left){var b=document.createElement("DIV");b.style.display="hidden",b.style.top=r.top,b.style.right=r.right,b.style.bottom=r.bottom,b.style.left=r.left,b.style.position="absolute",y.zone.appendChild(b);var _=b.getBoundingClientRect();y.zone.removeChild(b),f=r,r={x:_.left+o.x,y:_.top+o.y}}var S=new GB(n,{color:y.color,size:y.size,threshold:y.threshold,fadeTime:y.fadeTime,dataOnly:y.dataOnly,restJoystick:y.restJoystick,restOpacity:y.restOpacity,mode:y.mode,identifier:a,position:r,zone:y.zone,frontPosition:{x:0,y:0},shape:y.shape});return y.dataOnly||(Cb(S.ui.el,f),Cb(S.ui.front,S.frontPosition)),n.nipples.push(S),n.trigger("added "+S.identifier+":added",S),n.manager.trigger("added "+S.identifier+":added",S),n.bindNipple(S),S};li.prototype.updateBox=function(){var r=this;r.box=r.options.zone.getBoundingClientRect()};li.prototype.bindNipple=function(r){var a=this,n,o=function(f,y){n=f.type+" "+y.id+":"+f.type,a.trigger(n,y)};r.on("destroyed",a.onDestroyed.bind(a)),r.on("shown hidden rested dir plain",o),r.on("dir:up dir:right dir:down dir:left",o),r.on("plain:up plain:right plain:down plain:left",o)};li.prototype.pressureFn=function(r,a,n){var o=this,f=0;clearInterval(o.pressureIntervals[n]),o.pressureIntervals[n]=setInterval((function(){var y=r.force||r.pressure||r.webkitForce||0;y!==f&&(a.trigger("pressure",y),o.trigger("pressure "+a.identifier+":pressure",y),f=y)}).bind(o),100)};li.prototype.onstart=function(r){var a=this,n=a.options,o=r;r=Mb(r),a.updateBox();var f=function(y){a.actives.length<n.maxNumberOfNipples?a.processOnStart(y):o.type.match(/^touch/)&&(Object.keys(a.manager.ids).forEach(function(x){if(Object.values(o.touches).findIndex(function(_){return _.identifier===x})<0){var b=[r[0]];b.identifier=x,a.processOnEnd(b)}}),a.actives.length<n.maxNumberOfNipples&&a.processOnStart(y))};return ig(r,f),a.manager.bindDocument(),!1};li.prototype.processOnStart=function(r){var a=this,n=a.options,o,f=a.manager.getIdentifier(r),y=r.force||r.pressure||r.webkitForce||0,x={x:r.pageX,y:r.pageY},b=a.getOrCreate(f,x);b.identifier!==f&&a.manager.removeIdentifier(b.identifier),b.identifier=f;var _=function(A){A.trigger("start",A),a.trigger("start "+A.id+":start",A),A.show(),y>0&&a.pressureFn(r,A,A.identifier),a.processOnMove(r)};if((o=a.idles.indexOf(b))>=0&&a.idles.splice(o,1),a.actives.push(b),a.ids.push(b.identifier),n.mode!=="semi")_(b);else{var S=rg(x,b.position);if(S<=n.catchDistance)_(b);else{b.destroy(),a.processOnStart(r);return}}return b};li.prototype.getOrCreate=function(r,a){var n=this,o=n.options,f;return/(semi|static)/.test(o.mode)?(f=n.idles[0],f?(n.idles.splice(0,1),f):o.mode==="semi"?n.createNipple(a,r):(console.warn("Coudln't find the needed nipple."),!1)):(f=n.createNipple(a,r),f)};li.prototype.processOnMove=function(r){var a=this,n=a.options,o=a.manager.getIdentifier(r),f=a.nipples.get(o),y=a.manager.scroll;if(!LB(r)){this.processOnEnd(r);return}if(!f){console.error("Found zombie joystick with ID "+o),a.manager.removeIdentifier(o);return}if(n.dynamicPage){var x=f.el.getBoundingClientRect();f.position={x:y.x+x.left,y:y.y+x.top}}f.identifier=o;var b=f.options.size/2,_={x:r.pageX,y:r.pageY};n.lockX&&(_.y=f.position.y),n.lockY&&(_.x=f.position.x);var S=rg(_,f.position),A=OB(_,f.position),C=Tb(A),P=S/b,T={distance:S,position:_},M,O;if(f.options.shape==="circle"?(M=Math.min(S,b),O=RB(f.position,M,A)):(O=VB(_,f.position,b),M=rg(O,f.position)),n.follow){if(S>b){let k=_.x-O.x,L=_.y-O.y;f.position.x+=k,f.position.y+=L,f.el.style.top=f.position.y-(a.box.top+y.y)+"px",f.el.style.left=f.position.x-(a.box.left+y.x)+"px",S=rg(_,f.position)}}else _=O,S=M;var I=_.x-f.position.x,D=_.y-f.position.y;f.frontPosition={x:I,y:D},n.dataOnly||Cb(f.ui.front,f.frontPosition);var z={identifier:f.identifier,position:_,force:P,pressure:r.force||r.pressure||r.webkitForce||0,distance:S,angle:{radian:C,degree:A},vector:{x:I/b,y:-D/b},raw:T,instance:f,lockX:n.lockX,lockY:n.lockY};z=f.computeDirection(z),z.angle={radian:Tb(180-A),degree:180-A},f.trigger("move",z),a.trigger("move "+f.id+":move",z)};li.prototype.processOnEnd=function(r){var a=this,n=a.options,o=a.manager.getIdentifier(r),f=a.nipples.get(o),y=a.manager.removeIdentifier(f.identifier);!f||(n.dataOnly||f.hide(function(){n.mode==="dynamic"&&(f.trigger("removed",f),a.trigger("removed "+f.id+":removed",f),a.manager.trigger("removed "+f.id+":removed",f),f.destroy())}),clearInterval(a.pressureIntervals[f.identifier]),f.resetDirection(),f.trigger("end",f),a.trigger("end "+f.id+":end",f),a.ids.indexOf(f.identifier)>=0&&a.ids.splice(a.ids.indexOf(f.identifier),1),a.actives.indexOf(f)>=0&&a.actives.splice(a.actives.indexOf(f),1),/(semi|static)/.test(n.mode)?a.idles.push(f):a.nipples.indexOf(f)>=0&&a.nipples.splice(a.nipples.indexOf(f),1),a.manager.unbindDocument(),/(semi|static)/.test(n.mode)&&(a.manager.ids[y.id]=y.identifier))};li.prototype.onDestroyed=function(r,a){var n=this;n.nipples.indexOf(a)>=0&&n.nipples.splice(n.nipples.indexOf(a),1),n.actives.indexOf(a)>=0&&n.actives.splice(n.actives.indexOf(a),1),n.idles.indexOf(a)>=0&&n.idles.splice(n.idles.indexOf(a),1),n.ids.indexOf(a.identifier)>=0&&n.ids.splice(n.ids.indexOf(a.identifier),1),n.manager.removeIdentifier(a.identifier),n.manager.unbindDocument()};li.prototype.destroy=function(){var r=this;r.unbindEvt(r.options.zone,"start"),r.nipples.forEach(function(n){n.destroy()});for(var a in r.pressureIntervals)r.pressureIntervals.hasOwnProperty(a)&&clearInterval(r.pressureIntervals[a]);r.trigger("destroyed",r.nipples),r.manager.unbindDocument(),r.off()};var jB=li;function Hi(r){var a=this;a.ids={},a.index=0,a.collections=[],a.scroll=LT(),a.config(r),a.prepareCollections();var n=function(){var f;a.collections.forEach(function(y){y.forEach(function(x){f=x.el.getBoundingClientRect(),x.position={x:a.scroll.x+f.left,y:a.scroll.y+f.top}})})};if(typeof window>"u")return a.collections;Ff(window,"resize",function(){OT(n)});var o=function(){a.scroll=LT()};return Ff(window,"scroll",function(){OT(o)}),a.collections}Hi.prototype=new Uf;Hi.constructor=Hi;Hi.prototype.prepareCollections=function(){var r=this;r.collections.create=r.create.bind(r),r.collections.on=r.on.bind(r),r.collections.off=r.off.bind(r),r.collections.destroy=r.destroy.bind(r),r.collections.get=function(a){var n;return r.collections.every(function(o){return n=o.get(a),!n}),n}};Hi.prototype.create=function(r){return this.createCollection(r)};Hi.prototype.createCollection=function(r){var a=this,n=new jB(a,r);return a.bindCollection(n),a.collections.push(n),n};Hi.prototype.bindCollection=function(r){var a=this,n,o=function(f,y){n=f.type+" "+y.id+":"+f.type,a.trigger(n,y)};r.on("destroyed",a.onDestroyed.bind(a)),r.on("shown hidden rested dir plain",o),r.on("dir:up dir:right dir:down dir:left",o),r.on("plain:up plain:right plain:down plain:left",o)};Hi.prototype.bindDocument=function(){var r=this;r.binded||(r.bindEvt(document,"move").bindEvt(document,"end"),r.binded=!0)};Hi.prototype.unbindDocument=function(r){var a=this;(!Object.keys(a.ids).length||r===!0)&&(a.unbindEvt(document,"move").unbindEvt(document,"end"),a.binded=!1)};Hi.prototype.getIdentifier=function(r){var a;return r?(a=r.identifier===void 0?r.pointerId:r.identifier,a===void 0&&(a=this.latest||0)):a=this.index,this.ids[a]===void 0&&(this.ids[a]=this.index,this.index+=1),this.latest=a,this.ids[a]};Hi.prototype.removeIdentifier=function(r){var a={};for(var n in this.ids)if(this.ids[n]===r){a.id=n,a.identifier=this.ids[n],delete this.ids[n];break}return a};Hi.prototype.onmove=function(r){var a=this;return a.onAny("move",r),!1};Hi.prototype.onend=function(r){var a=this;return a.onAny("end",r),!1};Hi.prototype.oncancel=function(r){var a=this;return a.onAny("end",r),!1};Hi.prototype.onAny=function(r,a){var n=this,o,f="processOn"+r.charAt(0).toUpperCase()+r.slice(1);a=Mb(a);var y=function(b,_,S){S.ids.indexOf(_)>=0&&(S[f](b),b._found_=!0)},x=function(b){o=n.getIdentifier(b),ig(n.collections,y.bind(null,b,o)),b._found_||n.removeIdentifier(o)};return ig(a,x),!1};Hi.prototype.destroy=function(){var r=this;r.unbindDocument(!0),r.ids={},r.index=0,r.collections.forEach(function(a){a.destroy()}),r.off()};Hi.prototype.onDestroyed=function(r,a){var n=this;if(n.collections.indexOf(a)<0)return!1;n.collections.splice(n.collections.indexOf(a),1)};var HB=Hi;new HB;var XB=new Map,og=new Map,Qo=class{constructor(r,a,n,o){this.data=a;let{audio:f,volume:y,delay:x,loop:b}=a;if(!f)throw new Error("Missing property");let _=typeof f=="string"?o.getAudio(f).src:f.data;this.audioPlayer=new za({src:_,volume:y,delay:x,loop:b}),og.has(n.uuid)?og.get(n.uuid).push(this):og.set(n.uuid,[this]),XB.set(r,this)}playByToggle(){this.data.toggle==="stop"?this.audioPlayer.status==="playing"?this.audioPlayer.stop():(this.audioPlayer.stop(),this.audioPlayer.play()):this.data.toggle==="pause"?this.audioPlayer.status==="playing"?this.audioPlayer.pause():this.audioPlayer.play():(this.audioPlayer.stop(),this.audioPlayer.play())}dispose(){this.audioPlayer.stop()}},zf=class{constructor(r){this.data=r}dispatch(){this.data.playAudio?this.pauseAudio(this.data.playAudio):this.data.object?this.pauseAllAudiosFromObject(this.data.object):this.pauseAllAudios()}pauseAudio(r){let a=XB.get(r);!a||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{a.audioPlayer[this.data.interaction](),this.disposeDelay()},this.data.delay)):a.audioPlayer[this.data.interaction]())}pauseAllAudiosFromObject(r){let a=og.get(r);!(a!=null&&a.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{a.forEach(n=>n.audioPlayer[this.data.interaction]()),this.disposeDelay()},this.data.delay)):a.forEach(n=>n.audioPlayer[this.data.interaction]()))}pauseAllAudios(){let r=[...og.values()];!r.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{r.forEach(a=>{a.forEach(n=>{n.audioPlayer[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):r.forEach(a=>{a.forEach(n=>{n.audioPlayer[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},ag=class{constructor(r,a,n,o,f){if(this.data=a,this.shared=o,this.condition=f,a.interaction==="play")this.interaction=new Qo(r,a,n,o);else if(a.interaction==="pause"||a.interaction==="stop")this.interaction=new zf(a);else throw new Error("Missing property")}dispatchBasic(){if(Ct(this.shared,this.condition)===!1)return!1;this.interaction instanceof Qo?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){if(Ct(this.shared,this.condition)===!1)return!1;this.interaction instanceof Qo?this.interaction.audioPlayer.play():this.interaction.dispatch()}dispatchGameControl(r){if(Ct(this.shared,this.condition)===!1)return!1;this.interaction instanceof Qo&&(r==="start"?this.interaction.audioPlayer.play():this.interaction.audioPlayer.stop())}dispose(){this.interaction.dispose()}},lg=class{constructor(r,a,n,o){this.data=r,this.page=a,this.shared=n,this.condition=o,this.delay=0,this.emission=r.emission,r.delay!==void 0&&(this.delay=r.delay),this.particleSystem=this.page.scene.find(this.data.emitterObjectId)}toggleEmitting(){this.particleSystem.started&&!this.particleSystem.stopped?this.stop(this.delay):this.start(this.delay)}toggleFroze(){this.particleSystem.started&&!this.particleSystem.isFrozen?this.freeze(this.delay):this.unFreeze(this.delay)}start(r=0){if(r){this.delayTimerId=window.setTimeout(()=>{this.start(0),this.clearDelay()},r);return}this.particleSystem.start()}stop(r=0){if(r){this.delayTimerId=window.setTimeout(()=>{this.stop(0),this.clearDelay()},r);return}this.particleSystem.stop()}freeze(r=0){if(r){this.delayTimerId=window.setTimeout(()=>{this.freeze(0),this.clearDelay()},r);return}this.particleSystem.froze()}unFreeze(r=0){if(r){this.delayTimerId=window.setTimeout(()=>{this.unFreeze(0),this.clearDelay()},r);return}this.particleSystem.unFroze()}reset(r=0){if(r){this.delayTimerId=window.setTimeout(()=>{this.reset(0),this.clearDelay()},r);return}this.particleSystem.reset()}reverseFromCurrent(){switch(this.emission){case"emitToggle":this.toggleEmitting();break;case"pauseToggle":this.toggleFroze();break}}dispatchBasic(){if(Ct(this.shared,this.condition)===!1||!this.particleSystem)return!1;switch(this.emission){case"start":this.start(this.delay);break;case"emitToggle":this.toggleEmitting();break;case"pause":this.freeze(this.delay);break;case"pauseToggle":this.toggleFroze();break;case"stop":this.stop(this.delay);break;case"reset":this.reset(this.delay);break}}dispatchConditional(){if(Ct(this.shared,this.condition)===!1||!this.particleSystem)return!1;switch(this.emission){case"start":this.start(this.delay);break;case"stop":this.stop(this.delay);break;case"reset":this.reset(this.delay);break}}dispatchGameControl(r){if(Ct(this.shared,this.condition)===!1||!this.particleSystem)return!1;r==="start"?this.start(this.delay):this.stop(this.delay)}dispose(){!this.particleSystem||(this.particleSystem.reset(),this.clearDelay())}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}},HZ="text/plain",WZ="us-ascii",YB=(r,a)=>a.some(n=>n instanceof RegExp?n.test(r):n===r),qZ=(r,{stripHash:a})=>{let n=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(r);if(!n)throw new Error(`Invalid URL: ${r}`);let{type:o,data:f,hash:y}=n.groups,x=o.split(";");y=a?"":y;let b=!1;x[x.length-1]==="base64"&&(x.pop(),b=!0);let _=(x.shift()||"").toLowerCase(),S=[...x.map(A=>{let[C,P=""]=A.split("=").map(T=>T.trim());return C==="charset"&&(P=P.toLowerCase(),P===WZ)?"":`${C}${P?`=${P}`:""}`}).filter(Boolean)];return b&&S.push("base64"),(S.length>0||_&&_!==HZ)&&S.unshift(_),`data:${S.join(";")},${b?f.trim():f}${y?`#${y}`:""}`};function BT(r,a){if(a={defaultProtocol:"http:",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,sortQueryParameters:!0,...a},r=r.trim(),/^data:/i.test(r))return qZ(r,a);if(/^view-source:/i.test(r))throw new Error("`view-source:` is not supported as it is a non-standard protocol");let n=r.startsWith("//");!n&&/^\.*\//.test(r)||(r=r.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,a.defaultProtocol));let o=new URL(r);if(a.forceHttp&&a.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(a.forceHttp&&o.protocol==="https:"&&(o.protocol="http:"),a.forceHttps&&o.protocol==="http:"&&(o.protocol="https:"),a.stripAuthentication&&(o.username="",o.password=""),a.stripHash?o.hash="":a.stripTextFragment&&(o.hash=o.hash.replace(/#?:~:text.*?$/i,"")),o.pathname){let y=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g,x=0,b="";for(;;){let S=y.exec(o.pathname);if(!S)break;let A=S[0],C=S.index,P=o.pathname.slice(x,C);b+=P.replace(/\/{2,}/g,"/"),b+=A,x=C+A.length}let _=o.pathname.slice(x,o.pathname.length);b+=_.replace(/\/{2,}/g,"/"),o.pathname=b}if(o.pathname)try{o.pathname=decodeURI(o.pathname)}catch{}if(a.removeDirectoryIndex===!0&&(a.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(a.removeDirectoryIndex)&&a.removeDirectoryIndex.length>0){let y=o.pathname.split("/"),x=y[y.length-1];YB(x,a.removeDirectoryIndex)&&(y=y.slice(0,-1),o.pathname=y.slice(1).join("/")+"/")}if(o.hostname&&(o.hostname=o.hostname.replace(/\.$/,""),a.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(o.hostname)&&(o.hostname=o.hostname.replace(/^www\./,""))),Array.isArray(a.removeQueryParameters))for(let y of[...o.searchParams.keys()])YB(y,a.removeQueryParameters)&&o.searchParams.delete(y);if(a.removeQueryParameters===!0&&(o.search=""),a.sortQueryParameters){o.searchParams.sort();try{o.search=decodeURIComponent(o.search)}catch{}}a.removeTrailingSlash&&(o.pathname=o.pathname.replace(/\/$/,""));let f=r;return r=o.toString(),!a.removeSingleSlash&&o.pathname==="/"&&!f.endsWith("/")&&o.hash===""&&(r=r.replace(/\/$/,"")),(a.removeTrailingSlash||o.pathname==="/")&&o.hash===""&&a.removeSingleSlash&&(r=r.replace(/\/$/,"")),n&&!a.normalizeProtocol&&(r=r.replace(/^http:\/\//,"//")),a.stripProtocol&&(r=r.replace(/^(?:https?:)?\/\//,"")),r}var Db=class{constructor({url:r,context:a},n,o,f){if(this.controlsManager=n,this.shared=o,this.condition=f,!r)throw new Error("Missing property");this.url=r.startsWith("mailto:")?r:BT(r,{removeTrailingSlash:!1,removeSingleSlash:!1,stripWWW:!1}),this.context=a??"tab"}dispatch(){var r;if(Ct(this.shared,this.condition)===!1)return!1;bo?window.location.assign(this.url):(this.context==="tab"||Sw&&this.context==="none"?window.open(this.url,"_blank"):this.context==="window"?window.open(this.url,"_blank",`width=${window.innerWidth}, height=${window.innerHeight}`):window.open(this.url,"_parent"),(r=this.controlsManager.orbitControls)==null||r.onPointerUp($e[0]),yI())}},cg=class{constructor(r,a,n,o,f){this.data=r,this.page=a,this.controlsManager=n,this.shared=o,this.condition=f,this.timeoutIdQueue=[],this.dispatchInner=()=>{this.objects.forEach(this.destroyCallback)},this.destroyCallback=y=>{var S,A;this.timeoutIdQueue.shift();let x=this.page.scene.find(y);if(x===void 0)return;let b=this.controlsManager.sharedGameControlGlobals.rapierWorld,_=b?(S=x.dataPatched.physics)==null?void 0:S.fusedBody:!0;if(x.cloner){for(let C of x.cloner.children)_?(C.playModeVisible=!1,C.rigidBody&&((A=x.dataPatched.physics)==null?void 0:A.rigidBody)==="positioned"&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(C.rigidBody.collider(0).handle),b.removeRigidBody(C.rigidBody),C.rigidBody=void 0),C.bvhGeometry&&(C.bvhGeometry=void 0)):this.clone===void 0||this.clone===C?(C.playModeVisible=!1,C.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(C.rigidBody.collider(0).handle),b.removeRigidBody(C.rigidBody),C.rigidBody=void 0)):C.playModeVisible===void 0&&(C.playModeVisible=!0);(_||this.clone===void 0||this.clone===!1)&&(x.visible=!1,x.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(x.rigidBody.collider(0).handle),b.removeRigidBody(x.rigidBody),x.rigidBody=void 0),x.bvhGeometry&&(x.bvhGeometry=void 0))}else x.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(x.rigidBody.collider(0).handle),b.removeRigidBody(x.rigidBody),x.rigidBody=void 0),x.bvhGeometry&&(x.bvhGeometry=void 0),x.visible=!1;b===void 0?this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(C=>C.bvhGeometry!==void 0):this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(C=>C.rigidBody!==void 0),x.destroyedInAction=!0,this.controlsManager.requestRender()},this.objects=[...r.objects]}dispatch(r){if(Ct(this.shared,this.condition)===!1)return!1;this.clone=r,this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()}dispatchFromStart(){if(Ct(this.shared,this.condition)===!1)return!1;this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))}dispose(){this.timeoutIdQueue.forEach(r=>window.clearTimeout(r))}},ug=class{constructor(r,a,n,o,f){this.data=r,this.page=a,this.shared=n,this.eventManager=o,this.condition=f,this.shared=n}dispatch(){if(Ct(this.shared,this.condition)===!1)return!1;clearTimeout(this.timeoutId),delete this.timeoutId,this.timeoutId=window.setTimeout(()=>{var r;this.shared.reset(this.shared.data,!0),kf(this.page,this.shared,!0),this.eventManager.reset(),(r=this.eventManager.controlsManager.gameControl)==null||r.reset(!0),this.page.switchToPlayCamera(),this.eventManager.controlsManager.requestRender(),delete this.timeoutId},(this.data.delay??0)*1e3)}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},tN={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,timelineChangeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0,rewind:!0},UT={duration:1e3,delay:0,endDelay:0,startOnceDelay:0,pingPongDelayCorrection:0,pingPongEndDelayCorrection:0,easing:"easeOutElastic(1, .5)",round:0},XZ=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],Ob={CSS:{},springs:{}};function io(r,a,n){return Math.min(Math.max(r,a),n)}function hg(r,a){return r.indexOf(a)>-1}function NT(r,a){return r.apply(null,a)}var dt={arr:function(r){return Array.isArray(r)},obj:function(r){return hg(Object.prototype.toString.call(r),"Object")},pth:function(r){return dt.obj(r)&&r.hasOwnProperty("totalLength")},svg:function(r){return r instanceof SVGElement},inp:function(r){return r instanceof HTMLInputElement},dom:function(r){return!("isNode"in r)&&(r.nodeType||dt.svg(r))},str:function(r){return typeof r=="string"},fnc:function(r){return typeof r=="function"},und:function(r){return typeof r>"u"},hex:function(r){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(r)},rgb:function(r){return/^rgb/.test(r)},hsl:function(r){return/^hsl/.test(r)},col:function(r){return dt.hex(r)||dt.rgb(r)||dt.hsl(r)},key:function(r){return!tN.hasOwnProperty(r)&&!UT.hasOwnProperty(r)&&r!=="targets"&&r!=="keyframes"}};function rN(r){var a=/\(([^)]+)\)/.exec(r);return a?a[1].split(",").map(function(n){return parseFloat(n)}):[]}function iN(r,a){var n=rN(r),o=io(dt.und(n[0])?1:n[0],.1,100),f=io(dt.und(n[1])?100:n[1],.1,100),y=io(dt.und(n[2])?10:n[2],.1,100),x=io(dt.und(n[3])?0:n[3],.1,100),b=Math.sqrt(f/o),_=y/(2*Math.sqrt(f*o)),S=_<1?b*Math.sqrt(1-_*_):0,A=1,C=_<1?(_*b+-x)/S:-x+b;function P(M){var O=a?a*M/1e3:M;return _<1?O=Math.exp(-O*_*b)*(A*Math.cos(S*O)+C*Math.sin(S*O)):O=(A+C*O)*Math.exp(-O*b),M===0||M===1?M:1-O}function T(){var M=Ob.springs[r];if(M)return M;for(var O=1/6,I=0,D=0;;)if(I+=O,P(I)===1){if(D++,D>=16)break}else D=0;var z=I*O*1e3;return Ob.springs[r]=z,z}return a?P:T}function YZ(r){return r===void 0&&(r=10),function(a){return Math.ceil(io(a,1e-6,1)*r)*(1/r)}}var KZ=function(){var r=11,a=1/(r-1);function n(A,C){return 1-3*C+3*A}function o(A,C){return 3*C-6*A}function f(A){return 3*A}function y(A,C,P){return((n(C,P)*A+o(C,P))*A+f(C))*A}function x(A,C,P){return 3*n(C,P)*A*A+2*o(C,P)*A+f(C)}function b(A,C,P,T,M){var O,I,D=0;do I=C+(P-C)/2,O=y(I,T,M)-A,O>0?P=I:C=I;while(Math.abs(O)>1e-7&&++D<10);return I}function _(A,C,P,T){for(var M=0;M<4;++M){var O=x(C,P,T);if(O===0)return C;var I=y(C,P,T)-A;C-=I/O}return C}function S(A,C,P,T){if(!(0<=A&&A<=1&&0<=P&&P<=1))return;var M=new Float32Array(r);if(A!==C||P!==T)for(var O=0;O<r;++O)M[O]=y(O*a,A,P);function I(D){for(var z=0,k=1,L=r-1;k!==L&&M[k]<=D;++k)z+=a;--k;var R=(D-M[k])/(M[k+1]-M[k]),F=z+R*a,B=x(F,A,P);return B>=.001?_(D,F,A,P):B===0?F:b(D,z,z+a,A,P)}return function(D){return A===C&&P===T||D===0||D===1?D:y(I(D),C,T)}}return S}(),nN=function(){var r={linear:function(){return function(o){return o}}},a={Sine:function(){return function(o){return 1-Math.cos(o*Math.PI/2)}},Circ:function(){return function(o){return 1-Math.sqrt(1-o*o)}},Back:function(){return function(o){return o*o*(3*o-2)}},Bounce:function(){return function(o){for(var f,y=4;o<((f=Math.pow(2,--y))-1)/11;);return 1/Math.pow(4,3-y)-7.5625*Math.pow((f*3-2)/22-o,2)}},Elastic:function(o,f){o===void 0&&(o=1),f===void 0&&(f=.5);var y=io(o,1,10),x=io(f,.1,2);return function(b){return b===0||b===1?b:-y*Math.pow(2,10*(b-1))*Math.sin((b-1-x/(Math.PI*2)*Math.asin(1/y))*(Math.PI*2)/x)}}},n=["Quad","Cubic","Quart","Quint","Expo"];return n.forEach(function(o,f){a[o]=function(){return function(y){return Math.pow(y,f+2)}}}),Object.keys(a).forEach(function(o){var f=a[o];r["easeIn"+o]=f,r["easeOut"+o]=function(y,x){return function(b){return 1-f(y,x)(1-b)}},r["easeInOut"+o]=function(y,x){return function(b){return b<.5?f(y,x)(b*2)/2:1-f(y,x)(b*-2+2)/2}}}),r}();function zT(r,a){if(dt.fnc(r))return r;var n=r.split("(")[0],o=nN[n],f=rN(r);switch(n){case"spring":return iN(r,a);case"cubicBezier":return NT(KZ,f);case"steps":return NT(YZ,f);default:return NT(o,f)}}function sN(r){try{var a=document.querySelectorAll(r);return a}catch{return}}function Rb(r,a){for(var n=r.length,o=arguments.length>=2?arguments[1]:void 0,f=[],y=0;y<n;y++)if(y in r){var x=r[y];a.call(o,x,y,r)&&f.push(x)}return f}function Lb(r){return r.reduce(function(a,n){return a.concat(dt.arr(n)?Lb(n):n)},[])}function KB(r){return dt.arr(r)?r:(dt.str(r)&&(r=sN(r)||r),r instanceof NodeList||r instanceof HTMLCollection?[].slice.call(r):[r])}function kT(r,a){return r.some(function(n){return n===a})}function GT(r){var a={};for(var n in r)a[n]=r[n];return a}function FT(r,a){var n=GT(r);for(var o in r)n[o]=a.hasOwnProperty(o)?a[o]:r[o];return n}function Bb(r,a){var n=GT(r);for(var o in a)n[o]=dt.und(r[o])?a[o]:r[o];return n}function QZ(r){var a=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(r);return a?"rgba("+a[1]+",1)":r}function ZZ(r){var a=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,n=r.replace(a,function(b,_,S,A){return _+_+S+S+A+A}),o=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n),f=parseInt(o[1],16),y=parseInt(o[2],16),x=parseInt(o[3],16);return"rgba("+f+","+y+","+x+",1)"}function JZ(r){var a=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(r)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(r),n=parseInt(a[1],10)/360,o=parseInt(a[2],10)/100,f=parseInt(a[3],10)/100,y=a[4]||1;function x(P,T,M){return M<0&&(M+=1),M>1&&(M-=1),M<1/6?P+(T-P)*6*M:M<1/2?T:M<2/3?P+(T-P)*(2/3-M)*6:P}var b,_,S;if(o==0)b=_=S=f;else{var A=f<.5?f*(1+o):f+o-f*o,C=2*f-A;b=x(C,A,n+1/3),_=x(C,A,n),S=x(C,A,n-1/3)}return"rgba("+b*255+","+_*255+","+S*255+","+y+")"}function $Z(r){if(dt.rgb(r))return QZ(r);if(dt.hex(r))return ZZ(r);if(dt.hsl(r))return JZ(r)}function Wa(r){var a=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(r);if(a)return a[1]}function eJ(r){if(hg(r,"translate")||r==="perspective")return"px";if(hg(r,"rotate")||hg(r,"skew"))return"deg"}function VT(r,a){return dt.fnc(r)?r(a.target,a.id,a.total):r}function Zo(r,a){return r.getAttribute(a)}function jT(r,a,n){var o=Wa(a);if(kT([n,"deg","rad","turn"],o))return a;var f=Ob.CSS[a+n];if(!dt.und(f))return f;var y=100,x=document.createElement(r.tagName),b=r.parentNode&&r.parentNode!==document?r.parentNode:document.body;b.appendChild(x),x.style.position="absolute",x.style.width=y+n;var _=y/x.offsetWidth;b.removeChild(x);var S=_*parseFloat(a);return Ob.CSS[a+n]=S,S}function oN(r,a,n){if(a in r.style){var o=a.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),f=r.style[a]||getComputedStyle(r).getPropertyValue(o)||"0";return n?jT(r,f,n):f}}function HT(r,a){if(dt.dom(r)&&!dt.inp(r)&&(Zo(r,a)||dt.svg(r)&&r[a]))return"attribute";if(dt.dom(r)&&kT(XZ,a))return"transform";if(dt.dom(r)&&a!=="transform"&&oN(r,a))return"css";if(r[a]!=null)return"object"}function aN(r){if(dt.dom(r)){for(var a=r.style.transform||"",n=/(\w+)\(([^)]*)\)/g,o=new Map,f;f=n.exec(a);)o.set(f[1],f[2]);return o}}function tJ(r,a,n,o){var f=hg(a,"scale")?1:0+eJ(a),y=aN(r).get(a)||f;return n&&(n.transforms.list.set(a,y),n.transforms.last=a),o?jT(r,y,o):y}function WT(r,a,n,o){switch(HT(r,a)){case"transform":return tJ(r,a,o,n);case"css":return oN(r,a,n);case"attribute":return Zo(r,a);default:return r[a]||0}}function qT(r,a){var n=/^(\*=|\+=|-=)/.exec(r);if(!n)return r;var o=Wa(r)||0,f=parseFloat(a),y=parseFloat(r.replace(n[0],""));switch(n[0][0]){case"+":return f+y+o;case"-":return f-y+o;case"*":return f*y+o}}function lN(r,a){if(dt.col(r))return $Z(r);if(/\s/g.test(r))return r;var n=Wa(r),o=n?r.substr(0,r.length-n.length):r;return a?o+a:o}function XT(r,a){return Math.sqrt(Math.pow(a.x-r.x,2)+Math.pow(a.y-r.y,2))}function rJ(r){return Math.PI*2*Zo(r,"r")}function iJ(r){return Zo(r,"width")*2+Zo(r,"height")*2}function nJ(r){return XT({x:Zo(r,"x1"),y:Zo(r,"y1")},{x:Zo(r,"x2"),y:Zo(r,"y2")})}function cN(r){for(var a=r.points,n=0,o,f=0;f<a.numberOfItems;f++){var y=a.getItem(f);f>0&&(n+=XT(o,y)),o=y}return n}function sJ(r){var a=r.points;return cN(r)+XT(a.getItem(a.numberOfItems-1),a.getItem(0))}function uN(r){if(r.getTotalLength)return r.getTotalLength();switch(r.tagName.toLowerCase()){case"circle":return rJ(r);case"rect":return iJ(r);case"line":return nJ(r);case"polyline":return cN(r);case"polygon":return sJ(r)}}function oJ(r){var a=uN(r);return r.setAttribute("stroke-dasharray",a),a}function aJ(r){for(var a=r.parentNode;dt.svg(a)&&dt.svg(a.parentNode);)a=a.parentNode;return a}function hN(r,a){var n=a||{},o=n.el||aJ(r),f=o.getBoundingClientRect(),y=Zo(o,"viewBox"),x=f.width,b=f.height,_=n.viewBox||(y?y.split(" "):[0,0,x,b]);return{el:o,viewBox:_,x:_[0]/1,y:_[1]/1,w:x/_[2],h:b/_[3]}}function lJ(r,a){var n=dt.str(r)?sN(r)[0]:r,o=a||100;return function(f){return{property:f,el:n,svg:hN(n),totalLength:uN(n)*(o/100)}}}function cJ(r,a){function n(b){b===void 0&&(b=0);var _=a+b>=1?a+b:0;return r.el.getPointAtLength(_)}var o=hN(r.el,r.svg),f=n(),y=n(-1),x=n(1);switch(r.property){case"x":return(f.x-o.x)*o.w;case"y":return(f.y-o.y)*o.h;case"angle":return Math.atan2(x.y-y.y,x.x-y.x)*180/Math.PI}}function QB(r,a){var n=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,o=lN(dt.pth(r)?r.totalLength:r,a)+"";return{original:o,numbers:o.match(n)?o.match(n).map(Number):[0],strings:dt.str(r)||a?o.split(n):[]}}function dN(r){var a=r?Lb(dt.arr(r)?r.map(KB):KB(r)):[];return Rb(a,function(n,o,f){return f.indexOf(n)===o})}function fN(r){var a=dN(r);return a.map(function(n,o){return{target:n,id:o,total:a.length,transforms:{list:aN(n)}}})}function uJ(r,a){var n=GT(a);if(/^spring/.test(n.easing)&&(n.duration=iN(n.easing)),dt.arr(r)){var o=r.length,f=o===2&&!dt.obj(r[0]);f?r={value:r}:dt.fnc(a.duration)||(n.duration=a.duration/o)}var y=dt.arr(r)?r:[r];return y.map(function(x,b){var _=dt.obj(x)&&!dt.pth(x)?x:{value:x};return dt.und(_.delay)&&(_.delay=b?0:a.delay),dt.und(_.endDelay)&&(_.endDelay=b===y.length-1?a.endDelay:0),_}).map(function(x){return Bb(x,n)})}function hJ(r){for(var a=Rb(Lb(r.map(function(y){return Object.keys(y)})),function(y){return dt.key(y)}).reduce(function(y,x){return y.indexOf(x)<0&&y.push(x),y},[]),n={},o=function(y){var x=a[y];n[x]=r.map(function(b){var _={};for(var S in b)dt.key(S)?S==x&&(_.value=b[S]):_[S]=b[S];return _})},f=0;f<a.length;f++)o(f);return n}function dJ(r,a){var n=[],o=a.keyframes;o&&(a=Bb(hJ(o),a));for(var f in a)dt.key(f)&&n.push({name:f,tweens:uJ(a[f],r)});return n}function fJ(r,a){var n={};for(var o in r){var f=VT(r[o],a);dt.arr(f)&&(f=f.map(function(y){return VT(y,a)}),f.length===1&&(f=f[0])),n[o]=f}return n.duration=parseFloat(n.duration),n.delay=parseFloat(n.delay),n}function pJ(r,a){var n;return r.tweens.map(function(o){var f=fJ(o,a),y=f.value,x=dt.arr(y)?y[1]:y,b=Wa(x),_=WT(a.target,r.name,b,a),S=n?n.to.original:_,A=dt.arr(y)?y[0]:S,C=Wa(A)||Wa(_),P=b||C;return dt.und(x)&&(x=S),f.from=QB(A,P),f.to=QB(qT(x,A),P),f.start=n?n.end:0,f.end=f.start+f.delay+f.duration+f.endDelay,f.easing=zT(f.easing,f.duration),f.isPath=dt.pth(y),f.isColor=dt.col(f.from.original),f.isColor&&(f.round=1),n=f,f})}var pN={css:function(r,a,n){return r.style[a]=n},attribute:function(r,a,n){return r.setAttribute(a,n)},object:function(r,a,n){return r[a]=n},transform:function(r,a,n,o,f){if(o.list.set(a,n),a===o.last||f){var y="";o.list.forEach(function(x,b){y+=b+"("+x+") "}),r.style.transform=y}}};function mN(r,a){var n=fN(r);n.forEach(function(o){for(var f in a){var y=VT(a[f],o),x=o.target,b=Wa(y),_=WT(x,f,b,o),S=b||Wa(_),A=qT(lN(y,S),_),C=HT(x,f);pN[C](x,f,A,o.transforms,!0)}})}function mJ(r,a){var n=HT(r.target,a.name);if(n){var o=pJ(a,r),f=o[o.length-1];return{type:n,property:a.name,animatable:r,tweens:o,duration:f.end,delay:o[0].delay,endDelay:f.endDelay}}}function gJ(r,a){return Rb(Lb(r.map(function(n){return a.map(function(o){return mJ(n,o)})})),function(n){return!dt.und(n)})}function gN(r,a){var n=r.length,o=function(y){return y.timelineOffset?y.timelineOffset:0},f={};return f.duration=n?Math.max.apply(Math,r.map(function(y){let x=y.startOnceDelay??0,b=y.pingPongDelayCorrection??0,_=y.pingPongEndDelayCorrection??0;return o(y)+x+b+_+y.duration*(y.loop??1)})):a.duration,f.delay=n?Math.min.apply(Math,r.map(function(y){let x=y.startOnceDelay??0,b=y.pingPongDelayCorrection??0;return o(y)+x+b+y.delay})):a.delay,f.endDelay=n?f.duration-Math.max.apply(Math,r.map(function(y){let x=y.startOnceDelay??0,b=y.pingPongDelayCorrection??0,_=y.pingPongEndDelayCorrection??0;return o(y)+x+b+y.duration*(y.loop??1)-y.endDelay-_})):a.endDelay,f}var ZB=0;function yJ(r){var a=FT(tN,r),n=FT(UT,r),o=dJ(n,r),f=fN(r.targets),y=gJ(f,o),x=gN(y,n),b=ZB;return ZB++,Bb(a,{id:b,children:[],animatables:f,animations:y,duration:x.duration,delay:x.delay,endDelay:x.endDelay,startOnceDelay:n.startOnceDelay,pingPongDelayCorrection:n.pingPongDelayCorrection,pingPongEndDelayCorrection:n.pingPongEndDelayCorrection})}var Cs=[],JB=[],Gf,$B=function(){let r=0,a=!0;function n(y){let x=Cs.length;if(x){let b=0;for(;b<x;){let _=Cs[b];_.paused?(Cs.splice(b,1),x--):(_.tick(y),b++)}Gf=requestAnimationFrame(n)}else Gf&&(cancelAnimationFrame(Gf),Gf=null)}function o(){r=performance.now(),Gf=requestAnimationFrame(n)}function f(y){r+=y,n(r)}return{isUsingInternalRaf:a,play:o,update:f}}();function vJ(r){document.hidden?(Cs.forEach(function(a){return a.pause(r.timeStamp)}),JB=Cs.slice(0),ci.running=Cs=[]):JB.forEach(function(a){return a.play(r.timeStamp)})}typeof document<"u"&&document.addEventListener("visibilitychange",vJ);function ci(r){r===void 0&&(r={});var a=0,n=0,o=0,f,y,x=0,b=null;function _(F){var B=window.Promise&&new Promise(function(N){return b=N});return F.finished=B,B}var S=yJ(r);_(S);function A(){var F=S.direction;F!=="alternate"&&(S.direction=F!=="normal"?"normal":"reverse"),S.reversed=!S.reversed,y.forEach(function(B){(B.loop===1||B.loop%2===0)&&(B.reversed=S.reversed)})}function C(){S.direction="normal",S.reversed=!1,y.forEach(function(F){return F.reversed=!1})}function P(F){return S.reversed?S.duration-F:F}function T(){a=0,n=P(S.currentTime)*(1/ci.speed)}function M(F,B,N=!1){B&&(S.reversed?B.seek(B.duration*B.loop-(F-B.timelineOffset-B.pingPongDelayCorrection),N):B.seek(F-B.timelineOffset-B.startOnceDelay-B.pingPongDelayCorrection,N))}function O(F,B=!1){if(S.reversed)for(var N=x;N--;)M(F,y[N],B);else for(var j=0;j<x;j++)M(F,y[j],B)}function I(F){var ye,_e,ve,Ee,xe,Me,Pe,be,Oe,Be;var B=0,N=S.animations,j=N.length;for(S.direction!=="alternate"&&((ye=S.parent)==null?void 0:ye.direction)==="alternate"?((_e=S.parent)==null?void 0:_e.rewind)===!1&&S.reversePlayback===!0&&S.rewind===!1&&((ve=S.parent)!=null&&ve.reversed&&S.direction==="alternate"?F=S.duration-S.delay+S.endDelay-F:F=S.duration+S.delay-S.endDelay-F):L(!1,(Ee=S.parent)==null?void 0:Ee.rewind,S.rewind,(xe=S.parent)==null?void 0:xe.reversePlayback,S.reversePlayback)&&((Me=S.parent)!=null&&Me.reversed&&S.direction==="alternate"?F=S.duration-S.delay+S.endDelay-F:F=S.duration+S.delay-S.endDelay-F);B<j;){var G=N[B],Y=G.animatable,X=G.tweens,$=X.length-1,te=X[$];$&&(te=Rb(X,function(De){return F<De.end})[0]||te);let oe;(Pe=S.parent)!=null&&Pe.reversed&&S.direction==="alternate"?oe=io(F-te.start-te.endDelay,0,te.duration)/te.duration:oe=io(F-te.start-te.delay,0,te.duration)/te.duration;for(var ee=isNaN(oe)?1:te.easing(oe),q=te.to.strings,Z=te.round,U=[],W=te.to.numbers.length,H=void 0,K=0;K<W;K++){var le=void 0;let De,ze;S.direction!=="alternate"?((be=S.parent)==null?void 0:be.rewind)===!1&&S.reversePlayback===!0&&S.rewind===!1?(De=te.to.numbers[K],ze=te.from.numbers[K]||0):(ze=te.to.numbers[K],De=te.from.numbers[K]||0):L(!0,(Oe=S.parent)==null?void 0:Oe.rewind,S.rewind,(Be=S.parent)==null?void 0:Be.reversePlayback,S.reversePlayback)?(De=te.to.numbers[K],ze=te.from.numbers[K]||0):(ze=te.to.numbers[K],De=te.from.numbers[K]||0),te.isPath?le=cJ(te.value,ee*ze):le=De+ee*(ze-De),Z&&(te.isColor&&K>2||(le=Math.round(le*Z)/Z)),U.push(le)}var me=q.length;if(!me)H=U[0];else{H=q[0];for(var ne=0;ne<me;ne++){q[ne];var pe=q[ne+1],ge=U[ne];isNaN(ge)||(pe?H+=ge+pe:H+=ge+" ")}}pN[G.type](Y.target,G.property,H,Y.transforms),G.currentValue=H,B++}}function D(F){S[F]&&!S.passThrough&&S[F](S)}function z(){S.remaining&&S.remaining!==!0&&S.remaining--}let k={0:!1,1:!0,2:!1,3:!0,4:!1,5:!1,6:!1,7:!1,8:!1,9:!0,10:!0,11:!1,12:!1,13:!1,14:!0,15:!0,16:!1,17:!0,18:!0,19:!1,20:!1,21:!1,22:!0,23:!0,24:!1,25:!0,26:!1,27:!0,28:!1,29:!1,30:!1,31:!1};function L(F,B,N,j,G){return k[F<<4|B<<3|N<<2|j<<1|G]}function R(F,B=!1){var X;var N=S.duration;let j=S.delay,G=N-S.endDelay;(X=S.parent)!=null&&X.reversed&&S.direction==="alternate"&&(j=S.endDelay,G=N-S.delay);var Y=P(F);if(S.progress=io(Y/N*100,0,100),B||(S.reversePlayback=Y<S.currentTime),x&&O(Y,B),!S.began&&S.currentTime>=0&&(S.began=!0,D("begin")),!S.loopBegan&&S.currentTime>0&&(S.loopBegan=!0,D("loopBegin")),(S.reversed||Y>=0)&&Y<=j&&S.currentTime!==0&&(I(0),D("change")),(Y>=G&&S.currentTime!==N+S.pingPongDelayCorrection||!N)&&(I(N),D("change")),Y>j&&Y<G?(S.changeBegan||(S.changeBegan=!0,S.changeCompleted=!1,D("changeBegin")),I(Y),D("change")):S.changeBegan?(S.changeCompleted=!0,S.changeBegan=!1,D("change"),x&&D("timelineChangeComplete")):S.began&&Y>G&&D("changeComplete"),S.currentTime=io(Y,0,N+S.pingPongDelayCorrection),S.began&&D("update"),F>=N)if(z(),!S.remaining)S.paused=!0,S.completed||(S.completed=!0,D("loopComplete"),D("complete"),!S.passThrough&&"Promise"in window&&(b(),_(S)));else{x?a+=S.duration/ci.speed:a+=S.duration;for(let $ of y)$.setStartTime(0),$.remaining=$.loop;D("loopComplete"),S.loopBegan=!1,S.direction==="alternate"?A():x&&C()}}return S.reset=function(){var F=S.direction;S.passThrough=!1,S.currentTime=0,S.progress=0,S.paused=!0,S.began=!1,S.loopBegan=!1,S.changeBegan=!1,S.completed=!1,S.changeCompleted=!1,S.reversePlayback=!1,S.reversed=F==="reverse",S.remaining=S.loop,y=S.children,x=y.length;for(var B=x;B--;)S.children[B].reset();I(S.reversed?S.duration:0)},S.setStartTime=function(F){a=F},S.set=function(F,B){return mN(F,B),S},S.tick=function(F){o=F,a||(a=o),R((o+(n-a))*ci.speed)},S.seek=function(F,B=!1){R(F-a,B)},S.pause=function(F){S.paused=!0,x&&(f=F??performance.now())},S.play=function(F){!S.paused||(S.completed&&S.reset(),S.paused=!1,Cs.push(S),x&&f!==void 0&&(a+=(F??performance.now())-f),!Gf&&$B.isUsingInternalRaf&&$B.play())},S.reverse=function(){A(),S.completed=!S.reversed,T()},S.restart=function(){S.reset(),S.play()},S.reset(),S.autoplay&&S.play(),S}function eN(r,a){for(var n=a.length;n--;)kT(r,a[n].animatable.target)&&a.splice(n,1)}function xJ(r){for(var a=dN(r),n=Cs.length;n--;){var o=Cs[n],f=o.animations,y=o.children;eN(a,f);for(var x=y.length;x--;){var b=y[x],_=b.animations;eN(a,_),!_.length&&!b.children.length&&y.splice(x,1)}!f.length&&!y.length&&o.pause()}}function bJ(r,a){a===void 0&&(a={});var n=a.direction||"normal",o=a.easing?zT(a.easing):null,f=a.grid,y=a.axis,x=a.from||0,b=x==="first",_=x==="center",S=x==="last",A=dt.arr(r),C=parseFloat(A?r[0]:r),P=A?parseFloat(r[1]):0,T=Wa(A?r[1]:r)||0,M=a.start||0+(A?C:0),O=[],I=0;return function(D,z,k){if(b&&(x=0),_&&(x=(k-1)/2),S&&(x=k-1),!O.length){for(var L=0;L<k;L++){if(!f)O.push(Math.abs(x-L));else{var R=_?(f[0]-1)/2:x%f[0],F=_?(f[1]-1)/2:Math.floor(x/f[0]),B=L%f[0],N=Math.floor(L/f[0]),j=R-B,G=F-N,Y=Math.sqrt(j*j+G*G);y==="x"&&(Y=-j),y==="y"&&(Y=-G),O.push(Y)}I=Math.max.apply(Math,O)}o&&(O=O.map(function($){return o($/I)*I})),n==="reverse"&&(O=O.map(function($){return y?$<0?$*-1:-$:Math.abs(I-$)}))}var X=A?(P-C)/I:C;return M+X*(Math.round(O[z]*100)/100)+T}}function SJ(r){r===void 0&&(r={});var a=ci(r);return a.duration=0,a.add=function(n,o){var f=Cs.indexOf(a),y=a.children;f>-1&&Cs.splice(f,1);function x(P){P.passThrough=!0}for(var b=0;b<y.length;b++)x(y[b]);var _=Bb(n,FT(UT,r));_.targets=_.targets||r.targets;var S=a.duration;_.autoplay=!1,_.timelineOffset=dt.und(o)?S:qT(o,S),x(a);var A=ci(_);x(A),y.push(A),A.parent=a;var C=gN(y,r);return a.delay=C.delay,a.endDelay=C.endDelay,a.duration=C.duration,A.loop===!0&&(a.duration=1/0),a.seek(0),a.reset(),a.autoplay&&a.play(),a},a}ci.version="3.2.0";ci.speed=1;ci.running=Cs;ci.remove=xJ;ci.get=WT;ci.set=mN;ci.convertPx=jT;ci.path=lJ;ci.setDashoffset=oJ;ci.stagger=bJ;ci.timeline=SJ;ci.easing=zT;ci.penner=nN;ci.random=function(r,a){return Math.floor(Math.random()*(a-r+1))+r};var jf=ci,yN=new E,vN=new E,xN=new Ke;function SN(r,a,n,o){if(o===0)return n.copy(r);if(o===1)return n.copy(a);let f=r.w*a.w+r.x*a.x+r.y*a.y+r.z*a.z;if(f>=1)return n.copy(r);let y=1-f*f;if(y<=Number.EPSILON){let A=1-o;return n.w=A*r.w+o*a.w,n.x=A*r.x+o*a.x,n.y=A*r.y+o*a.y,n.z=A*r.z+o*a.z,n.normalize(),n}let x=Math.sqrt(y),b=Math.atan2(x,f),_=Math.sin((1-o)*b)/x,S=Math.sin(o*b)/x;return n.w=r.w*_+a.w*S,n.x=r.x*_+a.x*S,n.y=r.y*_+a.y*S,n.z=r.z*_+a.z*S,n}function $r(r,a,n,o,f,y){let x=n[r]!==void 0?n[r]:void 0,b=o[r];if(b==null)return;let _=x!=null?typeof x=="string"?Number(f.getVariable(x)??0):x:a[r],S=typeof b=="string"?Number(f.getVariable(b)??0):b;if(_!==S)return{update:A=>{let C=we.lerp(_,S,A);y?a[r]=Math.trunc(C):a[r]=C},start:()=>{a[r]=_},end:()=>{a[r]=S}}}function fg(r,a,n,o,f,y){let x=n[r]?n[r]:void 0,b=o[r];if(!b)return;let _=a[r],S=[...x??_].map(C=>typeof C=="string"?Number(f.getVariable(C)??0):C),A=[...b].map(C=>typeof C=="string"?Number(f.getVariable(C)??0):C);if(!(S.length!==A.length||Fc(S,A)))return{update:C=>{S.forEach((P,T)=>{let M=we.lerp(P,A[T],C);a[r][T]=y?Math.trunc(M):M})},start:()=>{Object.assign(a[r],S)},end:()=>{Object.assign(a[r],A)}}}function dg(r,a,n){return a.forEach((o,f)=>{r.setComponent(f,typeof o=="string"?Number(n.getVariable(o)??0):o)}),r}function YT(r,a,n,o,f){let y=n[r]?n[r]:void 0,x=o[r];if(!x)return;let b=a[r],_=y?dg(new E,y,f):b.clone(),S=dg(new E,x,f);if(!_.equals(S))return{update:A=>{b.lerpVectors(_,S,A)},start:()=>{b.copy(_)},end:()=>{b.copy(S)}}}function bN(r,a,n){return a.forEach((o,f)=>{r.setComponent(f,typeof o=="string"?Number(n.getVariable(o)??0):o)}),r}function Hf(r,a,n,o,f){let y=n[r]?n[r]:void 0,x=o[r];if(!x)return;let b=a[r],_=!(b instanceof V),S=b instanceof V?b:new V().fromArray(b),A=y?bN(new V,y,f):S.clone(),C=bN(new V,x,f);if(!A.equals(C))return{update:P=>{S.lerpVectors(A,C,P),_&&(a[r]=S.toArray())},start:()=>{S.copy(A),_&&(a[r]=S.toArray())},end:()=>{S.copy(C),_&&(a[r]=S.toArray())}}}function wN(r,a,n,o){let f=n[r]?n[r]:void 0,y=o[r];if(!y)return;let x=a[r],b=f?new ue().fromArray(f):x.clone(),_=new E,S=new Ke,A=new E;b.decompose(_,S,A);let C=new ue().fromArray(y),P=new E,T=new Ke,M=new E;if(C.decompose(P,T,M),!b.equals(C))return{update:O=>{xN.slerpQuaternions(S,T,O),yN.lerpVectors(_,P,O),vN.lerpVectors(A,M,O),x.compose(yN,xN,vN)},start:()=>{x.compose(_,S,A)},end:()=>{x.compose(P,T,M)}}}function AN(r,a,n,o,f){let y=n[r]?n[r]:void 0,x=o[r];if(!x)return;let b=a[r],_=y?typeof y=="string"?f.getColor(y).clone():new qe().setRGB(y.r,y.g,y.b):b.clone(),S=typeof x=="string"?f.getColor(x).clone():new qe().setRGB(x.r,x.g,x.b);if(_.equals(S))return;let A=b.clone();return{update:C=>{var P,T;A.lerpColors(_,S,C),(T=(P=a[r])==null?void 0:P.copy)==null||T.call(P,A)},start:()=>{A.copy(_)},end:()=>{A.copy(S)}}}function pg(r,a,n,o,f){let y=n[r]?n[r]:void 0,x=o[r];if(!x)return;let b=a[r],_=new br(b.r,b.g,b.b,b.a),S=y?typeof y=="string"?f.getColor(y).clone():new br(y.r,y.g,y.b,y.a):_.clone(),A=typeof x=="string"?f.getColor(x).clone():new br(x.r,x.g,x.b,x.a);if(!S.equals(A))return{update:C=>{_.lerpColors(S,A,C);let P=we.lerp(S.a,A.a,C);_.a=P,a[r]={r:_.r,g:_.g,b:_.b,a:_.a}},start:()=>{_.copy(S)},end:()=>{_.copy(A)}}}function Jo(r,a,n,o,f){if(typeof a[r]=="number")return $r(r,a,n??{},o,f);if(Array.isArray(a[r]))return fg(r,a,n??{},o,f)}function EN(r,a,n,o){var b,_,S,A;let f=[],y=r.cameraType==="OrthographicCamera"?(b=a.orthographic)==null?void 0:b.zoom:(_=a.perspective)==null?void 0:_.zoom,x=r.cameraType==="OrthographicCamera"?(S=n.orthographic)==null?void 0:S.zoom:(A=n.perspective)==null?void 0:A.zoom;if(x!==void 0){let C=y??r.zoom,P=x;C!==P&&f.push({update:T=>{r.zoom=we.lerp(C,P,T),r.updateProjectionMatrix()},start:()=>{r.zoom=C,r.updateProjectionMatrix()},end:()=>{r.zoom=P,r.updateProjectionMatrix()}})}if(n.targetOffset!==void 0){let C=$r("targetOffset",r,a,n,o);C&&f.push(C)}return f}function wJ(r,a,n,o){if(n.scaleBaked===void 0)return;let f=(a.scaleBaked??r.data.geometry.scaleBaked).map(b=>typeof b=="string"?Number(o.getVariable(b)??0):b),y=n.scaleBaked.map(b=>typeof b=="string"?Number(o.getVariable(b)??0):b);if(Co.isEqual(f,y))return;let x=[];return x.push({update:b=>{r.updateGeometryInteractions({scaleBaked:[we.lerp(f[0],y[0],b),we.lerp(f[1],y[1],b),we.lerp(f[2],y[2],b)]},o),r.invalidateDownstreamBooleanData(),r.refreshAttachedClonersInteractions()},start:()=>{r.updateGeometryInteractions({scaleBaked:f},o),r.invalidateDownstreamBooleanData(),r.refreshAttachedClonersInteractions()},end:()=>{r.updateGeometryInteractions({scaleBaked:y},o),r.invalidateDownstreamBooleanData(),r.refreshAttachedClonersInteractions()}}),x}function AJ(r,a,n,o){if(!n.extrusion)return;let f=r.extrusion,y=a.extrusion??{},x=n.extrusion,b=[];return $w.forEach(_=>{let S=Jo(_,f,y,x,o);S&&b.push(S)}),b}function TN(r,a,n,o){let f=[];if(!("geometry"in n))return f;let y=r.geometry.userData.parameters,x="geometry"in a?a.geometry:{},b=n.geometry;if(r instanceof Js){let _=wJ(r,x,b,o);_&&f.push(..._)}else{let _={};if(Object.assign(_,In(y,a0),In(x,a0)),a0.forEach(S=>{let A=Jo(S,_,x,b,o);A&&f.push(A)}),r instanceof ic){Object.assign(_,{extrusion:{...y.extrusion}});let S=AJ(_,x,b,o);S&&f.push(...S)}f.length&&f.push({update:S=>{r.updateGeometryInteractions(_,o),r.updateGeometryGroupsIfNeeded(),r.refreshAttachedClonersInteractions()},start:S=>{r.updateGeometryInteractions(_,o),r.updateGeometryGroupsIfNeeded(),r.refreshAttachedClonersInteractions()},end:S=>{r.updateGeometryInteractions(_,o),r.updateGeometryGroupsIfNeeded(),r.refreshAttachedClonersInteractions()}})}return f}function MN(r,a,n,o){let f=[];if(n.intensity!==void 0){let y=$r("intensity",r,a,n,o);y&&f.push(y)}if(n.color!==void 0){let y=AN("color",r,a,n,o);y&&f.push(y)}return f}function PN(r,a,n,o){let f=[];if(Array.isArray(r.material)){if(!("materials"in n&&n.materials))return f;let y="materials"in a&&a.materials?a.materials:[],x=n.materials;r.material.forEach((b,_)=>{if(!x[_])return;let S=y[_]??{},A=x[_];typeof S=="string"||typeof A=="string"||f.push(...CN(b,S,A,o))})}else{if(!("material"in n&&n.material))return f;let y="material"in a&&a.material?a.material:{},x=n.material;if(typeof y=="string"||typeof x=="string")return f;f.push(...CN(r.material,y,x,o))}return f}function CN(r,a,n,o){var x;let f=[],y=tu(n,o)||!!a.layers&&tu(a,o);f.push(OJ(r,y));for(let b of r.layers){let _=(x=a.layers)==null?void 0:x.data(b.uuid),S=n.layers.data(b.uuid);if(!S||b.type!=="light"&&(!(b.visible??!0)||!(S.visible??!0)))continue;let A=b.getNames().filter(C=>!i0.some(P=>C.includes(P)));for(let C of A)try{let P=b.getValue(C),T;if(C==="colors")T=IJ(b,_,S,C);else if(Array.isArray(P))C==="steps"&&(T=_J(b,_,S,C));else if(typeof P=="number")T=EJ(b,_,S,C,o);else{if(typeof P=="boolean")continue;P instanceof V?T=TJ(b,_,S,C):P instanceof E?T=MJ(b,_,S,C,o):P instanceof br?T=PJ(b,_,S,C,o):P instanceof qe?T=CJ(b,_,S,C,o):"isTexture"in P&&(T=DJ(b,_,S,C))}T&&(Array.isArray(T)?f.push(...T):f.push(T))}catch(P){console.error(`lerpMaterial: unexpected material layer for ${C}`,P)}}return f}function EJ(r,a,n,o,f){if(!r.hasValue(o)||!(o in n))return;let y=a?a[o]:r.getValue(o),x=n[o],b=typeof y=="string"?Number(f.getVariable(y)??0):y,_=typeof x=="string"?Number(f.getVariable(x)??0):x;if(b!==_)return{update:S=>{r.setValue(o,we.lerp(b,_,S))},start:()=>{r.setValue(o,b)},end:()=>{r.setValue(o,_)}}}function TJ(r,a,n,o){if(!r.hasValue(o)||!(o in n))return;let f=r.getValue(o),y=a?new V().fromArray(a[o]):f.clone(),x=new V().fromArray(n[o]);if(!y.equals(x))return{update:b=>{f.lerpVectors(y,x,b)},start:()=>{f.copy(y)},end:()=>{f.copy(x)}}}function MJ(r,a,n,o,f){if(!r.hasValue(o)||!(o in n))return;let y=r.getValue(o),x=a?a[o]:void 0,b=n[o],_=x?dg(new E,x,f):y.clone(),S=dg(new E,b,f);if(!_.equals(S))return{update:A=>{y.lerpVectors(_,S,A)},start:()=>{y.copy(_)},end:()=>{y.copy(S)}}}function CJ(r,a,n,o,f){if(!r.hasValue(o)||!(o in n))return;let y=a?a[o]:void 0,x=n[o],b=r.getValue(o),_=y?typeof y=="string"?f.getColor(y).clone():new qe().setRGB(y.r,y.g,y.b):b.clone(),S=typeof x=="string"?f.getColor(x).clone():new qe().setRGB(x.r,x.g,x.b);if(_.equals(S))return;let A=b.clone();return{update:C=>{r.getValue(o)!==A&&r.setValue(o,A),A.lerpColors(_,S,C)},start:()=>{A.copy(_)},end:()=>{A.copy(S)}}}function PJ(r,a,n,o,f){if(!r.hasValue(o)||!(o in n))return;let y=a?a[o]:void 0,x=n[o],b=r.getValue(o),_=y?typeof y=="string"?f.getColor(y).clone():new qe().setRGB(y.r,y.g,y.b):b.clone(),S=typeof x=="string"?f.getColor(x).clone():new br(x.r,x.g,x.b,x.a);if(_.equals(S))return;let A=b.clone();return{update:C=>{r.getValue(o)!==A&&r.setValue(o,A),A.lerpColors(_,S,C)},start:()=>{A.copy(_)},end:()=>{A.copy(S)}}}function _J(r,a,n,o="steps"){if(!r.hasValue(o)||!(o in n))return;let f=[],y=r.getValue(o),x=a?a[o]:y,b=n[o];return Fc(x,b)||f.push({update:_=>{let S=[...y];for(let A=0;A<y.length;++A){let C=x[A],P=b[A];S[A]=we.lerp(C,P,_)}r.setValue(o,S)},start:()=>{r.setValue(o,x)},end:()=>{r.setValue(o,b)}}),f.length?f:void 0}function IJ(r,a,n,o="colors"){if(!r.hasValue(o)||!(o in n))return;let f=[],y=r.getValue(o),x=a?a[o]:y.map(_=>_.toArray()),b=n[o];for(let _=0;_<y.length;++_){let S=[...x[_]],A=[...b[_]];tm.isEqual(S,A)||f.push({update:C=>{y[_].fromArray(tm.lerp(S,A,C))},start:()=>{y[_].fromArray(S)},end:()=>{y[_].fromArray(A)}})}return f.length?f:void 0}function DJ(r,a,n,o="texture"){var I,D;if(!r.hasValue(o)||!(o in n))return;let f=r.getNode("rotation"),y=((I=a==null?void 0:a[o])==null?void 0:I.rotation)??0,x=((D=n[o])==null?void 0:D.rotation)??0;if(f&&y!==x)return{update:z=>{f.value=we.lerp(y,x,z)*we.DEG2RAD},start:()=>{f.value=y*we.DEG2RAD},end:()=>{f.value=x*we.DEG2RAD}};let b=r.getNode("mat");if(!b)return;let _=a?a[o]:b,S=n[o],A=[..._.repeat],C=[..._.offset],P=[...S.repeat],T=[...S.offset],M=_.rotation??0,O=S.rotation??0;if(!zs.isEqual(A,P)||!zs.isEqual(C,T)||M!==O)return{update:z=>{b.repeat=zs.lerp(A,P,z),b.offset=zs.lerp(C,T,z),b.rotation=we.lerp(M,O,z),b.updateMatrix()},start:()=>{b.repeat=[...A],b.offset=[...C],b.rotation=M,b.updateMatrix()},end:()=>{b.repeat=[...P],b.offset=[...T],b.rotation=O,b.updateMatrix()}}}function OJ(r,a){return{update:()=>{r.transparent=a}}}var KT=new E,_N=new or;function IN(r,a,n,o,f){var M,O,I,D,z,k;let y=[],x,b,_,S,A,C,P,T;if(r instanceof nr?(x=Hf("position",r,a,n,f),x&&y.push(x),_=$r("rotation",r,a,n,f),_&&y.push(_),S=Hf("shear",r,a,n,f),S&&y.push(S)):(T={slide:((M=a.pathSnapping)==null?void 0:M.slide)??((O=r.updatedPathSnapping)==null?void 0:O.slide)??((I=r.dataPatched.pathSnapping)==null?void 0:I.slide)??0,offset:((D=a.pathSnapping)==null?void 0:D.offset)??((z=r.updatedPathSnapping)==null?void 0:z.offset)??((k=r.dataPatched.pathSnapping)==null?void 0:k.offset)??0},C=$r("slide",T,a.pathSnapping??r.updatedPathSnapping??r.dataPatched.pathSnapping,n.pathSnapping??r.dataPatched.pathSnapping,f),C&&y.push(C),P=$r("offset",T,a.pathSnapping??r.updatedPathSnapping??r.dataPatched.pathSnapping,n.pathSnapping??r.dataPatched.pathSnapping,f),P&&y.push(P),!C&&!P&&(x=YT("position",r,a,n,f),x&&y.push(x),b=YT("scale",r,a,n,f),b&&y.push(b),_=RJ(r,a,n,o,f),_&&y.push(_),A=wN("hiddenMatrix",r,a,n),A&&y.push(A))),x||b||_||A||C||P){let L=r instanceof nr?()=>{r.updateWorldMatrix(!0,!1,!0),r.resetBBoxNeedsUpdate()}:()=>{var R;r.updateMatrix(),r.hasNonUniformScale&&(r.updateMatrixWorld(),r.updateMatrixWorldSVD()),(R=r.parent)!=null&&R.matrixWorldFusedFalse&&(r.matrixWorld.multiplyMatrices(r.parent.matrixWorldFusedFalse,r.matrix),r.matrixWorldNeedsUpdate=!1),un(r)&&Mn(r.parent)&&r.invalidateDownstreamBooleanData(!0),r.updatePathSnapping(Object.assign({},a.pathSnapping,T))};y.push({update:L,start:L,end:L})}return y}function RJ(r,a,n,o,f){var A;let y=a!=null&&a.rotation?a.rotation.map(C=>(typeof C=="string"?Number(f.getVariable(C)??0):C)*we.DEG2RAD):void 0,x=(A=n.rotation)==null?void 0:A.map(C=>(typeof C=="string"?Number(f.getVariable(C)??0):C)*we.DEG2RAD);if(!x)return;let b=y?new E().fromArray(y):new E().setFromEuler(r.rotation),_=new E().fromArray(x);if(b.equals(_))return;let S=KT.subVectors(_,b);if(o&&S.toArray().every(C=>Math.abs(C)<2*Math.PI)){let C=new Ke().setFromEuler(_N.setFromVector3(b)),P=new Ke().setFromEuler(_N.setFromVector3(_));return{update:T=>{SN(C,P,r.quaternion,T)},start:()=>{r.rotation.setFromVector3(b)},end:()=>{r.rotation.setFromVector3(_)}}}else return{update:C=>{KT.lerpVectors(b,_,C),r.rotation.setFromVector3(KT)},start:()=>{r.rotation.setFromVector3(b)},end:()=>{r.rotation.setFromVector3(_)}}}function DN(r,a,n,o){let f=[];if(!("cloner"in n)||!r.cloner)return f;let y=r.cloner,x="cloner"in a?a.cloner:{},b=n.cloner;Hw.forEach(T=>{let M;T==="count"?M=$r("count",y.parameters,x,b,o,!0):M=Jo(T,y.parameters,x??{},b,o),M&&f.push(M)});let _=LJ(y,x,b,o);_!=null&&_.length&&f.push(..._);let S=BJ(y,x,b,o);S!=null&&S.length&&f.push(...S);let A=NJ(y,x,b,o);A!=null&&A.length&&f.push(...A);let C=FJ(y,x,b,o);C!=null&&C.length&&f.push(...C);let P=VJ(y,x,b,o);return P!=null&&P.length&&f.push(...P),f.length&&f.push({update:()=>{y.update()}}),f}function LJ(r,a,n,o){if(r.parameters.type!=="radial")return;let f=a.radial,y=n.radial;if(!y)return;let x=r.parameters.radial,b=[];return Ww.forEach(_=>{let S=Jo(_,x,f??{},y,o);S&&b.push(S)}),b}function BJ(r,a,n,o){if(r.parameters.type!=="linear")return;let f=a.linear,y=n.linear;if(!y)return;let x=[],b=r.parameters.linear;return qw.forEach(_=>{let S=Jo(_,b,f??{},y,o);S&&x.push(S)}),x}function NJ(r,a,n,o){if(r.parameters.type!=="grid")return;let f=a.grid,y=n.grid;if(!y)return;let x=[],b=r.parameters.grid;return Xw.forEach(_=>{let S;_==="count"?S=fg(_,b,f??{},y,o,!0):S=Jo(_,b,f??{},y,o),S&&x.push(S)}),x}function FJ(r,a,n,o){if(r.parameters.type!=="toObject")return;let f=a.toObject,y=n.toObject;if(!y)return;let x=[],b=r.parameters.toObject;return Yw.forEach(_=>{let S;_==="count"?S=$r(_,b,f??{},y,o,!0):S=Jo(_,b,f??{},y,o),S&&x.push(S)}),x}function VJ(r,a,n,o){if(!r.parameters.randomness)return;let f=a.randomnessObject,y=n.randomnessObject;if(!y)return;let x=[],b=r.parameters.randomnessObject;return Kw.forEach(_=>{let S=Jo(_,b,f??{},y,o);S&&x.push(S)}),x}function UJ(r,a){return{update:()=>{r instanceof Tr&&(r.fill.enabled=a)}}}function zJ(r,a){return{update:()=>{r instanceof Tr&&(r.stroke.enabled=a)}}}function kJ(r,a){return{update:()=>{r instanceof Tr&&(r.dropShadow.enabled=a)}}}function GJ(r,a){return{update:()=>{r instanceof Tr&&(r.innerShadow.enabled=a)}}}function jJ(r,a){return{update:()=>{r instanceof Tr&&(r.backgroundBlur.enabled=a)}}}function HJ(r,a){return{update:()=>{r instanceof Tr&&(r.layerBlur.enabled=a)}}}function ON(r,a,n,o,f){let y=[],x,b,_,S,A,C,P,T,M,O,I,D,z,k,L;if("width"in r&&(x=$r("width",r,a,n,f),x&&y.push(x)),"height"in r&&(b=$r("height",r,a,n,f),b&&y.push(b)),r instanceof Tr||r instanceof $i){let R={...a.fill},F={...n.fill};R.enabled!==void 0&&R.enabled!==F.enabled&&(y.push(UJ(r,!0)),R.enabled||Object.assign(R,{enabled:!0,color:{...R.color,a:0}}),F.enabled||Object.assign(F,{enabled:!0,color:{...F.color,a:0}})),_=pg("color",r.fill,R,F,f),_&&y.push(_)}if(r instanceof Tr){let R={...a.stroke},F={...n.stroke};(R.enabled||F.enabled)&&(y.push(zJ(r,!0)),R.enabled||Object.assign(R,{enabled:!0,color:{...R.color,a:0}}),F.enabled||Object.assign(F,{enabled:!0,color:{...F.color,a:0}})),S=pg("color",r.stroke,R,F,f),S&&y.push(S),A=$r("thickness",r.stroke,R,F,f),A&&y.push(A)}if(r instanceof Tr){let R={...a.dropShadow},F={...n.dropShadow};(R.enabled||F.enabled)&&(y.push(kJ(r,!0)),R.enabled||Object.assign(R,{enabled:!0,color:{...R.color,a:0}}),F.enabled||Object.assign(F,{enabled:!0,color:{...F.color,a:0}})),C=pg("color",r.dropShadow,R,F,f),C&&y.push(C),P=$r("blurRadius",r.dropShadow,R,F,f),P&&y.push(P),M=$r("spread",r.dropShadow,R,F,f),M&&y.push(M),T=Hf("offset",r.dropShadow,R,F,f),T&&y.push(T)}if(r instanceof Tr){let R={...a.innerShadow},F={...n.innerShadow};(R.enabled||F.enabled)&&(y.push(GJ(r,!0)),R.enabled||Object.assign(R,{enabled:!0,color:{...R.color,a:0}}),F.enabled||Object.assign(F,{enabled:!0,color:{...F.color,a:0}})),O=pg("color",r.innerShadow,R,F,f),O&&y.push(O),I=$r("blurRadius",r.innerShadow,R,F,f),I&&y.push(I),z=$r("spread",r.innerShadow,R,F,f),z&&y.push(z),D=Hf("offset",r.innerShadow,R,F,f),D&&y.push(D)}if(r instanceof Tr||r instanceof $i){let R={...a.backgroundBlur},F={...n.backgroundBlur};(R.enabled||F.enabled)&&(y.push(jJ(r,!0)),R.enabled||Object.assign(R,{enabled:!0,radius:0}),F.enabled||Object.assign(F,{enabled:!0,radius:0})),k=$r("radius",r.backgroundBlur,R,F,f),k&&y.push(k)}if(r instanceof Tr){let R={...a.layerBlur},F={...n.layerBlur};(R.enabled||F.enabled)&&(y.push(HJ(r,!0)),R.enabled||Object.assign(R,{enabled:!0,radius:0}),F.enabled||Object.assign(F,{enabled:!0,radius:0})),L=$r("radius",r.layerBlur,R,F,f),L&&y.push(L)}if(r instanceof $i||r instanceof Ms){let R=fg("cornerRadius",r,a,n,f);R&&y.push(R)}return y}function QT(r,a,n,o,f){let y=[];return r.data.visible&&y.push(...IN(r,a,n,f,o)),r instanceof nr?y.push(...ON(r,a,n,f,o)):(r.data.visible&&y.push(...DN(r,a,n,o)),un(r)?(r instanceof jt&&r.data.visible&&y.push(...TN(r,a,n,o)),r.data.visible&&y.push(...PN(r,a,n,o))):V3(r)?r.data.visible&&y.push(...MN(r,a,n,o)):F3(r)&&y.push(...EN(r,a,n,o))),y.length?{update:x=>{y.forEach(b=>b.update(x))},start:x=>{y.forEach(b=>{var _;return(_=b.start)==null?void 0:_.call(b,x)})},end:x=>{y.forEach(b=>{var _;return(_=b.end)==null?void 0:_.call(b,x)})}}:void 0}var RN=new E;function kf(r,a,n=!1){var y;let o=[],f=x=>{let b=x.data;delete x.states,x.currentState=null,x.reversibleToState=null,x.currentTransitionEvent=null;for(let _ of b.states){let S={..._.data};x.states||(x.states={}),x.states[_.id]=_a.patch(b,S)}BN(r.scene,x,null,a,b.events.find(_=>_.data.type==="Follow"||_.data.type==="LookAt")!==void 0),LN(r)};r.scene.traverse2D(f),r.traverseChildren(x=>{var A,C,P,T,M,O;if(n&&((A=x.rigidBody)==null||A.setTranslation(x.position0,!0),(C=x.rigidBody)==null||C.setRotation(x.rotation0,!0),(P=x.rigidBody)==null||P.setLinvel(RN,!0),(T=x.rigidBody)==null||T.setAngvel(RN,!0)),!mt.is(x))return;let b=x.uuid,_=x.data;if(delete x.states,x.uuid===fs)return;let S=!1;o.some(I=>{var D;return(D=r.scene.find(b))==null?void 0:D.isDescendantOf(I)})?S=!0:((M=_.physics)==null?void 0:M.fusedBody)===!0&&_.physics.rigidBody==="dynamic"&&o.push(b),x.data=_,x.currentState=null,x.reversibleToState=null,x.currentTransitionEvent=null;for(let I of _.states){let D={...I.data};r.data.globalPhysics.usePhysics===!0&&_.physics&&(_.physics.rigidBody==="dynamic"||S)&&(I.data.position!==void 0&&delete D.position,I.data.rotation!==void 0&&delete D.rotation,I.data.hiddenMatrix!==void 0&&delete D.hiddenMatrix),x.states||(x.states={}),x.states[I.id]=Ea.patch(_,D)}BN(r.scene,x,null,a,_.events.find(I=>I.data.type==="Follow"||I.data.type==="LookAt")!==void 0),x instanceof Mr&&x.frame&&(x.frame.traverse(I=>f(I)),(O=x.uiCanvas)==null||O.applySize())}),LN(r),r.frame&&(r.frame.traverse(x=>f(x)),(y=r.uiCanvas)==null||y.applySize())}function LN(r){r.traverseEntity(a=>{for(let n of a.data.events){let o=[];switch(n.data.type){case"Follow":case"MouseHover":case"Scroll":case"MouseDown":case"MouseUp":case"MousePress":case"KeyUp":case"KeyDown":case"KeyPress":case"Collision":o.push(...n.data.actions);break;case"GameControl":for(let f of Object.values(n.data.gameActions))o.push(...f);break;case"DragDrop":o.push(...n.data.dragDropActions.drag,...n.data.dragDropActions.drop);break;case"Conditional":o.push(...n.data.inActions,...n.data.outActions);break}for(let f of o)if(f.data.type==="Create"&&f.data.hideBase==="Yes"){let y=r.scene.find(f.data.object);y&&(y.visible=!1)}}})}function BN(r,a,n,o,f=!1){if(a instanceof jt&&!(a instanceof ts)&&a.removeInteractionGeometry(o),a instanceof nr?a.changeSelectedState(n,{shared:o},f):a.changeSelectedState(n,{scene:r,shared:o},f),a instanceof jt&&a.updateGeometryGroupsIfNeeded(),a instanceof Er&&a.updateCameraState(a.dataPatched,{scene:r,shared:o}),!(a instanceof nr)){if(a.cloner)for(let y of a.cloner.children)y.playModeVisible=void 0;a.updateVisible()}}function JT(r){let a;if(r.easing===5){let{control1:n,control2:o}=r;a=`cubicBezier(
			${n[0]}, ${n[1]}, ${o[0]}, ${o[1]}
		)`}else if(r.easing===6){let{mass:n,stiffness:o,damping:f,velocity:y}=r;a=`spring( ${n}, ${o}, ${f}, ${y} )`}else{let n;switch(r.easing){case 0:n=Sa.linear;break;case 1:n=Sa.ease;break;case 2:n=Sa.easeIn;break;case 3:n=Sa.easeOut;break;case 4:n=Sa.easeInOut;break;default:n=Sa.linear}let[o,f,y,x]=n;a=`cubicBezier( ${o}, ${f}, ${y}, ${x} )`}return{duration:Math.max(r.duration,1e-4),easing:a}}function ZT(r){let a={delay:0,loop:r.repeat===-1?!0:r.repeat+1};if(r.repeat===0)a.direction="normal",a.rewind=!1;else switch(r.direction){case"pingpong":a.direction="alternate",a.rewind=!1;break;case"pingpong-rewind":a.direction="alternate",a.rewind=!0;break;default:a.direction="normal",a.rewind=!1;break}switch(a.delay=0,a.endDelay=0,a.startOnceDelay=0,a.pingPongDelayCorrection=0,a.pingPongEndDelayCorrection=0,r.delayDirection){case"start-once":a.startOnceDelay=r.delay;break;case"start":a.delay=r.delay;break;case"end":a.endDelay=r.delay;break;case"start-end":case void 0:a.delay=r.delay,a.endDelay=r.delay;break}return a.direction==="alternate"&&(a.delay/=2,a.endDelay/=2,r.delayDirection==="start"?(a.pingPongDelayCorrection=a.delay,typeof a.loop=="number"&&a.loop%2===0&&(a.pingPongEndDelayCorrection=a.delay)):r.delayDirection==="end"?typeof a.loop=="number"&&a.loop%2!==0&&(a.pingPongEndDelayCorrection=a.endDelay):r.delayDirection==="start-end"&&(a.pingPongDelayCorrection=a.delay,a.pingPongEndDelayCorrection=a.endDelay)),a}var WJ={type:"beginState"},qJ={type:"completeState",isfromEntity:!1},Wf=class{constructor(r,a,n,o,f,y){if(this.object=r,this.data=o,this.sharedAssets=f,this.allowSlerp=y,this.targets={t:0},this.firstLoop=!0,this._changeBegan=!1,this._changeCompleted=!0,this.onChange=()=>{this.callback&&(this.callback.update(this.targets.t),this.object.requestRender()),this.targets.t===0||this.targets.t===1?this._changeCompleted||(this._changeCompleted=!0,this._changeBegan=!1,this.onChangeComplete()):(this._changeCompleted&&(this._changeCompleted=!1),this._changeBegan||(this._changeBegan=!0,this.onChangeBegin()))},this.onChangeBegin=()=>{this.object.reversibleToState=this.to.id;let x=this.targets.t>.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=x,this.object.dispatchEvent({type:"beginState",state:x}),this.object instanceof nr||this.object.traverseEntity(b=>{b!==this.object&&b instanceof Er&&b.dispatchEvent(WJ)})},this.onChangeComplete=()=>{this.firstLoop&&(this.onFirstLoop(),this.firstLoop=!1),this.object.reversibleToState=this.to.id;let x=this.targets.t<.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=x,this.object.dispatchEvent({type:"completeState",state:x}),this.object instanceof nr||this.object.traverseEntity(b=>{b!==this.object&&b instanceof Er&&b.dispatchEvent(qJ)})},this.onFirstLoop=()=>{this.useCurrentState&&(this.callback=QT(this.object,this.from.data,this.to.data,this.sharedAssets,this.allowSlerp))},a===void 0){let x=Nb(this.object,this.object.currentState===n?this.object.prevState:this.object.currentState);if(!x)throw new Error("Missing property");this.from=x}else{let x=Nb(this.object,a);if(!x)throw new Error("Missing property");this.from=x}if(n===void 0)throw new Error("Missing property");{let x=Nb(this.object,n);if(!x)throw new Error("Missing property");this.to=x}this.useCurrentState=a===void 0||n===void 0,this.params={targets:this.targets,t:1,autoplay:!1,...ZT(o),...JT(o),change:this.onChange},this.callback=QT(this.object,a===void 0?{}:this.from.data,n===void 0?{}:this.to.data,this.sharedAssets,this.allowSlerp)}get changeBegan(){return this._changeBegan}get changeCompleted(){return this._changeCompleted}},mg=class extends gr{constructor(r,a,n,o,f){var x;if(super(),this.eventType=r,this.data=a,this.page=n,this.shared=o,this.condition=f,this.toggleIsForward=!1,this.timelineNeedsRebuild=!1,this.hasPlayedOnce=!1,this.onTimelineChangeComplete=()=>{var b;this.data.tweens[0].data.direction!=="normal"&&(this.toggleIsForward=!this.toggleIsForward),this.timelineNeedsRebuild!==!1&&((b=this.timeline)==null||b.pause(),this.buildTimeline({isForward:this.toggleIsForward,needsRebuild:!1,isRebuild:!0}),this.timeline.play())},!a.object)throw new Error("Missing property");let y=this.page.scene.find(a.object)??((x=this.page.uiCanvas)==null?void 0:x.find(a.object))??this.page.scene.find2DInUIObjects(a.object);if(!y)throw new Error("Missing property");if(!y.states)throw new Error("Missing property");if(this.object=y,a.tweens.length<2)throw new Error("Missing property");this.tweens=Array(this.data.tweens.length-1),this.startOnceDelay=a.tweens[0].data.delayDirection==="start-once"?a.tweens[0].data.delay:0,this.init()}get playing(){var r;return((r=this.timeline)==null?void 0:r.paused)===!1}get changeBegan(){return this.tweens.some(r=>r.changeBegan)??!1}init(){this.initialCurrentState=Nb(this.object,this.object.currentState).id,this.toggleIsForward=!1}get currentState(){return this.data.runMode==="Toggle"&&Gw(this.eventType)?this.initialCurrentState:this.object.currentState}buildTimeline({isForward:r=!0,needsRebuild:a=!1,isRebuild:n=!1}={}){var o,f,y,x;try{let b=ZT(this.data.tweens[0].data);n&&typeof b.loop=="number"&&b.loop--,(o=this.timeline)==null||o.pause(),this.timeline=jf.timeline({autoplay:!1,...b,...b.loop===!0||b.loop>1?{timelineChangeComplete:this.onTimelineChangeComplete}:{}});let _=this.tweens.findIndex(S=>S==null?void 0:S.changeBegan);if(a===!0&&(this.timelineNeedsRebuild=!0),r){let S=_===-1?0:_;for(let A=S;A<this.data.tweens.length-1;A++){let C=this.data.tweens[A],P=this.data.tweens[A+1],T;A===S&&(this.object.wasMovedByUser===!0||((f=this.object.previousAction)==null?void 0:f.changeBegan)===!0)?(T=void 0,this.object instanceof Er&&(this.object.wasMovedByUser=!1)):T=C.data.state===void 0?this.currentState:C.data.state;let M=new Wf(this.object,T,P.data.state===void 0?this.currentState:P.data.state,P.data,this.shared,this.data.allowSlerp??!1);_!==-1&&A===S&&Object.assign(M.params,{startOnceDelay:0}),this.tweens[A]=M,this.timeline.add(M.params,this.timeline.duration+(A===S?b.delay:0))}this.timeline.duration+=b.endDelay}else{let S=_===-1?this.data.tweens.length-1:_+1;for(let A=S;A>0;A--){let C=this.data.tweens[A],P=this.data.tweens[A-1],T;A===S&&(this.object.wasMovedByUser===!0||((y=this.object.previousAction)==null?void 0:y.changeBegan)===!0)?(T=void 0,this.object instanceof Er&&(this.object.wasMovedByUser=!1)):T=C.data.state===void 0?this.currentState:C.data.state;let M=new Wf(this.object,T,P.data.state===void 0?this.currentState:P.data.state,C.data,this.shared,this.data.allowSlerp??!1);_!==-1&&A===S&&Object.assign(M.params,{startOnceDelay:0}),this.tweens[A-1]=M,this.timeline.add(M.params,this.timeline.duration+(A===S?b.endDelay:0))}this.timeline.duration+=b.delay}}catch(b){b instanceof Error&&console.error(b.message)}((x=this.object.previousAction)==null?void 0:x.playing)===!0&&this.object.previousAction.pause(),this.object.previousAction=this}play(){if(Ct(this.shared,this.condition)===!1||Gw(this.eventType)&&this.data.runMode==="Once"&&this.hasPlayedOnce||(this.hasPlayedOnce=!0,this.playing))return!1;clearTimeout(this.timeoutId);let r=ZT(this.data.tweens[0].data).pingPongDelayCorrection;this.timeoutId=window.setTimeout(()=>{try{this.buildTimeline(),this.timeline.play()}catch(a){a instanceof Error&&console.error(a.message)}},this.startOnceDelay+r)}pause(){var r;(r=this.timeline)==null||r.pause(),clearTimeout(this.timeoutId),this.tweens=Array(this.data.tweens.length-1),delete this.timeoutId}stop(){this.pause();let r=this.data.tweens[0].data.state===void 0?this.initialCurrentState:this.data.tweens[0].data.state;this.object instanceof nr?this.object.changeSelectedState(r,{shared:this.shared}):this.object.changeSelectedState(r,{scene:this.page.scene,shared:this.shared}),this.object.currentState=r}seek(r){var a;if(Ct(this.shared,this.condition)===!1)return!1;this.timeline===void 0&&this.buildTimeline(),(a=this.timeline)==null||a.seek(r*this.timeline.duration,!0)}toggle(r){var a;if(Ct(this.shared,this.condition)===!1)return!1;clearTimeout(this.timeoutId),this.toggleIsForward=r??!this.toggleIsForward,this.playing?((a=this.timeline)==null||a.pause(),this.buildTimeline({isForward:this.toggleIsForward,needsRebuild:!0}),this.timeline.play()):this.timeoutId=window.setTimeout(()=>{var n;(n=this.timeline)==null||n.pause(),this.buildTimeline({isForward:this.toggleIsForward}),this.timeline.play()},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause()}};function Nb(r,a){var f;let n,o;if(typeof a=="string"?(n=a,o=(f=r.states)==null?void 0:f[n]):a===null&&(n=null,o=r.data),!(n===void 0||o===void 0))return{id:n,data:o}}var XJ={type:"beginState"},NN={type:"completeState",isfromEntity:!1},FN={type:"requestRender"},gg=class extends gr{constructor(r,a,n,o){super(),this.data=r,this.page=a,this.shared=n,this.condition=o,this.toggleIsForward=!1,this.posStart=new E,this.posEnd=new E,this.qStart=new Ke,this.qEnd=new Ke,this.zoomStart=1,this.zoomEnd=1}init(){}get playing(){return this.animation&&this.animation.began&&!this.animation.completed}buildAnimation(r=!1){if(!this.data.animate)return;let a=this.page.scene.find(this.data.targetCamera);if(!a||!a.visible)throw new ReferenceError("Target camera not founded or not visible");let n={t:0};this.posStart.copy(this.page.activeCamera.position),this.qStart.copy(this.page.activeCamera.quaternion),this.zoomStart=this.page.activeCamera.zoom,this.animation=jf({targets:n,t:1,...JT(this.data),update:()=>{n.t===0&&(this.data.runMode==="Toggle"&&!this.toggleIsForward?this.fromCamera&&(this.posEnd.copy(this.fromCamera.position),this.qEnd.copy(this.fromCamera.quaternion),this.zoomEnd=this.fromCamera.zoom,this.switchCamera(this.fromCamera.uuid)):(this.posEnd.copy(a.position),this.qEnd.copy(a.quaternion),this.zoomEnd=a.zoom,this.fromCamera=this.page.activeCamera,this.switchCamera(a.uuid)),this.page.activeCamera.dispatchEvent(XJ));let o=this.page.activeCamera;o.position.lerpVectors(this.posStart,this.posEnd,n.t),o.quaternion.slerpQuaternions(this.qStart,this.qEnd,n.t),o.zoom=this.zoomStart+(this.zoomEnd-this.zoomStart)*n.t,o.wasMovedBySwitchCameraAction=!0,o.updateMatrix(),o.updateMatrixWorld(),o.updateProjectionMatrix(),o.dispatchEvent(FN),n.t===1&&o.dispatchEvent(NN)}})}switchCamera(r){let a=this.page.activeCamera,n=this.page.scene.find(r);if(!n||!n.visible)throw new ReferenceError("Target camera not founded or not visible");this.page.switchActiveCamera(n),a.dispatchEvent({type:"cameraChange",camera:n})}play(){if(Ct(this.shared,this.condition)===!1)return!1;if(!this.playing&&this.page.activeCamera.uuid!==this.data.targetCamera)try{clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var r;delete this.timeoutId,this.data.animate?(this.buildAnimation(),(r=this.animation)==null||r.play()):this.switchCamera(this.data.targetCamera)},this.data.delay*1e3)}catch{}}pause(){var r;(r=this.animation)==null||r.pause(),clearTimeout(this.timeoutId),delete this.timeoutId}toggle(r){var a,n;if(Ct(this.shared,this.condition)===!1)return!1;if(window.clearTimeout(this.timeoutId),delete this.timeoutId,r!==this.toggleIsForward)try{this.playing?((a=this.animation)==null||a.pause(),this.toggleIsForward=r??!this.toggleIsForward,this.buildAnimation(!0),(n=this.animation)==null||n.play()):this.timeoutId=window.setTimeout(()=>{var o,f;this.toggleIsForward=r??!this.toggleIsForward,this.data.animate?((o=this.animation)==null||o.pause(),this.buildAnimation(),(f=this.animation)==null||f.play()):(this.toggleIsForward?(this.fromCamera=this.page.activeCamera,this.switchCamera(this.data.targetCamera)):this.fromCamera&&this.switchCamera(this.fromCamera.uuid),this.page.activeCamera.dispatchEvent(NN),this.page.activeCamera.dispatchEvent(FN))},this.data.delay*1e3)}catch{}}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause(),this.toggleIsForward=!1}};function $T(r){let a=r==null?void 0:r.tracks.filter(n=>n.ValueTypeName==="vector"||n.ValueTypeName==="quaternion").map(n=>n.times.length);if(a!=null&&a.length){let n=xw(a);return n&&n>2?n:2}return 2}var yg=class extends gr{constructor(r,a,n,o,f){var _,S,A;super(),this.data=r,this.page=a,this.animationControls=n,this.shared=o,this.condition=f,this.startOnceDelay=0,this.toggleIsForward=!1;let y=r.object,x=a.scene.find(r.object);x&&Array.isArray(x.identity)&&(y=x.identity[0]),this.data={...r,object:y};let b=this.animationControls.clipIdToAction[r.clipId+"/"+y];if(this.duration=((_=b==null?void 0:b.getClip())==null?void 0:_.duration)??1,this.data.crop2){let C=$T(b==null?void 0:b.getClip());this.leftFrameTime=this.data.crop2[0]/(C-1)*this.duration,this.rightFrameTime=this.data.crop2[1]/(C-1)*this.duration}else{let C=(A=(S=b==null?void 0:b.getClip())==null?void 0:S.tracks[0])==null?void 0:A.times.length;C&&C>1?(this.leftFrameTime=this.data.crop[0]/C*this.duration,this.rightFrameTime=this.data.crop[1]/C*this.duration):(this.leftFrameTime=0,this.rightFrameTime=this.duration)}this.startOnceDelay=r.delay}get playing(){var r;return((r=this.threeAnimAction)==null?void 0:r.isRunning())??!1}play(r=!1){if(Ct(this.shared,this.condition)===!1)return!1;window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var n;if(this.threeAnimAction=this.animationControls.play(this.data),!this.threeAnimAction)return;this.threeAnimAction.reset(),this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime;let a=this.data.object;Object.entries(this.animationControls.clipIdToAction).forEach(([o,f])=>{let y=o.split("/")[1];this.threeAnimAction!==f&&y===a&&f.isRunning()&&(r?f.fadeOut(.2):f.stop())}),r&&((n=this.threeAnimAction)==null||n.fadeIn(.2))},this.startOnceDelay)}pause(){this.threeAnimAction&&(this.threeAnimAction.paused=!0),window.clearTimeout(this.timeoutId),delete this.timeoutId}stop(){var r;(r=this.threeAnimAction)==null||r.fadeOut(.2)}seek(r){this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction&&(this.threeAnimAction.paused=!0,this.threeAnimAction.time=we.clamp(this.threeAnimAction.time+1/60*r,this.leftFrameTime,this.rightFrameTime-16e-5),this.animationControls.needsUpdate=!0,this.animationControls.requestRender())}toggle(r,a=!1){if(Ct(this.shared,this.condition)===!1)return!1;this.toggleIsForward=r??!this.toggleIsForward,this.threeAnimAction&&(this.threeAnimAction._loopCount=0),this.playing?this.threeAnimAction&&(this.threeAnimAction.timeScale=this.toggleIsForward?1:-1,this.toggleIsForward?(this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime)):this.timeoutId=window.setTimeout(()=>{var n;if(this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction){this.toggleIsForward?(this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction.time=this.rightFrameTime,this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime),this.threeAnimAction.paused=!1,this.threeAnimAction.timeScale=this.toggleIsForward?1:-1;let o=this.data.clipId.split("/")[1];Object.entries(this.animationControls.clipIdToAction).forEach(([f,y])=>{let x=f.split("/")[1];this.threeAnimAction!==y&&x===o&&y.isRunning()&&(a?y.fadeOut(.2):y.stop())}),a&&((n=this.threeAnimAction)==null||n.fadeIn(.2))}},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){var a;let r=(a=this.animationControls.clipIdToAction[this.data.clipId+"/"+this.data.object])==null?void 0:a.getClip();r&&(r.duration=this.duration),this.pause()}},vg=class{constructor(r,a,n,o,f){this.data=r,this.page=a,this.eventManager=n,this.shared=o,this.condition=f,this.timeOutId=-1,this.scene=a.scene}dispatch(){if(Ct(this.shared,this.condition)===!1)return!1;this.data.target!==this.page.uuid&&(window.clearTimeout(this.timeOutId),this.timeOutId=window.setTimeout(()=>{this.play()},this.data.delay*1e3))}dispose(){window.clearTimeout(this.timeOutId)}play(){if(this.scene.children.every(a=>a.uuid!==this.data.target||a.data.uiScene))return;this.data.transition==="fade"&&this.data.duration>0&&this.eventManager.eventContext.renderer.renderFromSceneForSceneTransitionPass(this.scene,this.scene.activeCamera,this.data.duration*1e3),this.eventManager.deactivate(),this.eventManager.controlsManager.deactivate();let r=this.scene.activeCamera;this.scene.updatePage(this.data.target),this.scene.traverseVisibleEntity(a=>{a.type==="ParticleSystem"&&(a.sleep(),a.wakeUp(),a.data.autoPlay?a.start():a.stop())}),this.scene.activePage.switchToPlayCamera(),this.scene.activeCamera.copyViewPlaneSize(r),kf(this.scene.activePage,this.shared),this.eventManager.activate(),this.eventManager.controlsManager.activate(this.eventManager)}},xg=class{constructor(r,a,n,o){this.data=r,this.page=a,this.shared=n,this.condition=o,this.evaluatedCondition=!1}checkConditions(){this.evaluatedCondition=Ct(this.shared,this.condition)}dispatch(){if(this.evaluatedCondition===!1)return!1;let r=this.shared.getVariable(this.data.variableId),a=K0(this.data.expression,this.shared,Ur.typeOfVariable(r));a!==void 0&&this.shared.updateVariable(this.data.variableId,typeof a=="string"?{textValue:a}:a)}dispose(){}},bg=class{constructor(r,a,n,o){this.data=r,this.page=a,this.shared=n,this.condition=o,this.timeoutId=null}dispatchInner(){if(Ct(this.shared,this.condition)===!1)return!1;let r=this.shared.getDynamicVariablePlayState(this.data.variableId);if(this.data.mode==="PlayPause")this.shared.getDynamicVariableToggleIsForward(this.data.variableId)===void 0&&this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!0),this.shared.setDynamicVariablePlayState(this.data.variableId,r==="Playing"?"Paused":"Playing");else if(this.data.mode==="Play"&&r!=="Playing")this.shared.getDynamicVariableToggleIsForward(this.data.variableId)===void 0&&this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!0),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing");else if(this.data.mode==="Stop"&&r!=="Stopped")this.shared.setDynamicVariablePlayState(this.data.variableId,"Stopped");else if(this.data.mode==="Pause"&&r!=="Paused")this.shared.setDynamicVariablePlayState(this.data.variableId,"Paused");else if(this.data.mode==="Restart")this.shared.setDynamicVariablePlayState(this.data.variableId,"Restarted");else if(this.data.mode==="Toggle"){let a=this.shared.getDynamicVariableToggleIsForward(this.data.variableId);r==="Playing"?this.shared.setDynamicVariableToggleIsForward(this.data.variableId,a===void 0?!1:!a):(this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!a),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing"))}}dispatch(){let r=this.data.delay,a=this.shared.getDynamicVariablePlayState(this.data.variableId);this.data.mode==="PlayPause"&&a==="Playing"&&(r=this.data.pauseDelay),r!==0?(this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.timeoutId=null,this.dispatchInner()},r)):this.dispatchInner()}dispose(){this.timeoutId&&window.clearTimeout(this.timeoutId)}},Fb=class{constructor(r,a,n,o){this.data=r,this.page=a,this.shared=n,this.condition=o}dispatch(){if(Ct(this.shared,this.condition)===!1)return!1;(this.data.target==="single"?this.data.variableId?[this.data.variableId]:[]:Object.keys(this.shared.getVariables())).forEach(r=>{var n;this.shared.getVariable(r);let a=(n=this.shared.data.variables.data(r))==null?void 0:n.value;a!==void 0&&this.shared.updateVariable(r,a),this.shared.enableLocalStorageForPersistentVariables&&localStorage.removeItem(Ex(r))})}dispose(){}},Vb=class{constructor(r,a,n,o){this.data=r,this.page=a,this.shared=n,this.condition=o}dispatch(){var r;if(Ct(this.shared,this.condition)===!1)return!1;this.data.userAPIId&&((r=this.shared.getUserAPI(this.data.userAPIId))==null||r.callUserAPI(this.shared))}dispose(){}};function Ct(r,a){if(a===void 0)return!0;if(a.expression.length===0)return!1;let n=K0(a.expression,r,"boolean");return a.negate?!n:!!n}function Ht(r,a,n,o,f,y){let x={Audio:[],Video:[],Particles:[],Link:[],Destroy:[],Create:[],Reset:[],Transition:[],SwitchCamera:[],Animation:[],SceneTransition:[],SetVariable:[],DynamicVariablePlay:[],ClearLocalStorage:[],UserAPI:[]},b=_=>({id:S,data:A})=>{try{A.type==="Audio"?Yi[r.type].includes("Audio")&&x.Audio.push(new ag(S,A,y,o,_)):A.type==="Video"&&!(y instanceof nr)?Yi[r.type].includes("Video")&&x.Video.push(new Sg(S,A,y,o,_)):A.type==="Particles"?Yi[r.type].includes("Particles")&&x.Particles.push(new lg(A,n,o,_)):A.type==="Link"?Yi[r.type].includes("Link")&&x.Link.push(new Db(A,f.controlsManager,o,_)):A.type==="Create"?Yi[r.type].includes("Create")&&x.Create.push(new wg(A,n,f.controlsManager,o,_)):A.type==="Destroy"?Yi[r.type].includes("Destroy")&&x.Destroy.push(new cg(A,n,f.controlsManager,o,_)):A.type==="Reset"?Yi[r.type].includes("Reset")&&x.Reset.push(new ug(A,n,o,f,_)):A.type==="Transition"?Yi[r.type].includes("Transition")&&x.Transition.push(new mg(r.type,A,n,o,_)):A.type==="SwitchCamera"?Yi[r.type].includes("SwitchCamera")&&x.SwitchCamera.push(new gg(A,n,o,_)):A.type==="SceneTransition"?Yi[r.type].includes("SceneTransition")&&x.SceneTransition.push(new vg(A,n,f,o,_)):A.type==="Animation"?Yi[r.type].includes("Animation")&&x.Animation.push(new yg(A,n,f.animationControls,o,_)):A.type==="SetVariable"?Yi[r.type].includes("SetVariable")&&x.SetVariable.push(new xg(A,n,o,_)):A.type==="DynamicVariablePlay"?Yi[r.type].includes("DynamicVariablePlay")&&x.DynamicVariablePlay.push(new bg(A,n,o,_)):A.type==="Conditional"?Yi[r.type].includes("Conditional")&&(A.ifActions.forEach(b({expression:A.condition,negate:!1})),A.elseActions.forEach(b({expression:A.condition,negate:!0}))):A.type==="ClearLocalStorage"?Yi[r.type].includes("ClearLocalStorage")&&x.ClearLocalStorage.push(new Fb(A,n,o,_)):A.type==="UserAPI"&&Yi[r.type].includes("UserAPI")&&x.UserAPI.push(new Vb(A,n,o,_))}catch{}};return a.forEach(b()),x}function dr(r){Object.values(r).forEach(a=>{a.forEach(n=>{(n instanceof ag||n instanceof Sg||n instanceof lg||n instanceof yg||n instanceof mg||n instanceof wg||n instanceof cg||n instanceof gg||n instanceof vg||n instanceof ug||n instanceof xg||n instanceof bg)&&n.dispose()})})}function VN(r,a){let n;if("material"in r){let o=r.material;Array.isArray(o)?n=r.material[0].layers.find(f=>f.uuid===a):n=r.material.layers.find(f=>f.uuid===a)}if(n)return n.color.texture.image.img instanceof HTMLVideoElement?n.color.texture.image.img:void 0}var UN=new Map,Ag=new Map,qa=class{constructor(r,a,n){this.data=a,this.delay=0,this.status="stopped";let{layerId:o,loop:f,volume:y,delay:x}=a;if(this.object=n,o===void 0)throw new Error("Missing property");let b=VN(n,o);b&&(this.videoElement=b,this.videoElement.loop=f===1/0,bo&&(this.videoElement.autoplay=!0),y!==void 0&&(this.videoElement.volume=y)),x!==void 0&&(this.delay=x),Ag.has(n.uuid)?Ag.get(n.uuid).push(this):Ag.set(n.uuid,[this]),UN.set(r,this),this.pause()}mute(){!this.videoElement||(this.videoElement.muted=!0)}unMute(){!this.videoElement||(this.videoElement.muted=!1)}play(r){if(!this.videoElement)return;let a=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);r?(this.mute(),this.delay+=150):a?(this.mute(),window.setTimeout(()=>{this.unMute()},100)):this.unMute(),this.delayTimerId=window.setTimeout(()=>{if(!this.videoElement)return;let n=this.videoElement.play();n!==void 0&&n.then(o=>{}).catch(o=>{this.play()}),this.clearDelay()},this.delay),this.status="playing"}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}pause(){!this.videoElement||(this.videoElement.pause(),this.status="paused")}stop(){!this.videoElement||(this.videoElement.pause(),this.videoElement.currentTime=0,this.status="stopped",this.clearDelay())}playByToggle(){this.data.toggle==="stop"?this.status==="playing"?this.stop():(this.stop(),this.play()):this.data.toggle==="pause"?this.status==="playing"?this.pause():this.play():(this.stop(),this.play())}dispose(){!this.videoElement||(this.stop(),this.videoElement.muted=!0)}},qf=class{constructor(r){this.data=r}dispatch(){this.data.playVideo?this.pauseVideo(this.data.playVideo):this.data.object?this.pauseAllVideosFromObject(this.data.object):this.pauseAllVideos()}pauseVideo(r){let a=UN.get(r);!a||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{a[this.data.interaction](),this.disposeDelay()},this.data.delay)):a[this.data.interaction]())}pauseAllVideosFromObject(r){let a=Ag.get(r);!(a!=null&&a.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{a.forEach(n=>n[this.data.interaction]()),this.disposeDelay()},this.data.delay)):a.forEach(n=>n[this.data.interaction]()))}pauseAllVideos(){let r=[...Ag.values()];!r.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{r.forEach(a=>{a.forEach(n=>{n[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):r.forEach(a=>{a.forEach(n=>{n[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},Sg=class{constructor(r,a,n,o,f){if(this.data=a,this.shared=o,this.condition=f,a.interaction==="play")this.interaction=new qa(r,a,n);else if(a.interaction==="pause"||a.interaction==="stop")this.interaction=new qf(a);else throw new Error("Missing property")}dispatchBasic(){if(Ct(this.shared,this.condition)===!1)return!1;this.interaction instanceof qa?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){if(Ct(this.shared,this.condition)===!1)return!1;this.interaction instanceof qa?this.interaction.play():this.interaction.dispatch()}dispose(){this.interaction.dispose()}},zN=(()=>{let r,a,n,o;function f(b){!r&&!kN()&&(a==null?void 0:a.sharedGameControlGlobals.createdObjects.length)>0&&(r=requestAnimationFrame(y)),b&&(a=b,o=b.requestRender)}function y(b){let _=n?b-n:0,S=a.sharedGameControlGlobals.createdObjects,A=a.sharedGameControlGlobals.nCreatedPerAction,C=S.length,P=0;for(;P<C;){let T=S[P];T.userData.createdTime===void 0&&(T.userData.createdTime=b),T.userData.lifetime===void 0&&T.userData.quantity===void 0||T.userData.lifetime&&b-T.userData.createdTime<T.userData.lifetime||T.userData.quantity&&A[T.userData.actionId]<=T.userData.quantity?(T.userData.velocity&&(T.position.addScaledVector(T.userData.velocity,_/1e3),T.updateMatrix(),o()),P++):(A[T.userData.actionId]>T.userData.quantity&&A[T.userData.actionId]--,S.splice(P,1),T.removeFromParent(),a.sharedGameControlGlobals.rapierWorld&&T.rigidBody?(a.sharedGameControlGlobals.colliderToEntity.delete(T.rigidBody.collider(0).handle),a.sharedGameControlGlobals.rapierWorld.removeRigidBody(T.rigidBody)):(T.bvhGeometry=void 0,a.sharedGameControlGlobals.entitiesWithTransformAnim=a.sharedGameControlGlobals.entitiesWithTransformAnim.filter(M=>M.bvhGeometry!==void 0)),C--,o())}r=P>0?requestAnimationFrame(y):void 0,n=P>0?b:void 0}function x(){kN()?r&&(cancelAnimationFrame(r),r=void 0,n=void 0):f()}return typeof document<"u"&&document.addEventListener("visibilitychange",x),f})();function kN(){return!!document&&document.hidden}var GN=new Ke,YJ=new E,KJ=new E,wg=class{constructor(r,a,n,o,f){this.data=r,this.page=a,this.controlsManager=n,this.shared=o,this.condition=f,this.intervalId=null,this.timeoutIdQueue=[],this.uniqueId=we.generateUUID(),this.dispatch=()=>{if(Ct(this.shared,this.condition)===!1)return!1;this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()},this.dispatchFromStart=()=>{if(Ct(this.shared,this.condition)===!1)return!1;this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))},this.dispatchThrottled=bw(this.dispatch,1e3/this.data.creationSpeed),this.dispatchStart=()=>{this.intervalId===null&&(this.intervalId=window.setInterval(this.dispatch,1e3/this.data.creationSpeed))},this.dispatchStop=()=>{this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null)},this.dispatchInner=()=>{this.timeoutIdQueue.shift();let x=new Dr(this.object);if(x.playModeVisible=!0,x.expand(),this.data.coordinateSystem!=="world"){let _=this.data.coordinateSystem,S=this.page.scene.find(_);S&&(S.updateMatrixWorldSVD(),x.hiddenMatrix.copy(S.matrixWorldRigid))}x.scale.copy(this.object.scale),x.position.fromArray(this.data.position),x.rotation.fromArray(this.data.rotation),x.updateMatrix(),this.page.add(x);let b=this.controlsManager.sharedGameControlGlobals;b.createdObjects.push(x),b.nCreatedPerAction[this.uniqueId]===void 0?b.nCreatedPerAction[this.uniqueId]=1:b.nCreatedPerAction[this.uniqueId]++,x.updateWorldMatrix(!0,!0),x.traverseObject(this.traverseObjectCB),zN(),this.controlsManager.requestRender()},this.traverseObjectCB=x=>{var A,C,P,T;x.hasNonUniformScale&&x.updateMatrixWorldSVD();let b;if(this.controlsManager.sharedGameControlGlobals.rapierWorld){if(x instanceof bi)if(x.objectForSample){if(x.objectForSample.dataPatched.physics.fusedBody)return;b=x.object}else return x.object.dataPatched.physics.fusedBody===!0&&x.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(x instanceof Dr)b=x.object;else if(b=x,(A=b.dataPatched.cloner)==null?void 0:A.hideBase)return!0}else{if(x instanceof bi)return;x instanceof Dr?b=x.object:b=x}this.data.destroy==="Time"?x.userData.lifetime=this.data.lifetime*1e3:this.data.destroy==="Quantity"&&(x.userData.quantity=this.data.destroyAfterQuantity,x.userData.actionId=this.uniqueId);let _=new E().fromArray(this.data.velocity),S=b.dataPatched;if(!(S.physics.enabled==="visibility"?!S.visible:!S.physics.enabled)&&(this.controlsManager.sharedGameControlGlobals.rapierWorld?(this.controlsManager.addRigidBody(x,b,{fromCreate:!0,dynamic:this.data.dynamic}),this.data.destroy==="Collision"&&((C=x.rigidBody)==null||C.collider(0).setActiveEvents(1),x.userData.hasCollisionDestroy=!0),x.matrixWorld.decompose(YJ,GN,KJ),_.applyQuaternion(GN),this.data.velocity.some(M=>M!==0)&&this.data.dynamic&&((P=x.rigidBody)==null||P.setLinvel(_.divideScalar(this.controlsManager.pixelsPerMeter),!0))):("geometry"in x.object&&this.controlsManager.addBoundsTree(x),this.data.velocity.some(M=>M!==0)&&this.data.dynamic&&(x.userData.velocity=_)),((T=b.dataPatched.physics)==null?void 0:T.fusedBody)===!0))return!0};let y=this.page.scene.find(this.data.object);if(!y)throw new Error("Missing Property");if(this.object=y,this.data.coordinateSystem!=="world"&&!this.page.scene.find(this.data.coordinateSystem))throw new Error("Missing Property");zN(n)}dispose(){this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null),this.timeoutIdQueue.forEach(r=>window.clearTimeout(r)),this.dispatchThrottled.cancel(),this.page.remove(...this.controlsManager.sharedGameControlGlobals.createdObjects),this.controlsManager.sharedGameControlGlobals.createdObjects=[]}},iM=200,eM=.02,tM=.3,QJ=65;new E;var jN=new E,HN=new E,ZJ=new E,Cn=new E,Gn=new E,cc=new E,rM=new ue,WN=new ue,JJ=new ue;new ue;var no=new Ke,Xa=new Ke,$o=new or(0,0,0,"YXZ"),$J=new E(1,0,0),so=new E(0,1,0),e$=new E(0,0,1),qN=new E(1,1,1);new Nr;var t$=1,r$=.025,i$=16e-6,XN=12,n$=20,Wi=new Pi,Ps=new Xt,s$={type:"requestRender"},o$={type:"updateMatrix"},YN=Math.PI/6,Ub=class extends gr{constructor(r,a,n,o,f,y,x,b,_){var M;super(),this.object=r,this.domElement=a,this.data=n,this.gloabalPhysics=o,this.controlsManager=f,this.cameraFollow=y,this.camera=x,this.page=b,this.sharedAssets=_,this.enableDamping=!0,this.hiddenMatrix0=new ue,this.target0=new E,this.zoom0=1,this.rotForce=1,this.moveForce=1,this.pixelsPerMeter=iM,this.euler0=new or(0,0,0,"YXZ"),this.position0Cam=new E,this.quat0Cam=new Ke,this.scale0Cam=new E,this.hiddenMatrix0Cam=new ue,this.threshEndTranslate=.01,this.threshEndRotate=1e-8,this.threshEndRotVel=.005,this.collider={type:"capsule",radius:40,segment:new Pi(new E(0,-40,0),new E(0,40,0)),matrix:new ue,position:new E,rotation:new Ke},this.euler=new or(0,0,0,"YXZ"),this.eulerDelta=new E,this.lastPosition=new E,this.lastCameraQuaternion=new Ke,this.lastCameraPosition=new E,this.PI_2=Math.PI/2,this.prevMouse=new V,this.velocityTarget=new E,this.velocity=new E,this.directionXZ=new E,this.rotVelocityStick=new E,this.rotVelocityTarget=new E,this.rotVelocity=new E,this.rotDirection=new E,this.nonColliderRotOffset=new ue,this.nonColliderPosOffset=new ue,this.firstPointerId=-1,this.rot=new E,this.path=[],this.movementState={moveNegZ:0,movePosZ:0,moveNegX:0,movePosX:0,moveNegY:0,movePosY:0,rotPosX:0,rotNegX:0,rotPosY:0,rotNegY:0,jump:0,run:0},this.vrEulerYOffset=0,this.onObject=!1,this.actionState={},this.keyAssignments=[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","ArrowUp"],["rotPosY","ArrowLeft"],["rotNegX","ArrowDown"],["rotNegY","ArrowRight"],["jump"," "]],this.collisionEnabled=!0,this.offsetMatrix=new ue,this.objectToTarget=new E,this.objectToTarget0=new E,this.objectToCamXZ=new E,this.objectToCamXZ0=new E,this.targetToCamera=new E,this.targetToCamera0=new E,this.cameraPolarAxis0=new E,this.targetPos=new E,this.targetQuat=new Ke,this.lerpFactorPos=new E().setScalar(.3),this.lerpFactorPosStart=.3,this.lerpFactorPosEnd=.3,this.lerpFactorRotStart=.3,this.lerpFactorRotEnd=.3,this.lerpFactorPosCamera=.3,this.lerpFactorRotCamera=.3,this.objXZQuat=new Ke,this.objXZQuatInv=new Ke,this.objXZRotMat=new ue,this.isFirstPerson=!1,this.didHit=!1,this.groundVelocity=new E,this.pushedVelocity=new E,this.groundYRotation=0,this.objectRealQuat=new Ke,this.colliderWorldQuat=new Ke,this.groundNormal=new E,this.groundTilt=new Ke,this.groundTiltInv=new Ke,this.lastHitObj=null,this.isFirstFrame=!0,this.rotationAccumWhenOrientWithCamera=0,this.navMeshPathDest=null,this.position=new E,this.quaternion=new Ke,this.scale=new E,this.initialAction=!0,this.onPointerDown=O=>{var I;!(O.target===this.domElement||O.target instanceof HTMLElement&&O.target.tagName==="SPLINE-VIEWER"&&((I=O.target.shadowRoot)!=null&&I.contains(this.domElement)))||this.firstPointerId!==-1||(this.firstPointerId=O.pointerId,this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp),this.rotBy!=="keys"&&!Ii&&!ww&&this.domElement.requestPointerLock(),this.prevMouse.set(O.clientX,O.clientY))},this.onPointerUp=O=>{this.firstPointerId=-1,this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this.onPointerUp),O.pointerType==="mouse"&&this.domElement.ownerDocument.exitPointerLock()},this.onPointerMove=O=>{if(O.pointerId!==this.firstPointerId)return;let I=O.clientX-this.prevMouse.x,D=O.clientY-this.prevMouse.y;this.prevMouse.set(O.clientX,O.clientY),O.pointerType==="mouse"&&this.rotBy!=="keys"&&(ww&&pI<15.5&&!Ii?(this.eulerDelta.y=-I*this.mouseOrbitSensitivity,this.eulerDelta.x=-D*this.mouseOrbitSensitivity):(this.eulerDelta.y=-O.movementX*this.mouseOrbitSensitivity,this.eulerDelta.x=-O.movementY*this.mouseOrbitSensitivity)),O.pointerType!=="mouse"&&this.rotByTouch==="drag"&&(this.eulerDelta.y=-I*this.mouseOrbitSensitivity*5,this.eulerDelta.x=-D*this.mouseOrbitSensitivity*5),this.controlsManager.requestRender()},this.onPointerlockChange=O=>{this.domElement.ownerDocument.pointerLockElement===this.domElement?Ub.isLocked=!0:Ub.isLocked=!1},this.onPointerlockError=()=>{console.error("SPE.GameControls: Unable to use Pointer Lock API")},this.handleVisibilityChange=()=>{if(document!=null&&document.hidden)for(let O in this.movementState)this.movementState[O]=0},this.onKeyDown=O=>{!(O.target instanceof HTMLInputElement)&&(O.code==="ArrowLeft"||O.code==="ArrowUp"||O.code==="ArrowRight"||O.code==="ArrowDown"||O.code==="Space")&&O.preventDefault();for(let I of this.keyAssignments)if(O.key.toUpperCase()===I[1]||O.key===I[1]){this.movementState[I[0]]=1;break}this.controlsManager.requestRender()},this.onKeyUp=O=>{for(let I of this.keyAssignments)if(O.key.toUpperCase()===I[1]||O.key===I[1]||O.code.slice(3,O.code.length).toUpperCase()===I[1]){this.movementState[I[0]]=0;break}},this.copyVRGamePadValues=(O,I)=>{for(let D=2;D<4;D++){let z=O.axes[D];I===0?D===2?this.movementState.movePosX=z:this.movementState.movePosZ=z:(O.buttons[3].pressed?this.movementState.jump=1:this.movementState.jump=0,D===2?(Math.abs(this.movementState.rotPosY)<.3&&Math.abs(z)>=.3&&(this.vrEulerYOffset+=z<0?1:-1),this.movementState.rotPosY=z):this.moveMode==="fly"&&(this.movementState.moveNegY=z))}},this.sharedGameControlGlobals=f.sharedGameControlGlobals,r===x&&(this.isFirstPerson=!0),this.hiddenMatrix0.copy(this.object.hiddenMatrix),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.euler0.setFromQuaternion(this.quaternion,"YXZ");let S=this.euler0.clone(),A=S.y;if(this.objectRealQuat.copy(this.quaternion),S.y=0,this.quaternion.setFromEuler(S),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),S.set(0,A,0),this.quaternion.setFromEuler(S),this.rot.setFromEuler(S),this.object.matrixAutoUpdate=!1,(this.isFirstPerson||this.cameraFollow===!0)&&(this.target0.copy(this.camera.getTarget()),this.zoom0=this.camera.zoom),this.cameraFollow===!0){this.position0Cam.copy(this.camera.position),this.quat0Cam.copy(this.camera.quaternion),this.scale0Cam.copy(this.camera.scale),this.hiddenMatrix0Cam.copy(this.camera.hiddenMatrix),this.camera.parent?(this.camera.hiddenMatrix.copy((M=this.camera)==null?void 0:M.parent.matrixWorld),this.camera.matrix.copy(this.camera.matrixWorld)):this.camera.hiddenMatrix.identity(),this.camera.matrix.copy(this.camera.matrixWorld),this.camera.matrix.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.matrixAutoUpdate=!1,this.offsetMatrix.copy(this.object.matrix).invert().multiply(this.camera.matrix);let O=new E(0,0,-1).applyQuaternion(this.camera.quaternion),I=new E().subVectors(this.position,this.camera.position);this.objectToCamXZ.copy(I),this.objectToCamXZ.y=0,this.objectToCamXZ0.copy(this.objectToCamXZ);let D,z;Math.abs(O.y)<1e-6?(I.y=0,O.y=0,z=I.projectOnVector(O)):I.y/O.y>0?z=O.multiplyScalar(I.y/O.y):z=O.multiplyScalar(I.length()),this.targetToCamera0.copy(z).negate(),D=this.camera.position.clone().add(z),this.objectToTarget0.subVectors(D,this.position);let k=new or().setFromQuaternion(this.camera.quaternion,"YXZ");this.cameraPolarOffset=-k.x,k.x=0,k.z=0,k.y-=Math.PI/2,this.cameraPolarAxis0.set(0,0,-1).applyEuler(k)}if(this.object instanceof Er&&(this.object.matrixAutoUpdate=!1),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.rotByTouch=n.rotByTouch??"joystick",this.rotBy=n.rotBy??"keys",this.rotationMode=n.rotationMode??"normal",this.moveMode=n.moveMode??"walk",this.collisionEnabled=n.collisionEnabled,this.speedTranslate=(n.speedTranslate??250)*t$,this.speedOrbit=(n.speedRotate??100)*r$,this.mouseOrbitSensitivity=(n.speedRotate??100)*i$,this.keyAssignments=n.keyAssignments.map(O=>{let I=[O[0],O[1]];return I[1]==="▲"?I[1]="ArrowUp":I[1]==="◀"?I[1]="ArrowLeft":I[1]==="▼"?I[1]="ArrowDown":I[1]==="▶"?I[1]="ArrowRight":I[1]==="⇧"?I[1]="Shift":I[1]==="↵"?I[1]="Enter":I[1]==="Space"?I[1]=" ":I[1]==="⌘"?I[1]="Meta":I[1]==="Ctrl"?I[1]="Control":I[1]==="Esc"&&(I[1]="Escape"),I}),n.rotBy==="mouse"){let O;O=this.keyAssignments.findIndex(I=>I[0]==="rotNegX"),O!==-1&&(this.keyAssignments[O][1]=""),O=this.keyAssignments.findIndex(I=>I[0]==="rotPosX"),O!==-1&&(this.keyAssignments[O][1]=""),O=this.keyAssignments.findIndex(I=>I[0]==="rotPosY"),O!==-1&&(this.keyAssignments[O][1]=""),O=this.keyAssignments.findIndex(I=>I[0]==="rotNegY"),O!==-1&&(this.keyAssignments[O][1]="")}this.lerpFactorPosStart=1-.02**(1/((n.delayPos[0]??.3)*60)),this.lerpFactorPosEnd=1-.02**(1/((n.delayPos[1]??.3)*60)),this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.lerpFactorRotStart=1-.02**(1/((n.delayRot[0]??.3)*60)),this.lerpFactorRotEnd=1-.02**(1/((n.delayRot[1]??.3)*60)),this.lerpFactorPosCamera=1-.02**(1/((n.delayPosCamera??.3)*60)),this.lerpFactorRotCamera=1-.02**(1/((n.delayRotCamera??.3)*60)),this.gravity=(this.gloabalPhysics.gravity??Rl.defaultData.gravity)*XN,this.usePhysics=this.gloabalPhysics.usePhysics??Rl.defaultData.usePhysics,this.jumpPower=n.jumpPower*n$,this.resetYPosition=this.position.y+Math.abs(n.resetYPosition)*(this.gravity>0?1:-1),this.alignToGround=n.alignToGround??!1,this.orientMode=n.autoOrientMove?n.orientMode:"none",this.orientWith=n.orientWith??nd.defaultDataThirdPerson.orientWith,this.slopeThresh=QJ*Math.PI/180,n.collider.type==="capsule"?(this.collider.radius=n.collider.radius,this.collider.segment.start.y=n.collider.height/2-n.collider.radius,this.collider.segment.end.y=-this.collider.segment.start.y,this.offset=n.collider.height*eM/this.pixelsPerMeter,this.stepThresh=n.collider.height*tM/this.pixelsPerMeter,this.colliderHeight=n.collider.height):n.collider.type==="sphere"?(this.collider.radius=n.collider.radius,this.collider.segment.start.y=0,this.collider.segment.end.y=0,this.offset=2*n.collider.radius*eM/this.pixelsPerMeter,this.stepThresh=2*n.collider.radius*tM/this.pixelsPerMeter,this.colliderHeight=n.collider.radius*2):(this.offset=n.collider.height*eM/this.pixelsPerMeter,this.stepThresh=n.collider.height*tM/this.pixelsPerMeter,this.colliderHeight=n.collider.height),this.collider.type=n.collider.type;let C=new E().fromArray(n.collider.position),P=new Ke().setFromEuler(new or().fromArray([...n.collider.rotation,"XYZ"]));this.collider.position.copy(C).multiply(this.scale),this.collider.rotation.copy(P),this.collider.matrix.compose(C,P,qN),n.cameraXAxis!==void 0&&(this.cameraXAxis=n.cameraXAxis,this.cameraYAxis=n.cameraYAxis,this.minPolarAngle=n.cameraRotXLimits[0],this.maxPolarAngle=n.cameraRotXLimits[1],this.minAzimuthAngleRel=n.cameraRotYLimits[0],this.maxAzimuthAngleRel=n.cameraRotYLimits[1]),this.forwardDir=n.forwardDirection??"-z",this.isFirstPerson&&(this.forwardDir="-z"),this.runMultiplier=n.runMultiplier??2;let T=n.navmesh.destinationHelperRadius*2;if(T>0){let O=new Ue;O.push({fi:0,data:{...Wr.defaultData("light","phong"),alpha:0},id:"layer1"}),O.push({fi:0,data:{...Wr.defaultData("color"),color:n.navmesh.destinationHelperColor,alpha:n.navmesh.destinationHelperColor.a},id:"layer2"});let I=new Ua({layers:O},{scene:this.page.scene,shared:this.sharedAssets});this.navMeshPathDest=new Et(N0.create({parameters:{width:T,height:T/10,hollow:.7}}),I),this.navMeshPathDest.material.userData.opacity0=n.navmesh.destinationHelperColor.a}this.activate()}reset(r=!1){if(this.object.hiddenMatrix.copy(this.hiddenMatrix0),r){this.object.updateMatrix(),this.object.updateMatrixWorld(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity();let a=new or().setFromQuaternion(this.quaternion,"YXZ"),n=a.y;this.objectRealQuat.copy(this.quaternion),a.y=0,this.quaternion.setFromEuler(a),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),a.set(0,n,0),this.quaternion.setFromEuler(a),this.rot.setFromEuler(a),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.velocityTarget.set(0,0,0),this.velocity.set(0,0,0)}else this.object instanceof Er?this.object.matrixAutoUpdate=!0:this.object.updateMatrix();this.cameraFollow===!0&&(this.camera.quaternion.copy(this.quat0Cam),this.camera.position.copy(this.position0Cam),this.camera.scale.copy(this.scale0Cam),this.camera.hiddenMatrix.copy(this.hiddenMatrix0Cam),this.camera.matrixAutoUpdate=!0),this.controlsManager.requestRender()}activate(){this.instantiateActions(),this.domElement.ownerDocument.addEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.addEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.addEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.addEventListener("visibilitychange",this.handleVisibilityChange)}deactivate(){this.disposeActions(),this.domElement.ownerDocument.removeEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.removeEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.removeEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.removeEventListener("visibilitychange",this.handleVisibilityChange)}dispose(){var r;this.deactivate(),(r=this.navMeshPathDest)!=null&&r.parent&&this.page.remove(this.navMeshPathDest)}instantiateActions(){let r=this.data,a=this.sharedAssets;r.gameActions!==void 0&&(this.actions={},id.list.forEach(n=>{this.actions[n]=Ht({...r,disabled:!1,type:"GameControl"},r.gameActions[n],this.page,a,this.controlsManager.eventManager,this.object)})),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"),this.initialAction&&(this.initialAction=!1)}disposeActions(){this.initialAction=!1,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),dr(this.actions.idle),dr(this.actions.move),dr(this.actions.run),dr(this.actions.jump)}dispatchStartEvent(r){this.actions[r]!==void 0&&(this.actionState[r]||(this.actionState[r]=!0,this.actions[r].Transition.forEach(a=>{a.play()}),this.actions[r].Animation.forEach(a=>{a.play(this.initialAction===!1)}),this.actions[r].Create.forEach(a=>{a.dispatchStart()}),this.actions[r].Audio.forEach(a=>{a.dispatchGameControl("start")}),this.actions[r].Particles.forEach(a=>{a.dispatchGameControl("start")})))}dispatchStopEvent(r){this.actions[r]!==void 0&&(!this.actionState[r]||(this.actionState[r]=!1,this.actions[r].Transition.forEach(a=>{a.stop(),a.object.currentState!==null&&a.object.changeSelectedState(null,{scene:this.page.scene,shared:this.sharedAssets})}),this.actions[r].Create.forEach(a=>{a.dispatchStop()}),this.actions[r].Audio.forEach(a=>{a.dispatchGameControl("stop")}),this.actions[r].Particles.forEach(a=>{a.dispatchGameControl("stop")})))}get colliderWorldPosition(){return Cn.copy(this.collider.position).applyQuaternion(this.objectRealQuat).add(this.position)}update(r,a,n){var b,_,S,A,C,P,T,M,O;if(this.gravity<0?this.position.y<this.resetYPosition:this.position.y>this.resetYPosition)return this.reset(!0),!0;this.sharedGameControlGlobals.gamePads.forEach(this.copyVRGamePadValues);let o=(this.isFirstFrame?16.6:r)/1e3;this.isFirstFrame&&(this.isFirstFrame=!1);let f=o*60,y=!1;if(this.usePhysics&&this.collisionEnabled){let I=Gn.set(0,(this.velocity.y===0?this.pixelsPerMeter*Math.max(Math.abs(this.gravity)/(10*XN),1)*(this.gravity>0?1:-1):this.velocity.y)*o,0).divideScalar(this.pixelsPerMeter),D=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter),this.colliderWorldQuat,I,(b=this.object.rigidBody)==null?void 0:b.collider(0).shape,1,!1,16,void 0,void 0,this.object.rigidBody);if(D){this.onObject=!0,this.groundNormal.set(D.normal2.x,D.normal2.y,D.normal2.z).applyQuaternion(this.colliderWorldQuat).negate(),this.alignToGround&&this.groundTiltAdjustment(this.groundNormal),Math.acos(this.groundNormal.y)<this.slopeThresh&&(y=!0),((_=D.collider.parent())==null?void 0:_.bodyType())===0&&Math.acos(this.groundNormal.y)*(180/Math.PI)>45&&(this.onObject=!1);let z=D.collider.parent();this.groundYRotation=0,this.groundVelocity.set(0,0,0);for(let k of this.sharedGameControlGlobals.entitiesWithTransformAnim)if(k.rigidBody===z&&k.userData.isFollowingObj!==this.object.uuid){(k.hasNonUniformScale?k.matrixWorldRigid:k.matrixWorld).decompose(Cn,Xa,Gn),this.groundVelocity.subVectors(Cn,k.prevT),this.object.getWorldPosition(Gn).add(this.collider.position).sub(Cn),this.groundYRotation=$o.setFromQuaternion(Xa).y-k.prevR.y,cc.copy(Gn).applyAxisAngle(so,this.groundYRotation),this.groundVelocity.add(cc.sub(Gn)).divideScalar(o);break}}else this.onObject=!1}if(this.moveMode==="walk"&&this.collisionEnabled&&(this.movementState.jump===1&&this.onObject&&(this.velocityTarget.y=this.jumpPower,this.movementState.jump=0,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("jump"),this.onObject=!1),this.onObject?this.velocityTarget.y/=2:this.velocityTarget.y+=this.gravity*f),this.moveMode==="fly"&&(this.velocityTarget.y=(this.movementState.movePosY-this.movementState.moveNegY)*this.speedTranslate),this.directionXZ.z=this.movementState.movePosZ-this.movementState.moveNegZ,this.directionXZ.x=this.movementState.movePosX-this.movementState.moveNegX,this.forwardDir==="+z"&&this.directionXZ.multiplyScalar(-1),this.directionXZ.manhattanLength()>0&&(this.path=[]),this.navMeshPathDest){let I=this.navMeshPathDest.material;if(this.moveMode==="walk"&&this.path.length>1){this.navMeshPathDest.position.copy(this.path[this.path.length-1]),this.navMeshPathDest.parent||this.page.add(this.navMeshPathDest);let D=Cn.subVectors(this.path[1],this.position),z=Gn.subVectors(this.path[1],this.path[0]);D.dot(z)<0?this.path.shift():(this.directionXZ.x=z.x,this.directionXZ.z=z.z),I.opacity=I.userData.opacity0}else I.opacity-=.05*I.userData.opacity0,this.navMeshPathDest.material.opacity<=0&&this.navMeshPathDest.parent&&this.page.remove(this.navMeshPathDest)}this.directionXZ.normalize(),this.movementState.run?this.moveForce=this.runMultiplier:this.moveForce=1,this.velocityTarget.z=this.directionXZ.z*this.speedTranslate*this.moveForce,this.velocityTarget.x=this.directionXZ.x*this.speedTranslate*this.moveForce,(this.moveMode==="walk"?this.velocityTarget.x+this.velocityTarget.z===0:this.velocityTarget.manhattanLength()===0)?this.lerpFactorPos.setScalar(this.lerpFactorPosEnd):this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.moveMode==="walk"&&(this.lerpFactorPos.y=1),this.didHit===!1&&this.pushedVelocity.manhattanLength()===0||this.usePhysics===!1?(this.velocity.x+=(this.velocityTarget.x-this.velocity.x)*(1-(1-this.lerpFactorPos.x)**f),this.velocity.y+=(this.velocityTarget.y-this.velocity.y)*(1-(1-this.lerpFactorPos.y)**f),this.velocity.z+=(this.velocityTarget.z-this.velocity.z)*(1-(1-this.lerpFactorPos.z)**f)):this.velocity.copy(this.velocityTarget),(this.moveMode==="walk"?this.velocity.x**2+this.velocity.z**2<this.speedTranslate:this.velocity.lengthSq()<this.speedTranslate)?(this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.onObject&&(this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"))):(this.dispatchStopEvent("idle"),this.onObject&&(this.dispatchStopEvent("jump"),this.movementState.run?(this.dispatchStopEvent("move"),this.dispatchStartEvent("run")):(this.dispatchStopEvent("run"),this.dispatchStartEvent("move"))));let x=ZJ.copy(this.velocity);if(this.orientMode!=="none"&&this.isFirstPerson===!1){let I=Gn.copy(x);I.y=0,x.set(0,x.y,I.length()*(this.forwardDir==="+z"?1:-1))}if(this.directionXZ.manhattanLength()>0&&this.orientMode!=="none"&&this.isFirstPerson===!1)if(this.orientWith==="camera"&&this.path.length<=1){let I=Cn;this.camera.getWorldDirection(I);let D=cc.copy(so).multiplyScalar(I.dot(so));I.sub(D);let z=Gn.copy(this.directionXZ);z.x*=-1,this.rot.y=I.angleTo(z)*(I.cross(z).y>0?-1:1)+this.rotationAccumWhenOrientWithCamera}else this.rot.y=(this.path.length>1?0:this.euler.y)+Math.atan2(-this.directionXZ.z,this.directionXZ.x)+Math.PI/2*(this.forwardDir==="+z"?1:-1);if($o.setFromVector3(this.rot),this.moveMode==="walk"&&($o.x=0),x.applyEuler($o),y&&(Xa.setFromUnitVectors(so,this.groundNormal),x.applyQuaternion(Xa)),n){let I=$o.set(0,this.vrEulerYOffset*YN,0);n.applyEuler(I),x.x+=n.x,x.z+=n.z,this.nonColliderPosOffset.elements[13]+=n.y*o}if(this.usePhysics===!0){let I=Gn;this.pushedVelocity.set(0,0,0);for(let D of this.sharedGameControlGlobals.entitiesWithTransformAnim){let z=cc.setFromMatrixPosition(D.matrixWorld).sub(D.prevT).divideScalar(o).divideScalar(this.pixelsPerMeter),k=D.rigidBody.collider(0).castCollider(z,this.object.rigidBody.collider(0),Cn.copy(x).divideScalar(this.pixelsPerMeter),o,!1);z.multiplyScalar(this.pixelsPerMeter);let L=mt.is(D)?D:D.object;if(k!==null&&this.lastHitObj!==L){let R;D instanceof Dr&&(R=D);let F=this.sharedGameControlGlobals.entityToCollisionEvents[L.uuid];if(F)for(let B of F)B.data.target==="character"&&(B.dispatch(R),L.dispatchEvent(zb));this.lastHitObj=L}if(k!==null){this.pushedVelocity.copy(z),I.copy(k.normal1).applyQuaternion(D.quaternion);break}}if(this.pushedVelocity.manhattanLength()!==0){let D=I.dot(x);D<0&&x.addScaledVector(I,-D),x.add(this.pushedVelocity)}else x.add(this.groundVelocity)}if(this.rotDirection.y=Number(this.movementState.rotPosY)-Number(this.movementState.rotNegY),this.rotDirection.x=Number(this.movementState.rotPosX)-Number(this.movementState.rotNegX),this.rotDirection.normalize(),this.rotationMode==="normal"&&(this.movementState.rotPosX||this.movementState.rotNegX)||this.rotationMode==="steer"&&(this.movementState.rotPosX||this.movementState.rotNegX)&&(this.movementState.movePosZ||this.movementState.moveNegZ||this.moveMode==="walk")?this.rotVelocityStick.x=-this.rotDirection.x*this.speedOrbit*this.rotForce:this.rotVelocityStick.x=0,this.rotationMode==="normal"&&(this.movementState.rotPosY||this.movementState.rotNegY)||this.rotationMode==="steer"&&(this.movementState.rotPosY||this.movementState.rotNegY)&&(this.movementState.movePosZ||this.movementState.moveNegZ)?this.rotVelocityStick.y=-this.rotDirection.y*this.speedOrbit*this.rotForce:this.rotVelocityStick.y=0,this.rotVelocityTarget.subVectors(this.eulerDelta.divideScalar(o),this.rotVelocityStick),this.rotVelocityTarget.manhattanLength()===0?this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotEnd)**f):this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotStart)**f),this.euler.x+=this.rotVelocity.x*o,this.euler.y+=this.rotVelocity.y*o+this.groundYRotation,this.rotVelocityTarget.y===0&&this.directionXZ.manhattanLength()===0?this.rotationAccumWhenOrientWithCamera=0:(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.rotationAccumWhenOrientWithCamera+=this.rotVelocity.y*o),this.isFirstPerson===!1&&this.orientMode!=="none"&&this.directionXZ.manhattanLength()>0){if(this.orientMode==="radial"){this.objectToCamXZ.copy(this.objectToCamXZ0).applyAxisAngle(so,this.euler.y-this.euler0.y);let I=Gn.copy(this.objectToCamXZ).normalize(),D=cc.copy(x).multiplyScalar(o);D.y=0;let z=D.sub(Cn.copy(I).multiplyScalar(D.dot(I))).cross(I).y;this.euler.y-=Math.atan2(z,this.objectToCamXZ.length())}}else this.rot.y+=this.rotVelocity.y*o+this.groundYRotation,this.rotVelocityTarget.y!==0&&(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.euler.y=this.rot.y);if(this.cameraFollow===!0&&(this.moveMode==="walk"?this.cameraXAxis==="Limit"?this.euler.x=we.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):this.euler.x=we.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset,this.PI_2+this.cameraPolarOffset):this.cameraXAxis==="Limit"&&(this.euler.x=we.clamp(this.euler.x,-this.PI_2,this.PI_2))),this.moveMode==="fly"?this.rot.x=this.euler.x:this.isFirstPerson&&(a?($o.copy(a),$o.y=0):($o.copy(this.euler),$o.y=0),this.nonColliderRotOffset.makeRotationFromEuler($o)),a&&(this.moveMode==="walk"?(this.rot.y=a.y,this.rot.x=0,this.rot.z=0):this.rot.setFromEuler(a),this.rot.y+=this.vrEulerYOffset*YN),no.setFromAxisAngle($J,this.rot.x),Xa.setFromAxisAngle(so,this.rot.y),Xa.multiply(no),no.setFromAxisAngle(e$,this.rot.z),Xa.multiply(no),this.quaternion.copy(Xa),this.objectRealQuat.multiplyQuaternions(this.quaternion,this.objXZQuat),this.colliderWorldQuat.copy(this.objectRealQuat).multiply(this.collider.rotation),this.collisionEnabled)if(this.usePhysics){let I=Gn.copy(x).multiplyScalar(o/this.pixelsPerMeter),D=null;this.didHit=!1;let z=new E;for(let k=0;k<5;k++){let L=I.length(),R=cc.copy(I).normalize();if(D=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(z),this.colliderWorldQuat,R,(S=this.object.rigidBody)==null?void 0:S.collider(0).shape,L,!1,24,void 0,void 0,this.object.rigidBody),D!==null){this.didHit=!0;let F=this.sharedGameControlGlobals.colliderToEntity.get(D.collider.handle);if(F!==this.lastHitObj&&k===0){this.lastHitObj=F;let G=this.sharedGameControlGlobals.entityToCollisionEvents[F==null?void 0:F.uuid];if(G){for(let Y of G)if(Y.data.target==="character"){let X=((A=this.sharedGameControlGlobals.rapierWorld)==null?void 0:A.getCollider(D.collider.handle))._parent,$;if(F.cloner){for(let te of F.cloner.children)if(te.rigidBody===X){$=te;break}}Y.dispatch($),F.dispatchEvent(zb)}}}let B=jN.set(D.normal2.x,D.normal2.y,D.normal2.z).applyQuaternion(this.colliderWorldQuat),N=HN.copy(R).multiplyScalar(D.toi).dot(B),j=D.toi;if(j===0&&(this.position.y+=this.offset*this.pixelsPerMeter),N>this.offset&&(j=D.toi*(N-this.offset)/N,z.addScaledVector(R,j)),I.copy(R).multiplyScalar(L-j),Math.acos(-B.y)>this.slopeThresh){let G=this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(z),Y=cc.copy(D.witness2).applyQuaternion(this.colliderWorldQuat);Y.y=0;let X=G.add(Y);X.y+=this.stepThresh;let $=this.sharedGameControlGlobals.rapierWorld.castShape(X,this.colliderWorldQuat,I,(C=this.object.rigidBody)==null?void 0:C.collider(0).shape,1,!1,24,void 0,void 0,this.object.rigidBody);$!==null&&$.toi===0&&(B.y=0,B.normalize())}I.addScaledVector(B,-I.dot(B))}else{k===0&&this.directionXZ.manhattanLength()!==0&&(this.lastHitObj=null),z.add(I);break}}this.position.addScaledVector(z,this.pixelsPerMeter),(P=this.object.rigidBody)==null||P.setTranslation(Cn.copy(this.position).divideScalar(this.pixelsPerMeter),!0),(T=this.object.rigidBody)==null||T.setRotation(no.copy(this.quaternion).premultiply(this.groundTilt).multiply(this.objXZQuat),!0)}else{let I=this.onObject?1:5,D=x.multiplyScalar(o/I);for(let z=0;z<I;z++)this.position.add(D),this.collisionAdjustment(o/I)}else this.position.addScaledVector(x,o);if(this.moveMode==="walk"&&this.onObject&&(this.velocityTarget.y=0,this.velocity.y=0),this.quaternion.premultiply(this.groundTilt).multiply(this.objXZQuat),this.object.matrix.compose(this.position,this.quaternion,this.scale),this.object.matrixWorldNeedsUpdate=!0,this.object.matrix.multiply(this.nonColliderPosOffset).multiply(this.nonColliderRotOffset),this.quaternion.premultiply(this.groundTiltInv).multiply(this.objXZQuatInv),this.cameraFollow===!0){this.updateFollowArms();let I=this.objectToTarget.add(this.position),D=this.targetToCamera.add(I);rM.lookAt(D,I,so).setPosition(D),rM.decompose(this.targetPos,this.targetQuat,Cn),this.camera.quaternion.slerp(this.targetQuat,1-(1-this.lerpFactorRotCamera)**f),this.camera.position.lerp(this.targetPos,1-(1-this.lerpFactorPosCamera)**f),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.cameraYAxis==="Limit"&&this.orientMode==="cartesian"&&(this.euler.y=we.clamp(this.euler.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel)),this.euler.x=we.clamp(this.euler.x,-this.PI_2+(this.cameraPolarOffset<0?this.cameraPolarOffset:0),this.PI_2+(this.cameraPolarOffset>0?this.cameraPolarOffset:0))}return this.eulerDelta.set(0,0,0),this.object.dispatchEvent(o$),this.path.length<2&&this.lastPosition.distanceToSquared(this.position)<this.threshEndTranslate&&Math.abs(this.rotVelocity.x)<this.threshEndRotVel&&Math.abs(this.rotVelocity.y)<this.threshEndRotVel&&(this.camera===void 0||this.isFirstPerson||this.lastCameraPosition.distanceToSquared(this.camera.position)<this.threshEndTranslate&&8*(1-this.lastCameraQuaternion.dot(this.camera.quaternion))<this.threshEndRotate)&&(this.moveMode==="fly"||this.onObject===!0||this.collisionEnabled===!1)&&(this.navMeshPathDest===null||this.navMeshPathDest.material.opacity<-.04*((O=(M=this.navMeshPathDest)==null?void 0:M.material)==null?void 0:O.userData.opacity0))?!1:(this.camera&&(this.lastCameraPosition.copy(this.camera.position),this.lastCameraQuaternion.copy(this.camera.quaternion)),this.lastPosition.copy(this.position),this.object.dispatchEvent(s$),!0)}updateFollowArms(){this.objectToTarget.copy(this.objectToTarget0),this.targetToCamera.copy(this.targetToCamera0);let r=no.setFromAxisAngle(so,this.cameraYAxis==="Limit"&&this.orientMode!=="radial"?we.clamp(this.euler.y-this.euler0.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel):this.euler.y-this.euler0.y);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&this.objectToTarget.applyQuaternion(r);let a;this.cameraXAxis==="Limit"?a=we.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):a=we.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset+1e-6,this.PI_2+this.cameraPolarOffset-1e-6);let n=Cn.copy(this.cameraPolarAxis0);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&n.applyQuaternion(r);let o=Xa.setFromAxisAngle(n,a);this.cameraYAxis!=="Locked"&&this.targetToCamera.applyQuaternion(r),this.cameraXAxis!=="Locked"&&this.targetToCamera.applyQuaternion(o)}groundTiltAdjustment(r){so.angleTo(r)*180/Math.PI<15||so.angleTo(r)*180/Math.PI>85?no.identity():no.setFromUnitVectors(so,r),this.groundTilt.slerp(no,.06),this.groundTiltInv.copy(this.groundTilt).invert()}collisionAdjustment(r){var f;let a=HN.set(0,0,0);this.object.matrix.compose(this.position,this.quaternion,this.scale);let n=rM.multiplyMatrices(this.object.matrix,this.objXZRotMat).multiply(this.collider.matrix).decompose(Cn,no,Gn).compose(Cn,no,qN);this.sharedGameControlGlobals.entitiesWithTransformAnim.forEach(y=>{if(y===this.object||y.isDescendantOf(this.object))return;Ps.makeEmpty(),y.updateMatrixWorldSVD();let x=y.matrixWorldRigid,b=WN.copy(x).invert(),_=JJ.copy(WN).multiply(n);Wi.copy(this.collider.segment),Wi.start.applyMatrix4(_),Wi.end.applyMatrix4(_);let S=jN.copy(this.position).applyMatrix4(b);Ps.expandByPoint(Wi.start),Ps.expandByPoint(Wi.end),Ps.min.addScalar(-this.collider.radius),Ps.max.addScalar(this.collider.radius),y.bvhGeometry.boundsTree.shapecast({traverseBoundsOrder(A){return A.distanceToPoint(Wi.end)},intersectsBounds:A=>A.intersectsBox(Ps),intersectsTriangle:A=>{let C=Cn,P=Gn,T=A.closestPointToSegment(Wi,C,P);if(T<this.collider.radius){let M=this.collider.radius-T,O=P.sub(C).normalize(),I=cc.copy(S);I.addScaledVector(O,M);let D=I.applyMatrix4(x).sub(this.position);a.add(D),Wi.start.addScaledVector(O,M),Wi.end.addScaledVector(O,M)}}})}),Ps.makeEmpty(),Wi.copy(this.collider.segment),Wi.start.applyMatrix4(n),Wi.end.applyMatrix4(n),Ps.expandByPoint(Wi.start),Ps.expandByPoint(Wi.end),Ps.min.addScalar(-this.collider.radius),Ps.max.addScalar(this.collider.radius),(f=this.sharedGameControlGlobals.staticMeshBVH)==null||f.shapecast({traverseBoundsOrder(y){return y.distanceToPoint(Wi.end)},intersectsBounds:y=>y.intersectsBox(Ps),intersectsTriangle:y=>{let x=Cn,b=Gn,_=y.closestPointToSegment(Wi,x,b);if(_<this.collider.radius){let S=this.collider.radius-_,A=b.sub(x).normalize();this.alignToGround&&this.groundTiltAdjustment(A),a.addScaledVector(A,S),Wi.start.addScaledVector(A,S),Wi.end.addScaledVector(A,S)}}}),this.onObject=Math.abs(a.y)>Math.abs(r*this.velocity.y*.25),this.onObject&&this.dispatchStopEvent("jump");let o=Math.max(0,a.length()-1e-5);a.normalize().multiplyScalar(o),this.position.add(a)}pause(){this.firstPointerId=-1,this.movementState={moveNegZ:0,movePosZ:0,moveNegX:0,movePosX:0,moveNegY:0,movePosY:0,rotPosX:0,rotNegX:0,rotPosY:0,rotNegY:0,jump:0,run:0},this.deactivate()}resume(){this.activate()}},Eg=Ub;Eg.isLocked=!1;var KN=Za(CA()),a$=new ue,l$=new ue,ea=[[0,0,0],[0,0,0],[0,0,0]];function sM(r){let a=r.elements;ea[0][0]=a[0],ea[0][1]=a[4],ea[0][2]=a[8],ea[1][0]=a[1],ea[1][1]=a[5],ea[1][2]=a[9],ea[2][0]=a[2],ea[2][1]=a[6],ea[2][2]=a[10];let{u:n,v:o}=(0,KN.SVD)(ea),f=a$.set(n[0][0],n[0][1],n[0][2],0,n[1][0],n[1][1],n[1][2],0,n[2][0],n[2][1],n[2][2],0,0,0,0,1),y=l$.set(o[0][0],o[0][1],o[0][2],0,o[1][0],o[1][1],o[1][2],0,o[2][0],o[2][1],o[2][2],0,0,0,0,1);return f.multiply(y.transpose())}new E;new E;new E;new E;new E;new Gr;var sr=new E,Li=new E;new E;var fu=new Ke;new ue;new mr;new E;new E;function dM(r,a){!a||(a[0]<a[1]&&(r.x=Math.min(Math.max(r.x,a[0]),a[1])),a[2]<a[3]&&(r.y=Math.min(Math.max(r.y,a[2]),a[3])),a[4]<a[5]&&(r.z=Math.min(Math.max(r.z,a[4]),a[5])))}(function(){let r=new ue;return(a,n,o)=>{let f=a.obj;r.copy(f.hiddenMatrix),f.parent!==null&&r.premultiply(f.parent.matrixWorld),r.invert(),f.position.copy(n),a.reference==="global"&&dM(f.position,a.limits),f.position.applyMatrix4(r),a.reference==="parent"?dM(f.position,a.limits):a.reference==="local"&&(fu.copy(a.quat0).invert(),f.position.sub(a.position0),f.position.applyQuaternion(fu),dM(f.position,a.limits),fu.invert(),f.position.applyQuaternion(fu),f.position.add(a.position0)),r.multiply(o??f.matrixWorld).decompose(sr,f.quaternion,Li),f.updateMatrix(),f.hasNonUniformScale&&(f.updateMatrixWorld(),f.updateMatrixWorldSVD()),f instanceof yr&&Mn(f.parent)&&f.invalidateDownstreamBooleanData(!0)}})();new E;new E;new E;new E;new Gr;(function(){let r=new E,a=new E;return(n,o,f)=>f>0?(r.subVectors(n,o),r.length()<=f?n:a.copy(o).add(r.normalize().multiplyScalar(f))):o})();(function(){let r=new ue;return(a,n)=>{a.position.copy(n),a.parent!==null&&(r.copy(a.parent.matrixWorld).invert(),a.position.applyMatrix4(r)),r.copy(a.hiddenMatrix).invert(),a.position.applyMatrix4(r),a.updateMatrix(),a.hasNonUniformScale&&(a.updateMatrixWorld(),a.updateMatrixWorldSVD()),a instanceof yr&&Mn(a.parent)&&a.invalidateDownstreamBooleanData(!0)}})();new E;new E;new ue;new E;new E;new E;new E;new Gr;(function(){let r=new ue;return function(a,n){a.parent!==null?r.multiplyMatrices(a.parent.matrixWorld,a.hiddenMatrix):r.copy(a.hiddenMatrix),n.premultiply(sM(r).invert()),a.rotation.setFromRotationMatrix(n),a.updateMatrix(),a instanceof yr&&Mn(a.parent)&&a.invalidateDownstreamBooleanData(!0)}})();new E;new E;new E;AI.then(r=>{new r.Vec3,new r.Vec3});new E;new V;new E;new V;new E;new ue;MI.then(r=>r);new E;new E;new E;new E;new E(1,1,1);new ue;new ue;new Nr;var zb={type:"beginEvent",eventName:"Collision"};new E(0,0,1);new E;new E;new mr;Za(IF(),1);new V;function t(r,a,n){return Math.max(r,Math.min(a,n))}class Animate{advance(a){var b;if(!this.isRunning)return;let n=!1;if(this.lerp)this.value=(o=this.value,f=this.to,y=60*this.lerp,x=a,function(_,S,A){return(1-A)*_+A*S}(o,f,1-Math.exp(-y*x))),Math.round(this.value)===this.to&&(this.value=this.to,n=!0);else{this.currentTime+=a;const _=t(0,this.currentTime/this.duration,1);n=_>=1;const S=n?1:this.easing(_);this.value=this.from+(this.to-this.from)*S}var o,f,y,x;(b=this.onUpdate)==null||b.call(this,this.value,n),n&&this.stop()}stop(){this.isRunning=!1}fromTo(a,n,{lerp:o=.1,duration:f=1,easing:y=_=>_,onStart:x,onUpdate:b}){this.from=this.value=a,this.to=n,this.lerp=o,this.duration=f,this.easing=y,this.currentTime=0,this.isRunning=!0,x==null||x(),this.onUpdate=b}}class Dimensions{constructor({wrapper:a,content:n,autoResize:o=!0,debounce:f=250}={}){_s(this,"resize",()=>{this.onWrapperResize(),this.onContentResize()});_s(this,"onWrapperResize",()=>{this.wrapper===window?(this.width=window.innerWidth,this.height=window.innerHeight):(this.width=this.wrapper.clientWidth,this.height=this.wrapper.clientHeight)});_s(this,"onContentResize",()=>{this.wrapper===window?(this.scrollHeight=this.content.scrollHeight,this.scrollWidth=this.content.scrollWidth):(this.scrollHeight=this.wrapper.scrollHeight,this.scrollWidth=this.wrapper.scrollWidth)});this.wrapper=a,this.content=n,o&&(this.debouncedResize=function(y,x){let b;return function(){let _=arguments,S=this;clearTimeout(b),b=setTimeout(function(){y.apply(S,_)},x)}}(this.resize,f),this.wrapper===window?window.addEventListener("resize",this.debouncedResize,!1):(this.wrapperResizeObserver=new ResizeObserver(this.debouncedResize),this.wrapperResizeObserver.observe(this.wrapper)),this.contentResizeObserver=new ResizeObserver(this.debouncedResize),this.contentResizeObserver.observe(this.content)),this.resize()}destroy(){var a,n;(a=this.wrapperResizeObserver)==null||a.disconnect(),(n=this.contentResizeObserver)==null||n.disconnect(),window.removeEventListener("resize",this.debouncedResize,!1)}get limit(){return{x:this.scrollWidth-this.width,y:this.scrollHeight-this.height}}}class Emitter{constructor(){this.events={}}emit(a,...n){let o=this.events[a]||[];for(let f=0,y=o.length;f<y;f++)o[f](...n)}on(a,n){var o;return(o=this.events[a])!=null&&o.push(n)||(this.events[a]=[n]),()=>{var f;this.events[a]=(f=this.events[a])==null?void 0:f.filter(y=>n!==y)}}off(a,n){var o;this.events[a]=(o=this.events[a])==null?void 0:o.filter(f=>n!==f)}destroy(){this.events={}}}const e=100/6;class VirtualScroll{constructor(a,{wheelMultiplier:n=1,touchMultiplier:o=1}){_s(this,"onTouchStart",a=>{const{clientX:n,clientY:o}=a.targetTouches?a.targetTouches[0]:a;this.touchStart.x=n,this.touchStart.y=o,this.lastDelta={x:0,y:0},this.emitter.emit("scroll",{deltaX:0,deltaY:0,event:a})});_s(this,"onTouchMove",a=>{const{clientX:n,clientY:o}=a.targetTouches?a.targetTouches[0]:a,f=-(n-this.touchStart.x)*this.touchMultiplier,y=-(o-this.touchStart.y)*this.touchMultiplier;this.touchStart.x=n,this.touchStart.y=o,this.lastDelta={x:f,y},this.emitter.emit("scroll",{deltaX:f,deltaY:y,event:a})});_s(this,"onTouchEnd",a=>{this.emitter.emit("scroll",{deltaX:this.lastDelta.x,deltaY:this.lastDelta.y,event:a})});_s(this,"onWheel",a=>{let{deltaX:n,deltaY:o,deltaMode:f}=a;n*=f===1?e:f===2?this.windowWidth:1,o*=f===1?e:f===2?this.windowHeight:1,n*=this.wheelMultiplier,o*=this.wheelMultiplier,this.emitter.emit("scroll",{deltaX:n,deltaY:o,event:a})});_s(this,"onWindowResize",()=>{this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight});this.element=a,this.wheelMultiplier=n,this.touchMultiplier=o,this.touchStart={x:null,y:null},this.emitter=new Emitter,window.addEventListener("resize",this.onWindowResize,!1),this.onWindowResize(),this.element.addEventListener("wheel",this.onWheel,{passive:!1}),this.element.addEventListener("touchstart",this.onTouchStart,{passive:!1}),this.element.addEventListener("touchmove",this.onTouchMove,{passive:!1}),this.element.addEventListener("touchend",this.onTouchEnd,{passive:!1})}on(a,n){return this.emitter.on(a,n)}destroy(){this.emitter.destroy(),window.removeEventListener("resize",this.onWindowResize,!1),this.element.removeEventListener("wheel",this.onWheel,{passive:!1}),this.element.removeEventListener("touchstart",this.onTouchStart,{passive:!1}),this.element.removeEventListener("touchmove",this.onTouchMove,{passive:!1}),this.element.removeEventListener("touchend",this.onTouchEnd,{passive:!1})}}class Lenis{constructor({wrapper:a=window,content:n=document.documentElement,wheelEventsTarget:o=a,eventsTarget:f=o,smoothWheel:y=!0,syncTouch:x=!1,syncTouchLerp:b=.075,touchInertiaMultiplier:_=35,duration:S,easing:A=k=>Math.min(1,1.001-Math.pow(2,-10*k)),lerp:C=!S&&.1,infinite:P=!1,orientation:T="vertical",gestureOrientation:M="vertical",touchMultiplier:O=1,wheelMultiplier:I=1,autoResize:D=!0,__experimental__naiveDimensions:z=!1}={}){this.__isSmooth=!1,this.__isScrolling=!1,this.__isStopped=!1,this.__isLocked=!1,this.onVirtualScroll=({deltaX:k,deltaY:L,event:R})=>{if(R.ctrlKey)return;const F=R.type.includes("touch"),B=R.type.includes("wheel");if(this.options.syncTouch&&F&&R.type==="touchstart"&&!this.isStopped&&!this.isLocked)return void this.reset();const N=k===0&&L===0,j=this.options.gestureOrientation==="vertical"&&L===0||this.options.gestureOrientation==="horizontal"&&k===0;if(N||j)return;let G=R.composedPath();if(G=G.slice(0,G.indexOf(this.rootElement)),G.find(te=>{var ee,q,Z,U,W;return((ee=te.hasAttribute)===null||ee===void 0?void 0:ee.call(te,"data-lenis-prevent"))||F&&((q=te.hasAttribute)===null||q===void 0?void 0:q.call(te,"data-lenis-prevent-touch"))||B&&((Z=te.hasAttribute)===null||Z===void 0?void 0:Z.call(te,"data-lenis-prevent-wheel"))||((U=te.classList)===null||U===void 0?void 0:U.contains("lenis"))&&!(!((W=te.classList)===null||W===void 0)&&W.contains("lenis-stopped"))}))return;if(this.isStopped||this.isLocked)return void R.preventDefault();if(this.isSmooth=this.options.syncTouch&&F||this.options.smoothWheel&&B,!this.isSmooth)return this.isScrolling=!1,void this.animate.stop();R.preventDefault();let Y=L;this.options.gestureOrientation==="both"?Y=Math.abs(L)>Math.abs(k)?L:k:this.options.gestureOrientation==="horizontal"&&(Y=k);const X=F&&this.options.syncTouch,$=F&&R.type==="touchend"&&Math.abs(Y)>5;$&&(Y=this.velocity*this.options.touchInertiaMultiplier),this.scrollTo(this.targetScroll+Y,Object.assign({programmatic:!1},X?{lerp:$?this.options.syncTouchLerp:1}:{lerp:this.options.lerp,duration:this.options.duration,easing:this.options.easing}))},this.onNativeScroll=()=>{if(!this.__preventNextScrollEvent&&!this.isScrolling){const k=this.animatedScroll;this.animatedScroll=this.targetScroll=this.actualScroll,this.velocity=0,this.direction=Math.sign(this.animatedScroll-k),this.emit()}},window.lenisVersion="1.0.42",a!==document.documentElement&&a!==document.body||(a=window),this.options={wrapper:a,content:n,wheelEventsTarget:o,eventsTarget:f,smoothWheel:y,syncTouch:x,syncTouchLerp:b,touchInertiaMultiplier:_,duration:S,easing:A,lerp:C,infinite:P,gestureOrientation:M,orientation:T,touchMultiplier:O,wheelMultiplier:I,autoResize:D,__experimental__naiveDimensions:z},this.animate=new Animate,this.emitter=new Emitter,this.dimensions=new Dimensions({wrapper:a,content:n,autoResize:D}),this.toggleClassName("lenis",!0),this.velocity=0,this.isLocked=!1,this.isStopped=!1,this.isSmooth=x||y,this.isScrolling=!1,this.targetScroll=this.animatedScroll=this.actualScroll,this.options.wrapper.addEventListener("scroll",this.onNativeScroll,!1),this.virtualScroll=new VirtualScroll(f,{touchMultiplier:O,wheelMultiplier:I}),this.virtualScroll.on("scroll",this.onVirtualScroll)}destroy(){this.emitter.destroy(),this.options.wrapper.removeEventListener("scroll",this.onNativeScroll,!1),this.virtualScroll.destroy(),this.dimensions.destroy(),this.toggleClassName("lenis",!1),this.toggleClassName("lenis-smooth",!1),this.toggleClassName("lenis-scrolling",!1),this.toggleClassName("lenis-stopped",!1),this.toggleClassName("lenis-locked",!1)}on(a,n){return this.emitter.on(a,n)}off(a,n){return this.emitter.off(a,n)}setScroll(a){this.isHorizontal?this.rootElement.scrollLeft=a:this.rootElement.scrollTop=a}resize(){this.dimensions.resize()}emit(){this.emitter.emit("scroll",this)}reset(){this.isLocked=!1,this.isScrolling=!1,this.animatedScroll=this.targetScroll=this.actualScroll,this.velocity=0,this.animate.stop()}start(){this.isStopped&&(this.isStopped=!1,this.reset())}stop(){this.isStopped||(this.isStopped=!0,this.animate.stop(),this.reset())}raf(a){const n=a-(this.time||a);this.time=a,this.animate.advance(.001*n)}scrollTo(a,{offset:n=0,immediate:o=!1,lock:f=!1,duration:y=this.options.duration,easing:x=this.options.easing,lerp:b=!y&&this.options.lerp,onComplete:_,force:S=!1,programmatic:A=!0}={}){if(!this.isStopped&&!this.isLocked||S){if(["top","left","start"].includes(a))a=0;else if(["bottom","right","end"].includes(a))a=this.limit;else{let C;if(typeof a=="string"?C=document.querySelector(a):a!=null&&a.nodeType&&(C=a),C){if(this.options.wrapper!==window){const T=this.options.wrapper.getBoundingClientRect();n-=this.isHorizontal?T.left:T.top}const P=C.getBoundingClientRect();a=(this.isHorizontal?P.left:P.top)+this.animatedScroll}}if(typeof a=="number"){if(a+=n,a=Math.round(a),this.options.infinite?A&&(this.targetScroll=this.animatedScroll=this.scroll):a=t(0,a,this.limit),o)return this.animatedScroll=this.targetScroll=a,this.setScroll(this.scroll),this.reset(),void(_==null||_(this));if(!A){if(a===this.targetScroll)return;this.targetScroll=a}this.animate.fromTo(this.animatedScroll,a,{duration:y,easing:x,lerp:b,onStart:()=>{f&&(this.isLocked=!0),this.isScrolling=!0},onUpdate:(C,P)=>{this.isScrolling=!0,this.velocity=C-this.animatedScroll,this.direction=Math.sign(this.velocity),this.animatedScroll=C,this.setScroll(this.scroll),A&&(this.targetScroll=C),P||this.emit(),P&&(this.reset(),this.emit(),_==null||_(this),this.__preventNextScrollEvent=!0,requestAnimationFrame(()=>{delete this.__preventNextScrollEvent}))}})}}}get rootElement(){return this.options.wrapper===window?document.documentElement:this.options.wrapper}get limit(){return this.options.__experimental__naiveDimensions?this.isHorizontal?this.rootElement.scrollWidth-this.rootElement.clientWidth:this.rootElement.scrollHeight-this.rootElement.clientHeight:this.dimensions.limit[this.isHorizontal?"x":"y"]}get isHorizontal(){return this.options.orientation==="horizontal"}get actualScroll(){return this.isHorizontal?this.rootElement.scrollLeft:this.rootElement.scrollTop}get scroll(){return this.options.infinite?(a=this.animatedScroll,n=this.limit,(a%n+n)%n):this.animatedScroll;var a,n}get progress(){return this.limit===0?1:this.scroll/this.limit}get isSmooth(){return this.__isSmooth}set isSmooth(a){this.__isSmooth!==a&&(this.__isSmooth=a,this.toggleClassName("lenis-smooth",a))}get isScrolling(){return this.__isScrolling}set isScrolling(a){this.__isScrolling!==a&&(this.__isScrolling=a,this.toggleClassName("lenis-scrolling",a))}get isStopped(){return this.__isStopped}set isStopped(a){this.__isStopped!==a&&(this.__isStopped=a,this.toggleClassName("lenis-stopped",a))}get isLocked(){return this.__isLocked}set isLocked(a){this.__isLocked!==a&&(this.__isLocked=a,this.toggleClassName("lenis-locked",a))}get className(){let a="lenis";return this.isStopped&&(a+=" lenis-stopped"),this.isLocked&&(a+=" lenis-locked"),this.isScrolling&&(a+=" lenis-scrolling"),this.isSmooth&&(a+=" lenis-smooth"),a}toggleClassName(a,n){this.rootElement.classList.toggle(a,n),this.emitter.emit("className change",this)}}function _defineProperties(r,a){for(var n=0;n<a.length;n++){var o=a[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(r,o.key,o)}}function _createClass(r,a,n){return a&&_defineProperties(r.prototype,a),r}/*!
 * Observer 3.13.0
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var gsap$2,_coreInitted$2,_win$1,_doc$1,_docEl$2,_body$2,_isTouch,_pointerType,ScrollTrigger$2,_root$1,_normalizer$1,_eventTypes,_context$1,_getGSAP$2=function(){return gsap$2||typeof window<"u"&&(gsap$2=window.gsap)&&gsap$2.registerPlugin&&gsap$2},_startup$1=1,_observers=[],_scrollers=[],_proxies=[],_getTime$1=Date.now,_bridge=function(a,n){return n},_integrate=function(){var a=ScrollTrigger$2.core,n=a.bridge||{},o=a._scrollers,f=a._proxies;o.push.apply(o,_scrollers),f.push.apply(f,_proxies),_scrollers=o,_proxies=f,_bridge=function(x,b){return n[x](b)}},_getProxyProp=function(a,n){return~_proxies.indexOf(a)&&_proxies[_proxies.indexOf(a)+1][n]},_isViewport$1=function(a){return!!~_root$1.indexOf(a)},_addListener$1=function(a,n,o,f,y){return a.addEventListener(n,o,{passive:f!==!1,capture:!!y})},_removeListener$1=function(a,n,o,f){return a.removeEventListener(n,o,!!f)},_scrollLeft="scrollLeft",_scrollTop="scrollTop",_onScroll$1=function(){return _normalizer$1&&_normalizer$1.isPressed||_scrollers.cache++},_scrollCacheFunc=function(a,n){var o=function f(y){if(y||y===0){_startup$1&&(_win$1.history.scrollRestoration="manual");var x=_normalizer$1&&_normalizer$1.isPressed;y=f.v=Math.round(y)||(_normalizer$1&&_normalizer$1.iOS?1:0),a(y),f.cacheID=_scrollers.cache,x&&_bridge("ss",y)}else(n||_scrollers.cache!==f.cacheID||_bridge("ref"))&&(f.cacheID=_scrollers.cache,f.v=a());return f.v+f.offset};return o.offset=0,a&&o},_horizontal={s:_scrollLeft,p:"left",p2:"Left",os:"right",os2:"Right",d:"width",d2:"Width",a:"x",sc:_scrollCacheFunc(function(r){return arguments.length?_win$1.scrollTo(r,_vertical.sc()):_win$1.pageXOffset||_doc$1[_scrollLeft]||_docEl$2[_scrollLeft]||_body$2[_scrollLeft]||0})},_vertical={s:_scrollTop,p:"top",p2:"Top",os:"bottom",os2:"Bottom",d:"height",d2:"Height",a:"y",op:_horizontal,sc:_scrollCacheFunc(function(r){return arguments.length?_win$1.scrollTo(_horizontal.sc(),r):_win$1.pageYOffset||_doc$1[_scrollTop]||_docEl$2[_scrollTop]||_body$2[_scrollTop]||0})},_getTarget=function(a,n){return(n&&n._ctx&&n._ctx.selector||gsap$2.utils.toArray)(a)[0]||(typeof a=="string"&&gsap$2.config().nullTargetWarn!==!1?console.warn("Element not found:",a):null)},_isWithin=function(a,n){for(var o=n.length;o--;)if(n[o]===a||n[o].contains(a))return!0;return!1},_getScrollFunc=function(a,n){var o=n.s,f=n.sc;_isViewport$1(a)&&(a=_doc$1.scrollingElement||_docEl$2);var y=_scrollers.indexOf(a),x=f===_vertical.sc?1:2;!~y&&(y=_scrollers.push(a)-1),_scrollers[y+x]||_addListener$1(a,"scroll",_onScroll$1);var b=_scrollers[y+x],_=b||(_scrollers[y+x]=_scrollCacheFunc(_getProxyProp(a,o),!0)||(_isViewport$1(a)?f:_scrollCacheFunc(function(S){return arguments.length?a[o]=S:a[o]})));return _.target=a,b||(_.smooth=gsap$2.getProperty(a,"scrollBehavior")==="smooth"),_},_getVelocityProp=function(a,n,o){var f=a,y=a,x=_getTime$1(),b=x,_=n||50,S=Math.max(500,_*3),A=function(M,O){var I=_getTime$1();O||I-x>_?(y=f,f=M,b=x,x=I):o?f+=M:f=y+(M-y)/(I-b)*(x-b)},C=function(){y=f=o?0:f,b=x=0},P=function(M){var O=b,I=y,D=_getTime$1();return(M||M===0)&&M!==f&&A(M),x===b||D-b>S?0:(f+(o?I:-I))/((o?D:x)-O)*1e3};return{update:A,reset:C,getVelocity:P}},_getEvent=function(a,n){return n&&!a._gsapAllow&&a.preventDefault(),a.changedTouches?a.changedTouches[0]:a},_getAbsoluteMax=function(a){var n=Math.max.apply(Math,a),o=Math.min.apply(Math,a);return Math.abs(n)>=Math.abs(o)?n:o},_setScrollTrigger=function(){ScrollTrigger$2=gsap$2.core.globals().ScrollTrigger,ScrollTrigger$2&&ScrollTrigger$2.core&&_integrate()},_initCore$1=function(a){return gsap$2=a||_getGSAP$2(),!_coreInitted$2&&gsap$2&&typeof document<"u"&&document.body&&(_win$1=window,_doc$1=document,_docEl$2=_doc$1.documentElement,_body$2=_doc$1.body,_root$1=[_win$1,_doc$1,_docEl$2,_body$2],gsap$2.utils.clamp,_context$1=gsap$2.core.context||function(){},_pointerType="onpointerenter"in _body$2?"pointer":"mouse",_isTouch=Observer.isTouch=_win$1.matchMedia&&_win$1.matchMedia("(hover: none), (pointer: coarse)").matches?1:"ontouchstart"in _win$1||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0?2:0,_eventTypes=Observer.eventTypes=("ontouchstart"in _docEl$2?"touchstart,touchmove,touchcancel,touchend":"onpointerdown"in _docEl$2?"pointerdown,pointermove,pointercancel,pointerup":"mousedown,mousemove,mouseup,mouseup").split(","),setTimeout(function(){return _startup$1=0},500),_setScrollTrigger(),_coreInitted$2=1),_coreInitted$2};_horizontal.op=_vertical;_scrollers.cache=0;var Observer=function(){function r(n){this.init(n)}var a=r.prototype;return a.init=function(o){_coreInitted$2||_initCore$1(gsap$2)||console.warn("Please gsap.registerPlugin(Observer)"),ScrollTrigger$2||_setScrollTrigger();var f=o.tolerance,y=o.dragMinimum,x=o.type,b=o.target,_=o.lineHeight,S=o.debounce,A=o.preventDefault,C=o.onStop,P=o.onStopDelay,T=o.ignore,M=o.wheelSpeed,O=o.event,I=o.onDragStart,D=o.onDragEnd,z=o.onDrag,k=o.onPress,L=o.onRelease,R=o.onRight,F=o.onLeft,B=o.onUp,N=o.onDown,j=o.onChangeX,G=o.onChangeY,Y=o.onChange,X=o.onToggleX,$=o.onToggleY,te=o.onHover,ee=o.onHoverEnd,q=o.onMove,Z=o.ignoreCheck,U=o.isNormalizer,W=o.onGestureStart,H=o.onGestureEnd,K=o.onWheel,le=o.onEnable,me=o.onDisable,ne=o.onClick,pe=o.scrollSpeed,ge=o.capture,ye=o.allowClicks,_e=o.lockAxis,ve=o.onLockAxis;this.target=b=_getTarget(b)||_docEl$2,this.vars=o,T&&(T=gsap$2.utils.toArray(T)),f=f||1e-9,y=y||0,M=M||1,pe=pe||1,x=x||"wheel,touch,pointer",S=S!==!1,_||(_=parseFloat(_win$1.getComputedStyle(_body$2).lineHeight)||22);var Ee,xe,Me,Pe,be,Oe,Be,oe=this,De=0,ze=0,Ne=o.passive||!A&&o.passive!==!1,Le=_getScrollFunc(b,_horizontal),bt=_getScrollFunc(b,_vertical),Ve=Le(),He=bt(),tt=~x.indexOf("touch")&&!~x.indexOf("pointer")&&_eventTypes[0]==="pointerdown",ie=_isViewport$1(b),We=b.ownerDocument||_doc$1,wt=[0,0,0],Nt=[0,0,0],Ot=0,ui=function(){return Ot=_getTime$1()},nt=function(Ye,kt){return(oe.event=Ye)&&T&&_isWithin(Ye.target,T)||kt&&tt&&Ye.pointerType!=="touch"||Z&&Z(Ye,kt)},Rs=function(){oe._vx.reset(),oe._vy.reset(),xe.pause(),C&&C(oe)},er=function(){var Ye=oe.deltaX=_getAbsoluteMax(wt),kt=oe.deltaY=_getAbsoluteMax(Nt),Re=Math.abs(Ye)>=f,ft=Math.abs(kt)>=f;Y&&(Re||ft)&&Y(oe,Ye,kt,wt,Nt),Re&&(R&&oe.deltaX>0&&R(oe),F&&oe.deltaX<0&&F(oe),j&&j(oe),X&&oe.deltaX<0!=De<0&&X(oe),De=oe.deltaX,wt[0]=wt[1]=wt[2]=0),ft&&(N&&oe.deltaY>0&&N(oe),B&&oe.deltaY<0&&B(oe),G&&G(oe),$&&oe.deltaY<0!=ze<0&&$(oe),ze=oe.deltaY,Nt[0]=Nt[1]=Nt[2]=0),(Pe||Me)&&(q&&q(oe),Me&&(I&&Me===1&&I(oe),z&&z(oe),Me=0),Pe=!1),Oe&&!(Oe=!1)&&ve&&ve(oe),be&&(K(oe),be=!1),Ee=0},is=function(Ye,kt,Re){wt[Re]+=Ye,Nt[Re]+=kt,oe._vx.update(Ye),oe._vy.update(kt),S?Ee||(Ee=requestAnimationFrame(er)):er()},zt=function(Ye,kt){_e&&!Be&&(oe.axis=Be=Math.abs(Ye)>Math.abs(kt)?"x":"y",Oe=!0),Be!=="y"&&(wt[2]+=Ye,oe._vx.update(Ye,!0)),Be!=="x"&&(Nt[2]+=kt,oe._vy.update(kt,!0)),S?Ee||(Ee=requestAnimationFrame(er)):er()},zr=function(Ye){if(!nt(Ye,1)){Ye=_getEvent(Ye,A);var kt=Ye.clientX,Re=Ye.clientY,ft=kt-oe.x,je=Re-oe.y,ot=oe.isDragging;oe.x=kt,oe.y=Re,(ot||(ft||je)&&(Math.abs(oe.startX-kt)>=y||Math.abs(oe.startY-Re)>=y))&&(Me=ot?2:1,ot||(oe.isDragging=!0),zt(ft,je))}},Lr=oe.onPress=function(vt){nt(vt,1)||vt&&vt.button||(oe.axis=Be=null,xe.pause(),oe.isPressed=!0,vt=_getEvent(vt),De=ze=0,oe.startX=oe.x=vt.clientX,oe.startY=oe.y=vt.clientY,oe._vx.reset(),oe._vy.reset(),_addListener$1(U?b:We,_eventTypes[1],zr,Ne,!0),oe.deltaX=oe.deltaY=0,k&&k(oe))},st=oe.onRelease=function(vt){if(!nt(vt,1)){_removeListener$1(U?b:We,_eventTypes[1],zr,!0);var Ye=!isNaN(oe.y-oe.startY),kt=oe.isDragging,Re=kt&&(Math.abs(oe.x-oe.startX)>3||Math.abs(oe.y-oe.startY)>3),ft=_getEvent(vt);!Re&&Ye&&(oe._vx.reset(),oe._vy.reset(),A&&ye&&gsap$2.delayedCall(.08,function(){if(_getTime$1()-Ot>300&&!vt.defaultPrevented){if(vt.target.click)vt.target.click();else if(We.createEvent){var je=We.createEvent("MouseEvents");je.initMouseEvent("click",!0,!0,_win$1,1,ft.screenX,ft.screenY,ft.clientX,ft.clientY,!1,!1,!1,!1,0,null),vt.target.dispatchEvent(je)}}})),oe.isDragging=oe.isGesturing=oe.isPressed=!1,C&&kt&&!U&&xe.restart(!0),Me&&er(),D&&kt&&D(oe),L&&L(oe,Re)}},Cr=function(Ye){return Ye.touches&&Ye.touches.length>1&&(oe.isGesturing=!0)&&W(Ye,oe.isDragging)},Rt=function(){return(oe.isGesturing=!1)||H(oe)},Ei=function(Ye){if(!nt(Ye)){var kt=Le(),Re=bt();is((kt-Ve)*pe,(Re-He)*pe,1),Ve=kt,He=Re,C&&xe.restart(!0)}},Bi=function(Ye){if(!nt(Ye)){Ye=_getEvent(Ye,A),K&&(be=!0);var kt=(Ye.deltaMode===1?_:Ye.deltaMode===2?_win$1.innerHeight:1)*M;is(Ye.deltaX*kt,Ye.deltaY*kt,0),C&&!U&&xe.restart(!0)}},Pr=function(Ye){if(!nt(Ye)){var kt=Ye.clientX,Re=Ye.clientY,ft=kt-oe.x,je=Re-oe.y;oe.x=kt,oe.y=Re,Pe=!0,C&&xe.restart(!0),(ft||je)&&zt(ft,je)}},ps=function(Ye){oe.event=Ye,te(oe)},rs=function(Ye){oe.event=Ye,ee(oe)},Us=function(Ye){return nt(Ye)||_getEvent(Ye,A)&&ne(oe)};xe=oe._dc=gsap$2.delayedCall(P||.25,Rs).pause(),oe.deltaX=oe.deltaY=0,oe._vx=_getVelocityProp(0,50,!0),oe._vy=_getVelocityProp(0,50,!0),oe.scrollX=Le,oe.scrollY=bt,oe.isDragging=oe.isGesturing=oe.isPressed=!1,_context$1(this),oe.enable=function(vt){return oe.isEnabled||(_addListener$1(ie?We:b,"scroll",_onScroll$1),x.indexOf("scroll")>=0&&_addListener$1(ie?We:b,"scroll",Ei,Ne,ge),x.indexOf("wheel")>=0&&_addListener$1(b,"wheel",Bi,Ne,ge),(x.indexOf("touch")>=0&&_isTouch||x.indexOf("pointer")>=0)&&(_addListener$1(b,_eventTypes[0],Lr,Ne,ge),_addListener$1(We,_eventTypes[2],st),_addListener$1(We,_eventTypes[3],st),ye&&_addListener$1(b,"click",ui,!0,!0),ne&&_addListener$1(b,"click",Us),W&&_addListener$1(We,"gesturestart",Cr),H&&_addListener$1(We,"gestureend",Rt),te&&_addListener$1(b,_pointerType+"enter",ps),ee&&_addListener$1(b,_pointerType+"leave",rs),q&&_addListener$1(b,_pointerType+"move",Pr)),oe.isEnabled=!0,oe.isDragging=oe.isGesturing=oe.isPressed=Pe=Me=!1,oe._vx.reset(),oe._vy.reset(),Ve=Le(),He=bt(),vt&&vt.type&&Lr(vt),le&&le(oe)),oe},oe.disable=function(){oe.isEnabled&&(_observers.filter(function(vt){return vt!==oe&&_isViewport$1(vt.target)}).length||_removeListener$1(ie?We:b,"scroll",_onScroll$1),oe.isPressed&&(oe._vx.reset(),oe._vy.reset(),_removeListener$1(U?b:We,_eventTypes[1],zr,!0)),_removeListener$1(ie?We:b,"scroll",Ei,ge),_removeListener$1(b,"wheel",Bi,ge),_removeListener$1(b,_eventTypes[0],Lr,ge),_removeListener$1(We,_eventTypes[2],st),_removeListener$1(We,_eventTypes[3],st),_removeListener$1(b,"click",ui,!0),_removeListener$1(b,"click",Us),_removeListener$1(We,"gesturestart",Cr),_removeListener$1(We,"gestureend",Rt),_removeListener$1(b,_pointerType+"enter",ps),_removeListener$1(b,_pointerType+"leave",rs),_removeListener$1(b,_pointerType+"move",Pr),oe.isEnabled=oe.isPressed=oe.isDragging=!1,me&&me(oe))},oe.kill=oe.revert=function(){oe.disable();var vt=_observers.indexOf(oe);vt>=0&&_observers.splice(vt,1),_normalizer$1===oe&&(_normalizer$1=0)},_observers.push(oe),U&&_isViewport$1(b)&&(_normalizer$1=oe),oe.enable(O)},_createClass(r,[{key:"velocityX",get:function(){return this._vx.getVelocity()}},{key:"velocityY",get:function(){return this._vy.getVelocity()}}]),r}();Observer.version="3.13.0";Observer.create=function(r){return new Observer(r)};Observer.register=_initCore$1;Observer.getAll=function(){return _observers.slice()};Observer.getById=function(r){return _observers.filter(function(a){return a.vars.id===r})[0]};_getGSAP$2()&&gsap$2.registerPlugin(Observer);/*!
 * ScrollTrigger 3.13.0
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var gsap$1,_coreInitted$1,_win,_doc,_docEl$1,_body$1,_root,_resizeDelay,_toArray$1,_clamp,_time2,_syncInterval,_refreshing,_pointerIsDown,_transformProp,_i,_prevWidth,_prevHeight,_autoRefresh,_sort,_suppressOverwrites,_ignoreResize,_normalizer,_ignoreMobileResize,_baseScreenHeight,_baseScreenWidth,_fixIOSBug,_context,_scrollRestoration,_div100vh,_100vh,_isReverted,_clampingMax,_limitCallbacks,_startup=1,_getTime=Date.now,_time1=_getTime(),_lastScrollTime=0,_enabled=0,_parseClamp=function(a,n,o){var f=_isString$1(a)&&(a.substr(0,6)==="clamp("||a.indexOf("max")>-1);return o["_"+n+"Clamp"]=f,f?a.substr(6,a.length-7):a},_keepClamp=function(a,n){return n&&(!_isString$1(a)||a.substr(0,6)!=="clamp(")?"clamp("+a+")":a},_rafBugFix=function r(){return _enabled&&requestAnimationFrame(r)},_pointerDownHandler=function(){return _pointerIsDown=1},_pointerUpHandler=function(){return _pointerIsDown=0},_passThrough=function(a){return a},_round=function(a){return Math.round(a*1e5)/1e5||0},_windowExists$1=function(){return typeof window<"u"},_getGSAP$1=function(){return gsap$1||_windowExists$1()&&(gsap$1=window.gsap)&&gsap$1.registerPlugin&&gsap$1},_isViewport=function(a){return!!~_root.indexOf(a)},_getViewportDimension=function(a){return(a==="Height"?_100vh:_win["inner"+a])||_docEl$1["client"+a]||_body$1["client"+a]},_getBoundsFunc=function(a){return _getProxyProp(a,"getBoundingClientRect")||(_isViewport(a)?function(){return _winOffsets.width=_win.innerWidth,_winOffsets.height=_100vh,_winOffsets}:function(){return _getBounds(a)})},_getSizeFunc=function(a,n,o){var f=o.d,y=o.d2,x=o.a;return(x=_getProxyProp(a,"getBoundingClientRect"))?function(){return x()[f]}:function(){return(n?_getViewportDimension(y):a["client"+y])||0}},_getOffsetsFunc=function(a,n){return!n||~_proxies.indexOf(a)?_getBoundsFunc(a):function(){return _winOffsets}},_maxScroll=function(a,n){var o=n.s,f=n.d2,y=n.d,x=n.a;return Math.max(0,(o="scroll"+f)&&(x=_getProxyProp(a,o))?x()-_getBoundsFunc(a)()[y]:_isViewport(a)?(_docEl$1[o]||_body$1[o])-_getViewportDimension(f):a[o]-a["offset"+f])},_iterateAutoRefresh=function(a,n){for(var o=0;o<_autoRefresh.length;o+=3)(!n||~n.indexOf(_autoRefresh[o+1]))&&a(_autoRefresh[o],_autoRefresh[o+1],_autoRefresh[o+2])},_isString$1=function(a){return typeof a=="string"},_isFunction$1=function(a){return typeof a=="function"},_isNumber=function(a){return typeof a=="number"},_isObject=function(a){return typeof a=="object"},_endAnimation=function(a,n,o){return a&&a.progress(n?0:1)&&o&&a.pause()},_callback=function(a,n){if(a.enabled){var o=a._ctx?a._ctx.add(function(){return n(a)}):n(a);o&&o.totalTime&&(a.callbackAnimation=o)}},_abs=Math.abs,_left="left",_top="top",_right="right",_bottom="bottom",_width="width",_height="height",_Right="Right",_Left="Left",_Top="Top",_Bottom="Bottom",_padding="padding",_margin="margin",_Width="Width",_Height="Height",_px="px",_getComputedStyle=function(a){return _win.getComputedStyle(a)},_makePositionable=function(a){var n=_getComputedStyle(a).position;a.style.position=n==="absolute"||n==="fixed"?n:"relative"},_setDefaults=function(a,n){for(var o in n)o in a||(a[o]=n[o]);return a},_getBounds=function(a,n){var o=n&&_getComputedStyle(a)[_transformProp]!=="matrix(1, 0, 0, 1, 0, 0)"&&gsap$1.to(a,{x:0,y:0,xPercent:0,yPercent:0,rotation:0,rotationX:0,rotationY:0,scale:1,skewX:0,skewY:0}).progress(1),f=a.getBoundingClientRect();return o&&o.progress(0).kill(),f},_getSize=function(a,n){var o=n.d2;return a["offset"+o]||a["client"+o]||0},_getLabelRatioArray=function(a){var n=[],o=a.labels,f=a.duration(),y;for(y in o)n.push(o[y]/f);return n},_getClosestLabel=function(a){return function(n){return gsap$1.utils.snap(_getLabelRatioArray(a),n)}},_snapDirectional=function(a){var n=gsap$1.utils.snap(a),o=Array.isArray(a)&&a.slice(0).sort(function(f,y){return f-y});return o?function(f,y,x){x===void 0&&(x=.001);var b;if(!y)return n(f);if(y>0){for(f-=x,b=0;b<o.length;b++)if(o[b]>=f)return o[b];return o[b-1]}else for(b=o.length,f+=x;b--;)if(o[b]<=f)return o[b];return o[0]}:function(f,y,x){x===void 0&&(x=.001);var b=n(f);return!y||Math.abs(b-f)<x||b-f<0==y<0?b:n(y<0?f-a:f+a)}},_getLabelAtDirection=function(a){return function(n,o){return _snapDirectional(_getLabelRatioArray(a))(n,o.direction)}},_multiListener=function(a,n,o,f){return o.split(",").forEach(function(y){return a(n,y,f)})},_addListener=function(a,n,o,f,y){return a.addEventListener(n,o,{passive:!f,capture:!!y})},_removeListener=function(a,n,o,f){return a.removeEventListener(n,o,!!f)},_wheelListener=function(a,n,o){o=o&&o.wheelHandler,o&&(a(n,"wheel",o),a(n,"touchmove",o))},_markerDefaults={startColor:"green",endColor:"red",indent:0,fontSize:"16px",fontWeight:"normal"},_defaults={toggleActions:"play",anticipatePin:0},_keywords={top:0,left:0,center:.5,bottom:1,right:1},_offsetToPx=function(a,n){if(_isString$1(a)){var o=a.indexOf("="),f=~o?+(a.charAt(o-1)+1)*parseFloat(a.substr(o+1)):0;~o&&(a.indexOf("%")>o&&(f*=n/100),a=a.substr(0,o-1)),a=f+(a in _keywords?_keywords[a]*n:~a.indexOf("%")?parseFloat(a)*n/100:parseFloat(a)||0)}return a},_createMarker=function(a,n,o,f,y,x,b,_){var S=y.startColor,A=y.endColor,C=y.fontSize,P=y.indent,T=y.fontWeight,M=_doc.createElement("div"),O=_isViewport(o)||_getProxyProp(o,"pinType")==="fixed",I=a.indexOf("scroller")!==-1,D=O?_body$1:o,z=a.indexOf("start")!==-1,k=z?S:A,L="border-color:"+k+";font-size:"+C+";color:"+k+";font-weight:"+T+";pointer-events:none;white-space:nowrap;font-family:sans-serif,Arial;z-index:1000;padding:4px 8px;border-width:0;border-style:solid;";return L+="position:"+((I||_)&&O?"fixed;":"absolute;"),(I||_||!O)&&(L+=(f===_vertical?_right:_bottom)+":"+(x+parseFloat(P))+"px;"),b&&(L+="box-sizing:border-box;text-align:left;width:"+b.offsetWidth+"px;"),M._isStart=z,M.setAttribute("class","gsap-marker-"+a+(n?" marker-"+n:"")),M.style.cssText=L,M.innerText=n||n===0?a+"-"+n:a,D.children[0]?D.insertBefore(M,D.children[0]):D.appendChild(M),M._offset=M["offset"+f.op.d2],_positionMarker(M,0,f,z),M},_positionMarker=function(a,n,o,f){var y={display:"block"},x=o[f?"os2":"p2"],b=o[f?"p2":"os2"];a._isFlipped=f,y[o.a+"Percent"]=f?-100:0,y[o.a]=f?"1px":0,y["border"+x+_Width]=1,y["border"+b+_Width]=0,y[o.p]=n+"px",gsap$1.set(a,y)},_triggers=[],_ids={},_rafID,_sync=function(){return _getTime()-_lastScrollTime>34&&(_rafID||(_rafID=requestAnimationFrame(_updateAll)))},_onScroll=function(){(!_normalizer||!_normalizer.isPressed||_normalizer.startX>_body$1.clientWidth)&&(_scrollers.cache++,_normalizer?_rafID||(_rafID=requestAnimationFrame(_updateAll)):_updateAll(),_lastScrollTime||_dispatch("scrollStart"),_lastScrollTime=_getTime())},_setBaseDimensions=function(){_baseScreenWidth=_win.innerWidth,_baseScreenHeight=_win.innerHeight},_onResize=function(a){_scrollers.cache++,(a===!0||!_refreshing&&!_ignoreResize&&!_doc.fullscreenElement&&!_doc.webkitFullscreenElement&&(!_ignoreMobileResize||_baseScreenWidth!==_win.innerWidth||Math.abs(_win.innerHeight-_baseScreenHeight)>_win.innerHeight*.25))&&_resizeDelay.restart(!0)},_listeners={},_emptyArray=[],_softRefresh=function r(){return _removeListener(ScrollTrigger$1,"scrollEnd",r)||_refreshAll(!0)},_dispatch=function(a){return _listeners[a]&&_listeners[a].map(function(n){return n()})||_emptyArray},_savedStyles=[],_revertRecorded=function(a){for(var n=0;n<_savedStyles.length;n+=5)(!a||_savedStyles[n+4]&&_savedStyles[n+4].query===a)&&(_savedStyles[n].style.cssText=_savedStyles[n+1],_savedStyles[n].getBBox&&_savedStyles[n].setAttribute("transform",_savedStyles[n+2]||""),_savedStyles[n+3].uncache=1)},_revertAll=function(a,n){var o;for(_i=0;_i<_triggers.length;_i++)o=_triggers[_i],o&&(!n||o._ctx===n)&&(a?o.kill(1):o.revert(!0,!0));_isReverted=!0,n&&_revertRecorded(n),n||_dispatch("revert")},_clearScrollMemory=function(a,n){_scrollers.cache++,(n||!_refreshingAll)&&_scrollers.forEach(function(o){return _isFunction$1(o)&&o.cacheID++&&(o.rec=0)}),_isString$1(a)&&(_win.history.scrollRestoration=_scrollRestoration=a)},_refreshingAll,_refreshID=0,_queueRefreshID,_queueRefreshAll=function(){if(_queueRefreshID!==_refreshID){var a=_queueRefreshID=_refreshID;requestAnimationFrame(function(){return a===_refreshID&&_refreshAll(!0)})}},_refresh100vh=function(){_body$1.appendChild(_div100vh),_100vh=!_normalizer&&_div100vh.offsetHeight||_win.innerHeight,_body$1.removeChild(_div100vh)},_hideAllMarkers=function(a){return _toArray$1(".gsap-marker-start, .gsap-marker-end, .gsap-marker-scroller-start, .gsap-marker-scroller-end").forEach(function(n){return n.style.display=a?"none":"block"})},_refreshAll=function(a,n){if(_docEl$1=_doc.documentElement,_body$1=_doc.body,_root=[_win,_doc,_docEl$1,_body$1],_lastScrollTime&&!a&&!_isReverted){_addListener(ScrollTrigger$1,"scrollEnd",_softRefresh);return}_refresh100vh(),_refreshingAll=ScrollTrigger$1.isRefreshing=!0,_scrollers.forEach(function(f){return _isFunction$1(f)&&++f.cacheID&&(f.rec=f())});var o=_dispatch("refreshInit");_sort&&ScrollTrigger$1.sort(),n||_revertAll(),_scrollers.forEach(function(f){_isFunction$1(f)&&(f.smooth&&(f.target.style.scrollBehavior="auto"),f(0))}),_triggers.slice(0).forEach(function(f){return f.refresh()}),_isReverted=!1,_triggers.forEach(function(f){if(f._subPinOffset&&f.pin){var y=f.vars.horizontal?"offsetWidth":"offsetHeight",x=f.pin[y];f.revert(!0,1),f.adjustPinSpacing(f.pin[y]-x),f.refresh()}}),_clampingMax=1,_hideAllMarkers(!0),_triggers.forEach(function(f){var y=_maxScroll(f.scroller,f._dir),x=f.vars.end==="max"||f._endClamp&&f.end>y,b=f._startClamp&&f.start>=y;(x||b)&&f.setPositions(b?y-1:f.start,x?Math.max(b?y:f.start+1,y):f.end,!0)}),_hideAllMarkers(!1),_clampingMax=0,o.forEach(function(f){return f&&f.render&&f.render(-1)}),_scrollers.forEach(function(f){_isFunction$1(f)&&(f.smooth&&requestAnimationFrame(function(){return f.target.style.scrollBehavior="smooth"}),f.rec&&f(f.rec))}),_clearScrollMemory(_scrollRestoration,1),_resizeDelay.pause(),_refreshID++,_refreshingAll=2,_updateAll(2),_triggers.forEach(function(f){return _isFunction$1(f.vars.onRefresh)&&f.vars.onRefresh(f)}),_refreshingAll=ScrollTrigger$1.isRefreshing=!1,_dispatch("refresh")},_lastScroll=0,_direction=1,_primary,_updateAll=function(a){if(a===2||!_refreshingAll&&!_isReverted){ScrollTrigger$1.isUpdating=!0,_primary&&_primary.update(0);var n=_triggers.length,o=_getTime(),f=o-_time1>=50,y=n&&_triggers[0].scroll();if(_direction=_lastScroll>y?-1:1,_refreshingAll||(_lastScroll=y),f&&(_lastScrollTime&&!_pointerIsDown&&o-_lastScrollTime>200&&(_lastScrollTime=0,_dispatch("scrollEnd")),_time2=_time1,_time1=o),_direction<0){for(_i=n;_i-- >0;)_triggers[_i]&&_triggers[_i].update(0,f);_direction=1}else for(_i=0;_i<n;_i++)_triggers[_i]&&_triggers[_i].update(0,f);ScrollTrigger$1.isUpdating=!1}_rafID=0},_propNamesToCopy=[_left,_top,_bottom,_right,_margin+_Bottom,_margin+_Right,_margin+_Top,_margin+_Left,"display","flexShrink","float","zIndex","gridColumnStart","gridColumnEnd","gridRowStart","gridRowEnd","gridArea","justifySelf","alignSelf","placeSelf","order"],_stateProps=_propNamesToCopy.concat([_width,_height,"boxSizing","max"+_Width,"max"+_Height,"position",_margin,_padding,_padding+_Top,_padding+_Right,_padding+_Bottom,_padding+_Left]),_swapPinOut=function(a,n,o){_setState(o);var f=a._gsap;if(f.spacerIsNative)_setState(f.spacerState);else if(a._gsap.swappedIn){var y=n.parentNode;y&&(y.insertBefore(a,n),y.removeChild(n))}a._gsap.swappedIn=!1},_swapPinIn=function(a,n,o,f){if(!a._gsap.swappedIn){for(var y=_propNamesToCopy.length,x=n.style,b=a.style,_;y--;)_=_propNamesToCopy[y],x[_]=o[_];x.position=o.position==="absolute"?"absolute":"relative",o.display==="inline"&&(x.display="inline-block"),b[_bottom]=b[_right]="auto",x.flexBasis=o.flexBasis||"auto",x.overflow="visible",x.boxSizing="border-box",x[_width]=_getSize(a,_horizontal)+_px,x[_height]=_getSize(a,_vertical)+_px,x[_padding]=b[_margin]=b[_top]=b[_left]="0",_setState(f),b[_width]=b["max"+_Width]=o[_width],b[_height]=b["max"+_Height]=o[_height],b[_padding]=o[_padding],a.parentNode!==n&&(a.parentNode.insertBefore(n,a),n.appendChild(a)),a._gsap.swappedIn=!0}},_capsExp=/([A-Z])/g,_setState=function(a){if(a){var n=a.t.style,o=a.length,f=0,y,x;for((a.t._gsap||gsap$1.core.getCache(a.t)).uncache=1;f<o;f+=2)x=a[f+1],y=a[f],x?n[y]=x:n[y]&&n.removeProperty(y.replace(_capsExp,"-$1").toLowerCase())}},_getState=function(a){for(var n=_stateProps.length,o=a.style,f=[],y=0;y<n;y++)f.push(_stateProps[y],o[_stateProps[y]]);return f.t=a,f},_copyState=function(a,n,o){for(var f=[],y=a.length,x=o?8:0,b;x<y;x+=2)b=a[x],f.push(b,b in n?n[b]:a[x+1]);return f.t=a.t,f},_winOffsets={left:0,top:0},_parsePosition=function(a,n,o,f,y,x,b,_,S,A,C,P,T,M){_isFunction$1(a)&&(a=a(_)),_isString$1(a)&&a.substr(0,3)==="max"&&(a=P+(a.charAt(4)==="="?_offsetToPx("0"+a.substr(3),o):0));var O=T?T.time():0,I,D,z;if(T&&T.seek(0),isNaN(a)||(a=+a),_isNumber(a))T&&(a=gsap$1.utils.mapRange(T.scrollTrigger.start,T.scrollTrigger.end,0,P,a)),b&&_positionMarker(b,o,f,!0);else{_isFunction$1(n)&&(n=n(_));var k=(a||"0").split(" "),L,R,F,B;z=_getTarget(n,_)||_body$1,L=_getBounds(z)||{},(!L||!L.left&&!L.top)&&_getComputedStyle(z).display==="none"&&(B=z.style.display,z.style.display="block",L=_getBounds(z),B?z.style.display=B:z.style.removeProperty("display")),R=_offsetToPx(k[0],L[f.d]),F=_offsetToPx(k[1]||"0",o),a=L[f.p]-S[f.p]-A+R+y-F,b&&_positionMarker(b,F,f,o-F<20||b._isStart&&F>20),o-=o-F}if(M&&(_[M]=a||-.001,a<0&&(a=0)),x){var N=a+o,j=x._isStart;I="scroll"+f.d2,_positionMarker(x,N,f,j&&N>20||!j&&(C?Math.max(_body$1[I],_docEl$1[I]):x.parentNode[I])<=N+1),C&&(S=_getBounds(b),C&&(x.style[f.op.p]=S[f.op.p]-f.op.m-x._offset+_px))}return T&&z&&(I=_getBounds(z),T.seek(P),D=_getBounds(z),T._caScrollDist=I[f.p]-D[f.p],a=a/T._caScrollDist*P),T&&T.seek(O),T?a:Math.round(a)},_prefixExp=/(webkit|moz|length|cssText|inset)/i,_reparent=function(a,n,o,f){if(a.parentNode!==n){var y=a.style,x,b;if(n===_body$1){a._stOrig=y.cssText,b=_getComputedStyle(a);for(x in b)!+x&&!_prefixExp.test(x)&&b[x]&&typeof y[x]=="string"&&x!=="0"&&(y[x]=b[x]);y.top=o,y.left=f}else y.cssText=a._stOrig;gsap$1.core.getCache(a).uncache=1,n.appendChild(a)}},_interruptionTracker=function(a,n,o){var f=n,y=f;return function(x){var b=Math.round(a());return b!==f&&b!==y&&Math.abs(b-f)>3&&Math.abs(b-y)>3&&(x=b,o&&o()),y=f,f=Math.round(x),f}},_shiftMarker=function(a,n,o){var f={};f[n.p]="+="+o,gsap$1.set(a,f)},_getTweenCreator=function(a,n){var o=_getScrollFunc(a,n),f="_scroll"+n.p2,y=function x(b,_,S,A,C){var P=x.tween,T=_.onComplete,M={};S=S||o();var O=_interruptionTracker(o,S,function(){P.kill(),x.tween=0});return C=A&&C||0,A=A||b-S,P&&P.kill(),_[f]=b,_.inherit=!1,_.modifiers=M,M[f]=function(){return O(S+A*P.ratio+C*P.ratio*P.ratio)},_.onUpdate=function(){_scrollers.cache++,x.tween&&_updateAll()},_.onComplete=function(){x.tween=0,T&&T.call(P)},P=x.tween=gsap$1.to(a,_),P};return a[f]=o,o.wheelHandler=function(){return y.tween&&y.tween.kill()&&(y.tween=0)},_addListener(a,"wheel",o.wheelHandler),ScrollTrigger$1.isTouch&&_addListener(a,"touchmove",o.wheelHandler),y},ScrollTrigger$1=function(){function r(n,o){_coreInitted$1||r.register(gsap$1)||console.warn("Please gsap.registerPlugin(ScrollTrigger)"),_context(this),this.init(n,o)}var a=r.prototype;return a.init=function(o,f){if(this.progress=this.start=0,this.vars&&this.kill(!0,!0),!_enabled){this.update=this.refresh=this.kill=_passThrough;return}o=_setDefaults(_isString$1(o)||_isNumber(o)||o.nodeType?{trigger:o}:o,_defaults);var y=o,x=y.onUpdate,b=y.toggleClass,_=y.id,S=y.onToggle,A=y.onRefresh,C=y.scrub,P=y.trigger,T=y.pin,M=y.pinSpacing,O=y.invalidateOnRefresh,I=y.anticipatePin,D=y.onScrubComplete,z=y.onSnapComplete,k=y.once,L=y.snap,R=y.pinReparent,F=y.pinSpacer,B=y.containerAnimation,N=y.fastScrollEnd,j=y.preventOverlaps,G=o.horizontal||o.containerAnimation&&o.horizontal!==!1?_horizontal:_vertical,Y=!C&&C!==0,X=_getTarget(o.scroller||_win),$=gsap$1.core.getCache(X),te=_isViewport(X),ee=("pinType"in o?o.pinType:_getProxyProp(X,"pinType")||te&&"fixed")==="fixed",q=[o.onEnter,o.onLeave,o.onEnterBack,o.onLeaveBack],Z=Y&&o.toggleActions.split(" "),U="markers"in o?o.markers:_defaults.markers,W=te?0:parseFloat(_getComputedStyle(X)["border"+G.p2+_Width])||0,H=this,K=o.onRefreshInit&&function(){return o.onRefreshInit(H)},le=_getSizeFunc(X,te,G),me=_getOffsetsFunc(X,te),ne=0,pe=0,ge=0,ye=_getScrollFunc(X,G),_e,ve,Ee,xe,Me,Pe,be,Oe,Be,oe,De,ze,Ne,Le,bt,Ve,He,tt,ie,We,wt,Nt,Ot,ui,nt,Rs,er,is,zt,zr,Lr,st,Cr,Rt,Ei,Bi,Pr,ps,rs;if(H._startClamp=H._endClamp=!1,H._dir=G,I*=45,H.scroller=X,H.scroll=B?B.time.bind(B):ye,xe=ye(),H.vars=o,f=f||o.animation,"refreshPriority"in o&&(_sort=1,o.refreshPriority===-9999&&(_primary=H)),$.tweenScroll=$.tweenScroll||{top:_getTweenCreator(X,_vertical),left:_getTweenCreator(X,_horizontal)},H.tweenTo=_e=$.tweenScroll[G.p],H.scrubDuration=function(Re){Cr=_isNumber(Re)&&Re,Cr?st?st.duration(Re):st=gsap$1.to(f,{ease:"expo",totalProgress:"+=0",inherit:!1,duration:Cr,paused:!0,onComplete:function(){return D&&D(H)}}):(st&&st.progress(1).kill(),st=0)},f&&(f.vars.lazy=!1,f._initted&&!H.isReverted||f.vars.immediateRender!==!1&&o.immediateRender!==!1&&f.duration()&&f.render(0,!0,!0),H.animation=f.pause(),f.scrollTrigger=H,H.scrubDuration(C),zr=0,_||(_=f.vars.id)),L&&((!_isObject(L)||L.push)&&(L={snapTo:L}),"scrollBehavior"in _body$1.style&&gsap$1.set(te?[_body$1,_docEl$1]:X,{scrollBehavior:"auto"}),_scrollers.forEach(function(Re){return _isFunction$1(Re)&&Re.target===(te?_doc.scrollingElement||_docEl$1:X)&&(Re.smooth=!1)}),Ee=_isFunction$1(L.snapTo)?L.snapTo:L.snapTo==="labels"?_getClosestLabel(f):L.snapTo==="labelsDirectional"?_getLabelAtDirection(f):L.directional!==!1?function(Re,ft){return _snapDirectional(L.snapTo)(Re,_getTime()-pe<500?0:ft.direction)}:gsap$1.utils.snap(L.snapTo),Rt=L.duration||{min:.1,max:2},Rt=_isObject(Rt)?_clamp(Rt.min,Rt.max):_clamp(Rt,Rt),Ei=gsap$1.delayedCall(L.delay||Cr/2||.1,function(){var Re=ye(),ft=_getTime()-pe<500,je=_e.tween;if((ft||Math.abs(H.getVelocity())<10)&&!je&&!_pointerIsDown&&ne!==Re){var ot=(Re-Pe)/Le,di=f&&!Y?f.totalProgress():ot,It=ft?0:(di-Lr)/(_getTime()-_time2)*1e3||0,Kt=gsap$1.utils.clamp(-ot,1-ot,_abs(It/2)*It/.185),Ai=ot+(L.inertia===!1?0:Kt),ai,qt,Bt=L,Vi=Bt.onStart,Dt=Bt.onInterrupt,Fi=Bt.onComplete;if(ai=Ee(Ai,H),_isNumber(ai)||(ai=Ai),qt=Math.max(0,Math.round(Pe+ai*Le)),Re<=be&&Re>=Pe&&qt!==Re){if(je&&!je._initted&&je.data<=_abs(qt-Re))return;L.inertia===!1&&(Kt=ai-ot),_e(qt,{duration:Rt(_abs(Math.max(_abs(Ai-di),_abs(ai-di))*.185/It/.05||0)),ease:L.ease||"power3",data:_abs(qt-Re),onInterrupt:function(){return Ei.restart(!0)&&Dt&&Dt(H)},onComplete:function(){H.update(),ne=ye(),f&&!Y&&(st?st.resetTo("totalProgress",ai,f._tTime/f._tDur):f.progress(ai)),zr=Lr=f&&!Y?f.totalProgress():H.progress,z&&z(H),Fi&&Fi(H)}},Re,Kt*Le,qt-Re-Kt*Le),Vi&&Vi(H,_e.tween)}}else H.isActive&&ne!==Re&&Ei.restart(!0)}).pause()),_&&(_ids[_]=H),P=H.trigger=_getTarget(P||T!==!0&&T),rs=P&&P._gsap&&P._gsap.stRevert,rs&&(rs=rs(H)),T=T===!0?P:_getTarget(T),_isString$1(b)&&(b={targets:P,className:b}),T&&(M===!1||M===_margin||(M=!M&&T.parentNode&&T.parentNode.style&&_getComputedStyle(T.parentNode).display==="flex"?!1:_padding),H.pin=T,ve=gsap$1.core.getCache(T),ve.spacer?bt=ve.pinState:(F&&(F=_getTarget(F),F&&!F.nodeType&&(F=F.current||F.nativeElement),ve.spacerIsNative=!!F,F&&(ve.spacerState=_getState(F))),ve.spacer=tt=F||_doc.createElement("div"),tt.classList.add("pin-spacer"),_&&tt.classList.add("pin-spacer-"+_),ve.pinState=bt=_getState(T)),o.force3D!==!1&&gsap$1.set(T,{force3D:!0}),H.spacer=tt=ve.spacer,zt=_getComputedStyle(T),ui=zt[M+G.os2],We=gsap$1.getProperty(T),wt=gsap$1.quickSetter(T,G.a,_px),_swapPinIn(T,tt,zt),He=_getState(T)),U){ze=_isObject(U)?_setDefaults(U,_markerDefaults):_markerDefaults,oe=_createMarker("scroller-start",_,X,G,ze,0),De=_createMarker("scroller-end",_,X,G,ze,0,oe),ie=oe["offset"+G.op.d2];var Us=_getTarget(_getProxyProp(X,"content")||X);Oe=this.markerStart=_createMarker("start",_,Us,G,ze,ie,0,B),Be=this.markerEnd=_createMarker("end",_,Us,G,ze,ie,0,B),B&&(ps=gsap$1.quickSetter([Oe,Be],G.a,_px)),!ee&&!(_proxies.length&&_getProxyProp(X,"fixedMarkers")===!0)&&(_makePositionable(te?_body$1:X),gsap$1.set([oe,De],{force3D:!0}),Rs=gsap$1.quickSetter(oe,G.a,_px),is=gsap$1.quickSetter(De,G.a,_px))}if(B){var vt=B.vars.onUpdate,Ye=B.vars.onUpdateParams;B.eventCallback("onUpdate",function(){H.update(0,0,1),vt&&vt.apply(B,Ye||[])})}if(H.previous=function(){return _triggers[_triggers.indexOf(H)-1]},H.next=function(){return _triggers[_triggers.indexOf(H)+1]},H.revert=function(Re,ft){if(!ft)return H.kill(!0);var je=Re!==!1||!H.enabled,ot=_refreshing;je!==H.isReverted&&(je&&(Bi=Math.max(ye(),H.scroll.rec||0),ge=H.progress,Pr=f&&f.progress()),Oe&&[Oe,Be,oe,De].forEach(function(di){return di.style.display=je?"none":"block"}),je&&(_refreshing=H,H.update(je)),T&&(!R||!H.isActive)&&(je?_swapPinOut(T,tt,bt):_swapPinIn(T,tt,_getComputedStyle(T),nt)),je||H.update(je),_refreshing=ot,H.isReverted=je)},H.refresh=function(Re,ft,je,ot){if(!((_refreshing||!H.enabled)&&!ft)){if(T&&Re&&_lastScrollTime){_addListener(r,"scrollEnd",_softRefresh);return}!_refreshingAll&&K&&K(H),_refreshing=H,_e.tween&&!je&&(_e.tween.kill(),_e.tween=0),st&&st.pause(),O&&f&&(f.revert({kill:!1}).invalidate(),f.getChildren&&f.getChildren(!0,!0,!1).forEach(function(Q){return Q.vars.immediateRender&&Q.render(0,!0,!0)})),H.isReverted||H.revert(!0,!0),H._subPinOffset=!1;var di=le(),It=me(),Kt=B?B.duration():_maxScroll(X,G),Ai=Le<=.01||!Le,ai=0,qt=ot||0,Bt=_isObject(je)?je.end:o.end,Vi=o.endTrigger||P,Dt=_isObject(je)?je.start:o.start||(o.start===0||!P?0:T?"0 0":"0 100%"),Fi=H.pinnedContainer=o.pinnedContainer&&_getTarget(o.pinnedContainer,H),Mi=P&&Math.max(0,_triggers.indexOf(H))||0,mi=Mi,At,wi,os,ta,Si,hi,Ci,Pt,ra,cs,kr,es,J;for(U&&_isObject(je)&&(es=gsap$1.getProperty(oe,G.p),J=gsap$1.getProperty(De,G.p));mi-- >0;)hi=_triggers[mi],hi.end||hi.refresh(0,1)||(_refreshing=H),Ci=hi.pin,Ci&&(Ci===P||Ci===T||Ci===Fi)&&!hi.isReverted&&(cs||(cs=[]),cs.unshift(hi),hi.revert(!0,!0)),hi!==_triggers[mi]&&(Mi--,mi--);for(_isFunction$1(Dt)&&(Dt=Dt(H)),Dt=_parseClamp(Dt,"start",H),Pe=_parsePosition(Dt,P,di,G,ye(),Oe,oe,H,It,W,ee,Kt,B,H._startClamp&&"_startClamp")||(T?-.001:0),_isFunction$1(Bt)&&(Bt=Bt(H)),_isString$1(Bt)&&!Bt.indexOf("+=")&&(~Bt.indexOf(" ")?Bt=(_isString$1(Dt)?Dt.split(" ")[0]:"")+Bt:(ai=_offsetToPx(Bt.substr(2),di),Bt=_isString$1(Dt)?Dt:(B?gsap$1.utils.mapRange(0,B.duration(),B.scrollTrigger.start,B.scrollTrigger.end,Pe):Pe)+ai,Vi=P)),Bt=_parseClamp(Bt,"end",H),be=Math.max(Pe,_parsePosition(Bt||(Vi?"100% 0":Kt),Vi,di,G,ye()+ai,Be,De,H,It,W,ee,Kt,B,H._endClamp&&"_endClamp"))||-.001,ai=0,mi=Mi;mi--;)hi=_triggers[mi],Ci=hi.pin,Ci&&hi.start-hi._pinPush<=Pe&&!B&&hi.end>0&&(At=hi.end-(H._startClamp?Math.max(0,hi.start):hi.start),(Ci===P&&hi.start-hi._pinPush<Pe||Ci===Fi)&&isNaN(Dt)&&(ai+=At*(1-hi.progress)),Ci===T&&(qt+=At));if(Pe+=ai,be+=ai,H._startClamp&&(H._startClamp+=ai),H._endClamp&&!_refreshingAll&&(H._endClamp=be||-.001,be=Math.min(be,_maxScroll(X,G))),Le=be-Pe||(Pe-=.01)&&.001,Ai&&(ge=gsap$1.utils.clamp(0,1,gsap$1.utils.normalize(Pe,be,Bi))),H._pinPush=qt,Oe&&ai&&(At={},At[G.a]="+="+ai,Fi&&(At[G.p]="-="+ye()),gsap$1.set([Oe,Be],At)),T&&!(_clampingMax&&H.end>=_maxScroll(X,G)))At=_getComputedStyle(T),ta=G===_vertical,os=ye(),Nt=parseFloat(We(G.a))+qt,!Kt&&be>1&&(kr=(te?_doc.scrollingElement||_docEl$1:X).style,kr={style:kr,value:kr["overflow"+G.a.toUpperCase()]},te&&_getComputedStyle(_body$1)["overflow"+G.a.toUpperCase()]!=="scroll"&&(kr.style["overflow"+G.a.toUpperCase()]="scroll")),_swapPinIn(T,tt,At),He=_getState(T),wi=_getBounds(T,!0),Pt=ee&&_getScrollFunc(X,ta?_horizontal:_vertical)(),M?(nt=[M+G.os2,Le+qt+_px],nt.t=tt,mi=M===_padding?_getSize(T,G)+Le+qt:0,mi&&(nt.push(G.d,mi+_px),tt.style.flexBasis!=="auto"&&(tt.style.flexBasis=mi+_px)),_setState(nt),Fi&&_triggers.forEach(function(Q){Q.pin===Fi&&Q.vars.pinSpacing!==!1&&(Q._subPinOffset=!0)}),ee&&ye(Bi)):(mi=_getSize(T,G),mi&&tt.style.flexBasis!=="auto"&&(tt.style.flexBasis=mi+_px)),ee&&(Si={top:wi.top+(ta?os-Pe:Pt)+_px,left:wi.left+(ta?Pt:os-Pe)+_px,boxSizing:"border-box",position:"fixed"},Si[_width]=Si["max"+_Width]=Math.ceil(wi.width)+_px,Si[_height]=Si["max"+_Height]=Math.ceil(wi.height)+_px,Si[_margin]=Si[_margin+_Top]=Si[_margin+_Right]=Si[_margin+_Bottom]=Si[_margin+_Left]="0",Si[_padding]=At[_padding],Si[_padding+_Top]=At[_padding+_Top],Si[_padding+_Right]=At[_padding+_Right],Si[_padding+_Bottom]=At[_padding+_Bottom],Si[_padding+_Left]=At[_padding+_Left],Ve=_copyState(bt,Si,R),_refreshingAll&&ye(0)),f?(ra=f._initted,_suppressOverwrites(1),f.render(f.duration(),!0,!0),Ot=We(G.a)-Nt+Le+qt,er=Math.abs(Le-Ot)>1,ee&&er&&Ve.splice(Ve.length-2,2),f.render(0,!0,!0),ra||f.invalidate(!0),f.parent||f.totalTime(f.totalTime()),_suppressOverwrites(0)):Ot=Le,kr&&(kr.value?kr.style["overflow"+G.a.toUpperCase()]=kr.value:kr.style.removeProperty("overflow-"+G.a));else if(P&&ye()&&!B)for(wi=P.parentNode;wi&&wi!==_body$1;)wi._pinOffset&&(Pe-=wi._pinOffset,be-=wi._pinOffset),wi=wi.parentNode;cs&&cs.forEach(function(Q){return Q.revert(!1,!0)}),H.start=Pe,H.end=be,xe=Me=_refreshingAll?Bi:ye(),!B&&!_refreshingAll&&(xe<Bi&&ye(Bi),H.scroll.rec=0),H.revert(!1,!0),pe=_getTime(),Ei&&(ne=-1,Ei.restart(!0)),_refreshing=0,f&&Y&&(f._initted||Pr)&&f.progress()!==Pr&&f.progress(Pr||0,!0).render(f.time(),!0,!0),(Ai||ge!==H.progress||B||O||f&&!f._initted)&&(f&&!Y&&(f._initted||ge||f.vars.immediateRender!==!1)&&f.totalProgress(B&&Pe<-.001&&!ge?gsap$1.utils.normalize(Pe,be,0):ge,!0),H.progress=Ai||(xe-Pe)/Le===ge?0:ge),T&&M&&(tt._pinOffset=Math.round(H.progress*Ot)),st&&st.invalidate(),isNaN(es)||(es-=gsap$1.getProperty(oe,G.p),J-=gsap$1.getProperty(De,G.p),_shiftMarker(oe,G,es),_shiftMarker(Oe,G,es-(ot||0)),_shiftMarker(De,G,J),_shiftMarker(Be,G,J-(ot||0))),Ai&&!_refreshingAll&&H.update(),A&&!_refreshingAll&&!Ne&&(Ne=!0,A(H),Ne=!1)}},H.getVelocity=function(){return(ye()-Me)/(_getTime()-_time2)*1e3||0},H.endAnimation=function(){_endAnimation(H.callbackAnimation),f&&(st?st.progress(1):f.paused()?Y||_endAnimation(f,H.direction<0,1):_endAnimation(f,f.reversed()))},H.labelToScroll=function(Re){return f&&f.labels&&(Pe||H.refresh()||Pe)+f.labels[Re]/f.duration()*Le||0},H.getTrailing=function(Re){var ft=_triggers.indexOf(H),je=H.direction>0?_triggers.slice(0,ft).reverse():_triggers.slice(ft+1);return(_isString$1(Re)?je.filter(function(ot){return ot.vars.preventOverlaps===Re}):je).filter(function(ot){return H.direction>0?ot.end<=Pe:ot.start>=be})},H.update=function(Re,ft,je){if(!(B&&!je&&!Re)){var ot=_refreshingAll===!0?Bi:H.scroll(),di=Re?0:(ot-Pe)/Le,It=di<0?0:di>1?1:di||0,Kt=H.progress,Ai,ai,qt,Bt,Vi,Dt,Fi,Mi;if(ft&&(Me=xe,xe=B?ye():ot,L&&(Lr=zr,zr=f&&!Y?f.totalProgress():It)),I&&T&&!_refreshing&&!_startup&&_lastScrollTime&&(!It&&Pe<ot+(ot-Me)/(_getTime()-_time2)*I?It=1e-4:It===1&&be>ot+(ot-Me)/(_getTime()-_time2)*I&&(It=.9999)),It!==Kt&&H.enabled){if(Ai=H.isActive=!!It&&It<1,ai=!!Kt&&Kt<1,Dt=Ai!==ai,Vi=Dt||!!It!=!!Kt,H.direction=It>Kt?1:-1,H.progress=It,Vi&&!_refreshing&&(qt=It&&!Kt?0:It===1?1:Kt===1?2:3,Y&&(Bt=!Dt&&Z[qt+1]!=="none"&&Z[qt+1]||Z[qt],Mi=f&&(Bt==="complete"||Bt==="reset"||Bt in f))),j&&(Dt||Mi)&&(Mi||C||!f)&&(_isFunction$1(j)?j(H):H.getTrailing(j).forEach(function(os){return os.endAnimation()})),Y||(st&&!_refreshing&&!_startup?(st._dp._time-st._start!==st._time&&st.render(st._dp._time-st._start),st.resetTo?st.resetTo("totalProgress",It,f._tTime/f._tDur):(st.vars.totalProgress=It,st.invalidate().restart())):f&&f.totalProgress(It,!!(_refreshing&&(pe||Re)))),T){if(Re&&M&&(tt.style[M+G.os2]=ui),!ee)wt(_round(Nt+Ot*It));else if(Vi){if(Fi=!Re&&It>Kt&&be+1>ot&&ot+1>=_maxScroll(X,G),R)if(!Re&&(Ai||Fi)){var mi=_getBounds(T,!0),At=ot-Pe;_reparent(T,_body$1,mi.top+(G===_vertical?At:0)+_px,mi.left+(G===_vertical?0:At)+_px)}else _reparent(T,tt);_setState(Ai||Fi?Ve:He),er&&It<1&&Ai||wt(Nt+(It===1&&!Fi?Ot:0))}}L&&!_e.tween&&!_refreshing&&!_startup&&Ei.restart(!0),b&&(Dt||k&&It&&(It<1||!_limitCallbacks))&&_toArray$1(b.targets).forEach(function(os){return os.classList[Ai||k?"add":"remove"](b.className)}),x&&!Y&&!Re&&x(H),Vi&&!_refreshing?(Y&&(Mi&&(Bt==="complete"?f.pause().totalProgress(1):Bt==="reset"?f.restart(!0).pause():Bt==="restart"?f.restart(!0):f[Bt]()),x&&x(H)),(Dt||!_limitCallbacks)&&(S&&Dt&&_callback(H,S),q[qt]&&_callback(H,q[qt]),k&&(It===1?H.kill(!1,1):q[qt]=0),Dt||(qt=It===1?1:3,q[qt]&&_callback(H,q[qt]))),N&&!Ai&&Math.abs(H.getVelocity())>(_isNumber(N)?N:2500)&&(_endAnimation(H.callbackAnimation),st?st.progress(1):_endAnimation(f,Bt==="reverse"?1:!It,1))):Y&&x&&!_refreshing&&x(H)}if(is){var wi=B?ot/B.duration()*(B._caScrollDist||0):ot;Rs(wi+(oe._isFlipped?1:0)),is(wi)}ps&&ps(-ot/B.duration()*(B._caScrollDist||0))}},H.enable=function(Re,ft){H.enabled||(H.enabled=!0,_addListener(X,"resize",_onResize),te||_addListener(X,"scroll",_onScroll),K&&_addListener(r,"refreshInit",K),Re!==!1&&(H.progress=ge=0,xe=Me=ne=ye()),ft!==!1&&H.refresh())},H.getTween=function(Re){return Re&&_e?_e.tween:st},H.setPositions=function(Re,ft,je,ot){if(B){var di=B.scrollTrigger,It=B.duration(),Kt=di.end-di.start;Re=di.start+Kt*Re/It,ft=di.start+Kt*ft/It}H.refresh(!1,!1,{start:_keepClamp(Re,je&&!!H._startClamp),end:_keepClamp(ft,je&&!!H._endClamp)},ot),H.update()},H.adjustPinSpacing=function(Re){if(nt&&Re){var ft=nt.indexOf(G.d)+1;nt[ft]=parseFloat(nt[ft])+Re+_px,nt[1]=parseFloat(nt[1])+Re+_px,_setState(nt)}},H.disable=function(Re,ft){if(H.enabled&&(Re!==!1&&H.revert(!0,!0),H.enabled=H.isActive=!1,ft||st&&st.pause(),Bi=0,ve&&(ve.uncache=1),K&&_removeListener(r,"refreshInit",K),Ei&&(Ei.pause(),_e.tween&&_e.tween.kill()&&(_e.tween=0)),!te)){for(var je=_triggers.length;je--;)if(_triggers[je].scroller===X&&_triggers[je]!==H)return;_removeListener(X,"resize",_onResize),te||_removeListener(X,"scroll",_onScroll)}},H.kill=function(Re,ft){H.disable(Re,ft),st&&!ft&&st.kill(),_&&delete _ids[_];var je=_triggers.indexOf(H);je>=0&&_triggers.splice(je,1),je===_i&&_direction>0&&_i--,je=0,_triggers.forEach(function(ot){return ot.scroller===H.scroller&&(je=1)}),je||_refreshingAll||(H.scroll.rec=0),f&&(f.scrollTrigger=null,Re&&f.revert({kill:!1}),ft||f.kill()),Oe&&[Oe,Be,oe,De].forEach(function(ot){return ot.parentNode&&ot.parentNode.removeChild(ot)}),_primary===H&&(_primary=0),T&&(ve&&(ve.uncache=1),je=0,_triggers.forEach(function(ot){return ot.pin===T&&je++}),je||(ve.spacer=0)),o.onKill&&o.onKill(H)},_triggers.push(H),H.enable(!1,!1),rs&&rs(H),f&&f.add&&!Le){var kt=H.update;H.update=function(){H.update=kt,_scrollers.cache++,Pe||be||H.refresh()},gsap$1.delayedCall(.01,H.update),Le=.01,Pe=be=0}else H.refresh();T&&_queueRefreshAll()},r.register=function(o){return _coreInitted$1||(gsap$1=o||_getGSAP$1(),_windowExists$1()&&window.document&&r.enable(),_coreInitted$1=_enabled),_coreInitted$1},r.defaults=function(o){if(o)for(var f in o)_defaults[f]=o[f];return _defaults},r.disable=function(o,f){_enabled=0,_triggers.forEach(function(x){return x[f?"kill":"disable"](o)}),_removeListener(_win,"wheel",_onScroll),_removeListener(_doc,"scroll",_onScroll),clearInterval(_syncInterval),_removeListener(_doc,"touchcancel",_passThrough),_removeListener(_body$1,"touchstart",_passThrough),_multiListener(_removeListener,_doc,"pointerdown,touchstart,mousedown",_pointerDownHandler),_multiListener(_removeListener,_doc,"pointerup,touchend,mouseup",_pointerUpHandler),_resizeDelay.kill(),_iterateAutoRefresh(_removeListener);for(var y=0;y<_scrollers.length;y+=3)_wheelListener(_removeListener,_scrollers[y],_scrollers[y+1]),_wheelListener(_removeListener,_scrollers[y],_scrollers[y+2])},r.enable=function(){if(_win=window,_doc=document,_docEl$1=_doc.documentElement,_body$1=_doc.body,gsap$1&&(_toArray$1=gsap$1.utils.toArray,_clamp=gsap$1.utils.clamp,_context=gsap$1.core.context||_passThrough,_suppressOverwrites=gsap$1.core.suppressOverwrites||_passThrough,_scrollRestoration=_win.history.scrollRestoration||"auto",_lastScroll=_win.pageYOffset||0,gsap$1.core.globals("ScrollTrigger",r),_body$1)){_enabled=1,_div100vh=document.createElement("div"),_div100vh.style.height="100vh",_div100vh.style.position="absolute",_refresh100vh(),_rafBugFix(),Observer.register(gsap$1),r.isTouch=Observer.isTouch,_fixIOSBug=Observer.isTouch&&/(iPad|iPhone|iPod|Mac)/g.test(navigator.userAgent),_ignoreMobileResize=Observer.isTouch===1,_addListener(_win,"wheel",_onScroll),_root=[_win,_doc,_docEl$1,_body$1],gsap$1.matchMedia?(r.matchMedia=function(S){var A=gsap$1.matchMedia(),C;for(C in S)A.add(C,S[C]);return A},gsap$1.addEventListener("matchMediaInit",function(){return _revertAll()}),gsap$1.addEventListener("matchMediaRevert",function(){return _revertRecorded()}),gsap$1.addEventListener("matchMedia",function(){_refreshAll(0,1),_dispatch("matchMedia")}),gsap$1.matchMedia().add("(orientation: portrait)",function(){return _setBaseDimensions(),_setBaseDimensions})):console.warn("Requires GSAP 3.11.0 or later"),_setBaseDimensions(),_addListener(_doc,"scroll",_onScroll);var o=_body$1.hasAttribute("style"),f=_body$1.style,y=f.borderTopStyle,x=gsap$1.core.Animation.prototype,b,_;for(x.revert||Object.defineProperty(x,"revert",{value:function(){return this.time(-.01,!0)}}),f.borderTopStyle="solid",b=_getBounds(_body$1),_vertical.m=Math.round(b.top+_vertical.sc())||0,_horizontal.m=Math.round(b.left+_horizontal.sc())||0,y?f.borderTopStyle=y:f.removeProperty("border-top-style"),o||(_body$1.setAttribute("style",""),_body$1.removeAttribute("style")),_syncInterval=setInterval(_sync,250),gsap$1.delayedCall(.5,function(){return _startup=0}),_addListener(_doc,"touchcancel",_passThrough),_addListener(_body$1,"touchstart",_passThrough),_multiListener(_addListener,_doc,"pointerdown,touchstart,mousedown",_pointerDownHandler),_multiListener(_addListener,_doc,"pointerup,touchend,mouseup",_pointerUpHandler),_transformProp=gsap$1.utils.checkPrefix("transform"),_stateProps.push(_transformProp),_coreInitted$1=_getTime(),_resizeDelay=gsap$1.delayedCall(.2,_refreshAll).pause(),_autoRefresh=[_doc,"visibilitychange",function(){var S=_win.innerWidth,A=_win.innerHeight;_doc.hidden?(_prevWidth=S,_prevHeight=A):(_prevWidth!==S||_prevHeight!==A)&&_onResize()},_doc,"DOMContentLoaded",_refreshAll,_win,"load",_refreshAll,_win,"resize",_onResize],_iterateAutoRefresh(_addListener),_triggers.forEach(function(S){return S.enable(0,1)}),_=0;_<_scrollers.length;_+=3)_wheelListener(_removeListener,_scrollers[_],_scrollers[_+1]),_wheelListener(_removeListener,_scrollers[_],_scrollers[_+2])}},r.config=function(o){"limitCallbacks"in o&&(_limitCallbacks=!!o.limitCallbacks);var f=o.syncInterval;f&&clearInterval(_syncInterval)||(_syncInterval=f)&&setInterval(_sync,f),"ignoreMobileResize"in o&&(_ignoreMobileResize=r.isTouch===1&&o.ignoreMobileResize),"autoRefreshEvents"in o&&(_iterateAutoRefresh(_removeListener)||_iterateAutoRefresh(_addListener,o.autoRefreshEvents||"none"),_ignoreResize=(o.autoRefreshEvents+"").indexOf("resize")===-1)},r.scrollerProxy=function(o,f){var y=_getTarget(o),x=_scrollers.indexOf(y),b=_isViewport(y);~x&&_scrollers.splice(x,b?6:2),f&&(b?_proxies.unshift(_win,f,_body$1,f,_docEl$1,f):_proxies.unshift(y,f))},r.clearMatchMedia=function(o){_triggers.forEach(function(f){return f._ctx&&f._ctx.query===o&&f._ctx.kill(!0,!0)})},r.isInViewport=function(o,f,y){var x=(_isString$1(o)?_getTarget(o):o).getBoundingClientRect(),b=x[y?_width:_height]*f||0;return y?x.right-b>0&&x.left+b<_win.innerWidth:x.bottom-b>0&&x.top+b<_win.innerHeight},r.positionInViewport=function(o,f,y){_isString$1(o)&&(o=_getTarget(o));var x=o.getBoundingClientRect(),b=x[y?_width:_height],_=f==null?b/2:f in _keywords?_keywords[f]*b:~f.indexOf("%")?parseFloat(f)*b/100:parseFloat(f)||0;return y?(x.left+_)/_win.innerWidth:(x.top+_)/_win.innerHeight},r.killAll=function(o){if(_triggers.slice(0).forEach(function(y){return y.vars.id!=="ScrollSmoother"&&y.kill()}),o!==!0){var f=_listeners.killAll||[];_listeners={},f.forEach(function(y){return y()})}},r}();ScrollTrigger$1.version="3.13.0";ScrollTrigger$1.saveStyles=function(r){return r?_toArray$1(r).forEach(function(a){if(a&&a.style){var n=_savedStyles.indexOf(a);n>=0&&_savedStyles.splice(n,5),_savedStyles.push(a,a.style.cssText,a.getBBox&&a.getAttribute("transform"),gsap$1.core.getCache(a),_context())}}):_savedStyles};ScrollTrigger$1.revert=function(r,a){return _revertAll(!r,a)};ScrollTrigger$1.create=function(r,a){return new ScrollTrigger$1(r,a)};ScrollTrigger$1.refresh=function(r){return r?_onResize(!0):(_coreInitted$1||ScrollTrigger$1.register())&&_refreshAll(!0)};ScrollTrigger$1.update=function(r){return++_scrollers.cache&&_updateAll(r===!0?2:0)};ScrollTrigger$1.clearScrollMemory=_clearScrollMemory;ScrollTrigger$1.maxScroll=function(r,a){return _maxScroll(r,a?_horizontal:_vertical)};ScrollTrigger$1.getScrollFunc=function(r,a){return _getScrollFunc(_getTarget(r),a?_horizontal:_vertical)};ScrollTrigger$1.getById=function(r){return _ids[r]};ScrollTrigger$1.getAll=function(){return _triggers.filter(function(r){return r.vars.id!=="ScrollSmoother"})};ScrollTrigger$1.isScrolling=function(){return!!_lastScrollTime};ScrollTrigger$1.snapDirectional=_snapDirectional;ScrollTrigger$1.addEventListener=function(r,a){var n=_listeners[r]||(_listeners[r]=[]);~n.indexOf(a)||n.push(a)};ScrollTrigger$1.removeEventListener=function(r,a){var n=_listeners[r],o=n&&n.indexOf(a);o>=0&&n.splice(o,1)};ScrollTrigger$1.batch=function(r,a){var n=[],o={},f=a.interval||.016,y=a.batchMax||1e9,x=function(S,A){var C=[],P=[],T=gsap$1.delayedCall(f,function(){A(C,P),C=[],P=[]}).pause();return function(M){C.length||T.restart(!0),C.push(M.trigger),P.push(M),y<=C.length&&T.progress(1)}},b;for(b in a)o[b]=b.substr(0,2)==="on"&&_isFunction$1(a[b])&&b!=="onRefreshInit"?x(b,a[b]):a[b];return _isFunction$1(y)&&(y=y(),_addListener(ScrollTrigger$1,"refresh",function(){return y=a.batchMax()})),_toArray$1(r).forEach(function(_){var S={};for(b in o)S[b]=o[b];S.trigger=_,n.push(ScrollTrigger$1.create(S))}),n};var _clampScrollAndGetDurationMultiplier=function(a,n,o,f){return n>f?a(f):n<0&&a(0),o>f?(f-n)/(o-n):o<0?n/(n-o):1},_allowNativePanning=function r(a,n){n===!0?a.style.removeProperty("touch-action"):a.style.touchAction=n===!0?"auto":n?"pan-"+n+(Observer.isTouch?" pinch-zoom":""):"none",a===_docEl$1&&r(_body$1,n)},_overflow={auto:1,scroll:1},_nestedScroll=function(a){var n=a.event,o=a.target,f=a.axis,y=(n.changedTouches?n.changedTouches[0]:n).target,x=y._gsap||gsap$1.core.getCache(y),b=_getTime(),_;if(!x._isScrollT||b-x._isScrollT>2e3){for(;y&&y!==_body$1&&(y.scrollHeight<=y.clientHeight&&y.scrollWidth<=y.clientWidth||!(_overflow[(_=_getComputedStyle(y)).overflowY]||_overflow[_.overflowX]));)y=y.parentNode;x._isScroll=y&&y!==o&&!_isViewport(y)&&(_overflow[(_=_getComputedStyle(y)).overflowY]||_overflow[_.overflowX]),x._isScrollT=b}(x._isScroll||f==="x")&&(n.stopPropagation(),n._gsapAllow=!0)},_inputObserver=function(a,n,o,f){return Observer.create({target:a,capture:!0,debounce:!1,lockAxis:!0,type:n,onWheel:f=f&&_nestedScroll,onPress:f,onDrag:f,onScroll:f,onEnable:function(){return o&&_addListener(_doc,Observer.eventTypes[0],_captureInputs,!1,!0)},onDisable:function(){return _removeListener(_doc,Observer.eventTypes[0],_captureInputs,!0)}})},_inputExp=/(input|label|select|textarea)/i,_inputIsFocused,_captureInputs=function(a){var n=_inputExp.test(a.target.tagName);(n||_inputIsFocused)&&(a._gsapAllow=!0,_inputIsFocused=n)},_getScrollNormalizer=function(a){_isObject(a)||(a={}),a.preventDefault=a.isNormalizer=a.allowClicks=!0,a.type||(a.type="wheel,touch"),a.debounce=!!a.debounce,a.id=a.id||"normalizer";var n=a,o=n.normalizeScrollX,f=n.momentum,y=n.allowNestedScroll,x=n.onRelease,b,_,S=_getTarget(a.target)||_docEl$1,A=gsap$1.core.globals().ScrollSmoother,C=A&&A.get(),P=_fixIOSBug&&(a.content&&_getTarget(a.content)||C&&a.content!==!1&&!C.smooth()&&C.content()),T=_getScrollFunc(S,_vertical),M=_getScrollFunc(S,_horizontal),O=1,I=(Observer.isTouch&&_win.visualViewport?_win.visualViewport.scale*_win.visualViewport.width:_win.outerWidth)/_win.innerWidth,D=0,z=_isFunction$1(f)?function(){return f(b)}:function(){return f||2.8},k,L,R=_inputObserver(S,a.type,!0,y),F=function(){return L=!1},B=_passThrough,N=_passThrough,j=function(){_=_maxScroll(S,_vertical),N=_clamp(_fixIOSBug?1:0,_),o&&(B=_clamp(0,_maxScroll(S,_horizontal))),k=_refreshID},G=function(){P._gsap.y=_round(parseFloat(P._gsap.y)+T.offset)+"px",P.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+parseFloat(P._gsap.y)+", 0, 1)",T.offset=T.cacheID=0},Y=function(){if(L){requestAnimationFrame(F);var U=_round(b.deltaY/2),W=N(T.v-U);if(P&&W!==T.v+T.offset){T.offset=W-T.v;var H=_round((parseFloat(P&&P._gsap.y)||0)-T.offset);P.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+H+", 0, 1)",P._gsap.y=H+"px",T.cacheID=_scrollers.cache,_updateAll()}return!0}T.offset&&G(),L=!0},X,$,te,ee,q=function(){j(),X.isActive()&&X.vars.scrollY>_&&(T()>_?X.progress(1)&&T(_):X.resetTo("scrollY",_))};return P&&gsap$1.set(P,{y:"+=0"}),a.ignoreCheck=function(Z){return _fixIOSBug&&Z.type==="touchmove"&&Y()||O>1.05&&Z.type!=="touchstart"||b.isGesturing||Z.touches&&Z.touches.length>1},a.onPress=function(){L=!1;var Z=O;O=_round((_win.visualViewport&&_win.visualViewport.scale||1)/I),X.pause(),Z!==O&&_allowNativePanning(S,O>1.01?!0:o?!1:"x"),$=M(),te=T(),j(),k=_refreshID},a.onRelease=a.onGestureStart=function(Z,U){if(T.offset&&G(),!U)ee.restart(!0);else{_scrollers.cache++;var W=z(),H,K;o&&(H=M(),K=H+W*.05*-Z.velocityX/.227,W*=_clampScrollAndGetDurationMultiplier(M,H,K,_maxScroll(S,_horizontal)),X.vars.scrollX=B(K)),H=T(),K=H+W*.05*-Z.velocityY/.227,W*=_clampScrollAndGetDurationMultiplier(T,H,K,_maxScroll(S,_vertical)),X.vars.scrollY=N(K),X.invalidate().duration(W).play(.01),(_fixIOSBug&&X.vars.scrollY>=_||H>=_-1)&&gsap$1.to({},{onUpdate:q,duration:W})}x&&x(Z)},a.onWheel=function(){X._ts&&X.pause(),_getTime()-D>1e3&&(k=0,D=_getTime())},a.onChange=function(Z,U,W,H,K){if(_refreshID!==k&&j(),U&&o&&M(B(H[2]===U?$+(Z.startX-Z.x):M()+U-H[1])),W){T.offset&&G();var le=K[2]===W,me=le?te+Z.startY-Z.y:T()+W-K[1],ne=N(me);le&&me!==ne&&(te+=ne-me),T(ne)}(W||U)&&_updateAll()},a.onEnable=function(){_allowNativePanning(S,o?!1:"x"),ScrollTrigger$1.addEventListener("refresh",q),_addListener(_win,"resize",q),T.smooth&&(T.target.style.scrollBehavior="auto",T.smooth=M.smooth=!1),R.enable()},a.onDisable=function(){_allowNativePanning(S,!0),_removeListener(_win,"resize",q),ScrollTrigger$1.removeEventListener("refresh",q),R.kill()},a.lockAxis=a.lockAxis!==!1,b=new Observer(a),b.iOS=_fixIOSBug,_fixIOSBug&&!T()&&T(1),_fixIOSBug&&gsap$1.ticker.add(_passThrough),ee=b._dc,X=gsap$1.to(b,{ease:"power4",paused:!0,inherit:!1,scrollX:o?"+=0.1":"+=0",scrollY:"+=0.1",modifiers:{scrollY:_interruptionTracker(T,T(),function(){return X.pause()})},onUpdate:_updateAll,onComplete:ee.vars.onComplete}),b};ScrollTrigger$1.sort=function(r){if(_isFunction$1(r))return _triggers.sort(r);var a=_win.pageYOffset||0;return ScrollTrigger$1.getAll().forEach(function(n){return n._sortY=n.trigger?a+n.trigger.getBoundingClientRect().top:n.start+_win.innerHeight}),_triggers.sort(r||function(n,o){return(n.vars.refreshPriority||0)*-1e6+(n.vars.containerAnimation?1e6:n._sortY)-((o.vars.containerAnimation?1e6:o._sortY)+(o.vars.refreshPriority||0)*-1e6)})};ScrollTrigger$1.observe=function(r){return new Observer(r)};ScrollTrigger$1.normalizeScroll=function(r){if(typeof r>"u")return _normalizer;if(r===!0&&_normalizer)return _normalizer.enable();if(r===!1){_normalizer&&_normalizer.kill(),_normalizer=r;return}var a=r instanceof Observer?r:_getScrollNormalizer(r);return _normalizer&&_normalizer.target===a.target&&_normalizer.kill(),_isViewport(a.target)&&(_normalizer=a),a};ScrollTrigger$1.core={_getVelocityProp,_inputObserver,_scrollers,_proxies,bridge:{ss:function(){_lastScrollTime||_dispatch("scrollStart"),_lastScrollTime=_getTime()},ref:function(){return _refreshing}}};_getGSAP$1()&&gsap$1.registerPlugin(ScrollTrigger$1);/*!
 * ScrollToPlugin 3.13.0
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var gsap,_coreInitted,_window,_docEl,_body,_toArray,_config,ScrollTrigger,_windowExists=function(){return typeof window<"u"},_getGSAP=function(){return gsap||_windowExists()&&(gsap=window.gsap)&&gsap.registerPlugin&&gsap},_isString=function(a){return typeof a=="string"},_isFunction=function(a){return typeof a=="function"},_max=function(a,n){var o=n==="x"?"Width":"Height",f="scroll"+o,y="client"+o;return a===_window||a===_docEl||a===_body?Math.max(_docEl[f],_body[f])-(_window["inner"+o]||_docEl[y]||_body[y]):a[f]-a["offset"+o]},_buildGetter=function(a,n){var o="scroll"+(n==="x"?"Left":"Top");return a===_window&&(a.pageXOffset!=null?o="page"+n.toUpperCase()+"Offset":a=_docEl[o]!=null?_docEl:_body),function(){return a[o]}},_clean=function(a,n,o,f){if(_isFunction(a)&&(a=a(n,o,f)),typeof a!="object")return _isString(a)&&a!=="max"&&a.charAt(1)!=="="?{x:a,y:a}:{y:a};if(a.nodeType)return{y:a,x:a};var y={},x;for(x in a)y[x]=x!=="onAutoKill"&&_isFunction(a[x])?a[x](n,o,f):a[x];return y},_getOffset=function(a,n){if(a=_toArray(a)[0],!a||!a.getBoundingClientRect)return console.warn("scrollTo target doesn't exist. Using 0")||{x:0,y:0};var o=a.getBoundingClientRect(),f=!n||n===_window||n===_body,y=f?{top:_docEl.clientTop-(_window.pageYOffset||_docEl.scrollTop||_body.scrollTop||0),left:_docEl.clientLeft-(_window.pageXOffset||_docEl.scrollLeft||_body.scrollLeft||0)}:n.getBoundingClientRect(),x={x:o.left-y.left,y:o.top-y.top};return!f&&n&&(x.x+=_buildGetter(n,"x")(),x.y+=_buildGetter(n,"y")()),x},_parseVal=function(a,n,o,f,y){return!isNaN(a)&&typeof a!="object"?parseFloat(a)-y:_isString(a)&&a.charAt(1)==="="?parseFloat(a.substr(2))*(a.charAt(0)==="-"?-1:1)+f-y:a==="max"?_max(n,o)-y:Math.min(_max(n,o),_getOffset(a,n)[o]-y)},_initCore=function(){gsap=_getGSAP(),_windowExists()&&gsap&&typeof document<"u"&&document.body&&(_window=window,_body=document.body,_docEl=document.documentElement,_toArray=gsap.utils.toArray,gsap.config({autoKillThreshold:7}),_config=gsap.config(),_coreInitted=1)},ScrollToPlugin={version:"3.13.0",name:"scrollTo",rawVars:1,register:function(a){gsap=a,_initCore()},init:function(a,n,o,f,y){_coreInitted||_initCore();var x=this,b=gsap.getProperty(a,"scrollSnapType");x.isWin=a===_window,x.target=a,x.tween=o,n=_clean(n,f,a,y),x.vars=n,x.autoKill=!!("autoKill"in n?n:_config).autoKill,x.getX=_buildGetter(a,"x"),x.getY=_buildGetter(a,"y"),x.x=x.xPrev=x.getX(),x.y=x.yPrev=x.getY(),ScrollTrigger||(ScrollTrigger=gsap.core.globals().ScrollTrigger),gsap.getProperty(a,"scrollBehavior")==="smooth"&&gsap.set(a,{scrollBehavior:"auto"}),b&&b!=="none"&&(x.snap=1,x.snapInline=a.style.scrollSnapType,a.style.scrollSnapType="none"),n.x!=null?(x.add(x,"x",x.x,_parseVal(n.x,a,"x",x.x,n.offsetX||0),f,y),x._props.push("scrollTo_x")):x.skipX=1,n.y!=null?(x.add(x,"y",x.y,_parseVal(n.y,a,"y",x.y,n.offsetY||0),f,y),x._props.push("scrollTo_y")):x.skipY=1},render:function(a,n){for(var o=n._pt,f=n.target,y=n.tween,x=n.autoKill,b=n.xPrev,_=n.yPrev,S=n.isWin,A=n.snap,C=n.snapInline,P,T,M,O,I;o;)o.r(a,o.d),o=o._next;P=S||!n.skipX?n.getX():b,T=S||!n.skipY?n.getY():_,M=T-_,O=P-b,I=_config.autoKillThreshold,n.x<0&&(n.x=0),n.y<0&&(n.y=0),x&&(!n.skipX&&(O>I||O<-I)&&P<_max(f,"x")&&(n.skipX=1),!n.skipY&&(M>I||M<-I)&&T<_max(f,"y")&&(n.skipY=1),n.skipX&&n.skipY&&(y.kill(),n.vars.onAutoKill&&n.vars.onAutoKill.apply(y,n.vars.onAutoKillParams||[]))),S?_window.scrollTo(n.skipX?P:n.x,n.skipY?T:n.y):(n.skipY||(f.scrollTop=n.y),n.skipX||(f.scrollLeft=n.x)),A&&(a===1||a===0)&&(T=f.scrollTop,P=f.scrollLeft,C?f.style.scrollSnapType=C:f.style.removeProperty("scroll-snap-type"),f.scrollTop=T+1,f.scrollLeft=P+1,f.scrollTop=T,f.scrollLeft=P),n.xPrev=n.x,n.yPrev=n.y,ScrollTrigger&&ScrollTrigger.update()},kill:function(a){var n=a==="scrollTo",o=this._props.indexOf(a);return(n||a==="scrollTo_x")&&(this.skipX=1),(n||a==="scrollTo_y")&&(this.skipY=1),o>-1&&this._props.splice(o,1),!this._props.length}};ScrollToPlugin.max=_max;ScrollToPlugin.getOffset=_getOffset;ScrollToPlugin.buildGetter=_buildGetter;ScrollToPlugin.config=function(r){_config||_initCore()||(_config=gsap.config());for(var a in r)_config[a]=r[a]};_getGSAP()&&gsap.registerPlugin(ScrollToPlugin);function getDefaultExportFromCjs(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var lottie$1={exports:{}},lottie=lottie$1.exports,hasRequiredLottie;function requireLottie(){return hasRequiredLottie||(hasRequiredLottie=1,function(module,exports){typeof document<"u"&&typeof navigator<"u"&&function(r,a){module.exports=a()}(lottie,function(){var svgNS="http://www.w3.org/2000/svg",locationHref="",_useWebWorker=!1,initialDefaultFrame=-999999,setWebWorker=function(a){_useWebWorker=!!a},getWebWorker=function(){return _useWebWorker},setLocationHref=function(a){locationHref=a},getLocationHref=function(){return locationHref};function createTag(r){return document.createElement(r)}function extendPrototype(r,a){var n,o=r.length,f;for(n=0;n<o;n+=1){f=r[n].prototype;for(var y in f)Object.prototype.hasOwnProperty.call(f,y)&&(a.prototype[y]=f[y])}}function getDescriptor(r,a){return Object.getOwnPropertyDescriptor(r,a)}function createProxyFunction(r){function a(){}return a.prototype=r,a}var audioControllerFactory=function(){function r(a){this.audios=[],this.audioFactory=a,this._volume=1,this._isMuted=!1}return r.prototype={addAudio:function(n){this.audios.push(n)},pause:function(){var n,o=this.audios.length;for(n=0;n<o;n+=1)this.audios[n].pause()},resume:function(){var n,o=this.audios.length;for(n=0;n<o;n+=1)this.audios[n].resume()},setRate:function(n){var o,f=this.audios.length;for(o=0;o<f;o+=1)this.audios[o].setRate(n)},createAudio:function(n){return this.audioFactory?this.audioFactory(n):window.Howl?new window.Howl({src:[n]}):{isPlaying:!1,play:function(){this.isPlaying=!0},seek:function(){this.isPlaying=!1},playing:function(){},rate:function(){},setVolume:function(){}}},setAudioFactory:function(n){this.audioFactory=n},setVolume:function(n){this._volume=n,this._updateVolume()},mute:function(){this._isMuted=!0,this._updateVolume()},unmute:function(){this._isMuted=!1,this._updateVolume()},getVolume:function(){return this._volume},_updateVolume:function(){var n,o=this.audios.length;for(n=0;n<o;n+=1)this.audios[n].volume(this._volume*(this._isMuted?0:1))}},function(){return new r}}(),createTypedArray=function(){function r(n,o){var f=0,y=[],x;switch(n){case"int16":case"uint8c":x=1;break;default:x=1.1;break}for(f=0;f<o;f+=1)y.push(x);return y}function a(n,o){return n==="float32"?new Float32Array(o):n==="int16"?new Int16Array(o):n==="uint8c"?new Uint8ClampedArray(o):r(n,o)}return typeof Uint8ClampedArray=="function"&&typeof Float32Array=="function"?a:r}();function createSizedArray(r){return Array.apply(null,{length:r})}function _typeof$6(r){"@babel/helpers - typeof";return _typeof$6=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof$6(r)}var subframeEnabled=!0,expressionsPlugin=null,expressionsInterfaces=null,idPrefix$1="",isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),bmPow=Math.pow,bmSqrt=Math.sqrt,bmFloor=Math.floor,bmMax=Math.max,bmMin=Math.min,BMMath={};(function(){var r=["abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","cbrt","expm1","clz32","cos","cosh","exp","floor","fround","hypot","imul","log","log1p","log2","log10","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh","trunc","E","LN10","LN2","LOG10E","LOG2E","PI","SQRT1_2","SQRT2"],a,n=r.length;for(a=0;a<n;a+=1)BMMath[r[a]]=Math[r[a]]})(),BMMath.random=Math.random,BMMath.abs=function(r){var a=_typeof$6(r);if(a==="object"&&r.length){var n=createSizedArray(r.length),o,f=r.length;for(o=0;o<f;o+=1)n[o]=Math.abs(r[o]);return n}return Math.abs(r)};var defaultCurveSegments=150,degToRads=Math.PI/180,roundCorner=.5519;function styleDiv(r){r.style.position="absolute",r.style.top=0,r.style.left=0,r.style.display="block",r.style.transformOrigin="0 0",r.style.webkitTransformOrigin="0 0",r.style.backfaceVisibility="visible",r.style.webkitBackfaceVisibility="visible",r.style.transformStyle="preserve-3d",r.style.webkitTransformStyle="preserve-3d",r.style.mozTransformStyle="preserve-3d"}function BMEnterFrameEvent(r,a,n,o){this.type=r,this.currentTime=a,this.totalTime=n,this.direction=o<0?-1:1}function BMCompleteEvent(r,a){this.type=r,this.direction=a<0?-1:1}function BMCompleteLoopEvent(r,a,n,o){this.type=r,this.currentLoop=n,this.totalLoops=a,this.direction=o<0?-1:1}function BMSegmentStartEvent(r,a,n){this.type=r,this.firstFrame=a,this.totalFrames=n}function BMDestroyEvent(r,a){this.type=r,this.target=a}function BMRenderFrameErrorEvent(r,a){this.type="renderFrameError",this.nativeError=r,this.currentTime=a}function BMConfigErrorEvent(r){this.type="configError",this.nativeError=r}var createElementID=function(){var r=0;return function(){return r+=1,idPrefix$1+"__lottie_element_"+r}}();function HSVtoRGB(r,a,n){var o,f,y,x,b,_,S,A;switch(x=Math.floor(r*6),b=r*6-x,_=n*(1-a),S=n*(1-b*a),A=n*(1-(1-b)*a),x%6){case 0:o=n,f=A,y=_;break;case 1:o=S,f=n,y=_;break;case 2:o=_,f=n,y=A;break;case 3:o=_,f=S,y=n;break;case 4:o=A,f=_,y=n;break;case 5:o=n,f=_,y=S;break}return[o,f,y]}function RGBtoHSV(r,a,n){var o=Math.max(r,a,n),f=Math.min(r,a,n),y=o-f,x,b=o===0?0:y/o,_=o/255;switch(o){case f:x=0;break;case r:x=a-n+y*(a<n?6:0),x/=6*y;break;case a:x=n-r+y*2,x/=6*y;break;case n:x=r-a+y*4,x/=6*y;break}return[x,b,_]}function addSaturationToRGB(r,a){var n=RGBtoHSV(r[0]*255,r[1]*255,r[2]*255);return n[1]+=a,n[1]>1?n[1]=1:n[1]<=0&&(n[1]=0),HSVtoRGB(n[0],n[1],n[2])}function addBrightnessToRGB(r,a){var n=RGBtoHSV(r[0]*255,r[1]*255,r[2]*255);return n[2]+=a,n[2]>1?n[2]=1:n[2]<0&&(n[2]=0),HSVtoRGB(n[0],n[1],n[2])}function addHueToRGB(r,a){var n=RGBtoHSV(r[0]*255,r[1]*255,r[2]*255);return n[0]+=a/360,n[0]>1?n[0]-=1:n[0]<0&&(n[0]+=1),HSVtoRGB(n[0],n[1],n[2])}var rgbToHex=function(){var r=[],a,n;for(a=0;a<256;a+=1)n=a.toString(16),r[a]=n.length===1?"0"+n:n;return function(o,f,y){return o<0&&(o=0),f<0&&(f=0),y<0&&(y=0),"#"+r[o]+r[f]+r[y]}}(),setSubframeEnabled=function(a){subframeEnabled=!!a},getSubframeEnabled=function(){return subframeEnabled},setExpressionsPlugin=function(a){expressionsPlugin=a},getExpressionsPlugin=function(){return expressionsPlugin},setExpressionInterfaces=function(a){expressionsInterfaces=a},getExpressionInterfaces=function(){return expressionsInterfaces},setDefaultCurveSegments=function(a){defaultCurveSegments=a},getDefaultCurveSegments=function(){return defaultCurveSegments},setIdPrefix=function(a){idPrefix$1=a};function createNS(r){return document.createElementNS(svgNS,r)}function _typeof$5(r){"@babel/helpers - typeof";return _typeof$5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof$5(r)}var dataManager=function(){var r=1,a=[],n,o,f={onmessage:function(){},postMessage:function(T){n({data:T})}},y={postMessage:function(T){f.onmessage({data:T})}};function x(P){if(window.Worker&&window.Blob&&getWebWorker()){var T=new Blob(["var _workerSelf = self; self.onmessage = ",P.toString()],{type:"text/javascript"}),M=URL.createObjectURL(T);return new Worker(M)}return n=P,f}function b(){o||(o=x(function(T){function M(){function I(ee,q){var Z,U,W=ee.length,H,K,le,me;for(U=0;U<W;U+=1)if(Z=ee[U],"ks"in Z&&!Z.completed){if(Z.completed=!0,Z.hasMask){var ne=Z.masksProperties;for(K=ne.length,H=0;H<K;H+=1)if(ne[H].pt.k.i)R(ne[H].pt.k);else for(me=ne[H].pt.k.length,le=0;le<me;le+=1)ne[H].pt.k[le].s&&R(ne[H].pt.k[le].s[0]),ne[H].pt.k[le].e&&R(ne[H].pt.k[le].e[0])}Z.ty===0?(Z.layers=k(Z.refId,q),I(Z.layers,q)):Z.ty===4?L(Z.shapes):Z.ty===5&&$(Z)}}function D(ee,q){if(ee){var Z=0,U=ee.length;for(Z=0;Z<U;Z+=1)ee[Z].t===1&&(ee[Z].data.layers=k(ee[Z].data.refId,q),I(ee[Z].data.layers,q))}}function z(ee,q){for(var Z=0,U=q.length;Z<U;){if(q[Z].id===ee)return q[Z];Z+=1}return null}function k(ee,q){var Z=z(ee,q);return Z?Z.layers.__used?JSON.parse(JSON.stringify(Z.layers)):(Z.layers.__used=!0,Z.layers):null}function L(ee){var q,Z=ee.length,U,W;for(q=Z-1;q>=0;q-=1)if(ee[q].ty==="sh")if(ee[q].ks.k.i)R(ee[q].ks.k);else for(W=ee[q].ks.k.length,U=0;U<W;U+=1)ee[q].ks.k[U].s&&R(ee[q].ks.k[U].s[0]),ee[q].ks.k[U].e&&R(ee[q].ks.k[U].e[0]);else ee[q].ty==="gr"&&L(ee[q].it)}function R(ee){var q,Z=ee.i.length;for(q=0;q<Z;q+=1)ee.i[q][0]+=ee.v[q][0],ee.i[q][1]+=ee.v[q][1],ee.o[q][0]+=ee.v[q][0],ee.o[q][1]+=ee.v[q][1]}function F(ee,q){var Z=q?q.split("."):[100,100,100];return ee[0]>Z[0]?!0:Z[0]>ee[0]?!1:ee[1]>Z[1]?!0:Z[1]>ee[1]?!1:ee[2]>Z[2]?!0:Z[2]>ee[2]?!1:null}var B=function(){var ee=[4,4,14];function q(U){var W=U.t.d;U.t.d={k:[{s:W,t:0}]}}function Z(U){var W,H=U.length;for(W=0;W<H;W+=1)U[W].ty===5&&q(U[W])}return function(U){if(F(ee,U.v)&&(Z(U.layers),U.assets)){var W,H=U.assets.length;for(W=0;W<H;W+=1)U.assets[W].layers&&Z(U.assets[W].layers)}}}(),N=function(){var ee=[4,7,99];return function(q){if(q.chars&&!F(ee,q.v)){var Z,U=q.chars.length;for(Z=0;Z<U;Z+=1){var W=q.chars[Z];W.data&&W.data.shapes&&(L(W.data.shapes),W.data.ip=0,W.data.op=99999,W.data.st=0,W.data.sr=1,W.data.ks={p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0}},q.chars[Z].t||(W.data.shapes.push({ty:"no"}),W.data.shapes[0].it.push({p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0},sk:{k:0,a:0},sa:{k:0,a:0},ty:"tr"})))}}}}(),j=function(){var ee=[5,7,15];function q(U){var W=U.t.p;typeof W.a=="number"&&(W.a={a:0,k:W.a}),typeof W.p=="number"&&(W.p={a:0,k:W.p}),typeof W.r=="number"&&(W.r={a:0,k:W.r})}function Z(U){var W,H=U.length;for(W=0;W<H;W+=1)U[W].ty===5&&q(U[W])}return function(U){if(F(ee,U.v)&&(Z(U.layers),U.assets)){var W,H=U.assets.length;for(W=0;W<H;W+=1)U.assets[W].layers&&Z(U.assets[W].layers)}}}(),G=function(){var ee=[4,1,9];function q(U){var W,H=U.length,K,le;for(W=0;W<H;W+=1)if(U[W].ty==="gr")q(U[W].it);else if(U[W].ty==="fl"||U[W].ty==="st")if(U[W].c.k&&U[W].c.k[0].i)for(le=U[W].c.k.length,K=0;K<le;K+=1)U[W].c.k[K].s&&(U[W].c.k[K].s[0]/=255,U[W].c.k[K].s[1]/=255,U[W].c.k[K].s[2]/=255,U[W].c.k[K].s[3]/=255),U[W].c.k[K].e&&(U[W].c.k[K].e[0]/=255,U[W].c.k[K].e[1]/=255,U[W].c.k[K].e[2]/=255,U[W].c.k[K].e[3]/=255);else U[W].c.k[0]/=255,U[W].c.k[1]/=255,U[W].c.k[2]/=255,U[W].c.k[3]/=255}function Z(U){var W,H=U.length;for(W=0;W<H;W+=1)U[W].ty===4&&q(U[W].shapes)}return function(U){if(F(ee,U.v)&&(Z(U.layers),U.assets)){var W,H=U.assets.length;for(W=0;W<H;W+=1)U.assets[W].layers&&Z(U.assets[W].layers)}}}(),Y=function(){var ee=[4,4,18];function q(U){var W,H=U.length,K,le;for(W=H-1;W>=0;W-=1)if(U[W].ty==="sh")if(U[W].ks.k.i)U[W].ks.k.c=U[W].closed;else for(le=U[W].ks.k.length,K=0;K<le;K+=1)U[W].ks.k[K].s&&(U[W].ks.k[K].s[0].c=U[W].closed),U[W].ks.k[K].e&&(U[W].ks.k[K].e[0].c=U[W].closed);else U[W].ty==="gr"&&q(U[W].it)}function Z(U){var W,H,K=U.length,le,me,ne,pe;for(H=0;H<K;H+=1){if(W=U[H],W.hasMask){var ge=W.masksProperties;for(me=ge.length,le=0;le<me;le+=1)if(ge[le].pt.k.i)ge[le].pt.k.c=ge[le].cl;else for(pe=ge[le].pt.k.length,ne=0;ne<pe;ne+=1)ge[le].pt.k[ne].s&&(ge[le].pt.k[ne].s[0].c=ge[le].cl),ge[le].pt.k[ne].e&&(ge[le].pt.k[ne].e[0].c=ge[le].cl)}W.ty===4&&q(W.shapes)}}return function(U){if(F(ee,U.v)&&(Z(U.layers),U.assets)){var W,H=U.assets.length;for(W=0;W<H;W+=1)U.assets[W].layers&&Z(U.assets[W].layers)}}}();function X(ee){ee.__complete||(G(ee),B(ee),N(ee),j(ee),Y(ee),I(ee.layers,ee.assets),D(ee.chars,ee.assets),ee.__complete=!0)}function $(ee){ee.t.a.length===0&&"m"in ee.t.p}var te={};return te.completeData=X,te.checkColors=G,te.checkChars=N,te.checkPathProperties=j,te.checkShapes=Y,te.completeLayers=I,te}if(y.dataManager||(y.dataManager=M()),y.assetLoader||(y.assetLoader=function(){function I(z){var k=z.getResponseHeader("content-type");return k&&z.responseType==="json"&&k.indexOf("json")!==-1||z.response&&_typeof$5(z.response)==="object"?z.response:z.response&&typeof z.response=="string"?JSON.parse(z.response):z.responseText?JSON.parse(z.responseText):null}function D(z,k,L,R){var F,B=new XMLHttpRequest;try{B.responseType="json"}catch{}B.onreadystatechange=function(){if(B.readyState===4)if(B.status===200)F=I(B),L(F);else try{F=I(B),L(F)}catch(N){R&&R(N)}};try{B.open(["G","E","T"].join(""),z,!0)}catch{B.open(["G","E","T"].join(""),k+"/"+z,!0)}B.send()}return{load:D}}()),T.data.type==="loadAnimation")y.assetLoader.load(T.data.path,T.data.fullPath,function(I){y.dataManager.completeData(I),y.postMessage({id:T.data.id,payload:I,status:"success"})},function(){y.postMessage({id:T.data.id,status:"error"})});else if(T.data.type==="complete"){var O=T.data.animation;y.dataManager.completeData(O),y.postMessage({id:T.data.id,payload:O,status:"success"})}else T.data.type==="loadData"&&y.assetLoader.load(T.data.path,T.data.fullPath,function(I){y.postMessage({id:T.data.id,payload:I,status:"success"})},function(){y.postMessage({id:T.data.id,status:"error"})})}),o.onmessage=function(P){var T=P.data,M=T.id,O=a[M];a[M]=null,T.status==="success"?O.onComplete(T.payload):O.onError&&O.onError()})}function _(P,T){r+=1;var M="processId_"+r;return a[M]={onComplete:P,onError:T},M}function S(P,T,M){b();var O=_(T,M);o.postMessage({type:"loadAnimation",path:P,fullPath:window.location.origin+window.location.pathname,id:O})}function A(P,T,M){b();var O=_(T,M);o.postMessage({type:"loadData",path:P,fullPath:window.location.origin+window.location.pathname,id:O})}function C(P,T,M){b();var O=_(T,M);o.postMessage({type:"complete",animation:P,id:O})}return{loadAnimation:S,loadData:A,completeAnimation:C}}(),ImagePreloader=function(){var r=function(){var D=createTag("canvas");D.width=1,D.height=1;var z=D.getContext("2d");return z.fillStyle="rgba(0,0,0,0)",z.fillRect(0,0,1,1),D}();function a(){this.loadedAssets+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function n(){this.loadedFootagesCount+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function o(D,z,k){var L="";if(D.e)L=D.p;else if(z){var R=D.p;R.indexOf("images/")!==-1&&(R=R.split("/")[1]),L=z+R}else L=k,L+=D.u?D.u:"",L+=D.p;return L}function f(D){var z=0,k=setInterval((function(){var L=D.getBBox();(L.width||z>500)&&(this._imageLoaded(),clearInterval(k)),z+=1}).bind(this),50)}function y(D){var z=o(D,this.assetsPath,this.path),k=createNS("image");isSafari?this.testImageLoaded(k):k.addEventListener("load",this._imageLoaded,!1),k.addEventListener("error",(function(){L.img=r,this._imageLoaded()}).bind(this),!1),k.setAttributeNS("http://www.w3.org/1999/xlink","href",z),this._elementHelper.append?this._elementHelper.append(k):this._elementHelper.appendChild(k);var L={img:k,assetData:D};return L}function x(D){var z=o(D,this.assetsPath,this.path),k=createTag("img");k.crossOrigin="anonymous",k.addEventListener("load",this._imageLoaded,!1),k.addEventListener("error",(function(){L.img=r,this._imageLoaded()}).bind(this),!1),k.src=z;var L={img:k,assetData:D};return L}function b(D){var z={assetData:D},k=o(D,this.assetsPath,this.path);return dataManager.loadData(k,(function(L){z.img=L,this._footageLoaded()}).bind(this),(function(){z.img={},this._footageLoaded()}).bind(this)),z}function _(D,z){this.imagesLoadedCb=z;var k,L=D.length;for(k=0;k<L;k+=1)D[k].layers||(!D[k].t||D[k].t==="seq"?(this.totalImages+=1,this.images.push(this._createImageData(D[k]))):D[k].t===3&&(this.totalFootages+=1,this.images.push(this.createFootageData(D[k]))))}function S(D){this.path=D||""}function A(D){this.assetsPath=D||""}function C(D){for(var z=0,k=this.images.length;z<k;){if(this.images[z].assetData===D)return this.images[z].img;z+=1}return null}function P(){this.imagesLoadedCb=null,this.images.length=0}function T(){return this.totalImages===this.loadedAssets}function M(){return this.totalFootages===this.loadedFootagesCount}function O(D,z){D==="svg"?(this._elementHelper=z,this._createImageData=this.createImageData.bind(this)):this._createImageData=this.createImgData.bind(this)}function I(){this._imageLoaded=a.bind(this),this._footageLoaded=n.bind(this),this.testImageLoaded=f.bind(this),this.createFootageData=b.bind(this),this.assetsPath="",this.path="",this.totalImages=0,this.totalFootages=0,this.loadedAssets=0,this.loadedFootagesCount=0,this.imagesLoadedCb=null,this.images=[]}return I.prototype={loadAssets:_,setAssetsPath:A,setPath:S,loadedImages:T,loadedFootages:M,destroy:P,getAsset:C,createImgData:x,createImageData:y,imageLoaded:a,footageLoaded:n,setCacheType:O},I}();function BaseEvent(){}BaseEvent.prototype={triggerEvent:function(a,n){if(this._cbs[a])for(var o=this._cbs[a],f=0;f<o.length;f+=1)o[f](n)},addEventListener:function(a,n){return this._cbs[a]||(this._cbs[a]=[]),this._cbs[a].push(n),(function(){this.removeEventListener(a,n)}).bind(this)},removeEventListener:function(a,n){if(!n)this._cbs[a]=null;else if(this._cbs[a]){for(var o=0,f=this._cbs[a].length;o<f;)this._cbs[a][o]===n&&(this._cbs[a].splice(o,1),o-=1,f-=1),o+=1;this._cbs[a].length||(this._cbs[a]=null)}}};var markerParser=function(){function r(a){for(var n=a.split(`\r
`),o={},f,y=0,x=0;x<n.length;x+=1)f=n[x].split(":"),f.length===2&&(o[f[0]]=f[1].trim(),y+=1);if(y===0)throw new Error;return o}return function(a){for(var n=[],o=0;o<a.length;o+=1){var f=a[o],y={time:f.tm,duration:f.dr};try{y.payload=JSON.parse(a[o].cm)}catch{try{y.payload=r(a[o].cm)}catch{y.payload={name:a[o].cm}}}n.push(y)}return n}}(),ProjectInterface=function(){function r(a){this.compositions.push(a)}return function(){function a(n){for(var o=0,f=this.compositions.length;o<f;){if(this.compositions[o].data&&this.compositions[o].data.nm===n)return this.compositions[o].prepareFrame&&this.compositions[o].data.xt&&this.compositions[o].prepareFrame(this.currentFrame),this.compositions[o].compInterface;o+=1}return null}return a.compositions=[],a.currentFrame=0,a.registerComposition=r,a}}(),renderers={},registerRenderer=function(a,n){renderers[a]=n};function getRenderer(r){return renderers[r]}function getRegisteredRenderer(){if(renderers.canvas)return"canvas";for(var r in renderers)if(renderers[r])return r;return""}function _typeof$4(r){"@babel/helpers - typeof";return _typeof$4=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof$4(r)}var AnimationItem=function(){this._cbs=[],this.name="",this.path="",this.isLoaded=!1,this.currentFrame=0,this.currentRawFrame=0,this.firstFrame=0,this.totalFrames=0,this.frameRate=0,this.frameMult=0,this.playSpeed=1,this.playDirection=1,this.playCount=0,this.animationData={},this.assets=[],this.isPaused=!0,this.autoplay=!1,this.loop=!0,this.renderer=null,this.animationID=createElementID(),this.assetsPath="",this.timeCompleted=0,this.segmentPos=0,this.isSubframeEnabled=getSubframeEnabled(),this.segments=[],this._idle=!0,this._completedLoop=!1,this.projectInterface=ProjectInterface(),this.imagePreloader=new ImagePreloader,this.audioController=audioControllerFactory(),this.markers=[],this.configAnimation=this.configAnimation.bind(this),this.onSetupError=this.onSetupError.bind(this),this.onSegmentComplete=this.onSegmentComplete.bind(this),this.drawnFrameEvent=new BMEnterFrameEvent("drawnFrame",0,0,0),this.expressionsPlugin=getExpressionsPlugin()};extendPrototype([BaseEvent],AnimationItem),AnimationItem.prototype.setParams=function(r){(r.wrapper||r.container)&&(this.wrapper=r.wrapper||r.container);var a="svg";r.animType?a=r.animType:r.renderer&&(a=r.renderer);var n=getRenderer(a);this.renderer=new n(this,r.rendererSettings),this.imagePreloader.setCacheType(a,this.renderer.globalData.defs),this.renderer.setProjectInterface(this.projectInterface),this.animType=a,r.loop===""||r.loop===null||r.loop===void 0||r.loop===!0?this.loop=!0:r.loop===!1?this.loop=!1:this.loop=parseInt(r.loop,10),this.autoplay="autoplay"in r?r.autoplay:!0,this.name=r.name?r.name:"",this.autoloadSegments=Object.prototype.hasOwnProperty.call(r,"autoloadSegments")?r.autoloadSegments:!0,this.assetsPath=r.assetsPath,this.initialSegment=r.initialSegment,r.audioFactory&&this.audioController.setAudioFactory(r.audioFactory),r.animationData?this.setupAnimation(r.animationData):r.path&&(r.path.lastIndexOf("\\")!==-1?this.path=r.path.substr(0,r.path.lastIndexOf("\\")+1):this.path=r.path.substr(0,r.path.lastIndexOf("/")+1),this.fileName=r.path.substr(r.path.lastIndexOf("/")+1),this.fileName=this.fileName.substr(0,this.fileName.lastIndexOf(".json")),dataManager.loadAnimation(r.path,this.configAnimation,this.onSetupError))},AnimationItem.prototype.onSetupError=function(){this.trigger("data_failed")},AnimationItem.prototype.setupAnimation=function(r){dataManager.completeAnimation(r,this.configAnimation)},AnimationItem.prototype.setData=function(r,a){a&&_typeof$4(a)!=="object"&&(a=JSON.parse(a));var n={wrapper:r,animationData:a},o=r.attributes;n.path=o.getNamedItem("data-animation-path")?o.getNamedItem("data-animation-path").value:o.getNamedItem("data-bm-path")?o.getNamedItem("data-bm-path").value:o.getNamedItem("bm-path")?o.getNamedItem("bm-path").value:"",n.animType=o.getNamedItem("data-anim-type")?o.getNamedItem("data-anim-type").value:o.getNamedItem("data-bm-type")?o.getNamedItem("data-bm-type").value:o.getNamedItem("bm-type")?o.getNamedItem("bm-type").value:o.getNamedItem("data-bm-renderer")?o.getNamedItem("data-bm-renderer").value:o.getNamedItem("bm-renderer")?o.getNamedItem("bm-renderer").value:getRegisteredRenderer()||"canvas";var f=o.getNamedItem("data-anim-loop")?o.getNamedItem("data-anim-loop").value:o.getNamedItem("data-bm-loop")?o.getNamedItem("data-bm-loop").value:o.getNamedItem("bm-loop")?o.getNamedItem("bm-loop").value:"";f==="false"?n.loop=!1:f==="true"?n.loop=!0:f!==""&&(n.loop=parseInt(f,10));var y=o.getNamedItem("data-anim-autoplay")?o.getNamedItem("data-anim-autoplay").value:o.getNamedItem("data-bm-autoplay")?o.getNamedItem("data-bm-autoplay").value:o.getNamedItem("bm-autoplay")?o.getNamedItem("bm-autoplay").value:!0;n.autoplay=y!=="false",n.name=o.getNamedItem("data-name")?o.getNamedItem("data-name").value:o.getNamedItem("data-bm-name")?o.getNamedItem("data-bm-name").value:o.getNamedItem("bm-name")?o.getNamedItem("bm-name").value:"";var x=o.getNamedItem("data-anim-prerender")?o.getNamedItem("data-anim-prerender").value:o.getNamedItem("data-bm-prerender")?o.getNamedItem("data-bm-prerender").value:o.getNamedItem("bm-prerender")?o.getNamedItem("bm-prerender").value:"";x==="false"&&(n.prerender=!1),n.path?this.setParams(n):this.trigger("destroy")},AnimationItem.prototype.includeLayers=function(r){r.op>this.animationData.op&&(this.animationData.op=r.op,this.totalFrames=Math.floor(r.op-this.animationData.ip));var a=this.animationData.layers,n,o=a.length,f=r.layers,y,x=f.length;for(y=0;y<x;y+=1)for(n=0;n<o;){if(a[n].id===f[y].id){a[n]=f[y];break}n+=1}if((r.chars||r.fonts)&&(this.renderer.globalData.fontManager.addChars(r.chars),this.renderer.globalData.fontManager.addFonts(r.fonts,this.renderer.globalData.defs)),r.assets)for(o=r.assets.length,n=0;n<o;n+=1)this.animationData.assets.push(r.assets[n]);this.animationData.__complete=!1,dataManager.completeAnimation(this.animationData,this.onSegmentComplete)},AnimationItem.prototype.onSegmentComplete=function(r){this.animationData=r;var a=getExpressionsPlugin();a&&a.initExpressions(this),this.loadNextSegment()},AnimationItem.prototype.loadNextSegment=function(){var r=this.animationData.segments;if(!r||r.length===0||!this.autoloadSegments){this.trigger("data_ready"),this.timeCompleted=this.totalFrames;return}var a=r.shift();this.timeCompleted=a.time*this.frameRate;var n=this.path+this.fileName+"_"+this.segmentPos+".json";this.segmentPos+=1,dataManager.loadData(n,this.includeLayers.bind(this),(function(){this.trigger("data_failed")}).bind(this))},AnimationItem.prototype.loadSegments=function(){var r=this.animationData.segments;r||(this.timeCompleted=this.totalFrames),this.loadNextSegment()},AnimationItem.prototype.imagesLoaded=function(){this.trigger("loaded_images"),this.checkLoaded()},AnimationItem.prototype.preloadImages=function(){this.imagePreloader.setAssetsPath(this.assetsPath),this.imagePreloader.setPath(this.path),this.imagePreloader.loadAssets(this.animationData.assets,this.imagesLoaded.bind(this))},AnimationItem.prototype.configAnimation=function(r){if(this.renderer)try{this.animationData=r,this.initialSegment?(this.totalFrames=Math.floor(this.initialSegment[1]-this.initialSegment[0]),this.firstFrame=Math.round(this.initialSegment[0])):(this.totalFrames=Math.floor(this.animationData.op-this.animationData.ip),this.firstFrame=Math.round(this.animationData.ip)),this.renderer.configAnimation(r),r.assets||(r.assets=[]),this.assets=this.animationData.assets,this.frameRate=this.animationData.fr,this.frameMult=this.animationData.fr/1e3,this.renderer.searchExtraCompositions(r.assets),this.markers=markerParser(r.markers||[]),this.trigger("config_ready"),this.preloadImages(),this.loadSegments(),this.updaFrameModifier(),this.waitForFontsLoaded(),this.isPaused&&this.audioController.pause()}catch(a){this.triggerConfigError(a)}},AnimationItem.prototype.waitForFontsLoaded=function(){this.renderer&&(this.renderer.globalData.fontManager.isLoaded?this.checkLoaded():setTimeout(this.waitForFontsLoaded.bind(this),20))},AnimationItem.prototype.checkLoaded=function(){if(!this.isLoaded&&this.renderer.globalData.fontManager.isLoaded&&(this.imagePreloader.loadedImages()||this.renderer.rendererType!=="canvas")&&this.imagePreloader.loadedFootages()){this.isLoaded=!0;var r=getExpressionsPlugin();r&&r.initExpressions(this),this.renderer.initItems(),setTimeout((function(){this.trigger("DOMLoaded")}).bind(this),0),this.gotoFrame(),this.autoplay&&this.play()}},AnimationItem.prototype.resize=function(r,a){var n=typeof r=="number"?r:void 0,o=typeof a=="number"?a:void 0;this.renderer.updateContainerSize(n,o)},AnimationItem.prototype.setSubframe=function(r){this.isSubframeEnabled=!!r},AnimationItem.prototype.gotoFrame=function(){this.currentFrame=this.isSubframeEnabled?this.currentRawFrame:~~this.currentRawFrame,this.timeCompleted!==this.totalFrames&&this.currentFrame>this.timeCompleted&&(this.currentFrame=this.timeCompleted),this.trigger("enterFrame"),this.renderFrame(),this.trigger("drawnFrame")},AnimationItem.prototype.renderFrame=function(){if(!(this.isLoaded===!1||!this.renderer))try{this.expressionsPlugin&&this.expressionsPlugin.resetFrame(),this.renderer.renderFrame(this.currentFrame+this.firstFrame)}catch(r){this.triggerRenderFrameError(r)}},AnimationItem.prototype.play=function(r){r&&this.name!==r||this.isPaused===!0&&(this.isPaused=!1,this.trigger("_play"),this.audioController.resume(),this._idle&&(this._idle=!1,this.trigger("_active")))},AnimationItem.prototype.pause=function(r){r&&this.name!==r||this.isPaused===!1&&(this.isPaused=!0,this.trigger("_pause"),this._idle=!0,this.trigger("_idle"),this.audioController.pause())},AnimationItem.prototype.togglePause=function(r){r&&this.name!==r||(this.isPaused===!0?this.play():this.pause())},AnimationItem.prototype.stop=function(r){r&&this.name!==r||(this.pause(),this.playCount=0,this._completedLoop=!1,this.setCurrentRawFrameValue(0))},AnimationItem.prototype.getMarkerData=function(r){for(var a,n=0;n<this.markers.length;n+=1)if(a=this.markers[n],a.payload&&a.payload.name===r)return a;return null},AnimationItem.prototype.goToAndStop=function(r,a,n){if(!(n&&this.name!==n)){var o=Number(r);if(isNaN(o)){var f=this.getMarkerData(r);f&&this.goToAndStop(f.time,!0)}else a?this.setCurrentRawFrameValue(r):this.setCurrentRawFrameValue(r*this.frameModifier);this.pause()}},AnimationItem.prototype.goToAndPlay=function(r,a,n){if(!(n&&this.name!==n)){var o=Number(r);if(isNaN(o)){var f=this.getMarkerData(r);f&&(f.duration?this.playSegments([f.time,f.time+f.duration],!0):this.goToAndStop(f.time,!0))}else this.goToAndStop(o,a,n);this.play()}},AnimationItem.prototype.advanceTime=function(r){if(!(this.isPaused===!0||this.isLoaded===!1)){var a=this.currentRawFrame+r*this.frameModifier,n=!1;a>=this.totalFrames-1&&this.frameModifier>0?!this.loop||this.playCount===this.loop?this.checkSegments(a>this.totalFrames?a%this.totalFrames:0)||(n=!0,a=this.totalFrames-1):a>=this.totalFrames?(this.playCount+=1,this.checkSegments(a%this.totalFrames)||(this.setCurrentRawFrameValue(a%this.totalFrames),this._completedLoop=!0,this.trigger("loopComplete"))):this.setCurrentRawFrameValue(a):a<0?this.checkSegments(a%this.totalFrames)||(this.loop&&!(this.playCount--<=0&&this.loop!==!0)?(this.setCurrentRawFrameValue(this.totalFrames+a%this.totalFrames),this._completedLoop?this.trigger("loopComplete"):this._completedLoop=!0):(n=!0,a=0)):this.setCurrentRawFrameValue(a),n&&(this.setCurrentRawFrameValue(a),this.pause(),this.trigger("complete"))}},AnimationItem.prototype.adjustSegment=function(r,a){this.playCount=0,r[1]<r[0]?(this.frameModifier>0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(-1)),this.totalFrames=r[0]-r[1],this.timeCompleted=this.totalFrames,this.firstFrame=r[1],this.setCurrentRawFrameValue(this.totalFrames-.001-a)):r[1]>r[0]&&(this.frameModifier<0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(1)),this.totalFrames=r[1]-r[0],this.timeCompleted=this.totalFrames,this.firstFrame=r[0],this.setCurrentRawFrameValue(.001+a)),this.trigger("segmentStart")},AnimationItem.prototype.setSegment=function(r,a){var n=-1;this.isPaused&&(this.currentRawFrame+this.firstFrame<r?n=r:this.currentRawFrame+this.firstFrame>a&&(n=a-r)),this.firstFrame=r,this.totalFrames=a-r,this.timeCompleted=this.totalFrames,n!==-1&&this.goToAndStop(n,!0)},AnimationItem.prototype.playSegments=function(r,a){if(a&&(this.segments.length=0),_typeof$4(r[0])==="object"){var n,o=r.length;for(n=0;n<o;n+=1)this.segments.push(r[n])}else this.segments.push(r);this.segments.length&&a&&this.adjustSegment(this.segments.shift(),0),this.isPaused&&this.play()},AnimationItem.prototype.resetSegments=function(r){this.segments.length=0,this.segments.push([this.animationData.ip,this.animationData.op]),r&&this.checkSegments(0)},AnimationItem.prototype.checkSegments=function(r){return this.segments.length?(this.adjustSegment(this.segments.shift(),r),!0):!1},AnimationItem.prototype.destroy=function(r){r&&this.name!==r||!this.renderer||(this.renderer.destroy(),this.imagePreloader.destroy(),this.trigger("destroy"),this._cbs=null,this.onEnterFrame=null,this.onLoopComplete=null,this.onComplete=null,this.onSegmentStart=null,this.onDestroy=null,this.renderer=null,this.expressionsPlugin=null,this.imagePreloader=null,this.projectInterface=null)},AnimationItem.prototype.setCurrentRawFrameValue=function(r){this.currentRawFrame=r,this.gotoFrame()},AnimationItem.prototype.setSpeed=function(r){this.playSpeed=r,this.updaFrameModifier()},AnimationItem.prototype.setDirection=function(r){this.playDirection=r<0?-1:1,this.updaFrameModifier()},AnimationItem.prototype.setLoop=function(r){this.loop=r},AnimationItem.prototype.setVolume=function(r,a){a&&this.name!==a||this.audioController.setVolume(r)},AnimationItem.prototype.getVolume=function(){return this.audioController.getVolume()},AnimationItem.prototype.mute=function(r){r&&this.name!==r||this.audioController.mute()},AnimationItem.prototype.unmute=function(r){r&&this.name!==r||this.audioController.unmute()},AnimationItem.prototype.updaFrameModifier=function(){this.frameModifier=this.frameMult*this.playSpeed*this.playDirection,this.audioController.setRate(this.playSpeed*this.playDirection)},AnimationItem.prototype.getPath=function(){return this.path},AnimationItem.prototype.getAssetsPath=function(r){var a="";if(r.e)a=r.p;else if(this.assetsPath){var n=r.p;n.indexOf("images/")!==-1&&(n=n.split("/")[1]),a=this.assetsPath+n}else a=this.path,a+=r.u?r.u:"",a+=r.p;return a},AnimationItem.prototype.getAssetData=function(r){for(var a=0,n=this.assets.length;a<n;){if(r===this.assets[a].id)return this.assets[a];a+=1}return null},AnimationItem.prototype.hide=function(){this.renderer.hide()},AnimationItem.prototype.show=function(){this.renderer.show()},AnimationItem.prototype.getDuration=function(r){return r?this.totalFrames:this.totalFrames/this.frameRate},AnimationItem.prototype.updateDocumentData=function(r,a,n){try{var o=this.renderer.getElementByPath(r);o.updateDocumentData(a,n)}catch{}},AnimationItem.prototype.trigger=function(r){if(this._cbs&&this._cbs[r])switch(r){case"enterFrame":this.triggerEvent(r,new BMEnterFrameEvent(r,this.currentFrame,this.totalFrames,this.frameModifier));break;case"drawnFrame":this.drawnFrameEvent.currentTime=this.currentFrame,this.drawnFrameEvent.totalTime=this.totalFrames,this.drawnFrameEvent.direction=this.frameModifier,this.triggerEvent(r,this.drawnFrameEvent);break;case"loopComplete":this.triggerEvent(r,new BMCompleteLoopEvent(r,this.loop,this.playCount,this.frameMult));break;case"complete":this.triggerEvent(r,new BMCompleteEvent(r,this.frameMult));break;case"segmentStart":this.triggerEvent(r,new BMSegmentStartEvent(r,this.firstFrame,this.totalFrames));break;case"destroy":this.triggerEvent(r,new BMDestroyEvent(r,this));break;default:this.triggerEvent(r)}r==="enterFrame"&&this.onEnterFrame&&this.onEnterFrame.call(this,new BMEnterFrameEvent(r,this.currentFrame,this.totalFrames,this.frameMult)),r==="loopComplete"&&this.onLoopComplete&&this.onLoopComplete.call(this,new BMCompleteLoopEvent(r,this.loop,this.playCount,this.frameMult)),r==="complete"&&this.onComplete&&this.onComplete.call(this,new BMCompleteEvent(r,this.frameMult)),r==="segmentStart"&&this.onSegmentStart&&this.onSegmentStart.call(this,new BMSegmentStartEvent(r,this.firstFrame,this.totalFrames)),r==="destroy"&&this.onDestroy&&this.onDestroy.call(this,new BMDestroyEvent(r,this))},AnimationItem.prototype.triggerRenderFrameError=function(r){var a=new BMRenderFrameErrorEvent(r,this.currentFrame);this.triggerEvent("error",a),this.onError&&this.onError.call(this,a)},AnimationItem.prototype.triggerConfigError=function(r){var a=new BMConfigErrorEvent(r,this.currentFrame);this.triggerEvent("error",a),this.onError&&this.onError.call(this,a)};var animationManager=function(){var r={},a=[],n=0,o=0,f=0,y=!0,x=!1;function b(q){for(var Z=0,U=q.target;Z<o;)a[Z].animation===U&&(a.splice(Z,1),Z-=1,o-=1,U.isPaused||C()),Z+=1}function _(q,Z){if(!q)return null;for(var U=0;U<o;){if(a[U].elem===q&&a[U].elem!==null)return a[U].animation;U+=1}var W=new AnimationItem;return P(W,q),W.setData(q,Z),W}function S(){var q,Z=a.length,U=[];for(q=0;q<Z;q+=1)U.push(a[q].animation);return U}function A(){f+=1,G()}function C(){f-=1}function P(q,Z){q.addEventListener("destroy",b),q.addEventListener("_active",A),q.addEventListener("_idle",C),a.push({elem:Z,animation:q}),o+=1}function T(q){var Z=new AnimationItem;return P(Z,null),Z.setParams(q),Z}function M(q,Z){var U;for(U=0;U<o;U+=1)a[U].animation.setSpeed(q,Z)}function O(q,Z){var U;for(U=0;U<o;U+=1)a[U].animation.setDirection(q,Z)}function I(q){var Z;for(Z=0;Z<o;Z+=1)a[Z].animation.play(q)}function D(q){var Z=q-n,U;for(U=0;U<o;U+=1)a[U].animation.advanceTime(Z);n=q,f&&!x?window.requestAnimationFrame(D):y=!0}function z(q){n=q,window.requestAnimationFrame(D)}function k(q){var Z;for(Z=0;Z<o;Z+=1)a[Z].animation.pause(q)}function L(q,Z,U){var W;for(W=0;W<o;W+=1)a[W].animation.goToAndStop(q,Z,U)}function R(q){var Z;for(Z=0;Z<o;Z+=1)a[Z].animation.stop(q)}function F(q){var Z;for(Z=0;Z<o;Z+=1)a[Z].animation.togglePause(q)}function B(q){var Z;for(Z=o-1;Z>=0;Z-=1)a[Z].animation.destroy(q)}function N(q,Z,U){var W=[].concat([].slice.call(document.getElementsByClassName("lottie")),[].slice.call(document.getElementsByClassName("bodymovin"))),H,K=W.length;for(H=0;H<K;H+=1)U&&W[H].setAttribute("data-bm-type",U),_(W[H],q);if(Z&&K===0){U||(U="svg");var le=document.getElementsByTagName("body")[0];le.innerText="";var me=createTag("div");me.style.width="100%",me.style.height="100%",me.setAttribute("data-bm-type",U),le.appendChild(me),_(me,q)}}function j(){var q;for(q=0;q<o;q+=1)a[q].animation.resize()}function G(){!x&&f&&y&&(window.requestAnimationFrame(z),y=!1)}function Y(){x=!0}function X(){x=!1,G()}function $(q,Z){var U;for(U=0;U<o;U+=1)a[U].animation.setVolume(q,Z)}function te(q){var Z;for(Z=0;Z<o;Z+=1)a[Z].animation.mute(q)}function ee(q){var Z;for(Z=0;Z<o;Z+=1)a[Z].animation.unmute(q)}return r.registerAnimation=_,r.loadAnimation=T,r.setSpeed=M,r.setDirection=O,r.play=I,r.pause=k,r.stop=R,r.togglePause=F,r.searchAnimations=N,r.resize=j,r.goToAndStop=L,r.destroy=B,r.freeze=Y,r.unfreeze=X,r.setVolume=$,r.mute=te,r.unmute=ee,r.getRegisteredAnimations=S,r}(),BezierFactory=function(){var r={};r.getBezierEasing=n;var a={};function n(z,k,L,R,F){var B=F||("bez_"+z+"_"+k+"_"+L+"_"+R).replace(/\./g,"p");if(a[B])return a[B];var N=new D([z,k,L,R]);return a[B]=N,N}var o=4,f=.001,y=1e-7,x=10,b=11,_=1/(b-1),S=typeof Float32Array=="function";function A(z,k){return 1-3*k+3*z}function C(z,k){return 3*k-6*z}function P(z){return 3*z}function T(z,k,L){return((A(k,L)*z+C(k,L))*z+P(k))*z}function M(z,k,L){return 3*A(k,L)*z*z+2*C(k,L)*z+P(k)}function O(z,k,L,R,F){var B,N,j=0;do N=k+(L-k)/2,B=T(N,R,F)-z,B>0?L=N:k=N;while(Math.abs(B)>y&&++j<x);return N}function I(z,k,L,R){for(var F=0;F<o;++F){var B=M(k,L,R);if(B===0)return k;var N=T(k,L,R)-z;k-=N/B}return k}function D(z){this._p=z,this._mSampleValues=S?new Float32Array(b):new Array(b),this._precomputed=!1,this.get=this.get.bind(this)}return D.prototype={get:function(k){var L=this._p[0],R=this._p[1],F=this._p[2],B=this._p[3];return this._precomputed||this._precompute(),L===R&&F===B?k:k===0?0:k===1?1:T(this._getTForX(k),R,B)},_precompute:function(){var k=this._p[0],L=this._p[1],R=this._p[2],F=this._p[3];this._precomputed=!0,(k!==L||R!==F)&&this._calcSampleValues()},_calcSampleValues:function(){for(var k=this._p[0],L=this._p[2],R=0;R<b;++R)this._mSampleValues[R]=T(R*_,k,L)},_getTForX:function(k){for(var L=this._p[0],R=this._p[2],F=this._mSampleValues,B=0,N=1,j=b-1;N!==j&&F[N]<=k;++N)B+=_;--N;var G=(k-F[N])/(F[N+1]-F[N]),Y=B+G*_,X=M(Y,L,R);return X>=f?I(k,Y,L,R):X===0?Y:O(k,B,B+_,L,R)}},r}(),pooling=function(){function r(a){return a.concat(createSizedArray(a.length))}return{double:r}}(),poolFactory=function(){return function(r,a,n){var o=0,f=r,y=createSizedArray(f),x={newElement:b,release:_};function b(){var S;return o?(o-=1,S=y[o]):S=a(),S}function _(S){o===f&&(y=pooling.double(y),f*=2),n&&n(S),y[o]=S,o+=1}return x}}(),bezierLengthPool=function(){function r(){return{addedLength:0,percents:createTypedArray("float32",getDefaultCurveSegments()),lengths:createTypedArray("float32",getDefaultCurveSegments())}}return poolFactory(8,r)}(),segmentsLengthPool=function(){function r(){return{lengths:[],totalLength:0}}function a(n){var o,f=n.lengths.length;for(o=0;o<f;o+=1)bezierLengthPool.release(n.lengths[o]);n.lengths.length=0}return poolFactory(8,r,a)}();function bezFunction(){var r=Math;function a(P,T,M,O,I,D){var z=P*O+T*I+M*D-I*O-D*P-M*T;return z>-.001&&z<.001}function n(P,T,M,O,I,D,z,k,L){if(M===0&&D===0&&L===0)return a(P,T,O,I,z,k);var R=r.sqrt(r.pow(O-P,2)+r.pow(I-T,2)+r.pow(D-M,2)),F=r.sqrt(r.pow(z-P,2)+r.pow(k-T,2)+r.pow(L-M,2)),B=r.sqrt(r.pow(z-O,2)+r.pow(k-I,2)+r.pow(L-D,2)),N;return R>F?R>B?N=R-F-B:N=B-F-R:B>F?N=B-F-R:N=F-R-B,N>-1e-4&&N<1e-4}var o=function(){return function(P,T,M,O){var I=getDefaultCurveSegments(),D,z,k,L,R,F=0,B,N=[],j=[],G=bezierLengthPool.newElement();for(k=M.length,D=0;D<I;D+=1){for(R=D/(I-1),B=0,z=0;z<k;z+=1)L=bmPow(1-R,3)*P[z]+3*bmPow(1-R,2)*R*M[z]+3*(1-R)*bmPow(R,2)*O[z]+bmPow(R,3)*T[z],N[z]=L,j[z]!==null&&(B+=bmPow(N[z]-j[z],2)),j[z]=N[z];B&&(B=bmSqrt(B),F+=B),G.percents[D]=R,G.lengths[D]=F}return G.addedLength=F,G}}();function f(P){var T=segmentsLengthPool.newElement(),M=P.c,O=P.v,I=P.o,D=P.i,z,k=P._length,L=T.lengths,R=0;for(z=0;z<k-1;z+=1)L[z]=o(O[z],O[z+1],I[z],D[z+1]),R+=L[z].addedLength;return M&&k&&(L[z]=o(O[z],O[0],I[z],D[0]),R+=L[z].addedLength),T.totalLength=R,T}function y(P){this.segmentLength=0,this.points=new Array(P)}function x(P,T){this.partialLength=P,this.point=T}var b=function(){var P={};return function(T,M,O,I){var D=(T[0]+"_"+T[1]+"_"+M[0]+"_"+M[1]+"_"+O[0]+"_"+O[1]+"_"+I[0]+"_"+I[1]).replace(/\./g,"p");if(!P[D]){var z=getDefaultCurveSegments(),k,L,R,F,B,N=0,j,G,Y=null;T.length===2&&(T[0]!==M[0]||T[1]!==M[1])&&a(T[0],T[1],M[0],M[1],T[0]+O[0],T[1]+O[1])&&a(T[0],T[1],M[0],M[1],M[0]+I[0],M[1]+I[1])&&(z=2);var X=new y(z);for(R=O.length,k=0;k<z;k+=1){for(G=createSizedArray(R),B=k/(z-1),j=0,L=0;L<R;L+=1)F=bmPow(1-B,3)*T[L]+3*bmPow(1-B,2)*B*(T[L]+O[L])+3*(1-B)*bmPow(B,2)*(M[L]+I[L])+bmPow(B,3)*M[L],G[L]=F,Y!==null&&(j+=bmPow(G[L]-Y[L],2));j=bmSqrt(j),N+=j,X.points[k]=new x(j,G),Y=G}X.segmentLength=N,P[D]=X}return P[D]}}();function _(P,T){var M=T.percents,O=T.lengths,I=M.length,D=bmFloor((I-1)*P),z=P*T.addedLength,k=0;if(D===I-1||D===0||z===O[D])return M[D];for(var L=O[D]>z?-1:1,R=!0;R;)if(O[D]<=z&&O[D+1]>z?(k=(z-O[D])/(O[D+1]-O[D]),R=!1):D+=L,D<0||D>=I-1){if(D===I-1)return M[D];R=!1}return M[D]+(M[D+1]-M[D])*k}function S(P,T,M,O,I,D){var z=_(I,D),k=1-z,L=r.round((k*k*k*P[0]+(z*k*k+k*z*k+k*k*z)*M[0]+(z*z*k+k*z*z+z*k*z)*O[0]+z*z*z*T[0])*1e3)/1e3,R=r.round((k*k*k*P[1]+(z*k*k+k*z*k+k*k*z)*M[1]+(z*z*k+k*z*z+z*k*z)*O[1]+z*z*z*T[1])*1e3)/1e3;return[L,R]}var A=createTypedArray("float32",8);function C(P,T,M,O,I,D,z){I<0?I=0:I>1&&(I=1);var k=_(I,z);D=D>1?1:D;var L=_(D,z),R,F=P.length,B=1-k,N=1-L,j=B*B*B,G=k*B*B*3,Y=k*k*B*3,X=k*k*k,$=B*B*N,te=k*B*N+B*k*N+B*B*L,ee=k*k*N+B*k*L+k*B*L,q=k*k*L,Z=B*N*N,U=k*N*N+B*L*N+B*N*L,W=k*L*N+B*L*L+k*N*L,H=k*L*L,K=N*N*N,le=L*N*N+N*L*N+N*N*L,me=L*L*N+N*L*L+L*N*L,ne=L*L*L;for(R=0;R<F;R+=1)A[R*4]=r.round((j*P[R]+G*M[R]+Y*O[R]+X*T[R])*1e3)/1e3,A[R*4+1]=r.round(($*P[R]+te*M[R]+ee*O[R]+q*T[R])*1e3)/1e3,A[R*4+2]=r.round((Z*P[R]+U*M[R]+W*O[R]+H*T[R])*1e3)/1e3,A[R*4+3]=r.round((K*P[R]+le*M[R]+me*O[R]+ne*T[R])*1e3)/1e3;return A}return{getSegmentsLength:f,getNewSegment:C,getPointInSegment:S,buildBezierData:b,pointOnLine2D:a,pointOnLine3D:n}}var bez=bezFunction(),initFrame=initialDefaultFrame,mathAbs=Math.abs;function interpolateValue(r,a){var n=this.offsetTime,o;this.propType==="multidimensional"&&(o=createTypedArray("float32",this.pv.length));for(var f=a.lastIndex,y=f,x=this.keyframes.length-1,b=!0,_,S,A;b;){if(_=this.keyframes[y],S=this.keyframes[y+1],y===x-1&&r>=S.t-n){_.h&&(_=S),f=0;break}if(S.t-n>r){f=y;break}y<x-1?y+=1:(f=0,b=!1)}A=this.keyframesMetadata[y]||{};var C,P,T,M,O,I,D=S.t-n,z=_.t-n,k;if(_.to){A.bezierData||(A.bezierData=bez.buildBezierData(_.s,S.s||_.e,_.to,_.ti));var L=A.bezierData;if(r>=D||r<z){var R=r>=D?L.points.length-1:0;for(P=L.points[R].point.length,C=0;C<P;C+=1)o[C]=L.points[R].point[C]}else{A.__fnct?I=A.__fnct:(I=BezierFactory.getBezierEasing(_.o.x,_.o.y,_.i.x,_.i.y,_.n).get,A.__fnct=I),T=I((r-z)/(D-z));var F=L.segmentLength*T,B,N=a.lastFrame<r&&a._lastKeyframeIndex===y?a._lastAddedLength:0;for(O=a.lastFrame<r&&a._lastKeyframeIndex===y?a._lastPoint:0,b=!0,M=L.points.length;b;){if(N+=L.points[O].partialLength,F===0||T===0||O===L.points.length-1){for(P=L.points[O].point.length,C=0;C<P;C+=1)o[C]=L.points[O].point[C];break}else if(F>=N&&F<N+L.points[O+1].partialLength){for(B=(F-N)/L.points[O+1].partialLength,P=L.points[O].point.length,C=0;C<P;C+=1)o[C]=L.points[O].point[C]+(L.points[O+1].point[C]-L.points[O].point[C])*B;break}O<M-1?O+=1:b=!1}a._lastPoint=O,a._lastAddedLength=N-L.points[O].partialLength,a._lastKeyframeIndex=y}}else{var j,G,Y,X,$;if(x=_.s.length,k=S.s||_.e,this.sh&&_.h!==1)if(r>=D)o[0]=k[0],o[1]=k[1],o[2]=k[2];else if(r<=z)o[0]=_.s[0],o[1]=_.s[1],o[2]=_.s[2];else{var te=createQuaternion(_.s),ee=createQuaternion(k),q=(r-z)/(D-z);quaternionToEuler(o,slerp(te,ee,q))}else for(y=0;y<x;y+=1)_.h!==1&&(r>=D?T=1:r<z?T=0:(_.o.x.constructor===Array?(A.__fnct||(A.__fnct=[]),A.__fnct[y]?I=A.__fnct[y]:(j=_.o.x[y]===void 0?_.o.x[0]:_.o.x[y],G=_.o.y[y]===void 0?_.o.y[0]:_.o.y[y],Y=_.i.x[y]===void 0?_.i.x[0]:_.i.x[y],X=_.i.y[y]===void 0?_.i.y[0]:_.i.y[y],I=BezierFactory.getBezierEasing(j,G,Y,X).get,A.__fnct[y]=I)):A.__fnct?I=A.__fnct:(j=_.o.x,G=_.o.y,Y=_.i.x,X=_.i.y,I=BezierFactory.getBezierEasing(j,G,Y,X).get,_.keyframeMetadata=I),T=I((r-z)/(D-z)))),k=S.s||_.e,$=_.h===1?_.s[y]:_.s[y]+(k[y]-_.s[y])*T,this.propType==="multidimensional"?o[y]=$:o=$}return a.lastIndex=f,o}function slerp(r,a,n){var o=[],f=r[0],y=r[1],x=r[2],b=r[3],_=a[0],S=a[1],A=a[2],C=a[3],P,T,M,O,I;return T=f*_+y*S+x*A+b*C,T<0&&(T=-T,_=-_,S=-S,A=-A,C=-C),1-T>1e-6?(P=Math.acos(T),M=Math.sin(P),O=Math.sin((1-n)*P)/M,I=Math.sin(n*P)/M):(O=1-n,I=n),o[0]=O*f+I*_,o[1]=O*y+I*S,o[2]=O*x+I*A,o[3]=O*b+I*C,o}function quaternionToEuler(r,a){var n=a[0],o=a[1],f=a[2],y=a[3],x=Math.atan2(2*o*y-2*n*f,1-2*o*o-2*f*f),b=Math.asin(2*n*o+2*f*y),_=Math.atan2(2*n*y-2*o*f,1-2*n*n-2*f*f);r[0]=x/degToRads,r[1]=b/degToRads,r[2]=_/degToRads}function createQuaternion(r){var a=r[0]*degToRads,n=r[1]*degToRads,o=r[2]*degToRads,f=Math.cos(a/2),y=Math.cos(n/2),x=Math.cos(o/2),b=Math.sin(a/2),_=Math.sin(n/2),S=Math.sin(o/2),A=f*y*x-b*_*S,C=b*_*x+f*y*S,P=b*y*x+f*_*S,T=f*_*x-b*y*S;return[C,P,T,A]}function getValueAtCurrentTime(){var r=this.comp.renderedFrame-this.offsetTime,a=this.keyframes[0].t-this.offsetTime,n=this.keyframes[this.keyframes.length-1].t-this.offsetTime;if(!(r===this._caching.lastFrame||this._caching.lastFrame!==initFrame&&(this._caching.lastFrame>=n&&r>=n||this._caching.lastFrame<a&&r<a))){this._caching.lastFrame>=r&&(this._caching._lastKeyframeIndex=-1,this._caching.lastIndex=0);var o=this.interpolateValue(r,this._caching);this.pv=o}return this._caching.lastFrame=r,this.pv}function setVValue(r){var a;if(this.propType==="unidimensional")a=r*this.mult,mathAbs(this.v-a)>1e-5&&(this.v=a,this._mdf=!0);else for(var n=0,o=this.v.length;n<o;)a=r[n]*this.mult,mathAbs(this.v[n]-a)>1e-5&&(this.v[n]=a,this._mdf=!0),n+=1}function processEffectsSequence(){if(!(this.elem.globalData.frameId===this.frameId||!this.effectsSequence.length)){if(this.lock){this.setVValue(this.pv);return}this.lock=!0,this._mdf=this._isFirstFrame;var r,a=this.effectsSequence.length,n=this.kf?this.pv:this.data.k;for(r=0;r<a;r+=1)n=this.effectsSequence[r](n);this.setVValue(n),this._isFirstFrame=!1,this.lock=!1,this.frameId=this.elem.globalData.frameId}}function addEffect(r){this.effectsSequence.push(r),this.container.addDynamicProperty(this)}function ValueProperty(r,a,n,o){this.propType="unidimensional",this.mult=n||1,this.data=a,this.v=n?a.k*n:a.k,this.pv=a.k,this._mdf=!1,this.elem=r,this.container=o,this.comp=r.comp,this.k=!1,this.kf=!1,this.vel=0,this.effectsSequence=[],this._isFirstFrame=!0,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.addEffect=addEffect}function MultiDimensionalProperty(r,a,n,o){this.propType="multidimensional",this.mult=n||1,this.data=a,this._mdf=!1,this.elem=r,this.container=o,this.comp=r.comp,this.k=!1,this.kf=!1,this.frameId=-1;var f,y=a.k.length;for(this.v=createTypedArray("float32",y),this.pv=createTypedArray("float32",y),this.vel=createTypedArray("float32",y),f=0;f<y;f+=1)this.v[f]=a.k[f]*this.mult,this.pv[f]=a.k[f];this._isFirstFrame=!0,this.effectsSequence=[],this.getValue=processEffectsSequence,this.setVValue=setVValue,this.addEffect=addEffect}function KeyframedValueProperty(r,a,n,o){this.propType="unidimensional",this.keyframes=a.k,this.keyframesMetadata=[],this.offsetTime=r.data.st,this.frameId=-1,this._caching={lastFrame:initFrame,lastIndex:0,value:0,_lastKeyframeIndex:-1},this.k=!0,this.kf=!0,this.data=a,this.mult=n||1,this.elem=r,this.container=o,this.comp=r.comp,this.v=initFrame,this.pv=initFrame,this._isFirstFrame=!0,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.interpolateValue=interpolateValue,this.effectsSequence=[getValueAtCurrentTime.bind(this)],this.addEffect=addEffect}function KeyframedMultidimensionalProperty(r,a,n,o){this.propType="multidimensional";var f,y=a.k.length,x,b,_,S;for(f=0;f<y-1;f+=1)a.k[f].to&&a.k[f].s&&a.k[f+1]&&a.k[f+1].s&&(x=a.k[f].s,b=a.k[f+1].s,_=a.k[f].to,S=a.k[f].ti,(x.length===2&&!(x[0]===b[0]&&x[1]===b[1])&&bez.pointOnLine2D(x[0],x[1],b[0],b[1],x[0]+_[0],x[1]+_[1])&&bez.pointOnLine2D(x[0],x[1],b[0],b[1],b[0]+S[0],b[1]+S[1])||x.length===3&&!(x[0]===b[0]&&x[1]===b[1]&&x[2]===b[2])&&bez.pointOnLine3D(x[0],x[1],x[2],b[0],b[1],b[2],x[0]+_[0],x[1]+_[1],x[2]+_[2])&&bez.pointOnLine3D(x[0],x[1],x[2],b[0],b[1],b[2],b[0]+S[0],b[1]+S[1],b[2]+S[2]))&&(a.k[f].to=null,a.k[f].ti=null),x[0]===b[0]&&x[1]===b[1]&&_[0]===0&&_[1]===0&&S[0]===0&&S[1]===0&&(x.length===2||x[2]===b[2]&&_[2]===0&&S[2]===0)&&(a.k[f].to=null,a.k[f].ti=null));this.effectsSequence=[getValueAtCurrentTime.bind(this)],this.data=a,this.keyframes=a.k,this.keyframesMetadata=[],this.offsetTime=r.data.st,this.k=!0,this.kf=!0,this._isFirstFrame=!0,this.mult=n||1,this.elem=r,this.container=o,this.comp=r.comp,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.interpolateValue=interpolateValue,this.frameId=-1;var A=a.k[0].s.length;for(this.v=createTypedArray("float32",A),this.pv=createTypedArray("float32",A),f=0;f<A;f+=1)this.v[f]=initFrame,this.pv[f]=initFrame;this._caching={lastFrame:initFrame,lastIndex:0,value:createTypedArray("float32",A)},this.addEffect=addEffect}var PropertyFactory=function(){function r(n,o,f,y,x){o.sid&&(o=n.globalData.slotManager.getProp(o));var b;if(!o.k.length)b=new ValueProperty(n,o,y,x);else if(typeof o.k[0]=="number")b=new MultiDimensionalProperty(n,o,y,x);else switch(f){case 0:b=new KeyframedValueProperty(n,o,y,x);break;case 1:b=new KeyframedMultidimensionalProperty(n,o,y,x);break}return b.effectsSequence.length&&x.addDynamicProperty(b),b}var a={getProp:r};return a}();function DynamicPropertyContainer(){}DynamicPropertyContainer.prototype={addDynamicProperty:function(a){this.dynamicProperties.indexOf(a)===-1&&(this.dynamicProperties.push(a),this.container.addDynamicProperty(this),this._isAnimated=!0)},iterateDynamicProperties:function(){this._mdf=!1;var a,n=this.dynamicProperties.length;for(a=0;a<n;a+=1)this.dynamicProperties[a].getValue(),this.dynamicProperties[a]._mdf&&(this._mdf=!0)},initDynamicPropertyContainer:function(a){this.container=a,this.dynamicProperties=[],this._mdf=!1,this._isAnimated=!1}};var pointPool=function(){function r(){return createTypedArray("float32",2)}return poolFactory(8,r)}();function ShapePath(){this.c=!1,this._length=0,this._maxLength=8,this.v=createSizedArray(this._maxLength),this.o=createSizedArray(this._maxLength),this.i=createSizedArray(this._maxLength)}ShapePath.prototype.setPathData=function(r,a){this.c=r,this.setLength(a);for(var n=0;n<a;)this.v[n]=pointPool.newElement(),this.o[n]=pointPool.newElement(),this.i[n]=pointPool.newElement(),n+=1},ShapePath.prototype.setLength=function(r){for(;this._maxLength<r;)this.doubleArrayLength();this._length=r},ShapePath.prototype.doubleArrayLength=function(){this.v=this.v.concat(createSizedArray(this._maxLength)),this.i=this.i.concat(createSizedArray(this._maxLength)),this.o=this.o.concat(createSizedArray(this._maxLength)),this._maxLength*=2},ShapePath.prototype.setXYAt=function(r,a,n,o,f){var y;switch(this._length=Math.max(this._length,o+1),this._length>=this._maxLength&&this.doubleArrayLength(),n){case"v":y=this.v;break;case"i":y=this.i;break;case"o":y=this.o;break;default:y=[];break}(!y[o]||y[o]&&!f)&&(y[o]=pointPool.newElement()),y[o][0]=r,y[o][1]=a},ShapePath.prototype.setTripleAt=function(r,a,n,o,f,y,x,b){this.setXYAt(r,a,"v",x,b),this.setXYAt(n,o,"o",x,b),this.setXYAt(f,y,"i",x,b)},ShapePath.prototype.reverse=function(){var r=new ShapePath;r.setPathData(this.c,this._length);var a=this.v,n=this.o,o=this.i,f=0;this.c&&(r.setTripleAt(a[0][0],a[0][1],o[0][0],o[0][1],n[0][0],n[0][1],0,!1),f=1);var y=this._length-1,x=this._length,b;for(b=f;b<x;b+=1)r.setTripleAt(a[y][0],a[y][1],o[y][0],o[y][1],n[y][0],n[y][1],b,!1),y-=1;return r},ShapePath.prototype.length=function(){return this._length};var shapePool=function(){function r(){return new ShapePath}function a(f){var y=f._length,x;for(x=0;x<y;x+=1)pointPool.release(f.v[x]),pointPool.release(f.i[x]),pointPool.release(f.o[x]),f.v[x]=null,f.i[x]=null,f.o[x]=null;f._length=0,f.c=!1}function n(f){var y=o.newElement(),x,b=f._length===void 0?f.v.length:f._length;for(y.setLength(b),y.c=f.c,x=0;x<b;x+=1)y.setTripleAt(f.v[x][0],f.v[x][1],f.o[x][0],f.o[x][1],f.i[x][0],f.i[x][1],x);return y}var o=poolFactory(4,r,a);return o.clone=n,o}();function ShapeCollection(){this._length=0,this._maxLength=4,this.shapes=createSizedArray(this._maxLength)}ShapeCollection.prototype.addShape=function(r){this._length===this._maxLength&&(this.shapes=this.shapes.concat(createSizedArray(this._maxLength)),this._maxLength*=2),this.shapes[this._length]=r,this._length+=1},ShapeCollection.prototype.releaseShapes=function(){var r;for(r=0;r<this._length;r+=1)shapePool.release(this.shapes[r]);this._length=0};var shapeCollectionPool=function(){var r={newShapeCollection:f,release:y},a=0,n=4,o=createSizedArray(n);function f(){var x;return a?(a-=1,x=o[a]):x=new ShapeCollection,x}function y(x){var b,_=x._length;for(b=0;b<_;b+=1)shapePool.release(x.shapes[b]);x._length=0,a===n&&(o=pooling.double(o),n*=2),o[a]=x,a+=1}return r}(),ShapePropertyFactory=function(){var r=-999999;function a(D,z,k){var L=k.lastIndex,R,F,B,N,j,G,Y,X,$,te=this.keyframes;if(D<te[0].t-this.offsetTime)R=te[0].s[0],B=!0,L=0;else if(D>=te[te.length-1].t-this.offsetTime)R=te[te.length-1].s?te[te.length-1].s[0]:te[te.length-2].e[0],B=!0;else{for(var ee=L,q=te.length-1,Z=!0,U,W,H;Z&&(U=te[ee],W=te[ee+1],!(W.t-this.offsetTime>D));)ee<q-1?ee+=1:Z=!1;if(H=this.keyframesMetadata[ee]||{},B=U.h===1,L=ee,!B){if(D>=W.t-this.offsetTime)X=1;else if(D<U.t-this.offsetTime)X=0;else{var K;H.__fnct?K=H.__fnct:(K=BezierFactory.getBezierEasing(U.o.x,U.o.y,U.i.x,U.i.y).get,H.__fnct=K),X=K((D-(U.t-this.offsetTime))/(W.t-this.offsetTime-(U.t-this.offsetTime)))}F=W.s?W.s[0]:U.e[0]}R=U.s[0]}for(G=z._length,Y=R.i[0].length,k.lastIndex=L,N=0;N<G;N+=1)for(j=0;j<Y;j+=1)$=B?R.i[N][j]:R.i[N][j]+(F.i[N][j]-R.i[N][j])*X,z.i[N][j]=$,$=B?R.o[N][j]:R.o[N][j]+(F.o[N][j]-R.o[N][j])*X,z.o[N][j]=$,$=B?R.v[N][j]:R.v[N][j]+(F.v[N][j]-R.v[N][j])*X,z.v[N][j]=$}function n(){var D=this.comp.renderedFrame-this.offsetTime,z=this.keyframes[0].t-this.offsetTime,k=this.keyframes[this.keyframes.length-1].t-this.offsetTime,L=this._caching.lastFrame;return L!==r&&(L<z&&D<z||L>k&&D>k)||(this._caching.lastIndex=L<D?this._caching.lastIndex:0,this.interpolateShape(D,this.pv,this._caching)),this._caching.lastFrame=D,this.pv}function o(){this.paths=this.localShapeCollection}function f(D,z){if(D._length!==z._length||D.c!==z.c)return!1;var k,L=D._length;for(k=0;k<L;k+=1)if(D.v[k][0]!==z.v[k][0]||D.v[k][1]!==z.v[k][1]||D.o[k][0]!==z.o[k][0]||D.o[k][1]!==z.o[k][1]||D.i[k][0]!==z.i[k][0]||D.i[k][1]!==z.i[k][1])return!1;return!0}function y(D){f(this.v,D)||(this.v=shapePool.clone(D),this.localShapeCollection.releaseShapes(),this.localShapeCollection.addShape(this.v),this._mdf=!0,this.paths=this.localShapeCollection)}function x(){if(this.elem.globalData.frameId!==this.frameId){if(!this.effectsSequence.length){this._mdf=!1;return}if(this.lock){this.setVValue(this.pv);return}this.lock=!0,this._mdf=!1;var D;this.kf?D=this.pv:this.data.ks?D=this.data.ks.k:D=this.data.pt.k;var z,k=this.effectsSequence.length;for(z=0;z<k;z+=1)D=this.effectsSequence[z](D);this.setVValue(D),this.lock=!1,this.frameId=this.elem.globalData.frameId}}function b(D,z,k){this.propType="shape",this.comp=D.comp,this.container=D,this.elem=D,this.data=z,this.k=!1,this.kf=!1,this._mdf=!1;var L=k===3?z.pt.k:z.ks.k;this.v=shapePool.clone(L),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.reset=o,this.effectsSequence=[]}function _(D){this.effectsSequence.push(D),this.container.addDynamicProperty(this)}b.prototype.interpolateShape=a,b.prototype.getValue=x,b.prototype.setVValue=y,b.prototype.addEffect=_;function S(D,z,k){this.propType="shape",this.comp=D.comp,this.elem=D,this.container=D,this.offsetTime=D.data.st,this.keyframes=k===3?z.pt.k:z.ks.k,this.keyframesMetadata=[],this.k=!0,this.kf=!0;var L=this.keyframes[0].s[0].i.length;this.v=shapePool.newElement(),this.v.setPathData(this.keyframes[0].s[0].c,L),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.lastFrame=r,this.reset=o,this._caching={lastFrame:r,lastIndex:0},this.effectsSequence=[n.bind(this)]}S.prototype.getValue=x,S.prototype.interpolateShape=a,S.prototype.setVValue=y,S.prototype.addEffect=_;var A=function(){var D=roundCorner;function z(k,L){this.v=shapePool.newElement(),this.v.setPathData(!0,4),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.localShapeCollection.addShape(this.v),this.d=L.d,this.elem=k,this.comp=k.comp,this.frameId=-1,this.initDynamicPropertyContainer(k),this.p=PropertyFactory.getProp(k,L.p,1,0,this),this.s=PropertyFactory.getProp(k,L.s,1,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertEllToPath())}return z.prototype={reset:o,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertEllToPath())},convertEllToPath:function(){var L=this.p.v[0],R=this.p.v[1],F=this.s.v[0]/2,B=this.s.v[1]/2,N=this.d!==3,j=this.v;j.v[0][0]=L,j.v[0][1]=R-B,j.v[1][0]=N?L+F:L-F,j.v[1][1]=R,j.v[2][0]=L,j.v[2][1]=R+B,j.v[3][0]=N?L-F:L+F,j.v[3][1]=R,j.i[0][0]=N?L-F*D:L+F*D,j.i[0][1]=R-B,j.i[1][0]=N?L+F:L-F,j.i[1][1]=R-B*D,j.i[2][0]=N?L+F*D:L-F*D,j.i[2][1]=R+B,j.i[3][0]=N?L-F:L+F,j.i[3][1]=R+B*D,j.o[0][0]=N?L+F*D:L-F*D,j.o[0][1]=R-B,j.o[1][0]=N?L+F:L-F,j.o[1][1]=R+B*D,j.o[2][0]=N?L-F*D:L+F*D,j.o[2][1]=R+B,j.o[3][0]=N?L-F:L+F,j.o[3][1]=R-B*D}},extendPrototype([DynamicPropertyContainer],z),z}(),C=function(){function D(z,k){this.v=shapePool.newElement(),this.v.setPathData(!0,0),this.elem=z,this.comp=z.comp,this.data=k,this.frameId=-1,this.d=k.d,this.initDynamicPropertyContainer(z),k.sy===1?(this.ir=PropertyFactory.getProp(z,k.ir,0,0,this),this.is=PropertyFactory.getProp(z,k.is,0,.01,this),this.convertToPath=this.convertStarToPath):this.convertToPath=this.convertPolygonToPath,this.pt=PropertyFactory.getProp(z,k.pt,0,0,this),this.p=PropertyFactory.getProp(z,k.p,1,0,this),this.r=PropertyFactory.getProp(z,k.r,0,degToRads,this),this.or=PropertyFactory.getProp(z,k.or,0,0,this),this.os=PropertyFactory.getProp(z,k.os,0,.01,this),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertToPath())}return D.prototype={reset:o,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertToPath())},convertStarToPath:function(){var k=Math.floor(this.pt.v)*2,L=Math.PI*2/k,R=!0,F=this.or.v,B=this.ir.v,N=this.os.v,j=this.is.v,G=2*Math.PI*F/(k*2),Y=2*Math.PI*B/(k*2),X,$,te,ee,q=-Math.PI/2;q+=this.r.v;var Z=this.data.d===3?-1:1;for(this.v._length=0,X=0;X<k;X+=1){$=R?F:B,te=R?N:j,ee=R?G:Y;var U=$*Math.cos(q),W=$*Math.sin(q),H=U===0&&W===0?0:W/Math.sqrt(U*U+W*W),K=U===0&&W===0?0:-U/Math.sqrt(U*U+W*W);U+=+this.p.v[0],W+=+this.p.v[1],this.v.setTripleAt(U,W,U-H*ee*te*Z,W-K*ee*te*Z,U+H*ee*te*Z,W+K*ee*te*Z,X,!0),R=!R,q+=L*Z}},convertPolygonToPath:function(){var k=Math.floor(this.pt.v),L=Math.PI*2/k,R=this.or.v,F=this.os.v,B=2*Math.PI*R/(k*4),N,j=-Math.PI*.5,G=this.data.d===3?-1:1;for(j+=this.r.v,this.v._length=0,N=0;N<k;N+=1){var Y=R*Math.cos(j),X=R*Math.sin(j),$=Y===0&&X===0?0:X/Math.sqrt(Y*Y+X*X),te=Y===0&&X===0?0:-Y/Math.sqrt(Y*Y+X*X);Y+=+this.p.v[0],X+=+this.p.v[1],this.v.setTripleAt(Y,X,Y-$*B*F*G,X-te*B*F*G,Y+$*B*F*G,X+te*B*F*G,N,!0),j+=L*G}this.paths.length=0,this.paths[0]=this.v}},extendPrototype([DynamicPropertyContainer],D),D}(),P=function(){function D(z,k){this.v=shapePool.newElement(),this.v.c=!0,this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.elem=z,this.comp=z.comp,this.frameId=-1,this.d=k.d,this.initDynamicPropertyContainer(z),this.p=PropertyFactory.getProp(z,k.p,1,0,this),this.s=PropertyFactory.getProp(z,k.s,1,0,this),this.r=PropertyFactory.getProp(z,k.r,0,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertRectToPath())}return D.prototype={convertRectToPath:function(){var k=this.p.v[0],L=this.p.v[1],R=this.s.v[0]/2,F=this.s.v[1]/2,B=bmMin(R,F,this.r.v),N=B*(1-roundCorner);this.v._length=0,this.d===2||this.d===1?(this.v.setTripleAt(k+R,L-F+B,k+R,L-F+B,k+R,L-F+N,0,!0),this.v.setTripleAt(k+R,L+F-B,k+R,L+F-N,k+R,L+F-B,1,!0),B!==0?(this.v.setTripleAt(k+R-B,L+F,k+R-B,L+F,k+R-N,L+F,2,!0),this.v.setTripleAt(k-R+B,L+F,k-R+N,L+F,k-R+B,L+F,3,!0),this.v.setTripleAt(k-R,L+F-B,k-R,L+F-B,k-R,L+F-N,4,!0),this.v.setTripleAt(k-R,L-F+B,k-R,L-F+N,k-R,L-F+B,5,!0),this.v.setTripleAt(k-R+B,L-F,k-R+B,L-F,k-R+N,L-F,6,!0),this.v.setTripleAt(k+R-B,L-F,k+R-N,L-F,k+R-B,L-F,7,!0)):(this.v.setTripleAt(k-R,L+F,k-R+N,L+F,k-R,L+F,2),this.v.setTripleAt(k-R,L-F,k-R,L-F+N,k-R,L-F,3))):(this.v.setTripleAt(k+R,L-F+B,k+R,L-F+N,k+R,L-F+B,0,!0),B!==0?(this.v.setTripleAt(k+R-B,L-F,k+R-B,L-F,k+R-N,L-F,1,!0),this.v.setTripleAt(k-R+B,L-F,k-R+N,L-F,k-R+B,L-F,2,!0),this.v.setTripleAt(k-R,L-F+B,k-R,L-F+B,k-R,L-F+N,3,!0),this.v.setTripleAt(k-R,L+F-B,k-R,L+F-N,k-R,L+F-B,4,!0),this.v.setTripleAt(k-R+B,L+F,k-R+B,L+F,k-R+N,L+F,5,!0),this.v.setTripleAt(k+R-B,L+F,k+R-N,L+F,k+R-B,L+F,6,!0),this.v.setTripleAt(k+R,L+F-B,k+R,L+F-B,k+R,L+F-N,7,!0)):(this.v.setTripleAt(k-R,L-F,k-R+N,L-F,k-R,L-F,1,!0),this.v.setTripleAt(k-R,L+F,k-R,L+F-N,k-R,L+F,2,!0),this.v.setTripleAt(k+R,L+F,k+R-N,L+F,k+R,L+F,3,!0)))},getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertRectToPath())},reset:o},extendPrototype([DynamicPropertyContainer],D),D}();function T(D,z,k){var L;if(k===3||k===4){var R=k===3?z.pt:z.ks,F=R.k;F.length?L=new S(D,z,k):L=new b(D,z,k)}else k===5?L=new P(D,z):k===6?L=new A(D,z):k===7&&(L=new C(D,z));return L.k&&D.addDynamicProperty(L),L}function M(){return b}function O(){return S}var I={};return I.getShapeProp=T,I.getConstructorFunction=M,I.getKeyframedConstructorFunction=O,I}();/*!
 Transformation Matrix v2.0
 (c) Epistemex 2014-2015
 www.epistemex.com
 By Ken Fyrstenberg
 Contributions by leeoniya.
 License: MIT, header required.
 */var Matrix=function(){var r=Math.cos,a=Math.sin,n=Math.tan,o=Math.round;function f(){return this.props[0]=1,this.props[1]=0,this.props[2]=0,this.props[3]=0,this.props[4]=0,this.props[5]=1,this.props[6]=0,this.props[7]=0,this.props[8]=0,this.props[9]=0,this.props[10]=1,this.props[11]=0,this.props[12]=0,this.props[13]=0,this.props[14]=0,this.props[15]=1,this}function y(U){if(U===0)return this;var W=r(U),H=a(U);return this._t(W,-H,0,0,H,W,0,0,0,0,1,0,0,0,0,1)}function x(U){if(U===0)return this;var W=r(U),H=a(U);return this._t(1,0,0,0,0,W,-H,0,0,H,W,0,0,0,0,1)}function b(U){if(U===0)return this;var W=r(U),H=a(U);return this._t(W,0,H,0,0,1,0,0,-H,0,W,0,0,0,0,1)}function _(U){if(U===0)return this;var W=r(U),H=a(U);return this._t(W,-H,0,0,H,W,0,0,0,0,1,0,0,0,0,1)}function S(U,W){return this._t(1,W,U,1,0,0)}function A(U,W){return this.shear(n(U),n(W))}function C(U,W){var H=r(W),K=a(W);return this._t(H,K,0,0,-K,H,0,0,0,0,1,0,0,0,0,1)._t(1,0,0,0,n(U),1,0,0,0,0,1,0,0,0,0,1)._t(H,-K,0,0,K,H,0,0,0,0,1,0,0,0,0,1)}function P(U,W,H){return!H&&H!==0&&(H=1),U===1&&W===1&&H===1?this:this._t(U,0,0,0,0,W,0,0,0,0,H,0,0,0,0,1)}function T(U,W,H,K,le,me,ne,pe,ge,ye,_e,ve,Ee,xe,Me,Pe){return this.props[0]=U,this.props[1]=W,this.props[2]=H,this.props[3]=K,this.props[4]=le,this.props[5]=me,this.props[6]=ne,this.props[7]=pe,this.props[8]=ge,this.props[9]=ye,this.props[10]=_e,this.props[11]=ve,this.props[12]=Ee,this.props[13]=xe,this.props[14]=Me,this.props[15]=Pe,this}function M(U,W,H){return H=H||0,U!==0||W!==0||H!==0?this._t(1,0,0,0,0,1,0,0,0,0,1,0,U,W,H,1):this}function O(U,W,H,K,le,me,ne,pe,ge,ye,_e,ve,Ee,xe,Me,Pe){var be=this.props;if(U===1&&W===0&&H===0&&K===0&&le===0&&me===1&&ne===0&&pe===0&&ge===0&&ye===0&&_e===1&&ve===0)return be[12]=be[12]*U+be[15]*Ee,be[13]=be[13]*me+be[15]*xe,be[14]=be[14]*_e+be[15]*Me,be[15]*=Pe,this._identityCalculated=!1,this;var Oe=be[0],Be=be[1],oe=be[2],De=be[3],ze=be[4],Ne=be[5],Le=be[6],bt=be[7],Ve=be[8],He=be[9],tt=be[10],ie=be[11],We=be[12],wt=be[13],Nt=be[14],Ot=be[15];return be[0]=Oe*U+Be*le+oe*ge+De*Ee,be[1]=Oe*W+Be*me+oe*ye+De*xe,be[2]=Oe*H+Be*ne+oe*_e+De*Me,be[3]=Oe*K+Be*pe+oe*ve+De*Pe,be[4]=ze*U+Ne*le+Le*ge+bt*Ee,be[5]=ze*W+Ne*me+Le*ye+bt*xe,be[6]=ze*H+Ne*ne+Le*_e+bt*Me,be[7]=ze*K+Ne*pe+Le*ve+bt*Pe,be[8]=Ve*U+He*le+tt*ge+ie*Ee,be[9]=Ve*W+He*me+tt*ye+ie*xe,be[10]=Ve*H+He*ne+tt*_e+ie*Me,be[11]=Ve*K+He*pe+tt*ve+ie*Pe,be[12]=We*U+wt*le+Nt*ge+Ot*Ee,be[13]=We*W+wt*me+Nt*ye+Ot*xe,be[14]=We*H+wt*ne+Nt*_e+Ot*Me,be[15]=We*K+wt*pe+Nt*ve+Ot*Pe,this._identityCalculated=!1,this}function I(U){var W=U.props;return this.transform(W[0],W[1],W[2],W[3],W[4],W[5],W[6],W[7],W[8],W[9],W[10],W[11],W[12],W[13],W[14],W[15])}function D(){return this._identityCalculated||(this._identity=!(this.props[0]!==1||this.props[1]!==0||this.props[2]!==0||this.props[3]!==0||this.props[4]!==0||this.props[5]!==1||this.props[6]!==0||this.props[7]!==0||this.props[8]!==0||this.props[9]!==0||this.props[10]!==1||this.props[11]!==0||this.props[12]!==0||this.props[13]!==0||this.props[14]!==0||this.props[15]!==1),this._identityCalculated=!0),this._identity}function z(U){for(var W=0;W<16;){if(U.props[W]!==this.props[W])return!1;W+=1}return!0}function k(U){var W;for(W=0;W<16;W+=1)U.props[W]=this.props[W];return U}function L(U){var W;for(W=0;W<16;W+=1)this.props[W]=U[W]}function R(U,W,H){return{x:U*this.props[0]+W*this.props[4]+H*this.props[8]+this.props[12],y:U*this.props[1]+W*this.props[5]+H*this.props[9]+this.props[13],z:U*this.props[2]+W*this.props[6]+H*this.props[10]+this.props[14]}}function F(U,W,H){return U*this.props[0]+W*this.props[4]+H*this.props[8]+this.props[12]}function B(U,W,H){return U*this.props[1]+W*this.props[5]+H*this.props[9]+this.props[13]}function N(U,W,H){return U*this.props[2]+W*this.props[6]+H*this.props[10]+this.props[14]}function j(){var U=this.props[0]*this.props[5]-this.props[1]*this.props[4],W=this.props[5]/U,H=-this.props[1]/U,K=-this.props[4]/U,le=this.props[0]/U,me=(this.props[4]*this.props[13]-this.props[5]*this.props[12])/U,ne=-(this.props[0]*this.props[13]-this.props[1]*this.props[12])/U,pe=new Matrix;return pe.props[0]=W,pe.props[1]=H,pe.props[4]=K,pe.props[5]=le,pe.props[12]=me,pe.props[13]=ne,pe}function G(U){var W=this.getInverseMatrix();return W.applyToPointArray(U[0],U[1],U[2]||0)}function Y(U){var W,H=U.length,K=[];for(W=0;W<H;W+=1)K[W]=G(U[W]);return K}function X(U,W,H){var K=createTypedArray("float32",6);if(this.isIdentity())K[0]=U[0],K[1]=U[1],K[2]=W[0],K[3]=W[1],K[4]=H[0],K[5]=H[1];else{var le=this.props[0],me=this.props[1],ne=this.props[4],pe=this.props[5],ge=this.props[12],ye=this.props[13];K[0]=U[0]*le+U[1]*ne+ge,K[1]=U[0]*me+U[1]*pe+ye,K[2]=W[0]*le+W[1]*ne+ge,K[3]=W[0]*me+W[1]*pe+ye,K[4]=H[0]*le+H[1]*ne+ge,K[5]=H[0]*me+H[1]*pe+ye}return K}function $(U,W,H){var K;return this.isIdentity()?K=[U,W,H]:K=[U*this.props[0]+W*this.props[4]+H*this.props[8]+this.props[12],U*this.props[1]+W*this.props[5]+H*this.props[9]+this.props[13],U*this.props[2]+W*this.props[6]+H*this.props[10]+this.props[14]],K}function te(U,W){if(this.isIdentity())return U+","+W;var H=this.props;return Math.round((U*H[0]+W*H[4]+H[12])*100)/100+","+Math.round((U*H[1]+W*H[5]+H[13])*100)/100}function ee(){for(var U=0,W=this.props,H="matrix3d(",K=1e4;U<16;)H+=o(W[U]*K)/K,H+=U===15?")":",",U+=1;return H}function q(U){var W=1e4;return U<1e-6&&U>0||U>-1e-6&&U<0?o(U*W)/W:U}function Z(){var U=this.props,W=q(U[0]),H=q(U[1]),K=q(U[4]),le=q(U[5]),me=q(U[12]),ne=q(U[13]);return"matrix("+W+","+H+","+K+","+le+","+me+","+ne+")"}return function(){this.reset=f,this.rotate=y,this.rotateX=x,this.rotateY=b,this.rotateZ=_,this.skew=A,this.skewFromAxis=C,this.shear=S,this.scale=P,this.setTransform=T,this.translate=M,this.transform=O,this.multiply=I,this.applyToPoint=R,this.applyToX=F,this.applyToY=B,this.applyToZ=N,this.applyToPointArray=$,this.applyToTriplePoints=X,this.applyToPointStringified=te,this.toCSS=ee,this.to2dCSS=Z,this.clone=k,this.cloneFromProps=L,this.equals=z,this.inversePoints=Y,this.inversePoint=G,this.getInverseMatrix=j,this._t=this.transform,this.isIdentity=D,this._identity=!0,this._identityCalculated=!1,this.props=createTypedArray("float32",16),this.reset()}}();function _typeof$3(r){"@babel/helpers - typeof";return _typeof$3=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof$3(r)}var lottie={};function setLocation(r){setLocationHref(r)}function searchAnimations(){animationManager.searchAnimations()}function setSubframeRendering(r){setSubframeEnabled(r)}function setPrefix(r){setIdPrefix(r)}function loadAnimation(r){return animationManager.loadAnimation(r)}function setQuality(r){if(typeof r=="string")switch(r){case"high":setDefaultCurveSegments(200);break;default:case"medium":setDefaultCurveSegments(50);break;case"low":setDefaultCurveSegments(10);break}else!isNaN(r)&&r>1&&setDefaultCurveSegments(r)}function inBrowser(){return typeof navigator<"u"}function installPlugin(r,a){r==="expressions"&&setExpressionsPlugin(a)}function getFactory(r){switch(r){case"propertyFactory":return PropertyFactory;case"shapePropertyFactory":return ShapePropertyFactory;case"matrix":return Matrix;default:return null}}lottie.play=animationManager.play,lottie.pause=animationManager.pause,lottie.setLocationHref=setLocation,lottie.togglePause=animationManager.togglePause,lottie.setSpeed=animationManager.setSpeed,lottie.setDirection=animationManager.setDirection,lottie.stop=animationManager.stop,lottie.searchAnimations=searchAnimations,lottie.registerAnimation=animationManager.registerAnimation,lottie.loadAnimation=loadAnimation,lottie.setSubframeRendering=setSubframeRendering,lottie.resize=animationManager.resize,lottie.goToAndStop=animationManager.goToAndStop,lottie.destroy=animationManager.destroy,lottie.setQuality=setQuality,lottie.inBrowser=inBrowser,lottie.installPlugin=installPlugin,lottie.freeze=animationManager.freeze,lottie.unfreeze=animationManager.unfreeze,lottie.setVolume=animationManager.setVolume,lottie.mute=animationManager.mute,lottie.unmute=animationManager.unmute,lottie.getRegisteredAnimations=animationManager.getRegisteredAnimations,lottie.useWebWorker=setWebWorker,lottie.setIDPrefix=setPrefix,lottie.__getFactory=getFactory,lottie.version="5.13.0";function checkReady(){document.readyState==="complete"&&(clearInterval(readyStateCheckInterval),searchAnimations())}function getQueryVariable(r){for(var a=queryString.split("&"),n=0;n<a.length;n+=1){var o=a[n].split("=");if(decodeURIComponent(o[0])==r)return decodeURIComponent(o[1])}return null}var queryString="";{var scripts=document.getElementsByTagName("script"),index=scripts.length-1,myScript=scripts[index]||{src:""};queryString=myScript.src?myScript.src.replace(/^[^\?]+\??/,""):"",getQueryVariable("renderer")}var readyStateCheckInterval=setInterval(checkReady,100);try{_typeof$3(exports)!=="object"&&(window.bodymovin=lottie)}catch(r){}var ShapeModifiers=function(){var r={},a={};r.registerModifier=n,r.getModifier=o;function n(f,y){a[f]||(a[f]=y)}function o(f,y,x){return new a[f](y,x)}return r}();function ShapeModifier(){}ShapeModifier.prototype.initModifierProperties=function(){},ShapeModifier.prototype.addShapeToModifier=function(){},ShapeModifier.prototype.addShape=function(r){if(!this.closed){r.sh.container.addDynamicProperty(r.sh);var a={shape:r.sh,data:r,localShapeCollection:shapeCollectionPool.newShapeCollection()};this.shapes.push(a),this.addShapeToModifier(a),this._isAnimated&&r.setAsAnimated()}},ShapeModifier.prototype.init=function(r,a){this.shapes=[],this.elem=r,this.initDynamicPropertyContainer(r),this.initModifierProperties(r,a),this.frameId=initialDefaultFrame,this.closed=!1,this.k=!1,this.dynamicProperties.length?this.k=!0:this.getValue(!0)},ShapeModifier.prototype.processKeys=function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties())},extendPrototype([DynamicPropertyContainer],ShapeModifier);function TrimModifier(){}extendPrototype([ShapeModifier],TrimModifier),TrimModifier.prototype.initModifierProperties=function(r,a){this.s=PropertyFactory.getProp(r,a.s,0,.01,this),this.e=PropertyFactory.getProp(r,a.e,0,.01,this),this.o=PropertyFactory.getProp(r,a.o,0,0,this),this.sValue=0,this.eValue=0,this.getValue=this.processKeys,this.m=a.m,this._isAnimated=!!this.s.effectsSequence.length||!!this.e.effectsSequence.length||!!this.o.effectsSequence.length},TrimModifier.prototype.addShapeToModifier=function(r){r.pathsData=[]},TrimModifier.prototype.calculateShapeEdges=function(r,a,n,o,f){var y=[];a<=1?y.push({s:r,e:a}):r>=1?y.push({s:r-1,e:a-1}):(y.push({s:r,e:1}),y.push({s:0,e:a-1}));var x=[],b,_=y.length,S;for(b=0;b<_;b+=1)if(S=y[b],!(S.e*f<o||S.s*f>o+n)){var A,C;S.s*f<=o?A=0:A=(S.s*f-o)/n,S.e*f>=o+n?C=1:C=(S.e*f-o)/n,x.push([A,C])}return x.length||x.push([0,0]),x},TrimModifier.prototype.releasePathsData=function(r){var a,n=r.length;for(a=0;a<n;a+=1)segmentsLengthPool.release(r[a]);return r.length=0,r},TrimModifier.prototype.processShapes=function(r){var a,n;if(this._mdf||r){var o=this.o.v%360/360;if(o<0&&(o+=1),this.s.v>1?a=1+o:this.s.v<0?a=0+o:a=this.s.v+o,this.e.v>1?n=1+o:this.e.v<0?n=0+o:n=this.e.v+o,a>n){var f=a;a=n,n=f}a=Math.round(a*1e4)*1e-4,n=Math.round(n*1e4)*1e-4,this.sValue=a,this.eValue=n}else a=this.sValue,n=this.eValue;var y,x,b=this.shapes.length,_,S,A,C,P,T=0;if(n===a)for(x=0;x<b;x+=1)this.shapes[x].localShapeCollection.releaseShapes(),this.shapes[x].shape._mdf=!0,this.shapes[x].shape.paths=this.shapes[x].localShapeCollection,this._mdf&&(this.shapes[x].pathsData.length=0);else if(n===1&&a===0||n===0&&a===1){if(this._mdf)for(x=0;x<b;x+=1)this.shapes[x].pathsData.length=0,this.shapes[x].shape._mdf=!0}else{var M=[],O,I;for(x=0;x<b;x+=1)if(O=this.shapes[x],!O.shape._mdf&&!this._mdf&&!r&&this.m!==2)O.shape.paths=O.localShapeCollection;else{if(y=O.shape.paths,S=y._length,P=0,!O.shape._mdf&&O.pathsData.length)P=O.totalShapeLength;else{for(A=this.releasePathsData(O.pathsData),_=0;_<S;_+=1)C=bez.getSegmentsLength(y.shapes[_]),A.push(C),P+=C.totalLength;O.totalShapeLength=P,O.pathsData=A}T+=P,O.shape._mdf=!0}var D=a,z=n,k=0,L;for(x=b-1;x>=0;x-=1)if(O=this.shapes[x],O.shape._mdf){for(I=O.localShapeCollection,I.releaseShapes(),this.m===2&&b>1?(L=this.calculateShapeEdges(a,n,O.totalShapeLength,k,T),k+=O.totalShapeLength):L=[[D,z]],S=L.length,_=0;_<S;_+=1){D=L[_][0],z=L[_][1],M.length=0,z<=1?M.push({s:O.totalShapeLength*D,e:O.totalShapeLength*z}):D>=1?M.push({s:O.totalShapeLength*(D-1),e:O.totalShapeLength*(z-1)}):(M.push({s:O.totalShapeLength*D,e:O.totalShapeLength}),M.push({s:0,e:O.totalShapeLength*(z-1)}));var R=this.addShapes(O,M[0]);if(M[0].s!==M[0].e){if(M.length>1){var F=O.shape.paths.shapes[O.shape.paths._length-1];if(F.c){var B=R.pop();this.addPaths(R,I),R=this.addShapes(O,M[1],B)}else this.addPaths(R,I),R=this.addShapes(O,M[1])}this.addPaths(R,I)}}O.shape.paths=I}}},TrimModifier.prototype.addPaths=function(r,a){var n,o=r.length;for(n=0;n<o;n+=1)a.addShape(r[n])},TrimModifier.prototype.addSegment=function(r,a,n,o,f,y,x){f.setXYAt(a[0],a[1],"o",y),f.setXYAt(n[0],n[1],"i",y+1),x&&f.setXYAt(r[0],r[1],"v",y),f.setXYAt(o[0],o[1],"v",y+1)},TrimModifier.prototype.addSegmentFromArray=function(r,a,n,o){a.setXYAt(r[1],r[5],"o",n),a.setXYAt(r[2],r[6],"i",n+1),o&&a.setXYAt(r[0],r[4],"v",n),a.setXYAt(r[3],r[7],"v",n+1)},TrimModifier.prototype.addShapes=function(r,a,n){var o=r.pathsData,f=r.shape.paths.shapes,y,x=r.shape.paths._length,b,_,S=0,A,C,P,T,M=[],O,I=!0;for(n?(C=n._length,O=n._length):(n=shapePool.newElement(),C=0,O=0),M.push(n),y=0;y<x;y+=1){for(P=o[y].lengths,n.c=f[y].c,_=f[y].c?P.length:P.length+1,b=1;b<_;b+=1)if(A=P[b-1],S+A.addedLength<a.s)S+=A.addedLength,n.c=!1;else if(S>a.e){n.c=!1;break}else a.s<=S&&a.e>=S+A.addedLength?(this.addSegment(f[y].v[b-1],f[y].o[b-1],f[y].i[b],f[y].v[b],n,C,I),I=!1):(T=bez.getNewSegment(f[y].v[b-1],f[y].v[b],f[y].o[b-1],f[y].i[b],(a.s-S)/A.addedLength,(a.e-S)/A.addedLength,P[b-1]),this.addSegmentFromArray(T,n,C,I),I=!1,n.c=!1),S+=A.addedLength,C+=1;if(f[y].c&&P.length){if(A=P[b-1],S<=a.e){var D=P[b-1].addedLength;a.s<=S&&a.e>=S+D?(this.addSegment(f[y].v[b-1],f[y].o[b-1],f[y].i[0],f[y].v[0],n,C,I),I=!1):(T=bez.getNewSegment(f[y].v[b-1],f[y].v[0],f[y].o[b-1],f[y].i[0],(a.s-S)/D,(a.e-S)/D,P[b-1]),this.addSegmentFromArray(T,n,C,I),I=!1,n.c=!1)}else n.c=!1;S+=A.addedLength,C+=1}if(n._length&&(n.setXYAt(n.v[O][0],n.v[O][1],"i",O),n.setXYAt(n.v[n._length-1][0],n.v[n._length-1][1],"o",n._length-1)),S>a.e)break;y<x-1&&(n=shapePool.newElement(),I=!0,M.push(n),C=0)}return M};function PuckerAndBloatModifier(){}extendPrototype([ShapeModifier],PuckerAndBloatModifier),PuckerAndBloatModifier.prototype.initModifierProperties=function(r,a){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(r,a.a,0,null,this),this._isAnimated=!!this.amount.effectsSequence.length},PuckerAndBloatModifier.prototype.processPath=function(r,a){var n=a/100,o=[0,0],f=r._length,y=0;for(y=0;y<f;y+=1)o[0]+=r.v[y][0],o[1]+=r.v[y][1];o[0]/=f,o[1]/=f;var x=shapePool.newElement();x.c=r.c;var b,_,S,A,C,P;for(y=0;y<f;y+=1)b=r.v[y][0]+(o[0]-r.v[y][0])*n,_=r.v[y][1]+(o[1]-r.v[y][1])*n,S=r.o[y][0]+(o[0]-r.o[y][0])*-n,A=r.o[y][1]+(o[1]-r.o[y][1])*-n,C=r.i[y][0]+(o[0]-r.i[y][0])*-n,P=r.i[y][1]+(o[1]-r.i[y][1])*-n,x.setTripleAt(b,_,S,A,C,P,y);return x},PuckerAndBloatModifier.prototype.processShapes=function(r){var a,n,o=this.shapes.length,f,y,x=this.amount.v;if(x!==0){var b,_;for(n=0;n<o;n+=1){if(b=this.shapes[n],_=b.localShapeCollection,!(!b.shape._mdf&&!this._mdf&&!r))for(_.releaseShapes(),b.shape._mdf=!0,a=b.shape.paths.shapes,y=b.shape.paths._length,f=0;f<y;f+=1)_.addShape(this.processPath(a[f],x));b.shape.paths=b.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};var TransformPropertyFactory=function(){var r=[0,0];function a(_){var S=this._mdf;this.iterateDynamicProperties(),this._mdf=this._mdf||S,this.a&&_.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.s&&_.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&_.skewFromAxis(-this.sk.v,this.sa.v),this.r?_.rotate(-this.r.v):_.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.data.p.s?this.data.p.z?_.translate(this.px.v,this.py.v,-this.pz.v):_.translate(this.px.v,this.py.v,0):_.translate(this.p.v[0],this.p.v[1],-this.p.v[2])}function n(_){if(this.elem.globalData.frameId!==this.frameId){if(this._isDirty&&(this.precalculateMatrix(),this._isDirty=!1),this.iterateDynamicProperties(),this._mdf||_){var S;if(this.v.cloneFromProps(this.pre.props),this.appliedTransformations<1&&this.v.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations<2&&this.v.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&this.appliedTransformations<3&&this.v.skewFromAxis(-this.sk.v,this.sa.v),this.r&&this.appliedTransformations<4?this.v.rotate(-this.r.v):!this.r&&this.appliedTransformations<4&&this.v.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.autoOriented){var A,C;if(S=this.elem.globalData.frameRate,this.p&&this.p.keyframes&&this.p.getValueAtTime)this.p._caching.lastFrame+this.p.offsetTime<=this.p.keyframes[0].t?(A=this.p.getValueAtTime((this.p.keyframes[0].t+.01)/S,0),C=this.p.getValueAtTime(this.p.keyframes[0].t/S,0)):this.p._caching.lastFrame+this.p.offsetTime>=this.p.keyframes[this.p.keyframes.length-1].t?(A=this.p.getValueAtTime(this.p.keyframes[this.p.keyframes.length-1].t/S,0),C=this.p.getValueAtTime((this.p.keyframes[this.p.keyframes.length-1].t-.05)/S,0)):(A=this.p.pv,C=this.p.getValueAtTime((this.p._caching.lastFrame+this.p.offsetTime-.01)/S,this.p.offsetTime));else if(this.px&&this.px.keyframes&&this.py.keyframes&&this.px.getValueAtTime&&this.py.getValueAtTime){A=[],C=[];var P=this.px,T=this.py;P._caching.lastFrame+P.offsetTime<=P.keyframes[0].t?(A[0]=P.getValueAtTime((P.keyframes[0].t+.01)/S,0),A[1]=T.getValueAtTime((T.keyframes[0].t+.01)/S,0),C[0]=P.getValueAtTime(P.keyframes[0].t/S,0),C[1]=T.getValueAtTime(T.keyframes[0].t/S,0)):P._caching.lastFrame+P.offsetTime>=P.keyframes[P.keyframes.length-1].t?(A[0]=P.getValueAtTime(P.keyframes[P.keyframes.length-1].t/S,0),A[1]=T.getValueAtTime(T.keyframes[T.keyframes.length-1].t/S,0),C[0]=P.getValueAtTime((P.keyframes[P.keyframes.length-1].t-.01)/S,0),C[1]=T.getValueAtTime((T.keyframes[T.keyframes.length-1].t-.01)/S,0)):(A=[P.pv,T.pv],C[0]=P.getValueAtTime((P._caching.lastFrame+P.offsetTime-.01)/S,P.offsetTime),C[1]=T.getValueAtTime((T._caching.lastFrame+T.offsetTime-.01)/S,T.offsetTime))}else C=r,A=C;this.v.rotate(-Math.atan2(A[1]-C[1],A[0]-C[0]))}this.data.p&&this.data.p.s?this.data.p.z?this.v.translate(this.px.v,this.py.v,-this.pz.v):this.v.translate(this.px.v,this.py.v,0):this.v.translate(this.p.v[0],this.p.v[1],-this.p.v[2])}this.frameId=this.elem.globalData.frameId}}function o(){if(this.appliedTransformations=0,this.pre.reset(),!this.a.effectsSequence.length)this.pre.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations=1;else return;if(!this.s.effectsSequence.length)this.pre.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.appliedTransformations=2;else return;if(this.sk)if(!this.sk.effectsSequence.length&&!this.sa.effectsSequence.length)this.pre.skewFromAxis(-this.sk.v,this.sa.v),this.appliedTransformations=3;else return;this.r?this.r.effectsSequence.length||(this.pre.rotate(-this.r.v),this.appliedTransformations=4):!this.rz.effectsSequence.length&&!this.ry.effectsSequence.length&&!this.rx.effectsSequence.length&&!this.or.effectsSequence.length&&(this.pre.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.appliedTransformations=4)}function f(){}function y(_){this._addDynamicProperty(_),this.elem.addDynamicProperty(_),this._isDirty=!0}function x(_,S,A){if(this.elem=_,this.frameId=-1,this.propType="transform",this.data=S,this.v=new Matrix,this.pre=new Matrix,this.appliedTransformations=0,this.initDynamicPropertyContainer(A||_),S.p&&S.p.s?(this.px=PropertyFactory.getProp(_,S.p.x,0,0,this),this.py=PropertyFactory.getProp(_,S.p.y,0,0,this),S.p.z&&(this.pz=PropertyFactory.getProp(_,S.p.z,0,0,this))):this.p=PropertyFactory.getProp(_,S.p||{k:[0,0,0]},1,0,this),S.rx){if(this.rx=PropertyFactory.getProp(_,S.rx,0,degToRads,this),this.ry=PropertyFactory.getProp(_,S.ry,0,degToRads,this),this.rz=PropertyFactory.getProp(_,S.rz,0,degToRads,this),S.or.k[0].ti){var C,P=S.or.k.length;for(C=0;C<P;C+=1)S.or.k[C].to=null,S.or.k[C].ti=null}this.or=PropertyFactory.getProp(_,S.or,1,degToRads,this),this.or.sh=!0}else this.r=PropertyFactory.getProp(_,S.r||{k:0},0,degToRads,this);S.sk&&(this.sk=PropertyFactory.getProp(_,S.sk,0,degToRads,this),this.sa=PropertyFactory.getProp(_,S.sa,0,degToRads,this)),this.a=PropertyFactory.getProp(_,S.a||{k:[0,0,0]},1,0,this),this.s=PropertyFactory.getProp(_,S.s||{k:[100,100,100]},1,.01,this),S.o?this.o=PropertyFactory.getProp(_,S.o,0,.01,_):this.o={_mdf:!1,v:1},this._isDirty=!0,this.dynamicProperties.length||this.getValue(!0)}x.prototype={applyToMatrix:a,getValue:n,precalculateMatrix:o,autoOrient:f},extendPrototype([DynamicPropertyContainer],x),x.prototype.addDynamicProperty=y,x.prototype._addDynamicProperty=DynamicPropertyContainer.prototype.addDynamicProperty;function b(_,S,A){return new x(_,S,A)}return{getTransformProperty:b}}();function RepeaterModifier(){}extendPrototype([ShapeModifier],RepeaterModifier),RepeaterModifier.prototype.initModifierProperties=function(r,a){this.getValue=this.processKeys,this.c=PropertyFactory.getProp(r,a.c,0,null,this),this.o=PropertyFactory.getProp(r,a.o,0,null,this),this.tr=TransformPropertyFactory.getTransformProperty(r,a.tr,this),this.so=PropertyFactory.getProp(r,a.tr.so,0,.01,this),this.eo=PropertyFactory.getProp(r,a.tr.eo,0,.01,this),this.data=a,this.dynamicProperties.length||this.getValue(!0),this._isAnimated=!!this.dynamicProperties.length,this.pMatrix=new Matrix,this.rMatrix=new Matrix,this.sMatrix=new Matrix,this.tMatrix=new Matrix,this.matrix=new Matrix},RepeaterModifier.prototype.applyTransforms=function(r,a,n,o,f,y){var x=y?-1:1,b=o.s.v[0]+(1-o.s.v[0])*(1-f),_=o.s.v[1]+(1-o.s.v[1])*(1-f);r.translate(o.p.v[0]*x*f,o.p.v[1]*x*f,o.p.v[2]),a.translate(-o.a.v[0],-o.a.v[1],o.a.v[2]),a.rotate(-o.r.v*x*f),a.translate(o.a.v[0],o.a.v[1],o.a.v[2]),n.translate(-o.a.v[0],-o.a.v[1],o.a.v[2]),n.scale(y?1/b:b,y?1/_:_),n.translate(o.a.v[0],o.a.v[1],o.a.v[2])},RepeaterModifier.prototype.init=function(r,a,n,o){for(this.elem=r,this.arr=a,this.pos=n,this.elemsData=o,this._currentCopies=0,this._elements=[],this._groups=[],this.frameId=-1,this.initDynamicPropertyContainer(r),this.initModifierProperties(r,a[n]);n>0;)n-=1,this._elements.unshift(a[n]);this.dynamicProperties.length?this.k=!0:this.getValue(!0)},RepeaterModifier.prototype.resetElements=function(r){var a,n=r.length;for(a=0;a<n;a+=1)r[a]._processed=!1,r[a].ty==="gr"&&this.resetElements(r[a].it)},RepeaterModifier.prototype.cloneElements=function(r){var a=JSON.parse(JSON.stringify(r));return this.resetElements(a),a},RepeaterModifier.prototype.changeGroupRender=function(r,a){var n,o=r.length;for(n=0;n<o;n+=1)r[n]._render=a,r[n].ty==="gr"&&this.changeGroupRender(r[n].it,a)},RepeaterModifier.prototype.processShapes=function(r){var a,n,o,f,y,x=!1;if(this._mdf||r){var b=Math.ceil(this.c.v);if(this._groups.length<b){for(;this._groups.length<b;){var _={it:this.cloneElements(this._elements),ty:"gr"};_.it.push({a:{a:0,ix:1,k:[0,0]},nm:"Transform",o:{a:0,ix:7,k:100},p:{a:0,ix:2,k:[0,0]},r:{a:1,ix:6,k:[{s:0,e:0,t:0},{s:0,e:0,t:1}]},s:{a:0,ix:3,k:[100,100]},sa:{a:0,ix:5,k:0},sk:{a:0,ix:4,k:0},ty:"tr"}),this.arr.splice(0,0,_),this._groups.splice(0,0,_),this._currentCopies+=1}this.elem.reloadShapes(),x=!0}y=0;var S;for(o=0;o<=this._groups.length-1;o+=1){if(S=y<b,this._groups[o]._render=S,this.changeGroupRender(this._groups[o].it,S),!S){var A=this.elemsData[o].it,C=A[A.length-1];C.transform.op.v!==0?(C.transform.op._mdf=!0,C.transform.op.v=0):C.transform.op._mdf=!1}y+=1}this._currentCopies=b;var P=this.o.v,T=P%1,M=P>0?Math.floor(P):Math.ceil(P),O=this.pMatrix.props,I=this.rMatrix.props,D=this.sMatrix.props;this.pMatrix.reset(),this.rMatrix.reset(),this.sMatrix.reset(),this.tMatrix.reset(),this.matrix.reset();var z=0;if(P>0){for(;z<M;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),z+=1;T&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,T,!1),z+=T)}else if(P<0){for(;z>M;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!0),z-=1;T&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,-T,!0),z-=T)}o=this.data.m===1?0:this._currentCopies-1,f=this.data.m===1?1:-1,y=this._currentCopies;for(var k,L;y;){if(a=this.elemsData[o].it,n=a[a.length-1].transform.mProps.v.props,L=n.length,a[a.length-1].transform.mProps._mdf=!0,a[a.length-1].transform.op._mdf=!0,a[a.length-1].transform.op.v=this._currentCopies===1?this.so.v:this.so.v+(this.eo.v-this.so.v)*(o/(this._currentCopies-1)),z!==0){for((o!==0&&f===1||o!==this._currentCopies-1&&f===-1)&&this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),this.matrix.transform(I[0],I[1],I[2],I[3],I[4],I[5],I[6],I[7],I[8],I[9],I[10],I[11],I[12],I[13],I[14],I[15]),this.matrix.transform(D[0],D[1],D[2],D[3],D[4],D[5],D[6],D[7],D[8],D[9],D[10],D[11],D[12],D[13],D[14],D[15]),this.matrix.transform(O[0],O[1],O[2],O[3],O[4],O[5],O[6],O[7],O[8],O[9],O[10],O[11],O[12],O[13],O[14],O[15]),k=0;k<L;k+=1)n[k]=this.matrix.props[k];this.matrix.reset()}else for(this.matrix.reset(),k=0;k<L;k+=1)n[k]=this.matrix.props[k];z+=1,y-=1,o+=f}}else for(y=this._currentCopies,o=0,f=1;y;)a=this.elemsData[o].it,n=a[a.length-1].transform.mProps.v.props,a[a.length-1].transform.mProps._mdf=!1,a[a.length-1].transform.op._mdf=!1,y-=1,o+=f;return x},RepeaterModifier.prototype.addShape=function(){};function RoundCornersModifier(){}extendPrototype([ShapeModifier],RoundCornersModifier),RoundCornersModifier.prototype.initModifierProperties=function(r,a){this.getValue=this.processKeys,this.rd=PropertyFactory.getProp(r,a.r,0,null,this),this._isAnimated=!!this.rd.effectsSequence.length},RoundCornersModifier.prototype.processPath=function(r,a){var n=shapePool.newElement();n.c=r.c;var o,f=r._length,y,x,b,_,S,A,C=0,P,T,M,O,I,D;for(o=0;o<f;o+=1)y=r.v[o],b=r.o[o],x=r.i[o],y[0]===b[0]&&y[1]===b[1]&&y[0]===x[0]&&y[1]===x[1]?(o===0||o===f-1)&&!r.c?(n.setTripleAt(y[0],y[1],b[0],b[1],x[0],x[1],C),C+=1):(o===0?_=r.v[f-1]:_=r.v[o-1],S=Math.sqrt(Math.pow(y[0]-_[0],2)+Math.pow(y[1]-_[1],2)),A=S?Math.min(S/2,a)/S:0,I=y[0]+(_[0]-y[0])*A,P=I,D=y[1]-(y[1]-_[1])*A,T=D,M=P-(P-y[0])*roundCorner,O=T-(T-y[1])*roundCorner,n.setTripleAt(P,T,M,O,I,D,C),C+=1,o===f-1?_=r.v[0]:_=r.v[o+1],S=Math.sqrt(Math.pow(y[0]-_[0],2)+Math.pow(y[1]-_[1],2)),A=S?Math.min(S/2,a)/S:0,M=y[0]+(_[0]-y[0])*A,P=M,O=y[1]+(_[1]-y[1])*A,T=O,I=P-(P-y[0])*roundCorner,D=T-(T-y[1])*roundCorner,n.setTripleAt(P,T,M,O,I,D,C),C+=1):(n.setTripleAt(r.v[o][0],r.v[o][1],r.o[o][0],r.o[o][1],r.i[o][0],r.i[o][1],C),C+=1);return n},RoundCornersModifier.prototype.processShapes=function(r){var a,n,o=this.shapes.length,f,y,x=this.rd.v;if(x!==0){var b,_;for(n=0;n<o;n+=1){if(b=this.shapes[n],_=b.localShapeCollection,!(!b.shape._mdf&&!this._mdf&&!r))for(_.releaseShapes(),b.shape._mdf=!0,a=b.shape.paths.shapes,y=b.shape.paths._length,f=0;f<y;f+=1)_.addShape(this.processPath(a[f],x));b.shape.paths=b.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};function floatEqual(r,a){return Math.abs(r-a)*1e5<=Math.min(Math.abs(r),Math.abs(a))}function floatZero(r){return Math.abs(r)<=1e-5}function lerp(r,a,n){return r*(1-n)+a*n}function lerpPoint(r,a,n){return[lerp(r[0],a[0],n),lerp(r[1],a[1],n)]}function quadRoots(r,a,n){if(r===0)return[];var o=a*a-4*r*n;if(o<0)return[];var f=-a/(2*r);if(o===0)return[f];var y=Math.sqrt(o)/(2*r);return[f-y,f+y]}function polynomialCoefficients(r,a,n,o){return[-r+3*a-3*n+o,3*r-6*a+3*n,-3*r+3*a,r]}function singlePoint(r){return new PolynomialBezier(r,r,r,r,!1)}function PolynomialBezier(r,a,n,o,f){f&&pointEqual(r,a)&&(a=lerpPoint(r,o,1/3)),f&&pointEqual(n,o)&&(n=lerpPoint(r,o,2/3));var y=polynomialCoefficients(r[0],a[0],n[0],o[0]),x=polynomialCoefficients(r[1],a[1],n[1],o[1]);this.a=[y[0],x[0]],this.b=[y[1],x[1]],this.c=[y[2],x[2]],this.d=[y[3],x[3]],this.points=[r,a,n,o]}PolynomialBezier.prototype.point=function(r){return[((this.a[0]*r+this.b[0])*r+this.c[0])*r+this.d[0],((this.a[1]*r+this.b[1])*r+this.c[1])*r+this.d[1]]},PolynomialBezier.prototype.derivative=function(r){return[(3*r*this.a[0]+2*this.b[0])*r+this.c[0],(3*r*this.a[1]+2*this.b[1])*r+this.c[1]]},PolynomialBezier.prototype.tangentAngle=function(r){var a=this.derivative(r);return Math.atan2(a[1],a[0])},PolynomialBezier.prototype.normalAngle=function(r){var a=this.derivative(r);return Math.atan2(a[0],a[1])},PolynomialBezier.prototype.inflectionPoints=function(){var r=this.a[1]*this.b[0]-this.a[0]*this.b[1];if(floatZero(r))return[];var a=-.5*(this.a[1]*this.c[0]-this.a[0]*this.c[1])/r,n=a*a-1/3*(this.b[1]*this.c[0]-this.b[0]*this.c[1])/r;if(n<0)return[];var o=Math.sqrt(n);return floatZero(o)?o>0&&o<1?[a]:[]:[a-o,a+o].filter(function(f){return f>0&&f<1})},PolynomialBezier.prototype.split=function(r){if(r<=0)return[singlePoint(this.points[0]),this];if(r>=1)return[this,singlePoint(this.points[this.points.length-1])];var a=lerpPoint(this.points[0],this.points[1],r),n=lerpPoint(this.points[1],this.points[2],r),o=lerpPoint(this.points[2],this.points[3],r),f=lerpPoint(a,n,r),y=lerpPoint(n,o,r),x=lerpPoint(f,y,r);return[new PolynomialBezier(this.points[0],a,f,x,!0),new PolynomialBezier(x,y,o,this.points[3],!0)]};function extrema(r,a){var n=r.points[0][a],o=r.points[r.points.length-1][a];if(n>o){var f=o;o=n,n=f}for(var y=quadRoots(3*r.a[a],2*r.b[a],r.c[a]),x=0;x<y.length;x+=1)if(y[x]>0&&y[x]<1){var b=r.point(y[x])[a];b<n?n=b:b>o&&(o=b)}return{min:n,max:o}}PolynomialBezier.prototype.bounds=function(){return{x:extrema(this,0),y:extrema(this,1)}},PolynomialBezier.prototype.boundingBox=function(){var r=this.bounds();return{left:r.x.min,right:r.x.max,top:r.y.min,bottom:r.y.max,width:r.x.max-r.x.min,height:r.y.max-r.y.min,cx:(r.x.max+r.x.min)/2,cy:(r.y.max+r.y.min)/2}};function intersectData(r,a,n){var o=r.boundingBox();return{cx:o.cx,cy:o.cy,width:o.width,height:o.height,bez:r,t:(a+n)/2,t1:a,t2:n}}function splitData(r){var a=r.bez.split(.5);return[intersectData(a[0],r.t1,r.t),intersectData(a[1],r.t,r.t2)]}function boxIntersect(r,a){return Math.abs(r.cx-a.cx)*2<r.width+a.width&&Math.abs(r.cy-a.cy)*2<r.height+a.height}function intersectsImpl(r,a,n,o,f,y){if(boxIntersect(r,a)){if(n>=y||r.width<=o&&r.height<=o&&a.width<=o&&a.height<=o){f.push([r.t,a.t]);return}var x=splitData(r),b=splitData(a);intersectsImpl(x[0],b[0],n+1,o,f,y),intersectsImpl(x[0],b[1],n+1,o,f,y),intersectsImpl(x[1],b[0],n+1,o,f,y),intersectsImpl(x[1],b[1],n+1,o,f,y)}}PolynomialBezier.prototype.intersections=function(r,a,n){a===void 0&&(a=2),n===void 0&&(n=7);var o=[];return intersectsImpl(intersectData(this,0,1),intersectData(r,0,1),0,a,o,n),o},PolynomialBezier.shapeSegment=function(r,a){var n=(a+1)%r.length();return new PolynomialBezier(r.v[a],r.o[a],r.i[n],r.v[n],!0)},PolynomialBezier.shapeSegmentInverted=function(r,a){var n=(a+1)%r.length();return new PolynomialBezier(r.v[n],r.i[n],r.o[a],r.v[a],!0)};function crossProduct(r,a){return[r[1]*a[2]-r[2]*a[1],r[2]*a[0]-r[0]*a[2],r[0]*a[1]-r[1]*a[0]]}function lineIntersection(r,a,n,o){var f=[r[0],r[1],1],y=[a[0],a[1],1],x=[n[0],n[1],1],b=[o[0],o[1],1],_=crossProduct(crossProduct(f,y),crossProduct(x,b));return floatZero(_[2])?null:[_[0]/_[2],_[1]/_[2]]}function polarOffset(r,a,n){return[r[0]+Math.cos(a)*n,r[1]-Math.sin(a)*n]}function pointDistance(r,a){return Math.hypot(r[0]-a[0],r[1]-a[1])}function pointEqual(r,a){return floatEqual(r[0],a[0])&&floatEqual(r[1],a[1])}function ZigZagModifier(){}extendPrototype([ShapeModifier],ZigZagModifier),ZigZagModifier.prototype.initModifierProperties=function(r,a){this.getValue=this.processKeys,this.amplitude=PropertyFactory.getProp(r,a.s,0,null,this),this.frequency=PropertyFactory.getProp(r,a.r,0,null,this),this.pointsType=PropertyFactory.getProp(r,a.pt,0,null,this),this._isAnimated=this.amplitude.effectsSequence.length!==0||this.frequency.effectsSequence.length!==0||this.pointsType.effectsSequence.length!==0};function setPoint(r,a,n,o,f,y,x){var b=n-Math.PI/2,_=n+Math.PI/2,S=a[0]+Math.cos(n)*o*f,A=a[1]-Math.sin(n)*o*f;r.setTripleAt(S,A,S+Math.cos(b)*y,A-Math.sin(b)*y,S+Math.cos(_)*x,A-Math.sin(_)*x,r.length())}function getPerpendicularVector(r,a){var n=[a[0]-r[0],a[1]-r[1]],o=-Math.PI*.5,f=[Math.cos(o)*n[0]-Math.sin(o)*n[1],Math.sin(o)*n[0]+Math.cos(o)*n[1]];return f}function getProjectingAngle(r,a){var n=a===0?r.length()-1:a-1,o=(a+1)%r.length(),f=r.v[n],y=r.v[o],x=getPerpendicularVector(f,y);return Math.atan2(0,1)-Math.atan2(x[1],x[0])}function zigZagCorner(r,a,n,o,f,y,x){var b=getProjectingAngle(a,n),_=a.v[n%a._length],S=a.v[n===0?a._length-1:n-1],A=a.v[(n+1)%a._length],C=y===2?Math.sqrt(Math.pow(_[0]-S[0],2)+Math.pow(_[1]-S[1],2)):0,P=y===2?Math.sqrt(Math.pow(_[0]-A[0],2)+Math.pow(_[1]-A[1],2)):0;setPoint(r,a.v[n%a._length],b,x,o,P/((f+1)*2),C/((f+1)*2))}function zigZagSegment(r,a,n,o,f,y){for(var x=0;x<o;x+=1){var b=(x+1)/(o+1),_=f===2?Math.sqrt(Math.pow(a.points[3][0]-a.points[0][0],2)+Math.pow(a.points[3][1]-a.points[0][1],2)):0,S=a.normalAngle(b),A=a.point(b);setPoint(r,A,S,y,n,_/((o+1)*2),_/((o+1)*2)),y=-y}return y}ZigZagModifier.prototype.processPath=function(r,a,n,o){var f=r._length,y=shapePool.newElement();if(y.c=r.c,r.c||(f-=1),f===0)return y;var x=-1,b=PolynomialBezier.shapeSegment(r,0);zigZagCorner(y,r,0,a,n,o,x);for(var _=0;_<f;_+=1)x=zigZagSegment(y,b,a,n,o,-x),_===f-1&&!r.c?b=null:b=PolynomialBezier.shapeSegment(r,(_+1)%f),zigZagCorner(y,r,_+1,a,n,o,x);return y},ZigZagModifier.prototype.processShapes=function(r){var a,n,o=this.shapes.length,f,y,x=this.amplitude.v,b=Math.max(0,Math.round(this.frequency.v)),_=this.pointsType.v;if(x!==0){var S,A;for(n=0;n<o;n+=1){if(S=this.shapes[n],A=S.localShapeCollection,!(!S.shape._mdf&&!this._mdf&&!r))for(A.releaseShapes(),S.shape._mdf=!0,a=S.shape.paths.shapes,y=S.shape.paths._length,f=0;f<y;f+=1)A.addShape(this.processPath(a[f],x,b,_));S.shape.paths=S.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};function linearOffset(r,a,n){var o=Math.atan2(a[0]-r[0],a[1]-r[1]);return[polarOffset(r,o,n),polarOffset(a,o,n)]}function offsetSegment(r,a){var n,o,f,y,x,b,_;_=linearOffset(r.points[0],r.points[1],a),n=_[0],o=_[1],_=linearOffset(r.points[1],r.points[2],a),f=_[0],y=_[1],_=linearOffset(r.points[2],r.points[3],a),x=_[0],b=_[1];var S=lineIntersection(n,o,f,y);S===null&&(S=o);var A=lineIntersection(x,b,f,y);return A===null&&(A=x),new PolynomialBezier(n,S,A,b)}function joinLines(r,a,n,o,f){var y=a.points[3],x=n.points[0];if(o===3||pointEqual(y,x))return y;if(o===2){var b=-a.tangentAngle(1),_=-n.tangentAngle(0)+Math.PI,S=lineIntersection(y,polarOffset(y,b+Math.PI/2,100),x,polarOffset(x,b+Math.PI/2,100)),A=S?pointDistance(S,y):pointDistance(y,x)/2,C=polarOffset(y,b,2*A*roundCorner);return r.setXYAt(C[0],C[1],"o",r.length()-1),C=polarOffset(x,_,2*A*roundCorner),r.setTripleAt(x[0],x[1],x[0],x[1],C[0],C[1],r.length()),x}var P=pointEqual(y,a.points[2])?a.points[0]:a.points[2],T=pointEqual(x,n.points[1])?n.points[3]:n.points[1],M=lineIntersection(P,y,x,T);return M&&pointDistance(M,y)<f?(r.setTripleAt(M[0],M[1],M[0],M[1],M[0],M[1],r.length()),M):y}function getIntersection(r,a){var n=r.intersections(a);return n.length&&floatEqual(n[0][0],1)&&n.shift(),n.length?n[0]:null}function pruneSegmentIntersection(r,a){var n=r.slice(),o=a.slice(),f=getIntersection(r[r.length-1],a[0]);return f&&(n[r.length-1]=r[r.length-1].split(f[0])[0],o[0]=a[0].split(f[1])[1]),r.length>1&&a.length>1&&(f=getIntersection(r[0],a[a.length-1]),f)?[[r[0].split(f[0])[0]],[a[a.length-1].split(f[1])[1]]]:[n,o]}function pruneIntersections(r){for(var a,n=1;n<r.length;n+=1)a=pruneSegmentIntersection(r[n-1],r[n]),r[n-1]=a[0],r[n]=a[1];return r.length>1&&(a=pruneSegmentIntersection(r[r.length-1],r[0]),r[r.length-1]=a[0],r[0]=a[1]),r}function offsetSegmentSplit(r,a){var n=r.inflectionPoints(),o,f,y,x;if(n.length===0)return[offsetSegment(r,a)];if(n.length===1||floatEqual(n[1],1))return y=r.split(n[0]),o=y[0],f=y[1],[offsetSegment(o,a),offsetSegment(f,a)];y=r.split(n[0]),o=y[0];var b=(n[1]-n[0])/(1-n[0]);return y=y[1].split(b),x=y[0],f=y[1],[offsetSegment(o,a),offsetSegment(x,a),offsetSegment(f,a)]}function OffsetPathModifier(){}extendPrototype([ShapeModifier],OffsetPathModifier),OffsetPathModifier.prototype.initModifierProperties=function(r,a){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(r,a.a,0,null,this),this.miterLimit=PropertyFactory.getProp(r,a.ml,0,null,this),this.lineJoin=a.lj,this._isAnimated=this.amount.effectsSequence.length!==0},OffsetPathModifier.prototype.processPath=function(r,a,n,o){var f=shapePool.newElement();f.c=r.c;var y=r.length();r.c||(y-=1);var x,b,_,S=[];for(x=0;x<y;x+=1)_=PolynomialBezier.shapeSegment(r,x),S.push(offsetSegmentSplit(_,a));if(!r.c)for(x=y-1;x>=0;x-=1)_=PolynomialBezier.shapeSegmentInverted(r,x),S.push(offsetSegmentSplit(_,a));S=pruneIntersections(S);var A=null,C=null;for(x=0;x<S.length;x+=1){var P=S[x];for(C&&(A=joinLines(f,C,P[0],n,o)),C=P[P.length-1],b=0;b<P.length;b+=1)_=P[b],A&&pointEqual(_.points[0],A)?f.setXYAt(_.points[1][0],_.points[1][1],"o",f.length()-1):f.setTripleAt(_.points[0][0],_.points[0][1],_.points[1][0],_.points[1][1],_.points[0][0],_.points[0][1],f.length()),f.setTripleAt(_.points[3][0],_.points[3][1],_.points[3][0],_.points[3][1],_.points[2][0],_.points[2][1],f.length()),A=_.points[3]}return S.length&&joinLines(f,C,S[0][0],n,o),f},OffsetPathModifier.prototype.processShapes=function(r){var a,n,o=this.shapes.length,f,y,x=this.amount.v,b=this.miterLimit.v,_=this.lineJoin;if(x!==0){var S,A;for(n=0;n<o;n+=1){if(S=this.shapes[n],A=S.localShapeCollection,!(!S.shape._mdf&&!this._mdf&&!r))for(A.releaseShapes(),S.shape._mdf=!0,a=S.shape.paths.shapes,y=S.shape.paths._length,f=0;f<y;f+=1)A.addShape(this.processPath(a[f],x,_,b));S.shape.paths=S.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};function getFontProperties(r){for(var a=r.fStyle?r.fStyle.split(" "):[],n="normal",o="normal",f=a.length,y,x=0;x<f;x+=1)switch(y=a[x].toLowerCase(),y){case"italic":o="italic";break;case"bold":n="700";break;case"black":n="900";break;case"medium":n="500";break;case"regular":case"normal":n="400";break;case"light":case"thin":n="200";break}return{style:o,weight:r.fWeight||n}}var FontManager=function(){var r=5e3,a={w:0,size:0,shapes:[],data:{shapes:[]}},n=[];n=n.concat([2304,2305,2306,2307,2362,2363,2364,2364,2366,2367,2368,2369,2370,2371,2372,2373,2374,2375,2376,2377,2378,2379,2380,2381,2382,2383,2387,2388,2389,2390,2391,2402,2403]);var o=127988,f=917631,y=917601,x=917626,b=65039,_=8205,S=127462,A=127487,C=["d83cdffb","d83cdffc","d83cdffd","d83cdffe","d83cdfff"];function P(q){var Z=q.split(","),U,W=Z.length,H=[];for(U=0;U<W;U+=1)Z[U]!=="sans-serif"&&Z[U]!=="monospace"&&H.push(Z[U]);return H.join(",")}function T(q,Z){var U=createTag("span");U.setAttribute("aria-hidden",!0),U.style.fontFamily=Z;var W=createTag("span");W.innerText="giItT1WQy@!-/#",U.style.position="absolute",U.style.left="-10000px",U.style.top="-10000px",U.style.fontSize="300px",U.style.fontVariant="normal",U.style.fontStyle="normal",U.style.fontWeight="normal",U.style.letterSpacing="0",U.appendChild(W),document.body.appendChild(U);var H=W.offsetWidth;return W.style.fontFamily=P(q)+", "+Z,{node:W,w:H,parent:U}}function M(){var q,Z=this.fonts.length,U,W,H=Z;for(q=0;q<Z;q+=1)this.fonts[q].loaded?H-=1:this.fonts[q].fOrigin==="n"||this.fonts[q].origin===0?this.fonts[q].loaded=!0:(U=this.fonts[q].monoCase.node,W=this.fonts[q].monoCase.w,U.offsetWidth!==W?(H-=1,this.fonts[q].loaded=!0):(U=this.fonts[q].sansCase.node,W=this.fonts[q].sansCase.w,U.offsetWidth!==W&&(H-=1,this.fonts[q].loaded=!0)),this.fonts[q].loaded&&(this.fonts[q].sansCase.parent.parentNode.removeChild(this.fonts[q].sansCase.parent),this.fonts[q].monoCase.parent.parentNode.removeChild(this.fonts[q].monoCase.parent)));H!==0&&Date.now()-this.initTime<r?setTimeout(this.checkLoadedFontsBinded,20):setTimeout(this.setIsLoadedBinded,10)}function O(q,Z){var U=document.body&&Z?"svg":"canvas",W,H=getFontProperties(q);if(U==="svg"){var K=createNS("text");K.style.fontSize="100px",K.setAttribute("font-family",q.fFamily),K.setAttribute("font-style",H.style),K.setAttribute("font-weight",H.weight),K.textContent="1",q.fClass?(K.style.fontFamily="inherit",K.setAttribute("class",q.fClass)):K.style.fontFamily=q.fFamily,Z.appendChild(K),W=K}else{var le=new OffscreenCanvas(500,500).getContext("2d");le.font=H.style+" "+H.weight+" 100px "+q.fFamily,W=le}function me(ne){return U==="svg"?(W.textContent=ne,W.getComputedTextLength()):W.measureText(ne).width}return{measureText:me}}function I(q,Z){if(!q){this.isLoaded=!0;return}if(this.chars){this.isLoaded=!0,this.fonts=q.list;return}if(!document.body){this.isLoaded=!0,q.list.forEach(function(_e){_e.helper=O(_e),_e.cache={}}),this.fonts=q.list;return}var U=q.list,W,H=U.length,K=H;for(W=0;W<H;W+=1){var le=!0,me,ne;if(U[W].loaded=!1,U[W].monoCase=T(U[W].fFamily,"monospace"),U[W].sansCase=T(U[W].fFamily,"sans-serif"),!U[W].fPath)U[W].loaded=!0,K-=1;else if(U[W].fOrigin==="p"||U[W].origin===3){if(me=document.querySelectorAll('style[f-forigin="p"][f-family="'+U[W].fFamily+'"], style[f-origin="3"][f-family="'+U[W].fFamily+'"]'),me.length>0&&(le=!1),le){var pe=createTag("style");pe.setAttribute("f-forigin",U[W].fOrigin),pe.setAttribute("f-origin",U[W].origin),pe.setAttribute("f-family",U[W].fFamily),pe.type="text/css",pe.innerText="@font-face {font-family: "+U[W].fFamily+"; font-style: normal; src: url('"+U[W].fPath+"');}",Z.appendChild(pe)}}else if(U[W].fOrigin==="g"||U[W].origin===1){for(me=document.querySelectorAll('link[f-forigin="g"], link[f-origin="1"]'),ne=0;ne<me.length;ne+=1)me[ne].href.indexOf(U[W].fPath)!==-1&&(le=!1);if(le){var ge=createTag("link");ge.setAttribute("f-forigin",U[W].fOrigin),ge.setAttribute("f-origin",U[W].origin),ge.type="text/css",ge.rel="stylesheet",ge.href=U[W].fPath,document.body.appendChild(ge)}}else if(U[W].fOrigin==="t"||U[W].origin===2){for(me=document.querySelectorAll('script[f-forigin="t"], script[f-origin="2"]'),ne=0;ne<me.length;ne+=1)U[W].fPath===me[ne].src&&(le=!1);if(le){var ye=createTag("link");ye.setAttribute("f-forigin",U[W].fOrigin),ye.setAttribute("f-origin",U[W].origin),ye.setAttribute("rel","stylesheet"),ye.setAttribute("href",U[W].fPath),Z.appendChild(ye)}}U[W].helper=O(U[W],Z),U[W].cache={},this.fonts.push(U[W])}K===0?this.isLoaded=!0:setTimeout(this.checkLoadedFonts.bind(this),100)}function D(q){if(q){this.chars||(this.chars=[]);var Z,U=q.length,W,H=this.chars.length,K;for(Z=0;Z<U;Z+=1){for(W=0,K=!1;W<H;)this.chars[W].style===q[Z].style&&this.chars[W].fFamily===q[Z].fFamily&&this.chars[W].ch===q[Z].ch&&(K=!0),W+=1;K||(this.chars.push(q[Z]),H+=1)}}}function z(q,Z,U){for(var W=0,H=this.chars.length;W<H;){if(this.chars[W].ch===q&&this.chars[W].style===Z&&this.chars[W].fFamily===U)return this.chars[W];W+=1}return(typeof q=="string"&&q.charCodeAt(0)!==13||!q)&&console&&console.warn&&!this._warned&&(this._warned=!0,console.warn("Missing character from exported characters list: ",q,Z,U)),a}function k(q,Z,U){var W=this.getFontByName(Z),H=q;if(!W.cache[H]){var K=W.helper;if(q===" "){var le=K.measureText("|"+q+"|"),me=K.measureText("||");W.cache[H]=(le-me)/100}else W.cache[H]=K.measureText(q)/100}return W.cache[H]*U}function L(q){for(var Z=0,U=this.fonts.length;Z<U;){if(this.fonts[Z].fName===q)return this.fonts[Z];Z+=1}return this.fonts[0]}function R(q){var Z=0,U=q.charCodeAt(0);if(U>=55296&&U<=56319){var W=q.charCodeAt(1);W>=56320&&W<=57343&&(Z=(U-55296)*1024+W-56320+65536)}return Z}function F(q,Z){var U=q.toString(16)+Z.toString(16);return C.indexOf(U)!==-1}function B(q){return q===_}function N(q){return q===b}function j(q){var Z=R(q);return Z>=S&&Z<=A}function G(q){return j(q.substr(0,2))&&j(q.substr(2,2))}function Y(q){return n.indexOf(q)!==-1}function X(q,Z){var U=R(q.substr(Z,2));if(U!==o)return!1;var W=0;for(Z+=2;W<5;){if(U=R(q.substr(Z,2)),U<y||U>x)return!1;W+=1,Z+=2}return R(q.substr(Z,2))===f}function $(){this.isLoaded=!0}var te=function(){this.fonts=[],this.chars=null,this.typekitLoaded=0,this.isLoaded=!1,this._warned=!1,this.initTime=Date.now(),this.setIsLoadedBinded=this.setIsLoaded.bind(this),this.checkLoadedFontsBinded=this.checkLoadedFonts.bind(this)};te.isModifier=F,te.isZeroWidthJoiner=B,te.isFlagEmoji=G,te.isRegionalCode=j,te.isCombinedCharacter=Y,te.isRegionalFlag=X,te.isVariationSelector=N,te.BLACK_FLAG_CODE_POINT=o;var ee={addChars:D,addFonts:I,getCharData:z,getFontByName:L,measureText:k,checkLoadedFonts:M,setIsLoaded:$};return te.prototype=ee,te}();function SlotManager(r){this.animationData=r}SlotManager.prototype.getProp=function(r){return this.animationData.slots&&this.animationData.slots[r.sid]?Object.assign(r,this.animationData.slots[r.sid].p):r};function slotFactory(r){return new SlotManager(r)}function RenderableElement(){}RenderableElement.prototype={initRenderable:function(){this.isInRange=!1,this.hidden=!1,this.isTransparent=!1,this.renderableComponents=[]},addRenderableComponent:function(a){this.renderableComponents.indexOf(a)===-1&&this.renderableComponents.push(a)},removeRenderableComponent:function(a){this.renderableComponents.indexOf(a)!==-1&&this.renderableComponents.splice(this.renderableComponents.indexOf(a),1)},prepareRenderableFrame:function(a){this.checkLayerLimits(a)},checkTransparency:function(){this.finalTransform.mProp.o.v<=0?!this.isTransparent&&this.globalData.renderConfig.hideOnTransparent&&(this.isTransparent=!0,this.hide()):this.isTransparent&&(this.isTransparent=!1,this.show())},checkLayerLimits:function(a){this.data.ip-this.data.st<=a&&this.data.op-this.data.st>a?this.isInRange!==!0&&(this.globalData._mdf=!0,this._mdf=!0,this.isInRange=!0,this.show()):this.isInRange!==!1&&(this.globalData._mdf=!0,this.isInRange=!1,this.hide())},renderRenderable:function(){var a,n=this.renderableComponents.length;for(a=0;a<n;a+=1)this.renderableComponents[a].renderFrame(this._isFirstFrame)},sourceRectAtTime:function(){return{top:0,left:0,width:100,height:100}},getLayerSize:function(){return this.data.ty===5?{w:this.data.textData.width,h:this.data.textData.height}:{w:this.data.width,h:this.data.height}}};var getBlendMode=function(){var r={0:"source-over",1:"multiply",2:"screen",3:"overlay",4:"darken",5:"lighten",6:"color-dodge",7:"color-burn",8:"hard-light",9:"soft-light",10:"difference",11:"exclusion",12:"hue",13:"saturation",14:"color",15:"luminosity"};return function(a){return r[a]||""}}();function SliderEffect(r,a,n){this.p=PropertyFactory.getProp(a,r.v,0,0,n)}function AngleEffect(r,a,n){this.p=PropertyFactory.getProp(a,r.v,0,0,n)}function ColorEffect(r,a,n){this.p=PropertyFactory.getProp(a,r.v,1,0,n)}function PointEffect(r,a,n){this.p=PropertyFactory.getProp(a,r.v,1,0,n)}function LayerIndexEffect(r,a,n){this.p=PropertyFactory.getProp(a,r.v,0,0,n)}function MaskIndexEffect(r,a,n){this.p=PropertyFactory.getProp(a,r.v,0,0,n)}function CheckboxEffect(r,a,n){this.p=PropertyFactory.getProp(a,r.v,0,0,n)}function NoValueEffect(){this.p={}}function EffectsManager(r,a){var n=r.ef||[];this.effectElements=[];var o,f=n.length,y;for(o=0;o<f;o+=1)y=new GroupEffect(n[o],a),this.effectElements.push(y)}function GroupEffect(r,a){this.init(r,a)}extendPrototype([DynamicPropertyContainer],GroupEffect),GroupEffect.prototype.getValue=GroupEffect.prototype.iterateDynamicProperties,GroupEffect.prototype.init=function(r,a){this.data=r,this.effectElements=[],this.initDynamicPropertyContainer(a);var n,o=this.data.ef.length,f,y=this.data.ef;for(n=0;n<o;n+=1){switch(f=null,y[n].ty){case 0:f=new SliderEffect(y[n],a,this);break;case 1:f=new AngleEffect(y[n],a,this);break;case 2:f=new ColorEffect(y[n],a,this);break;case 3:f=new PointEffect(y[n],a,this);break;case 4:case 7:f=new CheckboxEffect(y[n],a,this);break;case 10:f=new LayerIndexEffect(y[n],a,this);break;case 11:f=new MaskIndexEffect(y[n],a,this);break;case 5:f=new EffectsManager(y[n],a);break;default:f=new NoValueEffect(y[n]);break}f&&this.effectElements.push(f)}};function BaseElement(){}BaseElement.prototype={checkMasks:function(){if(!this.data.hasMask)return!1;for(var a=0,n=this.data.masksProperties.length;a<n;){if(this.data.masksProperties[a].mode!=="n"&&this.data.masksProperties[a].cl!==!1)return!0;a+=1}return!1},initExpressions:function(){var a=getExpressionInterfaces();if(a){var n=a("layer"),o=a("effects"),f=a("shape"),y=a("text"),x=a("comp");this.layerInterface=n(this),this.data.hasMask&&this.maskManager&&this.layerInterface.registerMaskInterface(this.maskManager);var b=o.createEffectsInterface(this,this.layerInterface);this.layerInterface.registerEffectsInterface(b),this.data.ty===0||this.data.xt?this.compInterface=x(this):this.data.ty===4?(this.layerInterface.shapeInterface=f(this.shapesData,this.itemsData,this.layerInterface),this.layerInterface.content=this.layerInterface.shapeInterface):this.data.ty===5&&(this.layerInterface.textInterface=y(this),this.layerInterface.text=this.layerInterface.textInterface)}},setBlendMode:function(){var a=getBlendMode(this.data.bm),n=this.baseElement||this.layerElement;n.style["mix-blend-mode"]=a},initBaseData:function(a,n,o){this.globalData=n,this.comp=o,this.data=a,this.layerId=createElementID(),this.data.sr||(this.data.sr=1),this.effectsManager=new EffectsManager(this.data,this,this.dynamicProperties)},getType:function(){return this.type},sourceRectAtTime:function(){}};function FrameElement(){}FrameElement.prototype={initFrame:function(){this._isFirstFrame=!1,this.dynamicProperties=[],this._mdf=!1},prepareProperties:function(a,n){var o,f=this.dynamicProperties.length;for(o=0;o<f;o+=1)(n||this._isParent&&this.dynamicProperties[o].propType==="transform")&&(this.dynamicProperties[o].getValue(),this.dynamicProperties[o]._mdf&&(this.globalData._mdf=!0,this._mdf=!0))},addDynamicProperty:function(a){this.dynamicProperties.indexOf(a)===-1&&this.dynamicProperties.push(a)}};function FootageElement(r,a,n){this.initFrame(),this.initRenderable(),this.assetData=a.getAssetData(r.refId),this.footageData=a.imageLoader.getAsset(this.assetData),this.initBaseData(r,a,n)}FootageElement.prototype.prepareFrame=function(){},extendPrototype([RenderableElement,BaseElement,FrameElement],FootageElement),FootageElement.prototype.getBaseElement=function(){return null},FootageElement.prototype.renderFrame=function(){},FootageElement.prototype.destroy=function(){},FootageElement.prototype.initExpressions=function(){var r=getExpressionInterfaces();if(r){var a=r("footage");this.layerInterface=a(this)}},FootageElement.prototype.getFootageData=function(){return this.footageData};function AudioElement(r,a,n){this.initFrame(),this.initRenderable(),this.assetData=a.getAssetData(r.refId),this.initBaseData(r,a,n),this._isPlaying=!1,this._canPlay=!1;var o=this.globalData.getAssetsPath(this.assetData);this.audio=this.globalData.audioController.createAudio(o),this._currentTime=0,this.globalData.audioController.addAudio(this),this._volumeMultiplier=1,this._volume=1,this._previousVolume=null,this.tm=r.tm?PropertyFactory.getProp(this,r.tm,0,a.frameRate,this):{_placeholder:!0},this.lv=PropertyFactory.getProp(this,r.au&&r.au.lv?r.au.lv:{k:[100]},1,.01,this)}AudioElement.prototype.prepareFrame=function(r){if(this.prepareRenderableFrame(r,!0),this.prepareProperties(r,!0),this.tm._placeholder)this._currentTime=r/this.data.sr;else{var a=this.tm.v;this._currentTime=a}this._volume=this.lv.v[0];var n=this._volume*this._volumeMultiplier;this._previousVolume!==n&&(this._previousVolume=n,this.audio.volume(n))},extendPrototype([RenderableElement,BaseElement,FrameElement],AudioElement),AudioElement.prototype.renderFrame=function(){this.isInRange&&this._canPlay&&(this._isPlaying?(!this.audio.playing()||Math.abs(this._currentTime/this.globalData.frameRate-this.audio.seek())>.1)&&this.audio.seek(this._currentTime/this.globalData.frameRate):(this.audio.play(),this.audio.seek(this._currentTime/this.globalData.frameRate),this._isPlaying=!0))},AudioElement.prototype.show=function(){},AudioElement.prototype.hide=function(){this.audio.pause(),this._isPlaying=!1},AudioElement.prototype.pause=function(){this.audio.pause(),this._isPlaying=!1,this._canPlay=!1},AudioElement.prototype.resume=function(){this._canPlay=!0},AudioElement.prototype.setRate=function(r){this.audio.rate(r)},AudioElement.prototype.volume=function(r){this._volumeMultiplier=r,this._previousVolume=r*this._volume,this.audio.volume(this._previousVolume)},AudioElement.prototype.getBaseElement=function(){return null},AudioElement.prototype.destroy=function(){},AudioElement.prototype.sourceRectAtTime=function(){},AudioElement.prototype.initExpressions=function(){};function BaseRenderer(){}BaseRenderer.prototype.checkLayers=function(r){var a,n=this.layers.length,o;for(this.completeLayers=!0,a=n-1;a>=0;a-=1)this.elements[a]||(o=this.layers[a],o.ip-o.st<=r-this.layers[a].st&&o.op-o.st>r-this.layers[a].st&&this.buildItem(a)),this.completeLayers=this.elements[a]?this.completeLayers:!1;this.checkPendingElements()},BaseRenderer.prototype.createItem=function(r){switch(r.ty){case 2:return this.createImage(r);case 0:return this.createComp(r);case 1:return this.createSolid(r);case 3:return this.createNull(r);case 4:return this.createShape(r);case 5:return this.createText(r);case 6:return this.createAudio(r);case 13:return this.createCamera(r);case 15:return this.createFootage(r);default:return this.createNull(r)}},BaseRenderer.prototype.createCamera=function(){throw new Error("You're using a 3d camera. Try the html renderer.")},BaseRenderer.prototype.createAudio=function(r){return new AudioElement(r,this.globalData,this)},BaseRenderer.prototype.createFootage=function(r){return new FootageElement(r,this.globalData,this)},BaseRenderer.prototype.buildAllItems=function(){var r,a=this.layers.length;for(r=0;r<a;r+=1)this.buildItem(r);this.checkPendingElements()},BaseRenderer.prototype.includeLayers=function(r){this.completeLayers=!1;var a,n=r.length,o,f=this.layers.length;for(a=0;a<n;a+=1)for(o=0;o<f;){if(this.layers[o].id===r[a].id){this.layers[o]=r[a];break}o+=1}},BaseRenderer.prototype.setProjectInterface=function(r){this.globalData.projectInterface=r},BaseRenderer.prototype.initItems=function(){this.globalData.progressiveLoad||this.buildAllItems()},BaseRenderer.prototype.buildElementParenting=function(r,a,n){for(var o=this.elements,f=this.layers,y=0,x=f.length;y<x;)f[y].ind==a&&(!o[y]||o[y]===!0?(this.buildItem(y),this.addPendingElement(r)):(n.push(o[y]),o[y].setAsParent(),f[y].parent!==void 0?this.buildElementParenting(r,f[y].parent,n):r.setHierarchy(n))),y+=1},BaseRenderer.prototype.addPendingElement=function(r){this.pendingElements.push(r)},BaseRenderer.prototype.searchExtraCompositions=function(r){var a,n=r.length;for(a=0;a<n;a+=1)if(r[a].xt){var o=this.createComp(r[a]);o.initExpressions(),this.globalData.projectInterface.registerComposition(o)}},BaseRenderer.prototype.getElementById=function(r){var a,n=this.elements.length;for(a=0;a<n;a+=1)if(this.elements[a].data.ind===r)return this.elements[a];return null},BaseRenderer.prototype.getElementByPath=function(r){var a=r.shift(),n;if(typeof a=="number")n=this.elements[a];else{var o,f=this.elements.length;for(o=0;o<f;o+=1)if(this.elements[o].data.nm===a){n=this.elements[o];break}}return r.length===0?n:n.getElementByPath(r)},BaseRenderer.prototype.setupGlobalData=function(r,a){this.globalData.fontManager=new FontManager,this.globalData.slotManager=slotFactory(r),this.globalData.fontManager.addChars(r.chars),this.globalData.fontManager.addFonts(r.fonts,a),this.globalData.getAssetData=this.animationItem.getAssetData.bind(this.animationItem),this.globalData.getAssetsPath=this.animationItem.getAssetsPath.bind(this.animationItem),this.globalData.imageLoader=this.animationItem.imagePreloader,this.globalData.audioController=this.animationItem.audioController,this.globalData.frameId=0,this.globalData.frameRate=r.fr,this.globalData.nm=r.nm,this.globalData.compSize={w:r.w,h:r.h}};var effectTypes={TRANSFORM_EFFECT:"transformEFfect"};function TransformElement(){}TransformElement.prototype={initTransform:function(){var a=new Matrix;this.finalTransform={mProp:this.data.ks?TransformPropertyFactory.getTransformProperty(this,this.data.ks,this):{o:0},_matMdf:!1,_localMatMdf:!1,_opMdf:!1,mat:a,localMat:a,localOpacity:1},this.data.ao&&(this.finalTransform.mProp.autoOriented=!0),this.data.ty},renderTransform:function(){if(this.finalTransform._opMdf=this.finalTransform.mProp.o._mdf||this._isFirstFrame,this.finalTransform._matMdf=this.finalTransform.mProp._mdf||this._isFirstFrame,this.hierarchy){var a,n=this.finalTransform.mat,o=0,f=this.hierarchy.length;if(!this.finalTransform._matMdf)for(;o<f;){if(this.hierarchy[o].finalTransform.mProp._mdf){this.finalTransform._matMdf=!0;break}o+=1}if(this.finalTransform._matMdf)for(a=this.finalTransform.mProp.v.props,n.cloneFromProps(a),o=0;o<f;o+=1)n.multiply(this.hierarchy[o].finalTransform.mProp.v)}(!this.localTransforms||this.finalTransform._matMdf)&&(this.finalTransform._localMatMdf=this.finalTransform._matMdf),this.finalTransform._opMdf&&(this.finalTransform.localOpacity=this.finalTransform.mProp.o.v)},renderLocalTransform:function(){if(this.localTransforms){var a=0,n=this.localTransforms.length;if(this.finalTransform._localMatMdf=this.finalTransform._matMdf,!this.finalTransform._localMatMdf||!this.finalTransform._opMdf)for(;a<n;)this.localTransforms[a]._mdf&&(this.finalTransform._localMatMdf=!0),this.localTransforms[a]._opMdf&&!this.finalTransform._opMdf&&(this.finalTransform.localOpacity=this.finalTransform.mProp.o.v,this.finalTransform._opMdf=!0),a+=1;if(this.finalTransform._localMatMdf){var o=this.finalTransform.localMat;for(this.localTransforms[0].matrix.clone(o),a=1;a<n;a+=1){var f=this.localTransforms[a].matrix;o.multiply(f)}o.multiply(this.finalTransform.mat)}if(this.finalTransform._opMdf){var y=this.finalTransform.localOpacity;for(a=0;a<n;a+=1)y*=this.localTransforms[a].opacity*.01;this.finalTransform.localOpacity=y}}},searchEffectTransforms:function(){if(this.renderableEffectsManager){var a=this.renderableEffectsManager.getEffects(effectTypes.TRANSFORM_EFFECT);if(a.length){this.localTransforms=[],this.finalTransform.localMat=new Matrix;var n=0,o=a.length;for(n=0;n<o;n+=1)this.localTransforms.push(a[n])}}},globalToLocal:function(a){var n=[];n.push(this.finalTransform);for(var o=!0,f=this.comp;o;)f.finalTransform?(f.data.hasMask&&n.splice(0,0,f.finalTransform),f=f.comp):o=!1;var y,x=n.length,b;for(y=0;y<x;y+=1)b=n[y].mat.applyToPointArray(0,0,0),a=[a[0]-b[0],a[1]-b[1],0];return a},mHelper:new Matrix};function MaskElement(r,a,n){this.data=r,this.element=a,this.globalData=n,this.storedData=[],this.masksProperties=this.data.masksProperties||[],this.maskElement=null;var o=this.globalData.defs,f,y=this.masksProperties?this.masksProperties.length:0;this.viewData=createSizedArray(y),this.solidPath="";var x,b=this.masksProperties,_=0,S=[],A,C,P=createElementID(),T,M,O,I,D="clipPath",z="clip-path";for(f=0;f<y;f+=1)if((b[f].mode!=="a"&&b[f].mode!=="n"||b[f].inv||b[f].o.k!==100||b[f].o.x)&&(D="mask",z="mask"),(b[f].mode==="s"||b[f].mode==="i")&&_===0?(T=createNS("rect"),T.setAttribute("fill","#ffffff"),T.setAttribute("width",this.element.comp.data.w||0),T.setAttribute("height",this.element.comp.data.h||0),S.push(T)):T=null,x=createNS("path"),b[f].mode==="n")this.viewData[f]={op:PropertyFactory.getProp(this.element,b[f].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,b[f],3),elem:x,lastPath:""},o.appendChild(x);else{_+=1,x.setAttribute("fill",b[f].mode==="s"?"#000000":"#ffffff"),x.setAttribute("clip-rule","nonzero");var k;if(b[f].x.k!==0?(D="mask",z="mask",I=PropertyFactory.getProp(this.element,b[f].x,0,null,this.element),k=createElementID(),M=createNS("filter"),M.setAttribute("id",k),O=createNS("feMorphology"),O.setAttribute("operator","erode"),O.setAttribute("in","SourceGraphic"),O.setAttribute("radius","0"),M.appendChild(O),o.appendChild(M),x.setAttribute("stroke",b[f].mode==="s"?"#000000":"#ffffff")):(O=null,I=null),this.storedData[f]={elem:x,x:I,expan:O,lastPath:"",lastOperator:"",filterId:k,lastRadius:0},b[f].mode==="i"){C=S.length;var L=createNS("g");for(A=0;A<C;A+=1)L.appendChild(S[A]);var R=createNS("mask");R.setAttribute("mask-type","alpha"),R.setAttribute("id",P+"_"+_),R.appendChild(x),o.appendChild(R),L.setAttribute("mask","url("+getLocationHref()+"#"+P+"_"+_+")"),S.length=0,S.push(L)}else S.push(x);b[f].inv&&!this.solidPath&&(this.solidPath=this.createLayerSolidPath()),this.viewData[f]={elem:x,lastPath:"",op:PropertyFactory.getProp(this.element,b[f].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,b[f],3),invRect:T},this.viewData[f].prop.k||this.drawPath(b[f],this.viewData[f].prop.v,this.viewData[f])}for(this.maskElement=createNS(D),y=S.length,f=0;f<y;f+=1)this.maskElement.appendChild(S[f]);_>0&&(this.maskElement.setAttribute("id",P),this.element.maskedElement.setAttribute(z,"url("+getLocationHref()+"#"+P+")"),o.appendChild(this.maskElement)),this.viewData.length&&this.element.addRenderableComponent(this)}MaskElement.prototype.getMaskProperty=function(r){return this.viewData[r].prop},MaskElement.prototype.renderFrame=function(r){var a=this.element.finalTransform.mat,n,o=this.masksProperties.length;for(n=0;n<o;n+=1)if((this.viewData[n].prop._mdf||r)&&this.drawPath(this.masksProperties[n],this.viewData[n].prop.v,this.viewData[n]),(this.viewData[n].op._mdf||r)&&this.viewData[n].elem.setAttribute("fill-opacity",this.viewData[n].op.v),this.masksProperties[n].mode!=="n"&&(this.viewData[n].invRect&&(this.element.finalTransform.mProp._mdf||r)&&this.viewData[n].invRect.setAttribute("transform",a.getInverseMatrix().to2dCSS()),this.storedData[n].x&&(this.storedData[n].x._mdf||r))){var f=this.storedData[n].expan;this.storedData[n].x.v<0?(this.storedData[n].lastOperator!=="erode"&&(this.storedData[n].lastOperator="erode",this.storedData[n].elem.setAttribute("filter","url("+getLocationHref()+"#"+this.storedData[n].filterId+")")),f.setAttribute("radius",-this.storedData[n].x.v)):(this.storedData[n].lastOperator!=="dilate"&&(this.storedData[n].lastOperator="dilate",this.storedData[n].elem.setAttribute("filter",null)),this.storedData[n].elem.setAttribute("stroke-width",this.storedData[n].x.v*2))}},MaskElement.prototype.getMaskelement=function(){return this.maskElement},MaskElement.prototype.createLayerSolidPath=function(){var r="M0,0 ";return r+=" h"+this.globalData.compSize.w,r+=" v"+this.globalData.compSize.h,r+=" h-"+this.globalData.compSize.w,r+=" v-"+this.globalData.compSize.h+" ",r},MaskElement.prototype.drawPath=function(r,a,n){var o=" M"+a.v[0][0]+","+a.v[0][1],f,y;for(y=a._length,f=1;f<y;f+=1)o+=" C"+a.o[f-1][0]+","+a.o[f-1][1]+" "+a.i[f][0]+","+a.i[f][1]+" "+a.v[f][0]+","+a.v[f][1];if(a.c&&y>1&&(o+=" C"+a.o[f-1][0]+","+a.o[f-1][1]+" "+a.i[0][0]+","+a.i[0][1]+" "+a.v[0][0]+","+a.v[0][1]),n.lastPath!==o){var x="";n.elem&&(a.c&&(x=r.inv?this.solidPath+o:o),n.elem.setAttribute("d",x)),n.lastPath=o}},MaskElement.prototype.destroy=function(){this.element=null,this.globalData=null,this.maskElement=null,this.data=null,this.masksProperties=null};var filtersFactory=function(){var r={};r.createFilter=a,r.createAlphaToLuminanceFilter=n;function a(o,f){var y=createNS("filter");return y.setAttribute("id",o),f!==!0&&(y.setAttribute("filterUnits","objectBoundingBox"),y.setAttribute("x","0%"),y.setAttribute("y","0%"),y.setAttribute("width","100%"),y.setAttribute("height","100%")),y}function n(){var o=createNS("feColorMatrix");return o.setAttribute("type","matrix"),o.setAttribute("color-interpolation-filters","sRGB"),o.setAttribute("values","0 0 0 1 0  0 0 0 1 0  0 0 0 1 0  0 0 0 1 1"),o}return r}(),featureSupport=function(){var r={maskType:!0,svgLumaHidden:!0,offscreenCanvas:typeof OffscreenCanvas<"u"};return(/MSIE 10/i.test(navigator.userAgent)||/MSIE 9/i.test(navigator.userAgent)||/rv:11.0/i.test(navigator.userAgent)||/Edge\/\d./i.test(navigator.userAgent))&&(r.maskType=!1),/firefox/i.test(navigator.userAgent)&&(r.svgLumaHidden=!1),r}(),registeredEffects$1={},idPrefix="filter_result_";function SVGEffects(r){var a,n="SourceGraphic",o=r.data.ef?r.data.ef.length:0,f=createElementID(),y=filtersFactory.createFilter(f,!0),x=0;this.filters=[];var b;for(a=0;a<o;a+=1){b=null;var _=r.data.ef[a].ty;if(registeredEffects$1[_]){var S=registeredEffects$1[_].effect;b=new S(y,r.effectsManager.effectElements[a],r,idPrefix+x,n),n=idPrefix+x,registeredEffects$1[_].countsAsEffect&&(x+=1)}b&&this.filters.push(b)}x&&(r.globalData.defs.appendChild(y),r.layerElement.setAttribute("filter","url("+getLocationHref()+"#"+f+")")),this.filters.length&&r.addRenderableComponent(this)}SVGEffects.prototype.renderFrame=function(r){var a,n=this.filters.length;for(a=0;a<n;a+=1)this.filters[a].renderFrame(r)},SVGEffects.prototype.getEffects=function(r){var a,n=this.filters.length,o=[];for(a=0;a<n;a+=1)this.filters[a].type===r&&o.push(this.filters[a]);return o};function registerEffect$1(r,a,n){registeredEffects$1[r]={effect:a,countsAsEffect:n}}function SVGBaseElement(){}SVGBaseElement.prototype={initRendererElement:function(){this.layerElement=createNS("g")},createContainerElements:function(){this.matteElement=createNS("g"),this.transformedElement=this.layerElement,this.maskedElement=this.layerElement,this._sizeChanged=!1;var a=null;if(this.data.td){this.matteMasks={};var n=createNS("g");n.setAttribute("id",this.layerId),n.appendChild(this.layerElement),a=n,this.globalData.defs.appendChild(n)}else this.data.tt?(this.matteElement.appendChild(this.layerElement),a=this.matteElement,this.baseElement=this.matteElement):this.baseElement=this.layerElement;if(this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),this.data.ty===0&&!this.data.hd){var o=createNS("clipPath"),f=createNS("path");f.setAttribute("d","M0,0 L"+this.data.w+",0 L"+this.data.w+","+this.data.h+" L0,"+this.data.h+"z");var y=createElementID();if(o.setAttribute("id",y),o.appendChild(f),this.globalData.defs.appendChild(o),this.checkMasks()){var x=createNS("g");x.setAttribute("clip-path","url("+getLocationHref()+"#"+y+")"),x.appendChild(this.layerElement),this.transformedElement=x,a?a.appendChild(this.transformedElement):this.baseElement=this.transformedElement}else this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+y+")")}this.data.bm!==0&&this.setBlendMode()},renderElement:function(){this.finalTransform._localMatMdf&&this.transformedElement.setAttribute("transform",this.finalTransform.localMat.to2dCSS()),this.finalTransform._opMdf&&this.transformedElement.setAttribute("opacity",this.finalTransform.localOpacity)},destroyBaseElement:function(){this.layerElement=null,this.matteElement=null,this.maskManager.destroy()},getBaseElement:function(){return this.data.hd?null:this.baseElement},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData),this.renderableEffectsManager=new SVGEffects(this),this.searchEffectTransforms()},getMatte:function(a){if(this.matteMasks||(this.matteMasks={}),!this.matteMasks[a]){var n=this.layerId+"_"+a,o,f,y,x;if(a===1||a===3){var b=createNS("mask");b.setAttribute("id",n),b.setAttribute("mask-type",a===3?"luminance":"alpha"),y=createNS("use"),y.setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.layerId),b.appendChild(y),this.globalData.defs.appendChild(b),!featureSupport.maskType&&a===1&&(b.setAttribute("mask-type","luminance"),o=createElementID(),f=filtersFactory.createFilter(o),this.globalData.defs.appendChild(f),f.appendChild(filtersFactory.createAlphaToLuminanceFilter()),x=createNS("g"),x.appendChild(y),b.appendChild(x),x.setAttribute("filter","url("+getLocationHref()+"#"+o+")"))}else if(a===2){var _=createNS("mask");_.setAttribute("id",n),_.setAttribute("mask-type","alpha");var S=createNS("g");_.appendChild(S),o=createElementID(),f=filtersFactory.createFilter(o);var A=createNS("feComponentTransfer");A.setAttribute("in","SourceGraphic"),f.appendChild(A);var C=createNS("feFuncA");C.setAttribute("type","table"),C.setAttribute("tableValues","1.0 0.0"),A.appendChild(C),this.globalData.defs.appendChild(f);var P=createNS("rect");P.setAttribute("width",this.comp.data.w),P.setAttribute("height",this.comp.data.h),P.setAttribute("x","0"),P.setAttribute("y","0"),P.setAttribute("fill","#ffffff"),P.setAttribute("opacity","0"),S.setAttribute("filter","url("+getLocationHref()+"#"+o+")"),S.appendChild(P),y=createNS("use"),y.setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.layerId),S.appendChild(y),featureSupport.maskType||(_.setAttribute("mask-type","luminance"),f.appendChild(filtersFactory.createAlphaToLuminanceFilter()),x=createNS("g"),S.appendChild(P),x.appendChild(this.layerElement),S.appendChild(x)),this.globalData.defs.appendChild(_)}this.matteMasks[a]=n}return this.matteMasks[a]},setMatte:function(a){this.matteElement&&this.matteElement.setAttribute("mask","url("+getLocationHref()+"#"+a+")")}};function HierarchyElement(){}HierarchyElement.prototype={initHierarchy:function(){this.hierarchy=[],this._isParent=!1,this.checkParenting()},setHierarchy:function(a){this.hierarchy=a},setAsParent:function(){this._isParent=!0},checkParenting:function(){this.data.parent!==void 0&&this.comp.buildElementParenting(this,this.data.parent,[])}};function RenderableDOMElement(){}(function(){var r={initElement:function(n,o,f){this.initFrame(),this.initBaseData(n,o,f),this.initTransform(n,o,f),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide()},hide:function(){if(!this.hidden&&(!this.isInRange||this.isTransparent)){var n=this.baseElement||this.layerElement;n.style.display="none",this.hidden=!0}},show:function(){if(this.isInRange&&!this.isTransparent){if(!this.data.hd){var n=this.baseElement||this.layerElement;n.style.display="block"}this.hidden=!1,this._isFirstFrame=!0}},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderLocalTransform(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},renderInnerContent:function(){},prepareFrame:function(n){this._mdf=!1,this.prepareRenderableFrame(n),this.prepareProperties(n,this.isInRange),this.checkTransparency()},destroy:function(){this.innerElem=null,this.destroyBaseElement()}};extendPrototype([RenderableElement,createProxyFunction(r)],RenderableDOMElement)})();function IImageElement(r,a,n){this.assetData=a.getAssetData(r.refId),this.assetData&&this.assetData.sid&&(this.assetData=a.slotManager.getProp(this.assetData)),this.initElement(r,a,n),this.sourceRect={top:0,left:0,width:this.assetData.w,height:this.assetData.h}}extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],IImageElement),IImageElement.prototype.createContent=function(){var r=this.globalData.getAssetsPath(this.assetData);this.innerElem=createNS("image"),this.innerElem.setAttribute("width",this.assetData.w+"px"),this.innerElem.setAttribute("height",this.assetData.h+"px"),this.innerElem.setAttribute("preserveAspectRatio",this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio),this.innerElem.setAttributeNS("http://www.w3.org/1999/xlink","href",r),this.layerElement.appendChild(this.innerElem)},IImageElement.prototype.sourceRectAtTime=function(){return this.sourceRect};function ProcessedElement(r,a){this.elem=r,this.pos=a}function IShapeElement(){}IShapeElement.prototype={addShapeToModifiers:function(a){var n,o=this.shapeModifiers.length;for(n=0;n<o;n+=1)this.shapeModifiers[n].addShape(a)},isShapeInAnimatedModifiers:function(a){for(var n=0,o=this.shapeModifiers.length;n<o;)if(this.shapeModifiers[n].isAnimatedWithShape(a))return!0;return!1},renderModifiers:function(){if(this.shapeModifiers.length){var a,n=this.shapes.length;for(a=0;a<n;a+=1)this.shapes[a].sh.reset();n=this.shapeModifiers.length;var o;for(a=n-1;a>=0&&(o=this.shapeModifiers[a].processShapes(this._isFirstFrame),!o);a-=1);}},searchProcessedElement:function(a){for(var n=this.processedElements,o=0,f=n.length;o<f;){if(n[o].elem===a)return n[o].pos;o+=1}return 0},addProcessedElement:function(a,n){for(var o=this.processedElements,f=o.length;f;)if(f-=1,o[f].elem===a){o[f].pos=n;return}o.push(new ProcessedElement(a,n))},prepareFrame:function(a){this.prepareRenderableFrame(a),this.prepareProperties(a,this.isInRange)}};var lineCapEnum={1:"butt",2:"round",3:"square"},lineJoinEnum={1:"miter",2:"round",3:"bevel"};function SVGShapeData(r,a,n){this.caches=[],this.styles=[],this.transformers=r,this.lStr="",this.sh=n,this.lvl=a,this._isAnimated=!!n.k;for(var o=0,f=r.length;o<f;){if(r[o].mProps.dynamicProperties.length){this._isAnimated=!0;break}o+=1}}SVGShapeData.prototype.setAsAnimated=function(){this._isAnimated=!0};function SVGStyleData(r,a){this.data=r,this.type=r.ty,this.d="",this.lvl=a,this._mdf=!1,this.closed=r.hd===!0,this.pElem=createNS("path"),this.msElem=null}SVGStyleData.prototype.reset=function(){this.d="",this._mdf=!1};function DashProperty(r,a,n,o){this.elem=r,this.frameId=-1,this.dataProps=createSizedArray(a.length),this.renderer=n,this.k=!1,this.dashStr="",this.dashArray=createTypedArray("float32",a.length?a.length-1:0),this.dashoffset=createTypedArray("float32",1),this.initDynamicPropertyContainer(o);var f,y=a.length||0,x;for(f=0;f<y;f+=1)x=PropertyFactory.getProp(r,a[f].v,0,0,this),this.k=x.k||this.k,this.dataProps[f]={n:a[f].n,p:x};this.k||this.getValue(!0),this._isAnimated=this.k}DashProperty.prototype.getValue=function(r){if(!(this.elem.globalData.frameId===this.frameId&&!r)&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf=this._mdf||r,this._mdf)){var a=0,n=this.dataProps.length;for(this.renderer==="svg"&&(this.dashStr=""),a=0;a<n;a+=1)this.dataProps[a].n!=="o"?this.renderer==="svg"?this.dashStr+=" "+this.dataProps[a].p.v:this.dashArray[a]=this.dataProps[a].p.v:this.dashoffset[0]=this.dataProps[a].p.v}},extendPrototype([DynamicPropertyContainer],DashProperty);function SVGStrokeStyleData(r,a,n){this.initDynamicPropertyContainer(r),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(r,a.o,0,.01,this),this.w=PropertyFactory.getProp(r,a.w,0,null,this),this.d=new DashProperty(r,a.d||{},"svg",this),this.c=PropertyFactory.getProp(r,a.c,1,255,this),this.style=n,this._isAnimated=!!this._isAnimated}extendPrototype([DynamicPropertyContainer],SVGStrokeStyleData);function SVGFillStyleData(r,a,n){this.initDynamicPropertyContainer(r),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(r,a.o,0,.01,this),this.c=PropertyFactory.getProp(r,a.c,1,255,this),this.style=n}extendPrototype([DynamicPropertyContainer],SVGFillStyleData);function SVGNoStyleData(r,a,n){this.initDynamicPropertyContainer(r),this.getValue=this.iterateDynamicProperties,this.style=n}extendPrototype([DynamicPropertyContainer],SVGNoStyleData);function GradientProperty(r,a,n){this.data=a,this.c=createTypedArray("uint8c",a.p*4);var o=a.k.k[0].s?a.k.k[0].s.length-a.p*4:a.k.k.length-a.p*4;this.o=createTypedArray("float32",o),this._cmdf=!1,this._omdf=!1,this._collapsable=this.checkCollapsable(),this._hasOpacity=o,this.initDynamicPropertyContainer(n),this.prop=PropertyFactory.getProp(r,a.k,1,null,this),this.k=this.prop.k,this.getValue(!0)}GradientProperty.prototype.comparePoints=function(r,a){for(var n=0,o=this.o.length/2,f;n<o;){if(f=Math.abs(r[n*4]-r[a*4+n*2]),f>.01)return!1;n+=1}return!0},GradientProperty.prototype.checkCollapsable=function(){if(this.o.length/2!==this.c.length/4)return!1;if(this.data.k.k[0].s)for(var r=0,a=this.data.k.k.length;r<a;){if(!this.comparePoints(this.data.k.k[r].s,this.data.p))return!1;r+=1}else if(!this.comparePoints(this.data.k.k,this.data.p))return!1;return!0},GradientProperty.prototype.getValue=function(r){if(this.prop.getValue(),this._mdf=!1,this._cmdf=!1,this._omdf=!1,this.prop._mdf||r){var a,n=this.data.p*4,o,f;for(a=0;a<n;a+=1)o=a%4===0?100:255,f=Math.round(this.prop.v[a]*o),this.c[a]!==f&&(this.c[a]=f,this._cmdf=!r);if(this.o.length)for(n=this.prop.v.length,a=this.data.p*4;a<n;a+=1)o=a%2===0?100:1,f=a%2===0?Math.round(this.prop.v[a]*100):this.prop.v[a],this.o[a-this.data.p*4]!==f&&(this.o[a-this.data.p*4]=f,this._omdf=!r);this._mdf=!r}},extendPrototype([DynamicPropertyContainer],GradientProperty);function SVGGradientFillStyleData(r,a,n){this.initDynamicPropertyContainer(r),this.getValue=this.iterateDynamicProperties,this.initGradientData(r,a,n)}SVGGradientFillStyleData.prototype.initGradientData=function(r,a,n){this.o=PropertyFactory.getProp(r,a.o,0,.01,this),this.s=PropertyFactory.getProp(r,a.s,1,null,this),this.e=PropertyFactory.getProp(r,a.e,1,null,this),this.h=PropertyFactory.getProp(r,a.h||{k:0},0,.01,this),this.a=PropertyFactory.getProp(r,a.a||{k:0},0,degToRads,this),this.g=new GradientProperty(r,a.g,this),this.style=n,this.stops=[],this.setGradientData(n.pElem,a),this.setGradientOpacity(a,n),this._isAnimated=!!this._isAnimated},SVGGradientFillStyleData.prototype.setGradientData=function(r,a){var n=createElementID(),o=createNS(a.t===1?"linearGradient":"radialGradient");o.setAttribute("id",n),o.setAttribute("spreadMethod","pad"),o.setAttribute("gradientUnits","userSpaceOnUse");var f=[],y,x,b;for(b=a.g.p*4,x=0;x<b;x+=4)y=createNS("stop"),o.appendChild(y),f.push(y);r.setAttribute(a.ty==="gf"?"fill":"stroke","url("+getLocationHref()+"#"+n+")"),this.gf=o,this.cst=f},SVGGradientFillStyleData.prototype.setGradientOpacity=function(r,a){if(this.g._hasOpacity&&!this.g._collapsable){var n,o,f,y=createNS("mask"),x=createNS("path");y.appendChild(x);var b=createElementID(),_=createElementID();y.setAttribute("id",_);var S=createNS(r.t===1?"linearGradient":"radialGradient");S.setAttribute("id",b),S.setAttribute("spreadMethod","pad"),S.setAttribute("gradientUnits","userSpaceOnUse"),f=r.g.k.k[0].s?r.g.k.k[0].s.length:r.g.k.k.length;var A=this.stops;for(o=r.g.p*4;o<f;o+=2)n=createNS("stop"),n.setAttribute("stop-color","rgb(255,255,255)"),S.appendChild(n),A.push(n);x.setAttribute(r.ty==="gf"?"fill":"stroke","url("+getLocationHref()+"#"+b+")"),r.ty==="gs"&&(x.setAttribute("stroke-linecap",lineCapEnum[r.lc||2]),x.setAttribute("stroke-linejoin",lineJoinEnum[r.lj||2]),r.lj===1&&x.setAttribute("stroke-miterlimit",r.ml)),this.of=S,this.ms=y,this.ost=A,this.maskId=_,a.msElem=x}},extendPrototype([DynamicPropertyContainer],SVGGradientFillStyleData);function SVGGradientStrokeStyleData(r,a,n){this.initDynamicPropertyContainer(r),this.getValue=this.iterateDynamicProperties,this.w=PropertyFactory.getProp(r,a.w,0,null,this),this.d=new DashProperty(r,a.d||{},"svg",this),this.initGradientData(r,a,n),this._isAnimated=!!this._isAnimated}extendPrototype([SVGGradientFillStyleData,DynamicPropertyContainer],SVGGradientStrokeStyleData);function ShapeGroupData(){this.it=[],this.prevViewData=[],this.gr=createNS("g")}function SVGTransformData(r,a,n){this.transform={mProps:r,op:a,container:n},this.elements=[],this._isAnimated=this.transform.mProps.dynamicProperties.length||this.transform.op.effectsSequence.length}var buildShapeString=function(a,n,o,f){if(n===0)return"";var y=a.o,x=a.i,b=a.v,_,S=" M"+f.applyToPointStringified(b[0][0],b[0][1]);for(_=1;_<n;_+=1)S+=" C"+f.applyToPointStringified(y[_-1][0],y[_-1][1])+" "+f.applyToPointStringified(x[_][0],x[_][1])+" "+f.applyToPointStringified(b[_][0],b[_][1]);return o&&n&&(S+=" C"+f.applyToPointStringified(y[_-1][0],y[_-1][1])+" "+f.applyToPointStringified(x[0][0],x[0][1])+" "+f.applyToPointStringified(b[0][0],b[0][1]),S+="z"),S},SVGElementsRenderer=function(){var r=new Matrix,a=new Matrix,n={createRenderFunction:o};function o(C){switch(C.ty){case"fl":return b;case"gf":return S;case"gs":return _;case"st":return A;case"sh":case"el":case"rc":case"sr":return x;case"tr":return f;case"no":return y;default:return null}}function f(C,P,T){(T||P.transform.op._mdf)&&P.transform.container.setAttribute("opacity",P.transform.op.v),(T||P.transform.mProps._mdf)&&P.transform.container.setAttribute("transform",P.transform.mProps.v.to2dCSS())}function y(){}function x(C,P,T){var M,O,I,D,z,k,L=P.styles.length,R=P.lvl,F,B,N,j;for(k=0;k<L;k+=1){if(D=P.sh._mdf||T,P.styles[k].lvl<R){for(B=a.reset(),N=R-P.styles[k].lvl,j=P.transformers.length-1;!D&&N>0;)D=P.transformers[j].mProps._mdf||D,N-=1,j-=1;if(D)for(N=R-P.styles[k].lvl,j=P.transformers.length-1;N>0;)B.multiply(P.transformers[j].mProps.v),N-=1,j-=1}else B=r;if(F=P.sh.paths,O=F._length,D){for(I="",M=0;M<O;M+=1)z=F.shapes[M],z&&z._length&&(I+=buildShapeString(z,z._length,z.c,B));P.caches[k]=I}else I=P.caches[k];P.styles[k].d+=C.hd===!0?"":I,P.styles[k]._mdf=D||P.styles[k]._mdf}}function b(C,P,T){var M=P.style;(P.c._mdf||T)&&M.pElem.setAttribute("fill","rgb("+bmFloor(P.c.v[0])+","+bmFloor(P.c.v[1])+","+bmFloor(P.c.v[2])+")"),(P.o._mdf||T)&&M.pElem.setAttribute("fill-opacity",P.o.v)}function _(C,P,T){S(C,P,T),A(C,P,T)}function S(C,P,T){var M=P.gf,O=P.g._hasOpacity,I=P.s.v,D=P.e.v;if(P.o._mdf||T){var z=C.ty==="gf"?"fill-opacity":"stroke-opacity";P.style.pElem.setAttribute(z,P.o.v)}if(P.s._mdf||T){var k=C.t===1?"x1":"cx",L=k==="x1"?"y1":"cy";M.setAttribute(k,I[0]),M.setAttribute(L,I[1]),O&&!P.g._collapsable&&(P.of.setAttribute(k,I[0]),P.of.setAttribute(L,I[1]))}var R,F,B,N;if(P.g._cmdf||T){R=P.cst;var j=P.g.c;for(B=R.length,F=0;F<B;F+=1)N=R[F],N.setAttribute("offset",j[F*4]+"%"),N.setAttribute("stop-color","rgb("+j[F*4+1]+","+j[F*4+2]+","+j[F*4+3]+")")}if(O&&(P.g._omdf||T)){var G=P.g.o;for(P.g._collapsable?R=P.cst:R=P.ost,B=R.length,F=0;F<B;F+=1)N=R[F],P.g._collapsable||N.setAttribute("offset",G[F*2]+"%"),N.setAttribute("stop-opacity",G[F*2+1])}if(C.t===1)(P.e._mdf||T)&&(M.setAttribute("x2",D[0]),M.setAttribute("y2",D[1]),O&&!P.g._collapsable&&(P.of.setAttribute("x2",D[0]),P.of.setAttribute("y2",D[1])));else{var Y;if((P.s._mdf||P.e._mdf||T)&&(Y=Math.sqrt(Math.pow(I[0]-D[0],2)+Math.pow(I[1]-D[1],2)),M.setAttribute("r",Y),O&&!P.g._collapsable&&P.of.setAttribute("r",Y)),P.s._mdf||P.e._mdf||P.h._mdf||P.a._mdf||T){Y||(Y=Math.sqrt(Math.pow(I[0]-D[0],2)+Math.pow(I[1]-D[1],2)));var X=Math.atan2(D[1]-I[1],D[0]-I[0]),$=P.h.v;$>=1?$=.99:$<=-1&&($=-.99);var te=Y*$,ee=Math.cos(X+P.a.v)*te+I[0],q=Math.sin(X+P.a.v)*te+I[1];M.setAttribute("fx",ee),M.setAttribute("fy",q),O&&!P.g._collapsable&&(P.of.setAttribute("fx",ee),P.of.setAttribute("fy",q))}}}function A(C,P,T){var M=P.style,O=P.d;O&&(O._mdf||T)&&O.dashStr&&(M.pElem.setAttribute("stroke-dasharray",O.dashStr),M.pElem.setAttribute("stroke-dashoffset",O.dashoffset[0])),P.c&&(P.c._mdf||T)&&M.pElem.setAttribute("stroke","rgb("+bmFloor(P.c.v[0])+","+bmFloor(P.c.v[1])+","+bmFloor(P.c.v[2])+")"),(P.o._mdf||T)&&M.pElem.setAttribute("stroke-opacity",P.o.v),(P.w._mdf||T)&&(M.pElem.setAttribute("stroke-width",P.w.v),M.msElem&&M.msElem.setAttribute("stroke-width",P.w.v))}return n}();function SVGShapeElement(r,a,n){this.shapes=[],this.shapesData=r.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.initElement(r,a,n),this.prevViewData=[]}extendPrototype([BaseElement,TransformElement,SVGBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableDOMElement],SVGShapeElement),SVGShapeElement.prototype.initSecondaryElement=function(){},SVGShapeElement.prototype.identityMatrix=new Matrix,SVGShapeElement.prototype.buildExpressionInterface=function(){},SVGShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes()},SVGShapeElement.prototype.filterUniqueShapes=function(){var r,a=this.shapes.length,n,o,f=this.stylesList.length,y,x=[],b=!1;for(o=0;o<f;o+=1){for(y=this.stylesList[o],b=!1,x.length=0,r=0;r<a;r+=1)n=this.shapes[r],n.styles.indexOf(y)!==-1&&(x.push(n),b=n._isAnimated||b);x.length>1&&b&&this.setShapesAsAnimated(x)}},SVGShapeElement.prototype.setShapesAsAnimated=function(r){var a,n=r.length;for(a=0;a<n;a+=1)r[a].setAsAnimated()},SVGShapeElement.prototype.createStyleElement=function(r,a){var n,o=new SVGStyleData(r,a),f=o.pElem;if(r.ty==="st")n=new SVGStrokeStyleData(this,r,o);else if(r.ty==="fl")n=new SVGFillStyleData(this,r,o);else if(r.ty==="gf"||r.ty==="gs"){var y=r.ty==="gf"?SVGGradientFillStyleData:SVGGradientStrokeStyleData;n=new y(this,r,o),this.globalData.defs.appendChild(n.gf),n.maskId&&(this.globalData.defs.appendChild(n.ms),this.globalData.defs.appendChild(n.of),f.setAttribute("mask","url("+getLocationHref()+"#"+n.maskId+")"))}else r.ty==="no"&&(n=new SVGNoStyleData(this,r,o));return(r.ty==="st"||r.ty==="gs")&&(f.setAttribute("stroke-linecap",lineCapEnum[r.lc||2]),f.setAttribute("stroke-linejoin",lineJoinEnum[r.lj||2]),f.setAttribute("fill-opacity","0"),r.lj===1&&f.setAttribute("stroke-miterlimit",r.ml)),r.r===2&&f.setAttribute("fill-rule","evenodd"),r.ln&&f.setAttribute("id",r.ln),r.cl&&f.setAttribute("class",r.cl),r.bm&&(f.style["mix-blend-mode"]=getBlendMode(r.bm)),this.stylesList.push(o),this.addToAnimatedContents(r,n),n},SVGShapeElement.prototype.createGroupElement=function(r){var a=new ShapeGroupData;return r.ln&&a.gr.setAttribute("id",r.ln),r.cl&&a.gr.setAttribute("class",r.cl),r.bm&&(a.gr.style["mix-blend-mode"]=getBlendMode(r.bm)),a},SVGShapeElement.prototype.createTransformElement=function(r,a){var n=TransformPropertyFactory.getTransformProperty(this,r,this),o=new SVGTransformData(n,n.o,a);return this.addToAnimatedContents(r,o),o},SVGShapeElement.prototype.createShapeElement=function(r,a,n){var o=4;r.ty==="rc"?o=5:r.ty==="el"?o=6:r.ty==="sr"&&(o=7);var f=ShapePropertyFactory.getShapeProp(this,r,o,this),y=new SVGShapeData(a,n,f);return this.shapes.push(y),this.addShapeToModifiers(y),this.addToAnimatedContents(r,y),y},SVGShapeElement.prototype.addToAnimatedContents=function(r,a){for(var n=0,o=this.animatedContents.length;n<o;){if(this.animatedContents[n].element===a)return;n+=1}this.animatedContents.push({fn:SVGElementsRenderer.createRenderFunction(r),element:a,data:r})},SVGShapeElement.prototype.setElementStyles=function(r){var a=r.styles,n,o=this.stylesList.length;for(n=0;n<o;n+=1)a.indexOf(this.stylesList[n])===-1&&!this.stylesList[n].closed&&a.push(this.stylesList[n])},SVGShapeElement.prototype.reloadShapes=function(){this._isFirstFrame=!0;var r,a=this.itemsData.length;for(r=0;r<a;r+=1)this.prevViewData[r]=this.itemsData[r];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes(),a=this.dynamicProperties.length,r=0;r<a;r+=1)this.dynamicProperties[r].getValue();this.renderModifiers()},SVGShapeElement.prototype.searchShapes=function(r,a,n,o,f,y,x){var b=[].concat(y),_,S=r.length-1,A,C,P=[],T=[],M,O,I;for(_=S;_>=0;_-=1){if(I=this.searchProcessedElement(r[_]),I?a[_]=n[I-1]:r[_]._render=x,r[_].ty==="fl"||r[_].ty==="st"||r[_].ty==="gf"||r[_].ty==="gs"||r[_].ty==="no")I?a[_].style.closed=r[_].hd:a[_]=this.createStyleElement(r[_],f),r[_]._render&&a[_].style.pElem.parentNode!==o&&o.appendChild(a[_].style.pElem),P.push(a[_].style);else if(r[_].ty==="gr"){if(!I)a[_]=this.createGroupElement(r[_]);else for(C=a[_].it.length,A=0;A<C;A+=1)a[_].prevViewData[A]=a[_].it[A];this.searchShapes(r[_].it,a[_].it,a[_].prevViewData,a[_].gr,f+1,b,x),r[_]._render&&a[_].gr.parentNode!==o&&o.appendChild(a[_].gr)}else r[_].ty==="tr"?(I||(a[_]=this.createTransformElement(r[_],o)),M=a[_].transform,b.push(M)):r[_].ty==="sh"||r[_].ty==="rc"||r[_].ty==="el"||r[_].ty==="sr"?(I||(a[_]=this.createShapeElement(r[_],b,f)),this.setElementStyles(a[_])):r[_].ty==="tm"||r[_].ty==="rd"||r[_].ty==="ms"||r[_].ty==="pb"||r[_].ty==="zz"||r[_].ty==="op"?(I?(O=a[_],O.closed=!1):(O=ShapeModifiers.getModifier(r[_].ty),O.init(this,r[_]),a[_]=O,this.shapeModifiers.push(O)),T.push(O)):r[_].ty==="rp"&&(I?(O=a[_],O.closed=!0):(O=ShapeModifiers.getModifier(r[_].ty),a[_]=O,O.init(this,r,_,a),this.shapeModifiers.push(O),x=!1),T.push(O));this.addProcessedElement(r[_],_+1)}for(S=P.length,_=0;_<S;_+=1)P[_].closed=!0;for(S=T.length,_=0;_<S;_+=1)T[_].closed=!0},SVGShapeElement.prototype.renderInnerContent=function(){this.renderModifiers();var r,a=this.stylesList.length;for(r=0;r<a;r+=1)this.stylesList[r].reset();for(this.renderShape(),r=0;r<a;r+=1)(this.stylesList[r]._mdf||this._isFirstFrame)&&(this.stylesList[r].msElem&&(this.stylesList[r].msElem.setAttribute("d",this.stylesList[r].d),this.stylesList[r].d="M0 0"+this.stylesList[r].d),this.stylesList[r].pElem.setAttribute("d",this.stylesList[r].d||"M0 0"))},SVGShapeElement.prototype.renderShape=function(){var r,a=this.animatedContents.length,n;for(r=0;r<a;r+=1)n=this.animatedContents[r],(this._isFirstFrame||n.element._isAnimated)&&n.data!==!0&&n.fn(n.data,n.element,this._isFirstFrame)},SVGShapeElement.prototype.destroy=function(){this.destroyBaseElement(),this.shapesData=null,this.itemsData=null};function LetterProps(r,a,n,o,f,y){this.o=r,this.sw=a,this.sc=n,this.fc=o,this.m=f,this.p=y,this._mdf={o:!0,sw:!!a,sc:!!n,fc:!!o,m:!0,p:!0}}LetterProps.prototype.update=function(r,a,n,o,f,y){this._mdf.o=!1,this._mdf.sw=!1,this._mdf.sc=!1,this._mdf.fc=!1,this._mdf.m=!1,this._mdf.p=!1;var x=!1;return this.o!==r&&(this.o=r,this._mdf.o=!0,x=!0),this.sw!==a&&(this.sw=a,this._mdf.sw=!0,x=!0),this.sc!==n&&(this.sc=n,this._mdf.sc=!0,x=!0),this.fc!==o&&(this.fc=o,this._mdf.fc=!0,x=!0),this.m!==f&&(this.m=f,this._mdf.m=!0,x=!0),y.length&&(this.p[0]!==y[0]||this.p[1]!==y[1]||this.p[4]!==y[4]||this.p[5]!==y[5]||this.p[12]!==y[12]||this.p[13]!==y[13])&&(this.p=y,this._mdf.p=!0,x=!0),x};function TextProperty(r,a){this._frameId=initialDefaultFrame,this.pv="",this.v="",this.kf=!1,this._isFirstFrame=!0,this._mdf=!1,a.d&&a.d.sid&&(a.d=r.globalData.slotManager.getProp(a.d)),this.data=a,this.elem=r,this.comp=this.elem.comp,this.keysIndex=0,this.canResize=!1,this.minimumFontSize=1,this.effectsSequence=[],this.currentData={ascent:0,boxWidth:this.defaultBoxWidth,f:"",fStyle:"",fWeight:"",fc:"",j:"",justifyOffset:"",l:[],lh:0,lineWidths:[],ls:"",of:"",s:"",sc:"",sw:0,t:0,tr:0,sz:0,ps:null,fillColorAnim:!1,strokeColorAnim:!1,strokeWidthAnim:!1,yOffset:0,finalSize:0,finalText:[],finalLineHeight:0,__complete:!1},this.copyData(this.currentData,this.data.d.k[0].s),this.searchProperty()||this.completeTextData(this.currentData)}TextProperty.prototype.defaultBoxWidth=[0,0],TextProperty.prototype.copyData=function(r,a){for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(r[n]=a[n]);return r},TextProperty.prototype.setCurrentData=function(r){r.__complete||this.completeTextData(r),this.currentData=r,this.currentData.boxWidth=this.currentData.boxWidth||this.defaultBoxWidth,this._mdf=!0},TextProperty.prototype.searchProperty=function(){return this.searchKeyframes()},TextProperty.prototype.searchKeyframes=function(){return this.kf=this.data.d.k.length>1,this.kf&&this.addEffect(this.getKeyframeValue.bind(this)),this.kf},TextProperty.prototype.addEffect=function(r){this.effectsSequence.push(r),this.elem.addDynamicProperty(this)},TextProperty.prototype.getValue=function(r){if(!((this.elem.globalData.frameId===this.frameId||!this.effectsSequence.length)&&!r)){this.currentData.t=this.data.d.k[this.keysIndex].s.t;var a=this.currentData,n=this.keysIndex;if(this.lock){this.setCurrentData(this.currentData);return}this.lock=!0,this._mdf=!1;var o,f=this.effectsSequence.length,y=r||this.data.d.k[this.keysIndex].s;for(o=0;o<f;o+=1)n!==this.keysIndex?y=this.effectsSequence[o](y,y.t):y=this.effectsSequence[o](this.currentData,y.t);a!==y&&this.setCurrentData(y),this.v=this.currentData,this.pv=this.v,this.lock=!1,this.frameId=this.elem.globalData.frameId}},TextProperty.prototype.getKeyframeValue=function(){for(var r=this.data.d.k,a=this.elem.comp.renderedFrame,n=0,o=r.length;n<=o-1&&!(n===o-1||r[n+1].t>a);)n+=1;return this.keysIndex!==n&&(this.keysIndex=n),this.data.d.k[this.keysIndex].s},TextProperty.prototype.buildFinalText=function(r){for(var a=[],n=0,o=r.length,f,y,x=!1,b=!1,_="";n<o;)x=b,b=!1,f=r.charCodeAt(n),_=r.charAt(n),FontManager.isCombinedCharacter(f)?x=!0:f>=55296&&f<=56319?FontManager.isRegionalFlag(r,n)?_=r.substr(n,14):(y=r.charCodeAt(n+1),y>=56320&&y<=57343&&(FontManager.isModifier(f,y)?(_=r.substr(n,2),x=!0):FontManager.isFlagEmoji(r.substr(n,4))?_=r.substr(n,4):_=r.substr(n,2))):f>56319?(y=r.charCodeAt(n+1),FontManager.isVariationSelector(f)&&(x=!0)):FontManager.isZeroWidthJoiner(f)&&(x=!0,b=!0),x?(a[a.length-1]+=_,x=!1):a.push(_),n+=_.length;return a},TextProperty.prototype.completeTextData=function(r){r.__complete=!0;var a=this.elem.globalData.fontManager,n=this.data,o=[],f,y,x,b=0,_,S=n.m.g,A=0,C=0,P=0,T=[],M=0,O=0,I,D,z=a.getFontByName(r.f),k,L=0,R=getFontProperties(z);r.fWeight=R.weight,r.fStyle=R.style,r.finalSize=r.s,r.finalText=this.buildFinalText(r.t),y=r.finalText.length,r.finalLineHeight=r.lh;var F=r.tr/1e3*r.finalSize,B;if(r.sz)for(var N=!0,j=r.sz[0],G=r.sz[1],Y,X;N;){X=this.buildFinalText(r.t),Y=0,M=0,y=X.length,F=r.tr/1e3*r.finalSize;var $=-1;for(f=0;f<y;f+=1)B=X[f].charCodeAt(0),x=!1,X[f]===" "?$=f:(B===13||B===3)&&(M=0,x=!0,Y+=r.finalLineHeight||r.finalSize*1.2),a.chars?(k=a.getCharData(X[f],z.fStyle,z.fFamily),L=x?0:k.w*r.finalSize/100):L=a.measureText(X[f],r.f,r.finalSize),M+L>j&&X[f]!==" "?($===-1?y+=1:f=$,Y+=r.finalLineHeight||r.finalSize*1.2,X.splice(f,$===f?1:0,"\r"),$=-1,M=0):(M+=L,M+=F);Y+=z.ascent*r.finalSize/100,this.canResize&&r.finalSize>this.minimumFontSize&&G<Y?(r.finalSize-=1,r.finalLineHeight=r.finalSize*r.lh/r.s):(r.finalText=X,y=r.finalText.length,N=!1)}M=-F,L=0;var te=0,ee;for(f=0;f<y;f+=1)if(x=!1,ee=r.finalText[f],B=ee.charCodeAt(0),B===13||B===3?(te=0,T.push(M),O=M>O?M:O,M=-2*F,_="",x=!0,P+=1):_=ee,a.chars?(k=a.getCharData(ee,z.fStyle,a.getFontByName(r.f).fFamily),L=x?0:k.w*r.finalSize/100):L=a.measureText(_,r.f,r.finalSize),ee===" "?te+=L+F:(M+=L+F+te,te=0),o.push({l:L,an:L,add:A,n:x,anIndexes:[],val:_,line:P,animatorJustifyOffset:0}),S==2){if(A+=L,_===""||_===" "||f===y-1){for((_===""||_===" ")&&(A-=L);C<=f;)o[C].an=A,o[C].ind=b,o[C].extra=L,C+=1;b+=1,A=0}}else if(S==3){if(A+=L,_===""||f===y-1){for(_===""&&(A-=L);C<=f;)o[C].an=A,o[C].ind=b,o[C].extra=L,C+=1;A=0,b+=1}}else o[b].ind=b,o[b].extra=0,b+=1;if(r.l=o,O=M>O?M:O,T.push(M),r.sz)r.boxWidth=r.sz[0],r.justifyOffset=0;else switch(r.boxWidth=O,r.j){case 1:r.justifyOffset=-r.boxWidth;break;case 2:r.justifyOffset=-r.boxWidth/2;break;default:r.justifyOffset=0}r.lineWidths=T;var q=n.a,Z,U;D=q.length;var W,H,K=[];for(I=0;I<D;I+=1){for(Z=q[I],Z.a.sc&&(r.strokeColorAnim=!0),Z.a.sw&&(r.strokeWidthAnim=!0),(Z.a.fc||Z.a.fh||Z.a.fs||Z.a.fb)&&(r.fillColorAnim=!0),H=0,W=Z.s.b,f=0;f<y;f+=1)U=o[f],U.anIndexes[I]=H,(W==1&&U.val!==""||W==2&&U.val!==""&&U.val!==" "||W==3&&(U.n||U.val==" "||f==y-1)||W==4&&(U.n||f==y-1))&&(Z.s.rn===1&&K.push(H),H+=1);n.a[I].s.totalChars=H;var le=-1,me;if(Z.s.rn===1)for(f=0;f<y;f+=1)U=o[f],le!=U.anIndexes[I]&&(le=U.anIndexes[I],me=K.splice(Math.floor(Math.random()*K.length),1)[0]),U.anIndexes[I]=me}r.yOffset=r.finalLineHeight||r.finalSize*1.2,r.ls=r.ls||0,r.ascent=z.ascent*r.finalSize/100},TextProperty.prototype.updateDocumentData=function(r,a){a=a===void 0?this.keysIndex:a;var n=this.copyData({},this.data.d.k[a].s);n=this.copyData(n,r),this.data.d.k[a].s=n,this.recalculate(a),this.setCurrentData(n),this.elem.addDynamicProperty(this)},TextProperty.prototype.recalculate=function(r){var a=this.data.d.k[r].s;a.__complete=!1,this.keysIndex=0,this._isFirstFrame=!0,this.getValue(a)},TextProperty.prototype.canResizeFont=function(r){this.canResize=r,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)},TextProperty.prototype.setMinimumFontSize=function(r){this.minimumFontSize=Math.floor(r)||1,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)};var TextSelectorProp=function(){var r=Math.max,a=Math.min,n=Math.floor;function o(y,x){this._currentTextLength=-1,this.k=!1,this.data=x,this.elem=y,this.comp=y.comp,this.finalS=0,this.finalE=0,this.initDynamicPropertyContainer(y),this.s=PropertyFactory.getProp(y,x.s||{k:0},0,0,this),"e"in x?this.e=PropertyFactory.getProp(y,x.e,0,0,this):this.e={v:100},this.o=PropertyFactory.getProp(y,x.o||{k:0},0,0,this),this.xe=PropertyFactory.getProp(y,x.xe||{k:0},0,0,this),this.ne=PropertyFactory.getProp(y,x.ne||{k:0},0,0,this),this.sm=PropertyFactory.getProp(y,x.sm||{k:100},0,0,this),this.a=PropertyFactory.getProp(y,x.a,0,.01,this),this.dynamicProperties.length||this.getValue()}o.prototype={getMult:function(x){this._currentTextLength!==this.elem.textProperty.currentData.l.length&&this.getValue();var b=0,_=0,S=1,A=1;this.ne.v>0?b=this.ne.v/100:_=-this.ne.v/100,this.xe.v>0?S=1-this.xe.v/100:A=1+this.xe.v/100;var C=BezierFactory.getBezierEasing(b,_,S,A).get,P=0,T=this.finalS,M=this.finalE,O=this.data.sh;if(O===2)M===T?P=x>=M?1:0:P=r(0,a(.5/(M-T)+(x-T)/(M-T),1)),P=C(P);else if(O===3)M===T?P=x>=M?0:1:P=1-r(0,a(.5/(M-T)+(x-T)/(M-T),1)),P=C(P);else if(O===4)M===T?P=0:(P=r(0,a(.5/(M-T)+(x-T)/(M-T),1)),P<.5?P*=2:P=1-2*(P-.5)),P=C(P);else if(O===5){if(M===T)P=0;else{var I=M-T;x=a(r(0,x+.5-T),M-T);var D=-I/2+x,z=I/2;P=Math.sqrt(1-D*D/(z*z))}P=C(P)}else O===6?(M===T?P=0:(x=a(r(0,x+.5-T),M-T),P=(1+Math.cos(Math.PI+Math.PI*2*x/(M-T)))/2),P=C(P)):(x>=n(T)&&(x-T<0?P=r(0,a(a(M,1)-(T-x),1)):P=r(0,a(M-x,1))),P=C(P));if(this.sm.v!==100){var k=this.sm.v*.01;k===0&&(k=1e-8);var L=.5-k*.5;P<L?P=0:(P=(P-L)/k,P>1&&(P=1))}return P*this.a.v},getValue:function(x){this.iterateDynamicProperties(),this._mdf=x||this._mdf,this._currentTextLength=this.elem.textProperty.currentData.l.length||0,x&&this.data.r===2&&(this.e.v=this._currentTextLength);var b=this.data.r===2?1:100/this.data.totalChars,_=this.o.v/b,S=this.s.v/b+_,A=this.e.v/b+_;if(S>A){var C=S;S=A,A=C}this.finalS=S,this.finalE=A}},extendPrototype([DynamicPropertyContainer],o);function f(y,x,b){return new o(y,x)}return{getTextSelectorProp:f}}();function TextAnimatorDataProperty(r,a,n){var o={propType:!1},f=PropertyFactory.getProp,y=a.a;this.a={r:y.r?f(r,y.r,0,degToRads,n):o,rx:y.rx?f(r,y.rx,0,degToRads,n):o,ry:y.ry?f(r,y.ry,0,degToRads,n):o,sk:y.sk?f(r,y.sk,0,degToRads,n):o,sa:y.sa?f(r,y.sa,0,degToRads,n):o,s:y.s?f(r,y.s,1,.01,n):o,a:y.a?f(r,y.a,1,0,n):o,o:y.o?f(r,y.o,0,.01,n):o,p:y.p?f(r,y.p,1,0,n):o,sw:y.sw?f(r,y.sw,0,0,n):o,sc:y.sc?f(r,y.sc,1,0,n):o,fc:y.fc?f(r,y.fc,1,0,n):o,fh:y.fh?f(r,y.fh,0,0,n):o,fs:y.fs?f(r,y.fs,0,.01,n):o,fb:y.fb?f(r,y.fb,0,.01,n):o,t:y.t?f(r,y.t,0,0,n):o},this.s=TextSelectorProp.getTextSelectorProp(r,a.s,n),this.s.t=a.s.t}function TextAnimatorProperty(r,a,n){this._isFirstFrame=!0,this._hasMaskedPath=!1,this._frameId=-1,this._textData=r,this._renderType=a,this._elem=n,this._animatorsData=createSizedArray(this._textData.a.length),this._pathData={},this._moreOptions={alignment:{}},this.renderedLetters=[],this.lettersChangedFlag=!1,this.initDynamicPropertyContainer(n)}TextAnimatorProperty.prototype.searchProperties=function(){var r,a=this._textData.a.length,n,o=PropertyFactory.getProp;for(r=0;r<a;r+=1)n=this._textData.a[r],this._animatorsData[r]=new TextAnimatorDataProperty(this._elem,n,this);this._textData.p&&"m"in this._textData.p?(this._pathData={a:o(this._elem,this._textData.p.a,0,0,this),f:o(this._elem,this._textData.p.f,0,0,this),l:o(this._elem,this._textData.p.l,0,0,this),r:o(this._elem,this._textData.p.r,0,0,this),p:o(this._elem,this._textData.p.p,0,0,this),m:this._elem.maskManager.getMaskProperty(this._textData.p.m)},this._hasMaskedPath=!0):this._hasMaskedPath=!1,this._moreOptions.alignment=o(this._elem,this._textData.m.a,1,0,this)},TextAnimatorProperty.prototype.getMeasures=function(r,a){if(this.lettersChangedFlag=a,!(!this._mdf&&!this._isFirstFrame&&!a&&(!this._hasMaskedPath||!this._pathData.m._mdf))){this._isFirstFrame=!1;var n=this._moreOptions.alignment.v,o=this._animatorsData,f=this._textData,y=this.mHelper,x=this._renderType,b=this.renderedLetters.length,_,S,A,C,P=r.l,T,M,O,I,D,z,k,L,R,F,B,N,j,G,Y;if(this._hasMaskedPath){if(Y=this._pathData.m,!this._pathData.n||this._pathData._mdf){var X=Y.v;this._pathData.r.v&&(X=X.reverse()),T={tLength:0,segments:[]},C=X._length-1;var $;for(N=0,A=0;A<C;A+=1)$=bez.buildBezierData(X.v[A],X.v[A+1],[X.o[A][0]-X.v[A][0],X.o[A][1]-X.v[A][1]],[X.i[A+1][0]-X.v[A+1][0],X.i[A+1][1]-X.v[A+1][1]]),T.tLength+=$.segmentLength,T.segments.push($),N+=$.segmentLength;A=C,Y.v.c&&($=bez.buildBezierData(X.v[A],X.v[0],[X.o[A][0]-X.v[A][0],X.o[A][1]-X.v[A][1]],[X.i[0][0]-X.v[0][0],X.i[0][1]-X.v[0][1]]),T.tLength+=$.segmentLength,T.segments.push($),N+=$.segmentLength),this._pathData.pi=T}if(T=this._pathData.pi,M=this._pathData.f.v,k=0,z=1,I=0,D=!0,F=T.segments,M<0&&Y.v.c)for(T.tLength<Math.abs(M)&&(M=-Math.abs(M)%T.tLength),k=F.length-1,R=F[k].points,z=R.length-1;M<0;)M+=R[z].partialLength,z-=1,z<0&&(k-=1,R=F[k].points,z=R.length-1);R=F[k].points,L=R[z-1],O=R[z],B=O.partialLength}C=P.length,_=0,S=0;var te=r.finalSize*1.2*.714,ee=!0,q,Z,U,W,H;W=o.length;var K,le=-1,me,ne,pe,ge=M,ye=k,_e=z,ve=-1,Ee,xe,Me,Pe,be,Oe,Be,oe,De="",ze=this.defaultPropsArray,Ne;if(r.j===2||r.j===1){var Le=0,bt=0,Ve=r.j===2?-.5:-1,He=0,tt=!0;for(A=0;A<C;A+=1)if(P[A].n){for(Le&&(Le+=bt);He<A;)P[He].animatorJustifyOffset=Le,He+=1;Le=0,tt=!0}else{for(U=0;U<W;U+=1)q=o[U].a,q.t.propType&&(tt&&r.j===2&&(bt+=q.t.v*Ve),Z=o[U].s,K=Z.getMult(P[A].anIndexes[U],f.a[U].s.totalChars),K.length?Le+=q.t.v*K[0]*Ve:Le+=q.t.v*K*Ve);tt=!1}for(Le&&(Le+=bt);He<A;)P[He].animatorJustifyOffset=Le,He+=1}for(A=0;A<C;A+=1){if(y.reset(),Ee=1,P[A].n)_=0,S+=r.yOffset,S+=ee?1:0,M=ge,ee=!1,this._hasMaskedPath&&(k=ye,z=_e,R=F[k].points,L=R[z-1],O=R[z],B=O.partialLength,I=0),De="",oe="",Oe="",Ne="",ze=this.defaultPropsArray;else{if(this._hasMaskedPath){if(ve!==P[A].line){switch(r.j){case 1:M+=N-r.lineWidths[P[A].line];break;case 2:M+=(N-r.lineWidths[P[A].line])/2;break}ve=P[A].line}le!==P[A].ind&&(P[le]&&(M+=P[le].extra),M+=P[A].an/2,le=P[A].ind),M+=n[0]*P[A].an*.005;var ie=0;for(U=0;U<W;U+=1)q=o[U].a,q.p.propType&&(Z=o[U].s,K=Z.getMult(P[A].anIndexes[U],f.a[U].s.totalChars),K.length?ie+=q.p.v[0]*K[0]:ie+=q.p.v[0]*K),q.a.propType&&(Z=o[U].s,K=Z.getMult(P[A].anIndexes[U],f.a[U].s.totalChars),K.length?ie+=q.a.v[0]*K[0]:ie+=q.a.v[0]*K);for(D=!0,this._pathData.a.v&&(M=P[0].an*.5+(N-this._pathData.f.v-P[0].an*.5-P[P.length-1].an*.5)*le/(C-1),M+=this._pathData.f.v);D;)I+B>=M+ie||!R?(j=(M+ie-I)/O.partialLength,ne=L.point[0]+(O.point[0]-L.point[0])*j,pe=L.point[1]+(O.point[1]-L.point[1])*j,y.translate(-n[0]*P[A].an*.005,-(n[1]*te)*.01),D=!1):R&&(I+=O.partialLength,z+=1,z>=R.length&&(z=0,k+=1,F[k]?R=F[k].points:Y.v.c?(z=0,k=0,R=F[k].points):(I-=O.partialLength,R=null)),R&&(L=O,O=R[z],B=O.partialLength));me=P[A].an/2-P[A].add,y.translate(-me,0,0)}else me=P[A].an/2-P[A].add,y.translate(-me,0,0),y.translate(-n[0]*P[A].an*.005,-n[1]*te*.01,0);for(U=0;U<W;U+=1)q=o[U].a,q.t.propType&&(Z=o[U].s,K=Z.getMult(P[A].anIndexes[U],f.a[U].s.totalChars),(_!==0||r.j!==0)&&(this._hasMaskedPath?K.length?M+=q.t.v*K[0]:M+=q.t.v*K:K.length?_+=q.t.v*K[0]:_+=q.t.v*K));for(r.strokeWidthAnim&&(Me=r.sw||0),r.strokeColorAnim&&(r.sc?xe=[r.sc[0],r.sc[1],r.sc[2]]:xe=[0,0,0]),r.fillColorAnim&&r.fc&&(Pe=[r.fc[0],r.fc[1],r.fc[2]]),U=0;U<W;U+=1)q=o[U].a,q.a.propType&&(Z=o[U].s,K=Z.getMult(P[A].anIndexes[U],f.a[U].s.totalChars),K.length?y.translate(-q.a.v[0]*K[0],-q.a.v[1]*K[1],q.a.v[2]*K[2]):y.translate(-q.a.v[0]*K,-q.a.v[1]*K,q.a.v[2]*K));for(U=0;U<W;U+=1)q=o[U].a,q.s.propType&&(Z=o[U].s,K=Z.getMult(P[A].anIndexes[U],f.a[U].s.totalChars),K.length?y.scale(1+(q.s.v[0]-1)*K[0],1+(q.s.v[1]-1)*K[1],1):y.scale(1+(q.s.v[0]-1)*K,1+(q.s.v[1]-1)*K,1));for(U=0;U<W;U+=1){if(q=o[U].a,Z=o[U].s,K=Z.getMult(P[A].anIndexes[U],f.a[U].s.totalChars),q.sk.propType&&(K.length?y.skewFromAxis(-q.sk.v*K[0],q.sa.v*K[1]):y.skewFromAxis(-q.sk.v*K,q.sa.v*K)),q.r.propType&&(K.length?y.rotateZ(-q.r.v*K[2]):y.rotateZ(-q.r.v*K)),q.ry.propType&&(K.length?y.rotateY(q.ry.v*K[1]):y.rotateY(q.ry.v*K)),q.rx.propType&&(K.length?y.rotateX(q.rx.v*K[0]):y.rotateX(q.rx.v*K)),q.o.propType&&(K.length?Ee+=(q.o.v*K[0]-Ee)*K[0]:Ee+=(q.o.v*K-Ee)*K),r.strokeWidthAnim&&q.sw.propType&&(K.length?Me+=q.sw.v*K[0]:Me+=q.sw.v*K),r.strokeColorAnim&&q.sc.propType)for(be=0;be<3;be+=1)K.length?xe[be]+=(q.sc.v[be]-xe[be])*K[0]:xe[be]+=(q.sc.v[be]-xe[be])*K;if(r.fillColorAnim&&r.fc){if(q.fc.propType)for(be=0;be<3;be+=1)K.length?Pe[be]+=(q.fc.v[be]-Pe[be])*K[0]:Pe[be]+=(q.fc.v[be]-Pe[be])*K;q.fh.propType&&(K.length?Pe=addHueToRGB(Pe,q.fh.v*K[0]):Pe=addHueToRGB(Pe,q.fh.v*K)),q.fs.propType&&(K.length?Pe=addSaturationToRGB(Pe,q.fs.v*K[0]):Pe=addSaturationToRGB(Pe,q.fs.v*K)),q.fb.propType&&(K.length?Pe=addBrightnessToRGB(Pe,q.fb.v*K[0]):Pe=addBrightnessToRGB(Pe,q.fb.v*K))}}for(U=0;U<W;U+=1)q=o[U].a,q.p.propType&&(Z=o[U].s,K=Z.getMult(P[A].anIndexes[U],f.a[U].s.totalChars),this._hasMaskedPath?K.length?y.translate(0,q.p.v[1]*K[0],-q.p.v[2]*K[1]):y.translate(0,q.p.v[1]*K,-q.p.v[2]*K):K.length?y.translate(q.p.v[0]*K[0],q.p.v[1]*K[1],-q.p.v[2]*K[2]):y.translate(q.p.v[0]*K,q.p.v[1]*K,-q.p.v[2]*K));if(r.strokeWidthAnim&&(Oe=Me<0?0:Me),r.strokeColorAnim&&(Be="rgb("+Math.round(xe[0]*255)+","+Math.round(xe[1]*255)+","+Math.round(xe[2]*255)+")"),r.fillColorAnim&&r.fc&&(oe="rgb("+Math.round(Pe[0]*255)+","+Math.round(Pe[1]*255)+","+Math.round(Pe[2]*255)+")"),this._hasMaskedPath){if(y.translate(0,-r.ls),y.translate(0,n[1]*te*.01+S,0),this._pathData.p.v){G=(O.point[1]-L.point[1])/(O.point[0]-L.point[0]);var We=Math.atan(G)*180/Math.PI;O.point[0]<L.point[0]&&(We+=180),y.rotate(-We*Math.PI/180)}y.translate(ne,pe,0),M-=n[0]*P[A].an*.005,P[A+1]&&le!==P[A+1].ind&&(M+=P[A].an/2,M+=r.tr*.001*r.finalSize)}else{switch(y.translate(_,S,0),r.ps&&y.translate(r.ps[0],r.ps[1]+r.ascent,0),r.j){case 1:y.translate(P[A].animatorJustifyOffset+r.justifyOffset+(r.boxWidth-r.lineWidths[P[A].line]),0,0);break;case 2:y.translate(P[A].animatorJustifyOffset+r.justifyOffset+(r.boxWidth-r.lineWidths[P[A].line])/2,0,0);break}y.translate(0,-r.ls),y.translate(me,0,0),y.translate(n[0]*P[A].an*.005,n[1]*te*.01,0),_+=P[A].l+r.tr*.001*r.finalSize}x==="html"?De=y.toCSS():x==="svg"?De=y.to2dCSS():ze=[y.props[0],y.props[1],y.props[2],y.props[3],y.props[4],y.props[5],y.props[6],y.props[7],y.props[8],y.props[9],y.props[10],y.props[11],y.props[12],y.props[13],y.props[14],y.props[15]],Ne=Ee}b<=A?(H=new LetterProps(Ne,Oe,Be,oe,De,ze),this.renderedLetters.push(H),b+=1,this.lettersChangedFlag=!0):(H=this.renderedLetters[A],this.lettersChangedFlag=H.update(Ne,Oe,Be,oe,De,ze)||this.lettersChangedFlag)}}},TextAnimatorProperty.prototype.getValue=function(){this._elem.globalData.frameId!==this._frameId&&(this._frameId=this._elem.globalData.frameId,this.iterateDynamicProperties())},TextAnimatorProperty.prototype.mHelper=new Matrix,TextAnimatorProperty.prototype.defaultPropsArray=[],extendPrototype([DynamicPropertyContainer],TextAnimatorProperty);function ITextElement(){}ITextElement.prototype.initElement=function(r,a,n){this.lettersChangedFlag=!0,this.initFrame(),this.initBaseData(r,a,n),this.textProperty=new TextProperty(this,r.t,this.dynamicProperties),this.textAnimator=new TextAnimatorProperty(r.t,this.renderType,this),this.initTransform(r,a,n),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide(),this.textAnimator.searchProperties(this.dynamicProperties)},ITextElement.prototype.prepareFrame=function(r){this._mdf=!1,this.prepareRenderableFrame(r),this.prepareProperties(r,this.isInRange)},ITextElement.prototype.createPathShape=function(r,a){var n,o=a.length,f,y="";for(n=0;n<o;n+=1)a[n].ty==="sh"&&(f=a[n].ks.k,y+=buildShapeString(f,f.i.length,!0,r));return y},ITextElement.prototype.updateDocumentData=function(r,a){this.textProperty.updateDocumentData(r,a)},ITextElement.prototype.canResizeFont=function(r){this.textProperty.canResizeFont(r)},ITextElement.prototype.setMinimumFontSize=function(r){this.textProperty.setMinimumFontSize(r)},ITextElement.prototype.applyTextPropertiesToMatrix=function(r,a,n,o,f){switch(r.ps&&a.translate(r.ps[0],r.ps[1]+r.ascent,0),a.translate(0,-r.ls,0),r.j){case 1:a.translate(r.justifyOffset+(r.boxWidth-r.lineWidths[n]),0,0);break;case 2:a.translate(r.justifyOffset+(r.boxWidth-r.lineWidths[n])/2,0,0);break}a.translate(o,f,0)},ITextElement.prototype.buildColor=function(r){return"rgb("+Math.round(r[0]*255)+","+Math.round(r[1]*255)+","+Math.round(r[2]*255)+")"},ITextElement.prototype.emptyProp=new LetterProps,ITextElement.prototype.destroy=function(){},ITextElement.prototype.validateText=function(){(this.textProperty._mdf||this.textProperty._isFirstFrame)&&(this.buildNewText(),this.textProperty._isFirstFrame=!1,this.textProperty._mdf=!1)};var emptyShapeData={shapes:[]};function SVGTextLottieElement(r,a,n){this.textSpans=[],this.renderType="svg",this.initElement(r,a,n)}extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],SVGTextLottieElement),SVGTextLottieElement.prototype.createContent=function(){this.data.singleShape&&!this.globalData.fontManager.chars&&(this.textContainer=createNS("text"))},SVGTextLottieElement.prototype.buildTextContents=function(r){for(var a=0,n=r.length,o=[],f="";a<n;)r[a]==="\r"||r[a]===""?(o.push(f),f=""):f+=r[a],a+=1;return o.push(f),o},SVGTextLottieElement.prototype.buildShapeData=function(r,a){if(r.shapes&&r.shapes.length){var n=r.shapes[0];if(n.it){var o=n.it[n.it.length-1];o.s&&(o.s.k[0]=a,o.s.k[1]=a)}}return r},SVGTextLottieElement.prototype.buildNewText=function(){this.addDynamicProperty(this);var r,a,n=this.textProperty.currentData;this.renderedLetters=createSizedArray(n?n.l.length:0),n.fc?this.layerElement.setAttribute("fill",this.buildColor(n.fc)):this.layerElement.setAttribute("fill","rgba(0,0,0,0)"),n.sc&&(this.layerElement.setAttribute("stroke",this.buildColor(n.sc)),this.layerElement.setAttribute("stroke-width",n.sw)),this.layerElement.setAttribute("font-size",n.finalSize);var o=this.globalData.fontManager.getFontByName(n.f);if(o.fClass)this.layerElement.setAttribute("class",o.fClass);else{this.layerElement.setAttribute("font-family",o.fFamily);var f=n.fWeight,y=n.fStyle;this.layerElement.setAttribute("font-style",y),this.layerElement.setAttribute("font-weight",f)}this.layerElement.setAttribute("aria-label",n.t);var x=n.l||[],b=!!this.globalData.fontManager.chars;a=x.length;var _,S=this.mHelper,A="",C=this.data.singleShape,P=0,T=0,M=!0,O=n.tr*.001*n.finalSize;if(C&&!b&&!n.sz){var I=this.textContainer,D="start";switch(n.j){case 1:D="end";break;case 2:D="middle";break;default:D="start";break}I.setAttribute("text-anchor",D),I.setAttribute("letter-spacing",O);var z=this.buildTextContents(n.finalText);for(a=z.length,T=n.ps?n.ps[1]+n.ascent:0,r=0;r<a;r+=1)_=this.textSpans[r].span||createNS("tspan"),_.textContent=z[r],_.setAttribute("x",0),_.setAttribute("y",T),_.style.display="inherit",I.appendChild(_),this.textSpans[r]||(this.textSpans[r]={span:null,glyph:null}),this.textSpans[r].span=_,T+=n.finalLineHeight;this.layerElement.appendChild(I)}else{var k=this.textSpans.length,L;for(r=0;r<a;r+=1){if(this.textSpans[r]||(this.textSpans[r]={span:null,childSpan:null,glyph:null}),!b||!C||r===0){if(_=k>r?this.textSpans[r].span:createNS(b?"g":"text"),k<=r){if(_.setAttribute("stroke-linecap","butt"),_.setAttribute("stroke-linejoin","round"),_.setAttribute("stroke-miterlimit","4"),this.textSpans[r].span=_,b){var R=createNS("g");_.appendChild(R),this.textSpans[r].childSpan=R}this.textSpans[r].span=_,this.layerElement.appendChild(_)}_.style.display="inherit"}if(S.reset(),C&&(x[r].n&&(P=-O,T+=n.yOffset,T+=M?1:0,M=!1),this.applyTextPropertiesToMatrix(n,S,x[r].line,P,T),P+=x[r].l||0,P+=O),b){L=this.globalData.fontManager.getCharData(n.finalText[r],o.fStyle,this.globalData.fontManager.getFontByName(n.f).fFamily);var F;if(L.t===1)F=new SVGCompElement(L.data,this.globalData,this);else{var B=emptyShapeData;L.data&&L.data.shapes&&(B=this.buildShapeData(L.data,n.finalSize)),F=new SVGShapeElement(B,this.globalData,this)}if(this.textSpans[r].glyph){var N=this.textSpans[r].glyph;this.textSpans[r].childSpan.removeChild(N.layerElement),N.destroy()}this.textSpans[r].glyph=F,F._debug=!0,F.prepareFrame(0),F.renderFrame(),this.textSpans[r].childSpan.appendChild(F.layerElement),L.t===1&&this.textSpans[r].childSpan.setAttribute("transform","scale("+n.finalSize/100+","+n.finalSize/100+")")}else C&&_.setAttribute("transform","translate("+S.props[12]+","+S.props[13]+")"),_.textContent=x[r].val,_.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve")}C&&_&&_.setAttribute("d",A)}for(;r<this.textSpans.length;)this.textSpans[r].span.style.display="none",r+=1;this._sizeChanged=!0},SVGTextLottieElement.prototype.sourceRectAtTime=function(){if(this.prepareFrame(this.comp.renderedFrame-this.data.st),this.renderInnerContent(),this._sizeChanged){this._sizeChanged=!1;var r=this.layerElement.getBBox();this.bbox={top:r.y,left:r.x,width:r.width,height:r.height}}return this.bbox},SVGTextLottieElement.prototype.getValue=function(){var r,a=this.textSpans.length,n;for(this.renderedFrame=this.comp.renderedFrame,r=0;r<a;r+=1)n=this.textSpans[r].glyph,n&&(n.prepareFrame(this.comp.renderedFrame-this.data.st),n._mdf&&(this._mdf=!0))},SVGTextLottieElement.prototype.renderInnerContent=function(){if(this.validateText(),(!this.data.singleShape||this._mdf)&&(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),this.lettersChangedFlag||this.textAnimator.lettersChangedFlag)){this._sizeChanged=!0;var r,a,n=this.textAnimator.renderedLetters,o=this.textProperty.currentData.l;a=o.length;var f,y,x;for(r=0;r<a;r+=1)o[r].n||(f=n[r],y=this.textSpans[r].span,x=this.textSpans[r].glyph,x&&x.renderFrame(),f._mdf.m&&y.setAttribute("transform",f.m),f._mdf.o&&y.setAttribute("opacity",f.o),f._mdf.sw&&y.setAttribute("stroke-width",f.sw),f._mdf.sc&&y.setAttribute("stroke",f.sc),f._mdf.fc&&y.setAttribute("fill",f.fc))}};function ISolidElement(r,a,n){this.initElement(r,a,n)}extendPrototype([IImageElement],ISolidElement),ISolidElement.prototype.createContent=function(){var r=createNS("rect");r.setAttribute("width",this.data.sw),r.setAttribute("height",this.data.sh),r.setAttribute("fill",this.data.sc),this.layerElement.appendChild(r)};function NullElement(r,a,n){this.initFrame(),this.initBaseData(r,a,n),this.initFrame(),this.initTransform(r,a,n),this.initHierarchy()}NullElement.prototype.prepareFrame=function(r){this.prepareProperties(r,!0)},NullElement.prototype.renderFrame=function(){},NullElement.prototype.getBaseElement=function(){return null},NullElement.prototype.destroy=function(){},NullElement.prototype.sourceRectAtTime=function(){},NullElement.prototype.hide=function(){},extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement],NullElement);function SVGRendererBase(){}extendPrototype([BaseRenderer],SVGRendererBase),SVGRendererBase.prototype.createNull=function(r){return new NullElement(r,this.globalData,this)},SVGRendererBase.prototype.createShape=function(r){return new SVGShapeElement(r,this.globalData,this)},SVGRendererBase.prototype.createText=function(r){return new SVGTextLottieElement(r,this.globalData,this)},SVGRendererBase.prototype.createImage=function(r){return new IImageElement(r,this.globalData,this)},SVGRendererBase.prototype.createSolid=function(r){return new ISolidElement(r,this.globalData,this)},SVGRendererBase.prototype.configAnimation=function(r){this.svgElement.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.svgElement.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),this.renderConfig.viewBoxSize?this.svgElement.setAttribute("viewBox",this.renderConfig.viewBoxSize):this.svgElement.setAttribute("viewBox","0 0 "+r.w+" "+r.h),this.renderConfig.viewBoxOnly||(this.svgElement.setAttribute("width",r.w),this.svgElement.setAttribute("height",r.h),this.svgElement.style.width="100%",this.svgElement.style.height="100%",this.svgElement.style.transform="translate3d(0,0,0)",this.svgElement.style.contentVisibility=this.renderConfig.contentVisibility),this.renderConfig.width&&this.svgElement.setAttribute("width",this.renderConfig.width),this.renderConfig.height&&this.svgElement.setAttribute("height",this.renderConfig.height),this.renderConfig.className&&this.svgElement.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.svgElement.setAttribute("id",this.renderConfig.id),this.renderConfig.focusable!==void 0&&this.svgElement.setAttribute("focusable",this.renderConfig.focusable),this.svgElement.setAttribute("preserveAspectRatio",this.renderConfig.preserveAspectRatio),this.animationItem.wrapper.appendChild(this.svgElement);var a=this.globalData.defs;this.setupGlobalData(r,a),this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.data=r;var n=createNS("clipPath"),o=createNS("rect");o.setAttribute("width",r.w),o.setAttribute("height",r.h),o.setAttribute("x",0),o.setAttribute("y",0);var f=createElementID();n.setAttribute("id",f),n.appendChild(o),this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+f+")"),a.appendChild(n),this.layers=r.layers,this.elements=createSizedArray(r.layers.length)},SVGRendererBase.prototype.destroy=function(){this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.layerElement=null,this.globalData.defs=null;var r,a=this.layers?this.layers.length:0;for(r=0;r<a;r+=1)this.elements[r]&&this.elements[r].destroy&&this.elements[r].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},SVGRendererBase.prototype.updateContainerSize=function(){},SVGRendererBase.prototype.findIndexByInd=function(r){var a=0,n=this.layers.length;for(a=0;a<n;a+=1)if(this.layers[a].ind===r)return a;return-1},SVGRendererBase.prototype.buildItem=function(r){var a=this.elements;if(!(a[r]||this.layers[r].ty===99)){a[r]=!0;var n=this.createItem(this.layers[r]);if(a[r]=n,getExpressionsPlugin()&&(this.layers[r].ty===0&&this.globalData.projectInterface.registerComposition(n),n.initExpressions()),this.appendElementInPos(n,r),this.layers[r].tt){var o="tp"in this.layers[r]?this.findIndexByInd(this.layers[r].tp):r-1;if(o===-1)return;if(!this.elements[o]||this.elements[o]===!0)this.buildItem(o),this.addPendingElement(n);else{var f=a[o],y=f.getMatte(this.layers[r].tt);n.setMatte(y)}}}},SVGRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var r=this.pendingElements.pop();if(r.checkParenting(),r.data.tt)for(var a=0,n=this.elements.length;a<n;){if(this.elements[a]===r){var o="tp"in r.data?this.findIndexByInd(r.data.tp):a-1,f=this.elements[o],y=f.getMatte(this.layers[a].tt);r.setMatte(y);break}a+=1}}},SVGRendererBase.prototype.renderFrame=function(r){if(!(this.renderedFrame===r||this.destroyed)){r===null?r=this.renderedFrame:this.renderedFrame=r,this.globalData.frameNum=r,this.globalData.frameId+=1,this.globalData.projectInterface.currentFrame=r,this.globalData._mdf=!1;var a,n=this.layers.length;for(this.completeLayers||this.checkLayers(r),a=n-1;a>=0;a-=1)(this.completeLayers||this.elements[a])&&this.elements[a].prepareFrame(r-this.layers[a].st);if(this.globalData._mdf)for(a=0;a<n;a+=1)(this.completeLayers||this.elements[a])&&this.elements[a].renderFrame()}},SVGRendererBase.prototype.appendElementInPos=function(r,a){var n=r.getBaseElement();if(n){for(var o=0,f;o<a;)this.elements[o]&&this.elements[o]!==!0&&this.elements[o].getBaseElement()&&(f=this.elements[o].getBaseElement()),o+=1;f?this.layerElement.insertBefore(n,f):this.layerElement.appendChild(n)}},SVGRendererBase.prototype.hide=function(){this.layerElement.style.display="none"},SVGRendererBase.prototype.show=function(){this.layerElement.style.display="block"};function ICompElement(){}extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement,RenderableDOMElement],ICompElement),ICompElement.prototype.initElement=function(r,a,n){this.initFrame(),this.initBaseData(r,a,n),this.initTransform(r,a,n),this.initRenderable(),this.initHierarchy(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),(this.data.xt||!a.progressiveLoad)&&this.buildAllItems(),this.hide()},ICompElement.prototype.prepareFrame=function(r){if(this._mdf=!1,this.prepareRenderableFrame(r),this.prepareProperties(r,this.isInRange),!(!this.isInRange&&!this.data.xt)){if(this.tm._placeholder)this.renderedFrame=r/this.data.sr;else{var a=this.tm.v;a===this.data.op&&(a=this.data.op-1),this.renderedFrame=a}var n,o=this.elements.length;for(this.completeLayers||this.checkLayers(this.renderedFrame),n=o-1;n>=0;n-=1)(this.completeLayers||this.elements[n])&&(this.elements[n].prepareFrame(this.renderedFrame-this.layers[n].st),this.elements[n]._mdf&&(this._mdf=!0))}},ICompElement.prototype.renderInnerContent=function(){var r,a=this.layers.length;for(r=0;r<a;r+=1)(this.completeLayers||this.elements[r])&&this.elements[r].renderFrame()},ICompElement.prototype.setElements=function(r){this.elements=r},ICompElement.prototype.getElements=function(){return this.elements},ICompElement.prototype.destroyElements=function(){var r,a=this.layers.length;for(r=0;r<a;r+=1)this.elements[r]&&this.elements[r].destroy()},ICompElement.prototype.destroy=function(){this.destroyElements(),this.destroyBaseElement()};function SVGCompElement(r,a,n){this.layers=r.layers,this.supports3d=!0,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(r,a,n),this.tm=r.tm?PropertyFactory.getProp(this,r.tm,0,a.frameRate,this):{_placeholder:!0}}extendPrototype([SVGRendererBase,ICompElement,SVGBaseElement],SVGCompElement),SVGCompElement.prototype.createComp=function(r){return new SVGCompElement(r,this.globalData,this)};function SVGRenderer(r,a){this.animationItem=r,this.layers=null,this.renderedFrame=-1,this.svgElement=createNS("svg");var n="";if(a&&a.title){var o=createNS("title"),f=createElementID();o.setAttribute("id",f),o.textContent=a.title,this.svgElement.appendChild(o),n+=f}if(a&&a.description){var y=createNS("desc"),x=createElementID();y.setAttribute("id",x),y.textContent=a.description,this.svgElement.appendChild(y),n+=" "+x}n&&this.svgElement.setAttribute("aria-labelledby",n);var b=createNS("defs");this.svgElement.appendChild(b);var _=createNS("g");this.svgElement.appendChild(_),this.layerElement=_,this.renderConfig={preserveAspectRatio:a&&a.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:a&&a.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:a&&a.contentVisibility||"visible",progressiveLoad:a&&a.progressiveLoad||!1,hideOnTransparent:!(a&&a.hideOnTransparent===!1),viewBoxOnly:a&&a.viewBoxOnly||!1,viewBoxSize:a&&a.viewBoxSize||!1,className:a&&a.className||"",id:a&&a.id||"",focusable:a&&a.focusable,filterSize:{width:a&&a.filterSize&&a.filterSize.width||"100%",height:a&&a.filterSize&&a.filterSize.height||"100%",x:a&&a.filterSize&&a.filterSize.x||"0%",y:a&&a.filterSize&&a.filterSize.y||"0%"},width:a&&a.width,height:a&&a.height,runExpressions:!a||a.runExpressions===void 0||a.runExpressions},this.globalData={_mdf:!1,frameNum:-1,defs:b,renderConfig:this.renderConfig},this.elements=[],this.pendingElements=[],this.destroyed=!1,this.rendererType="svg"}extendPrototype([SVGRendererBase],SVGRenderer),SVGRenderer.prototype.createComp=function(r){return new SVGCompElement(r,this.globalData,this)};function ShapeTransformManager(){this.sequences={},this.sequenceList=[],this.transform_key_count=0}ShapeTransformManager.prototype={addTransformSequence:function(a){var n,o=a.length,f="_";for(n=0;n<o;n+=1)f+=a[n].transform.key+"_";var y=this.sequences[f];return y||(y={transforms:[].concat(a),finalTransform:new Matrix,_mdf:!1},this.sequences[f]=y,this.sequenceList.push(y)),y},processSequence:function(a,n){for(var o=0,f=a.transforms.length,y=n;o<f&&!n;){if(a.transforms[o].transform.mProps._mdf){y=!0;break}o+=1}if(y)for(a.finalTransform.reset(),o=f-1;o>=0;o-=1)a.finalTransform.multiply(a.transforms[o].transform.mProps.v);a._mdf=y},processSequences:function(a){var n,o=this.sequenceList.length;for(n=0;n<o;n+=1)this.processSequence(this.sequenceList[n],a)},getNewKey:function(){return this.transform_key_count+=1,"_"+this.transform_key_count}};var lumaLoader=function(){var a="__lottie_element_luma_buffer",n=null,o=null,f=null;function y(){var _=createNS("svg"),S=createNS("filter"),A=createNS("feColorMatrix");return S.setAttribute("id",a),A.setAttribute("type","matrix"),A.setAttribute("color-interpolation-filters","sRGB"),A.setAttribute("values","0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0"),S.appendChild(A),_.appendChild(S),_.setAttribute("id",a+"_svg"),featureSupport.svgLumaHidden&&(_.style.display="none"),_}function x(){n||(f=y(),document.body.appendChild(f),n=createTag("canvas"),o=n.getContext("2d"),o.filter="url(#"+a+")",o.fillStyle="rgba(0,0,0,0)",o.fillRect(0,0,1,1))}function b(_){return n||x(),n.width=_.width,n.height=_.height,o.filter="url(#"+a+")",n}return{load:x,get:b}};function createCanvas(r,a){if(featureSupport.offscreenCanvas)return new OffscreenCanvas(r,a);var n=createTag("canvas");return n.width=r,n.height=a,n}var assetLoader=function(){return{loadLumaCanvas:lumaLoader.load,getLumaCanvas:lumaLoader.get,createCanvas}}(),registeredEffects={};function CVEffects(r){var a,n=r.data.ef?r.data.ef.length:0;this.filters=[];var o;for(a=0;a<n;a+=1){o=null;var f=r.data.ef[a].ty;if(registeredEffects[f]){var y=registeredEffects[f].effect;o=new y(r.effectsManager.effectElements[a],r)}o&&this.filters.push(o)}this.filters.length&&r.addRenderableComponent(this)}CVEffects.prototype.renderFrame=function(r){var a,n=this.filters.length;for(a=0;a<n;a+=1)this.filters[a].renderFrame(r)},CVEffects.prototype.getEffects=function(r){var a,n=this.filters.length,o=[];for(a=0;a<n;a+=1)this.filters[a].type===r&&o.push(this.filters[a]);return o};function registerEffect(r,a){registeredEffects[r]={effect:a}}function CVMaskElement(r,a){this.data=r,this.element=a,this.masksProperties=this.data.masksProperties||[],this.viewData=createSizedArray(this.masksProperties.length);var n,o=this.masksProperties.length,f=!1;for(n=0;n<o;n+=1)this.masksProperties[n].mode!=="n"&&(f=!0),this.viewData[n]=ShapePropertyFactory.getShapeProp(this.element,this.masksProperties[n],3);this.hasMasks=f,f&&this.element.addRenderableComponent(this)}CVMaskElement.prototype.renderFrame=function(){if(this.hasMasks){var r=this.element.finalTransform.mat,a=this.element.canvasContext,n,o=this.masksProperties.length,f,y,x;for(a.beginPath(),n=0;n<o;n+=1)if(this.masksProperties[n].mode!=="n"){this.masksProperties[n].inv&&(a.moveTo(0,0),a.lineTo(this.element.globalData.compSize.w,0),a.lineTo(this.element.globalData.compSize.w,this.element.globalData.compSize.h),a.lineTo(0,this.element.globalData.compSize.h),a.lineTo(0,0)),x=this.viewData[n].v,f=r.applyToPointArray(x.v[0][0],x.v[0][1],0),a.moveTo(f[0],f[1]);var b,_=x._length;for(b=1;b<_;b+=1)y=r.applyToTriplePoints(x.o[b-1],x.i[b],x.v[b]),a.bezierCurveTo(y[0],y[1],y[2],y[3],y[4],y[5]);y=r.applyToTriplePoints(x.o[b-1],x.i[0],x.v[0]),a.bezierCurveTo(y[0],y[1],y[2],y[3],y[4],y[5])}this.element.globalData.renderer.save(!0),a.clip()}},CVMaskElement.prototype.getMaskProperty=MaskElement.prototype.getMaskProperty,CVMaskElement.prototype.destroy=function(){this.element=null};function CVBaseElement(){}var operationsMap={1:"source-in",2:"source-out",3:"source-in",4:"source-out"};CVBaseElement.prototype={createElements:function(){},initRendererElement:function(){},createContainerElements:function(){if(this.data.tt>=1){this.buffers=[];var a=this.globalData.canvasContext,n=assetLoader.createCanvas(a.canvas.width,a.canvas.height);this.buffers.push(n);var o=assetLoader.createCanvas(a.canvas.width,a.canvas.height);this.buffers.push(o),this.data.tt>=3&&!document._isProxy&&assetLoader.loadLumaCanvas()}this.canvasContext=this.globalData.canvasContext,this.transformCanvas=this.globalData.transformCanvas,this.renderableEffectsManager=new CVEffects(this),this.searchEffectTransforms()},createContent:function(){},setBlendMode:function(){var a=this.globalData;if(a.blendMode!==this.data.bm){a.blendMode=this.data.bm;var n=getBlendMode(this.data.bm);a.canvasContext.globalCompositeOperation=n}},createRenderableComponents:function(){this.maskManager=new CVMaskElement(this.data,this),this.transformEffects=this.renderableEffectsManager.getEffects(effectTypes.TRANSFORM_EFFECT)},hideElement:function(){!this.hidden&&(!this.isInRange||this.isTransparent)&&(this.hidden=!0)},showElement:function(){this.isInRange&&!this.isTransparent&&(this.hidden=!1,this._isFirstFrame=!0,this.maskManager._isFirstFrame=!0)},clearCanvas:function(a){a.clearRect(this.transformCanvas.tx,this.transformCanvas.ty,this.transformCanvas.w*this.transformCanvas.sx,this.transformCanvas.h*this.transformCanvas.sy)},prepareLayer:function(){if(this.data.tt>=1){var a=this.buffers[0],n=a.getContext("2d");this.clearCanvas(n),n.drawImage(this.canvasContext.canvas,0,0),this.currentTransform=this.canvasContext.getTransform(),this.canvasContext.setTransform(1,0,0,1,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.setTransform(this.currentTransform)}},exitLayer:function(){if(this.data.tt>=1){var a=this.buffers[1],n=a.getContext("2d");this.clearCanvas(n),n.drawImage(this.canvasContext.canvas,0,0),this.canvasContext.setTransform(1,0,0,1,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.setTransform(this.currentTransform);var o=this.comp.getElementById("tp"in this.data?this.data.tp:this.data.ind-1);if(o.renderFrame(!0),this.canvasContext.setTransform(1,0,0,1,0,0),this.data.tt>=3&&!document._isProxy){var f=assetLoader.getLumaCanvas(this.canvasContext.canvas),y=f.getContext("2d");y.drawImage(this.canvasContext.canvas,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.drawImage(f,0,0)}this.canvasContext.globalCompositeOperation=operationsMap[this.data.tt],this.canvasContext.drawImage(a,0,0),this.canvasContext.globalCompositeOperation="destination-over",this.canvasContext.drawImage(this.buffers[0],0,0),this.canvasContext.setTransform(this.currentTransform),this.canvasContext.globalCompositeOperation="source-over"}},renderFrame:function(a){if(!(this.hidden||this.data.hd)&&!(this.data.td===1&&!a)){this.renderTransform(),this.renderRenderable(),this.renderLocalTransform(),this.setBlendMode();var n=this.data.ty===0;this.prepareLayer(),this.globalData.renderer.save(n),this.globalData.renderer.ctxTransform(this.finalTransform.localMat.props),this.globalData.renderer.ctxOpacity(this.finalTransform.localOpacity),this.renderInnerContent(),this.globalData.renderer.restore(n),this.exitLayer(),this.maskManager.hasMasks&&this.globalData.renderer.restore(!0),this._isFirstFrame&&(this._isFirstFrame=!1)}},destroy:function(){this.canvasContext=null,this.data=null,this.globalData=null,this.maskManager.destroy()},mHelper:new Matrix},CVBaseElement.prototype.hide=CVBaseElement.prototype.hideElement,CVBaseElement.prototype.show=CVBaseElement.prototype.showElement;function CVShapeData(r,a,n,o){this.styledShapes=[],this.tr=[0,0,0,0,0,0];var f=4;a.ty==="rc"?f=5:a.ty==="el"?f=6:a.ty==="sr"&&(f=7),this.sh=ShapePropertyFactory.getShapeProp(r,a,f,r);var y,x=n.length,b;for(y=0;y<x;y+=1)n[y].closed||(b={transforms:o.addTransformSequence(n[y].transforms),trNodes:[]},this.styledShapes.push(b),n[y].elements.push(b))}CVShapeData.prototype.setAsAnimated=SVGShapeData.prototype.setAsAnimated;function CVShapeElement(r,a,n){this.shapes=[],this.shapesData=r.shapes,this.stylesList=[],this.itemsData=[],this.prevViewData=[],this.shapeModifiers=[],this.processedElements=[],this.transformsManager=new ShapeTransformManager,this.initElement(r,a,n)}extendPrototype([BaseElement,TransformElement,CVBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableElement],CVShapeElement),CVShapeElement.prototype.initElement=RenderableDOMElement.prototype.initElement,CVShapeElement.prototype.transformHelper={opacity:1,_opMdf:!1},CVShapeElement.prototype.dashResetter=[],CVShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[])},CVShapeElement.prototype.createStyleElement=function(r,a){var n={data:r,type:r.ty,preTransforms:this.transformsManager.addTransformSequence(a),transforms:[],elements:[],closed:r.hd===!0},o={};if(r.ty==="fl"||r.ty==="st"?(o.c=PropertyFactory.getProp(this,r.c,1,255,this),o.c.k||(n.co="rgb("+bmFloor(o.c.v[0])+","+bmFloor(o.c.v[1])+","+bmFloor(o.c.v[2])+")")):(r.ty==="gf"||r.ty==="gs")&&(o.s=PropertyFactory.getProp(this,r.s,1,null,this),o.e=PropertyFactory.getProp(this,r.e,1,null,this),o.h=PropertyFactory.getProp(this,r.h||{k:0},0,.01,this),o.a=PropertyFactory.getProp(this,r.a||{k:0},0,degToRads,this),o.g=new GradientProperty(this,r.g,this)),o.o=PropertyFactory.getProp(this,r.o,0,.01,this),r.ty==="st"||r.ty==="gs"){if(n.lc=lineCapEnum[r.lc||2],n.lj=lineJoinEnum[r.lj||2],r.lj==1&&(n.ml=r.ml),o.w=PropertyFactory.getProp(this,r.w,0,null,this),o.w.k||(n.wi=o.w.v),r.d){var f=new DashProperty(this,r.d,"canvas",this);o.d=f,o.d.k||(n.da=o.d.dashArray,n.do=o.d.dashoffset[0])}}else n.r=r.r===2?"evenodd":"nonzero";return this.stylesList.push(n),o.style=n,o},CVShapeElement.prototype.createGroupElement=function(){var r={it:[],prevViewData:[]};return r},CVShapeElement.prototype.createTransformElement=function(r){var a={transform:{opacity:1,_opMdf:!1,key:this.transformsManager.getNewKey(),op:PropertyFactory.getProp(this,r.o,0,.01,this),mProps:TransformPropertyFactory.getTransformProperty(this,r,this)}};return a},CVShapeElement.prototype.createShapeElement=function(r){var a=new CVShapeData(this,r,this.stylesList,this.transformsManager);return this.shapes.push(a),this.addShapeToModifiers(a),a},CVShapeElement.prototype.reloadShapes=function(){this._isFirstFrame=!0;var r,a=this.itemsData.length;for(r=0;r<a;r+=1)this.prevViewData[r]=this.itemsData[r];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[]),a=this.dynamicProperties.length,r=0;r<a;r+=1)this.dynamicProperties[r].getValue();this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame)},CVShapeElement.prototype.addTransformToStyleList=function(r){var a,n=this.stylesList.length;for(a=0;a<n;a+=1)this.stylesList[a].closed||this.stylesList[a].transforms.push(r)},CVShapeElement.prototype.removeTransformFromStyleList=function(){var r,a=this.stylesList.length;for(r=0;r<a;r+=1)this.stylesList[r].closed||this.stylesList[r].transforms.pop()},CVShapeElement.prototype.closeStyles=function(r){var a,n=r.length;for(a=0;a<n;a+=1)r[a].closed=!0},CVShapeElement.prototype.searchShapes=function(r,a,n,o,f){var y,x=r.length-1,b,_,S=[],A=[],C,P,T,M=[].concat(f);for(y=x;y>=0;y-=1){if(C=this.searchProcessedElement(r[y]),C?a[y]=n[C-1]:r[y]._shouldRender=o,r[y].ty==="fl"||r[y].ty==="st"||r[y].ty==="gf"||r[y].ty==="gs")C?a[y].style.closed=!1:a[y]=this.createStyleElement(r[y],M),S.push(a[y].style);else if(r[y].ty==="gr"){if(!C)a[y]=this.createGroupElement(r[y]);else for(_=a[y].it.length,b=0;b<_;b+=1)a[y].prevViewData[b]=a[y].it[b];this.searchShapes(r[y].it,a[y].it,a[y].prevViewData,o,M)}else r[y].ty==="tr"?(C||(T=this.createTransformElement(r[y]),a[y]=T),M.push(a[y]),this.addTransformToStyleList(a[y])):r[y].ty==="sh"||r[y].ty==="rc"||r[y].ty==="el"||r[y].ty==="sr"?C||(a[y]=this.createShapeElement(r[y])):r[y].ty==="tm"||r[y].ty==="rd"||r[y].ty==="pb"||r[y].ty==="zz"||r[y].ty==="op"?(C?(P=a[y],P.closed=!1):(P=ShapeModifiers.getModifier(r[y].ty),P.init(this,r[y]),a[y]=P,this.shapeModifiers.push(P)),A.push(P)):r[y].ty==="rp"&&(C?(P=a[y],P.closed=!0):(P=ShapeModifiers.getModifier(r[y].ty),a[y]=P,P.init(this,r,y,a),this.shapeModifiers.push(P),o=!1),A.push(P));this.addProcessedElement(r[y],y+1)}for(this.removeTransformFromStyleList(),this.closeStyles(S),x=A.length,y=0;y<x;y+=1)A[y].closed=!0},CVShapeElement.prototype.renderInnerContent=function(){this.transformHelper.opacity=1,this.transformHelper._opMdf=!1,this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame),this.renderShape(this.transformHelper,this.shapesData,this.itemsData,!0)},CVShapeElement.prototype.renderShapeTransform=function(r,a){(r._opMdf||a.op._mdf||this._isFirstFrame)&&(a.opacity=r.opacity,a.opacity*=a.op.v,a._opMdf=!0)},CVShapeElement.prototype.drawLayer=function(){var r,a=this.stylesList.length,n,o,f,y,x,b,_=this.globalData.renderer,S=this.globalData.canvasContext,A,C;for(r=0;r<a;r+=1)if(C=this.stylesList[r],A=C.type,!((A==="st"||A==="gs")&&C.wi===0||!C.data._shouldRender||C.coOp===0||this.globalData.currentGlobalAlpha===0)){for(_.save(),x=C.elements,A==="st"||A==="gs"?(_.ctxStrokeStyle(A==="st"?C.co:C.grd),_.ctxLineWidth(C.wi),_.ctxLineCap(C.lc),_.ctxLineJoin(C.lj),_.ctxMiterLimit(C.ml||0)):_.ctxFillStyle(A==="fl"?C.co:C.grd),_.ctxOpacity(C.coOp),A!=="st"&&A!=="gs"&&S.beginPath(),_.ctxTransform(C.preTransforms.finalTransform.props),o=x.length,n=0;n<o;n+=1){for((A==="st"||A==="gs")&&(S.beginPath(),C.da&&(S.setLineDash(C.da),S.lineDashOffset=C.do)),b=x[n].trNodes,y=b.length,f=0;f<y;f+=1)b[f].t==="m"?S.moveTo(b[f].p[0],b[f].p[1]):b[f].t==="c"?S.bezierCurveTo(b[f].pts[0],b[f].pts[1],b[f].pts[2],b[f].pts[3],b[f].pts[4],b[f].pts[5]):S.closePath();(A==="st"||A==="gs")&&(_.ctxStroke(),C.da&&S.setLineDash(this.dashResetter))}A!=="st"&&A!=="gs"&&this.globalData.renderer.ctxFill(C.r),_.restore()}},CVShapeElement.prototype.renderShape=function(r,a,n,o){var f,y=a.length-1,x;for(x=r,f=y;f>=0;f-=1)a[f].ty==="tr"?(x=n[f].transform,this.renderShapeTransform(r,x)):a[f].ty==="sh"||a[f].ty==="el"||a[f].ty==="rc"||a[f].ty==="sr"?this.renderPath(a[f],n[f]):a[f].ty==="fl"?this.renderFill(a[f],n[f],x):a[f].ty==="st"?this.renderStroke(a[f],n[f],x):a[f].ty==="gf"||a[f].ty==="gs"?this.renderGradientFill(a[f],n[f],x):a[f].ty==="gr"?this.renderShape(x,a[f].it,n[f].it):a[f].ty;o&&this.drawLayer()},CVShapeElement.prototype.renderStyledShape=function(r,a){if(this._isFirstFrame||a._mdf||r.transforms._mdf){var n=r.trNodes,o=a.paths,f,y,x,b=o._length;n.length=0;var _=r.transforms.finalTransform;for(x=0;x<b;x+=1){var S=o.shapes[x];if(S&&S.v){for(y=S._length,f=1;f<y;f+=1)f===1&&n.push({t:"m",p:_.applyToPointArray(S.v[0][0],S.v[0][1],0)}),n.push({t:"c",pts:_.applyToTriplePoints(S.o[f-1],S.i[f],S.v[f])});y===1&&n.push({t:"m",p:_.applyToPointArray(S.v[0][0],S.v[0][1],0)}),S.c&&y&&(n.push({t:"c",pts:_.applyToTriplePoints(S.o[f-1],S.i[0],S.v[0])}),n.push({t:"z"}))}}r.trNodes=n}},CVShapeElement.prototype.renderPath=function(r,a){if(r.hd!==!0&&r._shouldRender){var n,o=a.styledShapes.length;for(n=0;n<o;n+=1)this.renderStyledShape(a.styledShapes[n],a.sh)}},CVShapeElement.prototype.renderFill=function(r,a,n){var o=a.style;(a.c._mdf||this._isFirstFrame)&&(o.co="rgb("+bmFloor(a.c.v[0])+","+bmFloor(a.c.v[1])+","+bmFloor(a.c.v[2])+")"),(a.o._mdf||n._opMdf||this._isFirstFrame)&&(o.coOp=a.o.v*n.opacity)},CVShapeElement.prototype.renderGradientFill=function(r,a,n){var o=a.style,f;if(!o.grd||a.g._mdf||a.s._mdf||a.e._mdf||r.t!==1&&(a.h._mdf||a.a._mdf)){var y=this.globalData.canvasContext,x=a.s.v,b=a.e.v;if(r.t===1)f=y.createLinearGradient(x[0],x[1],b[0],b[1]);else{var _=Math.sqrt(Math.pow(x[0]-b[0],2)+Math.pow(x[1]-b[1],2)),S=Math.atan2(b[1]-x[1],b[0]-x[0]),A=a.h.v;A>=1?A=.99:A<=-1&&(A=-.99);var C=_*A,P=Math.cos(S+a.a.v)*C+x[0],T=Math.sin(S+a.a.v)*C+x[1];f=y.createRadialGradient(P,T,0,x[0],x[1],_)}var M,O=r.g.p,I=a.g.c,D=1;for(M=0;M<O;M+=1)a.g._hasOpacity&&a.g._collapsable&&(D=a.g.o[M*2+1]),f.addColorStop(I[M*4]/100,"rgba("+I[M*4+1]+","+I[M*4+2]+","+I[M*4+3]+","+D+")");o.grd=f}o.coOp=a.o.v*n.opacity},CVShapeElement.prototype.renderStroke=function(r,a,n){var o=a.style,f=a.d;f&&(f._mdf||this._isFirstFrame)&&(o.da=f.dashArray,o.do=f.dashoffset[0]),(a.c._mdf||this._isFirstFrame)&&(o.co="rgb("+bmFloor(a.c.v[0])+","+bmFloor(a.c.v[1])+","+bmFloor(a.c.v[2])+")"),(a.o._mdf||n._opMdf||this._isFirstFrame)&&(o.coOp=a.o.v*n.opacity),(a.w._mdf||this._isFirstFrame)&&(o.wi=a.w.v)},CVShapeElement.prototype.destroy=function(){this.shapesData=null,this.globalData=null,this.canvasContext=null,this.stylesList.length=0,this.itemsData.length=0};function CVTextElement(r,a,n){this.textSpans=[],this.yOffset=0,this.fillColorAnim=!1,this.strokeColorAnim=!1,this.strokeWidthAnim=!1,this.stroke=!1,this.fill=!1,this.justifyOffset=0,this.currentRender=null,this.renderType="canvas",this.values={fill:"rgba(0,0,0,0)",stroke:"rgba(0,0,0,0)",sWidth:0,fValue:""},this.initElement(r,a,n)}extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement,ITextElement],CVTextElement),CVTextElement.prototype.tHelper=createTag("canvas").getContext("2d"),CVTextElement.prototype.buildNewText=function(){var r=this.textProperty.currentData;this.renderedLetters=createSizedArray(r.l?r.l.length:0);var a=!1;r.fc?(a=!0,this.values.fill=this.buildColor(r.fc)):this.values.fill="rgba(0,0,0,0)",this.fill=a;var n=!1;r.sc&&(n=!0,this.values.stroke=this.buildColor(r.sc),this.values.sWidth=r.sw);var o=this.globalData.fontManager.getFontByName(r.f),f,y,x=r.l,b=this.mHelper;this.stroke=n,this.values.fValue=r.finalSize+"px "+this.globalData.fontManager.getFontByName(r.f).fFamily,y=r.finalText.length;var _,S,A,C,P,T,M,O,I,D,z=this.data.singleShape,k=r.tr*.001*r.finalSize,L=0,R=0,F=!0,B=0;for(f=0;f<y;f+=1){_=this.globalData.fontManager.getCharData(r.finalText[f],o.fStyle,this.globalData.fontManager.getFontByName(r.f).fFamily),S=_&&_.data||{},b.reset(),z&&x[f].n&&(L=-k,R+=r.yOffset,R+=F?1:0,F=!1),P=S.shapes?S.shapes[0].it:[],M=P.length,b.scale(r.finalSize/100,r.finalSize/100),z&&this.applyTextPropertiesToMatrix(r,b,x[f].line,L,R),I=createSizedArray(M-1);var N=0;for(T=0;T<M;T+=1)if(P[T].ty==="sh"){for(C=P[T].ks.k.i.length,O=P[T].ks.k,D=[],A=1;A<C;A+=1)A===1&&D.push(b.applyToX(O.v[0][0],O.v[0][1],0),b.applyToY(O.v[0][0],O.v[0][1],0)),D.push(b.applyToX(O.o[A-1][0],O.o[A-1][1],0),b.applyToY(O.o[A-1][0],O.o[A-1][1],0),b.applyToX(O.i[A][0],O.i[A][1],0),b.applyToY(O.i[A][0],O.i[A][1],0),b.applyToX(O.v[A][0],O.v[A][1],0),b.applyToY(O.v[A][0],O.v[A][1],0));D.push(b.applyToX(O.o[A-1][0],O.o[A-1][1],0),b.applyToY(O.o[A-1][0],O.o[A-1][1],0),b.applyToX(O.i[0][0],O.i[0][1],0),b.applyToY(O.i[0][0],O.i[0][1],0),b.applyToX(O.v[0][0],O.v[0][1],0),b.applyToY(O.v[0][0],O.v[0][1],0)),I[N]=D,N+=1}z&&(L+=x[f].l,L+=k),this.textSpans[B]?this.textSpans[B].elem=I:this.textSpans[B]={elem:I},B+=1}},CVTextElement.prototype.renderInnerContent=function(){this.validateText();var r=this.canvasContext;r.font=this.values.fValue,this.globalData.renderer.ctxLineCap("butt"),this.globalData.renderer.ctxLineJoin("miter"),this.globalData.renderer.ctxMiterLimit(4),this.data.singleShape||this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag);var a,n,o,f,y,x,b=this.textAnimator.renderedLetters,_=this.textProperty.currentData.l;n=_.length;var S,A=null,C=null,P=null,T,M,O=this.globalData.renderer;for(a=0;a<n;a+=1)if(!_[a].n){if(S=b[a],S&&(O.save(),O.ctxTransform(S.p),O.ctxOpacity(S.o)),this.fill){for(S&&S.fc?A!==S.fc&&(O.ctxFillStyle(S.fc),A=S.fc):A!==this.values.fill&&(A=this.values.fill,O.ctxFillStyle(this.values.fill)),T=this.textSpans[a].elem,f=T.length,this.globalData.canvasContext.beginPath(),o=0;o<f;o+=1)for(M=T[o],x=M.length,this.globalData.canvasContext.moveTo(M[0],M[1]),y=2;y<x;y+=6)this.globalData.canvasContext.bezierCurveTo(M[y],M[y+1],M[y+2],M[y+3],M[y+4],M[y+5]);this.globalData.canvasContext.closePath(),O.ctxFill()}if(this.stroke){for(S&&S.sw?P!==S.sw&&(P=S.sw,O.ctxLineWidth(S.sw)):P!==this.values.sWidth&&(P=this.values.sWidth,O.ctxLineWidth(this.values.sWidth)),S&&S.sc?C!==S.sc&&(C=S.sc,O.ctxStrokeStyle(S.sc)):C!==this.values.stroke&&(C=this.values.stroke,O.ctxStrokeStyle(this.values.stroke)),T=this.textSpans[a].elem,f=T.length,this.globalData.canvasContext.beginPath(),o=0;o<f;o+=1)for(M=T[o],x=M.length,this.globalData.canvasContext.moveTo(M[0],M[1]),y=2;y<x;y+=6)this.globalData.canvasContext.bezierCurveTo(M[y],M[y+1],M[y+2],M[y+3],M[y+4],M[y+5]);this.globalData.canvasContext.closePath(),O.ctxStroke()}S&&this.globalData.renderer.restore()}};function CVImageElement(r,a,n){this.assetData=a.getAssetData(r.refId),this.img=a.imageLoader.getAsset(this.assetData),this.initElement(r,a,n)}extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVImageElement),CVImageElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVImageElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVImageElement.prototype.createContent=function(){if(this.img.width&&(this.assetData.w!==this.img.width||this.assetData.h!==this.img.height)){var r=createTag("canvas");r.width=this.assetData.w,r.height=this.assetData.h;var a=r.getContext("2d"),n=this.img.width,o=this.img.height,f=n/o,y=this.assetData.w/this.assetData.h,x,b,_=this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio;f>y&&_==="xMidYMid slice"||f<y&&_!=="xMidYMid slice"?(b=o,x=b*y):(x=n,b=x/y),a.drawImage(this.img,(n-x)/2,(o-b)/2,x,b,0,0,this.assetData.w,this.assetData.h),this.img=r}},CVImageElement.prototype.renderInnerContent=function(){this.canvasContext.drawImage(this.img,0,0)},CVImageElement.prototype.destroy=function(){this.img=null};function CVSolidElement(r,a,n){this.initElement(r,a,n)}extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVSolidElement),CVSolidElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVSolidElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVSolidElement.prototype.renderInnerContent=function(){this.globalData.renderer.ctxFillStyle(this.data.sc),this.globalData.renderer.ctxFillRect(0,0,this.data.sw,this.data.sh)};function CanvasRendererBase(){}extendPrototype([BaseRenderer],CanvasRendererBase),CanvasRendererBase.prototype.createShape=function(r){return new CVShapeElement(r,this.globalData,this)},CanvasRendererBase.prototype.createText=function(r){return new CVTextElement(r,this.globalData,this)},CanvasRendererBase.prototype.createImage=function(r){return new CVImageElement(r,this.globalData,this)},CanvasRendererBase.prototype.createSolid=function(r){return new CVSolidElement(r,this.globalData,this)},CanvasRendererBase.prototype.createNull=SVGRenderer.prototype.createNull,CanvasRendererBase.prototype.ctxTransform=function(r){r[0]===1&&r[1]===0&&r[4]===0&&r[5]===1&&r[12]===0&&r[13]===0||this.canvasContext.transform(r[0],r[1],r[4],r[5],r[12],r[13])},CanvasRendererBase.prototype.ctxOpacity=function(r){this.canvasContext.globalAlpha*=r<0?0:r},CanvasRendererBase.prototype.ctxFillStyle=function(r){this.canvasContext.fillStyle=r},CanvasRendererBase.prototype.ctxStrokeStyle=function(r){this.canvasContext.strokeStyle=r},CanvasRendererBase.prototype.ctxLineWidth=function(r){this.canvasContext.lineWidth=r},CanvasRendererBase.prototype.ctxLineCap=function(r){this.canvasContext.lineCap=r},CanvasRendererBase.prototype.ctxLineJoin=function(r){this.canvasContext.lineJoin=r},CanvasRendererBase.prototype.ctxMiterLimit=function(r){this.canvasContext.miterLimit=r},CanvasRendererBase.prototype.ctxFill=function(r){this.canvasContext.fill(r)},CanvasRendererBase.prototype.ctxFillRect=function(r,a,n,o){this.canvasContext.fillRect(r,a,n,o)},CanvasRendererBase.prototype.ctxStroke=function(){this.canvasContext.stroke()},CanvasRendererBase.prototype.reset=function(){if(!this.renderConfig.clearCanvas){this.canvasContext.restore();return}this.contextData.reset()},CanvasRendererBase.prototype.save=function(){this.canvasContext.save()},CanvasRendererBase.prototype.restore=function(r){if(!this.renderConfig.clearCanvas){this.canvasContext.restore();return}r&&(this.globalData.blendMode="source-over"),this.contextData.restore(r)},CanvasRendererBase.prototype.configAnimation=function(r){if(this.animationItem.wrapper){this.animationItem.container=createTag("canvas");var a=this.animationItem.container.style;a.width="100%",a.height="100%";var n="0px 0px 0px";a.transformOrigin=n,a.mozTransformOrigin=n,a.webkitTransformOrigin=n,a["-webkit-transform"]=n,a.contentVisibility=this.renderConfig.contentVisibility,this.animationItem.wrapper.appendChild(this.animationItem.container),this.canvasContext=this.animationItem.container.getContext("2d"),this.renderConfig.className&&this.animationItem.container.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.animationItem.container.setAttribute("id",this.renderConfig.id)}else this.canvasContext=this.renderConfig.context;this.contextData.setContext(this.canvasContext),this.data=r,this.layers=r.layers,this.transformCanvas={w:r.w,h:r.h,sx:0,sy:0,tx:0,ty:0},this.setupGlobalData(r,document.body),this.globalData.canvasContext=this.canvasContext,this.globalData.renderer=this,this.globalData.isDashed=!1,this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.globalData.transformCanvas=this.transformCanvas,this.elements=createSizedArray(r.layers.length),this.updateContainerSize()},CanvasRendererBase.prototype.updateContainerSize=function(r,a){this.reset();var n,o;r?(n=r,o=a,this.canvasContext.canvas.width=n,this.canvasContext.canvas.height=o):(this.animationItem.wrapper&&this.animationItem.container?(n=this.animationItem.wrapper.offsetWidth,o=this.animationItem.wrapper.offsetHeight):(n=this.canvasContext.canvas.width,o=this.canvasContext.canvas.height),this.canvasContext.canvas.width=n*this.renderConfig.dpr,this.canvasContext.canvas.height=o*this.renderConfig.dpr);var f,y;if(this.renderConfig.preserveAspectRatio.indexOf("meet")!==-1||this.renderConfig.preserveAspectRatio.indexOf("slice")!==-1){var x=this.renderConfig.preserveAspectRatio.split(" "),b=x[1]||"meet",_=x[0]||"xMidYMid",S=_.substr(0,4),A=_.substr(4);f=n/o,y=this.transformCanvas.w/this.transformCanvas.h,y>f&&b==="meet"||y<f&&b==="slice"?(this.transformCanvas.sx=n/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=n/(this.transformCanvas.w/this.renderConfig.dpr)):(this.transformCanvas.sx=o/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.sy=o/(this.transformCanvas.h/this.renderConfig.dpr)),S==="xMid"&&(y<f&&b==="meet"||y>f&&b==="slice")?this.transformCanvas.tx=(n-this.transformCanvas.w*(o/this.transformCanvas.h))/2*this.renderConfig.dpr:S==="xMax"&&(y<f&&b==="meet"||y>f&&b==="slice")?this.transformCanvas.tx=(n-this.transformCanvas.w*(o/this.transformCanvas.h))*this.renderConfig.dpr:this.transformCanvas.tx=0,A==="YMid"&&(y>f&&b==="meet"||y<f&&b==="slice")?this.transformCanvas.ty=(o-this.transformCanvas.h*(n/this.transformCanvas.w))/2*this.renderConfig.dpr:A==="YMax"&&(y>f&&b==="meet"||y<f&&b==="slice")?this.transformCanvas.ty=(o-this.transformCanvas.h*(n/this.transformCanvas.w))*this.renderConfig.dpr:this.transformCanvas.ty=0}else this.renderConfig.preserveAspectRatio==="none"?(this.transformCanvas.sx=n/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=o/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.tx=0,this.transformCanvas.ty=0):(this.transformCanvas.sx=this.renderConfig.dpr,this.transformCanvas.sy=this.renderConfig.dpr,this.transformCanvas.tx=0,this.transformCanvas.ty=0);this.transformCanvas.props=[this.transformCanvas.sx,0,0,0,0,this.transformCanvas.sy,0,0,0,0,1,0,this.transformCanvas.tx,this.transformCanvas.ty,0,1],this.ctxTransform(this.transformCanvas.props),this.canvasContext.beginPath(),this.canvasContext.rect(0,0,this.transformCanvas.w,this.transformCanvas.h),this.canvasContext.closePath(),this.canvasContext.clip(),this.renderFrame(this.renderedFrame,!0)},CanvasRendererBase.prototype.destroy=function(){this.renderConfig.clearCanvas&&this.animationItem.wrapper&&(this.animationItem.wrapper.innerText="");var r,a=this.layers?this.layers.length:0;for(r=a-1;r>=0;r-=1)this.elements[r]&&this.elements[r].destroy&&this.elements[r].destroy();this.elements.length=0,this.globalData.canvasContext=null,this.animationItem.container=null,this.destroyed=!0},CanvasRendererBase.prototype.renderFrame=function(r,a){if(!(this.renderedFrame===r&&this.renderConfig.clearCanvas===!0&&!a||this.destroyed||r===-1)){this.renderedFrame=r,this.globalData.frameNum=r-this.animationItem._isFirstFrame,this.globalData.frameId+=1,this.globalData._mdf=!this.renderConfig.clearCanvas||a,this.globalData.projectInterface.currentFrame=r;var n,o=this.layers.length;for(this.completeLayers||this.checkLayers(r),n=o-1;n>=0;n-=1)(this.completeLayers||this.elements[n])&&this.elements[n].prepareFrame(r-this.layers[n].st);if(this.globalData._mdf){for(this.renderConfig.clearCanvas===!0?this.canvasContext.clearRect(0,0,this.transformCanvas.w,this.transformCanvas.h):this.save(),n=o-1;n>=0;n-=1)(this.completeLayers||this.elements[n])&&this.elements[n].renderFrame();this.renderConfig.clearCanvas!==!0&&this.restore()}}},CanvasRendererBase.prototype.buildItem=function(r){var a=this.elements;if(!(a[r]||this.layers[r].ty===99)){var n=this.createItem(this.layers[r],this,this.globalData);a[r]=n,n.initExpressions()}},CanvasRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var r=this.pendingElements.pop();r.checkParenting()}},CanvasRendererBase.prototype.hide=function(){this.animationItem.container.style.display="none"},CanvasRendererBase.prototype.show=function(){this.animationItem.container.style.display="block"};function CanvasContext(){this.opacity=-1,this.transform=createTypedArray("float32",16),this.fillStyle="",this.strokeStyle="",this.lineWidth="",this.lineCap="",this.lineJoin="",this.miterLimit="",this.id=Math.random()}function CVContextData(){this.stack=[],this.cArrPos=0,this.cTr=new Matrix;var r,a=15;for(r=0;r<a;r+=1){var n=new CanvasContext;this.stack[r]=n}this._length=a,this.nativeContext=null,this.transformMat=new Matrix,this.currentOpacity=1,this.currentFillStyle="",this.appliedFillStyle="",this.currentStrokeStyle="",this.appliedStrokeStyle="",this.currentLineWidth="",this.appliedLineWidth="",this.currentLineCap="",this.appliedLineCap="",this.currentLineJoin="",this.appliedLineJoin="",this.appliedMiterLimit="",this.currentMiterLimit=""}CVContextData.prototype.duplicate=function(){var r=this._length*2,a=0;for(a=this._length;a<r;a+=1)this.stack[a]=new CanvasContext;this._length=r},CVContextData.prototype.reset=function(){this.cArrPos=0,this.cTr.reset(),this.stack[this.cArrPos].opacity=1},CVContextData.prototype.restore=function(r){this.cArrPos-=1;var a=this.stack[this.cArrPos],n=a.transform,o,f=this.cTr.props;for(o=0;o<16;o+=1)f[o]=n[o];if(r){this.nativeContext.restore();var y=this.stack[this.cArrPos+1];this.appliedFillStyle=y.fillStyle,this.appliedStrokeStyle=y.strokeStyle,this.appliedLineWidth=y.lineWidth,this.appliedLineCap=y.lineCap,this.appliedLineJoin=y.lineJoin,this.appliedMiterLimit=y.miterLimit}this.nativeContext.setTransform(n[0],n[1],n[4],n[5],n[12],n[13]),(r||a.opacity!==-1&&this.currentOpacity!==a.opacity)&&(this.nativeContext.globalAlpha=a.opacity,this.currentOpacity=a.opacity),this.currentFillStyle=a.fillStyle,this.currentStrokeStyle=a.strokeStyle,this.currentLineWidth=a.lineWidth,this.currentLineCap=a.lineCap,this.currentLineJoin=a.lineJoin,this.currentMiterLimit=a.miterLimit},CVContextData.prototype.save=function(r){r&&this.nativeContext.save();var a=this.cTr.props;this._length<=this.cArrPos&&this.duplicate();var n=this.stack[this.cArrPos],o;for(o=0;o<16;o+=1)n.transform[o]=a[o];this.cArrPos+=1;var f=this.stack[this.cArrPos];f.opacity=n.opacity,f.fillStyle=n.fillStyle,f.strokeStyle=n.strokeStyle,f.lineWidth=n.lineWidth,f.lineCap=n.lineCap,f.lineJoin=n.lineJoin,f.miterLimit=n.miterLimit},CVContextData.prototype.setOpacity=function(r){this.stack[this.cArrPos].opacity=r},CVContextData.prototype.setContext=function(r){this.nativeContext=r},CVContextData.prototype.fillStyle=function(r){this.stack[this.cArrPos].fillStyle!==r&&(this.currentFillStyle=r,this.stack[this.cArrPos].fillStyle=r)},CVContextData.prototype.strokeStyle=function(r){this.stack[this.cArrPos].strokeStyle!==r&&(this.currentStrokeStyle=r,this.stack[this.cArrPos].strokeStyle=r)},CVContextData.prototype.lineWidth=function(r){this.stack[this.cArrPos].lineWidth!==r&&(this.currentLineWidth=r,this.stack[this.cArrPos].lineWidth=r)},CVContextData.prototype.lineCap=function(r){this.stack[this.cArrPos].lineCap!==r&&(this.currentLineCap=r,this.stack[this.cArrPos].lineCap=r)},CVContextData.prototype.lineJoin=function(r){this.stack[this.cArrPos].lineJoin!==r&&(this.currentLineJoin=r,this.stack[this.cArrPos].lineJoin=r)},CVContextData.prototype.miterLimit=function(r){this.stack[this.cArrPos].miterLimit!==r&&(this.currentMiterLimit=r,this.stack[this.cArrPos].miterLimit=r)},CVContextData.prototype.transform=function(r){this.transformMat.cloneFromProps(r);var a=this.cTr;this.transformMat.multiply(a),a.cloneFromProps(this.transformMat.props);var n=a.props;this.nativeContext.setTransform(n[0],n[1],n[4],n[5],n[12],n[13])},CVContextData.prototype.opacity=function(r){var a=this.stack[this.cArrPos].opacity;a*=r<0?0:r,this.stack[this.cArrPos].opacity!==a&&(this.currentOpacity!==r&&(this.nativeContext.globalAlpha=r,this.currentOpacity=r),this.stack[this.cArrPos].opacity=a)},CVContextData.prototype.fill=function(r){this.appliedFillStyle!==this.currentFillStyle&&(this.appliedFillStyle=this.currentFillStyle,this.nativeContext.fillStyle=this.appliedFillStyle),this.nativeContext.fill(r)},CVContextData.prototype.fillRect=function(r,a,n,o){this.appliedFillStyle!==this.currentFillStyle&&(this.appliedFillStyle=this.currentFillStyle,this.nativeContext.fillStyle=this.appliedFillStyle),this.nativeContext.fillRect(r,a,n,o)},CVContextData.prototype.stroke=function(){this.appliedStrokeStyle!==this.currentStrokeStyle&&(this.appliedStrokeStyle=this.currentStrokeStyle,this.nativeContext.strokeStyle=this.appliedStrokeStyle),this.appliedLineWidth!==this.currentLineWidth&&(this.appliedLineWidth=this.currentLineWidth,this.nativeContext.lineWidth=this.appliedLineWidth),this.appliedLineCap!==this.currentLineCap&&(this.appliedLineCap=this.currentLineCap,this.nativeContext.lineCap=this.appliedLineCap),this.appliedLineJoin!==this.currentLineJoin&&(this.appliedLineJoin=this.currentLineJoin,this.nativeContext.lineJoin=this.appliedLineJoin),this.appliedMiterLimit!==this.currentMiterLimit&&(this.appliedMiterLimit=this.currentMiterLimit,this.nativeContext.miterLimit=this.appliedMiterLimit),this.nativeContext.stroke()};function CVCompElement(r,a,n){this.completeLayers=!1,this.layers=r.layers,this.pendingElements=[],this.elements=createSizedArray(this.layers.length),this.initElement(r,a,n),this.tm=r.tm?PropertyFactory.getProp(this,r.tm,0,a.frameRate,this):{_placeholder:!0}}extendPrototype([CanvasRendererBase,ICompElement,CVBaseElement],CVCompElement),CVCompElement.prototype.renderInnerContent=function(){var r=this.canvasContext;r.beginPath(),r.moveTo(0,0),r.lineTo(this.data.w,0),r.lineTo(this.data.w,this.data.h),r.lineTo(0,this.data.h),r.lineTo(0,0),r.clip();var a,n=this.layers.length;for(a=n-1;a>=0;a-=1)(this.completeLayers||this.elements[a])&&this.elements[a].renderFrame()},CVCompElement.prototype.destroy=function(){var r,a=this.layers.length;for(r=a-1;r>=0;r-=1)this.elements[r]&&this.elements[r].destroy();this.layers=null,this.elements=null},CVCompElement.prototype.createComp=function(r){return new CVCompElement(r,this.globalData,this)};function CanvasRenderer(r,a){this.animationItem=r,this.renderConfig={clearCanvas:a&&a.clearCanvas!==void 0?a.clearCanvas:!0,context:a&&a.context||null,progressiveLoad:a&&a.progressiveLoad||!1,preserveAspectRatio:a&&a.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:a&&a.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:a&&a.contentVisibility||"visible",className:a&&a.className||"",id:a&&a.id||"",runExpressions:!a||a.runExpressions===void 0||a.runExpressions},this.renderConfig.dpr=a&&a.dpr||1,this.animationItem.wrapper&&(this.renderConfig.dpr=a&&a.dpr||window.devicePixelRatio||1),this.renderedFrame=-1,this.globalData={frameNum:-1,_mdf:!1,renderConfig:this.renderConfig,currentGlobalAlpha:-1},this.contextData=new CVContextData,this.elements=[],this.pendingElements=[],this.transformMat=new Matrix,this.completeLayers=!1,this.rendererType="canvas",this.renderConfig.clearCanvas&&(this.ctxTransform=this.contextData.transform.bind(this.contextData),this.ctxOpacity=this.contextData.opacity.bind(this.contextData),this.ctxFillStyle=this.contextData.fillStyle.bind(this.contextData),this.ctxStrokeStyle=this.contextData.strokeStyle.bind(this.contextData),this.ctxLineWidth=this.contextData.lineWidth.bind(this.contextData),this.ctxLineCap=this.contextData.lineCap.bind(this.contextData),this.ctxLineJoin=this.contextData.lineJoin.bind(this.contextData),this.ctxMiterLimit=this.contextData.miterLimit.bind(this.contextData),this.ctxFill=this.contextData.fill.bind(this.contextData),this.ctxFillRect=this.contextData.fillRect.bind(this.contextData),this.ctxStroke=this.contextData.stroke.bind(this.contextData),this.save=this.contextData.save.bind(this.contextData))}extendPrototype([CanvasRendererBase],CanvasRenderer),CanvasRenderer.prototype.createComp=function(r){return new CVCompElement(r,this.globalData,this)};function HBaseElement(){}HBaseElement.prototype={checkBlendMode:function(){},initRendererElement:function(){this.baseElement=createTag(this.data.tg||"div"),this.data.hasMask?(this.svgElement=createNS("svg"),this.layerElement=createNS("g"),this.maskedElement=this.layerElement,this.svgElement.appendChild(this.layerElement),this.baseElement.appendChild(this.svgElement)):this.layerElement=this.baseElement,styleDiv(this.baseElement)},createContainerElements:function(){this.renderableEffectsManager=new CVEffects(this),this.transformedElement=this.baseElement,this.maskedElement=this.layerElement,this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),this.data.bm!==0&&this.setBlendMode()},renderElement:function(){var a=this.transformedElement?this.transformedElement.style:{};if(this.finalTransform._matMdf){var n=this.finalTransform.mat.toCSS();a.transform=n,a.webkitTransform=n}this.finalTransform._opMdf&&(a.opacity=this.finalTransform.mProp.o.v)},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},destroy:function(){this.layerElement=null,this.transformedElement=null,this.matteElement&&(this.matteElement=null),this.maskManager&&(this.maskManager.destroy(),this.maskManager=null)},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData)},addEffects:function(){},setMatte:function(){}},HBaseElement.prototype.getBaseElement=SVGBaseElement.prototype.getBaseElement,HBaseElement.prototype.destroyBaseElement=HBaseElement.prototype.destroy,HBaseElement.prototype.buildElementParenting=BaseRenderer.prototype.buildElementParenting;function HSolidElement(r,a,n){this.initElement(r,a,n)}extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],HSolidElement),HSolidElement.prototype.createContent=function(){var r;this.data.hasMask?(r=createNS("rect"),r.setAttribute("width",this.data.sw),r.setAttribute("height",this.data.sh),r.setAttribute("fill",this.data.sc),this.svgElement.setAttribute("width",this.data.sw),this.svgElement.setAttribute("height",this.data.sh)):(r=createTag("div"),r.style.width=this.data.sw+"px",r.style.height=this.data.sh+"px",r.style.backgroundColor=this.data.sc),this.layerElement.appendChild(r)};function HShapeElement(r,a,n){this.shapes=[],this.shapesData=r.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.shapesContainer=createNS("g"),this.initElement(r,a,n),this.prevViewData=[],this.currentBBox={x:999999,y:-999999,h:0,w:0}}extendPrototype([BaseElement,TransformElement,HSolidElement,SVGShapeElement,HBaseElement,HierarchyElement,FrameElement,RenderableElement],HShapeElement),HShapeElement.prototype._renderShapeFrame=HShapeElement.prototype.renderInnerContent,HShapeElement.prototype.createContent=function(){var r;if(this.baseElement.style.fontSize=0,this.data.hasMask)this.layerElement.appendChild(this.shapesContainer),r=this.svgElement;else{r=createNS("svg");var a=this.comp.data?this.comp.data:this.globalData.compSize;r.setAttribute("width",a.w),r.setAttribute("height",a.h),r.appendChild(this.shapesContainer),this.layerElement.appendChild(r)}this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.shapesContainer,0,[],!0),this.filterUniqueShapes(),this.shapeCont=r},HShapeElement.prototype.getTransformedPoint=function(r,a){var n,o=r.length;for(n=0;n<o;n+=1)a=r[n].mProps.v.applyToPointArray(a[0],a[1],0);return a},HShapeElement.prototype.calculateShapeBoundingBox=function(r,a){var n=r.sh.v,o=r.transformers,f,y=n._length,x,b,_,S;if(!(y<=1)){for(f=0;f<y-1;f+=1)x=this.getTransformedPoint(o,n.v[f]),b=this.getTransformedPoint(o,n.o[f]),_=this.getTransformedPoint(o,n.i[f+1]),S=this.getTransformedPoint(o,n.v[f+1]),this.checkBounds(x,b,_,S,a);n.c&&(x=this.getTransformedPoint(o,n.v[f]),b=this.getTransformedPoint(o,n.o[f]),_=this.getTransformedPoint(o,n.i[0]),S=this.getTransformedPoint(o,n.v[0]),this.checkBounds(x,b,_,S,a))}},HShapeElement.prototype.checkBounds=function(r,a,n,o,f){this.getBoundsOfCurve(r,a,n,o);var y=this.shapeBoundingBox;f.x=bmMin(y.left,f.x),f.xMax=bmMax(y.right,f.xMax),f.y=bmMin(y.top,f.y),f.yMax=bmMax(y.bottom,f.yMax)},HShapeElement.prototype.shapeBoundingBox={left:0,right:0,top:0,bottom:0},HShapeElement.prototype.tempBoundingBox={x:0,xMax:0,y:0,yMax:0,width:0,height:0},HShapeElement.prototype.getBoundsOfCurve=function(r,a,n,o){for(var f=[[r[0],o[0]],[r[1],o[1]]],y,x,b,_,S,A,C,P=0;P<2;++P)x=6*r[P]-12*a[P]+6*n[P],y=-3*r[P]+9*a[P]-9*n[P]+3*o[P],b=3*a[P]-3*r[P],x|=0,y|=0,b|=0,y===0&&x===0||(y===0?(_=-b/x,_>0&&_<1&&f[P].push(this.calculateF(_,r,a,n,o,P))):(S=x*x-4*b*y,S>=0&&(A=(-x+bmSqrt(S))/(2*y),A>0&&A<1&&f[P].push(this.calculateF(A,r,a,n,o,P)),C=(-x-bmSqrt(S))/(2*y),C>0&&C<1&&f[P].push(this.calculateF(C,r,a,n,o,P)))));this.shapeBoundingBox.left=bmMin.apply(null,f[0]),this.shapeBoundingBox.top=bmMin.apply(null,f[1]),this.shapeBoundingBox.right=bmMax.apply(null,f[0]),this.shapeBoundingBox.bottom=bmMax.apply(null,f[1])},HShapeElement.prototype.calculateF=function(r,a,n,o,f,y){return bmPow(1-r,3)*a[y]+3*bmPow(1-r,2)*r*n[y]+3*(1-r)*bmPow(r,2)*o[y]+bmPow(r,3)*f[y]},HShapeElement.prototype.calculateBoundingBox=function(r,a){var n,o=r.length;for(n=0;n<o;n+=1)r[n]&&r[n].sh?this.calculateShapeBoundingBox(r[n],a):r[n]&&r[n].it?this.calculateBoundingBox(r[n].it,a):r[n]&&r[n].style&&r[n].w&&this.expandStrokeBoundingBox(r[n].w,a)},HShapeElement.prototype.expandStrokeBoundingBox=function(r,a){var n=0;if(r.keyframes){for(var o=0;o<r.keyframes.length;o+=1){var f=r.keyframes[o].s;f>n&&(n=f)}n*=r.mult}else n=r.v*r.mult;a.x-=n,a.xMax+=n,a.y-=n,a.yMax+=n},HShapeElement.prototype.currentBoxContains=function(r){return this.currentBBox.x<=r.x&&this.currentBBox.y<=r.y&&this.currentBBox.width+this.currentBBox.x>=r.x+r.width&&this.currentBBox.height+this.currentBBox.y>=r.y+r.height},HShapeElement.prototype.renderInnerContent=function(){if(this._renderShapeFrame(),!this.hidden&&(this._isFirstFrame||this._mdf)){var r=this.tempBoundingBox,a=999999;if(r.x=a,r.xMax=-a,r.y=a,r.yMax=-a,this.calculateBoundingBox(this.itemsData,r),r.width=r.xMax<r.x?0:r.xMax-r.x,r.height=r.yMax<r.y?0:r.yMax-r.y,this.currentBoxContains(r))return;var n=!1;if(this.currentBBox.w!==r.width&&(this.currentBBox.w=r.width,this.shapeCont.setAttribute("width",r.width),n=!0),this.currentBBox.h!==r.height&&(this.currentBBox.h=r.height,this.shapeCont.setAttribute("height",r.height),n=!0),n||this.currentBBox.x!==r.x||this.currentBBox.y!==r.y){this.currentBBox.w=r.width,this.currentBBox.h=r.height,this.currentBBox.x=r.x,this.currentBBox.y=r.y,this.shapeCont.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h);var o=this.shapeCont.style,f="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";o.transform=f,o.webkitTransform=f}}};function HTextElement(r,a,n){this.textSpans=[],this.textPaths=[],this.currentBBox={x:999999,y:-999999,h:0,w:0},this.renderType="svg",this.isMasked=!1,this.initElement(r,a,n)}extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],HTextElement),HTextElement.prototype.createContent=function(){if(this.isMasked=this.checkMasks(),this.isMasked){this.renderType="svg",this.compW=this.comp.data.w,this.compH=this.comp.data.h,this.svgElement.setAttribute("width",this.compW),this.svgElement.setAttribute("height",this.compH);var r=createNS("g");this.maskedElement.appendChild(r),this.innerElem=r}else this.renderType="html",this.innerElem=this.layerElement;this.checkParenting()},HTextElement.prototype.buildNewText=function(){var r=this.textProperty.currentData;this.renderedLetters=createSizedArray(r.l?r.l.length:0);var a=this.innerElem.style,n=r.fc?this.buildColor(r.fc):"rgba(0,0,0,0)";a.fill=n,a.color=n,r.sc&&(a.stroke=this.buildColor(r.sc),a.strokeWidth=r.sw+"px");var o=this.globalData.fontManager.getFontByName(r.f);if(!this.globalData.fontManager.chars)if(a.fontSize=r.finalSize+"px",a.lineHeight=r.finalSize+"px",o.fClass)this.innerElem.className=o.fClass;else{a.fontFamily=o.fFamily;var f=r.fWeight,y=r.fStyle;a.fontStyle=y,a.fontWeight=f}var x,b,_=r.l;b=_.length;var S,A,C,P=this.mHelper,T,M="",O=0;for(x=0;x<b;x+=1){if(this.globalData.fontManager.chars?(this.textPaths[O]?S=this.textPaths[O]:(S=createNS("path"),S.setAttribute("stroke-linecap",lineCapEnum[1]),S.setAttribute("stroke-linejoin",lineJoinEnum[2]),S.setAttribute("stroke-miterlimit","4")),this.isMasked||(this.textSpans[O]?(A=this.textSpans[O],C=A.children[0]):(A=createTag("div"),A.style.lineHeight=0,C=createNS("svg"),C.appendChild(S),styleDiv(A)))):this.isMasked?S=this.textPaths[O]?this.textPaths[O]:createNS("text"):this.textSpans[O]?(A=this.textSpans[O],S=this.textPaths[O]):(A=createTag("span"),styleDiv(A),S=createTag("span"),styleDiv(S),A.appendChild(S)),this.globalData.fontManager.chars){var I=this.globalData.fontManager.getCharData(r.finalText[x],o.fStyle,this.globalData.fontManager.getFontByName(r.f).fFamily),D;if(I?D=I.data:D=null,P.reset(),D&&D.shapes&&D.shapes.length&&(T=D.shapes[0].it,P.scale(r.finalSize/100,r.finalSize/100),M=this.createPathShape(P,T),S.setAttribute("d",M)),this.isMasked)this.innerElem.appendChild(S);else{if(this.innerElem.appendChild(A),D&&D.shapes){document.body.appendChild(C);var z=C.getBBox();C.setAttribute("width",z.width+2),C.setAttribute("height",z.height+2),C.setAttribute("viewBox",z.x-1+" "+(z.y-1)+" "+(z.width+2)+" "+(z.height+2));var k=C.style,L="translate("+(z.x-1)+"px,"+(z.y-1)+"px)";k.transform=L,k.webkitTransform=L,_[x].yOffset=z.y-1}else C.setAttribute("width",1),C.setAttribute("height",1);A.appendChild(C)}}else if(S.textContent=_[x].val,S.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),this.isMasked)this.innerElem.appendChild(S);else{this.innerElem.appendChild(A);var R=S.style,F="translate3d(0,"+-r.finalSize/1.2+"px,0)";R.transform=F,R.webkitTransform=F}this.isMasked?this.textSpans[O]=S:this.textSpans[O]=A,this.textSpans[O].style.display="block",this.textPaths[O]=S,O+=1}for(;O<this.textSpans.length;)this.textSpans[O].style.display="none",O+=1},HTextElement.prototype.renderInnerContent=function(){this.validateText();var r;if(this.data.singleShape){if(!this._isFirstFrame&&!this.lettersChangedFlag)return;if(this.isMasked&&this.finalTransform._matMdf){this.svgElement.setAttribute("viewBox",-this.finalTransform.mProp.p.v[0]+" "+-this.finalTransform.mProp.p.v[1]+" "+this.compW+" "+this.compH),r=this.svgElement.style;var a="translate("+-this.finalTransform.mProp.p.v[0]+"px,"+-this.finalTransform.mProp.p.v[1]+"px)";r.transform=a,r.webkitTransform=a}}if(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),!(!this.lettersChangedFlag&&!this.textAnimator.lettersChangedFlag)){var n,o,f=0,y=this.textAnimator.renderedLetters,x=this.textProperty.currentData.l;o=x.length;var b,_,S;for(n=0;n<o;n+=1)x[n].n?f+=1:(_=this.textSpans[n],S=this.textPaths[n],b=y[f],f+=1,b._mdf.m&&(this.isMasked?_.setAttribute("transform",b.m):(_.style.webkitTransform=b.m,_.style.transform=b.m)),_.style.opacity=b.o,b.sw&&b._mdf.sw&&S.setAttribute("stroke-width",b.sw),b.sc&&b._mdf.sc&&S.setAttribute("stroke",b.sc),b.fc&&b._mdf.fc&&(S.setAttribute("fill",b.fc),S.style.color=b.fc));if(this.innerElem.getBBox&&!this.hidden&&(this._isFirstFrame||this._mdf)){var A=this.innerElem.getBBox();this.currentBBox.w!==A.width&&(this.currentBBox.w=A.width,this.svgElement.setAttribute("width",A.width)),this.currentBBox.h!==A.height&&(this.currentBBox.h=A.height,this.svgElement.setAttribute("height",A.height));var C=1;if(this.currentBBox.w!==A.width+C*2||this.currentBBox.h!==A.height+C*2||this.currentBBox.x!==A.x-C||this.currentBBox.y!==A.y-C){this.currentBBox.w=A.width+C*2,this.currentBBox.h=A.height+C*2,this.currentBBox.x=A.x-C,this.currentBBox.y=A.y-C,this.svgElement.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h),r=this.svgElement.style;var P="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";r.transform=P,r.webkitTransform=P}}}};function HCameraElement(r,a,n){this.initFrame(),this.initBaseData(r,a,n),this.initHierarchy();var o=PropertyFactory.getProp;if(this.pe=o(this,r.pe,0,0,this),r.ks.p.s?(this.px=o(this,r.ks.p.x,1,0,this),this.py=o(this,r.ks.p.y,1,0,this),this.pz=o(this,r.ks.p.z,1,0,this)):this.p=o(this,r.ks.p,1,0,this),r.ks.a&&(this.a=o(this,r.ks.a,1,0,this)),r.ks.or.k.length&&r.ks.or.k[0].to){var f,y=r.ks.or.k.length;for(f=0;f<y;f+=1)r.ks.or.k[f].to=null,r.ks.or.k[f].ti=null}this.or=o(this,r.ks.or,1,degToRads,this),this.or.sh=!0,this.rx=o(this,r.ks.rx,0,degToRads,this),this.ry=o(this,r.ks.ry,0,degToRads,this),this.rz=o(this,r.ks.rz,0,degToRads,this),this.mat=new Matrix,this._prevMat=new Matrix,this._isFirstFrame=!0,this.finalTransform={mProp:this}}extendPrototype([BaseElement,FrameElement,HierarchyElement],HCameraElement),HCameraElement.prototype.setup=function(){var r,a=this.comp.threeDElements.length,n,o,f;for(r=0;r<a;r+=1)if(n=this.comp.threeDElements[r],n.type==="3d"){o=n.perspectiveElem.style,f=n.container.style;var y=this.pe.v+"px",x="0px 0px 0px",b="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";o.perspective=y,o.webkitPerspective=y,f.transformOrigin=x,f.mozTransformOrigin=x,f.webkitTransformOrigin=x,o.transform=b,o.webkitTransform=b}},HCameraElement.prototype.createElements=function(){},HCameraElement.prototype.hide=function(){},HCameraElement.prototype.renderFrame=function(){var r=this._isFirstFrame,a,n;if(this.hierarchy)for(n=this.hierarchy.length,a=0;a<n;a+=1)r=this.hierarchy[a].finalTransform.mProp._mdf||r;if(r||this.pe._mdf||this.p&&this.p._mdf||this.px&&(this.px._mdf||this.py._mdf||this.pz._mdf)||this.rx._mdf||this.ry._mdf||this.rz._mdf||this.or._mdf||this.a&&this.a._mdf){if(this.mat.reset(),this.hierarchy)for(n=this.hierarchy.length-1,a=n;a>=0;a-=1){var o=this.hierarchy[a].finalTransform.mProp;this.mat.translate(-o.p.v[0],-o.p.v[1],o.p.v[2]),this.mat.rotateX(-o.or.v[0]).rotateY(-o.or.v[1]).rotateZ(o.or.v[2]),this.mat.rotateX(-o.rx.v).rotateY(-o.ry.v).rotateZ(o.rz.v),this.mat.scale(1/o.s.v[0],1/o.s.v[1],1/o.s.v[2]),this.mat.translate(o.a.v[0],o.a.v[1],o.a.v[2])}if(this.p?this.mat.translate(-this.p.v[0],-this.p.v[1],this.p.v[2]):this.mat.translate(-this.px.v,-this.py.v,this.pz.v),this.a){var f;this.p?f=[this.p.v[0]-this.a.v[0],this.p.v[1]-this.a.v[1],this.p.v[2]-this.a.v[2]]:f=[this.px.v-this.a.v[0],this.py.v-this.a.v[1],this.pz.v-this.a.v[2]];var y=Math.sqrt(Math.pow(f[0],2)+Math.pow(f[1],2)+Math.pow(f[2],2)),x=[f[0]/y,f[1]/y,f[2]/y],b=Math.sqrt(x[2]*x[2]+x[0]*x[0]),_=Math.atan2(x[1],b),S=Math.atan2(x[0],-x[2]);this.mat.rotateY(S).rotateX(-_)}this.mat.rotateX(-this.rx.v).rotateY(-this.ry.v).rotateZ(this.rz.v),this.mat.rotateX(-this.or.v[0]).rotateY(-this.or.v[1]).rotateZ(this.or.v[2]),this.mat.translate(this.globalData.compSize.w/2,this.globalData.compSize.h/2,0),this.mat.translate(0,0,this.pe.v);var A=!this._prevMat.equals(this.mat);if((A||this.pe._mdf)&&this.comp.threeDElements){n=this.comp.threeDElements.length;var C,P,T;for(a=0;a<n;a+=1)if(C=this.comp.threeDElements[a],C.type==="3d"){if(A){var M=this.mat.toCSS();T=C.container.style,T.transform=M,T.webkitTransform=M}this.pe._mdf&&(P=C.perspectiveElem.style,P.perspective=this.pe.v+"px",P.webkitPerspective=this.pe.v+"px")}this.mat.clone(this._prevMat)}}this._isFirstFrame=!1},HCameraElement.prototype.prepareFrame=function(r){this.prepareProperties(r,!0)},HCameraElement.prototype.destroy=function(){},HCameraElement.prototype.getBaseElement=function(){return null};function HImageElement(r,a,n){this.assetData=a.getAssetData(r.refId),this.initElement(r,a,n)}extendPrototype([BaseElement,TransformElement,HBaseElement,HSolidElement,HierarchyElement,FrameElement,RenderableElement],HImageElement),HImageElement.prototype.createContent=function(){var r=this.globalData.getAssetsPath(this.assetData),a=new Image;this.data.hasMask?(this.imageElem=createNS("image"),this.imageElem.setAttribute("width",this.assetData.w+"px"),this.imageElem.setAttribute("height",this.assetData.h+"px"),this.imageElem.setAttributeNS("http://www.w3.org/1999/xlink","href",r),this.layerElement.appendChild(this.imageElem),this.baseElement.setAttribute("width",this.assetData.w),this.baseElement.setAttribute("height",this.assetData.h)):this.layerElement.appendChild(a),a.crossOrigin="anonymous",a.src=r,this.data.ln&&this.baseElement.setAttribute("id",this.data.ln)};function HybridRendererBase(r,a){this.animationItem=r,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:a&&a.className||"",imagePreserveAspectRatio:a&&a.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(a&&a.hideOnTransparent===!1),filterSize:{width:a&&a.filterSize&&a.filterSize.width||"400%",height:a&&a.filterSize&&a.filterSize.height||"400%",x:a&&a.filterSize&&a.filterSize.x||"-100%",y:a&&a.filterSize&&a.filterSize.y||"-100%"}},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html"}extendPrototype([BaseRenderer],HybridRendererBase),HybridRendererBase.prototype.buildItem=SVGRenderer.prototype.buildItem,HybridRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var r=this.pendingElements.pop();r.checkParenting()}},HybridRendererBase.prototype.appendElementInPos=function(r,a){var n=r.getBaseElement();if(n){var o=this.layers[a];if(!o.ddd||!this.supports3d)if(this.threeDElements)this.addTo3dContainer(n,a);else{for(var f=0,y,x,b;f<a;)this.elements[f]&&this.elements[f]!==!0&&this.elements[f].getBaseElement&&(x=this.elements[f],b=this.layers[f].ddd?this.getThreeDContainerByPos(f):x.getBaseElement(),y=b||y),f+=1;y?(!o.ddd||!this.supports3d)&&this.layerElement.insertBefore(n,y):(!o.ddd||!this.supports3d)&&this.layerElement.appendChild(n)}else this.addTo3dContainer(n,a)}},HybridRendererBase.prototype.createShape=function(r){return this.supports3d?new HShapeElement(r,this.globalData,this):new SVGShapeElement(r,this.globalData,this)},HybridRendererBase.prototype.createText=function(r){return this.supports3d?new HTextElement(r,this.globalData,this):new SVGTextLottieElement(r,this.globalData,this)},HybridRendererBase.prototype.createCamera=function(r){return this.camera=new HCameraElement(r,this.globalData,this),this.camera},HybridRendererBase.prototype.createImage=function(r){return this.supports3d?new HImageElement(r,this.globalData,this):new IImageElement(r,this.globalData,this)},HybridRendererBase.prototype.createSolid=function(r){return this.supports3d?new HSolidElement(r,this.globalData,this):new ISolidElement(r,this.globalData,this)},HybridRendererBase.prototype.createNull=SVGRenderer.prototype.createNull,HybridRendererBase.prototype.getThreeDContainerByPos=function(r){for(var a=0,n=this.threeDElements.length;a<n;){if(this.threeDElements[a].startPos<=r&&this.threeDElements[a].endPos>=r)return this.threeDElements[a].perspectiveElem;a+=1}return null},HybridRendererBase.prototype.createThreeDContainer=function(r,a){var n=createTag("div"),o,f;styleDiv(n);var y=createTag("div");if(styleDiv(y),a==="3d"){o=n.style,o.width=this.globalData.compSize.w+"px",o.height=this.globalData.compSize.h+"px";var x="50% 50%";o.webkitTransformOrigin=x,o.mozTransformOrigin=x,o.transformOrigin=x,f=y.style;var b="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";f.transform=b,f.webkitTransform=b}n.appendChild(y);var _={container:y,perspectiveElem:n,startPos:r,endPos:r,type:a};return this.threeDElements.push(_),_},HybridRendererBase.prototype.build3dContainers=function(){var r,a=this.layers.length,n,o="";for(r=0;r<a;r+=1)this.layers[r].ddd&&this.layers[r].ty!==3?(o!=="3d"&&(o="3d",n=this.createThreeDContainer(r,"3d")),n.endPos=Math.max(n.endPos,r)):(o!=="2d"&&(o="2d",n=this.createThreeDContainer(r,"2d")),n.endPos=Math.max(n.endPos,r));for(a=this.threeDElements.length,r=a-1;r>=0;r-=1)this.resizerElem.appendChild(this.threeDElements[r].perspectiveElem)},HybridRendererBase.prototype.addTo3dContainer=function(r,a){for(var n=0,o=this.threeDElements.length;n<o;){if(a<=this.threeDElements[n].endPos){for(var f=this.threeDElements[n].startPos,y;f<a;)this.elements[f]&&this.elements[f].getBaseElement&&(y=this.elements[f].getBaseElement()),f+=1;y?this.threeDElements[n].container.insertBefore(r,y):this.threeDElements[n].container.appendChild(r);break}n+=1}},HybridRendererBase.prototype.configAnimation=function(r){var a=createTag("div"),n=this.animationItem.wrapper,o=a.style;o.width=r.w+"px",o.height=r.h+"px",this.resizerElem=a,styleDiv(a),o.transformStyle="flat",o.mozTransformStyle="flat",o.webkitTransformStyle="flat",this.renderConfig.className&&a.setAttribute("class",this.renderConfig.className),n.appendChild(a),o.overflow="hidden";var f=createNS("svg");f.setAttribute("width","1"),f.setAttribute("height","1"),styleDiv(f),this.resizerElem.appendChild(f);var y=createNS("defs");f.appendChild(y),this.data=r,this.setupGlobalData(r,f),this.globalData.defs=y,this.layers=r.layers,this.layerElement=this.resizerElem,this.build3dContainers(),this.updateContainerSize()},HybridRendererBase.prototype.destroy=function(){this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.animationItem.container=null,this.globalData.defs=null;var r,a=this.layers?this.layers.length:0;for(r=0;r<a;r+=1)this.elements[r]&&this.elements[r].destroy&&this.elements[r].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},HybridRendererBase.prototype.updateContainerSize=function(){var r=this.animationItem.wrapper.offsetWidth,a=this.animationItem.wrapper.offsetHeight,n=r/a,o=this.globalData.compSize.w/this.globalData.compSize.h,f,y,x,b;o>n?(f=r/this.globalData.compSize.w,y=r/this.globalData.compSize.w,x=0,b=(a-this.globalData.compSize.h*(r/this.globalData.compSize.w))/2):(f=a/this.globalData.compSize.h,y=a/this.globalData.compSize.h,x=(r-this.globalData.compSize.w*(a/this.globalData.compSize.h))/2,b=0);var _=this.resizerElem.style;_.webkitTransform="matrix3d("+f+",0,0,0,0,"+y+",0,0,0,0,1,0,"+x+","+b+",0,1)",_.transform=_.webkitTransform},HybridRendererBase.prototype.renderFrame=SVGRenderer.prototype.renderFrame,HybridRendererBase.prototype.hide=function(){this.resizerElem.style.display="none"},HybridRendererBase.prototype.show=function(){this.resizerElem.style.display="block"},HybridRendererBase.prototype.initItems=function(){if(this.buildAllItems(),this.camera)this.camera.setup();else{var r=this.globalData.compSize.w,a=this.globalData.compSize.h,n,o=this.threeDElements.length;for(n=0;n<o;n+=1){var f=this.threeDElements[n].perspectiveElem.style;f.webkitPerspective=Math.sqrt(Math.pow(r,2)+Math.pow(a,2))+"px",f.perspective=f.webkitPerspective}}},HybridRendererBase.prototype.searchExtraCompositions=function(r){var a,n=r.length,o=createTag("div");for(a=0;a<n;a+=1)if(r[a].xt){var f=this.createComp(r[a],o,this.globalData.comp,null);f.initExpressions(),this.globalData.projectInterface.registerComposition(f)}};function HCompElement(r,a,n){this.layers=r.layers,this.supports3d=!r.hasMask,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(r,a,n),this.tm=r.tm?PropertyFactory.getProp(this,r.tm,0,a.frameRate,this):{_placeholder:!0}}extendPrototype([HybridRendererBase,ICompElement,HBaseElement],HCompElement),HCompElement.prototype._createBaseContainerElements=HCompElement.prototype.createContainerElements,HCompElement.prototype.createContainerElements=function(){this._createBaseContainerElements(),this.data.hasMask?(this.svgElement.setAttribute("width",this.data.w),this.svgElement.setAttribute("height",this.data.h),this.transformedElement=this.baseElement):this.transformedElement=this.layerElement},HCompElement.prototype.addTo3dContainer=function(r,a){for(var n=0,o;n<a;)this.elements[n]&&this.elements[n].getBaseElement&&(o=this.elements[n].getBaseElement()),n+=1;o?this.layerElement.insertBefore(r,o):this.layerElement.appendChild(r)},HCompElement.prototype.createComp=function(r){return this.supports3d?new HCompElement(r,this.globalData,this):new SVGCompElement(r,this.globalData,this)};function HybridRenderer(r,a){this.animationItem=r,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:a&&a.className||"",imagePreserveAspectRatio:a&&a.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(a&&a.hideOnTransparent===!1),filterSize:{width:a&&a.filterSize&&a.filterSize.width||"400%",height:a&&a.filterSize&&a.filterSize.height||"400%",x:a&&a.filterSize&&a.filterSize.x||"-100%",y:a&&a.filterSize&&a.filterSize.y||"-100%"},runExpressions:!a||a.runExpressions===void 0||a.runExpressions},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html"}extendPrototype([HybridRendererBase],HybridRenderer),HybridRenderer.prototype.createComp=function(r){return this.supports3d?new HCompElement(r,this.globalData,this):new SVGCompElement(r,this.globalData,this)};var CompExpressionInterface=function(){return function(r){function a(n){for(var o=0,f=r.layers.length;o<f;){if(r.layers[o].nm===n||r.layers[o].ind===n)return r.elements[o].layerInterface;o+=1}return null}return Object.defineProperty(a,"_name",{value:r.data.nm}),a.layer=a,a.pixelAspect=1,a.height=r.data.h||r.globalData.compSize.h,a.width=r.data.w||r.globalData.compSize.w,a.pixelAspect=1,a.frameDuration=1/r.globalData.frameRate,a.displayStartTime=0,a.numLayers=r.layers.length,a}}();function _typeof$2(r){"@babel/helpers - typeof";return _typeof$2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof$2(r)}function seedRandom(r,a){var n=this,o=256,f=6,y=52,x="random",b=a.pow(o,f),_=a.pow(2,y),S=_*2,A=o-1,C;function P(k,L,R){var F=[];L=L===!0?{entropy:!0}:L||{};var B=I(O(L.entropy?[k,z(r)]:k===null?D():k,3),F),N=new T(F),j=function(){for(var Y=N.g(f),X=b,$=0;Y<_;)Y=(Y+$)*o,X*=o,$=N.g(1);for(;Y>=S;)Y/=2,X/=2,$>>>=1;return(Y+$)/X};return j.int32=function(){return N.g(4)|0},j.quick=function(){return N.g(4)/4294967296},j.double=j,I(z(N.S),r),(L.pass||R||function(G,Y,X,$){return $&&($.S&&M($,N),G.state=function(){return M(N,{})}),X?(a[x]=G,Y):G})(j,B,"global"in L?L.global:this==a,L.state)}a["seed"+x]=P;function T(k){var L,R=k.length,F=this,B=0,N=F.i=F.j=0,j=F.S=[];for(R||(k=[R++]);B<o;)j[B]=B++;for(B=0;B<o;B++)j[B]=j[N=A&N+k[B%R]+(L=j[B])],j[N]=L;F.g=function(G){for(var Y,X=0,$=F.i,te=F.j,ee=F.S;G--;)Y=ee[$=A&$+1],X=X*o+ee[A&(ee[$]=ee[te=A&te+Y])+(ee[te]=Y)];return F.i=$,F.j=te,X}}function M(k,L){return L.i=k.i,L.j=k.j,L.S=k.S.slice(),L}function O(k,L){var R=[],F=_typeof$2(k),B;if(L&&F=="object")for(B in k)try{R.push(O(k[B],L-1))}catch{}return R.length?R:F=="string"?k:k+"\0"}function I(k,L){for(var R=k+"",F,B=0;B<R.length;)L[A&B]=A&(F^=L[A&B]*19)+R.charCodeAt(B++);return z(L)}function D(){try{var k=new Uint8Array(o);return(n.crypto||n.msCrypto).getRandomValues(k),z(k)}catch{var L=n.navigator,R=L&&L.plugins;return[+new Date,n,R,n.screen,z(r)]}}function z(k){return String.fromCharCode.apply(0,k)}I(a.random(),r)}function initialize$2(r){seedRandom([],r)}var propTypes={SHAPE:"shape"};function _typeof$1(r){"@babel/helpers - typeof";return _typeof$1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof$1(r)}var ExpressionManager=function(){var ob={},Math=BMMath,window=null,document=null,XMLHttpRequest=null,fetch=null,frames=null,_lottieGlobal={};initialize$2(BMMath);function resetFrame(){_lottieGlobal={}}function $bm_isInstanceOfArray(r){return r.constructor===Array||r.constructor===Float32Array}function isNumerable(r,a){return r==="number"||a instanceof Number||r==="boolean"||r==="string"}function $bm_neg(r){var a=_typeof$1(r);if(a==="number"||r instanceof Number||a==="boolean")return-r;if($bm_isInstanceOfArray(r)){var n,o=r.length,f=[];for(n=0;n<o;n+=1)f[n]=-r[n];return f}return r.propType?r.v:-r}var easeInBez=BezierFactory.getBezierEasing(.333,0,.833,.833,"easeIn").get,easeOutBez=BezierFactory.getBezierEasing(.167,.167,.667,1,"easeOut").get,easeInOutBez=BezierFactory.getBezierEasing(.33,0,.667,1,"easeInOut").get;function sum(r,a){var n=_typeof$1(r),o=_typeof$1(a);if(isNumerable(n,r)&&isNumerable(o,a)||n==="string"||o==="string")return r+a;if($bm_isInstanceOfArray(r)&&isNumerable(o,a))return r=r.slice(0),r[0]+=a,r;if(isNumerable(n,r)&&$bm_isInstanceOfArray(a))return a=a.slice(0),a[0]=r+a[0],a;if($bm_isInstanceOfArray(r)&&$bm_isInstanceOfArray(a)){for(var f=0,y=r.length,x=a.length,b=[];f<y||f<x;)(typeof r[f]=="number"||r[f]instanceof Number)&&(typeof a[f]=="number"||a[f]instanceof Number)?b[f]=r[f]+a[f]:b[f]=a[f]===void 0?r[f]:r[f]||a[f],f+=1;return b}return 0}var add=sum;function sub(r,a){var n=_typeof$1(r),o=_typeof$1(a);if(isNumerable(n,r)&&isNumerable(o,a))return n==="string"&&(r=parseInt(r,10)),o==="string"&&(a=parseInt(a,10)),r-a;if($bm_isInstanceOfArray(r)&&isNumerable(o,a))return r=r.slice(0),r[0]-=a,r;if(isNumerable(n,r)&&$bm_isInstanceOfArray(a))return a=a.slice(0),a[0]=r-a[0],a;if($bm_isInstanceOfArray(r)&&$bm_isInstanceOfArray(a)){for(var f=0,y=r.length,x=a.length,b=[];f<y||f<x;)(typeof r[f]=="number"||r[f]instanceof Number)&&(typeof a[f]=="number"||a[f]instanceof Number)?b[f]=r[f]-a[f]:b[f]=a[f]===void 0?r[f]:r[f]||a[f],f+=1;return b}return 0}function mul(r,a){var n=_typeof$1(r),o=_typeof$1(a),f;if(isNumerable(n,r)&&isNumerable(o,a))return r*a;var y,x;if($bm_isInstanceOfArray(r)&&isNumerable(o,a)){for(x=r.length,f=createTypedArray("float32",x),y=0;y<x;y+=1)f[y]=r[y]*a;return f}if(isNumerable(n,r)&&$bm_isInstanceOfArray(a)){for(x=a.length,f=createTypedArray("float32",x),y=0;y<x;y+=1)f[y]=r*a[y];return f}return 0}function div(r,a){var n=_typeof$1(r),o=_typeof$1(a),f;if(isNumerable(n,r)&&isNumerable(o,a))return r/a;var y,x;if($bm_isInstanceOfArray(r)&&isNumerable(o,a)){for(x=r.length,f=createTypedArray("float32",x),y=0;y<x;y+=1)f[y]=r[y]/a;return f}if(isNumerable(n,r)&&$bm_isInstanceOfArray(a)){for(x=a.length,f=createTypedArray("float32",x),y=0;y<x;y+=1)f[y]=r/a[y];return f}return 0}function mod(r,a){return typeof r=="string"&&(r=parseInt(r,10)),typeof a=="string"&&(a=parseInt(a,10)),r%a}var $bm_sum=sum,$bm_sub=sub,$bm_mul=mul,$bm_div=div,$bm_mod=mod;function clamp(r,a,n){if(a>n){var o=n;n=a,a=o}return Math.min(Math.max(r,a),n)}function radiansToDegrees(r){return r/degToRads}var radians_to_degrees=radiansToDegrees;function degreesToRadians(r){return r*degToRads}var degrees_to_radians=radiansToDegrees,helperLengthArray=[0,0,0,0,0,0];function length(r,a){if(typeof r=="number"||r instanceof Number)return a=a||0,Math.abs(r-a);a||(a=helperLengthArray);var n,o=Math.min(r.length,a.length),f=0;for(n=0;n<o;n+=1)f+=Math.pow(a[n]-r[n],2);return Math.sqrt(f)}function normalize(r){return div(r,length(r))}function rgbToHsl(r){var a=r[0],n=r[1],o=r[2],f=Math.max(a,n,o),y=Math.min(a,n,o),x,b,_=(f+y)/2;if(f===y)x=0,b=0;else{var S=f-y;switch(b=_>.5?S/(2-f-y):S/(f+y),f){case a:x=(n-o)/S+(n<o?6:0);break;case n:x=(o-a)/S+2;break;case o:x=(a-n)/S+4;break}x/=6}return[x,b,_,r[3]]}function hue2rgb(r,a,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?r+(a-r)*6*n:n<1/2?a:n<2/3?r+(a-r)*(2/3-n)*6:r}function hslToRgb(r){var a=r[0],n=r[1],o=r[2],f,y,x;if(n===0)f=o,x=o,y=o;else{var b=o<.5?o*(1+n):o+n-o*n,_=2*o-b;f=hue2rgb(_,b,a+1/3),y=hue2rgb(_,b,a),x=hue2rgb(_,b,a-1/3)}return[f,y,x,r[3]]}function linear(r,a,n,o,f){if((o===void 0||f===void 0)&&(o=a,f=n,a=0,n=1),n<a){var y=n;n=a,a=y}if(r<=a)return o;if(r>=n)return f;var x=n===a?0:(r-a)/(n-a);if(!o.length)return o+(f-o)*x;var b,_=o.length,S=createTypedArray("float32",_);for(b=0;b<_;b+=1)S[b]=o[b]+(f[b]-o[b])*x;return S}function random(r,a){if(a===void 0&&(r===void 0?(r=0,a=1):(a=r,r=void 0)),a.length){var n,o=a.length;r||(r=createTypedArray("float32",o));var f=createTypedArray("float32",o),y=BMMath.random();for(n=0;n<o;n+=1)f[n]=r[n]+y*(a[n]-r[n]);return f}r===void 0&&(r=0);var x=BMMath.random();return r+x*(a-r)}function createPath(r,a,n,o){var f,y=r.length,x=shapePool.newElement();x.setPathData(!!o,y);var b=[0,0],_,S;for(f=0;f<y;f+=1)_=a&&a[f]?a[f]:b,S=n&&n[f]?n[f]:b,x.setTripleAt(r[f][0],r[f][1],S[0]+r[f][0],S[1]+r[f][1],_[0]+r[f][0],_[1]+r[f][1],f,!0);return x}function initiateExpression(elem,data,property){function noOp(r){return r}if(!elem.globalData.renderConfig.runExpressions)return noOp;var val=data.x,needsVelocity=/velocity(?![\w\d])/.test(val),_needsRandom=val.indexOf("random")!==-1,elemType=elem.data.ty,transform,$bm_transform,content,effect,thisProperty=property;thisProperty._name=elem.data.nm,thisProperty.valueAtTime=thisProperty.getValueAtTime,Object.defineProperty(thisProperty,"value",{get:function(){return thisProperty.v}}),elem.comp.frameDuration=1/elem.comp.globalData.frameRate,elem.comp.displayStartTime=0;var inPoint=elem.data.ip/elem.comp.globalData.frameRate,outPoint=elem.data.op/elem.comp.globalData.frameRate,width=elem.data.sw?elem.data.sw:0,height=elem.data.sh?elem.data.sh:0,name=elem.data.nm,loopIn,loop_in,loopOut,loop_out,smooth,toWorld,fromWorld,fromComp,toComp,fromCompToSurface,position,rotation,anchorPoint,scale,thisLayer,thisComp,mask,valueAtTime,velocityAtTime,scoped_bm_rt,expression_function=eval("[function _expression_function(){"+val+";scoped_bm_rt=$bm_rt}]")[0],numKeys=property.kf?data.k.length:0,active=!this.data||this.data.hd!==!0,wiggle=(function r(a,n){var o,f,y=this.pv.length?this.pv.length:1,x=createTypedArray("float32",y);a=5;var b=Math.floor(time*a);for(o=0,f=0;o<b;){for(f=0;f<y;f+=1)x[f]+=-n+n*2*BMMath.random();o+=1}var _=time*a,S=_-Math.floor(_),A=createTypedArray("float32",y);if(y>1){for(f=0;f<y;f+=1)A[f]=this.pv[f]+x[f]+(-n+n*2*BMMath.random())*S;return A}return this.pv+x[0]+(-n+n*2*BMMath.random())*S}).bind(this);thisProperty.loopIn&&(loopIn=thisProperty.loopIn.bind(thisProperty),loop_in=loopIn),thisProperty.loopOut&&(loopOut=thisProperty.loopOut.bind(thisProperty),loop_out=loopOut),thisProperty.smooth&&(smooth=thisProperty.smooth.bind(thisProperty));function loopInDuration(r,a){return loopIn(r,a,!0)}function loopOutDuration(r,a){return loopOut(r,a,!0)}this.getValueAtTime&&(valueAtTime=this.getValueAtTime.bind(this)),this.getVelocityAtTime&&(velocityAtTime=this.getVelocityAtTime.bind(this));var comp=elem.comp.globalData.projectInterface.bind(elem.comp.globalData.projectInterface);function lookAt(r,a){var n=[a[0]-r[0],a[1]-r[1],a[2]-r[2]],o=Math.atan2(n[0],Math.sqrt(n[1]*n[1]+n[2]*n[2]))/degToRads,f=-Math.atan2(n[1],n[2])/degToRads;return[f,o,0]}function easeOut(r,a,n,o,f){return applyEase(easeOutBez,r,a,n,o,f)}function easeIn(r,a,n,o,f){return applyEase(easeInBez,r,a,n,o,f)}function ease(r,a,n,o,f){return applyEase(easeInOutBez,r,a,n,o,f)}function applyEase(r,a,n,o,f,y){f===void 0?(f=n,y=o):a=(a-n)/(o-n),a>1?a=1:a<0&&(a=0);var x=r(a);if($bm_isInstanceOfArray(f)){var b,_=f.length,S=createTypedArray("float32",_);for(b=0;b<_;b+=1)S[b]=(y[b]-f[b])*x+f[b];return S}return(y-f)*x+f}function nearestKey(r){var a,n=data.k.length,o,f;if(!data.k.length||typeof data.k[0]=="number")o=0,f=0;else if(o=-1,r*=elem.comp.globalData.frameRate,r<data.k[0].t)o=1,f=data.k[0].t;else{for(a=0;a<n-1;a+=1)if(r===data.k[a].t){o=a+1,f=data.k[a].t;break}else if(r>data.k[a].t&&r<data.k[a+1].t){r-data.k[a].t>data.k[a+1].t-r?(o=a+2,f=data.k[a+1].t):(o=a+1,f=data.k[a].t);break}o===-1&&(o=a+1,f=data.k[a].t)}var y={};return y.index=o,y.time=f/elem.comp.globalData.frameRate,y}function key(r){var a,n,o;if(!data.k.length||typeof data.k[0]=="number")throw new Error("The property has no keyframe at index "+r);r-=1,a={time:data.k[r].t/elem.comp.globalData.frameRate,value:[]};var f=Object.prototype.hasOwnProperty.call(data.k[r],"s")?data.k[r].s:data.k[r-1].e;for(o=f.length,n=0;n<o;n+=1)a[n]=f[n],a.value[n]=f[n];return a}function framesToTime(r,a){return a||(a=elem.comp.globalData.frameRate),r/a}function timeToFrames(r,a){return!r&&r!==0&&(r=time),a||(a=elem.comp.globalData.frameRate),r*a}function seedRandom(r){BMMath.seedrandom(randSeed+r)}function sourceRectAtTime(){return elem.sourceRectAtTime()}function substring(r,a){return typeof value=="string"?a===void 0?value.substring(r):value.substring(r,a):""}function substr(r,a){return typeof value=="string"?a===void 0?value.substr(r):value.substr(r,a):""}function posterizeTime(r){time=r===0?0:Math.floor(time*r)/r,value=valueAtTime(time)}var time,velocity,value,text,textIndex,textTotal,selectorValue,index=elem.data.ind,hasParent=!!(elem.hierarchy&&elem.hierarchy.length),parent,randSeed=Math.floor(Math.random()*1e6),globalData=elem.globalData;function executeExpression(r){return value=r,this.frameExpressionId===elem.globalData.frameId&&this.propType!=="textSelector"?value:(this.propType==="textSelector"&&(textIndex=this.textIndex,textTotal=this.textTotal,selectorValue=this.selectorValue),thisLayer||(text=elem.layerInterface.text,thisLayer=elem.layerInterface,thisComp=elem.comp.compInterface,toWorld=thisLayer.toWorld.bind(thisLayer),fromWorld=thisLayer.fromWorld.bind(thisLayer),fromComp=thisLayer.fromComp.bind(thisLayer),toComp=thisLayer.toComp.bind(thisLayer),mask=thisLayer.mask?thisLayer.mask.bind(thisLayer):null,fromCompToSurface=fromComp),transform||(transform=elem.layerInterface("ADBE Transform Group"),$bm_transform=transform,transform&&(anchorPoint=transform.anchorPoint)),elemType===4&&!content&&(content=thisLayer("ADBE Root Vectors Group")),effect||(effect=thisLayer(4)),hasParent=!!(elem.hierarchy&&elem.hierarchy.length),hasParent&&!parent&&(parent=elem.hierarchy[0].layerInterface),time=this.comp.renderedFrame/this.comp.globalData.frameRate,_needsRandom&&seedRandom(randSeed+time),needsVelocity&&(velocity=velocityAtTime(time)),expression_function(),this.frameExpressionId=elem.globalData.frameId,scoped_bm_rt=scoped_bm_rt.propType===propTypes.SHAPE?scoped_bm_rt.v:scoped_bm_rt,scoped_bm_rt)}return executeExpression.__preventDeadCodeRemoval=[$bm_transform,anchorPoint,time,velocity,inPoint,outPoint,width,height,name,loop_in,loop_out,smooth,toComp,fromCompToSurface,toWorld,fromWorld,mask,position,rotation,scale,thisComp,numKeys,active,wiggle,loopInDuration,loopOutDuration,comp,lookAt,easeOut,easeIn,ease,nearestKey,key,text,textIndex,textTotal,selectorValue,framesToTime,timeToFrames,sourceRectAtTime,substring,substr,posterizeTime,index,globalData],executeExpression}return ob.initiateExpression=initiateExpression,ob.__preventDeadCodeRemoval=[window,document,XMLHttpRequest,fetch,frames,$bm_neg,add,$bm_sum,$bm_sub,$bm_mul,$bm_div,$bm_mod,clamp,radians_to_degrees,degreesToRadians,degrees_to_radians,normalize,rgbToHsl,hslToRgb,linear,random,createPath,_lottieGlobal],ob.resetFrame=resetFrame,ob}(),Expressions=function(){var r={};r.initExpressions=a,r.resetFrame=ExpressionManager.resetFrame;function a(n){var o=0,f=[];function y(){o+=1}function x(){o-=1,o===0&&_()}function b(S){f.indexOf(S)===-1&&f.push(S)}function _(){var S,A=f.length;for(S=0;S<A;S+=1)f[S].release();f.length=0}n.renderer.compInterface=CompExpressionInterface(n.renderer),n.renderer.globalData.projectInterface.registerComposition(n.renderer),n.renderer.globalData.pushExpression=y,n.renderer.globalData.popExpression=x,n.renderer.globalData.registerExpressionProperty=b}return r}(),MaskManagerInterface=function(){function r(n,o){this._mask=n,this._data=o}Object.defineProperty(r.prototype,"maskPath",{get:function(){return this._mask.prop.k&&this._mask.prop.getValue(),this._mask.prop}}),Object.defineProperty(r.prototype,"maskOpacity",{get:function(){return this._mask.op.k&&this._mask.op.getValue(),this._mask.op.v*100}});var a=function(o){var f=createSizedArray(o.viewData.length),y,x=o.viewData.length;for(y=0;y<x;y+=1)f[y]=new r(o.viewData[y],o.masksProperties[y]);var b=function(S){for(y=0;y<x;){if(o.masksProperties[y].nm===S)return f[y];y+=1}return null};return b};return a}(),ExpressionPropertyInterface=function(){var r={pv:0,v:0,mult:1},a={pv:[0,0,0],v:[0,0,0],mult:1};function n(x,b,_){Object.defineProperty(x,"velocity",{get:function(){return b.getVelocityAtTime(b.comp.currentFrame)}}),x.numKeys=b.keyframes?b.keyframes.length:0,x.key=function(S){if(!x.numKeys)return 0;var A="";"s"in b.keyframes[S-1]?A=b.keyframes[S-1].s:"e"in b.keyframes[S-2]?A=b.keyframes[S-2].e:A=b.keyframes[S-2].s;var C=_==="unidimensional"?new Number(A):Object.assign({},A);return C.time=b.keyframes[S-1].t/b.elem.comp.globalData.frameRate,C.value=_==="unidimensional"?A[0]:A,C},x.valueAtTime=b.getValueAtTime,x.speedAtTime=b.getSpeedAtTime,x.velocityAtTime=b.getVelocityAtTime,x.propertyGroup=b.propertyGroup}function o(x){(!x||!("pv"in x))&&(x=r);var b=1/x.mult,_=x.pv*b,S=new Number(_);return S.value=_,n(S,x,"unidimensional"),function(){return x.k&&x.getValue(),_=x.v*b,S.value!==_&&(S=new Number(_),S.value=_,S[0]=_,n(S,x,"unidimensional")),S}}function f(x){(!x||!("pv"in x))&&(x=a);var b=1/x.mult,_=x.data&&x.data.l||x.pv.length,S=createTypedArray("float32",_),A=createTypedArray("float32",_);return S.value=A,n(S,x,"multidimensional"),function(){x.k&&x.getValue();for(var C=0;C<_;C+=1)A[C]=x.v[C]*b,S[C]=A[C];return S}}function y(){return r}return function(x){return x?x.propType==="unidimensional"?o(x):f(x):y}}(),TransformExpressionInterface=function(){return function(r){function a(x){switch(x){case"scale":case"Scale":case"ADBE Scale":case 6:return a.scale;case"rotation":case"Rotation":case"ADBE Rotation":case"ADBE Rotate Z":case 10:return a.rotation;case"ADBE Rotate X":return a.xRotation;case"ADBE Rotate Y":return a.yRotation;case"position":case"Position":case"ADBE Position":case 2:return a.position;case"ADBE Position_0":return a.xPosition;case"ADBE Position_1":return a.yPosition;case"ADBE Position_2":return a.zPosition;case"anchorPoint":case"AnchorPoint":case"Anchor Point":case"ADBE AnchorPoint":case 1:return a.anchorPoint;case"opacity":case"Opacity":case 11:return a.opacity;default:return null}}Object.defineProperty(a,"rotation",{get:ExpressionPropertyInterface(r.r||r.rz)}),Object.defineProperty(a,"zRotation",{get:ExpressionPropertyInterface(r.rz||r.r)}),Object.defineProperty(a,"xRotation",{get:ExpressionPropertyInterface(r.rx)}),Object.defineProperty(a,"yRotation",{get:ExpressionPropertyInterface(r.ry)}),Object.defineProperty(a,"scale",{get:ExpressionPropertyInterface(r.s)});var n,o,f,y;return r.p?y=ExpressionPropertyInterface(r.p):(n=ExpressionPropertyInterface(r.px),o=ExpressionPropertyInterface(r.py),r.pz&&(f=ExpressionPropertyInterface(r.pz))),Object.defineProperty(a,"position",{get:function(){return r.p?y():[n(),o(),f?f():0]}}),Object.defineProperty(a,"xPosition",{get:ExpressionPropertyInterface(r.px)}),Object.defineProperty(a,"yPosition",{get:ExpressionPropertyInterface(r.py)}),Object.defineProperty(a,"zPosition",{get:ExpressionPropertyInterface(r.pz)}),Object.defineProperty(a,"anchorPoint",{get:ExpressionPropertyInterface(r.a)}),Object.defineProperty(a,"opacity",{get:ExpressionPropertyInterface(r.o)}),Object.defineProperty(a,"skew",{get:ExpressionPropertyInterface(r.sk)}),Object.defineProperty(a,"skewAxis",{get:ExpressionPropertyInterface(r.sa)}),Object.defineProperty(a,"orientation",{get:ExpressionPropertyInterface(r.or)}),a}}(),LayerExpressionInterface=function(){function r(S){var A=new Matrix;if(S!==void 0){var C=this._elem.finalTransform.mProp.getValueAtTime(S);C.clone(A)}else{var P=this._elem.finalTransform.mProp;P.applyToMatrix(A)}return A}function a(S,A){var C=this.getMatrix(A);return C.props[12]=0,C.props[13]=0,C.props[14]=0,this.applyPoint(C,S)}function n(S,A){var C=this.getMatrix(A);return this.applyPoint(C,S)}function o(S,A){var C=this.getMatrix(A);return C.props[12]=0,C.props[13]=0,C.props[14]=0,this.invertPoint(C,S)}function f(S,A){var C=this.getMatrix(A);return this.invertPoint(C,S)}function y(S,A){if(this._elem.hierarchy&&this._elem.hierarchy.length){var C,P=this._elem.hierarchy.length;for(C=0;C<P;C+=1)this._elem.hierarchy[C].finalTransform.mProp.applyToMatrix(S)}return S.applyToPointArray(A[0],A[1],A[2]||0)}function x(S,A){if(this._elem.hierarchy&&this._elem.hierarchy.length){var C,P=this._elem.hierarchy.length;for(C=0;C<P;C+=1)this._elem.hierarchy[C].finalTransform.mProp.applyToMatrix(S)}return S.inversePoint(A)}function b(S){var A=new Matrix;if(A.reset(),this._elem.finalTransform.mProp.applyToMatrix(A),this._elem.hierarchy&&this._elem.hierarchy.length){var C,P=this._elem.hierarchy.length;for(C=0;C<P;C+=1)this._elem.hierarchy[C].finalTransform.mProp.applyToMatrix(A);return A.inversePoint(S)}return A.inversePoint(S)}function _(){return[1,1,1,1]}return function(S){var A;function C(O){T.mask=new MaskManagerInterface(O,S)}function P(O){T.effect=O}function T(O){switch(O){case"ADBE Root Vectors Group":case"Contents":case 2:return T.shapeInterface;case 1:case 6:case"Transform":case"transform":case"ADBE Transform Group":return A;case 4:case"ADBE Effect Parade":case"effects":case"Effects":return T.effect;case"ADBE Text Properties":return T.textInterface;default:return null}}T.getMatrix=r,T.invertPoint=x,T.applyPoint=y,T.toWorld=n,T.toWorldVec=a,T.fromWorld=f,T.fromWorldVec=o,T.toComp=n,T.fromComp=b,T.sampleImage=_,T.sourceRectAtTime=S.sourceRectAtTime.bind(S),T._elem=S,A=TransformExpressionInterface(S.finalTransform.mProp);var M=getDescriptor(A,"anchorPoint");return Object.defineProperties(T,{hasParent:{get:function(){return S.hierarchy.length}},parent:{get:function(){return S.hierarchy[0].layerInterface}},rotation:getDescriptor(A,"rotation"),scale:getDescriptor(A,"scale"),position:getDescriptor(A,"position"),opacity:getDescriptor(A,"opacity"),anchorPoint:M,anchor_point:M,transform:{get:function(){return A}},active:{get:function(){return S.isInRange}}}),T.startTime=S.data.st,T.index=S.data.ind,T.source=S.data.refId,T.height=S.data.ty===0?S.data.h:100,T.width=S.data.ty===0?S.data.w:100,T.inPoint=S.data.ip/S.comp.globalData.frameRate,T.outPoint=S.data.op/S.comp.globalData.frameRate,T._name=S.data.nm,T.registerMaskInterface=C,T.registerEffectsInterface=P,T}}(),propertyGroupFactory=function(){return function(r,a){return function(n){return n=n===void 0?1:n,n<=0?r:a(n-1)}}}(),PropertyInterface=function(){return function(r,a){var n={_name:r};function o(f){return f=f===void 0?1:f,f<=0?n:a(f-1)}return o}}(),EffectsExpressionInterface=function(){var r={createEffectsInterface:a};function a(f,y){if(f.effectsManager){var x=[],b=f.data.ef,_,S=f.effectsManager.effectElements.length;for(_=0;_<S;_+=1)x.push(n(b[_],f.effectsManager.effectElements[_],y,f));var A=f.data.ef||[],C=function(T){for(_=0,S=A.length;_<S;){if(T===A[_].nm||T===A[_].mn||T===A[_].ix)return x[_];_+=1}return null};return Object.defineProperty(C,"numProperties",{get:function(){return A.length}}),C}return null}function n(f,y,x,b){function _(T){for(var M=f.ef,O=0,I=M.length;O<I;){if(T===M[O].nm||T===M[O].mn||T===M[O].ix)return M[O].ty===5?A[O]:A[O]();O+=1}throw new Error}var S=propertyGroupFactory(_,x),A=[],C,P=f.ef.length;for(C=0;C<P;C+=1)f.ef[C].ty===5?A.push(n(f.ef[C],y.effectElements[C],y.effectElements[C].propertyGroup,b)):A.push(o(y.effectElements[C],f.ef[C].ty,b,S));return f.mn==="ADBE Color Control"&&Object.defineProperty(_,"color",{get:function(){return A[0]()}}),Object.defineProperties(_,{numProperties:{get:function(){return f.np}},_name:{value:f.nm},propertyGroup:{value:S}}),_.enabled=f.en!==0,_.active=_.enabled,_}function o(f,y,x,b){var _=ExpressionPropertyInterface(f.p);function S(){return y===10?x.comp.compInterface(f.p.v):_()}return f.p.setGroupProperty&&f.p.setGroupProperty(PropertyInterface("",b)),S}return r}(),ShapePathInterface=function(){return function(a,n,o){var f=n.sh;function y(b){return b==="Shape"||b==="shape"||b==="Path"||b==="path"||b==="ADBE Vector Shape"||b===2?y.path:null}var x=propertyGroupFactory(y,o);return f.setGroupProperty(PropertyInterface("Path",x)),Object.defineProperties(y,{path:{get:function(){return f.k&&f.getValue(),f}},shape:{get:function(){return f.k&&f.getValue(),f}},_name:{value:a.nm},ix:{value:a.ix},propertyIndex:{value:a.ix},mn:{value:a.mn},propertyGroup:{value:o}}),y}}(),ShapeExpressionInterface=function(){function r(M,O,I){var D=[],z,k=M?M.length:0;for(z=0;z<k;z+=1)M[z].ty==="gr"?D.push(n(M[z],O[z],I)):M[z].ty==="fl"?D.push(o(M[z],O[z],I)):M[z].ty==="st"?D.push(x(M[z],O[z],I)):M[z].ty==="tm"?D.push(b(M[z],O[z],I)):M[z].ty==="tr"||(M[z].ty==="el"?D.push(S(M[z],O[z],I)):M[z].ty==="sr"?D.push(A(M[z],O[z],I)):M[z].ty==="sh"?D.push(ShapePathInterface(M[z],O[z],I)):M[z].ty==="rc"?D.push(C(M[z],O[z],I)):M[z].ty==="rd"?D.push(P(M[z],O[z],I)):M[z].ty==="rp"?D.push(T(M[z],O[z],I)):M[z].ty==="gf"?D.push(f(M[z],O[z],I)):D.push(y(M[z],O[z])));return D}function a(M,O,I){var D,z=function(R){for(var F=0,B=D.length;F<B;){if(D[F]._name===R||D[F].mn===R||D[F].propertyIndex===R||D[F].ix===R||D[F].ind===R)return D[F];F+=1}return typeof R=="number"?D[R-1]:null};z.propertyGroup=propertyGroupFactory(z,I),D=r(M.it,O.it,z.propertyGroup),z.numProperties=D.length;var k=_(M.it[M.it.length-1],O.it[O.it.length-1],z.propertyGroup);return z.transform=k,z.propertyIndex=M.cix,z._name=M.nm,z}function n(M,O,I){var D=function(R){switch(R){case"ADBE Vectors Group":case"Contents":case 2:return D.content;default:return D.transform}};D.propertyGroup=propertyGroupFactory(D,I);var z=a(M,O,D.propertyGroup),k=_(M.it[M.it.length-1],O.it[O.it.length-1],D.propertyGroup);return D.content=z,D.transform=k,Object.defineProperty(D,"_name",{get:function(){return M.nm}}),D.numProperties=M.np,D.propertyIndex=M.ix,D.nm=M.nm,D.mn=M.mn,D}function o(M,O,I){function D(z){return z==="Color"||z==="color"?D.color:z==="Opacity"||z==="opacity"?D.opacity:null}return Object.defineProperties(D,{color:{get:ExpressionPropertyInterface(O.c)},opacity:{get:ExpressionPropertyInterface(O.o)},_name:{value:M.nm},mn:{value:M.mn}}),O.c.setGroupProperty(PropertyInterface("Color",I)),O.o.setGroupProperty(PropertyInterface("Opacity",I)),D}function f(M,O,I){function D(z){return z==="Start Point"||z==="start point"?D.startPoint:z==="End Point"||z==="end point"?D.endPoint:z==="Opacity"||z==="opacity"?D.opacity:null}return Object.defineProperties(D,{startPoint:{get:ExpressionPropertyInterface(O.s)},endPoint:{get:ExpressionPropertyInterface(O.e)},opacity:{get:ExpressionPropertyInterface(O.o)},type:{get:function(){return"a"}},_name:{value:M.nm},mn:{value:M.mn}}),O.s.setGroupProperty(PropertyInterface("Start Point",I)),O.e.setGroupProperty(PropertyInterface("End Point",I)),O.o.setGroupProperty(PropertyInterface("Opacity",I)),D}function y(){function M(){return null}return M}function x(M,O,I){var D=propertyGroupFactory(B,I),z=propertyGroupFactory(F,D);function k(N){Object.defineProperty(F,M.d[N].nm,{get:ExpressionPropertyInterface(O.d.dataProps[N].p)})}var L,R=M.d?M.d.length:0,F={};for(L=0;L<R;L+=1)k(L),O.d.dataProps[L].p.setGroupProperty(z);function B(N){return N==="Color"||N==="color"?B.color:N==="Opacity"||N==="opacity"?B.opacity:N==="Stroke Width"||N==="stroke width"?B.strokeWidth:null}return Object.defineProperties(B,{color:{get:ExpressionPropertyInterface(O.c)},opacity:{get:ExpressionPropertyInterface(O.o)},strokeWidth:{get:ExpressionPropertyInterface(O.w)},dash:{get:function(){return F}},_name:{value:M.nm},mn:{value:M.mn}}),O.c.setGroupProperty(PropertyInterface("Color",D)),O.o.setGroupProperty(PropertyInterface("Opacity",D)),O.w.setGroupProperty(PropertyInterface("Stroke Width",D)),B}function b(M,O,I){function D(k){return k===M.e.ix||k==="End"||k==="end"?D.end:k===M.s.ix?D.start:k===M.o.ix?D.offset:null}var z=propertyGroupFactory(D,I);return D.propertyIndex=M.ix,O.s.setGroupProperty(PropertyInterface("Start",z)),O.e.setGroupProperty(PropertyInterface("End",z)),O.o.setGroupProperty(PropertyInterface("Offset",z)),D.propertyIndex=M.ix,D.propertyGroup=I,Object.defineProperties(D,{start:{get:ExpressionPropertyInterface(O.s)},end:{get:ExpressionPropertyInterface(O.e)},offset:{get:ExpressionPropertyInterface(O.o)},_name:{value:M.nm}}),D.mn=M.mn,D}function _(M,O,I){function D(k){return M.a.ix===k||k==="Anchor Point"?D.anchorPoint:M.o.ix===k||k==="Opacity"?D.opacity:M.p.ix===k||k==="Position"?D.position:M.r.ix===k||k==="Rotation"||k==="ADBE Vector Rotation"?D.rotation:M.s.ix===k||k==="Scale"?D.scale:M.sk&&M.sk.ix===k||k==="Skew"?D.skew:M.sa&&M.sa.ix===k||k==="Skew Axis"?D.skewAxis:null}var z=propertyGroupFactory(D,I);return O.transform.mProps.o.setGroupProperty(PropertyInterface("Opacity",z)),O.transform.mProps.p.setGroupProperty(PropertyInterface("Position",z)),O.transform.mProps.a.setGroupProperty(PropertyInterface("Anchor Point",z)),O.transform.mProps.s.setGroupProperty(PropertyInterface("Scale",z)),O.transform.mProps.r.setGroupProperty(PropertyInterface("Rotation",z)),O.transform.mProps.sk&&(O.transform.mProps.sk.setGroupProperty(PropertyInterface("Skew",z)),O.transform.mProps.sa.setGroupProperty(PropertyInterface("Skew Angle",z))),O.transform.op.setGroupProperty(PropertyInterface("Opacity",z)),Object.defineProperties(D,{opacity:{get:ExpressionPropertyInterface(O.transform.mProps.o)},position:{get:ExpressionPropertyInterface(O.transform.mProps.p)},anchorPoint:{get:ExpressionPropertyInterface(O.transform.mProps.a)},scale:{get:ExpressionPropertyInterface(O.transform.mProps.s)},rotation:{get:ExpressionPropertyInterface(O.transform.mProps.r)},skew:{get:ExpressionPropertyInterface(O.transform.mProps.sk)},skewAxis:{get:ExpressionPropertyInterface(O.transform.mProps.sa)},_name:{value:M.nm}}),D.ty="tr",D.mn=M.mn,D.propertyGroup=I,D}function S(M,O,I){function D(L){return M.p.ix===L?D.position:M.s.ix===L?D.size:null}var z=propertyGroupFactory(D,I);D.propertyIndex=M.ix;var k=O.sh.ty==="tm"?O.sh.prop:O.sh;return k.s.setGroupProperty(PropertyInterface("Size",z)),k.p.setGroupProperty(PropertyInterface("Position",z)),Object.defineProperties(D,{size:{get:ExpressionPropertyInterface(k.s)},position:{get:ExpressionPropertyInterface(k.p)},_name:{value:M.nm}}),D.mn=M.mn,D}function A(M,O,I){function D(L){return M.p.ix===L?D.position:M.r.ix===L?D.rotation:M.pt.ix===L?D.points:M.or.ix===L||L==="ADBE Vector Star Outer Radius"?D.outerRadius:M.os.ix===L?D.outerRoundness:M.ir&&(M.ir.ix===L||L==="ADBE Vector Star Inner Radius")?D.innerRadius:M.is&&M.is.ix===L?D.innerRoundness:null}var z=propertyGroupFactory(D,I),k=O.sh.ty==="tm"?O.sh.prop:O.sh;return D.propertyIndex=M.ix,k.or.setGroupProperty(PropertyInterface("Outer Radius",z)),k.os.setGroupProperty(PropertyInterface("Outer Roundness",z)),k.pt.setGroupProperty(PropertyInterface("Points",z)),k.p.setGroupProperty(PropertyInterface("Position",z)),k.r.setGroupProperty(PropertyInterface("Rotation",z)),M.ir&&(k.ir.setGroupProperty(PropertyInterface("Inner Radius",z)),k.is.setGroupProperty(PropertyInterface("Inner Roundness",z))),Object.defineProperties(D,{position:{get:ExpressionPropertyInterface(k.p)},rotation:{get:ExpressionPropertyInterface(k.r)},points:{get:ExpressionPropertyInterface(k.pt)},outerRadius:{get:ExpressionPropertyInterface(k.or)},outerRoundness:{get:ExpressionPropertyInterface(k.os)},innerRadius:{get:ExpressionPropertyInterface(k.ir)},innerRoundness:{get:ExpressionPropertyInterface(k.is)},_name:{value:M.nm}}),D.mn=M.mn,D}function C(M,O,I){function D(L){return M.p.ix===L?D.position:M.r.ix===L?D.roundness:M.s.ix===L||L==="Size"||L==="ADBE Vector Rect Size"?D.size:null}var z=propertyGroupFactory(D,I),k=O.sh.ty==="tm"?O.sh.prop:O.sh;return D.propertyIndex=M.ix,k.p.setGroupProperty(PropertyInterface("Position",z)),k.s.setGroupProperty(PropertyInterface("Size",z)),k.r.setGroupProperty(PropertyInterface("Rotation",z)),Object.defineProperties(D,{position:{get:ExpressionPropertyInterface(k.p)},roundness:{get:ExpressionPropertyInterface(k.r)},size:{get:ExpressionPropertyInterface(k.s)},_name:{value:M.nm}}),D.mn=M.mn,D}function P(M,O,I){function D(L){return M.r.ix===L||L==="Round Corners 1"?D.radius:null}var z=propertyGroupFactory(D,I),k=O;return D.propertyIndex=M.ix,k.rd.setGroupProperty(PropertyInterface("Radius",z)),Object.defineProperties(D,{radius:{get:ExpressionPropertyInterface(k.rd)},_name:{value:M.nm}}),D.mn=M.mn,D}function T(M,O,I){function D(L){return M.c.ix===L||L==="Copies"?D.copies:M.o.ix===L||L==="Offset"?D.offset:null}var z=propertyGroupFactory(D,I),k=O;return D.propertyIndex=M.ix,k.c.setGroupProperty(PropertyInterface("Copies",z)),k.o.setGroupProperty(PropertyInterface("Offset",z)),Object.defineProperties(D,{copies:{get:ExpressionPropertyInterface(k.c)},offset:{get:ExpressionPropertyInterface(k.o)},_name:{value:M.nm}}),D.mn=M.mn,D}return function(M,O,I){var D;function z(L){if(typeof L=="number")return L=L===void 0?1:L,L===0?I:D[L-1];for(var R=0,F=D.length;R<F;){if(D[R]._name===L)return D[R];R+=1}return null}function k(){return I}return z.propertyGroup=propertyGroupFactory(z,k),D=r(M,O,z.propertyGroup),z.numProperties=D.length,z._name="Contents",z}}(),TextExpressionInterface=function(){return function(r){var a;function n(o){switch(o){case"ADBE Text Document":return n.sourceText;default:return null}}return Object.defineProperty(n,"sourceText",{get:function(){r.textProperty.getValue();var f=r.textProperty.currentData.t;return(!a||f!==a.value)&&(a=new String(f),a.value=f||new String(f),Object.defineProperty(a,"style",{get:function(){return{fillColor:r.textProperty.currentData.fc}}})),a}}),n}}();function _typeof(r){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(r)}var FootageInterface=function(){var r=function(o){var f="",y=o.getFootageData();function x(){return f="",y=o.getFootageData(),b}function b(_){if(y[_])return f=_,y=y[_],_typeof(y)==="object"?b:y;var S=_.indexOf(f);if(S!==-1){var A=parseInt(_.substr(S+f.length),10);return y=y[A],_typeof(y)==="object"?b:y}return""}return x},a=function(o){function f(y){return y==="Outline"?f.outlineInterface():null}return f._name="Outline",f.outlineInterface=r(o),f};return function(n){function o(f){return f==="Data"?o.dataInterface:null}return o._name="Data",o.dataInterface=a(n),o}}(),interfaces={layer:LayerExpressionInterface,effects:EffectsExpressionInterface,comp:CompExpressionInterface,shape:ShapeExpressionInterface,text:TextExpressionInterface,footage:FootageInterface};function getInterface(r){return interfaces[r]||null}var expressionHelpers=function(){function r(x,b,_){b.x&&(_.k=!0,_.x=!0,_.initiateExpression=ExpressionManager.initiateExpression,_.effectsSequence.push(_.initiateExpression(x,b,_).bind(_)))}function a(x){return x*=this.elem.globalData.frameRate,x-=this.offsetTime,x!==this._cachingAtTime.lastFrame&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastFrame<x?this._cachingAtTime.lastIndex:0,this._cachingAtTime.value=this.interpolateValue(x,this._cachingAtTime),this._cachingAtTime.lastFrame=x),this._cachingAtTime.value}function n(x){var b=-.01,_=this.getValueAtTime(x),S=this.getValueAtTime(x+b),A=0;if(_.length){var C;for(C=0;C<_.length;C+=1)A+=Math.pow(S[C]-_[C],2);A=Math.sqrt(A)*100}else A=0;return A}function o(x){if(this.vel!==void 0)return this.vel;var b=-.001,_=this.getValueAtTime(x),S=this.getValueAtTime(x+b),A;if(_.length){A=createTypedArray("float32",_.length);var C;for(C=0;C<_.length;C+=1)A[C]=(S[C]-_[C])/b}else A=(S-_)/b;return A}function f(){return this.pv}function y(x){this.propertyGroup=x}return{searchExpressions:r,getSpeedAtTime:n,getVelocityAtTime:o,getValueAtTime:a,getStaticValueAtTime:f,setGroupProperty:y}}();function addPropertyDecorator(){function r(P,T,M){if(!this.k||!this.keyframes)return this.pv;P=P?P.toLowerCase():"";var O=this.comp.renderedFrame,I=this.keyframes,D=I[I.length-1].t;if(O<=D)return this.pv;var z,k;M?(T?z=Math.abs(D-this.elem.comp.globalData.frameRate*T):z=Math.max(0,D-this.elem.data.ip),k=D-z):((!T||T>I.length-1)&&(T=I.length-1),k=I[I.length-1-T].t,z=D-k);var L,R,F;if(P==="pingpong"){var B=Math.floor((O-k)/z);if(B%2!==0)return this.getValueAtTime((z-(O-k)%z+k)/this.comp.globalData.frameRate,0)}else if(P==="offset"){var N=this.getValueAtTime(k/this.comp.globalData.frameRate,0),j=this.getValueAtTime(D/this.comp.globalData.frameRate,0),G=this.getValueAtTime(((O-k)%z+k)/this.comp.globalData.frameRate,0),Y=Math.floor((O-k)/z);if(this.pv.length){for(F=new Array(N.length),R=F.length,L=0;L<R;L+=1)F[L]=(j[L]-N[L])*Y+G[L];return F}return(j-N)*Y+G}else if(P==="continue"){var X=this.getValueAtTime(D/this.comp.globalData.frameRate,0),$=this.getValueAtTime((D-.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(F=new Array(X.length),R=F.length,L=0;L<R;L+=1)F[L]=X[L]+(X[L]-$[L])*((O-D)/this.comp.globalData.frameRate)/5e-4;return F}return X+(X-$)*((O-D)/.001)}return this.getValueAtTime(((O-k)%z+k)/this.comp.globalData.frameRate,0)}function a(P,T,M){if(!this.k)return this.pv;P=P?P.toLowerCase():"";var O=this.comp.renderedFrame,I=this.keyframes,D=I[0].t;if(O>=D)return this.pv;var z,k;M?(T?z=Math.abs(this.elem.comp.globalData.frameRate*T):z=Math.max(0,this.elem.data.op-D),k=D+z):((!T||T>I.length-1)&&(T=I.length-1),k=I[T].t,z=k-D);var L,R,F;if(P==="pingpong"){var B=Math.floor((D-O)/z);if(B%2===0)return this.getValueAtTime(((D-O)%z+D)/this.comp.globalData.frameRate,0)}else if(P==="offset"){var N=this.getValueAtTime(D/this.comp.globalData.frameRate,0),j=this.getValueAtTime(k/this.comp.globalData.frameRate,0),G=this.getValueAtTime((z-(D-O)%z+D)/this.comp.globalData.frameRate,0),Y=Math.floor((D-O)/z)+1;if(this.pv.length){for(F=new Array(N.length),R=F.length,L=0;L<R;L+=1)F[L]=G[L]-(j[L]-N[L])*Y;return F}return G-(j-N)*Y}else if(P==="continue"){var X=this.getValueAtTime(D/this.comp.globalData.frameRate,0),$=this.getValueAtTime((D+.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(F=new Array(X.length),R=F.length,L=0;L<R;L+=1)F[L]=X[L]+(X[L]-$[L])*(D-O)/.001;return F}return X+(X-$)*(D-O)/.001}return this.getValueAtTime((z-((D-O)%z+D))/this.comp.globalData.frameRate,0)}function n(P,T){if(!this.k)return this.pv;if(P=(P||.4)*.5,T=Math.floor(T||5),T<=1)return this.pv;var M=this.comp.renderedFrame/this.comp.globalData.frameRate,O=M-P,I=M+P,D=T>1?(I-O)/(T-1):1,z=0,k=0,L;this.pv.length?L=createTypedArray("float32",this.pv.length):L=0;for(var R;z<T;){if(R=this.getValueAtTime(O+z*D),this.pv.length)for(k=0;k<this.pv.length;k+=1)L[k]+=R[k];else L+=R;z+=1}if(this.pv.length)for(k=0;k<this.pv.length;k+=1)L[k]/=T;else L/=T;return L}function o(P){this._transformCachingAtTime||(this._transformCachingAtTime={v:new Matrix});var T=this._transformCachingAtTime.v;if(T.cloneFromProps(this.pre.props),this.appliedTransformations<1){var M=this.a.getValueAtTime(P);T.translate(-M[0]*this.a.mult,-M[1]*this.a.mult,M[2]*this.a.mult)}if(this.appliedTransformations<2){var O=this.s.getValueAtTime(P);T.scale(O[0]*this.s.mult,O[1]*this.s.mult,O[2]*this.s.mult)}if(this.sk&&this.appliedTransformations<3){var I=this.sk.getValueAtTime(P),D=this.sa.getValueAtTime(P);T.skewFromAxis(-I*this.sk.mult,D*this.sa.mult)}if(this.r&&this.appliedTransformations<4){var z=this.r.getValueAtTime(P);T.rotate(-z*this.r.mult)}else if(!this.r&&this.appliedTransformations<4){var k=this.rz.getValueAtTime(P),L=this.ry.getValueAtTime(P),R=this.rx.getValueAtTime(P),F=this.or.getValueAtTime(P);T.rotateZ(-k*this.rz.mult).rotateY(L*this.ry.mult).rotateX(R*this.rx.mult).rotateZ(-F[2]*this.or.mult).rotateY(F[1]*this.or.mult).rotateX(F[0]*this.or.mult)}if(this.data.p&&this.data.p.s){var B=this.px.getValueAtTime(P),N=this.py.getValueAtTime(P);if(this.data.p.z){var j=this.pz.getValueAtTime(P);T.translate(B*this.px.mult,N*this.py.mult,-j*this.pz.mult)}else T.translate(B*this.px.mult,N*this.py.mult,0)}else{var G=this.p.getValueAtTime(P);T.translate(G[0]*this.p.mult,G[1]*this.p.mult,-G[2]*this.p.mult)}return T}function f(){return this.v.clone(new Matrix)}var y=TransformPropertyFactory.getTransformProperty;TransformPropertyFactory.getTransformProperty=function(P,T,M){var O=y(P,T,M);return O.dynamicProperties.length?O.getValueAtTime=o.bind(O):O.getValueAtTime=f.bind(O),O.setGroupProperty=expressionHelpers.setGroupProperty,O};var x=PropertyFactory.getProp;PropertyFactory.getProp=function(P,T,M,O,I){var D=x(P,T,M,O,I);D.kf?D.getValueAtTime=expressionHelpers.getValueAtTime.bind(D):D.getValueAtTime=expressionHelpers.getStaticValueAtTime.bind(D),D.setGroupProperty=expressionHelpers.setGroupProperty,D.loopOut=r,D.loopIn=a,D.smooth=n,D.getVelocityAtTime=expressionHelpers.getVelocityAtTime.bind(D),D.getSpeedAtTime=expressionHelpers.getSpeedAtTime.bind(D),D.numKeys=T.a===1?T.k.length:0,D.propertyIndex=T.ix;var z=0;return M!==0&&(z=createTypedArray("float32",T.a===1?T.k[0].s.length:T.k.length)),D._cachingAtTime={lastFrame:initialDefaultFrame,lastIndex:0,value:z},expressionHelpers.searchExpressions(P,T,D),D.k&&I.addDynamicProperty(D),D};function b(P){return this._cachingAtTime||(this._cachingAtTime={shapeValue:shapePool.clone(this.pv),lastIndex:0,lastTime:initialDefaultFrame}),P*=this.elem.globalData.frameRate,P-=this.offsetTime,P!==this._cachingAtTime.lastTime&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastTime<P?this._caching.lastIndex:0,this._cachingAtTime.lastTime=P,this.interpolateShape(P,this._cachingAtTime.shapeValue,this._cachingAtTime)),this._cachingAtTime.shapeValue}var _=ShapePropertyFactory.getConstructorFunction(),S=ShapePropertyFactory.getKeyframedConstructorFunction();function A(){}A.prototype={vertices:function(T,M){this.k&&this.getValue();var O=this.v;M!==void 0&&(O=this.getValueAtTime(M,0));var I,D=O._length,z=O[T],k=O.v,L=createSizedArray(D);for(I=0;I<D;I+=1)T==="i"||T==="o"?L[I]=[z[I][0]-k[I][0],z[I][1]-k[I][1]]:L[I]=[z[I][0],z[I][1]];return L},points:function(T){return this.vertices("v",T)},inTangents:function(T){return this.vertices("i",T)},outTangents:function(T){return this.vertices("o",T)},isClosed:function(){return this.v.c},pointOnPath:function(T,M){var O=this.v;M!==void 0&&(O=this.getValueAtTime(M,0)),this._segmentsLength||(this._segmentsLength=bez.getSegmentsLength(O));for(var I=this._segmentsLength,D=I.lengths,z=I.totalLength*T,k=0,L=D.length,R=0,F;k<L;){if(R+D[k].addedLength>z){var B=k,N=O.c&&k===L-1?0:k+1,j=(z-R)/D[k].addedLength;F=bez.getPointInSegment(O.v[B],O.v[N],O.o[B],O.i[N],j,D[k]);break}else R+=D[k].addedLength;k+=1}return F||(F=O.c?[O.v[0][0],O.v[0][1]]:[O.v[O._length-1][0],O.v[O._length-1][1]]),F},vectorOnPath:function(T,M,O){T==1?T=this.v.c:T==0&&(T=.999);var I=this.pointOnPath(T,M),D=this.pointOnPath(T+.001,M),z=D[0]-I[0],k=D[1]-I[1],L=Math.sqrt(Math.pow(z,2)+Math.pow(k,2));if(L===0)return[0,0];var R=O==="tangent"?[z/L,k/L]:[-k/L,z/L];return R},tangentOnPath:function(T,M){return this.vectorOnPath(T,M,"tangent")},normalOnPath:function(T,M){return this.vectorOnPath(T,M,"normal")},setGroupProperty:expressionHelpers.setGroupProperty,getValueAtTime:expressionHelpers.getStaticValueAtTime},extendPrototype([A],_),extendPrototype([A],S),S.prototype.getValueAtTime=b,S.prototype.initiateExpression=ExpressionManager.initiateExpression;var C=ShapePropertyFactory.getShapeProp;ShapePropertyFactory.getShapeProp=function(P,T,M,O,I){var D=C(P,T,M,O,I);return D.propertyIndex=T.ix,D.lock=!1,M===3?expressionHelpers.searchExpressions(P,T.pt,D):M===4&&expressionHelpers.searchExpressions(P,T.ks,D),D.k&&P.addDynamicProperty(D),D}}function initialize$1(){addPropertyDecorator()}function addDecorator(){function r(){return this.data.d.x?(this.calculateExpression=ExpressionManager.initiateExpression.bind(this)(this.elem,this.data.d,this),this.addEffect(this.getExpressionValue.bind(this)),!0):null}TextProperty.prototype.getExpressionValue=function(a,n){var o=this.calculateExpression(n);if(a.t!==o){var f={};return this.copyData(f,a),f.t=o.toString(),f.__complete=!1,f}return a},TextProperty.prototype.searchProperty=function(){var a=this.searchKeyframes(),n=this.searchExpressions();return this.kf=a||n,this.kf},TextProperty.prototype.searchExpressions=r}function initialize(){addDecorator()}function SVGComposableEffect(){}SVGComposableEffect.prototype={createMergeNode:function r(a,n){var o=createNS("feMerge");o.setAttribute("result",a);var f,y;for(y=0;y<n.length;y+=1)f=createNS("feMergeNode"),f.setAttribute("in",n[y]),o.appendChild(f),o.appendChild(f);return o}};var linearFilterValue="0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0";function SVGTintFilter(r,a,n,o,f){this.filterManager=a;var y=createNS("feColorMatrix");y.setAttribute("type","matrix"),y.setAttribute("color-interpolation-filters","linearRGB"),y.setAttribute("values",linearFilterValue+" 1 0"),this.linearFilter=y,y.setAttribute("result",o+"_tint_1"),r.appendChild(y),y=createNS("feColorMatrix"),y.setAttribute("type","matrix"),y.setAttribute("color-interpolation-filters","sRGB"),y.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),y.setAttribute("result",o+"_tint_2"),r.appendChild(y),this.matrixFilter=y;var x=this.createMergeNode(o,[f,o+"_tint_1",o+"_tint_2"]);r.appendChild(x)}extendPrototype([SVGComposableEffect],SVGTintFilter),SVGTintFilter.prototype.renderFrame=function(r){if(r||this.filterManager._mdf){var a=this.filterManager.effectElements[0].p.v,n=this.filterManager.effectElements[1].p.v,o=this.filterManager.effectElements[2].p.v/100;this.linearFilter.setAttribute("values",linearFilterValue+" "+o+" 0"),this.matrixFilter.setAttribute("values",n[0]-a[0]+" 0 0 0 "+a[0]+" "+(n[1]-a[1])+" 0 0 0 "+a[1]+" "+(n[2]-a[2])+" 0 0 0 "+a[2]+" 0 0 0 1 0")}};function SVGFillFilter(r,a,n,o){this.filterManager=a;var f=createNS("feColorMatrix");f.setAttribute("type","matrix"),f.setAttribute("color-interpolation-filters","sRGB"),f.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),f.setAttribute("result",o),r.appendChild(f),this.matrixFilter=f}SVGFillFilter.prototype.renderFrame=function(r){if(r||this.filterManager._mdf){var a=this.filterManager.effectElements[2].p.v,n=this.filterManager.effectElements[6].p.v;this.matrixFilter.setAttribute("values","0 0 0 0 "+a[0]+" 0 0 0 0 "+a[1]+" 0 0 0 0 "+a[2]+" 0 0 0 "+n+" 0")}};function SVGStrokeEffect(r,a,n){this.initialized=!1,this.filterManager=a,this.elem=n,this.paths=[]}SVGStrokeEffect.prototype.initialize=function(){var r=this.elem.layerElement.children||this.elem.layerElement.childNodes,a,n,o,f;for(this.filterManager.effectElements[1].p.v===1?(f=this.elem.maskManager.masksProperties.length,o=0):(o=this.filterManager.effectElements[0].p.v-1,f=o+1),n=createNS("g"),n.setAttribute("fill","none"),n.setAttribute("stroke-linecap","round"),n.setAttribute("stroke-dashoffset",1),o;o<f;o+=1)a=createNS("path"),n.appendChild(a),this.paths.push({p:a,m:o});if(this.filterManager.effectElements[10].p.v===3){var y=createNS("mask"),x=createElementID();y.setAttribute("id",x),y.setAttribute("mask-type","alpha"),y.appendChild(n),this.elem.globalData.defs.appendChild(y);var b=createNS("g");for(b.setAttribute("mask","url("+getLocationHref()+"#"+x+")");r[0];)b.appendChild(r[0]);this.elem.layerElement.appendChild(b),this.masker=y,n.setAttribute("stroke","#fff")}else if(this.filterManager.effectElements[10].p.v===1||this.filterManager.effectElements[10].p.v===2){if(this.filterManager.effectElements[10].p.v===2)for(r=this.elem.layerElement.children||this.elem.layerElement.childNodes;r.length;)this.elem.layerElement.removeChild(r[0]);this.elem.layerElement.appendChild(n),this.elem.layerElement.removeAttribute("mask"),n.setAttribute("stroke","#fff")}this.initialized=!0,this.pathMasker=n},SVGStrokeEffect.prototype.renderFrame=function(r){this.initialized||this.initialize();var a,n=this.paths.length,o,f;for(a=0;a<n;a+=1)if(this.paths[a].m!==-1&&(o=this.elem.maskManager.viewData[this.paths[a].m],f=this.paths[a].p,(r||this.filterManager._mdf||o.prop._mdf)&&f.setAttribute("d",o.lastPath),r||this.filterManager.effectElements[9].p._mdf||this.filterManager.effectElements[4].p._mdf||this.filterManager.effectElements[7].p._mdf||this.filterManager.effectElements[8].p._mdf||o.prop._mdf)){var y;if(this.filterManager.effectElements[7].p.v!==0||this.filterManager.effectElements[8].p.v!==100){var x=Math.min(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v)*.01,b=Math.max(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v)*.01,_=f.getTotalLength();y="0 0 0 "+_*x+" ";var S=_*(b-x),A=1+this.filterManager.effectElements[4].p.v*2*this.filterManager.effectElements[9].p.v*.01,C=Math.floor(S/A),P;for(P=0;P<C;P+=1)y+="1 "+this.filterManager.effectElements[4].p.v*2*this.filterManager.effectElements[9].p.v*.01+" ";y+="0 "+_*10+" 0 0"}else y="1 "+this.filterManager.effectElements[4].p.v*2*this.filterManager.effectElements[9].p.v*.01;f.setAttribute("stroke-dasharray",y)}if((r||this.filterManager.effectElements[4].p._mdf)&&this.pathMasker.setAttribute("stroke-width",this.filterManager.effectElements[4].p.v*2),(r||this.filterManager.effectElements[6].p._mdf)&&this.pathMasker.setAttribute("opacity",this.filterManager.effectElements[6].p.v),(this.filterManager.effectElements[10].p.v===1||this.filterManager.effectElements[10].p.v===2)&&(r||this.filterManager.effectElements[3].p._mdf)){var T=this.filterManager.effectElements[3].p.v;this.pathMasker.setAttribute("stroke","rgb("+bmFloor(T[0]*255)+","+bmFloor(T[1]*255)+","+bmFloor(T[2]*255)+")")}};function SVGTritoneFilter(r,a,n,o){this.filterManager=a;var f=createNS("feColorMatrix");f.setAttribute("type","matrix"),f.setAttribute("color-interpolation-filters","linearRGB"),f.setAttribute("values","0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"),r.appendChild(f);var y=createNS("feComponentTransfer");y.setAttribute("color-interpolation-filters","sRGB"),y.setAttribute("result",o),this.matrixFilter=y;var x=createNS("feFuncR");x.setAttribute("type","table"),y.appendChild(x),this.feFuncR=x;var b=createNS("feFuncG");b.setAttribute("type","table"),y.appendChild(b),this.feFuncG=b;var _=createNS("feFuncB");_.setAttribute("type","table"),y.appendChild(_),this.feFuncB=_,r.appendChild(y)}SVGTritoneFilter.prototype.renderFrame=function(r){if(r||this.filterManager._mdf){var a=this.filterManager.effectElements[0].p.v,n=this.filterManager.effectElements[1].p.v,o=this.filterManager.effectElements[2].p.v,f=o[0]+" "+n[0]+" "+a[0],y=o[1]+" "+n[1]+" "+a[1],x=o[2]+" "+n[2]+" "+a[2];this.feFuncR.setAttribute("tableValues",f),this.feFuncG.setAttribute("tableValues",y),this.feFuncB.setAttribute("tableValues",x)}};function SVGProLevelsFilter(r,a,n,o){this.filterManager=a;var f=this.filterManager.effectElements,y=createNS("feComponentTransfer");(f[10].p.k||f[10].p.v!==0||f[11].p.k||f[11].p.v!==1||f[12].p.k||f[12].p.v!==1||f[13].p.k||f[13].p.v!==0||f[14].p.k||f[14].p.v!==1)&&(this.feFuncR=this.createFeFunc("feFuncR",y)),(f[17].p.k||f[17].p.v!==0||f[18].p.k||f[18].p.v!==1||f[19].p.k||f[19].p.v!==1||f[20].p.k||f[20].p.v!==0||f[21].p.k||f[21].p.v!==1)&&(this.feFuncG=this.createFeFunc("feFuncG",y)),(f[24].p.k||f[24].p.v!==0||f[25].p.k||f[25].p.v!==1||f[26].p.k||f[26].p.v!==1||f[27].p.k||f[27].p.v!==0||f[28].p.k||f[28].p.v!==1)&&(this.feFuncB=this.createFeFunc("feFuncB",y)),(f[31].p.k||f[31].p.v!==0||f[32].p.k||f[32].p.v!==1||f[33].p.k||f[33].p.v!==1||f[34].p.k||f[34].p.v!==0||f[35].p.k||f[35].p.v!==1)&&(this.feFuncA=this.createFeFunc("feFuncA",y)),(this.feFuncR||this.feFuncG||this.feFuncB||this.feFuncA)&&(y.setAttribute("color-interpolation-filters","sRGB"),r.appendChild(y)),(f[3].p.k||f[3].p.v!==0||f[4].p.k||f[4].p.v!==1||f[5].p.k||f[5].p.v!==1||f[6].p.k||f[6].p.v!==0||f[7].p.k||f[7].p.v!==1)&&(y=createNS("feComponentTransfer"),y.setAttribute("color-interpolation-filters","sRGB"),y.setAttribute("result",o),r.appendChild(y),this.feFuncRComposed=this.createFeFunc("feFuncR",y),this.feFuncGComposed=this.createFeFunc("feFuncG",y),this.feFuncBComposed=this.createFeFunc("feFuncB",y))}SVGProLevelsFilter.prototype.createFeFunc=function(r,a){var n=createNS(r);return n.setAttribute("type","table"),a.appendChild(n),n},SVGProLevelsFilter.prototype.getTableValue=function(r,a,n,o,f){for(var y=0,x=256,b,_=Math.min(r,a),S=Math.max(r,a),A=Array.call(null,{length:x}),C,P=0,T=f-o,M=a-r;y<=256;)b=y/256,b<=_?C=M<0?f:o:b>=S?C=M<0?o:f:C=o+T*Math.pow((b-r)/M,1/n),A[P]=C,P+=1,y+=256/(x-1);return A.join(" ")},SVGProLevelsFilter.prototype.renderFrame=function(r){if(r||this.filterManager._mdf){var a,n=this.filterManager.effectElements;this.feFuncRComposed&&(r||n[3].p._mdf||n[4].p._mdf||n[5].p._mdf||n[6].p._mdf||n[7].p._mdf)&&(a=this.getTableValue(n[3].p.v,n[4].p.v,n[5].p.v,n[6].p.v,n[7].p.v),this.feFuncRComposed.setAttribute("tableValues",a),this.feFuncGComposed.setAttribute("tableValues",a),this.feFuncBComposed.setAttribute("tableValues",a)),this.feFuncR&&(r||n[10].p._mdf||n[11].p._mdf||n[12].p._mdf||n[13].p._mdf||n[14].p._mdf)&&(a=this.getTableValue(n[10].p.v,n[11].p.v,n[12].p.v,n[13].p.v,n[14].p.v),this.feFuncR.setAttribute("tableValues",a)),this.feFuncG&&(r||n[17].p._mdf||n[18].p._mdf||n[19].p._mdf||n[20].p._mdf||n[21].p._mdf)&&(a=this.getTableValue(n[17].p.v,n[18].p.v,n[19].p.v,n[20].p.v,n[21].p.v),this.feFuncG.setAttribute("tableValues",a)),this.feFuncB&&(r||n[24].p._mdf||n[25].p._mdf||n[26].p._mdf||n[27].p._mdf||n[28].p._mdf)&&(a=this.getTableValue(n[24].p.v,n[25].p.v,n[26].p.v,n[27].p.v,n[28].p.v),this.feFuncB.setAttribute("tableValues",a)),this.feFuncA&&(r||n[31].p._mdf||n[32].p._mdf||n[33].p._mdf||n[34].p._mdf||n[35].p._mdf)&&(a=this.getTableValue(n[31].p.v,n[32].p.v,n[33].p.v,n[34].p.v,n[35].p.v),this.feFuncA.setAttribute("tableValues",a))}};function SVGDropShadowEffect(r,a,n,o,f){var y=a.container.globalData.renderConfig.filterSize,x=a.data.fs||y;r.setAttribute("x",x.x||y.x),r.setAttribute("y",x.y||y.y),r.setAttribute("width",x.width||y.width),r.setAttribute("height",x.height||y.height),this.filterManager=a;var b=createNS("feGaussianBlur");b.setAttribute("in","SourceAlpha"),b.setAttribute("result",o+"_drop_shadow_1"),b.setAttribute("stdDeviation","0"),this.feGaussianBlur=b,r.appendChild(b);var _=createNS("feOffset");_.setAttribute("dx","25"),_.setAttribute("dy","0"),_.setAttribute("in",o+"_drop_shadow_1"),_.setAttribute("result",o+"_drop_shadow_2"),this.feOffset=_,r.appendChild(_);var S=createNS("feFlood");S.setAttribute("flood-color","#00ff00"),S.setAttribute("flood-opacity","1"),S.setAttribute("result",o+"_drop_shadow_3"),this.feFlood=S,r.appendChild(S);var A=createNS("feComposite");A.setAttribute("in",o+"_drop_shadow_3"),A.setAttribute("in2",o+"_drop_shadow_2"),A.setAttribute("operator","in"),A.setAttribute("result",o+"_drop_shadow_4"),r.appendChild(A);var C=this.createMergeNode(o,[o+"_drop_shadow_4",f]);r.appendChild(C)}extendPrototype([SVGComposableEffect],SVGDropShadowEffect),SVGDropShadowEffect.prototype.renderFrame=function(r){if(r||this.filterManager._mdf){if((r||this.filterManager.effectElements[4].p._mdf)&&this.feGaussianBlur.setAttribute("stdDeviation",this.filterManager.effectElements[4].p.v/4),r||this.filterManager.effectElements[0].p._mdf){var a=this.filterManager.effectElements[0].p.v;this.feFlood.setAttribute("flood-color",rgbToHex(Math.round(a[0]*255),Math.round(a[1]*255),Math.round(a[2]*255)))}if((r||this.filterManager.effectElements[1].p._mdf)&&this.feFlood.setAttribute("flood-opacity",this.filterManager.effectElements[1].p.v/255),r||this.filterManager.effectElements[2].p._mdf||this.filterManager.effectElements[3].p._mdf){var n=this.filterManager.effectElements[3].p.v,o=(this.filterManager.effectElements[2].p.v-90)*degToRads,f=n*Math.cos(o),y=n*Math.sin(o);this.feOffset.setAttribute("dx",f),this.feOffset.setAttribute("dy",y)}}};var _svgMatteSymbols=[];function SVGMatte3Effect(r,a,n){this.initialized=!1,this.filterManager=a,this.filterElem=r,this.elem=n,n.matteElement=createNS("g"),n.matteElement.appendChild(n.layerElement),n.matteElement.appendChild(n.transformedElement),n.baseElement=n.matteElement}SVGMatte3Effect.prototype.findSymbol=function(r){for(var a=0,n=_svgMatteSymbols.length;a<n;){if(_svgMatteSymbols[a]===r)return _svgMatteSymbols[a];a+=1}return null},SVGMatte3Effect.prototype.replaceInParent=function(r,a){var n=r.layerElement.parentNode;if(n){for(var o=n.children,f=0,y=o.length;f<y&&o[f]!==r.layerElement;)f+=1;var x;f<=y-2&&(x=o[f+1]);var b=createNS("use");b.setAttribute("href","#"+a),x?n.insertBefore(b,x):n.appendChild(b)}},SVGMatte3Effect.prototype.setElementAsMask=function(r,a){if(!this.findSymbol(a)){var n=createElementID(),o=createNS("mask");o.setAttribute("id",a.layerId),o.setAttribute("mask-type","alpha"),_svgMatteSymbols.push(a);var f=r.globalData.defs;f.appendChild(o);var y=createNS("symbol");y.setAttribute("id",n),this.replaceInParent(a,n),y.appendChild(a.layerElement),f.appendChild(y);var x=createNS("use");x.setAttribute("href","#"+n),o.appendChild(x),a.data.hd=!1,a.show()}r.setMatte(a.layerId)},SVGMatte3Effect.prototype.initialize=function(){for(var r=this.filterManager.effectElements[0].p.v,a=this.elem.comp.elements,n=0,o=a.length;n<o;)a[n]&&a[n].data.ind===r&&this.setElementAsMask(this.elem,a[n]),n+=1;this.initialized=!0},SVGMatte3Effect.prototype.renderFrame=function(){this.initialized||this.initialize()};function SVGGaussianBlurEffect(r,a,n,o){r.setAttribute("x","-100%"),r.setAttribute("y","-100%"),r.setAttribute("width","300%"),r.setAttribute("height","300%"),this.filterManager=a;var f=createNS("feGaussianBlur");f.setAttribute("result",o),r.appendChild(f),this.feGaussianBlur=f}SVGGaussianBlurEffect.prototype.renderFrame=function(r){if(r||this.filterManager._mdf){var a=.3,n=this.filterManager.effectElements[0].p.v*a,o=this.filterManager.effectElements[1].p.v,f=o==3?0:n,y=o==2?0:n;this.feGaussianBlur.setAttribute("stdDeviation",f+" "+y);var x=this.filterManager.effectElements[2].p.v==1?"wrap":"duplicate";this.feGaussianBlur.setAttribute("edgeMode",x)}};function TransformEffect(){}TransformEffect.prototype.init=function(r){this.effectsManager=r,this.type=effectTypes.TRANSFORM_EFFECT,this.matrix=new Matrix,this.opacity=-1,this._mdf=!1,this._opMdf=!1},TransformEffect.prototype.renderFrame=function(r){if(this._opMdf=!1,this._mdf=!1,r||this.effectsManager._mdf){var a=this.effectsManager.effectElements,n=a[0].p.v,o=a[1].p.v,f=a[2].p.v===1,y=a[3].p.v,x=f?y:a[4].p.v,b=a[5].p.v,_=a[6].p.v,S=a[7].p.v;this.matrix.reset(),this.matrix.translate(-n[0],-n[1],n[2]),this.matrix.scale(x*.01,y*.01,1),this.matrix.rotate(-S*degToRads),this.matrix.skewFromAxis(-b*degToRads,(_+90)*degToRads),this.matrix.translate(o[0],o[1],0),this._mdf=!0,this.opacity!==a[8].p.v&&(this.opacity=a[8].p.v,this._opMdf=!0)}};function SVGTransformEffect(r,a){this.init(a)}extendPrototype([TransformEffect],SVGTransformEffect);function CVTransformEffect(r){this.init(r)}return extendPrototype([TransformEffect],CVTransformEffect),registerRenderer("canvas",CanvasRenderer),registerRenderer("html",HybridRenderer),registerRenderer("svg",SVGRenderer),ShapeModifiers.registerModifier("tm",TrimModifier),ShapeModifiers.registerModifier("pb",PuckerAndBloatModifier),ShapeModifiers.registerModifier("rp",RepeaterModifier),ShapeModifiers.registerModifier("rd",RoundCornersModifier),ShapeModifiers.registerModifier("zz",ZigZagModifier),ShapeModifiers.registerModifier("op",OffsetPathModifier),setExpressionsPlugin(Expressions),setExpressionInterfaces(getInterface),initialize$1(),initialize(),registerEffect$1(20,SVGTintFilter,!0),registerEffect$1(21,SVGFillFilter,!0),registerEffect$1(22,SVGStrokeEffect,!1),registerEffect$1(23,SVGTritoneFilter,!0),registerEffect$1(24,SVGProLevelsFilter,!0),registerEffect$1(25,SVGDropShadowEffect,!0),registerEffect$1(28,SVGMatte3Effect,!1),registerEffect$1(29,SVGGaussianBlurEffect,!0),registerEffect$1(35,SVGTransformEffect,!1),registerEffect(35,CVTransformEffect),lottie})}(lottie$1,lottie$1.exports)),lottie$1.exports}var lottieExports=requireLottie();const c=getDefaultExportFromCjs(lottieExports),v$1="5.12.1",fr$1=60,ip$1=0,op$1=271,w$1=800,h$1=300,nm$1="Comp 1",ddd$1=0,assets$1=JSON.parse(`[{"id":"image_0","w":250,"h":175,"u":"","p":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPoAAACvCAYAAADUr8N5AAAACXBIWXMAAAABAAAAAQBPJcTWAAAAJHpUWHRDcmVhdG9yAAAImXNMyU9KVXBMK0ktUnBNS0tNLikGAEF6Bs5qehXFAAASN0lEQVR4nO2dzY7kyHHH/zR0NOzxyYAMyOkXkOYFJHH9AJoWfNfU6GLoop19gRnsE4zmCbq0Fx9n1ydfjObOC+xofZaqZMAGdNH0QbYBff19KPZUFsmqSkYmmV/xAxrNrmaSwSwGIxgZmdGQfIG8+bppms9jC5EKJA2AFsATAAbAY+vf+/7nDsBbAPumafYripctJJ8D+CsAfwPgUWRx5vJ1Q5KxpfBk2zTNs9hCxKZX8B8B+ATuN2IH4FOowl+F5A6HB2eOPPlGbAkUP3oFNwBuMf9GbPufLclPVdmL5b8bkhsc3LwWebkkexws0uumad7FFSUOlpt+G+BwewA/rLUvr0HyBsBTADexZenpALwD8CWA+yv7/rJ52LIsw/cAPEO6bsrnAL4A0NVsgSxX/dOAh90D+Kjmfr1E3+fA4eH6tP+9JlscFLsDAO/viaQh2ZK8Yzq8IfmYx86uFh6+n5sF+9nEvsbU4Xo6siO56c9nlrwYQ/LFwhdzjQ315vsADzeYlB3JVzx8p7fn+jv2NeYCl9OPOx6+Z7P2xbQXboyleE+14if038WdsD9PHpg8PshvB/vttM/d4VE/QrDj2gq+8AW58Pi6VHXh0f9nbx4evtdXg/03615Z3jCMbjw/9x2tDs9bgdDEfaolCOXW/MW1vuyPvbPa7LT/58HpB6YLu2Tv9/6ingsuyoW7JC86MpRbDON4/M2gnXpUM+FBL+awSvDzL6QN+9D+5wB+GEyaIz/XIZ5Jvido03nsq4ouYztjv0/WuNfFig58UPZ3CK/sXeDjlYKkn7+YeSPZ8wa+Izhf1fR9/aXDrlsAq2Ujeik6cKLsofLNr2X5VAmPCU1z6Vx37L/Lr6yP1KLLuJZd+A4rKjkQQNGBDzdIB3eX5RL36rZP8gjzU5TvMf/B+XZwTmU+1/r82dr3eBBFBz4o+6c4pFEq4TGCNr6z0lTRw/MRInitwRQd+KDs1U8ZXQiJ0u1XaqO4sUWkKcFBFb1nD+BnHu0f6dDaJN8StNF4R1pEmwocXNH7C3ntcQh1F+Oi/e/PVBDz5epSWCxh0R/wceH1ZouH9r0/U334Wcwg8yKKbkXh98JDmECiKPOxb1J1/WUM8w+ix60Ws+hWFF7C9wOKUgr/udJ5bEXfr3TOYuBx1R+b6IukLOm6AwerLrEKOjV1jKQfjaCNHfRTiy7DfkeP+m7+wKKK3j/FtoKmbVBBymAtpfsHa/sXK52zJIaBuKjv5g8sbdEB4OfCdpp+ecpe0Eay/NBwHXhlHt+2trexhBiyhqLf43SihCv6nu6PmbPzRD69rgg7g77/7IlHyczCXFzR+wv9QtD0Rt/TRyztvtv59Pp+Pp9HOHpEeyTkEa1h0QHZtFMDHdP9gDVLcC5mxr4nbnsq1igj7PUCblPqv7UUHZC9rzwNLUTmiEYwZuxrvy69EZyrWnrv0x4v/9dIokyyiqKr+x6Mr67vMuLvXXaaGP/9WnCumrHd9ndI7NVnTYv+DvPfWQzUfbeRKJ+rRX8EDcT58ANr+01KbjuwoqJbabFz+TisJFmzF7RxTT6y3y87wXmqZcJt/yySKGdZ06IDsjH1NJfBjYPEHby6Ms3EsNDcdeZqx+DoDXXRpLjA2oq+h8x91+SZI52gjUv/tda2JO+hZmxvKMmH5KqKbi0RPZcnatW9htiurebaWtv6bj6DCbc9yYfk2hYdkLnvm9BCZIzLUsJDLpZjwukwZnKBpMQxSNxtB+Io+j1kQaU2rBjZIrG411z31tp+e24nZRLbbU8m5XXI6oqu7nsQJMreOny+R0Jpm6kz4bZ3cSS5TgyLDsjc95vgUmSIxzDl6D19wm1PKm0zAwwycNuBeIqu7rsfIbMMW2tb3fZ5PLG2k3XbgUiK3nfIraCpuu8H9oI2BuPx9HZwTMlxq6S/DzfWR3dxJHEjlkUHZEn/6r4fkcQ5PqRpqtvujcHxwdkB+GM0SRyIqejqvgvxmCT00cAjaq1tddsd6fvQTs3+96Zp/iuSOOlDcjOzaPxqheNTh6QR9B1JPu7b/9T67CvtU3cGff9/JP8ytkzXiGnRAdkw0Q10RtsDnaDNQ/KMPSykSTLzsPMSftE0ze+iSeJIbEW/x3K520XTK6ZkmPJjjOcPJDfbKlU4dtt/FUmUvKDMfVdXEwDJxzLvna+s7TvtS3d46ra/J/nN2DJlAT3fNWum77s7Yf89sIl9HTnBU8P0KrY8rsR23R/wGiqqld599x2/7fwlqQOOhyQlIx9RiK7oHkNFz6guJ+C3CGGSUyoTp+1/75FRglF0Re/pBG0MNPoOyPMRAOC1Rttn0VrbWSUYpaLogMy6VL8ctGfVWn1QOjLhtmeVYJSEouty0N5IV4XRuQPzaPvfe2TktgOJKHpPJ2hjoFYJkOcjbKD954od/M3KbQfSUnRAq7mI8EieAbT/rsLxKrlZue3JQVnyzE7dT698BO2/K/A0MSnLZK3ULHoHrebigySgaaAzAq+RdBUWF5JSdK3mIscjoAloUO4sE257UsUTs4Vkq+6njN593wld+OpTiqcY3I93ud5nSVn0nj20mosID48IAD7O9SZemOSrsGQLT2dXuXKrN6rXjDZq/53CsYdkYsskJUWLDmg1Fx98UmLbcGIUgUEmyzlfI1VF1/XkhHimxL7M2WotQBZVWFxIUtG1mos3nbCdgQ5VAsirCosLSSp6j1Zz8WMrbKdBuQMGhbjtQNqKru67Hzthu01IITKmGLc9eYTR9+qXg6Y8HfaB57GvISZ9/723+sPElsmXlC06oO67lNazfe3uu8FpFZbsSV3R1X2fCccLJEgwqLQPJ/qviFV4klb0voNfC5rWHH03OFVS6bpwNffhxtqWLuqRFEkrek8naFNlNZdeMe0gUgf5mHqVfYjTVGpdPHMtKF+7fBNb9rXhOAh3Q7+JLtmsWx6CiXutjS1TVVCruTgx6Kf3D9cv7D+yslmBHFdhMbFlCkUOrjsgr89WjevJcRDplRVE6oSHNagrKNda29sSgnAP5KLogFZzuYbB6Y06XCBhKzxuFUNtEw/KbKqwuJCFoms1l8twOgh3//CHx+gFUJdn1Pa/98hsOedioDzbq/gFKSb6pj2zz07Yh7elPzB5Gsd4EVue0GRh0S20mss0rbW9x4Q18py+uhG2ywJmXoXFhWwUXau5TDNxk14qLtB5nKr1aJsDbf97D3Xb4zLhorpSrPvO8WKa5sK+pnfDJexKfWCS/Kl1ncW57UBGFt1iK2hTpPvO6SDcWTyDcgYFBuWoVVjShFrN5QN0CMKdafOVoA/JAoNygz4s8j4B8rTonaCNQYHWCA5BuCGeVn2D8vrxR9Z2dsUTXclR0QGZ+15UNRfOC8IN6WCNs8+kFbZLDmoVlrShVnOZFYQ7016yek9R/cgCiie6kqtF36Piai4cW/Ot4DDSMssG5Vh1O0Va14VLEcqGiW5LeGpTEIQ7c4w3gj4kC1iXjwVVYXEhV4sOyAJKm9BCRMIOIHUQJHh4Vl8tYVEKg4KWc75Gzope5XpyHBcW8HE5O8izwHLPTdDiibnACpeDpmcQbuJ41QXlWJnbDuRt0YHKloPub8iX1kcvz+w6hxqDcgYVue1A/opeo/veWttvA7ic96hvUYrqqrBkregVFmP0DsIN8QzKZbcoRf+9f2J91MWRRJkFT5Me5mBiyz4HjssEtYGPvZvqJAduc+pLnsY47nKS3YesLXpPLe57i6P13CPgnOlaFqXolfqJ9VEVbnsxkHwhsETZRN85Xm88+Jxp+hVm3ISWZwkmrtHElkmZAeXuexYpsQw8pHbmHMUvSsFDQYsHsnnQh6AE1x04uO+doF3yis7x4hKLlAkqfVEKjucHqNueIyy0mgsD5LXPPFeRi1JM9KOJLdOalGLRAVnVyxyGh+wZVh0WXLiw8EUpWmv7Z7GEiEVJin6Pwqq5cDzmu4a72aGw/HdOVGFRtz1jWNh6clwhCHfmvEXlv7Pg4omulGTRgYLWk+Myee2ulJb/3lrbr2q05qUpOlBWNZfW2v5sxRvUJ/89qfRiVlCFpUpYgPveu5p2EtDd2vJRnptAJpSfwEqWc64OyjO8Ur05yQWH1K7IsBP25au15T0HK6jC4kKJrjuQfzWX1tp+hwi1wHzz35mA5aRWYSkbZuy+c5zXvoksy/txVzkRTe6B/El9v0pAmLH7zkhDahfkyXaojadxjmrddqBc1x3IsJoL4w6pncNnqC3asCW1Cksd8HSmUhZWiGNPJAUPw2dW222s/mRFVVhcKNmiS4JYBnFntA2XipLWRwtGH5STWvVNOElmY6c2v6kxSaYahJYoihXigktF+UK/obZNAvKatWVQVoQZrSfH05GC5FxNykYyyAivQ6x0XbhLlOy6A5msJ8dxmubrBF3NDrJXCYP1X4e0CkttMINqLkxsSO0cwr4kV3wdorrtdcLE3XeOq5q+SPXm9OhLcqURBKrbPknprjuQh/tul4lac5baXHxmta2VYlxdFRalhwm774w8S20ulFv13dLXRnXb68bj5jQLyzW8MdslzxeCCZnnsFlYNnXbz1CD6w6k674/xmlVz/3C5/PGc1bb0otSaBWW2qGsmstiVoEJzVKbC/2s+iJBOY4TjswS58mVWiw6IJvU0GK5iRkGR49BWoAiCh5VbIHlJg4ZHL+rbqFzZEtNii5134NbII6rr+S4YKE0//0mtLXtj2c/QFJMOFLWgoksSMECqobQb1bbZgFZsu7PpanJogOyai4G4d13e5baIrXUlsazqsvLwMpoe13bgMdVcoTjAJgrwVYnYYZDaueYuJY5BHklmvhO2xDHVTKHkd13FjbWK+xPMlD+O7UKizIFx+9zrnhbIGY8pHYO+ll1E+D89oOm6nXhLlHbO/oDMau5tNZ2F+iY0fAcamt9zk2twqJcghHcd46rryQ7S20ujJT/Tl3OWbkEI7jvE+c0AS8pKvQbaru5foaz51W33ZFaXXdgffe9tbY7j+Mkh+dQ21PJQ4/qtisucEX3nRUMAXHloTaq2z6Lmi16J2hjcJxtNrdd229HqaW2NJ6z2iSekr2c862mvF6mZkUHVijGyHFee8l52J2w3az8d2rxRGUOXMF9Z8FBuCFcKf+dWoVlNrVb9A6yai7tjP1tFzOFWmqLsWJQTquwzKRqRe9vkE7Q9PsuN2W/zzPro7cV3JT3kI1otHCYPEQtniiiakXvkcyr3jjuZ3CcWdWhwCDckP5B9oWw+ccOD1CD0z6NXp8uB1TRD8q3F7RrL/2T4xLINa1h1kHWpxuHfbQKiyKDCywHzcpnVQn7lLwQlKMu56z4wAWWg+Ygr33Fy0kCjz7dnetXFjbFd03UdT8QdDlojoNwNQaMpEE5g/NBOa3CIkQVHV5TLc+tU25wul57dQGj0EG5iYdnJzy2UjMerqYZHKf4vHZXGDD/neq2e6EW/UhI9/3hs73wmEUQeFEKrcKihIEBqrmw8iDcEAYIylGrsHijFv0Ur2ouHL9HfuYvUvb4BOVaa1ursHigin6KbzUXg9MgXPV4BuUegp1ahUUJCz1mtFGDcJPQMyg3+NvEvp4cUYs+xqeaS9v/vUfFQbghnkG5V9Z2llVtlASZsMyu2Bar+iDckAnLLKGNfR25ohZ9QG99JDPajLWtQbgx0qCc3X4fRpT6UEWfpovUtlg8g3IAsNUgnBxV9PNIrY9Ghc/TQW6Vfx1OjPpQRZ/A0/pIgnlV4BmUe0rymwHFqQpV9PN0gjZFrwkXCEn8AzjkKvwupCA1oYp+mbnWp4Y14Xy5h9zr+VNIQWpCFf0MAve9g0aFr+KzUmzTNP8TVpp6UEW/TDdjX51R5U4naPPn0ELUhCr6dbaO+3ULylAi25n7a5DTA1X0C/QW+kuHXbtlJSkLYVKSpr8qy0G3WuptbDlzg/Mmuvwvyb+NLXPOqEV3Y3vhf3toEG42M8fU/6Vpmt8sKI6ijNYrG6ITWITQfaLLP8aWNXfUoruxx3mrrSV75dzjenzjt3CLkygXUEV34EIxxg7qtotxDMr9W9M0miijrMMZN/N5bLlyh9eDnf8UW0alIjgdJTax5cqdvl9vzyj5f5D8RmwZS0Bdd0d6N/MWx/f1bTxpyuFCrsIfAPxz0zR/XFciRVEWYcJb+jPJH8eWS1GUwPC4+u7vSf4ktjyKoixAb9V/TfK7sWVRFGUhSP4dyb+OLUep/D/ul90yOfAoVwAAAABJRU5ErkJggg==","e":1},{"id":"image_1","w":184,"h":163,"u":"","p":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALgAAACjCAYAAAA5ItSfAAAACXBIWXMAAAABAAAAAQBPJcTWAAAAJHpUWHRDcmVhdG9yAAAImXNMyU9KVXBMK0ktUnBNS0tNLikGAEF6Bs5qehXFAAAL7ElEQVR4nO2dTagkVxXH/xVHg4hkXAgGNxVEwZUvuFEMSUdwJSQjBlwl6eAiC8GZbNTVDENw4epl3Cr2iy4lzESEuBBe+4FxozMEETFgP4T4QYR5StSJmvm56OpMdVd/VN1b1fdW3fODYXp6+ladqjr973PO/cqATNJTkh7X8DmV9EyWZSehDYkd4KKkh/d0utyj7dnizzruySQJuFvSX7Z8cEjcZw6+G+BY0ii0HT5kWZadKV68Cbwg6YuBbTKMXZxIuiHpuqRXNP9VPtn04WzxAviUpHfuOPhZzX9OHtL8290XxT+RdE3S85JOTcF3Axxo/owfVXglvybpRc0du9Hzy3Z/ZD1ArrmzPyjpGcXp7EeSrsic2pmV53x5j6deOPVUkoI+PyAHRsAxcXAVOGD+cIwWYP6Mc2DS8bObRPvsuOPoXd+EbYyjvDkDofSM22ZCrI69CmEU/WZxzjz09Q+d4vkeFPfcl/7+2hY3YtzCTajDKPT1pkbhmD50/mt7V5cHLxKDqeYdBjc6PNXD2lIqMjrjVPNOwqZMJd0vaTqY5J/uEpTjrlXA2EzxXGcNntdksM+Lbpz8QujrSh3gMHnnXtCBkx+EvqbUoV5VZfjOvYDmP2vbyENfT+oUz3MbV5N7Tvhn4DD/kuShryV1ajh4Hsq2TqsoO3DNwJcYTBY+XPY15HYtwRy8VEK85nMcU/CoOZJ0krQItRCq5KGvIXW2hCh5aNtChigLTjX/phv9Zd1I0kt7tyJWaiQp2xiFtj91qA7HmMWg3lIcCr7A9Rv/YKtWGC58bOXfl5OOu9fhoeLp1Vgjonhu10vP42ZMzyMmBZfcYvFzbRthNKbcm3xo6r0B3Csqo9C2pwrVbvo8tE1lYlPwU7nVxR9t2xCjNuUc6CiUEb0BtwkSs9iUIwWoxt+j0DatEpuCS9JLkm41bJPLb3Ukw51F/H2iCCedROfgWZb9VfNlKJrypKn43nmk9HpiyWVNgA86hCnRJThDpghPjmMOT6QIFVySsix7TdIvHZqOWjbF2MxZ3bnfNxRheBI1wOcdFHxmKr4fgIul+34xtD29A7gbuO3g5DaFrWOozsjKQ9u0iShDFGm+4q2kFxyano/5hg+EXHeqVtNgVvQd4BMOCh61ogyBlfBkHNqe3gLcBbzh4ODj0LYPlSI8KS/Zloe2aRvRhiiSlGXZbUlfd2h6KfYb32Ny3ZngMA1nxkAAPuAYptgow5Yp1Puq3eOWAf7g4OATU/F2oTpmPw9t0y6iDlFKfM2hzVhx7jrRZ0al10eBbBgewHuAtxxU3NYtbAl60jXfW4DvOTj4rA8/o32A5fCkN/e1LyGKJB1qPiGiCbmWp1MZ7vRy5GCfHPy65rO379N8ybdpzXaP9kVtYqW4f58rvfXTQKYMG+AjC2flzq5fF9i9Uq2puAcsz5W9boLREcy77o9Z2WyK3XsBHQY0u/dgIwf3B/DbhdMuVLx4f6Ho63Yb6E1SFBv0aOTgIAC+suK869R83Y4D43BW95eVe3lsDt4xwL3Af1ecd7JGzQ9YnvFtK2A5gI0c3D/AD9co9CY1n5T+35LNBtCzkYODAXhsg4PDyuaiK05uyWYDgHOl+3psDr4ngHcBf9vi5JM1Tn4VmAU0u1dQ7Zq3kYP7BPjmFgevOLnRDJa75qNaMTYJgPt3ODhYYukMy/0KVvsOAXCjhpMfm5M3Axs5GAfA+RoObk7eEJa75md27wIBvB94s6aTT+xB1QPrmo8H4Ps1HRyK7v3QNscM1a556zsICfDZBg4OK3VyYxmsaz4ugDPAnxo6+Si03TFSqLd1zccG8I2GDn4T++mtQA9nze+iTzN6tnHU8PNnZYsDraP8pZ+GMsJYA/ByQxUHi8ffBqt9xw3wtIODg4UqkqxrPnqAe4B/OTi4dedLAr5cuieDqX0PJQZXlmV/l3TVoek5Jb71CTZrvh8An3EMU2YpqzjLte9BzZofjIIX/FjSHx3a5Upbxcu7FV/ty6I+SQI866jig1KuujDwWfNDU3BJuiIJh3YHSnM12ly2306/AH7iqOKToSnYNqguaD8ObZNRA+DTjg4+uJ/obTDArvlVhhiiSNLPJL3h2HbUoh2xMyq9fi6UEYYDwHccFXw2RCVbBeua7zfAhx0dHBLovqenC9o3ZaghirIse1XSq47NU9gt+YnS694saG+UAL7koeJ5aPu7goSmpQ1WwQuOJN12bDtqz4zoyLVc+266NYwRC8CPHBV8kHEpNi1tWAAPODr4IH+6SaD2XWboIYokvSzppmPbISabo9Lra6GMMFoE9wFYg1I4Eqx9p6DgkvQtj7ajtoyIhFHx90nxxxgCwG8cFXw2FBUnwSXZUlFwSXrWsV2uAQyjxaalDRvg3VQ3r6rLpO8qTqJLsiWj4FmW/VvSS47Nxy2asncKZy5PS3veuuYHCPBxRwWHHneIkFjtu0wyCl7wa0mvO7a91GPHsCXZUoHlSkJTetezSYK176QB3ufh4BN6puIkviRbaiGKsiy7KelXjs3HLZqyL8rjvg9TSy6Tc/CCr3q07c2GqFjtO02Y75R8yzFMmfXlZ55Ea99lklTwLMv+I+nbjs1zLVclooRq7fvF1MKTpAE+6qjg0INkk4Rr32WSVPCC30l6zbHtWPGPT7Had+oAj3uo+IXQ9m8Cq30b0tu7QrgyI9KffRKvfZdJOURZ7ArxgmPzXPFOhki69m2UAD7poeLR7e9Ddc2TUWibjIAA7wD+6eHkUZUMsdr3EkmHKJKUZdlbkg49DvFkW7b4Ujhz2R6rfRsScK+Hgs9iUUms9l0heQWXpCzL/izpFcfmueJJNh8pvZ6GMsKIEOCch4oHTzYL9b5esmkU0h4jMpgPwLrt4eRBk02Wk8tZ6C9cLFiIUuA5AEsKmGwWznyp9Jat921UAT7koeDBVJNqchlV6TIkpuDLvC7p945tc4VLNss9l1PZet/GJoBDDxXfe7JZqPfNkg29mXFkBAA48HBw2HN4AIxXzp/v8/yxYyFKlVP5rZu9t2STas/lpQ0fNYw7rFHFJsz2paIslwbBat9GHaiOyGvKeE82HpfOebyvL5YxAIALHg7eebJJtTQ47vJ8xsBY40BN6SzZpLpTGl1/ofqKJZnbOfJo23Wyebn02pJLozn4lQxnXanqGvW2nssNmIJv51TSDce2uTro2Sy+NE+V3prKei4NV/ArGV5vW8WpDusdtXl8IzHwLxm2Fj5QLQ3O2v4CDQ0LUXZQDDudeBzifEumSNWwx4bFGv7gl2y2svDOGvXG1Hs3puD1OJV7yfCs2kk2c9k+80ZXeKq4V7LJ+o6dUXtXZyTPhhChCc7JJtVe1WOfL0xKWIhSkyKZe97jEOddnLJo88TK27aRq9E++JcMc8dzeh8nVUzBG1Co5uVdn9vCqIU2Nu7E6I4NilqXWRP1xUqD3piCu3Hk2C5Xs61Pci0r+NTxvIZRH/xKhpM6KrxBvUfdX92wMAV3w2di8rjm51Y7iKaSThzPmSzm4A4UyeYVj0OMtv1nofCPrLxtpUFjf+BXMpxtC1Ow0mBrmII74lkyzLU92Ryt/NtKg8b+8VTxyTpVxkqDrWIK7kGh4m0nm7msNGjEAn4lw/HKsfJC2cuMwlyZYWijU9ZlRin8wEYNGjGCn4oflI6zOsF5HPCyBoHF4O3gs7zE+UK5c1UXC5r6GGUYrbFGfZuQU10p9iIWnnhjCt4eU7l3pY8kPbjy3g+s59KICqrzJusyY7mefmzqbUQH/tufLBiFvpahYCFKu/gsL7HgRDZq0IiVFlT8YuhrGBKm4O1zKj8F/m5LdhgyB28dz1GGz7VoimF0A9XNWS25DIQpeAc4jjKcypJLoy84JJvj0DYPEVPw7mg6MXnakR1JYw7eEUWY8mLNj9uUNKN/UH9K2yi0rUPFFLxDChWf7vjYDVlyafSVGsmm9Vwa/aVGmJKHttEwvGDzZIhjc3Cj97B5yeVzoW0bOpZkdgjwAPAFSQ9p/ZzNs8DTwHv3bFoynAltwJDJsuznkgQ8Jukfkl7T/J7/QtItSf/LsuwomIEJ8H/mjL4tbNAumwAAAABJRU5ErkJggg==","e":1},{"id":"image_2","w":163,"h":175,"u":"","p":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKMAAACvCAYAAACRrm77AAAACXBIWXMAAAABAAAAAQBPJcTWAAAAJHpUWHRDcmVhdG9yAAAImXNMyU9KVXBMK0ktUnBNS0tNLikGAEF6Bs5qehXFAAAMq0lEQVR4nO2dTY8cVxWG34otViA5W4KtGyQQIBCTVTYIV8QiGxTbQkmQQJk2Wxa2ERs2Y2UbFmP/gm4LKTvk8ZpFV/gDHpDY0q0gISEhzYgdQsnLoqrdd7qru6vud9U9z2baM66qc2+fOu/9OHUKGDgkb8W2QXBDEdsAG0iWAG4CuBbZlL6cF0VxHtsIACCpABwBuBHZlP9ej2yAESSvAfgEwCMM84Z6J7YBGzyPbQCAXwzSGQH8DsBvYhshuOW12AYY8j6AKrYRBiwBzABcxjVji8eobYvK4CSukeh/A3ir+ZUCcAfABPHHPbs4A/ACQFUUxTKyLa00Y0cF4Bh1X4ZiBuAzAH8KeE03kHyb5GnL7xXJkuSc6TAlecT6ix4ErPtRkTzx2C8LkpPVtWK32RiSv2c9i971d9U4gM/OPMQFybtD7mj6u7lPh9wvryB5neTfuzSGa6ecOu7MQ8xJHgXojiA0/XjqoF8WrJ1bxW6TE0jeI3nS85jVHX7hoEMP8XI0na1Be4ecjq5fWEed0vBYRf9R0si2IdD030uDPjnhCB3xR6xDvbI4h8+B+fg6fQPWCtOHQY+bd0Lyj+wp0TvOo5pOcs1oxom7aPpu0bE/xjM+1CH5Bskv6EgGm06dOHTExSg7vgV2GzsaOeJQdmA+APBXONolaBaeKwBPXJwPdeLD0tG5Umdx4O+PACxN+mNIzvjc5RfenOsp6t0RW1Lb3vPJ53v+NgNwNtobk+Q3SX5JT2My1muRtliPZYcC909ilM25hxAZf45679JX9LkEcN/yHK+7MGQg7Nr/t06LG4Izfgjgha/Qr40fK4vTpJqg4YO2tp7BcJw4GEh+x0X473itvmtoOnPf9qUC29dpSxfnTj0yfohweYtL1ANwEwaVmWPJmxv/foIEciG9Q/JvJCcBr2czmVGh7IwF2xe9lavzJxsZSX4fwPcQNqP7EubRUbkzI2mU9tnVOi2AhJ0R9dpiFfKC2tqjCXccmpIqm8trTieWqTvjswgztEuY3QQ5jBtva58rZDJW/GHMcRjN962j2BuClvHiXdfXSDUy/gxxn/6rYHbXl06tSAuF9XjxEoDzIgSpOuNdAE9jLaI21zXZs74z4uj4Y+3z6agXuFew3ouOLnk0X+aJarcPWiS69HGdFCPjT+Emk8aWS4hUr1BYS/QSniYuKTrjHUSU6BXN9acGh45RqnWJnsb+boJA8iusn+JTsW0BrKR6NI8gNBJ9EaJtqUXGHwCYJXTnGa85OrYjJgrrTJ0KuSQSk/ylr8GxKTRbc1ykEt1taKLic61dD31eL7XIeBPprepXBscojCfHUV/c9jqxTM0ZkZBE65h8CcfOrQhPqX2uItkQB5Jvx7ahjRylupHoudaeSWybgkLy67FtaKP5YkwY7ESmpc3K9zWTkumiKP4Z24Y9zAyOGbJUv6d9TmETQlhBs5IoixARxTXclugyxHWTioyJc47+M32FYa453sB68mK6LdobccaOZJbJo0t0Hhk6Q4MZZPJwuw5jGeraEhn7kUMmj8J6aLFEwE0IccYeZCLV+WXoDJUxSzW3k2iDTr4kMvZnzFKtsE6iPUcuGTpDhmbbg/OUoyO332jgNUNHcARHmHTLCNt/m4hMm3EJs4nMe4f/SzT0G6WKZYRgAEeUycPcM3SGTousdSU5qW5pi4phh8i0HWNJui21z1UkGwQbOAKp5rZEO6+hIwSgRd66koxUt7RBxbJFZNqemcExD1wbYYE+w3da/FMIDM0K0y9iRiDN9ihJtLuQyGjPEmZJt6VjO0zQk2iXiPyYsDijJRaZPLcTiI66REuGzhjgADN5GKjMXR8kMrphiJk8ClczdJaxDFkhzuiAgZbP05Nonb6xVoiMhVQHX3NkwDJ3fZDI6A7TousxHEEhxzJ3OUGz7cGXIaWa22XuJqGuLQRkCFLNhLb/NhGZdotp0m3ITJ5S+1wFvK4QGiacyUNJos2LFhnsinepbrFN+b5mH0Sm/TAzOCaEVJfaZylzlwNMUKqZWIZOGxIZ/VDBLJNHObZjk7L5GazMXR/EGT3QbK1VBocee4yOH2mfpcxdTjChTB5GLHPXB4mM/kgpk0chUpm7PogzeiKx8nlS5i53UpBqRi5z1weJjH5JQaoVBlLmTpzRI4kk3eoS/UwkOmMspNpaTrmdRKscNMkbEhn9E/Od1Ue4mkQr5A4jbA9SkmiFNhghk6flmsphk7wgMh2O0Em3pfa5sjiPMDYYUKopZe6EfbTIZld6S3XLtZSHJjlHZDosM4NjTMrnSZk7YT8M8M5qDiCJdhcSGcNi+s7qssf/T6rMXR/EGQNikXR7u0d0lDJ3QjfoMZOHCZa564NExvD4zORRWGfoLA2vEw1xxsB4TrqVJFqhHz6kukWik02i3YVExjj4kGqFtURXSDiJdhfijBFo5PNjg0OP26Jj87s72q9eiEQLnbGQ6i355UC3/zaRyBgPl++slndFC3bQQSYPpcyd4IIWee3K0Z5zqIhNskJkOj62Sbel5bkEoYYWUk1JohVc0iKzXSk3jr3ggCUaEJlOhZnBMce4OrOeydqiYA3N3ll9wQGUueuDRMY0WKL/9uANDKDMXR/EGRPAIpNnxSgydMQZ0+GZxbF/dmZFRMQZ08E0kyeJd0W7QJwxESykOr93RZO8GduGsUOzTB4V225XdIqMJK8VRfEP38YIvaW68mNGwpB8I7YNucB+24OT2PYGheS12DbkRE+pVrHtdUkXmX7fuxWCTtek28qzHWlBsmC95aRi25ITHaV6EtvOoJB8t2n44B57HDLslsmjYtvpmkMy/evm54MxNj5xZnv+llcSLclvkfxCuxMlOgbkgFSXse0LCsk/bHTAVKJjOLj9DpcVg0+i7QXJ725ExdGOU1KmCQCbnMa2KygkP90hDyfikOFg+5pjGduuYJC8RfJ/O5xRomNAuF3MaTHm/m+bTf8WwPU9x3w05g5JiZZKt6NIou0Eya+S/M+eqCjRMSBNZBzVcy772IyM9wB8rcNxEh3DMLrnXDrDqw+ES3SMDOsJ44qT2PYEg+S3SX7ZwxlPxSH90SLRo9900GX6VwCKHsc+xPpdxoJ7FNYSfY4BVqLty2vAq5zF+wbHy561B5o+1YvF5/OcC8mf9JDnTcrY9o8NbmftjF6igbVMf2BxjscSHZ1Tap+XyECiAdQSTfJfFpGRzC3R0yPcLnOX1Sz6G2zfkO9DXpkkHuF2Eagytk1BoXnlfR1Z6rGE21Exq0c+VmPGS5jVCNR5iPVLcQQzFK6OF/OZRes4io6LnO5kl7RERTKTWfQKfdHbRXRUkLXH3jT9pXA1KlbIZRbdhqPoSOY26LZkR79PYtsVlUYqpg6ccUGJjp1o+vx5Sx+q2LZFZ8ddaoLMrg/QOOJpS9/Npe+wt4NMmEinttP0890d/VbGti8ZuPsxSRPK2O1JjaZ/d73hYC438AY0e3NTGwvp3KvscUS5edvg9pNpNjwXh6zhftWZSz/t4MAd3Jdp7h3N3TPnFWVsG5OFbiczZMZFAHh42SzbvukM3U5msux0drupVWw7BwF3L0GIQx6gccSHB/qjzKU/rKG7nZmsHJL71xJXTMfeD86h29n1itHu0jT9dXKg/Rxr+71Dt7PrFdOxfSHsPvEbvTp4g93v9r685EjGTaz39vct36yYj6G9UeHhtTIbBuuQXG/xdV15KGPbPArofrlHZ9qcX8VuZ1fYfz1WEkhcQj/jR52HqX9hrJ1wwn435jT1dg0Odlu2sGXOBKWbaydc9GyP7NH7gv4mNJvM2UhbrC+zufYRazleGLQhq8dOo0D3+9eHOGGgaMm1A56wX+3KTS6Y2ZN+JvQpgbeTxjEeA5i4OF9HlqifoPus+QnTZ4w3HFuhrgD2FuqSdGr7iF5UAB4VRXFueZ7R48QZgWgOqbN6cfg5gAWAz7Xf6498qubnLQCvN/9WWNdCdMkZakdcejj36HDmjEASDpkSMwAfiyN2x6kzAq8c8gHqcie5ch9AJY7YD+fOCLxyyLsA8nq1WD1MuA9gKY7YHy/OCFwp2TH3dY3EeALgqTihOd6cEbjikFOMu0LZPQDn4oh2HHr5uRVFUSyLoqgAvAP7olIpcoZ6CUgc0QFeI6POCGVbJimO8RoZdZovbQngTQw7Ss5QR0NxxDHAde6fzRZbaOZMMGlDcATNs19CsqDkHwYh2JhxH80XXaJeLE8loeAMwDPI5CQYSTjjCq4nOY9xtaRwKJZYO+GlOGFYknLGFZoklgCO4dcxlxAHTIIknVFHc0yFWsJvwy61q0Kd2fOX5qc4YCL8HyVuhWqUsuxtAAAAAElFTkSuQmCC","e":1},{"id":"image_3","w":95,"h":130,"u":"","p":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAF8AAACCCAYAAAAg7BQEAAAACXBIWXMAAAABAAAAAQBPJcTWAAAAJHpUWHRDcmVhdG9yAAAImXNMyU9KVXBMK0ktUnBNS0tNLikGAEF6Bs5qehXFAAAGPUlEQVR4nO2dTYgcRRiG39JNMIvoCqIiEnoh/hwkjgp63FEQvWWDRyHZIHiWnBRhQ25eYtCTtzWevK0JKHhxh1wVskrwIMKMClEXNCME8rPJvh66OtPTTs9Md1f1VzP9PbDMb3V99dTXVdU9nTSglIbkPpJPlC1/j8tgmoYxZhfACkkjHUsjIRmRfKFMWc18N7xWppDKr4gxpgegJxxGcyF5kOS9Rcs1cqIgGdmnSwAiAIcBLNvXSyOK9O1fF8BviDO9B9zNfJB8zhjzQ5E4Fki+BWBfsfC90Eka4gMrfAlAC8ARAKsONtsjuQHgAoCdMkF9wjCIHMgY1b6I5BrJTc/xf1s0tgUAD3hoszi2M9sATiEeWnzzMslvjDGvT1tgwT5+iXgMu2pfJ+NfC/UE7gwrPQKwgXpjXwTwKslnjTGXpypB8vExn0Wp3XbL824bVW29jfWs5zjHsUvyGskPSC5Oinfq1Q4HGXUK8e7smuUqEy7JFuLYxk2kHQDbAH5FvHrJchDAQ4jbWWav3wNwG/GK6B1jzFbB8uPxmF1FG5qOp03yas52N+znUZE6ONjrVwu2d4/kDZIny7Rn2sDWSinOZ2oxmTjaOdtbZ0HhE+qZdvi9wbgDvid5f9W6xwXkcg+IStS/OmI7myRbRbdXsN68DifJv0neJrlD8hx9nfG0gbhaP0cOBKz7kj6i/ojxkJblppX/D8kzJL8m+dio7VTuFdvYSxh9WF6EqSZcDib+7GR2FMC2z6PkArHcRLyMPwbgEIADxpj3fQUxbjd0mvk5dbXryPiceEZN+FdJ3mE8/u+Q/NB3AFXH/2jKerqhiM/E1sp0wK59/K6OyiOf8jl6jF0NQXxCpgP+ZbzquUPyDd8V501AleVz9MrmbEjiEzgYFhP5ZE3Z3/IoP81GiOKB/63EbtnHayT311Fx16V8jt6jRn43FGzM64wPtPYYj/9vknyR5MM+K86Kqio/u7oJYoKdBAfHQF3bAddJ/kHyU5+Vlj3tEOU0IL2CCHKcz4PxMHzZxr7H+Oh3Jfncx9UL2y42YiUfw/DB28d1HkQ5oA/gDIC/APwJ4HfEZz0BDH5McV2hK06nnr/icLu1YIzpkdwC8BNiL0Nt8HXdTq9K4VTWJ3QA9GYs6wHcvbrhJIAnAdwH4O6ZTueZb3u7h2o/4UUYzvrTsyg+RR/x+a9bAB5J3gwu823WH0+91amyvRCwifORfflF8n6olwuupZ7PetYn9AGcB/BS8oYv+d0yhUaM9duY8axPsAn0OYD3kvdCzPz0WD9rS8tp+CU5VglN/rHM645EEL6wiXQOwNtAePJPpJ6fEovCL30AzwBhyY8wvDy9OIdDTpL9X5F8MCT56Uyfm4k2hw6Ap0OS304935zHrM/wqI9zOy64IB2AT+xZgMWQMj9hG25PzoVKP0T5TRhyYIy5EqL8i9IB1EVo8vuY71XOEKHJr/VyP2lCk+/2HxMETmjyf5QOoE5Ck+/kx/dZIST5PekA6iYk+Y2abIGw5PekA6ibkOQX+k8j5oGQ5DfhfM4QIclv1EoHCEt+41D5gqh8QVS+ICpfEJUviMoXROULovIFUfmCqHxBVL4gKl8QlS+IyhdE5Qui8gVR+YKofEFUviAqXxCVL4jKF0TlC6LyBVH5gqh8QVS+ICpfEJUviMoXROULovIFUfmCqHxBVL4gKl8QlS+IyhdE5Qui8gVR+YKofEFUviAqXxCVL4jKF0TlC6LyBVH5gqh8QXzJX/a03blCM18QX/KjmsrMNCHJX5r8lfnCuXx7378yIg87DiV4fGV+GfnPO48icHzIb5UsFyV3y2wKPuSXHT7KdtrM4lS+zdyjFTbRqA4IadgBgCPOopgBXMvP3ky4KKtNGvedybfSTkz63gSWMHx3UGUSJCOSa3RDt0nZXxkr3yVntQOmwIrfcCyfJNvaAWPwKF47YBw1iNcOyGKlt0heqkF8wnrjO8CKf7dG6Wm22MS9gIOlZFdIfJoNzkknmLwPODgvfxzAKsL7pakD4Jx9xCzeV3FIvhXeArCCMIXn0QFw3j7uGGOuiEYzJVn5bcz+3ZivAzg0Cx0wj1cvHACwLh3ENCxkXvcBfCYQh2v2k3zKGPOzdCDj+A9kUpv3TthNOAAAAABJRU5ErkJggg==","e":1},{"id":"image_4","w":116,"h":122,"u":"","p":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHQAAAB6CAYAAABukHdXAAAACXBIWXMAAAABAAAAAQBPJcTWAAAAJHpUWHRDcmVhdG9yAAAImXNMyU9KVXBMK0ktUnBNS0tNLikGAEF6Bs5qehXFAAAIIklEQVR4nO2dvY/cRBjGH68IQkKKDokGIRFXlMlFoqJIDH8ASWgQBXBpaElFeZRINCEFBTSX0CJxBBq6u4SKAt0lokVraCIhoV3RIAHiofB41/txu37GX+Pd9yedbm9vxn5nHr/vfHjsibDBkIwLf+4s+Tnv/vcngLH7PHY/KQBEUZQ2b2l9RF0bUBcF8WIAVwBcdp93Kxw2F/cUwAmAx+5zsEL3VtCCgLsArgJIUE08hVMAhwAeAkhDErdXghZETABcA3BdyJ4WfsYARu775zANwbvIvFphDOAugPsIQNxeCOqE3EUm4l7JbN8gC5MPUbI9LFwwO8gumtzzd0qeMwVwx5072LDcCSRj97NHcshyHLr08VyHqKodCcnbJW3I2a/Tjt7iKmGX5EHJihu5yt5tsvLod4Ftr7AeQtJVbtyRrYkobLI1oroK2hcq5zYDuOo97D7aaGFdhVyn1kY2GlpVOPXWI0HY/ZDKUBlOw+uhUAmdhNeyUPfWQwYQZSrDaceiLCcMzCvPglNvVehvCHYFVrr/t/tW2IKoI6GcQUefBTgNsUOhkNd7Vcg5XJmPhPL24+LltONTlhH7HIYKeIh6EHS5qXcUhiTbmmBvBVcHJ70X1RXkQCjIUZAFqQFmzY3SpoYlqom5CPXebxhtqom5HOp9CbLr3q+HmMNtEDOH+rCNJJMujVXEJDesA1QG6p2kUev15CnmRgxNfGDWSVI4bK2unJi3TMzyeNZZ8+0p/eYuw+i9dYyru6FYd82GXg8xD0zMKUHVH/XGnSbmLK4OlVuIZBO9XlonqDaod5CGq+px4GFAjGxJ5Z6Q7VMEsGY1UPJ1vWWJkS0trYe6ryij3jqVPNQd5LZo703zzLWM4RZnlySGvsJ/Fuq3wkjr1ZaG+jxvtckGJ6iK/wm3DNY0Li0Vcp0wH4k2qum3Gtcs3RGzved1MuoD4BPzTh220eGkvi6G7OqWT8+h30TDTNgtE3ITaOOeY7jH9wwNF3bvi9nKh136NdSJaJBRgHrYnWne1nloAm28cwzzzqpMXthRknJ3YMw7u4P6MpW9PO8qD02geWcK8866eCCmv5R/WCqoi8nqGOeOTfHVxqmYfnIn6ywPjaHP6CtzkcZ6UiHtpB1dENTTO21WqEZcpFO9NAbO9tA98WAPLdzWTiqm3wWWC5qIBzr1OLmxnqGY/gIwJ6hnuD0072yEx2L6GKjHQ78V0xvlSMX0Mcl4XtBEPMgppq8lNbplaRt6TTyIhdvAmAjq2s9EzP+wTmOMBVI1Q9FDY5R/6ySgTyIbAp6Rb6co6EUx87GF28ZJxfQzgt4QM6sTyEYLDICZ1fAKx3UbY1Sn6KFK+wnYcCVIckETMZ86cWz4oTrZRNDzK1MtcmodolbwFvSymO+ReiKjFdJcULVDlNZsiDGH66jqHuqZ0drQdvAOuXG9dhgdMAY8nuCGhdu2iMX04yiK0oFHRtsxqB1iMf0pkHmoGqdTMb3hhzqUTAE/QW2GqB1eE9P/Cvi1oSZow3jOraeAn6BGO8Ri+kkb+lLtphhVicX0af7BPDRM1MUGk7n1AYDfajfHqIraIZosNjAPDQzPxXqTqVgTNDxiVJgbGMBjhbaY3tC4IqY/Lv4xgI0rg8GFW7X9vF+civURtP97XoZNIqafedDapw2NPfIY5UjE9Av3pQdn/cNol7oe5Ry4L9JlqVcg30k3SpGI6b+c/yL30FQ8UCymN9bzrpj+eNmXuaDqKj51aspYgQu3N8Vs95YtNPBtQ9Vln8ZqYmhRb4xVj6K418ApG5aObOhSD/R7fe3+WccbAJM1QseCHTuwjlFdxKihM5RTHIeeiAfduq0i66bRl3zRYwtEtQDGLGxgY4aih6qP2NvWVxVwdacOVbRX8NFjPzPRIMNBfWOGtd4JLM7l3hPt8ttmYsthWy/IpP4W62GZq8aYxcM7/YeJrPB6bGM9bHjblGW3z9Swe8376tkyXD3F0Madd1Hl8RPPK8jGpCVgC/vHLXiomzVSvfQD89LV0G//OHU5ytknp77FR1zLyTcQV5/dbqBOck80YN9EXQ5D2KqTNe1nue0wpA3o2XWY6DlOTHXn3luN1SH9ri7zUgdDdAh63IVp3KgeQL3JaqfenGFqB2lvm0WlHtlGbDOysYadZ7cFDzHJLu5aUV93tHWh19XRLVXMzuqJeiPfXI8tMOjXo+12kUAvjW6BXteLM35fNH5j29Nei5njIWq7vbiW8BBzxGwYGHdt+wIeoh4FWRBPPMsf9kW9raJSH5ockOzH+6C4SWGnBM52ZUz+NskXu7Zbgn73+8LqGKyhUMYyY/F/SX5F8irJqGvbvXAF3qW2fKUXU4SubGUWz/1O8mOSL3Rtc20Ihc85cHnirm2fh9OL9GRNGX4k+Q7Jp7u2uRG4ASG4xIX5l7sYX+na1lbIvW5Npcxz1LWwnN5dGp5h45DkhySf78rGTuHUW48EYQ/aFnaNkP+R/J7kGyTtdXqAt7BHzIZEcYM2rRJyzCzCvNzE+TcCkhc8hB25ir3Oih2oORHPGk8+Ivk+yWdrLHortD5GIvkMgKsA3gJwAcDrHoc5Rvaij0fu9xiY3X5kTvQdZE+cX3K/kyXH/AfA1wA+i6LoBw+bgqDTQS/Jc8gq900A1wBUGb+lS76LS+R7AuBzAF9EUfSkwvmNIiQHJF8l+QnJX4Rw7MsDZiH8qa7LXifBTkuRvIjMc2+g2ouu8lcNjAH8BOAPAN9FUfRzVRtDJFhBi7j28G9k9p5T82/T1l7/A1DcthLblKqqAAAAAElFTkSuQmCC","e":1},{"id":"image_5","w":173,"h":165,"u":"","p":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAK0AAAClCAYAAAAu/H0uAAAACXBIWXMAAAABAAAAAQBPJcTWAAAAJHpUWHRDcmVhdG9yAAAImXNMyU9KVXBMK0ktUnBNS0tNLikGAEF6Bs5qehXFAAAIxUlEQVR4nO3dz3HbRhgF8MeMJ2edcwncAVNB6AYSuYFYueZiVyCPK0guOcNOA3IHZAdi3ADZgTRp4OWA5YgilhSwu8D+e78ZT2RHlJbAp9XDYrG7IPk3gD8wzP7ov3sAjwD+BbA1H2OxWOz7LxMJ5xWA/0Z8fnPy31Nbkht0hbwBVMQS3oLkDwC+P/q3xvy5AvCj+XiJ84V6yQbAF6iAJaDFkE8i2ZgPr9AV8M8AVhhXyBsAnwDsVbwSBcnG/Lkm+SfJHYdZk1wd/SCIxGEKeEnydmABq3glHaaAV6YwVbySj5HF25rPb2K3W+RQvNcDCpfs4kUTu80ixxdurSKDZOUoMqjXlXzwaaThbmCvu1TxShJM8f45sNdVXJA0cNxFWqvClSRwXM5VXJA0HBXug+KCZMX0okML94MKV5Jget31wMJtVbiShJGFe6fClSSMLNwHKudKCkYWLlW4kgSOuzgju3HfJna7pXIOhauRBYmPw29AHGjCjcTFcXfODloVrkSlwpUsmcK9UeFKVkzh3qpwJSsc/viOClfSwfE3H1S4Ep8p3DFjuCpciY/jRxRUuBIX3YbCVLgSlyncDypcyQrdRhRUuBIX3UYUyO5x9iZ2+6VSHD8r7ECTbCQeul2Ykd0t4iZ2+6VCdJujcKCJ5BIHxy29dEqP7kgcdL8wU+FKPOwuzFwtY7dfngzakqkEprdsAKwdXr4H8KbkraTM8VlFbsap7WKx2MZuRFR0v2NGFr4giDk2qbm1tfW7uQ9OTKan/Args8PLrwF8ZMGFm6CfYjcgGex6lZ3rT3+JhUu/UZaQ7tm14+wFcDWZ9hS7i6t7x5e/RZe39uFaFN9RkawAvMN8GXeDbg/lLYDH0o5rMBy3ArlN0UNh9Mv/Q+zY9ahaIHsM+v9KLHoojE8burjM4ThnR90m92NOzJBddmzuazj4DFO4KtaQPE9KW8OJoPscDrLQi9fo6D4jrIqTQreHR9dUZp0O/WaEkeQq9nuYGsfN39CE+jnQL9/uSj9JHP4Yk6Z1zol+E2uK7l047Ae66KHAJNH9UfSDInsZvnwX8YHKr/FQ47c9vDyh5qHE95wdKt8+w8sXqSrYVNBvYk0xUxl5+ckPZdjU0C/fFnFhxvPRIErBVjWf1tEe3awuFx8AZN0Tmbb/ZvlfbwHsNSMrUXRbdTx6jxTCmV62iN8gxaPfhRmZ4cUK7T+sxWT1KtDvwmyX28mmvZdtYrdLmXYEk99+d3x5AyCbX6u0Z9k3EZoivug/sSaLGWHsj5pk0W45g/75NukLM/bHZZVjS0C3+aXHkrwwo33uRZJtFQeWkztGkr0X+xdfSf9WkJHoP7EmqZzI/tL/bUrtk0DoNwxGJvLEA+2xoIndLpmI5WSPsUuhOKhYUBf6x4So47dULKgTM40JtI87NzHaIhEww5jA/jNxigU1YWYxgf2bJK0KtkLMJCbQPoOrmeN7S4KYQUywtFGxoGZMPCawP7egVcFKsjGBigVyCROMCZY2KRbIE/qvph00JlCxQIYwhXLvUbirgO1QLJBh6Leo3S5EcVGxQMZg5JhAxQJxwQCP6Hh83+NYsFPBymCMEBNoiQXh39m89Aj5vB7h9wj6+zGFaz7349E//YVumSeR4egfE65HfB/FAgmDfjHhYUjxscBYIBHRf8GP9lLhsn8LOZuVbSRhDBATbIXI/mSdtQpWgqFfTCAti2hQsUCmRP+Y8GzBD/ZjQVLrKkgh6B8TbszXUCyQ+TBATKBigcyJYWLC7ujvigUyPfrHhIO1ClZmQ/+YQFYQCzT3IC2PcN/+CQA20NwCmRv762qNdaN4ILNjoauMS+HY3aZ1leQq46Eo06Zri27+q4trZL69qWSK/gt+KCbI/FjgZiS+FA/St4dfTLBOYRSZlGLCc+pp89F4vLYtqbdV0SaO/SdqXSyhmCBzoH32l2KCpIv2TTySWz50booHiWI/FnxGN5Kwh/toQoORC36IDMIX9vZioquMS8U4YG8vKiZIKjhwby8mvhmJVIIjV+umYoLERofVui2vGWP30tcXOYuOq3XT3juPoZgg450pvGbk66NvRiIVYYBNPJjAZiRSCQbaxIOJ7VkmhWLgvb0YaTMSqQgn2NuLigkyFU60txf91wVTTJA+TrzlJ2fajEQqwhm2/OQMm5FIJTjTlp+ceDMSqQRn3tuLE21GIhVhhNW6OcFmJFIJ9mPBLFfpDLwZiVSCkbf8ZKDNSOZqrySACWziQcUEGYr9WBBlEw8qJsgQTGxvLyomyEuYQCywtEkxQeyY6JafVEwQGyYWC05RMUFOMcFYcIqKCXLARGPBKSomCGDdA2yd8omlYkLdTAEkHwtO0T8mrOZus1ZNDOcKwPro75+Rx5afj3BfhREobJXxatD+azabCxX6L6+kR3RyQvtCcElefF1Cv4syUvk2D7TnWOZ48ujf25IZZPiqXSjY7HrZA/r3tg/MKBZVh+evurM9afTf/ZxMfJivWjy/4Fv2J4zPx5ldtbkfh6KwfwPh2E3s9vmi/7itCjclLxQsSzhJDHNBdpBtvi/CgILdlXKC6HdrV4WbAg67R38Xu52h0G9lcZs2ZOG+CvWFSmQO9BWAFt3+spc8Tt6g+YR+LzcAQPLTYrHY+34xzT04wxRsA+AeLxcs0BV3KaZ4LzcA7hhg3TIVrYU5qO/xfALMS5YlZDfzHl5P9OWX6I5p8AX3qsWnidE7x+yW7Y2FA3MM5rDmBKtFVoNPt2TXnici69n89N8F0sWt+b5N7PefBfr3rDZtjifg6FjEckv1vHbm5CzZ9Si7iU7AOpcTYI5HjB72nDXNEqM8c/wWMx+j2R298QbArwCuzcdz+AjgHwAIMdQT0tFxWaEb0kvRVwBfAGyBp2NYbNGyuyj6BcAbdCcmpg26g79JoXjZzXt9BzN+moktgDsA30ou2jt0vWpKXidStDvM99smuJLHae9jN0CmUfJt3G/onoiVvhbT3UCY3P/ZwPpdulx/IQAAAABJRU5ErkJggg==","e":1},{"id":"image_6","w":169,"h":7,"u":"","p":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKkAAAAHCAYAAABzw22xAAAACXBIWXMAAAABAAAAAQBPJcTWAAAAJHpUWHRDcmVhdG9yAAAImXNMyU9KVXBMK0ktUnBNS0tNLikGAEF6Bs5qehXFAAAAyUlEQVRYhe3WKw7CUBBG4TM8LIENkC6BpSBxeBSC1eBRhF0ACsEWSHhYEDjSH0NCgSblfa+YL6m5zTQnNyNquLdJ6gCDnFcHoGtm6z8nOXdLUqJ87dBtMZFU+mS+IqkHzIF95rx+eWIWS+MSaN2d1SX1gVqAnlc0+M8dniQdgRGwMDO9MmySVkDzJ2nOPdoBE2AMTM0sLRrwJXUhPbWwJmkIVAs+lny37adi+Q14VhI6IBJbrgs7yy6sBUtySEpCN0QqBU5AGdicATRQUsiGlHLxAAAAAElFTkSuQmCC","e":1},{"id":"image_7","w":137,"h":4,"u":"","p":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIkAAAAECAYAAAC6ChzPAAAACXBIWXMAAAABAAAAAQBPJcTWAAAAJHpUWHRDcmVhdG9yAAAImXNMyU9KVXBMK0ktUnBNS0tNLikGAEF6Bs5qehXFAAAAQ0lEQVRIie3OMRHAIBBE0X8MdTTEDVqwQ8sMOpNq4yDtXnFPwQtJBwjKn9sdMFodeIDpnpS0dnMPSn4haQCvO1LSuj45TAqeTI6c1gAAAABJRU5ErkJggg==","e":1},{"id":"comp_0","nm":"Final Typo","fr":60,"layers":[{"ddd":0,"ind":1,"ty":0,"nm":"Pre-comp 1","refId":"comp_1","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":1,"k":[{"i":{"x":0.007,"y":0.993},"o":{"x":0.773,"y":0},"t":0,"s":[406,160,0],"to":[0,0,0],"ti":[0,0,0]},{"i":{"x":0.007,"y":0.007},"o":{"x":0.773,"y":0.773},"t":42,"s":[400,150,0],"to":[0,0,0],"ti":[0,0,0]},{"i":{"x":0.227,"y":1},"o":{"x":0.993,"y":0.007},"t":210,"s":[400,150,0],"to":[0,0,0],"ti":[0,0,0]},{"t":252,"s":[406,160,0]}],"ix":2,"l":2},"a":{"a":0,"k":[400,150,0],"ix":1,"l":2},"s":{"a":1,"k":[{"i":{"x":[0.007,0.007,0.007],"y":[0.993,0.993,1]},"o":{"x":[0.773,0.773,0.773],"y":[0,0,0]},"t":0,"s":[0,0,100]},{"i":{"x":[0.007,0.007,0.007],"y":[-1.708,-1.708,1]},"o":{"x":[0.773,0.773,0.773],"y":[0,0,0]},"t":42,"s":[100,100,100]},{"i":{"x":[0.227,0.227,0.227],"y":[1,1,1]},"o":{"x":[0.993,0.993,0.993],"y":[0.007,0.007,0]},"t":210,"s":[100,100,100]},{"t":252,"s":[0,0,100]}],"ix":6,"l":2}},"ao":0,"sy":[{"bm":{"a":0,"k":1,"ix":1},"c":{"a":0,"k":[1,1,1,1],"ix":2},"so":{"a":0,"k":100,"ix":3},"ty":7,"nm":"Color Overlay"}],"w":800,"h":300,"ip":0,"op":900,"st":0,"bm":0},{"ddd":0,"ind":2,"ty":2,"nm":"y","refId":"image_2","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":1,"k":[{"i":{"x":[0.007],"y":[0.993]},"o":{"x":[0.655],"y":[0.039]},"t":90,"s":[-45]},{"i":{"x":[0.007],"y":[-0.001]},"o":{"x":[0.655],"y":[0]},"t":118,"s":[0]},{"i":{"x":[0.345],"y":[0.961]},"o":{"x":[0.993],"y":[0.007]},"t":210,"s":[0]},{"t":238,"s":[-45]}],"ix":10},"p":{"a":0,"k":[284,171,0],"ix":2,"l":2},"a":{"a":0,"k":[81.5,87.5,0],"ix":1,"l":2},"s":{"a":1,"k":[{"i":{"x":[0.007,0.007,0.007],"y":[0.993,0.993,1]},"o":{"x":[0.655,0.655,0.655],"y":[0.039,0.039,0]},"t":90,"s":[0,0,100]},{"i":{"x":[0.007,0.007,0.007],"y":[-1.225,-1.225,1]},"o":{"x":[0.655,0.655,0.655],"y":[0,0,0]},"t":118,"s":[100,100,100]},{"i":{"x":[0.345,0.345,0.345],"y":[0.961,0.961,1]},"o":{"x":[0.993,0.993,0.993],"y":[0.007,0.007,0]},"t":210,"s":[100,100,100]},{"t":238,"s":[0,0,100]}],"ix":6,"l":2}},"ao":0,"sy":[{"bm":{"a":0,"k":1,"ix":1},"c":{"a":0,"k":[1,1,1,1],"ix":2},"so":{"a":0,"k":100,"ix":3},"ty":7,"nm":"Color Overlay"}],"ip":0,"op":900,"st":0,"bm":0},{"ddd":0,"ind":3,"ty":2,"nm":"r","refId":"image_3","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":1,"k":[{"i":{"x":[0.007],"y":[0.993]},"o":{"x":[0.655],"y":[0.039]},"t":94,"s":[-30]},{"i":{"x":[0.007],"y":[0.362]},"o":{"x":[0.655],"y":[0]},"t":122,"s":[0]},{"i":{"x":[0.345],"y":[0.961]},"o":{"x":[0.993],"y":[0.007]},"t":210,"s":[0]},{"t":238,"s":[-30]}],"ix":10},"p":{"a":0,"k":[413,142,0],"ix":2,"l":2},"a":{"a":0,"k":[47.5,65,0],"ix":1,"l":2},"s":{"a":1,"k":[{"i":{"x":[0.007,0.007,0.007],"y":[0.993,0.993,1]},"o":{"x":[0.655,0.655,0.655],"y":[0.039,0.039,0]},"t":94,"s":[0,0,100]},{"i":{"x":[0.007,0.007,0.007],"y":[-1.128,-1.128,1]},"o":{"x":[0.655,0.655,0.655],"y":[0,0,0]},"t":122,"s":[100,100,100]},{"i":{"x":[0.345,0.345,0.345],"y":[0.961,0.961,1]},"o":{"x":[0.993,0.993,0.993],"y":[0.007,0.007,0]},"t":210,"s":[100,100,100]},{"t":238,"s":[0,0,100]}],"ix":6,"l":2}},"ao":0,"sy":[{"bm":{"a":0,"k":1,"ix":1},"c":{"a":0,"k":[1,1,1,1],"ix":2},"so":{"a":0,"k":100,"ix":3},"ty":7,"nm":"Color Overlay"}],"ip":0,"op":900,"st":0,"bm":0},{"ddd":0,"ind":4,"ty":2,"nm":"o","refId":"image_4","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":1,"k":[{"i":{"x":[0.007],"y":[0.993]},"o":{"x":[0.655],"y":[0.039]},"t":94,"s":[-45]},{"i":{"x":[0.007],"y":[0.042]},"o":{"x":[0.167],"y":[0]},"t":122,"s":[0]},{"i":{"x":[0.345],"y":[0.961]},"o":{"x":[0.993],"y":[0.007]},"t":210,"s":[0]},{"t":238,"s":[-45]}],"ix":10},"p":{"a":0,"k":[599,149,0],"ix":2,"l":2},"a":{"a":0,"k":[58,61,0],"ix":1,"l":2},"s":{"a":1,"k":[{"i":{"x":[0.007,0.007,0.007],"y":[0.993,0.993,1]},"o":{"x":[0.655,0.655,0.655],"y":[0.039,0.039,0]},"t":94,"s":[0,0,100]},{"i":{"x":[0.007,0.007,0.007],"y":[-1.128,-1.128,1]},"o":{"x":[0.167,0.167,0.167],"y":[0,0,0]},"t":122,"s":[100,100,100]},{"i":{"x":[0.345,0.345,0.345],"y":[0.961,0.961,1]},"o":{"x":[0.993,0.993,0.993],"y":[0.007,0.007,0]},"t":210,"s":[100,100,100]},{"t":238,"s":[0,0,100]}],"ix":6,"l":2}},"ao":0,"sy":[{"bm":{"a":0,"k":1,"ix":1},"c":{"a":0,"k":[1,1,1,1],"ix":2},"so":{"a":0,"k":100,"ix":3},"ty":7,"nm":"Color Overlay"}],"ip":0,"op":900,"st":0,"bm":0},{"ddd":0,"ind":5,"ty":2,"nm":"x","refId":"image_5","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":1,"k":[{"i":{"x":[0.007],"y":[0.993]},"o":{"x":[0.655],"y":[0.039]},"t":90,"s":[30]},{"i":{"x":[0.007],"y":[1.667]},"o":{"x":[0.655],"y":[0]},"t":118,"s":[0]},{"i":{"x":[0.345],"y":[0.961]},"o":{"x":[0.993],"y":[0.007]},"t":210,"s":[0]},{"t":238,"s":[30]}],"ix":10},"p":{"a":0,"k":[674,125,0],"ix":2,"l":2},"a":{"a":0,"k":[86.5,82.5,0],"ix":1,"l":2},"s":{"a":1,"k":[{"i":{"x":[0.007,0.007,0.007],"y":[0.993,0.993,1]},"o":{"x":[0.655,0.655,0.655],"y":[0.039,0.039,0]},"t":90,"s":[0,0,100]},{"i":{"x":[0.007,0.007,0.007],"y":[-1.225,-1.225,1]},"o":{"x":[0.167,0.167,0.167],"y":[0,0,0]},"t":118,"s":[100,100,100]},{"i":{"x":[0.345,0.345,0.345],"y":[0.961,0.961,1]},"o":{"x":[0.993,0.993,0.993],"y":[0.007,0.007,0]},"t":210,"s":[100,100,100]},{"t":238,"s":[0,0,100]}],"ix":6,"l":2}},"ao":0,"sy":[{"bm":{"a":0,"k":1,"ix":1},"c":{"a":0,"k":[1,1,1,1],"ix":2},"so":{"a":0,"k":100,"ix":3},"ty":7,"nm":"Color Overlay"}],"ip":0,"op":900,"st":0,"bm":0},{"ddd":0,"ind":6,"ty":2,"nm":"LB","refId":"image_6","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[500,205,0],"ix":2,"l":2},"a":{"a":0,"k":[84.5,3.5,0],"ix":1,"l":2},"s":{"a":1,"k":[{"i":{"x":[0.007,0.007,0.007],"y":[0.993,1,1]},"o":{"x":[0.655,0.655,0.655],"y":[0.039,0,0]},"t":90,"s":[0,100,100]},{"i":{"x":[0.007,0.007,0.007],"y":[-1.225,1,1]},"o":{"x":[0.167,0.167,0.167],"y":[0,0,0]},"t":118,"s":[100,100,100]},{"i":{"x":[0.345,0.345,0.345],"y":[0.961,1,1]},"o":{"x":[0.993,0.993,0.993],"y":[0.007,0,0]},"t":210,"s":[100,100,100]},{"t":238,"s":[0,100,100]}],"ix":6,"l":2}},"ao":0,"sy":[{"bm":{"a":0,"k":1,"ix":1},"c":{"a":0,"k":[1,1,1,1],"ix":2},"so":{"a":0,"k":100,"ix":3},"ty":7,"nm":"Color Overlay"}],"ip":0,"op":900,"st":0,"bm":0},{"ddd":0,"ind":7,"ty":2,"nm":"LT","refId":"image_7","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[346,46,0],"ix":2,"l":2},"a":{"a":0,"k":[68.5,2,0],"ix":1,"l":2},"s":{"a":1,"k":[{"i":{"x":[0.007,0.007,0.007],"y":[0.993,1,1]},"o":{"x":[0.655,0.655,0.655],"y":[0.039,0,0]},"t":90,"s":[0,100,100]},{"i":{"x":[0.007,0.007,0.007],"y":[-1.225,1,1]},"o":{"x":[0.655,0.655,0.655],"y":[0,0,0]},"t":118,"s":[100,100,100]},{"i":{"x":[0.345,0.345,0.345],"y":[0.961,1,1]},"o":{"x":[0.993,0.993,0.993],"y":[0.007,0,0]},"t":210,"s":[100,100,100]},{"t":238,"s":[0,100,100]}],"ix":6,"l":2}},"ao":0,"sy":[{"bm":{"a":0,"k":1,"ix":1},"c":{"a":0,"k":[1,1,1,1],"ix":2},"so":{"a":0,"k":100,"ix":3},"ty":7,"nm":"Color Overlay"}],"ip":0,"op":900,"st":0,"bm":0}]},{"id":"comp_1","nm":"Pre-comp 1","fr":60,"layers":[{"ddd":0,"ind":1,"ty":4,"nm":"Shape Layer 1","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[395.39,151.299,0],"ix":2,"l":2,"x":"var $bm_rt;\\n$bm_rt = thisComp.layer('V').transform.position;"},"a":{"a":0,"k":[0,0,0],"ix":1,"l":2},"s":{"a":0,"k":[100,100,100],"ix":6,"l":2,"x":"var $bm_rt;\\n$bm_rt = thisComp.layer('V').transform.scale;"}},"ao":0,"sy":[{"bm":{"a":0,"k":1,"ix":1},"c":{"a":0,"k":[1,1,1,1],"ix":2},"so":{"a":0,"k":100,"ix":3},"ty":7,"nm":"Color Overlay"}],"shapes":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[4.75,7.125],[0,0],[0,-0.125],[0,0],[0,0]],"o":[[-4.75,-7.125],[0,0],[0,0.125],[0,0],[0,0]],"v":[[-39.854,-41.817],[-47.979,-40.692],[-34.5,-18.5],[-35.854,-17.817],[-30.729,-18.692]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[1,1,1,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false}],"ip":0,"op":105,"st":0,"ct":1,"bm":0},{"ddd":0,"ind":2,"ty":2,"nm":"W","refId":"image_0","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":1,"k":[{"i":{"x":0.003,"y":0.981},"o":{"x":1,"y":0.004},"t":75,"s":[400,131,0],"to":[0,0,0],"ti":[0,0,0]},{"i":{"x":0.003,"y":0.003},"o":{"x":0.167,"y":0.167},"t":120,"s":[166,131,0],"to":[0,0,0],"ti":[0,0,0]},{"i":{"x":0,"y":0.996},"o":{"x":0.997,"y":0.019},"t":266,"s":[166,131,0],"to":[0,0,0],"ti":[0,0,0]},{"t":311,"s":[400,131,0]}],"ix":2,"l":2},"a":{"a":0,"k":[125,87.5,0],"ix":1,"l":2},"s":{"a":0,"k":[100,100,100],"ix":6,"l":2}},"ao":0,"sy":[{"bm":{"a":0,"k":1,"ix":1},"c":{"a":0,"k":[1,1,1,1],"ix":2},"so":{"a":0,"k":100,"ix":3},"ty":7,"nm":"Color Overlay"}],"ip":0,"op":900,"st":0,"bm":0},{"ddd":0,"ind":3,"ty":2,"nm":"V","refId":"image_1","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":1,"k":[{"i":{"x":0.003,"y":0.981},"o":{"x":1,"y":0.004},"t":19,"s":[400,161,0],"to":[0,0,0],"ti":[0,0,0]},{"i":{"x":0.003,"y":0.981},"o":{"x":1,"y":0.004},"t":75,"s":[400,125,0],"to":[0,0,0],"ti":[0,0,0]},{"i":{"x":0.003,"y":0.003},"o":{"x":0.167,"y":0.167},"t":120,"s":[498,125,0],"to":[0,0,0],"ti":[0,0,0]},{"i":{"x":0,"y":0.996},"o":{"x":0.997,"y":0.019},"t":210,"s":[498,125,0],"to":[0,0,0],"ti":[0,0,0]},{"i":{"x":0,"y":0.996},"o":{"x":0.997,"y":0.019},"t":255,"s":[400,125,0],"to":[0,0,0],"ti":[0,0,0]},{"t":311,"s":[400,161,0]}],"ix":2,"l":2},"a":{"a":0,"k":[92,81.5,0],"ix":1,"l":2},"s":{"a":1,"k":[{"i":{"x":[0.007,0.007,0.007],"y":[0.993,0.993,1]},"o":{"x":[0.773,0.773,0.773],"y":[0,0,0]},"t":19,"s":[77,77,100]},{"i":{"x":[0.007,0.007,0.007],"y":[0.861,0.861,1]},"o":{"x":[0.773,0.773,0.773],"y":[0,0,0]},"t":120,"s":[100,100,100]},{"i":{"x":[0.227,0.227,0.227],"y":[1,1,1]},"o":{"x":[0.993,0.993,0.993],"y":[0.007,0.007,0]},"t":210,"s":[100,100,100]},{"t":311,"s":[77,77,100]}],"ix":6,"l":2}},"ao":0,"sy":[{"bm":{"a":0,"k":1,"ix":1},"c":{"a":0,"k":[1,1,1,1],"ix":2},"so":{"a":0,"k":100,"ix":3},"ty":7,"nm":"Color Overlay"}],"ip":0,"op":900,"st":0,"bm":0}]}]`),layers$1=[{ddd:0,ind:1,ty:0,nm:"Final Typo",refId:"comp_0",sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:0,k:0,ix:10},p:{a:0,k:[400,150,0],ix:2,l:2},a:{a:0,k:[400,150,0],ix:1,l:2},s:{a:1,k:[{i:{x:[.833,.833,.833],y:[.833,.833,.833]},o:{x:[.167,.167,.167],y:[.167,.167,.167]},t:33,s:[100,100,100]},{t:240,s:[90,90,100]}],ix:6,l:2}},ao:0,w:800,h:300,ip:0,op:900,st:0,bm:0}],markers$1=[],props$1={},s={v:v$1,fr:fr$1,ip:ip$1,op:op$1,w:w$1,h:h$1,nm:nm$1,ddd:ddd$1,assets:assets$1,layers:layers$1,markers:markers$1,props:props$1},v="5.12.1",fr=60,ip=0,op=151,w=1453,h=414,nm="Comp 1",ddd=0,assets=JSON.parse('[{"id":"image_0","w":91,"h":122,"u":"","p":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFsAAAB6CAYAAADQxi8KAAAACXBIWXMAAAABAAAAAQBPJcTWAAAAJHpUWHRDcmVhdG9yAAAImXNMyU9KVXBMK0ktUnBNS0tNLikGAEF6Bs5qehXFAAAHXUlEQVR4nO2dX0xbVRzHf20vOycDQjM2H+g/KAO2sUwTZzLdkAyZQjYMSwyZmvEkPoBL9jISn0yWGDU+GWSC2KCJ4U+QMOyyEDSGbDPR8GcPi1sKhhGhy4gwge7Pvbu3XB/WaukF2p72Hmj7+7yUe3vuved8+d3v/Z0/bQ2U0nx4hkEURZUQYgpuS5IkE0J2SJL0FACAEEIkSZJCXwFABQCQJOkpIWQHbMxq+A5JkmRKqRC6TxTF6U3OkfTkLy4u/qBuAyilzq0WQ0+MlFKDLMsrW10Rv9/v2+o66I1JURRzS0vLDUEQvs/MzPSYzWZ7RkbGbh4X9/v9vtu3b3/rdru/PHz4cLMgCEZFUf7hce3tgAMAHJcvX35rYWGhXy+78Pl8HpfLVU8pdaa6dUSEEFIMAI6RkZEGSZLmEiWyoigrY2NjnwYEtm91O7cbjtOnTz+/uLj4c7xCi6LobWpqOpH2kbwZwSifn58fiEfoc+fOvY5CRwEhpKi2tvYFURS9LGI3NTWdALSN6CGEFPX29r4dq9C3bt1qw4hmgBBStLS0NBqL2I2Nja9vdb2TEkJI0c2bNz+OVujZ2Vk3oH2wU1VV9VK0Yg8ODn6AFhIHhJDCaB+UjY2NVVtd36SGEFLo9Xp/jCS0LMs+jOq1GGM9QJIkeX5+/o9I5Xw+36QoigpbtVKTmMUGgL98Pt9ypEKyLD9kOHdKwyI2zMzMzEUqs7y8fC98YiDdYRL7/v37EaP28ePHK6k+6xIrTGJ7vd6UH+jXAyax/X4/03HpDpNoRqNRjVTGYDAYWM6dymCEcoRVbPwnMYCicYRJbFVVI/rx6uoqenYYGNkcQbE5wiQ2WgQbukW23+/Hf0gYuj0gES3o2RxBz+aIbmMjiBYmsWVZxshmgDWyUWwGMLI5wiR2RkYGejYDukU25uJaMLI5gp0ajmB3nSMY2RxBsTmim9hoNVpwkQ5HWMVOdD3SAoxQjjCJbTKZIhdCNDCJrSgKPvwYQBvhCI5ncwQjmyNMYhsMBhz1Y0C3yMYZeC046scR9GyOsObZia5HWoCpH0dwRRRHcK0fR3SLbMxYtOg2eYAdHy269SAxsrVgp4YjODbCEdZsBHueDOgmGka/FtbUT/P7BeGgr2vB7jpHWD07mi93QRsJQ7cHJNqIFiaxBUHAqGUAUziO6LZIBz1bCy4Z5gh6NkdwrR9HMLI5gtkIR3TrQSJaMLI5gmJzRLdRP+zUaMHI5ohuD0jsQWrByQOO6PahU/RsLejZHGH90GnECV9EC65i5Qiuz+YIejZH8DM1HMHI5giKzRHWmZpE1yMtwPXZHMHviOIIkx9E87VFmIsDAEDemTNn3jl27NihqampBSaxcQ4yetra2j7MycnZNTo6+hsOseqH1e12f52Tk7MLAKC5ufkLXJ+tD5bjx4+/eurUqZMAAHfv3v1zZGTkBpPYdrt9Z6Qy6TxTU1xc7BwYGGgJbnd3d/8CABF/0XtdLl269J4agdHRUVeiKp9kWK9du/ZTUIelpaVFALAAMKZ+ubm52QmtXupgvXLlSmtZWVllcEdXV5cbAAwAjGJbrVZLgiqXSli7uro+P3ny5JuhO/v6+oaB1UIopQUej6cHbWQNltbWVle4BuPj478CgDVYiCnPzs3NLU5YNZMfW29v7yd1dXXvhr/R09PzO7BGNQDAkSNHKiNFtaqq6tjY2DfxtCAJsACA7erVqwPrtX95eXkBAPJCD4g1su0XL158OWHVTV4s+/btKxoaGmp3OBzr3uU9PT2DEHgwMkEpdT548GA8mshOYc+2Xbhw4bOVlZW/N2q7JEmP9u7dW858BUqps6GhoToaoVPURiwlJSUV169fH4rU9omJiRsQyK2ZoJQ6nzx5ci8NxbYBgK2/v/87SZIeRdP2ioqKs0xXopQ6KaXOycnJ7miFThGxbQcOHHjN5XJ9tZllhDMzM+MBlqimlDrLy8vL5ubm3LEIncRiWyAg8vDwcF+0kRxKR0dHBzy7G6KDUuoEAHtnZ+dZn8/nifWCSSa2DQAs1dXV7/f393fOzs7eYWmvqv6X7lk3utCa1I8QUmgwGNT29vZXKisr6/Ly8mr0bilnbAAApaWlpUePHj1UXV1dUlhY6MzPzz+YnZ29O96TT09P34FN0j0BABwAoJ4/f95ZX1//RkFBwQmz2fxivBc2mUwqpbQgdJ8oigoAAKVUCG5TSgVRFOVAESMArMLaMZvwbdjkveC2WlNTU2O323fs379/j9ls3llSUlJIKc3Kz88/mJWVtSfe9q1Hc3OzCwBmN3rfQAgp8ng8HzkcDk13Mx4URXkoy/LD4LYaw/h2LGXDyczMfI712HiYmpqaKC4uroVNxBYAAAghCR8yFQQhSxCErESfd7syODg4ApsIDRCI7MDfq5IkyQAAhJAMgLVTW8FbPvTgoC0AgArwvz2Ell/vuM0IWIqRUmoURXEVNraR4BrxcOsJ328I1C94t6ghrxvZVeg51tterx4AAN71W/WMfwFNMtgQlWaDHgAAAABJRU5ErkJggg==","e":1},{"id":"image_1","w":89,"h":89,"u":"","p":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFkAAABZCAYAAABVC4ivAAAACXBIWXMAAAABAAAAAQBPJcTWAAAAJHpUWHRDcmVhdG9yAAAImXNMyU9KVXBMK0ktUnBNS0tNLikGAEF6Bs5qehXFAAAHWklEQVR4nO2dX0xTVxzHf4Ut2rkAHSRm9Yy0qTY1mvGwsDiRSuFFTZaZZQtXMsIjIWY0qHvzwYdhZpZA0Ep4WOY0nTPzD+KfbZkwUJSygiHDsmX9P1aLC7a9jEjLi3cPa2dR7P3Tc8+9defz0qY599fv+fbX3z3ntvccDQBsgCcUpR8fw0o06deK4Fm4rDZPv35/lfakQVnPn9eH55Fpn/0I6ecRoUE09fX1zf39/d0i3jgnHMdpNBoNt3fv3vbh4eGzuOJK5ciRI6fsdvt7OGPG4/G4yWSqA4FGv1RcXFxcUlJSjlOEmigvL19bVlamU1rHG2azufbo0aOOu3fv3uEwUVdXxyjdsTTIarU2Hj9+/Kzf7w/g6FsikYjDyjIkig0NDQ0tfX19X7IsG3tBTM5Gb7VaG8fHx39W0uT/xNTX1zffunXrxgtmcgZktVobXS6XOw+T9djEdHZ29qVSqSWxQqxWayMuETKCLl269KNEk/PO5BVCGIY5JNboAjEZAEDf39//g9ImAwCgkydPnhYjxGazNeEWISNocHDwpkiTsZWLFUKCwaBPqJACymQAADCZTNvj8XhChMmCM1nM7CfS09NzVWjjx48fPz1rVDWBQCA8MDAwqrQOABHZvGPHjg+VFisWo9H4djKZTArMZMHlQkwmAwBEPB6PV+QxBUMoFIpGIpE5gc0FeyfWZBgaGvpd7DEFROT27du/8jXiOO7pi2E5EW3ytWvXLog9ppBwu92/4I4p2uRAIBBeWFiI4xaiFjwezxTumKJNBgCIxWIJ3ELUwujo6DjumFJMjs7Pz8dwC1ETiUSCxRlPUia/4GAf31OTV+Hhw4dYyyE1+VmiuANSkwlATZaO4Notm8kajYbjb1XQyDetBhA/rXxBkTeT/wdZihVak6WjfLkotIv2ckLLBQHoiY8AtCYTgJpMAGoyAajJBKAmE4CaTABqMgGoyavAcRxWX+hkhAB0Wr0KGo0G63UXWi6ko/wvI5Qn0JosHXmvJ1PEQU0mAB1dEIBmMgHoiY8AtFwQgJYLAlCTCUBNJgA1WTr02oWaoCYTgA7hnkXo3f/KXyAqKioq2G/JunXrtDjjFawRcqLVatfijEdNXgWdTleGM54kkx89epTEKUJNIISErmMh7xBucXGR12SNRlMsJbbSVFdXVwtsKu+Jb2FhgdfkQv2n/ebNm7fgjinJZJZll/naVFVVvSUlttLs3LmzCndMSSaPj49P8rXZuHGjUUpshUFGo/F13EElmexyue7wtTEajSVSYivNpk2bsCeHJJPD4XCEZdmcd9KvX7++HGRaoE4uWltbW+WIK3mcPDU1lXOtHovFsjGf+AqAWlpadssRWKoJkZmZmZxLFpSVlekMBgP29SzlxGKxmBKJBOv3+0MCmss/ejKZTNv5Fknt6en5RnYheNB3dXVd5DiOGxsbm/T5fMFc/Uomk0mQYUHU1eBd7TAQCPhJickTlFmns6am5v3p6WkP3yqHQOp8Y7fbu3IJSaVSSyaTaTsRMXnQ1tbWyXEcNz09PQMAaGxsbILP5JqamvdJ6dPzLcs+MDDwHag8mzPloa2trRMAQMgyv7W1tR+Q0occDoeTL5tB5UO5dBZ7IJ0M3d3d3/KZfPjw4S9IakQCs1nVRmezf//+z/hMPnXq1BWSmvTt7e2f82VzIdTmDAaDYRufyYODgzeBcBnkHWncu3dvGgonm1EikYjn6k80Go0C6XONzWZr4hs3nzlz5iJxYdJAQ0NDI3zZbDAYtgkJhu3CejgcTiwuLr68a9eud57XxmKxGPx+/7zH4wkDwCKu95aBv0tKSrbs2bMnZ4kzGo3o3Llzw0C4L+jq1atXcn36LMvG0hu9qD2jEd83U66tMASJE2G0mms0unz58vd8JeP06dOXgBqdF2hubu5+rn6kUqml9CYJ6jQ6lUotOZ3O86Beo/VWq7VRSNlID1EV6Qfq7Ozs45usuN1uF+Y6jRiG6QgEAn6O4/L9S5meYZgOPqNZlo2lN7BRJqMbGho+CoVC3lwiM2antzOSmhGIYZhDbrfblYkZDAZ9GPqgZximgy9ZWJaNnThx4uu0fuJmIwBAvb29XwnZ58/tdrvsdnuXQLF6s9lc63A4zmRPiLJKEbZvR11dHZP9AeYy2+FwONOZrSd9FxMCAOjt7f20qanp3dLS0tdyNV5eXk5Go9H7MzMzv83Ozia8Xm8MAKCiouJVnU63duvWrRsqKysr9Xr9hjVr1mgzx9y4ceOngwcPHvN6vSEQsWGs0D7YbDbrsWPHPjabzWa+Puzbt+8TzO8vGAQA6MCBA90TExNj+e5imUqlloLBoM9ut3eZzeZaIHMCQpAuT06n8/zIyMhQMBj0PXjwIJLdn46Ojh413I+HAACam5ubd+/e/SZCqKKysrJSq9W+UlpaWp7JUIB/s3R5eXkpmUymZmdn//T5fH9MTk7+df369QterzcIym/hvGppUoPJT6OHlXtFc/BEZ/a+02rZF5uXfwAzxgE6H0KrJgAAAABJRU5ErkJggg==","e":1},{"id":"image_2","w":89,"h":88,"u":"","p":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFkAAABYCAYAAACeV1sKAAAACXBIWXMAAAABAAAAAQBPJcTWAAAAJHpUWHRDcmVhdG9yAAAImXNMyU9KVXBMK0ktUnBNS0tNLikGAEF6Bs5qehXFAAAIQ0lEQVR4nO2dzW8TRxjG30SVaLlALkhdzcGWJf4EXGPWovwDOCRA7pWSWLaokHogAkVVrVZERLYgUqsmlgyBFvLhOK5KEyfEpmrsxOkH4H4pxIlyqJ0TXp+wL830gNddNmt7Zu39cLy/C7Bs1s88nn323c3OTAcAMADQCW/YF/y92r95OkXbhPsJ2YfqxxfzT43/axSpdoq1i7cLqaVbyD4A5IQb3nE4HGwkEvmKSq4CPHv27MW5c+c+VOr4Ho/nqtfr/Uip4/O4XK4vHj16NCrc9s7+/v7+8ePHu5T+8HocPXr0qJLH7+jo+FeNdp44ceJ9qe2MxWI57Xa7b8ZisXihUHiFVSSTyWy73e6bAIAUbj/jcDgur6+vp5qpv1QqvY7FYvHbt28/NJlMH5C0AwEAc+nSpatra2sbHMflmylIyN7eXlYlcw+00eFwXE6n07/L1V4qlV6vrKw8FeiX3QYEAMjv90812+xMJrNtsVhONyKuCaCVlZWnNLqLxWIxHA4vKqEdAQAKh8OLxWKx2AyTz5w5c7GZAhsAZTKZbRLNAnMZJQUxLMv27u3tZRsxOJPJbCstlIa7d+9GaunlOC7f09NzBVQ86xgAQHNzc0tyTV5bW9tQSywJw8PDgWpak8nkz6QXMyVg5BpdNlk3PfnGjRuSJs/NzS2BttcMAABAPp9vltbkXC6X04N4HqnOoheDeVAwGPyO1ujyKagH0NbW1o5QWygUWgYdGcyDQqHQMo3J5YZoHhksy/YKdS0tLf0EOjSYBy0tLf1EanI+n+dA+8agZDL5M69pa2trRwea6sLkcrkcqdEDAwNe0LBRdrv9Qj6f5/gv3W63X9BKCw2IZdle0huWcm/WKjLeiriywbrvxTzI5XJ9TtqbA4HAY9DAaGFnKGtoGYN5mGg0ukpicrFYLGpQaTDJZPIXjDFOJBK/QgsazIOy2eweidELCwuroF5DmcHBwc/4uGqVHK4G6u7udpPGxuDg4GeggtEmk+kD/mLncrk+V+MzlYaZnZ19QmJyPp/nVIgNFI1GExhjHI1GE3AIDOYhjg2FG/5WTCCETin0OZrA2O32C6RlnVKxIYwJtaJJbVAgEPhBw9hAiUTi18MYE2LQy5cvd+qZrIARyOfzhRT8AvWFjNho+CbFZrM5+Ziw2WzOZhxT76CJiYkFFWOjEhMzMzMr0AYG8zCksfHixYu/QH5sMKOjo9P8F9bAcVoTmtgYGhr6EmQYJBET7WUyAKDx8fEoicnFYrEoo6ZFq6urv7VjTIghrjbKsUFqFGrrmBBjs9mcpLExMjLyEAgMEz6Ib9eYEMPQxEbZtFpUYmJ6ejoOhsEViGNjc3NzF6rHBhoZGXloxEQVaKqNiYmJBZAw0Gq1njdiojaNxgZjxAQZ6Pnz539TxAZvZKUc1PgXs62B2Ww+RRob4+PjUQBAwqhpl2cTjYKGhoa+JI0Nq9V6fnNzcxdjjKempp6CERPEEMcG34ONakIGJpPJylcKJFit1vOg85ggHQCoGru7u9lr167dJtm3VCqVOjs7O0A0ONGADLS4uJgk6cl1blIMamE2m0+Rxkb5JsUwWgaov7//UxKT+WpDa8GtCm1sGFWGHBBCxLFh1MvyYWhKuu7ubjcYRlPBTE9Px/ncJTE5m83ugWEyMchmszkxfnNX53Q6XaQ92ngaR04lJkZHR6eBotrAGOP+/v5PwSjraoL4mFhdXf0NBI82SauNtngtqwGQ3W6/wBslfkhP82zjsL9g2AjimBCf8nJiwzBaQLWYOLAf/9a8ERt01IwJqf0pBv8kwLgIAoBENVFvf6fT6SKNjWa9jtvKoJmZmRWMK2PrSM1g+J8zYqM2tDEhhqGMjfa7CAofABHGhBiG5r26wzowpxaVKoEyJg4cJxAIPDZi4yBIOLZORkyIIX6Lv21uUoRj63w+XwiaNBDHiI3/QfxMAtFotJkD2I3YKMMMDAx4+YaazeZmD8FlxJM3VSOdTv8Jh7F2Zlm2l48JpabIoXkd9/r1618roUFLKpMrKTw1GEMaGxpNbKIYjHAILih/mh6Y861ObLR+bxbGhFoTK9FMPHUYYqMSE0+ePPkR1GsMCgaD35PGRitPl1OZ05PjuLwWEzuRxkZ5Ar6WqzYYYUz4/X6p33QoDs00asFg8Htosdhg+KnaOY7Lg3biUTqd/oPU6J6eHg+0SI9+a47l4eHhAGjYQ8STn9aC47g8y7K9WmklBQmnMS/3Yq17BvH89RhXpoXXbWwgt9t9UyjY7/dPgQ4Ei3XVQ+VKiBh08eLFj8W1qY7uqFCpVHpNY3Q4HF4E7c/CCsjhcFwWr0mis9OOem0RjDGen5/XxZv8kj0YY4xjsVhca3FC7t27N0drsqBHa9ZZ0J07d76tdvsaiUR+0EqYFGNjY9/KMRljjJeXl59CeRkQtfQii8VyOhaLxWsJS6VS62qKqgOanJwMyTUZ4zeVUnnFH8XbhDwezy2SNaFKpdJrPV34mrVKW/kMbWhxraoiPR7Pre3t7QyNoHg8HlNCDK32SCRCNJ0lKYVC4dXY2Ng30IQIQSdPnmQnJydDtOYKSaVS6w6H43KjYuTqrxdrjVAoFF6lUqn1vr6+q0DYuxkAQH19fZ/cv39/dmdnZ6uZgjY2NtbOnj3bB8qXRIzFYjk9Pz//mLY2boRCofAqHo/Hrly5cqvWknLUBbscHjx4MKOkw16vd1zpNpDg9XrHJQewHzly5D0lDQAAOHbsmKKf0dXV9a6Sxyelq6vr3Q6J7Xz3Fi8rLPWFkOwj3r9T8KfSSyhLaRIuoyy1xLNYo5hay0JLLi/9H5jGbjZRWIbyAAAAAElFTkSuQmCC","e":1},{"id":"image_3","w":89,"h":89,"u":"","p":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFkAAABZCAYAAABVC4ivAAAACXBIWXMAAAABAAAAAQBPJcTWAAAAJHpUWHRDcmVhdG9yAAAImXNMyU9KVXBMK0ktUnBNS0tNLikGAEF6Bs5qehXFAAAHdUlEQVR4nO2dXUxTZxjHnxITi1m0nZgthxd2GJGEaEjMEhE5PaG7MsNkZoo0ys0uTVgb45bdKcmyJYTYph83S5aUIM65qYWZDLLyNVBowUXnBTGlH6QgegGcLiI93nB2Qc9SpZwvzlfJ+V2Z8pynz/s///O87zmtb00AgOBtNgCgBLay3euF/s7+e5EjXi3eHd92FKp/u9cAAJaEFrCHIIiG+/fv/yj0AKFYrdY6uXNKoaOj4zuXy/W5nDljsVisvr7+hND4PSUlJSUWi8UqZxE5NvhDlMdqtZrlHl9ZWVmZ2GNQdXX1Sa/XeysSiUQZmQDhl6nSYCRJtnq93lvxeDwhx9ji8XhiRwURBNESCoUGKYpa3SUi54NIkmzdqZl2KrJsxYA+RWZBBEG0SHW2XCKzYMFgsC+bzWYliIzJWYhCoFAoNKi1yAAA6OzZs04JIuvZyflg9+7d+1NrkQEAsO7u7v5dKjIAABoaGvpLa5EBAJCYHgbFJTLgOH5CaFsUKzLXHdy7LF6/fv0XEfG6WCcLZX5+fnFgYGBC6zoAANDc3FxyNzoZAKCqquq41k4GAFh8+vSpYv1Ia1Kp1GI8Hk/xxTEMYxKTV6zIMDQ0NC0wtKjaRY6lBw8ezMqdVLTIg4OD/Url1gPxePy53DlFC5FKpRYpisrIXYheGB8fD/PFbE45wpHktmw2SwsIK8Z2ARMTExG5c0oSeXl5mVIqtx6Q+0qVIsTS69ev1wXEFaWTlaBo3VZMSBJZ4DqxWE+g7FegkkIUa7uQXRMlRS5WJ8uOIYQKGO1CBYyJTwUkCWEymcTdVxYX+lhdCHRysbYLfawuBDrZaBc5DCergLFO3oo+evIuRx892UAcxs2IBBiGEaWb0ZO3YvRkFTB6cjFi9GQVMHqyChhCbEUfE5/Y74LtNkwmk6gToeQDomLtybyaqLJO3uUP7fXRLgzEYXwyogLG82QVMD4Z2YpxW60CxsSnAryaqLJO3uUYTlYBoycXI4bIKmDcjKiA8RROBQwnq4DRk1XA+IyvAKWlpWY58xlO3sqG2Ww2RFYSHMcr5c4pSeS1tTXe/1vd0NBwXEpurTl16tRncueUJPKrV6+ycheiFw4ePPiB3DkliZxOp//li8EwrFxKbq0hSfKI3DkliTwxMTHCF9PY2PiplNwag6qqqmTfNFCSyI8fP/6bL2b//v2yztBqgOM4Onz4cJXAcMEnQ5LI8/PzvLu31NbWfiimED1w8eLFL4XElZWVidoqWOoSbuPZs2dxroDa2tqPJebWCtTc3PyJEomlirwUjUbTXAFWq9WixJpTKXAcR8eOHTtCUVRG4M4tgrWTfDPi8/k6+WKEXn46ADmdzm/MZrN5dHT00crKipDtf1R5bMC72+Hk5OQMFMdOh2h1dZViGIZpbGz8QsgujqDWuC5duvQ9VyHZbDaL47jgDfY1Arnd7jv5ppicnJzhE1nNcWF8O7UGg8HfQd9ufsvFAABCtvllY4Ww4wdEfDu1njlzhgD9PvbEfD6f22q1Wqamph49fPgwAgCwsLDAe0dbV1enyEqkIDiOn+D7kYHu7u5+0KGbbTbbObZ2m812jn396tWrP/E52ePx3FazVszj8fzKVZBOezMKh8PjDMMwoVBoEPJMYLPZzvGJPDw8PKZ2wRjfLuHhcHgc9HMHiDwez22GYRiKolZha10Y39WZ20NZ3fGQJNnKNwl6vd5boH3bQARBtLC1EgTRUqAmNDU1Nc3nZi2uTnTt2rUgV1E0Ta+fP3/+coFBqVYjQRAtrEvfbRP5dHR0cI6FYRgmGAz2bXe8kmB9fX0DXIVRFLW6jXuUBpEk2coKPDIyMspVQ3V19Umapte5xvLixYvnXDmURIzQavW0twSORCJR4BeHdxwMwzA9PT13QaO5BvX39//BVVwmk1lRSWjU3t7elclkVkQIDACby1P2uO2gaXpdoysTAAQITdP0us/n+1nBAlFPT89d9v34WkQBMIfDcVlI28hNgto42u/33+RzQzQajdjt9gsgn9iovb29K5FIxNmTeePGjTsS8yO/33+Tq35WaJIkW0Eroe12+4VkMjnHV2g0Go3kCpUqNnI6nV3RaDTC5kwmk3M7zAkAgBwOx2U+s2QymRW/338z917atI9AINDLVygrttPp7BJYLKqpqbEFAoHe/BOZ5165nIXZ7fYL+SeQS+xAINDb1NTkAABM7a/AIgCAQCDwQ1tbW/OBAwfe5wp+8+ZNNplMziUSiYUnT54sLS8vrwEAHDp06D2LxWI+evRoeWVlZSWGYeV79+4tZY8Jh8MjV65c6YzFYimQ/8dwMbvd3tTZ2flVTU1NDd8Y2travpX5/QWDAABzuVzu6enpKSHu5oKm6fXZ2dl/XC6XG9S7VDHYbCNf9/b2/jY2NjacTCbnXr58uZg/HpfL5dbDl7kRAIDD4XCcPn26vqKiwlpRUfHRvn37Si0Wy/usQwE2XUrTdJam6Ww6nV6IxWLpmZmZ516v150L0fonnPNP7v+Pd/UgciHKAYCBzfoK1ain38Xm5T/BYx2lXI9xMgAAAABJRU5ErkJggg==","e":1},{"id":"image_4","w":64,"h":89,"u":"","p":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABZCAYAAACOsCKNAAAACXBIWXMAAAABAAAAAQBPJcTWAAAAJHpUWHRDcmVhdG9yAAAImXNMyU9KVXBMK0ktUnBNS0tNLikGAEF6Bs5qehXFAAAG80lEQVR4nO2cXWjbVhTHj5xsSyg0dtp0VIjgVDN7aQehMErq5GFlbNBAR9yPsIe25C1k9mjo2EOhFMqgpcMmLBBGGQ4Elg6aDwfajbCEpKHYDVsgH22htlXj77HU8tISaQ+x9hDLUxU7kq6lyE78e1F0fe/ROf977occfDEoP/Ds1QAAGcGVL4sqMYZlr4SgTGjUIKqf74EguBeXxZU4UwDCbDYTvb29jqNHjx5uaGg4cPDgwQM1NTW1wkosyzLr6+tMOBwORyIRen5+nurv73eBhCgYAODBYPBRfX19vQrO5uju7r557949F2JzgiTJxuvXr1+1Wq0fHTlyhET1g6Ko4IMHD+YdDsdVKCAGQdN0ilMZu91+CzHwFo/H85BhGEZNf2iaTnk8nodWq/UcvJ3xmw/t6em55fP5nqglhsPhuKMweNxut9/SojOE0DSd6uvrG+ZFwEROEAAAfX19dy5evPiZ0Wg0IfQiAADY7fbv+/v7v5Eb/Pj4+E9nzpz5nC9gWZaNxWLxubm55bW1Ncbv90c5jtuoqqqqam5uthw/fvyDxsbGw3V1dUhDd3p6evbUqVNfFvqcyDr1K6rSPT09coYAQZJkSyAQCPLtGIZhxsbGfjObzSfg/xk/HzgAEC6X6xeUrKFpOgWioZDXwba2tgsoD5AhAE6SZEsikYjxbaampmZIkmyRCDyfELjb7R5X4l8gEAjKEQAAAG9tbT2rVASpSVAYPMMwTHd393cKAxdDKPEzK4B84+fPn7+iRIBsQAXtLS0trXDcZirabDYHyOwNKT/liuD1eucVGx8dHZ2UK8A2GZCzwzAMc/LkyQ5QJ/icfZvN5tBCAGhqavpY7vpcIAMIp9N5X1SnmLQvBOF2uye28290dHQSxTA+OTk5hypAa2vr2VQqRQsc0CJ4HsLv91NSAoj3+lLEx8bGHsmpaDAYqkRF+O3bt781mUzG5eXlZx0dHV2gzrtCIaJOp3O40IehUGgNyarZbD6BkAGEzWb7iuM4LpVK0dlxvxPghbLg2rVrPwIozwAIhUJRmqbTStvdvXv3JgDA4ODg9OPHj5VPQGjEC2VBKpVaBUAQAAAy0WhUMnUzmQz/ioy7XK4+k8lkpGk63dvb+zUofGcvhoGBgYFAIPCy0OcoAsQTiQStoL7h0qVLnwBs9j7C84oluri4SIkLl5aW/gRAEwBev37NyqxKOJ1O3XqfZ3h4eEJcFovF4gCIAqTT6X+l6mAYxgFA5vLly8Lez2zfShtGRkbusyz7VqeFQqEoAKIAa2trsjLA6XT+IOp9LZe97TAsLCw842+yYmQAEAWQA4ZhVe3t7c0AAFNTUwugU+9niT5//vwv/oZhGBaysSMJkMlkNqTqkCRpsVgsTQCbmQD69T4AAFAUFeL/Xl1dpaGYDMizy9tCV1fXpwAAfr//pdfr/QPlOWoyOzv7u6gIfRKUkwEmk8kIADAxMfEH6DDzixFuvrJDAAA0nAN4RkZGftb6GXLhd7Bv3rxh+DJNBYjH40mk926N4Hs+Ho/ntvKaCrCyskJp/QwlZCc/4Dgu55Omzs3MzCxCCYz/LFF+BxsOh//mCzUVYGhoaFBL+2qg2TLIsiwr561RD168eJHbFVajGJCzDEYikQTou/vbgtVqbQdRpyMJIAeKopKg8+4vD1v80WwOiEQi/2hlW000E4CiqILfwpQSmglA0/SqVrbVBEkADMMk2wm+EyxpkATgOE5OcByK7Z0GSYCNjQ3JZVDOXqEUQBKgurr6Hak6e34IGAyGknkJ2o6ycFJLKgJoZXhXzwG7Cc02QuWClhuhsqCSAZoZ3s37ADlDoLIKlAkVAVAa7flJsLIMysiAyiqw11eBXZ0BcqhkwF7PgHJBs/8OlwuVDNDbAb2pCIDSCMPEv7jdCsdx0pVKANSdoLThvb4M7vmNULlQ2QkitiuL//3LAUkAk8lUo7YjeoEkQF1d3btSdSwWy4cotncaJAH279//nlQdDMN27SpAHDp0SPLcjmPHjr2PYHvHQcqAhoYGSQH27dtXC+qeC1AayP3xtNxDSvRGcQacPn36Czn1jEajiSTJRuUulTaE1+udl5MBHMdxbrd7XG+H1QZXcpqMkqNqygFC6Vk9HJc7T6jsRSCsVus5lAOVEolEDLQ9K0RzCJIkW4o55Mzn8z2BMs0CvK2t7UIymYyiBi8UIXtMVtkIgd+4ccPNsux6scHzpNPpV52dnVeghEXAAYBwOBx3gsFgQK3Axfh8viednZ1X+efpHDMQkA3a4/E8TKfTr7QKXEwymYwODQ3dF4ihjwBqjPFiefr06ZIewRsAAMQntOpBbW2tLj5gkP9IXeG9GKn3B6GNfEfziusJrzv+O8P/AC3Lgjb8G6K6AAAAAElFTkSuQmCC","e":1},{"id":"image_5","w":35,"h":109,"u":"","p":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAABtCAYAAAAri9hFAAAACXBIWXMAAAABAAAAAQBPJcTWAAAAJHpUWHRDcmVhdG9yAAAImXNMyU9KVXBMK0ktUnBNS0tNLikGAEF6Bs5qehXFAAAEPElEQVRoge2bT0gbWRjAvwk9xAqSZRVx+oRdtCNUyMFCLZjM4iHevAhi2IvKHhVBKe6teLNYKBXRgxZa/EMpWEKStQqusKJs3ShbqBVkHO2m2iAWM9NAZXJxejCxaXAy817ehAw7v0tI8r2ZX77vS96EfGGAjOorHjskPNYlDI5AXV3dzcHBwfaGhoZbCKGfAAAURTmLRqP/LSws/Ds8PDwBAA4aYjlFRkZGHiWTyS9qDqLR6G5LS8tvAHDDNJGlpaWXuSQySSQSnzo7O++bIVQ9Pz8/bVQkTTKZ/OLz+bqoCvl8vq5EIvEJV0ZVL0oGAIiazNTU1BSJSJra2tpfaLlU7+7uvslHZnJy8gnOCR25nnQ6ndfzeTUIoR9pyZwrinKWj8zh4WGclsxHURQ/5CMjiuLnfNZ/R39//2PSfpFl+RRovpsAAK2urv5JIjMxMfEMAFiaMsBxnPf4+PgIRyQcDoeAclbSsBzHeTc3N//Wk1AU5Wx2dvaFWSKZoIGBgdFIJPJaUZSzTAlZlk/D4fAfNTU1TZBHaXAuIdKwAODgOO5nlmVvxGKxj4IgvE89d0QqYmNDAgOphkzdP4fvt4ir7qdxZD2WvbVgNzMzPT39srW1tRl3YS4EQRAaGxvv4q67VlZWdt3lcv1AU6a8vLycdC3r9/v7R0dHn4uiuI+7B12FKIr7NF4U8ng87RsbG/8Ug8ylFM/zHZIkxYtBBuBis0OBQGCpGGTSsLhCZsoAACCc5iaVyfntIIOj7u7u3xVFUUhOQlsG1tbWNhYXF9eKQgYAjubm5kKmmRDAxuNxSa9n9vb2DkgOjpMZAADY2tp6R3IiI+DKxHZ2dk5MMQGCzKyvr6/qxaiqWhiZk5OTmF4Mw5Bc55PB6jWwIAiFaWDCNeYdWJIkmbYIAJnMuX4IGZYvk52ZgmN5maLqGdOwG1gLy/eM7hpVVYkybvky6cIwDFEp7Z4hPnAhsWW0sGW0sGW0sLyMtT6BSbHLpIXlM2OtnvnfXlyZhuV7pqjKZGem4Fi+TKZheZmiamC7Z7QoqjLpQvrjl90zWhDJlJSUOGmLABDKOJ1OIzLY852mlKm0tJQoc9gyTU1Nd/RiSMuILeN2u2/rxZBOt2HLVFRUVBqJ83q92HN6uDIsz/M3jQS2tbW1my3jqK+vrzUS6Ha7K4H2DHkmPM93GJ27kiQpDiaOb6Pl5eW/jMqoqqr29PQ8MMWEZIgwNZVGvVRoZWUFKytphoaGngLFcqFAIPCKRERVL8b/PR5POw0hFAwGiUXSSJIU7+3tfUgqhJqbm3/d3t5+m69IJsFg8FVKyJAU4jjOGwqFFrL/6EALWZZPx8bG5rSkEMdx3vHx8ZmDg4M9MwS0pCKRyOu+vr6Hl2IzMzPzhRLIhd/vv+dwuVymXLXhUlVVVc3At7rlGusHuHofMxKTHe/Iur1c+xXbWHPRTOIXLAAAAABJRU5ErkJggg==","e":1},{"id":"image_6","w":79,"h":90,"u":"","p":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE8AAABaCAYAAAD5LwuuAAAACXBIWXMAAAABAAAAAQBPJcTWAAAAJHpUWHRDcmVhdG9yAAAImXNMyU9KVXBMK0ktUnBNS0tNLikGAEF6Bs5qehXFAAAKOUlEQVR4nOVdW0wTax7/My9bFC8osjDnE6c26B4vD0aXA5R2xWTNbnKSQygHyXn0RUgXjI8GszbHmJAsabM+bHIUl4ubjQcPVPTAEQUED/TCRaC4oKXghVo4CjNdHzp149p9sGWHMjOdlun9lxDSma//7//95n/5pvN9/0mB2AIOABjHuY8A4IigLgGREqV+EQB8VCqVihMnTvxh7969W/fv3//Zpk2bNmVkZOyUSCSpzMZut5t2uVy0y+Vyzc/P28fHx395+vSp5ebNm7e8TeyRH0JkgQiCyNdoNI1ms9lEURTp2SCcTueKyWQyX7ly5Z8EQeTDp4uSUEDV1dV1JpPJ7Ha7XRsljAs0TdMmk8lcXl5+DhKARKRWq+tsNttcuAjjgs1mm1Or1XUQhyTykkbTNE1RFGmz2eaMRuOwyWQyWyyWKZvNNre4uPhaTOs0Go3DRUVFX0MckIgXFRV97U8aTdO00Wgc1ul033sHgjP+mEC+P5lMVqhWq+v0ev09MSxXr9ff8/YXkySipqamDpqmaZ/CNptt7uLFi40ymawQ1hMVlGyZTFao0+m+t1gsT0IlkKIoMtasEMlkskKj0TjMJK2qquoyhEdJpFAoynp7e/tDydY0TdNNTU0dsLGLKd5AfIOgKIrUaDR/h8hcWSSTyQrb29vvh0Iiw42jAqRSqWp8bmqz2eZEcM+Q9FAoFGU9PT0DwRJosVieRGNuiHQ6XauPuJ6engGIvhsguVxeSpIkFQyBi4uLr6VSaR5EiECk1Wp/8HXe3t5+P1IdCwAOAHhbW9uDYAh0OByOSFggUqlUf/J12tbW9iDcHYYIXKFQlAVjhQwCwwIkl8tLfa46Ozs7D9F3VT4guVxe6nA4HEIJNBgMIxCOMTHjCUmSlEKhKBO9E/GBCILIt1gs/xJKYGtr6wMQmUA0Ozs77+tAq9W2QWy6Kxdwg8EwIpTA2tra70AkAhEzABsMhlGxBEcYyGAwjAohj6ZpWgzPQgqFoowpWC6Xl4oxkigBCY2BYsR0nJmxvFYXT+7qD0QQRL7QLNzQ0NAJIY4Xb2ho6GQKKygoKBF5MNHAmllDIPdFCOUF3YP/bN1qtc5DfFsdE6i2tvY7IdYXirehoaGhMaYQb4ZNJKDu7u4hIQRWVlZ+K1hqQUFBib+AcM6+owWEUJ6Q+Of1OkHJY53VTU5OTkPiuCwTqLKy8lvRrE8ul5f6f7G+vr41AgOJFgS5r5CYj+rr61v9v5ggWZYTCKE8Idk3kPUh/xhAkiQFiemyTKDW1taHgcjr7u4eAq7Yx+b/ExMTM5xfSCAQBJEfyPr45n3rEoXH4/HcunWrN9IDiRJwIdZ37dq1n1i/zJa2z58//7dIjyJaEBL7/BMHBgBQUlLyVXp6+nZ/gTMzM1MR1D+qsNvtjrt375r42uTm5koJglibA65evdrNxvTu3bt/G1aNYwwEQXwRyHX9p2745OTkNFtDSIJk4QdktVrn2bjwYXBw8DF4ecEAAMvIyEj3l0JRlBO4V2kmKuz9/f2zfA2OHj36+eoHLlP1zvGSzfJAKpUGTBy+Gwfs5MmTf2QT8vbt239HVu3YwPPnzx0LCwuLfG1UKtU3AADYzp07M3naxdQC6gghoOseOnQIAQBgR44c+ZynXaLfmrHi+vXrvPPbrKysdABA2NatW3/F1iAtLY31eDLAbDaPuN1uN9f5nJycLAD4iKWlpUnYGqSmprIeTxaMjY3NcJ3zcoNhu3bt2hFBneIFjunp6bdcJyUSiUQqleJYSkrKR7YGbLdryYTR0VEj3/nMzMxs3klwQUHBMXFVih90dXV18Z3Pzs7GMY/Hw0lgVlbWZ+KrFR+w2+12710WKzIzM3/N6bYAAHK5/HfhUS0ugLlcrvecJzEM43XbnJycXeLrFD948eIF503Chw8f/ou9efOG0zRxHN8GSTpRBgC7w+HgvEXFMCyF1/IOHDggFV+n+IHT6fwP1zkMwzCMj9309PTtBEEkbdJ49+4dJzfj4+Nj2KtXrzgngwAAXL+6JDscDocDGxwcfMjXqLS09CQkadxbWVlZZjvudrvdCwsLr7GxsbFRPgGHDx9O2ri3srLyhu04SZJOAMCwhYWFRb7JII7jWQihpPtFGQBg3759B9iOLy8vUwDeZxSBfjnVaDQa0TWLYzx79uwXALBjAGAfHh5+yddYqVT+BpLweQYXJiYmngF4LW9kZMTM1zg3N1daUlLyVSQUiyXs2bNnJ9vxgYGB+8zPKNATI++6laTKumxr95grx1bvMB4/fjzNJ+jLL78sXLfUILGBpFJptv/BmZmZefhUXWiVPPuNGzc6+SRJJBLJhQsX/gzJE/s+bt68OdX/YGdnpxn8nyoKWSWUZA/CcTYOuBa3o+7u7kE+8jye1YUuCe++bIs9vYvbV42H+auKXa/X9wUSevr06d+HQ9lYw7Fjx476H2ttbf0ZeBYCrNkeyoWN7MuKEyD/lWOC1mdrtdq2QOTRNE0n4sYWBtZN3YQazLpV8WwYGhoagwRNHmzxTuh2WSTE+jwej+fMmTOXIPEIXLexOdhN2oI29pIkSSWg+65Z3E6SJBXsJm1UVVV1WYj1eXdFJ0zy8Pe6UEugIKGVIRobG3+ExHBfnDnboCiKhFANQ6FQlAnZl+XxeDxhrFwWMfhvXNRqtT/ABsaENzY2/iiEPJqmaW9siFcLXFNCRKwiNUho0T+Kosg4JRBnlnpijGPjkMlkhULr1MUpgWsyrNghaE29PCEEegu7xEMMRHq9/p5P93BVZkM6nW7dZmY+AlUqVU04FBERSKVS1fh07u3t7Ycw6oszr5IQxEqNThbgSqXylC8cLS4uvoYI6Infvn37p2AI7OnpGfCWxYwVK0T+xEWyBCYKlsAYKrW7jrhoXNigCfR4PB6TyWSOIol4dXV1nS/xWSyWKa/FRSWsoObm5vZgCaQoiuzo6OiKIIlIJpMV9vb29vt06OvrewgxEItReXn5OafTuRIsiU6nc6Wvr+8ho+y56LoRBJGv1+u7fNbmdrtdLS0tbWHqLyQgpVJ5ampqyhIsgT6YTCazRqNphP/XiN8IcKVSeaqjo6OLOTddWlqyK5XKUyLIDwtQS0tLWyhW6IPb7XZNTU1ZWlpa2ioqKnzvtkDAbSk4eC3s7Nmz2o6Ojq65uTmbv8w7d+50BpATNMLxGhtUXFysrKurq8nLy/tCDIFLS0sOl8tFLy8vr1tsuGXLltTs7Ozd27dvX7dbHQDgyZMnU2q1+vKjR4+GII5ed4OKi4u/GR4eNoZqhRvB/Pz8bE1NzV8gRl1UKFZJ3Ig7C4HPPY8fP14BcU6aPxAAoEuXLl0Vk0in07nS39/fe+7cub9ChF8YEq1Xd+EAgFVUVFQcPHhwn0KhkGVmZmZIJJJNO3bs2LFt27Y121jfv39Pu91umiRJcnl5edlqtdpfvnxJNjc3/8NqtT73Not4PIsWeVxgWo0HPunn++9DzAT9/wH8kxQgrM5ENwAAAABJRU5ErkJggg==","e":1},{"id":"image_7","w":88,"h":89,"u":"","p":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAABZCAYAAAC6yeORAAAACXBIWXMAAAABAAAAAQBPJcTWAAAAJHpUWHRDcmVhdG9yAAAImXNMyU9KVXBMK0ktUnBNS0tNLikGAEF6Bs5qehXFAAAIGklEQVR4nO2df2wT5xnHHxukuEIIhxVobq+ErRueNAETqpBCsC1n/NHSARp1k7j9ByGhRVGIS1BF/6mQJVQJiWmeIROoqpQasnZoi52QtilV3Fiz88P2NK1JG6RgGytcgyUU+wIS9h/Etz+aC8ELvvcu997Z6D7/JLFfP36er5977n3Pl+fVAQACgBI8Q7/8s7Tq99V/lz9e/jz/+/waY5QGrfEYH2t5DJXiW/0c/1oGxwHd9PT0FEJoLUck4/P5Bj0ez0k5bUoE5fP5KbmNHj16tD0ajf4DZ+xGAACj0VgvpwP19fUGOe2tB7ljE4t+z549b3Z1df0pFovFWZbNq+kMCcxm8wGPx/NZLBaLLy4u5tT0hQIAyufzfZHP53PcOvD5fF+oGcgLWImPZdmF9cRntVpb1uMIAgDk9XpvShXa6/XelEcTIlAAQAWDwW/UEpgHWa3WFikiV7nAPMjpdLqlxCdG4LWmWzxMNBqd2Ldv31vZbLYaplxyw/T39weOHTv2x2KxWCT1JpUEBgBgMpkM09ra+r5IJ3TrcUpBmEgkMnn27Nk/i3mRTqfjcMcKCbzixLVr14bEOFFDMFevXv1rKBT6FwnjOAIDADDd3d1n8/k8S8KJKmD+1KlTH+IOLpVKJeFRP4MrMAAAhMPhBM44juNE2a0GMpkMk0wm78ltV4wQjNfr/URuB6oIZmho6D9yGxWVaZFIZPIlLhMQDAb/LrdN0YcywzA4U7ZamUU8RyQSmZR7yiZWYCabzaq6nidNPp+X9XqM6Ayem5t7JKcD1UYmk5F1USVa4EePHhFb9VQBzOPHj1UtETA7O/ujnA5UGzgCE5sHa4hHE7gMjuNknQEREbhUKi2RsFuLaBlMGE1gwmgCE0YTmDCawGXIfalVE7gMnU6HvYjAQbTAYlYxtQhOBuv1emzdtAyWgLZUriI0gQmjCUwY0QKLKfAa2ixCEqVSSdY7ezTWgSZwGTjXgzdu3LgB1x4RgZeWlmr2ejDOjX1Pnz7Fjo+IwBs2bMD+hGsRvV6P/a2HlsESIHqS06Zp4iAyTXvZS4QYtGwkjFaDCaPNIgijlQjCaAJLQJsHE0b1iz0vew1WPYM1nqEJTBhtqUwY7RuNMlS/8eRlR7t1qsbQBC5DKxE1hjaLIIwmVhkURRnltKcJ/Dxo27ZtsjayEy3w9PT0f4XGGI3GTdLcUZ9Nmza9Iqc9IhlsNBrrSNhVgBJFUa/JaVC0wGNjY5NCYxoaGlTtFykVp9P5Ds440ne464W6nmzevNkAa7eWrWoOHz78Bs444ne4379//0Gl5xFClBS7KoP2799vxhlIOoMFu57U19cb4fmmzzWBxWLBElgMkjI4EAiMCo1xOp1vS7GtFu3t7e0GgwGr7/Hu3bv34dqVJPDt27e/EmoedOTIkTel2FYJdOLEicMAAHL3TpMkcCaTYRiGqViHrVbrb+DnVrJVj81mazxw4MDrLMvmcXqnKfF/cozf7/+u0gCEUIPZbK6FmQQ6fvz4uwAAvb29FWPi2bVr169xjUteaPT19X1aqUwYDAbD+fPnP5JqX0FKJ0+ebAYA6O/v/zyXywk23hNzSVOywJlMhhkeHo5UGmO1WndDdZcJ5PV6/2I0GusnJib+PTY2Fr9z547grgU7d+6U9YLQC6FpuqlQKBQqdYvu6Oj4WBFnJHDw4MG3+Q7YNpvtHQAAk8nUKNQBe3x8PAEKLaRQIBD4tpIzyWQyBdWZxWh8fDzBcRwXCAS+hWc+UkJJMz8/Pw9KxYSTxcs93avphIc6Ojo+5jiOy+fzOXheLJRMJlOV4ikUCgVQMGmQ1+u9KeSQXJ375cBut7fxpaGzs/MilIkVCoXCleLhOPl2IsCFmpqa+qGSQ8ulohqyeMXXYDD4DazhU2dn50UhgXt7ewcU9Zqm6SahLRMGBgaGQd16jPj9Mx48ePDTi3yhabqpWCw+wUgYRWOh7HZ7m1A99vv9AaUdWwYNDAwMcxzHsSy7sHyIv+iIonDKRFdX10UlAwAAQK2trd1Cn/7ly5c/B2XLBeIFwxAXAACsVmuLUBypVCopZIcEyOVyCYo8ODj4tQLOUTRNN6VSqaQYcfk4+IyvxPXr1/sViOP/nXO5XB8Ibco0MjIyStN0E5ApGdTp06cv8ecFlmUX7HZ7m8j3ovgPpxIul6sb1BDZbre3CYnMsuzClStX/iajgxRN000jIyOj/HvEYrHJ5Q9S9HuYTKZGoRiKxeITj8fTCyqcWxAAULdu3fpKKAtSqVTS7XZfAulCUyaTqXFwcPBrvjwVi8UnN27c+Oc6bAIAIIvFYpuZmfleKIZYLDYp4SiRBWS329vS6fRdISfT6fTdnp6ePofD4QJhYRAAUG63+1I4HA6trvujo6PfmUymRgwb2DH09PT04RyR8Xh8wuVyfQAASOntGJDb7X7/zJkzfzCbzb8SGnzv3r3k3NzcHMMwuUQicR8AgOO4JYvF0mA0GussFgvau3fvb+vq6lZuFkkkEpPnzp3zhcPhKGBubCrGf4fDYW1pafm90+ls3rFjxy8rDU4kEoK3OJCCam5ufi8cDoey2SwjlNU4WT80NPSlxWKxgTKHJwIA1Nzc/N6FCxc+CYfDoZmZme/T6fTd1Rkej8cn1N5QhAIAOHTo0O8cDofdZrPR27dvf3Xr1q2/MBgMr2zZsmXr6sGLi4u5YrFYyOVyCw8fPnwYjUZTfr+/b3Z2NgXVtc3wytbBagu8FqtrJgfPfFy93zEHAD8p6ZRU/gdeSP0GpjtZJQAAAABJRU5ErkJggg==","e":1},{"id":"image_8","w":63,"h":90,"u":"","p":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD8AAABaCAYAAAAPZo42AAAACXBIWXMAAAABAAAAAQBPJcTWAAAAJHpUWHRDcmVhdG9yAAAImXNMyU9KVXBMK0ktUnBNS0tNLikGAEF6Bs5qehXFAAAKAElEQVR4nOVcXUwb2RU+sFVjWHUD2WSB2QsY3LKhyTYNFXGMx1ZIIqUPiULCT9LtQx8qIRAlyZInkihCu9o2dBGuKY1UaStE0JbEgCFEFCglpOAfcJYouCQbszYlDdhsAXtIJWbYprl9wHaNmcEG2+BxvzfPvXfu+b5zzp0745kTBVsLAgCiWY6/dh5/7fxt3QpjokJwTgQAr0UikTA7O1uck5OTnZqaGpeYmLgrNjY2dvfu3W8LBIIYtoEMw9BLS0s0AMD8/Pz87OysfXFxkTYYDJPz8/PW27dvtzi7TgfD0GCQJwAgmiRJSVFR0RmxWJyekpKSnJiYSKw3iKIoBwBATEyMYMeOHaxisGFyctLy/PnzF4ODg1P379/vGRwc1MImxQiEPCovL//F0aNHf3DkyJHDcXFx8d4dKIpymEymr0wm08zU1NTLvr6+LpvNNmOxWP7h3ZckScnBgwd/lJWVtTczMzMpNTUV+RIQYEWMrq4ug0qlatdoNFoIYcoQIpEop6GhocNsNlswC8xms6WxsVFNkmQhrKQA2sQ8CAAIuVx+TqlUNnPN5Q2j0fi3qqqqBliJxs3My026ra2th6Zp2ntSiqIWOjo6uoVC4eFgTuoBRJJkoVKpbHY4HHZfIjgcDrtSqWwO1BYCAFB7ezsraYfDYS8rK7sBQVZ6HSAAQAqF4o4/IpjNZotHBG5sIrlcfs5ms814n5SmabqhoaEDto70GtsAAKnV6j/7EgBjjNva2no2YiuhUCjusHnbZrPNbFbNEACVlZXd8CcKbDbbjEwmKwAfdnMqqtPpHoYwrzcLJJPJCvxdC/Lz8y8Ah/2opaWFkzjXoDAAIRKJcthS1Bs0TdPXr1//DLy4ENeuXfuMbYDRaHzi3TkMgUQiUY7VarX6EgBjjH/zqyu/c4+UyWQFdrvdwRYqUqn07DaS2giQVCo9y8ZjTQRYVMPuQTqd7iFbp9ra2lYIf697gpDJZAVsi7Ub/5pYxk9vNAPAitdZ1aFpGvhF3AVUW1vbykn+q5vd7o5cXtfpdF/AyvWRj0BGo/HJGlILD+fcXgcAgitHamtr27bT+kAhFAoPrwr/ZQpj0/+8Hp2fn382Pj4+jm2wyWR6unWmBh9TU1PTXV1dWveBOc04/Jui3L+vXr36e67UcO6IeA2397+hMB7/ZbNnW3RaWhrngvbq1atXoTcvtHB7/5+ace+2b8XFxe3YDqO2ENMFBQXH2RqiKYr6hmvUgQMHskJn0/Yj+uXLlzRX47Fjx6TA30udT0QPDQ3d52rMycn5/lYas+UQCoWHOXdCGOMrV67cBH7u8vwCWu9GwG63OxBCh7bbyFCB6O3t1a7n/YmJiUmIVO+XlJR8tB55jDHWarWjEKGLH5qZmbH5EmBsbOxpGD7GChhETU2Nyhd51xogkUjyIMIEWHfh8xagpqZGBREkACouLq7yh7wL3d3dWueVICLWAtTT06PbiAAeURAZAkxMTExuRACMVxbDiFgLhEKh2N/894ZWqx11isDbSPD7EXCkioAkEkleIAJgjLFGo3nE13RAaWlphx4/fvxlIALwXQRCpVINBCqASwSxWHwaeCYCUV1d3bzuPyEbgMlkmiouLq4C5yso28zNLyCxWHw60HXAE3a73VFdXe16hSTsowEBAHHnzp0HwYoClwgeW+bwF0EsFp/WaDSPgiWASwSPSAj7dECVlZU3g5kKLCKEdSQgAEDV1dXN/+8iECqVaiAUInhcHcIahFQqPRusvYEnPDZLYb8eEBKJJC/Yi6KXCPyIhFBcGfj0LAFJJJK8YK8JfIoCAKcIwbw62O12R2VlJa/+XULgvGcIlggqlWoAeCQAQJD3CT09Pbrayz/+2XaT2igQAKCamhpVoCLYZy2O/xg/btpuQptBcER4UtPic6YwBgGBiGBpGtpuAsEAAgC04Uvk3MjXmKehzwYklUrParXaUb/IL9nwuuRLSko+amlp6Xf++8oXoLy8vFK/ouDL397jPEtLS0s/xu7XT/gEBADI14sV+OvB51zed3/Xmp6eLtwqq4OEaQCYPnHiRKFCoVAzDMOw9vpORgrXCdzkMzMzE4AnNwhesFZUVJQfP378pw6Hg1rTGpMA8KZQyDqytbX1Lxiv7I2BZ9tCLxCc/zAtPqPZQt/t+fj4+DiEEB8974JVr9cbTp069fM1KfDWewJ4QyDwHrDqW/aTJ0+eDLGBoYZVq9UaLl26VLOm5e1Dh9Z4v62trc8VHb29vRrgd+i7gHQ63RerQv8VjbGpfvVlz5XzGGNstVqtEBnk2b8bshsXPb0fHRUVhV0/kpKSkqRSaUS8bTk0NDRsNpv/vupg/PtvwZtCoUuANfUrKioqSiEyvD+t0WjWfiaDTpHwRowAwMvzAAASiWTfFhkXcrC+Tv/tnQDvyOTY+HFTNMZ4VemIpKSkpNLS0tItszCEePbs2QRrw+5D7zBRe3at8TwAQEVFxU8gMkKfE580PjIA1+fipaWln2y3gYGioaGhk+t+BwAQW8EeAAC4fPnyeeC391FycvJOtgaLxTIJAK+jo6KiXrN1EIlE6QqFohZ4LMC+ffu+y3b83r17owBghfb29h6u0KBpmnaWiOAd8vPzL3DxcnNajzzGKxVHgH/eR3q93sDGR6/XG8B16+6LPMYY9/X1DQJ/BEByufwcGw+Hw2FfFclKpbLZF3mMMe7o6OiG8BcAkSRZyFU8pLCw8CJ4PbAhOjo6uv0RoL29vcd7cBgBrVc0pLGxUQ1cVVIaGxvV/gigVqu7IfwEQCRJFm6GuAtEUVHRhxRFLfgSwGKxmJ25Ew4ioKKiog/ZQp1hmKXy8vIb4Ge6IpIkC4eHh0d8CUBR1EJdXd0fYfsEQEKh8PDdu3f/5MNBG16niPr6+s/9iYKRkZFhuVx+bjOTbBIIAFBVVdUf2OxjGGbp1q1bbYHag3Jzcz/o7Ozs8iUAxhgbDAb9hQsXPoWVSAhFNKCMjAxZU1NTK1tuMwyz1NnZ2ZWRkSGDIDoC5ebmfjAwMHDfn0igKGphZGRk2EOIzRqCXITr6+tvGQwGPcMwS97zzc7OTm+W9EbKQBIAAPX19b8+evTo++np6d/zVbtyeXmZtlqtM+Pj4xP9/f2msbExw4MHDzRc/TMyMtKysrLEJEn+cP/+/Ul79+59LyEh4V228w4PD+vVavWjuro6JaxUTd1w+cfN1sBEAAAXL16sOHPmzIGUlJQUgiDe9beQ5+Liot372M6dO3dx9XeJqNPpHo+OjloVCsWnzqaAqqAGq/QrAQDR58+fP5+QkEBkZ2cnJycnx+/Zs2ePQCCIjY2NjREIBDECgSCGTaDl5WWaYRiaYRjabrcvzM3Nzb148WJhamqK6u/v/+vAwMCgs2tQSr66EIq6t97YSB66iv8GlSQX/gtg+oak/ua8twAAAABJRU5ErkJggg==","e":1},{"id":"image_9","w":162,"h":202,"u":"","p":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKIAAADKCAYAAAAmVZssAAAACXBIWXMAAAABAAAAAQBPJcTWAAAAJHpUWHRDcmVhdG9yAAAImXNMyU9KVXBMK0ktUnBNS0tNLikGAEF6Bs5qehXFAAAgAElEQVR4nO29e3hb9ZXv/VlyKAlDHDn0PE9zgWxTIKRcIjOEWy+WM6Xl0DnYgWmnLSm2y7xnGqC1zSn0UJJKJqSZAlPLCeB23oLsDvCeTgtxOD1ML4Mtd6ZcCsUOl4aUi3bIbV4usRK3JBBrr/PH3luWb7FsbckS8fd5eLCivX9akr5a67fWb12EYwC6L2pQgp+kFYAkIMawCyzApybqSyCa4PCsPimvT+Rf0mMXMt0CeA2NR/2cQBChEksDiAZQ9dtvVZ2rREEF1RE3pz/WfpBtIH0MWj0cZ/XJgjVmft7FsYcPBBG1P+rHopYkNagGnX91nhUSB/6Muesd+l58AwBz19upS0Rs/hknn4Rx8ofxl87BWFyGf95fKC571SWt9AEx1NoqJ6+J5fM9ftBR1ETUt6JBkO+gWpX2r8R++zI9T+yg78U3iP12B4mD7056bX/pCQTOWkzlxWdQdclSXX7WYvGXnmCzVgQgjkUHs6yOGU2ZPYqSiPpmtA6hASUAgKCx/3hZOn7yWzofe25KxMsEwYvPoO4LF1N50RkYJ5/kCKMgtENJqyz+7305eeFjAEVFRH0rGkQkiqqBQuLgu7T+06+J/OBX45IvcPYpBM46Gf+8OcwrPSG1U3TfuLnrbcds75oUgYMXn0HtFy6m7vMXKYogKEoPs6if0ZCTR1EQUfujBkmJolSCivnG2zTfuZX2//Ufo641Tv4wtV/8OMGLlxI49xT1nzjHIYmmv9e0x6KgoCqJg+8Se/KPdP5rHz1P7sDc9c6EshmLTyLU9DmCF5+BcfJJ9ro+aaeE5hlCZo6CJ6K+09GAahjwJxLv0nxnJ5Ef/mrUdcGPn0nom9UELznD8UCwPWPEBKsPFRMhgWUJPp9iWQI+BTVADYQAlvoRSZG08xe9dPzkSTp/ObHFNRafRN0XLibUdLmtIdE4cJuccn27l5/HBxUFS0Ttj/oZlC1AEEFbf/ArCd/ROcp8Bj9+JqGbqgleshRsq3sAiw402TnZeKDuvidAyXEBVKtBqt1/N994W5pCP6Hzl9smXMNYfBLhps9R+/mLHHmkg+ThJilvmolLHgUFSUTbFPu6UTUSB99l1TWbiP325WHX+OedQOimahr/+2ecOI1lYrGJQ752L4LRuq/NIEkQkRDIEoD2nzwhzS0/z8hk133+IlpCn1d/6WxBMfmQr2rGVI+PgiOi9kcDJKUb8G97cZfWXNMq5htvD7vGOOXDdG+5GePk/wKiCSxp5V0iuToN0T0/DIN+A6XM3L2f+qZ2Yk/+ccL7jMUn0f2TBnfvuBNLVkn59TOedaFD3+6o1bc7VN9q1+jmv1P/vBMU29ym/gucc4rGf3+n6ptR1Tejcd0XNfIi2742Q3f/oFv3/NDS3W0auvGvR8k21n/+0jm65f/9e9Wd91i6855+jd8TyIe8M5gi9O1ojb7dYelb7Rq+edWYX6pxyoe1/9V7LH3zftW3ols0HvXnXc5dbWHd8wNLd//ACjV9LiMyAhpuulz1jXss3Xn3/hkyFii0PxrQdzr269sdVvjmmnFJ6GhCS9+MRqdV3l1tYd39A9VdbVbj363MnIyNl6uad6vuvGe/xtuMaRJ/BmNB+6OGvt0e17faNbLhy+N+ib1dzapvRS19M9o7nfK60N0/bNRdbaq72jR48RkZkzF612qbjObdcY235F2jFyp80/ni2h/1k5RuFKPzsedovPWhMa8L3VRN4OxTQNlJklV5FnNMyOK/jwCtCBr9/jX4S0/I6L6m2x6m7w+7AQzkuC25lHEGGULfam/Rt6Ia771L/aWjHRMck6xvtVv6ZlTtJIfCgu5q69ZdbVZL6G8y1orG4pM0/h/NtmaM3904XbLPADtxQd9qt/Ttdss4+cPjm7LN17omeVr3heNB422G7rpXdde9Gjjr5IzJGLzodFXzbkvNzTrjvEyTadb+qIFPQgBN335IUvmBI2Cc8mHq/vYTdsA6SXP+JMwcUr7GRIigEGr6XMb3xZ56hcj93U4OhtWSOwmLA9OzRzwiIVSN2BMvS+SfRp8bu6j7248DCCLtsqDezJd4k8aR95oR0ZrPnquZ7hUBmiOPkRg4DBDU+OZgrsQrBuSdiPpmNABaB1B/w4+Oem3tFz8OoOiRH+desqnDPkeWrSjSeG3VxDc4SBw8ROt93WJba0I5E7AIkH+N6GMLKM13bGU8kwx2HqFx8ocV1Z3yX/6fWP4EnCq0FdDKi0+f1F2R+7tJHDwE6DGtFfNKRH0zWoelhvnG24Tv7DzqtZV2No0gEsuHbNnCrmHRA8GLTh/K3s4AiYOHaI3GcMpjanMkXsEj3xqxFkSb73p0wguDl5zpWCyN5VoozyASAyF40WS1YgzsmoPqYzXInTciOnvDoPnGWzJWZvVIGKechM1EmTgJsFBg0QNK5UVnTOq2xMFDxJ56VUDLgGMylJNPjdgAaOyJHRldHDjrFAVR/oyZU6m8hJXsA9HAxxZN+taep19x1vDVeCxVUSCPRNQaVKX5zq0TXumfdwKgAnqguDouDPahKpPZI7qIPfWq/YfPV+mxUEWBvBBR//8f1aDqj/12x1E9ZRfGYueLFDFzK5m3kPKmBELCP3fOpBwWwD5/VgW1ZkxzziAl1SBs/UVmiTP+eX8BiGJZRaQNHaiaAP65mQe2wd4nmrv7QQSNtxg5kKygkR8iWlYQVTLdHzrHsQVXxpARhASAv3TOpG/dtn23ogrJY89hyTkRdfc/BQDD3PV2qvfMxBAg1bymuKDsBFiyeP6kb+0/eEgQUSg55kI4udeIHyoJgLLtpV0Z35I48GdQFYQi/ELsj1SmoM937t7vRKzU8FSkIkDuiahaCRB74uWJrkwhcfBd1zoXIRFVs1LmxbkhyRqzcv4KigHQ9+JkNOIhnC+zGImYHZW0SPfGWSL3GlHsjfekiHjwXezWH/ino1IvK4hvHrg/phlkipwSUfe1GSjzEgfenXSruJ273gEUZhebVrT8QJat8SyPZCke5FgjzjJQlcloQxe9L+wUEPAlj7lQxjTXtE0LcvuOVfwgemAK2mHn7v2AKsmk4blcuYRl74nNPfsnfWsq5KPFdaLkBXJLRJ+1BJR4Bk2LRqLvpTcAASlZ7r1gOYSwBNBMGjWNRFnpbLV9tGTxnShliVxrxDKAqWhE25wrQNBTmXIIjd8TQBFz9+S1IcC8uU5T0RJmiOgpLGfTPYWwWt9Lu0gc+LOgllE8nrPlB8Xc9c6UQjDGolSihOmZSEWC3BJRMOyWwH+e0u19L+62/zj+/aB3QuUQPgmAuJ0cJg3jZHuPKOVNpodSFQXy4p71TzGmFnvSTZIokhw9lUpgSkQMfGwxgN1H8RhEjjWiZJW40OM2w1Qr6IE0eYB9RrztD3smfad/7mznfN1neixUUaCgA1axJ3bYCRAQKPR9ot1mTgOJg+9OUSMuAgQsLZ4aHQ+RYyKKiSrlU0iddxF70qnlOP79Om9kyhUGAyDaNwVtCBC86DQFVYS4x4IVBXLvNYtklVi49Re9jokf6vJfkPBJNSBbf/X8lG5fsugkAQSfNaMRPYdwAFUtm0Q/mJHo/MU2Eok/CarBgjbPShCU2FMTN3kfCWPxfALLFgIg5U0xbwUrDuRaIyYAmTeFtHkXiYPv0vfSHgAtVPPstJUzzN37mYppDl7oFOQLMU8FKyLklogls0xUJ13RNhKtP3rc9iitQjXPVg2qxJ56ZUp3V154mrOMdngoVFEhx87KoAm26ckGsSf/SGLgkIJVqbvagh4I5jHsnjUdP3t60nf6S+dQ85mz7QclMxoxJ5AFa0xEMBaflHGP6bGQOPguHT950j42K7ACdNssi2HueWdKGrHm0nPwz50DQuxYPFFxkYeaFcsEsjbPzmBGQbWxsJwWbYC0Tg2TRO2VF9hRAZF2L6UqNuSeiBY9AIGzFme1TOzJP7pjx/wc/14htW8LIuhUzHLwwtMIXnQaqO6U8oZjdn8I+SDiLOlFlcDHTs56qY5/eRJQSGpBNCrS+KY6RA1z1zsyFbNce9UF7p8xL+UqRuSeiEn7yKryotOyXqrzl30kDrwLQoE4LVKLKs2t/zrpO43F86mziaj4tCAb1ecTuSfi4Ow+hP7A2SdPqtH5WEgcPETkR11ufuO09px2RpgF7d6Gk9eGoW9cZpdAQ8ex7KS4yDkRpbw+gbINRWouOzfr9Vrv6yJx8F2B6daKyRAonb96nslmZAcvPI26qy5URMwZbWgjT9k30glQedHSrFdKaUUA1WnRirY2tOqAKZnl9ju/rKCCpTPa0EF+iDioWwGt+ezyrOKJLtK0YlD3TceUz2QIoP1nT09aG4a+cRlLFpYJYMrpTeEcCFeUyAsRpXyNCfT4586m+rPZm+fEwUNDHvQRK69a0ck7rEUnrw2NxfMJN1xmP/BJ2HPhihh5TIy1OhHRus9f7Mlqkfu6sTsWSW1+taK9N2x/+HeT1obdD97gdPuS9mM9bjgS+SPi4PsdqHUgePHp6kVM0dz9Dh0/fcp+kCetOHxv+Nik7g01XIaxaD74iOPTphyIV9TIGxGdMWHtKOKFeQYIt/wfOytHqcvPRPgjIRTaf/b0pGqXG+orCX/9s44C15X2ZzGDdOS3ZkWSW0Fp/GqVJ06LufsdOn72FKBQklutqPFNdSC15p79k9obBj62iMjaVU7nTmmc8ZLHRl6JKCd/PQYa85fOYTLDE4+GcMtjJA4eVlTrdHdu5h47SRYhUGmNxjLeGxqL57Ol7Vr7gaXN8tGG1lzI90FA/qv4ktqMoA0easXIfV12Ycyg5mju8UAIWGLu3q/2uLKJYSyeT/eD19u5mErnTKjm6Mg7EaX86zGQHv+8E7TBI63Y6k74FKn0esKnvrqpDmgEqPrSpoxaidgkvAFj8UkK9FGi9V7K9EHE9NQ1S7IZVRqvrdKpjIEYicTBQ7Te3w1qCSKe7RU13mZQoiEUmiP/mpGDYiyeT+yh69VYPF+Bbfi0asY5mRjTQkQ5+esxVHv8c2dLw1dXerKm13OPNR71o+93gxjtDz9NOAMHxdWESxaeJNgkXDVDwswwfZ0e1D7sb7y2akrDcUYicfAQ4chj2D0VJZr1ggy0AIa5652MvOQ0TQhCn6MJzezlODYwbUSU8q/HUGL+0tk0frXKk+E+rffHMHe/DWDozs0NU11H45tDQG1i4LBWfXnzhF5y4GOL6P35zbpk0UmA9s2Y4yKDxjcH1bxb+5+/U52Nfdb/BS86XdXcbKm5uX8qQ7g1vjmkr7eqvt6qdhuQo79eQ32l6msR1Vcjqn9saZ/6p3FsY1qbMNlaUVv9pbNpv+tqT7Ri7KlXiD31iqDqh+Mm5bhofHMItcKIaP1ND01YENWydhWRW1c5M360Wc5oqstG9hlMIzTe4tedd+9X826t+cy5nmjFwMcWq8Y3q8Y3qdOFIQM5Nof09VZLX2/VcMNlR13fWDxfux+6QfXVFtXXIpa+0tLo1ecxg2mExjc1qrlZ+5+/w/KXzvGEjJHvXOWSsWvC19/pmuNNVmN9cALTf5r29260TfHrra9rvOUYHL/xAYbGN3erudlq+c5VnhDRXzpH+7d9TzW+yXKC0mO8ZotfX4tE9fVW1ddate5vLjjqei1rV9kEfLVF9dVI91T2oDMYGwUz983OnhnsBfVXfWnzlPvIpKPuby4kesfVAAkkWZ7uyWq8xUB9W4DliYOHZNXf/4jY02PvCYMXnUb0e192jusUxNc4c27sLQqmY6yTxR0BiN55tSexxfafPe2QS/1YJSnHRV/dXIP6nkMJmLv3S8Vf3zEmCf2lc2hZt4ruB653+/eYlFAxQ0LvUTAa0YXGN/cCyyP3d0vT+keyXs9YPJ/en9+Mv3SOYvmupEQrUW0E6Pz1C9Tf9KBzIjMcaVrQ9uZVN1FCeCY+mBsUIBHvCYD1HKhUfWnTlHvKpCPU8F/tWhEFxG7q1Nz6CyLRnlHXGovn07J2FTWXnuNe34elTXL6sdlA85iGvtYa1vgmK/6bsHrhRftL52j8NyHV11q19+c3uwkJo64JNVym/X0bLX0tovpapH8mLDMD9PXWXn29VVvWeeNFBy88TRvrKsd8ru6qCzTe8x03Lqj6WmSLxluMPL7dYx4FZ5pd2HPtkr2gVH35bk+86JEIXngaoYbLCF54mrMPpAfV5hkznH8ULBHBNtEIIXP3fir++o4xnYqpIHjhaYS+cRnBCz/q9CYkgaU3ymlN7Z68wAwmjYImItgmGlgeifZ44kX7S+cQ7/kOzt7zAEgEn9U64w1PLwomjjguxFoFHGisr9SgB63tEgcP0bzpF6AqgM6QsDBQ8ESU8iYTtZpRlS1t13oS6I5Ee4g9/RqoljFI1AMxZ3CsQF+NdOtrEe1+6AZPvGhj8Xzt7/2u6ivfV32lJZjv9zOD4Sh4jZhCidYj9AcvPI2G+sqslzN376e59Zf2A9HoTALD9KIoiKjxFj+WNGBpGXZM0JN1I+2uicZgcHo70B7rKHyv+dW7avDNuh9L/YmBQxJu/SWt7aOP5qYKY9F8ev/3N9U/d7aAVM3EEKcHBUtERwtGUXuCQOzp16j/1kOTbgWXCRrrKmlZW6NYupPjpGLGi84/CtI066t31WARR7UmMXCYpts7qbr67mEkDF54GvGedTTWZb9fjLT32HUuwpJ8N/6cgY2C0ogab/GTJApUI0LsqVdlpBb0l86h5dYaezSEKomBw1pxxV2TahM3FoxF8+l99H/gnzsbxKqS02+KZfdu8gt9YWMQH0EswId9ZGlZgs+nqYvcx5YFw797xbJGc8HnG/6cfa/g89mzuIce64jXsmO07msOX3O0PE6vtIKAvtISxMcWlHmJg4ckvOkXtLb/Ztg1NZeeQ/R7X8RfeoJ9KqKYiAZiT71G1ep7spahse5TtHy7GhCz2Ey0vrQxDITsr1/TnnE4oUo6P4ZudB6LqJ19Lm6wf+jfRpIWxKGOoirOPe71krpm+Bpjr+Ng1tTetnew94KEUBpQiD39qtR/6/8bpQWj3/sSNZ8+G+w30MMR6plNgiP0Bi/8qNFY+ykiHb8Z72UyQqT9N1T/1dkEL/yowRENAcXT2VVlHqLEnnmdnmdeH/106g9FQBERl3iqioiIqo68LaWp0liTTrSRiswln6Dq0no88glAaM3KtBunCRpvCZDULShGYuA9bd70rxIZoQWDF55G9HtftNv+ivSj1m1y+v+IpNZ4pSUI2pUYOETFFf/ojYne2mS3zEtaVbKsOEy0vvjddkSuqb/1p9Le+dx0i5Mx9PnbgWl0VvS17zcwqL0oRt/2vVT8tztHkbBlbQ3dD1yHsWi+AjGOcF46CQHk9KYYPmn1z50j0X/4YtZymXv203z3r+0HJb7iCnTrKMNbDFCYBiJqvMWvr7R0YxEBtLX9N1Stvgdzz5AmMxbPp/uB62is/ZTzueqNcvqNVbJsnKZGPppRzOAFH6Wx9lNZyxhp/40d6EaN4vGiZQmo1Kw8i+CKU6dbmAkROHMBDasvAccq59U06x9bAvh0C8qSxMFDsuq6+50vPE3AZYvYcm+dbYoRE0nWZ+LB6istQdTqRkQrrrhL+rbvzUpW20TfaAe6LS14E60vbuwGDbpOg7l3P7HfxaX1gSfoe3nfdIuHv3Q2gaULqL3iPGpWLrOjE2nIGxH11e/XokSAedu276ZmTbuka0GAhrpPEfl2tSOZxJglk+ovqK/8YwtKY9/2vVRU/2PWMjfUfpLIt68AFZPjSwrai9Z42M+fjg8g1IIGAcP1Vvt27CPyz09ox9bn8u4TBFeUU121jLrq85zQmOtZiwnaDfIbkr5YXgTTV1pCoCFUpbXj32nc0DnqmtDXP0v4G591hWyVM26cdOGSxlv8HLF6AaN5868Ib/5l1rJ3/3iNk8mtETnjpqLxorV3Q4ASaQStRDAANff2U7/2YYk9E8/56wdXlBP62kqCK8rTwzoxVHuwZrVLxS1m+vU5JaJNDFrAqkWExts7pXWMEEvLrTU01n7SfmBZTXLmTZFRF2X6mtvvDFLi6wa0avW9EvvdaxPeczQYi8ro7WzCP3cOKAVvoseCPr+hDgghLEFVIg8+SXPb4yQOHvb8tYYR0HZEDqDayixfp5x1a9949+WMiDYJk90ogcSf3mOs/SBA+/e+pLWrzsepG/mqLP3maHU52de2TXSDuWe/VFR/P+tal8baT9JyyxVA4Zvoo0FfWB9G7R7j5t4EVdfeh7mn35O1jUVlRG+70iUgQALVVqxkRCrCE35eOfGadXuLwftWL8hyc2+/Vlzxj2OSMPoPX6J21fkCHEB9K70gIQCzfM0oO41FZYRu+EzWy0U6/h1bs6rBe4NF4kWPhpyzLkyypBzFNBaV0X3ftRiLyrJet2H1JfT+y/UELzhVQRKoNpMcLJfl68KZkBByoBE13mJwxOrGnksiVV9pY6RTAjYJ6648H/uYzrdKzmgaV21PSY4/3hFAfb0AVV9pwxsTfaP6TzzeThcrQhPtQnvDfmbN6gZZbu7pl4ov3D0lM+0vnU3LTZdTV32ec2IinSSP1GdKvnR4qhE13mLwvtWNqtG3fY9U1Hx/TBK23FpD3aq/VET7sXxVXpMQQM64uQ+0GVWiG/8261oXc08/zZt/KQiK6P1FFegeAakIJxgcrMLSbcZCP+GvrZx0HNzVqHXV54FdDVkv5966aiokBA+JmCIhltG3fS9VX2kbc28WuuEzNF7zCUAOoCUrxw1SewBZelMY6DMWz9fwDZ/J+tAh8uP/IPa71wUoahMNDhmtklWI9DesvkTS9nYTwiVhYOkCQEySJRVy7q3t2cjjCRF1e4vBe8lu0CV9f9hL1TVjk7Ch9pOEv34p2IdR9bnQhKPg03pEEw21nyR4wUezXq7+lp+QOHhYQBt0+53B7AWcPjghlFaAhqsvyfi+LZEvYyz02/HVpK9qZChmKsiaiLq9xcCX7AbbHFfVjk1CY9F8It+uVhSw9DbPHJMJIGfc3IfFbaiKZyb67l85qVJWVOPhojXRAAweaQUIrjB05GnHWGi5+fIhTWh5Q0LIkogab/EjR7agaph7+h1NOHrTayyaT/ePv4aTBdQqy24KZ/O6k4UTl4zZXvSlWa/nmGi76Oq9vyh+Ew0x/9w5EjhzwVGvras+j8bVjub0SBO6yE4jvp+MggTMPft1PBIChG641Gn7KzvlzG9OT6s3HawH+hu/8glvTPS3/4XEwGGwrEbdvjGY9YLTCdVtgNasXDbuJcZCP+E1zmAm1WYvSQhZEFF33BnCsmpsEv5QxguM1q06n7pVTphGS7wZRzoFyLJbTLBuQ0S33H0N/tKJzdDRYO7pJ/Ljf7cfqK+4TbRoHyDzThz/M6mtPo8li+aDYsrydWGvRZgSEfWPdzVgaRhg1Q0do5IXXBiL5g+ZQrWac+khZwI581sRoMc/dw7tG7+QtRfdfM+/YWf5qMGhOcVroktK+gC1936jYSwqI7xmpb0vtnKjTCZNRN3eYmBpGEGb7/k1R0u3Ct1wqZ3UKtIuy25uz0ZQz6CD9QiJ6pVnU/NXZ2W9XP2tP3WamGjxmuj3jyQA8c8b25Fz0vkVZFSygleYFBE1HrZHx6r6Wzv+XcJuJvMYsE3yXwIcwDrSnKWcnsEx0WGA6MYvaLZHXH0v7yV877+5lRzFbaLHsBHGojLqrqgAEJK+nH2Pk9OI7/1FCJEl5t79Gr5nfBIChK6/1NEUVqv95RcO5Mz/2Qr0+OfOJvrdL2S9XspEK0Vqoo+HcQoNaqqWOc+RM20IkyCivnRHHZbVCEjVNT+Uo51N1q063x4LIZiy7FthD+TMAZL1qBwIrjjVOenJDvW3/szJu7Ma9YViM9HvgX1WPOqZVDq/aEcuJciIiLp9o4FoCCB8968mTB0KXfdpu3habIemECHLbjGRZBOChq6/1BsTffevnUL0YjPRJQagI7/X4Ipy5wQFU85ZF8ulBBlqxJIQghF75jWa7/m3o15ZV3O+nVokmLL0Wzn9FWULWXZLOypb/XOPl+iGz2e9XvO9j6eZ6NnFY6JnYdcij0CtndAAPmnPtQgTElH/8L0aVOtQtP7bP51wwfANn1Zn5XDW0uUD7x1XD9IfvOBUGrww0Wsfxums0FA0Jlp9BqqY+/qHbRKD5zuJEIO+nCuUDDSitoDSfM+/jRu0dlFX85csKRJt6EIqmhIMJr+KKuHrPp11oqjtRT9ux9xEi8NEq2UAunNPIqUVg+eXYyz0K4iZSyfFxVGJqNs3hgDD3NPPRF4yQMNXPuEmAxRMuCYTyLnf7kQl4p97PJ6Z6Jf32Sb6zx8qfBPt8y1HRPp2DJWdpo77xNqaFxHGe0K3bzRQqUMhPMG+EOyC6cCyBQCmLLul3TsR84QjxzeDmMEV5TRe8/Gsl6tf+7AbW2zUF9YHs14wlxBdgirmnqGc1kq7SF+AvGRJja8RVRpQjM6ul+jo/P2ECzV85RMAihDzTLo8QiqaElhaj9pevxcmuvnex0FQtKSwTbRFBaCuRjQWlRFY+hEAcu0tuxiTiLY21EZQmv7h5xktFLzgVNssl/iKdpaxnHNLDCTinzubLZtWZ71e2PaiBdElDBSmiXa1dd/L+9L2h4b7ZyxfcoytES0JAdq+9bmMyg2DF5yKsbBMEem1a0WKGEcON4OYgaULCF33V1kvZ3vRCKKFaaItCQD07fjP1D9Vnu/0zlHysj+EMYhoa0NqgAljhi5qq/8SUEEkb4LnCnYth9YDhK//NIEzF2a1Xt+OfbaJVi3MdDGRSoCeZ4e6P6TqVyyJ5UuM0RrRIojovNjvXp8wXOMiVdVfUvxEBNdEE0GVLa1XZ527GG7rcjWOwcCsAjPRWgngtiEJrijHWFSmqJhSMX5nBq8xmohqt79tfeC3GS0QOHOBfQwEO4veLKfjyCikT38AABRXSURBVPvNYBeih9Z4ZaIVKBwvWns3BIAyc28Cc6+tdGpWfsyNgcbyKcswItonAWqYe/ZL5+N/yGgB23QJKNtyIN+0QSrCCVTqUaVx9SVZ9xzs27GP5h902Q9UotpbACZ6FsO0IUB11TI7eSPHSQ4jMVwjCrUodHZlRkKA4IpyO33Il99fUD4g59wSQyQCQnTDlZq1ib63y43VLaGkAEy0ag0iurXb/r6NRWVuksPOfIVtXIwwzRoEpWNrb8YLLHcrv5LywTHLaZCzv90E2mcsKBNPTPR3HC96mk20bt9oAJWo0tm1HYDq4DL3rDmWb3lSRNQXNgZRlph7E/S9nHm31VSdw4nvfSCJCMDgcfUAjVdfzGQ6IoyF2DNxIg88YT+YTi/6iBUE6Ozanoof1tVUOH/n51gvHWka0QqCSmyM0QjjwVhYZp+lIKaUT63nSTFAKm7uw9ImgOjtV2XtRTe3uSZal0ybFy1aC4i7DbNPU+zCeTl3XV6O9dIxRESRTyGiWx01nQmcvEMFTO9FKyzI8rV2kf4Cf9ZedGLg8LSaaCdWHAR0a8z+vodKAqZnrz9ERNUqVCX27CQ04iJHI1rWgVwIV3BIlthF+h6Z6NaUiZb782qiHbPcvrU3VfLR4HZwyLO37MIetta7IYAqfS/vm1SfPP+Js22N6NPcN2UuAEjFLSbKbQDR9Vd6Euh2Dg3K+XNeTXQISHnLabHgnJcEjAdbI5YQACbdxnbe3OPtoysp+cDuD0ciZaIXlhFdf1VWayUGDlO/7hH7gZUfE60vbQjYseKEuN5yw9UXO8+Kd4OwJwnHNOtygG07JjePI+Vu2dMujx0kB+uBRE3VMo7WLyYTxJ5NN9F58KKTNLiv6yIVrE8ybZlT7h7RycCYwmAYd5LlMQSpCJsozQDR9dl70eEhL9rIpYnW3rAfoRpszx3sTGzbLOf3bHkkbCIK9gZhzxQt7Fizfj/gcE20f+5s3dJydVZrpXnRYNGQMxNd4qtBtazn2bi6Z8u1V5wHoPgknJPXzBCORpTlgJr7pjDqQESHDYM+lmB70QeCK8qH+gZOEcMD3XJ/9sKNhZIQItq+tVfAjnrUrFxmN2I/Mn37QwCf9ob9jnk9aveGsZAYeM/Js9PpP8CfBjhedDPYjYqyLS9obutip62pDH1hg6cm2tayaph79tO+1R6j65SLSi6bK2UKHzhmeW//pLVaYuBdtUdLyzFJRHBNtHT6586mff2VWVmGxMBh6tY9Yg/kVg07aVreQH0NAOG27tQ2yh3ajVjTXvrrc9pNYO5NTHqf1z9wWFAVVLOfGlPMSB6pBxKV55eLpybap9HshXMTHLQaoGdkAiwybbHDdPiY5fw1hd/yzr0Jd5VzPZOoCGH3obbLC7wy0eaefvBJQLetD2ctYNIKAdLx6HMpJ6Xh6kvsiIevMPoT+UgxcfIw9/Q7HbA4tjUi4CQKdPjnztbobVdmtVYq0G3PXg7ZQeipQbdvNLC0DhEN39s90kmBIyXT6qS4cMI3MqW9TWLgMImDhwTwa+9Gw0O5ihPJwUaQnZ540c+mmWgrCxN9JBkCaO98TlxtGPpaFRSIk+LCx+CgU6MwtQVS09FLBr3bWBcppCKcQCzbRF+3MutWd81tXZh7E6AEpuJFO8mvde5aAP65s4eK3XLYAXaycPeIOpU9IqQdC6oYnkhU5HA2/hH/ibPxxkQ7gW7V8KRN9KBV68QNhxVHGQvLFOgpFG0I4GMQAGF0e7yM4JRJqlsfOwMgOdjsmujwmskPXEzHsHSxSZho7Q0bKHWoiqsNIRWyEZBpD9mkw8eHfAlE8J94/JQWiD0TBxEQgt6KVrxIM9EaWrNywolOEyGcbqIz9aJnHVcLasSeNVPasK76PDeH1Mx2iKPX8DmjDaY8o87c22/P3lP1exqALXLIOetiqG4CO3cxGwwz0Rl40U4Gdh2kWp4Ajja0PfGC2Ru68GGPvHeaMk4NW+0CHHXrZGfgwEqGUczA0gVEbr7cCxNtrzGRiT5ihUCN9L2h03gTVApOGwL47EJyHK04tXSmLXamr6Ba46FsRY/0PjqTnYk8FsJtXWLucU30hvBY19iN96kFNH1vGL7O3atqQXZrc+OICUCMBVMLN/Q8E7cHJEKw4JoMTTOkwvaiIfvygpSJtjsxjG2ik1YIVWnf2puKGwZXlNuNN1VMrJK8V+hlApeIfWDXLkwFiYHDdlKtiHKwZHqmjxYykoPNCH3GwjJCX1uZ1VKxZ+O0/vNv7RDH4HATrb1h+xSFobghpHIOBayOQgrZpMMmolomwLwMBkePh+a2LufsUqo9kewDBKkIJxgUu0h/9SVZVwCmvGgZEeguOc4+RXl0aG9oLCqjrroCFBNrVntWL5xDuImx2xDRwJkfmfKGOuaaZyVQKN2uCglScWsfqs2IqGcmGhS1TbT2bggg1CYG3qP53lFxQ0ULVxuCS8TkkRiqkpqrMUWk1elOf4OhAoQsXxfG0m3GwjINfy37QHfkgSfs3EVLo5SwBVVaH/htShsGli5wBjrKzkLWhuAQUSrCJpAwFpZJNr/UyANPDDktM1pxbFglq4ADDR6Y6PSzaNAl5t6EpBIlgJabL7f/kNwOdPQC6d3A+gBqqj425cUSA4eHMkaY0YpjIa28QNpvvyqrVnfDAt0gzW1driIgeH65Q3Qx8zE5Kluk977pBKgc6ig/JbSmtKJUzmjFseFWAC5Z4JesvWjnLNrcm0jVooDdLMp+scLXhpBOxEF6wGldmwUSA4ftvaKqzGjFoyBZUo+SaFx9iWZbpB9u62JV44Opx3XVFWlTRW8tuOO8sZAiolNcbablq00Zqb2iUqnPr585bRkDjpZqRsQu0s8idJYYODyUFwpD3coK8Ex5PAzvGKt2J6iaqmVZeXSJgcOE7RCCgBTeSIcCgSxfG0G1x186R1OmNEvUVZ83pA0L8Ex5PAwnouXrBKitPi8r7xmg9cEn3P4q/sIb6VBASJbUY+mBmqpl2pBleQHgdvWy++sXQsP4DDGMiI55jvlL56hzLJQV6tc+4npxDTMmemzYJlrCgIQ9qAAMt3XZZlpkCbM+5Ek5aq6QbilHz1lJaiuqku0GGuxcxea2Lpwi/KhTQzGDEZDlt7biKIBsywsAVjU+ROLgu6BWjW77bkGe/etLGwL8+UOp4+BRRJSKdZ1AIrji1KydFrAdl87H/yCAn8HklqwX/KAiOViP6oHgBadq4+rsxvSae/tZ1fiQnRghVkuhhdF0+0aDJFuwhjrJjT0UUrUV1aGWFFmift3Ddg20EtAXb2/xZNEPGKQibJLUelQltCaoxsLsTHTsmbg9YEhEUV9hWaMjySjCkvR/Gmc6aTICYgbPz74+F2wvelXjQyQGDqnddm1DQ9aLfgBhWyPp9M+dI9HbszfR4Xu76HnmdUCXMJjcUgjRCydbKIgOD8yMSUS7hcZQl6tsPWiwm4A2fe8x+5AeWmacl3GQPFKP4pkSqGl4UMy9CUEJMDBrWq2RPr++Bk21OBF8Q40dxp1g78SgYv65s7NO5nTR/mgvYTtvEZBoNq00PqiQinACn3pWpJ8YOEzVV+9zm/TXed3uLlNob9gAu+9j/8HDo7qLjEtEwO0V3e9FMqeL5rYuO31JxE9Su2fIOBpOkX7Mf+Jsabnpc1mvZ+7ttzvS2l9+SLfdXpv1opOAbt9oUHJcN1DWvvU53GkGyETOigOnV7Q7ziHrX6eLpjseo73z9wAzZBwDjtaqTAwcprntcU/W7OzaTvO9j4uTRd+Sr89c42EnWqKGuTdB0x2POU+ooBmYZheyfG0EIWYsLJNsxzmko37dI262yLwZMg5BX9gQcvZRUr/u4ak12B8H4bYut5bFVgA59qQ1Hvbzp1ndKAFzT8LeIgwcRsQe75N+7YREBGBw0NlAG1nX56ajft0jdDzaa8cYk9qrL343ryaj0JBGQprueCw1NRTIeoyGi3BbF+2dv3c+cytnZNTtG41hJLz2vlTmOGqBnVmemWl2IRVhE0tWoSQaVl8iXsUXAerWPjxUcWZZ7dO1mZ5upEgoos4+OvVcw+pL2BK52sO47iN2qxhLDY4kPSejvrQhwPvJsUkIdmkrQNJKjbHITCPinEOLNAGE16zU2isqPBM8zWTYXa+ev/2YythJ14TN9z4u4bRS0JqVy4h863MKEF6z0jOncVXjg67ZNzjinWbUFzY0kNReBKPv5X2jSDiUHSSmc4oHMPmuiLptfRiREKB16x6RjrSs4GxRs3JZem5enONKVsqyws8uzgb64oaoW4tct/ZhOh4dGtoeWLqA7ujf2Q2yhBhIZeLgu1R8/l5J/3KnCv/c2cTuv1aXL13gdoMLTzWRVl9YH3SK5ioBaX3gCRpdxyQN8V980x0wVJ+epjalXnQpMopo3dqHPSWjsbCM7vuuxVjkpjPJlD+cQoZu32jwfnILQiAxcFhXNT4osWeGxpIFli6g+/5r7R+larMsXxfWF27vRgn27diX2vh7gcjNl2vD6kvs/kXITnwalrPXTljnYjsjJQGQkDN2F3Nvgvp1D5P+XlyE1qx02vTJTjn31mGqfcoTo9I1Y3Pb48PGJniBlpsvTztZEJOkr6oYai8yga09fFE7pNGvqxoeknTvOLiinC2R1fjtoZvNsnxdGJz8wpLjekGXtD/6HPVrH/HsM6+rPs9uRO/mMyIJWwvTh1rbEBIofvD5ndmNAXtQlJYBmhg4LK0PPkHkn58Y8wdiLCqj91+ut39YolUjJxlk9UbSNWP43seHNYT0AqkPZ1GZ2u2Vi1s7ajzsJgk3gp2YsKrxwWFfXO0VFbS72dppJEyt0bvRoCT5HFA2bG/tEequqKDhK5c40+yHi+/8fxhnYs/G6ezaTsfW546qoaPrr7I7TiDtcu6t9SOfz/oXpb23NzJLvo+qdHZtp37dw56ZDLBNdfi6ldReUWGP6kJMoLmY0uBhuBYEOzyT7hlDynQ5N4wmYWqt3vVBSqQb0HBbl+cKAOxM7+CKUwks/QhLFpXhP3E2Imh8T0IODByib8c+Oru2Z/Rd11Wf5/SIlARJX8VYls0T1T7c1NiBSy820+kILF3AlsiX0zKYi4OQun2jwWAy6u6h+nbso37tI8MC1f5S+zzf2YooqreNR8LUur231VHiiwKE27o9O4HxGsYiZ8+/0K8oNzqltKPg2R5Dezca+JLdCAZAc1uXhtu6PJ9aOmovo5iINHOcL1ZIHrZu32g4DTPrABIDh7X1gSeGhWbA/qK2RL5MYOkCBUkAN2b649Jt68P4fN9BVQqVjL0/vYHA0o8wnkl24TlR9PnbW3D2QLnSjjDW5hrwSTtqdUznSC87G1pCqB3GAGjf2kvTHf9nlBmrrT6PyM2fw186W7F0J1bJpB2yXO/Ts0HKG1cxsY7ubOZkzrI+v6EOCDn7IQ23dUnrg08w2emnmaCu+jxqqysInl9ub6ZFBFUTiCGaF1LqSxsCWFTbE55si4AI7Z2/p7mte9QP0V86m/b1V2l11TLn85dOkkfqnTzQyb/+MM3ovQMzFaTtdxMkS8bcF6YjZwO/tTdsUDIrBNQCmHv7pbmte1hbDC9hLPTTsPoSZ46I30mRV7DfYwzoA+2hxGfKWdlNarc91yNB8C0HqXF/cGCPGo48+ERa65XhaFh9CeE1K52gvSRsp2TsfdOkZHp+Qx3YjTu3dm/XxjseE3OP95YoE4TWrCR83V/ZkY6krko/QRkPOZ88P2LvqObehITbuvAyCD4SgaULqK2uILB0wdhHYiL9oDttzSkmIgksPeC0cHaQBEpALYMSmYeFHyGAYuCMFnaRGHiP9q2/Z2v39jEDuWDHBkNfG3ZEFyNZUu9lbFR7NwQoYUsuncaJMIyEI05PjoacE9HFMHMtouaefgm3Pc7W7u05Mdku3BYqwfPLWb50AYEzFzhBVXE+rDQM16LjvhVzb0L6dvwnPc+8Tt+OfeOSD8YgoIqJWE3OEEnPMdJpzJep9pfOZkvL1QQvONXNwM+YhJBHIrqwww4lIYQlqEpi4DCd3XZA9GhfqJfwz51NYOkC/KWzMRaW4Z87G//c2cybOwfHwgIgqJp7EyQGDovbX8bc259R7Cy44lTCa4Jaef6p7j4wgVqtWMnIVPeCk0FaNo9dX35vV862RakcgdI5iqpJUq50mjVkjLwT0YU+v6EO0Vo3vga2l93Z9Qc6Hu0d1lSoWBBcUU511TLqqs9L07okUGtTvgiYDu0NG/hmpbRjz7Ova7itW7z6wQ/T9nYThRiDMqXtxrQR0YVjSsL2LD/71AFg576Edj8Tl61dfyD2bDyn5jsbuORLOUmgiIBqD8pWrMH2fBNwJEZsizD39BNu66Lnmfik95D+UtuaDN/vZu90TTsR06EvrA9iSR1QmQqDOLay59m49u7YJz3PxOnb8Z9Mh0fofgmBpQuoXrmMwNIF6p87O+0zlARqdeCjczpjmWPB+cHXAA0IhrtHjj0Tp2/HPnqejWPuTTgj7YZ+9MbCMoxFfpYvXaDBFeUSPL88/T0nUPVku1FQREyH9q4PMstXiWoQRg2c1MSfDrPt5b30vvyfstP5AM29Ccw9me3hjgZjYRn+0jkEln4EY6Fflywsk+CK8rROW0KqQFwxETpJ6lZnuE/Bw9GQ1QjVo5yzkU7c0GNNuy6GSCeDRzq80vYFS8R0aG/Yz6ySAPgqQYNYBPDJvBFer2sSBWDnvn7tP3hYEgPvAUri4OFRBPWXznGTTjEW+vGXzlH/3DmM8qZdiCiWbgPtQbSPpNU53WY3Gwz7XJUAqgYiBmhaeEpMVBPOUKgekr5YLtLxioKIYyHtQ1yOqgEEEPxOnG+ec5n9S04j6ETLpk5mlARCHyI70aRJsqRvsp7gDDJH0RJxImjvRgMsv/0fMAtswpYMXZS0EsyyB2IyOMsEt1/hDPKN/wt/fYTbyohP5wAAAABJRU5ErkJggg==","e":1},{"id":"image_10","w":70,"h":100,"u":"","p":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEYAAABkCAYAAAA7Ska5AAAACXBIWXMAAAABAAAAAQBPJcTWAAAAJHpUWHRDcmVhdG9yAAAImXNMyU9KVXBMK0ktUnBNS0tNLikGAEF6Bs5qehXFAAAC/klEQVR4nO3dv09TURjG8fdcWkQFf6CLEDQajHHSJoZBxg5uxsEYFidI5F/AwaG4uuvi5oJxcVETE6OGxOBAE4IuxFgbNRANiERqKed1MJUL9oFerLwHfT4LpTncc/vNuXc4TYsbGBg42dvbe0USSqVS6UqlsoR+Jj1e/Jj1jI2iKO29/20sej7J/KOjo7dSfX19uWw2e3EzB/pXdXV1dUbWJxEiVXWRqjrrEwmN9z6KvPdcNTVwxQBcLTWoqmOYGnjzXUdKvrx6IDOtR6SaR0VEdHlliGta/Xt10Nqe8eeqj3WD6eNjqo/X+7u1Y5wUFg+3bTBJYsVicaLRx9xSOjHcb30ORERERHGaz2V08kZWp58+fnL/duLdxUZIWUyKaD6XkfTudjl4ZkgO9GSlqUUW3Pxri3MJIoxOXu8R2dkWD2LNPIzmcxlpPX5BOs8P1QrivTc4K8Mwvy6bjuxN2XeqG45T3dSO/58yCaP5XEZa9nfL0csj0rx33bHOufQWndYqNhtVdUYRsVsxJmFeTB87V08USyZhPn7+Pl/vWKubL/d8AYYBGAZgGIBhgO0QpmwxqVUYkxebxHZYMSZMwqhu9A7l5sY2ElcMwDCA1aVU+RtjGyn4FeOcM9kzCj4MV0xgGAZgGIBhAIYBGAZgGIBhAIYBgg/jvf9/dvCsXmwSwa8YKyZhoihqtpg3CV5KAC8lgGEAhgEYBmAYgGEAhgEYBmAYgGEAhgEYBmAYgGEAhgEYBmAYgGEAhgEYBuC7BADfJQC4YoDg7zFWEYMPY4VhAIYBGAZgGIBhAIYBGAZgGIBhAJMwVp9aSyL4FXOovXmPxbxhhynPydmOwnOLqcMNs1wSKdwblNLslMX0YYZZLom8uTMo3z6MudPXxi1OIbybYHnu50oxjCJiFMY58I3/i9Mi7+5ektLslGUUkZBWzKexcXn/qF9ExDqKiF2Yle3KhYLIzLOr8vXtwxCCVNl8PcDSYjEeRCSMVRJn8u89Si+HT+xI6y6R8IJU/QCiAfaOH6zyWQAAAABJRU5ErkJggg==","e":1},{"id":"image_11","w":57,"h":112,"u":"","p":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADkAAABwCAYAAACkT9ghAAAACXBIWXMAAAABAAAAAQBPJcTWAAAAJHpUWHRDcmVhdG9yAAAImXNMyU9KVXBMK0ktUnBNS0tNLikGAEF6Bs5qehXFAAACnUlEQVR4nO2cPa7bMAyASSMnKIp3g4w5Q9ciS6bmBj1FpneeTNm6BHhAnbVDxgxd0qVFXwPkAOJb7MJgZDt8gGPz55siWbJJkZJpmTFuNpvn+Xz+ARGBiICICkRMdbmmrgdGVU9EhIiYeP+63NM/EVEBAMDbNuubfYqiSE35qjY3Mpdl+QuPx+PLYrH4xC9uhf1+vy2ICMcWZEhSSmheSQCAYmwBhoaI0LySAADm3dWPJccWYGiICGeSDtfr9fVyubwOJdAQnM/nfzPJnDwcDt+Xy+XXqlh7QWLlJonV1+Vmfdtvfm5+LEe2jciSFX/f0WdURKur1pXY/MIDIFQyLDlhipSSZE6qHBSVQkuRxq4xJ6eKj/skIlJ/M92Yf54E8BIMaBVcgg9Lji3AI/ChpFYXlBBz0grSsE7loIiEzr1f1IB0Ttq3pFZCSU7cQiaMG0veLbjWXYRwV45mdzWPDyW1uqAEH5YcW4BHEKurFVwsPDNJqFY9ND9Vxa4cHeg4xnN2uvKActfhx+q+dbs/N63KsvxBRjidTj9zIxGv7qxganWllo02U0q2EUpawZSSbTv8ppRsQ5TUu91uX9br9RdozyRujmRXNMPb5chFSZApt533Pz4yl8cW4BGEklaIBEKO1icWH+46tgCPIHbrODEnJ0woaYVQ0go+lNR6W5AgCtDVZkm+44WPOiLf1QqhpBV8KOniPilprHVAfLgrAKi0jgRR5rJW3FjybmLhmTChJCfcdcL4UFKrC0qInQEruFhdRenZFU+s3PVpxFybvs8ldiUy3ZMSfnMtUbLSarX6TES/JX3GZrfbfTM/JxFR52axlFDSCuYjHj9zMixpBASAj41y3x/KOH0fis7R9wc0fo62iKopc9s1AADgDW0j+4Zu6A2YAAAAAElFTkSuQmCC","e":1},{"id":"image_12","w":107,"h":114,"u":"","p":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGsAAAByCAYAAABUZi9fAAAACXBIWXMAAAABAAAAAQBPJcTWAAAAJHpUWHRDcmVhdG9yAAAImXNMyU9KVXBMK0ktUnBNS0tNLikGAEF6Bs5qehXFAAAMZ0lEQVR4nO2df0yT1xrHH97cmKJOmBiMb09dudVKzLzJNjNgrJ2tmRm5yb06vMOwEcm8MRK3Ee9FF7fcxOxm0bg7GsQQ77KJ3uDdABGhAsUJdIgIuOq1QQTk11ZW5WffNoP37T++9w9bwxBKz9u3fVs4n/+gPec853zP8zznnL4/oiByUQDAYwCAtLS0P8nl8pgXX3wxNjY2dsWqVatWxMTErJj55aioKJ7n+SiXy/Wr0+mc7uvrGwcAsFgso3V1dVdm1W0LTRfwiJLaAD9RAACkpaWlZWRkbElMTPx9XFxc/Nq1a5XPPffcGjEaGB8f/9ntdk/ZbLbBtra2znv37jm+/vrrC/BkQvwiRhuLFQUAyDdt2qQrLi4+fffuXbPL5RrjQ4zb7Z568ODBrYqKiuJ9+/YdBQC5x7YljwIA5ImJidsuXbp0zmaz3Q+1OAvhcrnG2traat5///1PPPYuOeEUACA/evToP8NRoPlwuVxjZ8+eLXrrrbf2wRIQTZ6YmLjt6tWr5W63e0rqwQ+EO3fu/LBjx45FKZpi06ZN+vr6+ouRLtJsZogml3qQA0UBAIqzZ8+eWWwizeb27dvNb775ZjZEqGgoOzv7Hz/99FO31AMZSkwmUwVE0ApSrlarNc3NzfVSD5xUOJ3O8SNHjpwAEbwsmJtiRXZ2dnZBQUHuqlWr4oLViMvlmrDb7T+zLDs9MjIyOjw8PAEA0NPT45j5vaioKAoAeLVaHRsbGytbsWLFyoSEhBeio6NXrFu3Di1btmx5sGwEAGhpaanXaDT7AICCMDshkZeWlpaInZvcbvfU0NBQT2lpacnhw4e/2LBhwxvwZMYKnbXevZLivffe++T48eOFt2/fbhkZGbGJabcXp9M5rtfrswKwV1TkGzZseOP69etXxeqg2+2eam5u/j4vL+9LjzgIgpsDEADI9Xp91ldfffXN0NBQj1h98fbn+PHjhUHuw8Kd1Ov1WWLNyqGhoZ68vLwvPYOHpOoTAMi3b9++12Kx3GAYZkKMvvE8z9fU1FSCRILRer0+y+l0jgfaCYvFciMzM/NjkFakuaABAJ05c+asWKLV1taGXDA6MzPz40A70N3dfUen02V6BiWcQQCALly48J0YotXU1FyGEOUwlJmZ+THHcdNCjWUYZuLQoUMFEF5e5A9Ir9dnWSyWGyIJFtT+ByyU0Wis9hgZFqsjgaCioqJzgXqZ0WisgiAJRut0ukyhBjIMM5Gbm5sfLOMkAOl0usyurq67gQhWVFR0DkQeExSIUAMDAw9UKlWq2EaFCbTRaKwWKhbHcdNZWVlHQayxUalUqUKFMpvNDRD+C4hAQSUlJeVCBWMYZkKtVmtABMFQR0fHTSFGGI3GK7D4hfJCnz59+j9CBRscHOyFAPM4bTQarwhpvLq6ugYWZ9jzBSoqKhIsWElJSSkIHDOk1WoziFDY0NXV1TVCxo3juGnPvhMPpVKZLCRPVVVV1cLSFcoLampqahQi2MDAwAPATB2osbGxCbehxsbGJiBCAcCTyf7w4cNfhAiGc2BA63S6TNwGHj16NOxvA0sEpNPpMoUcIDAMMwF+ehdyOByTuJW//vrrf/G3gSUEOn/+/CVcsXj+ad73OZ50QUHBt7gVFxQUfLtQxUsY1N/f34c7phzHTXv2XvNXjOtVbW1t7UDCn08+/PDDE7hi8fwT7/rdPHXSBoPhy9jY2Of9NYJhGEdeXt6/AGBYnG4tTgoLC09v3bpVHRMTEz3z/967XKKiovi5yjmdTm6+OrG9ymAwCN7EEYSDCgoKSnGEcjgck0CEkgShXkUWFaEmJyfnc+JV4Qk162+UlZW1A6eCc+fOXRPRHoK/KJXKZOJV4ctvPOvQoUN/xyl8//79fnHNIfgLbbVa7+F4Vmpq6ttSG71UQSzLsv4KZbfb7UBCYEh5GgZzcnJyZDKZzN+CtbW1d8DzHApCaHgq1s6dO9/AKVhXV1cPAHbRLSIsCN3b2zvgbwhkWZYFEgIlg8ZZWFit1ntAxAo5FADArl27duEU6ujoGAJyuh5yKACAzZs3/wGnkMVi+V9wzCH4ggIAeOmll1Q4herq6ozBMYewEPTdu3e7MBcX5IRdAigAoNasWeP3L8I2m+0hPHsATAgBFADA6tWrY/0tMDY25gCyuJAECgAA5+TCbrczwTOH4AsqJSVlK04Bp9PpDpYxBN9Qa9euXYdTgGGYX4NlDME3VHx8/FqcAr29vV3BMobgG4qiKLKyixCox48fk585IgTiVREEESuCwBaL5DjpwB54kuOkgxodHR3BKaBWqzcHyxiCb6ixsTEssQjSQdntdqxDWYVCER8sYwi+oQYHB7GuUIqJiVkWLGMIvqEAABwOh98n6StXrpQBuVhGEigAgPHxccdCX/SSkJCAdfBLEA8KAIZHR0f99iycHyoJ4kIBAHR1dY35W0Amk8lwfwMjiAMFADA4OIh16056ejr+A6AIAUMBADQ3N2Pdvbhly5ZIfqZtxENPTk46/L0craenZwjIijDkPD0b7OrqGvS3kFqtfkGhUJBVYYjximXHWWQAAKSlpf0xCPYQ/CEpKenPOHeSmEymViChUDKw8ha5Ryv0zPw9i+ro6Ljvb0GZTCbbv3//X4NgE8EfDhw48BlOKOzt7R0A4l2SgXXHPs/zvFKpTJba6KUKKisra8IRq6ysrAnILUDSgPtIIJZlWYTQq1LbvVTBunOf53m+vLy8AUjukob9+/cfw/UukruCz3zvKUa9vb3NGzduTPC3IpPJ1JqWlpYB5Ea7haBTUlJeFfX6S9xlPM/z/IEDBz4DEg59otFoduMcPnhpbW295ate7Nw1OTnpIOHQJ3RdXV0LrlA878cT6IR4V319/Q0gS/m5QBqNZrcQoTxetWDEQvX19dgz4eTJk98BEWw2SEj443mM5zoqlcpk3FMNlmXZlJSUnUDylxe6rKzsmhCh/PUqL+jTTz/9N24jk5OTDs+MWOqCIdwnentxOByTGo1mN3aDQsKh3W63exYcS1UwJHT1x/M8bzAYykDI2CmVymQhjc4QbKnlsICEwg1/zzSenp7+AW7+miXYUvEwpFQqk+12u12IUELD3zNG5OfnVwgxYEYOW+weRgciFM8HEP7mMqaiouJ7IticoNTU1LeFhj6e5/nKykoTiP3K9tbW1ltCjGFZls3Pz78otkFhAEpPT/8A96U7M7FarZ0QpIksWDCe53mTyXR9EeUxuri4uFroWPD8kzwV1KO6QGOzw+GYzMnJ+RwiNywijUazu6+vrz9QoULxUlNaqVQmW63WzkCMbW1tvRVhG2gEAKi4uLhayOp4HqFC1nf62rVrPwRiNM/z/KVLl656lqzh7GkoJyfn80By00yhtFptBkgwSVFlZaUp0A6wLMvevHmzI8zedYxUKtVrBoOhNNCQN1Moqfso+MXJc9HX19c/48WfoZ59NACggwcPnqisrDQFGu5m90ulUr0GYTAZkVarzWAYZkKszrEsy1qt1k6DwVA6I74HQzykUqleO3jw4ImGhgazGKFuNpcvX64DgSLNdw1GoCCtVpt68uTJvyUlJYl+mRrDMA6bzfaLxWLp//HHH7tHR0cflpeXl8NvLwef71qQpyKrVKr1r7zySlJqauqrmzdvXpeQkKCQy+U0zjOD/cXtdrOHDx8+VVhYeNqHbT4Jllhe0Pnz50+98847acEYgNkwDOPgOI6dmpripj3M/Hy5h7i4uOdlMll0KGwCABgYGOjfu3fv0ZaWlpsQ5hcU0VqtNqOtra1d7JAS7jAMM3Hs2LFvIAxyEy70qVOn/itmLgtXOI6brqqqqo30ExoEAKiwsPDCYhWtvb29zbN3ijhvmg8aAOjFIhrHcdNNTU2NUm1wQ8VTT3v06NGw1IOOC8dx09XV1TVqtVoDi8iTFgIBAHr33XePtLe3t4Wzt3EcN93R0XEzNzc3HzwRQuKxkxQaAOiPPvroC7PZ3BAOHscwzITZbG7Izc3N95w8SBLqgr3PChQaAGDbtm3a7du36zUajWr9+vXrExISNgSrQbfbzTIMM9nd3d3T2dn58OLFi1fMZnOL52NJ90jhLtZcIACAPXv27KFpWvHyyy/TCKHV8fHxa2Qy2fLly5dHy2SyaACAmJiY1d5Cbreb5TiOBQDgOI6dnp5mx8fHx1mWnbLZbBNDQ0NMQ0PDD01NTWZ4chLyGMLs1b6RKJYvvOHpMTz7ZO25/hfWpwmz+T+HeiMekM2s6AAAAABJRU5ErkJggg==","e":1},{"id":"image_13","w":84,"h":112,"u":"","p":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFQAAABwCAYAAACAVlfhAAAACXBIWXMAAAABAAAAAQBPJcTWAAAAJHpUWHRDcmVhdG9yAAAImXNMyU9KVXBMK0ktUnBNS0tNLikGAEF6Bs5qehXFAAADnUlEQVR4nO2dsVIUQRCGu4c7d8sIC0IwM/AF4DE0IzUw5AnMjCW9MjIyoMh4CosyscoqqoytMzCgKKoI5nRvx4SBY9kZ6fFf8eT/Eri77bvlv56e7p7ZRUXk8WQyebm2tvZQVUMIQVU1SIf4wv7+/pfDw8N33df/R/b29p5vbW09jY9DCGE8Hst8Pr/UxzknIiLT6fTrzs7OBxGRzfPz8+/hlhwcHLz563/ZHXF8fPz2trqcnZ19rKrqiRMRCSHoXZ/8v0jbtiZdZrPZD2f9EIqfpqqqB05EWovRfD6noD1ERyvxULPNsqKqww95kqaqqpETo5cyhubhLA/GPCndJ5qmMdtwyAOZzWY/OSmBYWKfwZo2iRQIStJUVTWmh4IIIWhRDKWgaeq6HnHIA/HeNxQ0g7V9V+Sh96k5YuFPuk2MoRlYemYo6f06EVF6HQ4nIjdWOEk5bI6A4aQEhikQGMZQMCVpE706QSw9KRAQigmktJbnLJ+BHpqhxHm4Lg8kTkqmtInip4kxlAIBiM1oxlAw7IcCKUrsGUOzcH0oh9V56rq2b3QgecyCtm3LLyGB956775Bw58gAsDkChnkoGA75DNa9TSLsNsGhh2ZwzpkXMJ2ISN/18cQ25Bd33zkO+X5KPHRkNbgQf0OuGtN68Xv3S+meTAwvMavQjk1fthGzkEXbVJjqvm/o2Kd+dt+3ret6JGLz0DjKVUQ2Tk9PP6+urj66rTG5ycnJyaf19fVnzENBhBA0lp6c6UHwooUBoKBA2G0CwyEPhh46ABQUiPe+GYkxD51MJu93d3df/eawVOXU9wW2cr2yWXxeEjbx9W7ls3h8PAeVdIXVZ3t57NHR0evt7e0Xic/vZZQ54RzTApulo2AZecRKCQwrpQwlbU2KCSTmoRzyQDjkgTCxHwAKCoaCAmFzBAwTezC81nMA6KEgVDVwkQ4MJyUgi8vIBEBspDCGgri2WcxiyJ16eTjkgRS177j1sZ/FtMlsOMQJLTvFMZTkoZhgKGgGy5ZwVQ2XlRLjIg4m9kCKmiP05jyMoWDMgjrnGCLSKGNoBm7FuWPiLTIoKhDW8kB4m6EBoIeCoYeCiHU/b7sOhvcPBcNuExhzpXSfxC+tlDgxAaGYYEpmeTZTMtBDwbBjD4YeCoa1PBgm9kCK/hcIxU8Tl5EpUIKVlRWTNt77RkVks/N87uZ9MQf9VnSGy8dmvLGg976p63qcOtB734iI/AKAq8U8ru5OkgAAAABJRU5ErkJggg==","e":1},{"id":"comp_0","nm":"Pre-comp 1","fr":60,"layers":[{"ddd":0,"ind":1,"ty":2,"nm":"Layer 2.png","cl":"png","refId":"image_0","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"s":true,"x":{"a":0,"k":170.5,"ix":3},"y":{"a":0,"k":193,"ix":4}},"a":{"a":0,"k":[45.5,61,0],"ix":1,"l":2},"s":{"a":1,"k":[{"i":{"x":[0.808,0.808,0.808],"y":[1.094,1.094,1]},"o":{"x":[0.364,0.364,0.364],"y":[1.438,1.438,0]},"t":0,"s":[0,0,100]},{"t":20,"s":[100,100,100]}],"ix":6,"l":2}},"ao":0,"ip":0,"op":900,"st":0,"bm":0},{"ddd":0,"ind":2,"ty":2,"nm":"Layer 3.png","cl":"png","refId":"image_1","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"s":true,"x":{"a":0,"k":256.5,"ix":3},"y":{"a":0,"k":211,"ix":4}},"a":{"a":0,"k":[44.5,44.5,0],"ix":1,"l":2},"s":{"a":1,"k":[{"i":{"x":[0.808,0.808,0.808],"y":[1.094,1.094,1]},"o":{"x":[0.364,0.364,0.364],"y":[1.438,1.438,0]},"t":5,"s":[0,0,100]},{"t":25,"s":[100,100,100]}],"ix":6,"l":2}},"ao":0,"ip":0,"op":900,"st":0,"bm":0},{"ddd":0,"ind":3,"ty":2,"nm":"Layer 4.png","cl":"png","refId":"image_2","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"s":true,"x":{"a":0,"k":346.5,"ix":3},"y":{"a":0,"k":209,"ix":4}},"a":{"a":0,"k":[44.5,44,0],"ix":1,"l":2},"s":{"a":1,"k":[{"i":{"x":[0.808,0.808,0.808],"y":[1.094,1.094,1]},"o":{"x":[0.364,0.364,0.364],"y":[1.438,1.438,0]},"t":10,"s":[0,0,100]},{"t":30,"s":[100,100,100]}],"ix":6,"l":2}},"ao":0,"ip":0,"op":900,"st":0,"bm":0},{"ddd":0,"ind":4,"ty":2,"nm":"Layer 5.png","cl":"png","refId":"image_3","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"s":true,"x":{"a":0,"k":434.5,"ix":3},"y":{"a":0,"k":211,"ix":4}},"a":{"a":0,"k":[44.5,44.5,0],"ix":1,"l":2},"s":{"a":1,"k":[{"i":{"x":[0.808,0.808,0.808],"y":[1.094,1.094,1]},"o":{"x":[0.364,0.364,0.364],"y":[1.438,1.438,0]},"t":15,"s":[0,0,100]},{"t":35,"s":[100,100,100]}],"ix":6,"l":2}},"ao":0,"ip":0,"op":900,"st":0,"bm":0},{"ddd":0,"ind":5,"ty":2,"nm":"Layer 7.png","cl":"png","refId":"image_4","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"s":true,"x":{"a":0,"k":518.5,"ix":3},"y":{"a":0,"k":209,"ix":4}},"a":{"a":0,"k":[32,44.5,0],"ix":1,"l":2},"s":{"a":1,"k":[{"i":{"x":[0.808,0.808,0.808],"y":[1.094,1.094,1]},"o":{"x":[0.364,0.364,0.364],"y":[1.438,1.438,0]},"t":20,"s":[0,0,100]},{"t":40,"s":[100,100,100]}],"ix":6,"l":2}},"ao":0,"ip":0,"op":900,"st":0,"bm":0},{"ddd":0,"ind":6,"ty":2,"nm":"Layer 6.png","cl":"png","refId":"image_5","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"s":true,"x":{"a":0,"k":574.5,"ix":3},"y":{"a":0,"k":199,"ix":4}},"a":{"a":0,"k":[17.5,54.5,0],"ix":1,"l":2},"s":{"a":1,"k":[{"i":{"x":[0.808,0.808,0.808],"y":[1.094,1.094,1]},"o":{"x":[0.364,0.364,0.364],"y":[1.438,1.438,0]},"t":25,"s":[0,0,100]},{"t":45,"s":[100,100,100]}],"ix":6,"l":2}},"ao":0,"ip":0,"op":900,"st":0,"bm":0},{"ddd":0,"ind":7,"ty":2,"nm":"Layer 8.png","cl":"png","refId":"image_6","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[636.5,209,0],"ix":2,"l":2},"a":{"a":0,"k":[39.5,45,0],"ix":1,"l":2},"s":{"a":1,"k":[{"i":{"x":[0.808,0.808,0.808],"y":[1.094,1.094,1]},"o":{"x":[0.364,0.364,0.364],"y":[1.438,1.438,0]},"t":30,"s":[0,0,100]},{"t":50,"s":[100,100,100]}],"ix":6,"l":2}},"ao":0,"ip":0,"op":900,"st":0,"bm":0},{"ddd":0,"ind":8,"ty":2,"nm":"Layer 9.png","cl":"png","refId":"image_7","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[724.5,211,0],"ix":2,"l":2},"a":{"a":0,"k":[44,44.5,0],"ix":1,"l":2},"s":{"a":1,"k":[{"i":{"x":[0.808,0.808,0.808],"y":[1.094,1.094,1]},"o":{"x":[0.364,0.364,0.364],"y":[1.438,1.438,0]},"t":35,"s":[0,0,100]},{"t":55,"s":[100,100,100]}],"ix":6,"l":2}},"ao":0,"ip":0,"op":900,"st":0,"bm":0},{"ddd":0,"ind":9,"ty":2,"nm":"Layer 10.png","cl":"png","refId":"image_8","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[808.5,209,0],"ix":2,"l":2},"a":{"a":0,"k":[31.5,45,0],"ix":1,"l":2},"s":{"a":1,"k":[{"i":{"x":[0.808,0.808,0.808],"y":[1.094,1.094,1]},"o":{"x":[0.364,0.364,0.364],"y":[1.438,1.438,0]},"t":40,"s":[0,0,100]},{"t":60,"s":[100,100,100]}],"ix":6,"l":2}},"ao":0,"ip":0,"op":900,"st":0,"bm":0}]},{"id":"comp_1","nm":"Pre-comp 2","fr":60,"layers":[{"ddd":0,"ind":1,"ty":2,"nm":"Layer 11.png","cl":"png","refId":"image_10","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[978.5,191,0],"ix":2,"l":2},"a":{"a":0,"k":[35,50,0],"ix":1,"l":2},"s":{"a":1,"k":[{"i":{"x":[0.808,0.808,0.808],"y":[1.094,1.094,1]},"o":{"x":[0.364,0.364,0.364],"y":[1.438,1.438,0]},"t":85,"s":[0,0,100]},{"t":105,"s":[100,100,100]}],"ix":6,"l":2}},"ao":0,"ip":0,"op":900,"st":0,"bm":0},{"ddd":0,"ind":2,"ty":2,"nm":"Layer 12.png","cl":"png","refId":"image_11","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[1058.5,197,0],"ix":2,"l":2},"a":{"a":0,"k":[28.5,56,0],"ix":1,"l":2},"s":{"a":1,"k":[{"i":{"x":[0.808,0.808,0.808],"y":[1.094,1.094,1]},"o":{"x":[0.364,0.364,0.364],"y":[1.438,1.438,0]},"t":80,"s":[0,0,100]},{"t":100,"s":[100,100,100]}],"ix":6,"l":2}},"ao":0,"ip":0,"op":900,"st":0,"bm":0},{"ddd":0,"ind":3,"ty":2,"nm":"Layer 13.png","cl":"png","refId":"image_12","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[1156.5,197,0],"ix":2,"l":2},"a":{"a":0,"k":[53.5,57,0],"ix":1,"l":2},"s":{"a":1,"k":[{"i":{"x":[0.808,0.808,0.808],"y":[1.094,1.094,1]},"o":{"x":[0.364,0.364,0.364],"y":[1.438,1.438,0]},"t":75,"s":[0,0,100]},{"t":95,"s":[100,100,100]}],"ix":6,"l":2}},"ao":0,"ip":0,"op":900,"st":0,"bm":0},{"ddd":0,"ind":4,"ty":2,"nm":"Layer 14.png","cl":"png","refId":"image_13","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[1276.5,197,0],"ix":2,"l":2},"a":{"a":0,"k":[42,56,0],"ix":1,"l":2},"s":{"a":1,"k":[{"i":{"x":[0.808,0.808,0.808],"y":[1.094,1.094,1]},"o":{"x":[0.364,0.364,0.364],"y":[1.438,1.438,0]},"t":70,"s":[0,0,100]},{"t":90,"s":[100,100,100]}],"ix":6,"l":2}},"ao":0,"ip":0,"op":900,"st":0,"bm":0}]}]'),layers=[{ddd:0,ind:1,ty:0,nm:"Pre-comp 1",refId:"comp_0",sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:0,k:0,ix:10},p:{a:1,k:[{i:{x:0,y:.984},o:{x:.439,y:.019},t:47,s:[1040,207,0],to:[0,0,0],ti:[0,0,0]},{i:{x:.609,y:.609},o:{x:.167,y:.167},t:75,s:[900.338,207,0],to:[0,0,0],ti:[0,0,0]},{i:{x:0,y:.984},o:{x:.439,y:.019},t:78,s:[900.338,207,0],to:[0,0,0],ti:[0,0,0]},{t:120,s:[726.5,207,0]}],ix:2,l:2},a:{a:0,k:[726.5,207,0],ix:1,l:2},s:{a:1,k:[{i:{x:[0,0,0],y:[.984,.984,1]},o:{x:[.439,.439,.439],y:[.019,.019,0]},t:47,s:[130,130,100]},{t:75,s:[100,100,100]}],ix:6,l:2}},ao:0,w:1453,h:414,ip:0,op:900,st:0,bm:0},{ddd:0,ind:2,ty:2,nm:"&.png",cl:"png",refId:"image_9",sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:0,k:0,ix:10},p:{a:1,k:[{i:{x:.833,y:.833},o:{x:.167,y:.167},t:67,s:[1086.5,157,0],to:[0,0,0],ti:[0,0,0]},{i:{x:0,y:.984},o:{x:.439,y:.019},t:78,s:[1086.5,157,0],to:[0,0,0],ti:[0,0,0]},{t:120,s:[911.5,157,0]}],ix:2,l:2},a:{a:0,k:[81,101,0],ix:1,l:2},s:{a:1,k:[{i:{x:[0,0,0],y:[.984,.984,1]},o:{x:[.439,.439,.439],y:[.019,.019,0]},t:47,s:[0,0,100]},{t:67,s:[100,100,100]}],ix:6,l:2}},ao:0,ip:0,op:900,st:0,bm:0},{ddd:0,ind:4,ty:0,nm:"Pre-comp 2",refId:"comp_1",sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:0,k:0,ix:10},p:{a:1,k:[{i:{x:0,y:.984},o:{x:.439,y:.019},t:78,s:[846.5,207,0],to:[0,0,0],ti:[0,0,0]},{t:120,s:[726.5,207,0]}],ix:2,l:2},a:{a:0,k:[726.5,207,0],ix:1,l:2},s:{a:0,k:[100,100,100],ix:6,l:2}},ao:0,w:1453,h:414,ip:0,op:900,st:0,bm:0}],markers=[],props={},i={v,fr,ip,op,w,h,nm,ddd,assets,layers,markers,props};gsapWithCSS.registerPlugin(CustomEase);gsapWithCSS.registerPlugin(ScrollTrigger$1,ScrollToPlugin),setTimeout(()=>{window.scrollTo({top:0,behavior:"instant"})},100);let l,m,d=!1,u=!1,g=[document.getElementsByClassName("ctaTextHolder").item(0).getElementsByTagName("span").item(4),document.getElementsByClassName("ctaTextHolder").item(0).getElementsByTagName("span").item(3),document.getElementsByClassName("ctaTextHolder").item(0).getElementsByTagName("span").item(2),document.getElementsByClassName("ctaTextHolder").item(0).getElementsByTagName("span").item(1),document.getElementsByClassName("ctaTextHolder").item(0).getElementsByTagName("span").item(0),document.getElementsByClassName("ctaTextHolder").item(0).getElementsByTagName("span").item(5),document.getElementsByClassName("ctaTextHolder").item(0).getElementsByTagName("span").item(6),document.getElementsByClassName("ctaTextHolder").item(0).getElementsByTagName("span").item(7),document.getElementsByClassName("ctaTextHolder").item(0).getElementsByTagName("span").item(8),document.getElementsByClassName("ctaTextHolder").item(0).getElementsByTagName("span").item(9),document.getElementsByClassName("ctaTextHolder").item(0).getElementsByTagName("span").item(10),document.getElementsByClassName("ctaTextHolder").item(0).getElementsByTagName("span").item(11),document.getElementsByClassName("ctaTextHolder").item(0).getElementsByTagName("span").item(12),document.getElementsByClassName("ctaTextHolder").item(0).getElementsByTagName("span").item(13)];function activateTick(){document.getElementById("tick").volume=.35,setInterval(()=>{document.getElementById("tick").currentTime=0,d||document.getElementById("tick").play()},1e3)}function clicked(){if(!u){u=!0,window.innerWidth<861&&gsapWithCSS.set(".hero, .note1, .note2",{pointerEvents:"all"}),showTime(),function(){window.addEventListener("scroll",()=>{gsapWithCSS.to(".menuLSLFill, .menuLSRFill",{height:100*window.scrollY/(document.body.scrollHeight-window.innerHeight)+"%",duration:.3,ease:CustomEase.create("custom","M0,0 C0.382,0 0.308,1 1,1 ")}),gsapWithCSS.to(".menuLTLFill, .menuLTRFill",{width:100-100*window.scrollY/(document.body.scrollHeight-window.innerHeight)+"%",duration:.3,ease:CustomEase.create("custom","M0,0 C0.382,0 0.308,1 1,1 ")})})}(),function(){document.getElementById("sfxMenuHover").volume=1;let o=document.getElementsByClassName("sfxMenu");for(let f=0;f<o.length;f++)o.item(f).addEventListener("mouseenter",()=>{d||(document.getElementById("sfxMenuHover").currentTime=0,document.getElementById("sfxMenuHover").play())}),o.item(f).addEventListener("mouseleave",()=>{d||document.getElementById("sfxMenuHover").pause()})}(),document.getElementById("ambient").volume=.7,document.getElementById("ambient").play(),document.getElementById("worksClick1").addEventListener("click",()=>{window.open("https://sobhanafsarian.com","_blank")}),document.getElementById("worksClick2").addEventListener("click",()=>{window.open("https://zia.photography","_blank")}),document.getElementById("worksClick3").addEventListener("click",()=>{window.open("https://en.college.icds.ai","_blank")}),gsapWithCSS.to(".ctaText",{opacity:0,scale:1.4,duration:.8,ease:CustomEase.create("custom","M0,0 C0.497,0.02 0.012,0.997 1,1 ")}),l.play(),setTimeout(()=>{m.play()},4e3),gsapWithCSS.to(".cta",{opacity:0,scale:1.3,duration:.5,ease:CustomEase.create("custom","M0,0 C0.497,0.02 0.012,0.997 1,1 "),onComplete:()=>{gsapWithCSS.set(".cta",{display:"none"})}});let r=96;window.innerWidth<1281&&(r=72),window.innerWidth<861&&(r=48),window.innerWidth<681&&(r=69),gsapWithCSS.to(".menuLogo",{top:r,delay:4.5,duration:2,ease:CustomEase.create("custom","M0,0 C0.562,0 0.144,1 1,1 "),onComplete:()=>{const n=new Lenis({duration:5,easing:o=>Math.min(1,1.001-Math.pow(4,-10*o)),smooth:!0,smoothWheel:!0,smoothTouch:!1,touchMultiplier:2,gestureDirection:"vertical"});n.on("scroll",ScrollTrigger$1.update),gsapWithCSS.ticker.add(o=>{n.raf(1e3*o)}),gsapWithCSS.ticker.lagSmoothing(0)}}),gsapWithCSS.to(".menuBtn1",{left:0,delay:5,duration:1.8,ease:CustomEase.create("custom","M0,0 C0,0 0.103,1 1,1 "),onComplete:activateTick}),gsapWithCSS.to(".menuBtn2",{right:0,delay:5,duration:1.8,ease:CustomEase.create("custom","M0,0 C0,0 0.103,1 1,1 ")}),gsapWithCSS.to(".menuBtn3",{bottom:0,delay:5.5,duration:1.8,ease:CustomEase.create("custom","M0,0 C0,0 0.103,1 1,1 ")}),gsapWithCSS.to(".menuClock",{bottom:0,delay:5.5,duration:1.8,ease:CustomEase.create("custom","M0,0 C0,0 0.103,1 1,1 ")}),gsapWithCSS.to(".menuLTR",{scaleX:"100%",delay:3,duration:5,ease:CustomEase.create("custom","M0,0 C0.562,0 0.144,1 1,1 ")}),gsapWithCSS.to(".menuLTL",{scaleX:"100%",delay:3,duration:5,ease:CustomEase.create("custom","M0,0 C0.562,0 0.144,1 1,1 ")}),gsapWithCSS.to(".fold1, .fold2",{opacity:1,delay:3,duration:5,ease:CustomEase.create("custom","M0,0 C0.562,0 0.144,1 1,1 ")}),gsapWithCSS.to(document.getElementsByClassName("note1").item(0),{marginTop:"-240px",delay:3,duration:6,ease:CustomEase.create("custom","M0,0 C0.562,0 0.144,1 1,1 ")}),gsapWithCSS.to("#intro",{scale:1,delay:4.25,duration:5,ease:CustomEase.create("custom","M0,0 C0.562,0 0.144,1 1,1 ")}),gsapWithCSS.to(".heroScrollArrowItem1, .heroScrollArrowItem2, .heroScrollArrowItem3",{y:0,opacity:1,delay:5.5,duration:.8,stagger:.2,ease:CustomEase.create("custom","M0,0 C0.562,0 0.144,1 1,1 ")}),gsapWithCSS.to(".heroScrollText",{opacity:1,y:0,delay:4.5,duration:2,ease:CustomEase.create("custom","M0,0 C0.562,0 0.144,1 1,1 ")}),gsapWithCSS.fromTo(".chapter1PopChars img",{y:"100%"},{y:0,duration:1,stagger:.15,scrollTrigger:{trigger:".chapter1PopChar1",start:"top 125%",end:"top 75%"}}),gsapWithCSS.fromTo(".chapter1PopEdges",{scale:.8,opacity:0},{opacity:1,scale:1,duration:1,scrollTrigger:{trigger:".chapter1PopChar1",start:"top 125%",end:"top 85%"}}),gsapWithCSS.fromTo("#intro",{display:"block"},{display:"none",scrollTrigger:{trigger:".note2",start:"top bottom",end:"top center",scrub:!0}});let a="80vh";window.innerWidth<480&&(a="10vh"),gsapWithCSS.fromTo(".note2Ctr",{y:0,skewX:"4deg"},{y:a,skewX:"-6deg",scrollTrigger:{trigger:".note2",start:"top bottom",end:"bottom -300%",scrub:!0}}),gsapWithCSS.fromTo(".servicesItemT1 span",{letterSpacing:0},{letterSpacing:8,autoRound:!1,scrollTrigger:{trigger:".servicesItem",start:"top 140%",end:"top center",scrub:!0}}),gsapWithCSS.fromTo(".servicesItemT2 h2",{letterSpacing:21},{letterSpacing:8,autoRound:!1,scrollTrigger:{trigger:".servicesItem",start:"top 140%",end:"top center",scrub:!0}}),gsapWithCSS.fromTo(".contactEdgeP",{letterSpacing:0},{letterSpacing:1,autoRound:!1,scrollTrigger:{trigger:".contactEdgeP",start:"top 120%",end:"top center",scrub:!0}}),gsapWithCSS.fromTo(".chapter2PopChars img",{y:"100%"},{y:0,duration:1,stagger:.15,scrollTrigger:{trigger:".chapter2PopChar1",start:"top 125%",end:"top 75%"}}),gsapWithCSS.fromTo(".chapter2PopEdges",{scale:.8,opacity:0},{opacity:1,scale:1,duration:1,scrollTrigger:{trigger:".chapter2PopChar1",start:"top 125%",end:"top 85%"}}),gsapWithCSS.fromTo(".chapter3PopChars img",{y:"100%"},{y:0,duration:1,scrollTrigger:{trigger:".chapter3PopChar1",start:"top 125%",end:"top 75%"}}),gsapWithCSS.fromTo(".chapter3PopEdges",{scale:.8,opacity:0},{opacity:1,scale:1,duration:1,scrollTrigger:{trigger:".chapter3PopChar1",start:"top 125%",end:"top 85%"}}),gsapWithCSS.to(".heroScrollText",{display:"none",scrollTrigger:{trigger:".note1",start:"top top",end:"top -10%"}}),gsapWithCSS.fromTo(".secTitle2",{top:"100%"},{top:0,scrollTrigger:{trigger:".servicesItemT1",start:"top 90%",end:"top 30%",scrub:!0}}),gsapWithCSS.fromTo(".secTitle3",{top:"100%"},{top:0,scrollTrigger:{trigger:".chapter1",start:"top 90%",end:"top 30%",scrub:!0}}),gsapWithCSS.fromTo(".secTitle2",{y:0},{y:"-100%",scrollTrigger:{trigger:".chapter1",start:"top 90%",end:"top 30%",scrub:!0}}),gsapWithCSS.fromTo(".secTitle4",{top:"100%"},{top:0,scrollTrigger:{trigger:".worksCtr",start:"top 90%",end:"top 30%",scrub:!0}}),gsapWithCSS.fromTo(".secTitle3",{y:0},{y:"-100%",scrollTrigger:{trigger:".worksCtr",start:"top 90%",end:"top 30%",scrub:!0}}),gsapWithCSS.fromTo(".secTitle5",{top:"100%"},{top:0,scrollTrigger:{trigger:".contact",start:"top 90%",end:"top 30%",scrub:!0}}),gsapWithCSS.fromTo(".secTitle4",{y:0},{y:"-100%",scrollTrigger:{trigger:".note3",start:"top 90%",end:"top 30%",scrub:!0}})}}window.addEventListener("DOMContentLoaded",()=>{l=c.loadAnimation({container:document.getElementById("introTypo"),renderer:"svg",loop:!1,autoplay:!1,animationData:s}),m=c.loadAnimation({container:document.getElementById("heroSlogan"),renderer:"svg",loop:!1,autoplay:!1,animationData:i})}),window.addEventListener("load",function r(){(function(){let o=0,f=0,y=0,x=0;window.addEventListener("mousemove",b=>{b.clientX,b.clientY,o=b.clientY/window.innerHeight*180,f=b.clientX/window.innerWidth*180,y=360*Math.abs(b.clientX/window.innerWidth-.5),x=360*Math.abs(b.clientY/window.innerHeight-.5),gsapWithCSS.to(".ctaCircle1",{rotation:o,duration:.5}),gsapWithCSS.to(".ctaCircle2",{rotation:f,duration:.5}),gsapWithCSS.to(".ctaLineR",{translateX:y+120,duration:.6}),gsapWithCSS.to(".ctaLineL",{translateX:-1*(y+240),duration:.4}),gsapWithCSS.to(".ctaLineB",{translateY:x+120,duration:.6}),gsapWithCSS.to(".ctaLineT",{translateY:-1*(x+240),duration:.4})})})();const a=[[document.getElementsByClassName("loadingCharsItem").item(3)],[document.getElementsByClassName("loadingCharsItem").item(2),document.getElementsByClassName("loadingCharsItem").item(4)],[document.getElementsByClassName("loadingCharsItem").item(1),document.getElementsByClassName("loadingCharsItem").item(5)],[document.getElementsByClassName("loadingCharsItem").item(0),document.getElementsByClassName("loadingCharsItem").item(6)]];gsapWithCSS.to(a,{opacity:0,duration:.8,stagger:.03,filter:"blur(32px)",scale:0,ease:CustomEase.create("custom","M0,0 C0.199,0 0.536,1 1,1 ")}),gsapWithCSS.to(a,{marginRight:16,marginLeft:16,autoRound:!1,duration:.8,ease:CustomEase.create("custom","M0,0 C0.634,-0.509 0.115,1.081 1,1 ")}),gsapWithCSS.to(".introLogo img",{scale:1,opacity:1,duration:1.8,delay:.2,filter:"blur(0px)",ease:CustomEase.create("custom","M0,0 C0.203,0 -0.264,1.131 1,1 ")}),gsapWithCSS.to(".introBackBottom, .introBackTop",{height:0,duration:2,delay:1.5,ease:CustomEase.create("custom","M0,0 C0.739,0.113 0.206,1 1,1 ")}),gsapWithCSS.to(".introLogo",{scale:.2,opacity:0,filter:"blur(8px)",duration:1.9,delay:1.7,ease:CustomEase.create("custom","M0,0 C0.668,0 0.206,1 1,1 "),onComplete:()=>{gsapWithCSS.set(".introLogo, .introBack, .loading",{display:"none"})}}),gsapWithCSS.to(".cta",{scale:1,delay:1.5,opacity:1,duration:2,ease:CustomEase.create("custom","M0,0 C0.739,0.113 0.206,1 1,1 ")}),gsapWithCSS.to(g,{delay:2.6,opacity:1,duration:.4,stagger:.06,ease:CustomEase.create("custom","M0,0 C0.197,0 0.584,1 1,1 ")}),gsapWithCSS.to(".ctaTextHolder",{delay:.8,duration:2.5,filter:"blur(0px)",scale:1,ease:CustomEase.create("custom","M0,0 C0.4,0 0.299,1 1,1 "),onComplete:()=>{document.addEventListener("click",clicked)}})}),function r(a){const n={},o=new IntersectionObserver(f=>{f.forEach(y=>{y.isIntersecting?async function(b){const _=document.getElementById(b);if(!_||n[b])return;const{Application:S}=await __vitePreload(()=>import("https://unpkg.com/@splinetool/runtime"),[]),A=new S(_);await A.load(a[b]),n[b]=A}(y.target.id):function(b){const _=n[b];_&&(_.dispose(),delete n[b])}(y.target.id)})},{threshold:.2});Object.keys(a).forEach(f=>{const y=document.getElementById(f);y&&o.observe(y)})}({scene1can:"https://prod.spline.design/6KSu8sOhBme2F3eM/scene.splinecode",scene2can:"https://prod.spline.design/pBcPpc0GvMRXrhZL/scene.splinecode",scene3can:"https://prod.spline.design/bpirc9JduHFVsKR9/scene.splinecode"});const p=document.getElementById("intro");new IntersectionObserver(([r])=>{r.isIntersecting?(p.style.pointerEvents="auto",p.setAttribute("loading","eager")):(p.style.pointerEvents="none",p.setAttribute("loading","lazy"))});function showTime(){var r=new Date,a=r.getHours(),n=r.getMinutes(),o=r.getSeconds(),f="AM";a==0&&(a=12),a>12&&(a-=12,f="PM");var y=(a=a<10?"0"+a:a)+":"+(n=n<10?"0"+n:n)+":"+(o=o<10?"0"+o:o)+" "+f;document.getElementsByClassName("menuClock").item(0).getElementsByTagName("span").item(0).innerText=y,document.getElementsByClassName("menuClock").item(0).getElementsByTagName("span").item(0).textContent=y,setTimeout(showTime,1e3)}(function r(){let a=document.getElementsByClassName("menuBtn2Hld").item(0),n=document.getElementsByClassName("servicesItemBtnClick"),o=document.getElementsByClassName("menuBtn1Hld").item(0),f=document.getElementsByClassName("menuLogo").item(0);function y(){d||(document.getElementById("sfxTransition").currentTime=0,document.getElementById("sfxTransition").play()),gsapWithCSS.set(window,{delay:.4,scrollTo:"#contact"}),gsapWithCSS.to(".scrollOverlay",{scale:5,duration:.4,ease:CustomEase.create("custom","M0,0 C0.571,0.026 0.564,1 1,1 ")}),gsapWithCSS.to(".scrollOverlay",{scale:0,duration:.6,delay:.4,ease:CustomEase.create("custom","M0,0 C0.136,0.822 0.564,1 1,1 "),onComplete:()=>{}})}document.getElementById("sfxTransition").volume=1,a.addEventListener("click",y),n.item(0).addEventListener("click",y),n.item(1).addEventListener("click",y),o.addEventListener("click",()=>{d||(document.getElementById("sfxTransition").currentTime=0,document.getElementById("sfxTransition").play()),gsapWithCSS.set(window,{delay:.4,scrollTo:".worksCtr"}),gsapWithCSS.to(".scrollOverlay",{scale:5,duration:.4,ease:CustomEase.create("custom","M0,0 C0.571,0.026 0.564,1 1,1 ")}),gsapWithCSS.to(".scrollOverlay",{scale:0,duration:.6,delay:.4,ease:CustomEase.create("custom","M0,0 C0.136,0.822 0.564,1 1,1 ")})}),f.addEventListener("click",()=>{d||(document.getElementById("sfxTransition").currentTime=0,document.getElementById("sfxTransition").play()),gsapWithCSS.set(window,{delay:.4,scrollTo:0}),gsapWithCSS.to(".scrollOverlay",{scale:5,duration:.4,ease:CustomEase.create("custom","M0,0 C0.571,0.026 0.564,1 1,1 ")}),gsapWithCSS.to(".scrollOverlay",{scale:0,duration:.6,delay:.4,ease:CustomEase.create("custom","M0,0 C0.136,0.822 0.564,1 1,1 ")})})})(),function r(){window.addEventListener("mousemove",a=>{let n=a.clientX/window.innerWidth*7-3,o=.025*(a.clientY-window.innerHeight/2),f="drop-shadow("+.025*(a.clientX-window.innerWidth/2)+"px "+o+"px 56px rgba(255, 255, 255, 0.1))";gsapWithCSS.to(".contactCircle1",{rotation:5*n,filter:f,duration:.17,ease:CustomEase.create("custom","M0,0 C0.568,0 0.178,1 1,1 ")}),gsapWithCSS.to(".contactCircle2",{rotation:n,duration:.17,ease:CustomEase.create("custom","M0,0 C0.568,0 0.178,1 1,1 ")}),gsapWithCSS.to(".contactCircle3",{rotation:n,duration:.17,ease:CustomEase.create("custom","M0,0 C0.568,0 0.178,1 1,1 ")})}),document.getElementsByClassName("contactCircles").item(0).addEventListener("mouseenter",()=>{gsapWithCSS.to(".contactCircle1, .contactCircle2, .contactCircle3, .contactCircle4",{scale:1.1,duration:.2,ease:CustomEase.create("custom","M0,0 C0.111,0.975 0.988,1.344 1,1 ")}),gsapWithCSS.to(".contactLineR, .contactLineL",{scaleX:.4,duration:.2,ease:CustomEase.create("custom","M0,0 C0.111,0.975 0.988,1.344 1,1 ")}),gsapWithCSS.to(".contactBtn",{scale:.9,autoRound:!1,letterSpacing:6,duration:.2,ease:CustomEase.create("custom","M0,0 C0.111,0.975 0.988,1.344 1,1 ")}),gsapWithCSS.to(".contactCircle4",{opacity:.07,duration:.2,ease:CustomEase.create("custom","M0,0 C0.111,0.975 0.988,1.344 1,1 ")}),gsapWithCSS.to(".contactBtn span",{background:"linear-gradient(90deg,rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 0) 50%, rgba(255, 255, 255, 0) 100%)",duration:.2,ease:CustomEase.create("custom","M0,0 C0.111,0.975 0.988,1.344 1,1 ")}),gsapWithCSS.to(".contactEmail",{scale:1.2,duration:.2,ease:CustomEase.create("custom","M0,0 C0.111,0.975 0.988,1.344 1,1 ")})}),document.getElementsByClassName("contactCircles").item(0).addEventListener("mouseleave",()=>{gsapWithCSS.to(".contactCircle1, .contactCircle2, .contactCircle3, .contactCircle4",{scale:1,duration:.2,ease:CustomEase.create("custom","M0,0 C0.111,0.975 0.988,1.344 1,1 ")}),gsapWithCSS.to(".contactBtn",{letterSpacing:1,autoRound:!1,scale:1,duration:.2,ease:CustomEase.create("custom","M0,0 C0.111,0.975 0.988,1.344 1,1 ")}),gsapWithCSS.to(".contactLineR, .contactLineL",{scaleX:1,duration:.2,ease:CustomEase.create("custom","M0,0 C0.111,0.975 0.988,1.344 1,1 ")}),gsapWithCSS.to(".contactCircle4",{opacity:.05,duration:.2,ease:CustomEase.create("custom","M0,0 C0.111,0.975 0.988,1.344 1,1 ")}),gsapWithCSS.to(".contactBtn span",{background:"linear-gradient(90deg,rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 0.1) 50%, rgba(255, 255, 255, 0) 100%)",duration:.2,ease:CustomEase.create("custom","M0,0 C0.111,0.975 0.988,1.344 1,1 ")}),gsapWithCSS.to(".contactEmail",{scale:1,duration:.2,ease:CustomEase.create("custom","M0,0 C0.111,0.975 0.988,1.344 1,1 ")})}),document.getElementsByClassName("contactCircles").item(0).addEventListener("click",()=>{d||(document.getElementById("sfxContact").currentTime=0,document.getElementById("sfxContact").play()),navigator.clipboard.writeText("hello@wyrvox.site"),gsapWithCSS.to(".contactCircleCopied",{scale:1.1,duration:.3,ease:CustomEase.create("custom","M0,0 C0.422,0.037 0.158,1 1,1 ")}),gsapWithCSS.to(".contactCircleCopied span",{scale:1,duration:.3,delay:.1,ease:CustomEase.create("custom","M0,0 C0.503,0.01 0,1 1,1 ")}),gsapWithCSS.to(".contactCircleCopied span",{scale:0,duration:.3,delay:1.1,ease:CustomEase.create("custom","M0,0 C0.422,0.037 0.158,1 1,1 ")}),gsapWithCSS.to(".contactCircleCopied",{scale:0,duration:.3,delay:1.3,ease:CustomEase.create("custom","M0,0 C0.422,0.037 0.158,1 1,1 ")})})}(),function r(){document.getElementsByClassName("menuBtn3").item(0).addEventListener("click",()=>{d?(d=!1,document.getElementById("tick").volume=.35,document.getElementById("ambient").play(),gsapWithCSS.to(".menuBtn3TXT",{left:0,delay:.1,duration:.5,ease:CustomEase.create("custom","M0,0 C0.658,0.101 0.053,1 1,1 ")}),gsapWithCSS.to(".menuBtn3TXTAlt",{left:"100%",duration:.5,delay:.1,ease:CustomEase.create("custom","M0,0 C0.422,0.037 0.158,1 1,1 ")})):(d=!0,document.getElementById("ambient").pause(),document.getElementById("tick").volume=0,gsapWithCSS.to(".menuBtn3TXT",{left:"-100%",duration:.3,ease:CustomEase.create("custom","M0,0 C0.422,0.037 0.158,1 1,1 ")}),gsapWithCSS.to(".menuBtn3TXTAlt",{left:"0",duration:.4,delay:.15,ease:CustomEase.create("custom","M0,0 C0.658,0.101 0.053,1 1,1 ")}))})}()});export default hn();
//# sourceMappingURL=index-CM4fW6ok.js.map
